// Decompiled: ntpd_638b3f6eff751391


int _init(EVP_PKEY_CTX *ctx)

{
  int iVar1;
  
  iVar1 = FUN_0000b5a4();
  return iVar1;
}




void FUN_0000b1d8(int param_1,undefined4 param_2,undefined4 param_3,uint param_4)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint local_84;
  uint local_80;
  int local_7c;
  uint local_78;
  byte local_74;
  char local_73;
  undefined1 local_72;
  undefined1 local_71;
  uint local_70;
  uint local_6c;
  undefined4 local_68;
  uint local_64;
  uint local_60;
  uint local_5c;
  uint uStack_58;
  uint local_54;
  uint local_50;
  uint local_4c;
  uint local_48;
  
  if ((*(uint *)(*(int *)(param_1 + 0x40) + 0x8c) & 0x40) != 0) {
    uVar1 = FUN_00015bd4(param_1 + 8);
    *(undefined4 *)(param_1 + 0x40) = uVar1;
  }
  if ((param_4 & 0x400) == 0) {
    local_5c = *(uint *)(param_1 + 0x84);
    uStack_58 = *(uint *)(param_1 + 0x88);
    uVar6 = *(uint *)(param_1 + 0x4c);
    local_73 = DAT_000cb4fc;
    if (DAT_000cb4fc == '\x10') {
      local_73 = '\0';
    }
    local_64 = DAT_000cb500 << 0x18 | (DAT_000cb500 >> 8 & 0xff) << 0x10 | (DAT_000cb500 >> 0x10 & 0xff) << 8 |
               DAT_000cb500 >> 0x18;
    local_54 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 | (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
    uVar6 = DAT_0007a1c8;
    if ((int)DAT_0007a1c8 <= (int)(uint)*(byte *)(param_1 + 0x5e)) {
      uVar6 = (uint)*(byte *)(param_1 + 0x5e);
    }
    local_72 = (undefined1)uVar6;
    uVar6 = *(uint *)(param_1 + 0x50);
    local_60 = DAT_000cb504 << 0x18 | (DAT_000cb504 >> 8 & 0xff) << 0x10 | (DAT_000cb504 >> 0x10 & 0xff) << 8 |
               DAT_000cb504 >> 0x18;
    uVar5 = (uint)(longlong)(DAT_000cb4b8 * 65536.0);
    local_50 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 | (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
    local_71 = DAT_000cb478;
    local_68 = DAT_000cb4e0;
    local_74 = (byte)param_2 & 7 | DAT_000cb4b0 << 6 | *(byte *)(param_1 + 0x5c) & 0x38;
    uVar6 = (uint)(0.0 < DAT_000cb498 * 65536.0) * (int)(longlong)(DAT_000cb498 * 65536.0);
    local_70 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
    local_6c = uVar6 * 0x1000000 | (uVar6 >> 8 & 0xff) << 0x10 | (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
    FUN_0004cba8(&local_84);
    local_4c = local_84 << 0x18 | (local_84 >> 8 & 0xff) << 0x10 | (local_84 >> 0x10 & 0xff) << 8 | local_84 >> 0x18;
    local_48 = local_80 << 0x18 | (local_80 >> 8 & 0xff) << 0x10 | (local_80 >> 0x10 & 0xff) << 8 | local_80 >> 0x18;
  }
  else {
    local_5c = *(uint *)(param_1 + 0x84);
    uStack_58 = *(uint *)(param_1 + 0x88);
    local_68 = 0x45544152;
    local_74 = ~((byte)~(byte)(((*(byte *)(param_1 + 0x5c) & 0x38) << 0x1a) >> 0x18) >> 2) | (byte)param_2 & 7;
    uVar6 = (uint)*(byte *)(param_1 + 0x5e);
    DAT_000cb4e4 = DAT_000cb4e4 + 1;
    if ((int)uVar6 < (int)DAT_0007a1c8) {
      uVar6 = DAT_0007a1c8;
    }
    local_72 = (undefined1)uVar6;
    local_73 = '\0';
    local_54 = local_5c;
    local_50 = uStack_58;
    local_4c = local_5c;
    local_48 = uStack_58;
  }
  if (*(int *)(param_1 + 0x58) == 0x30) {
    FUN_000154a4(param_1 + 8,*(undefined4 *)(param_1 + 0x40),0,&local_74,0x30);
    uVar1 = DAT_000cb548;
    if (DAT_0007cf4c != 0) {
      uVar2 = FUN_00050cd0(*(int *)(param_1 + 0x40) + 0x14);
      uVar3 = FUN_00050cd0(param_1 + 8);
      printf("transmit: at %ld %s->%s mode %d len %d\n",uVar1,uVar2,uVar3,param_2,0x30);
    }
  }
  else {
    FUN_0004cba8(&local_84);
    iVar4 = FUN_0004e458(param_3,&local_74,0x30);
    FUN_000154a4(param_1 + 8,*(undefined4 *)(param_1 + 0x40),0,&local_74,iVar4 + 0x30);
    FUN_0004cba8(&local_7c);
    uVar1 = DAT_000cb548;
    if (local_80 == 0) {
      local_7c = local_7c - local_84;
    }
    else {
      uVar6 = (local_78 & 0xffff) + (-local_80 & 0xffff);
      uVar5 = (local_78 >> 0x10) + (-local_80 >> 0x10);
      if ((uVar6 & 0x10000) != 0) {
        uVar5 = uVar5 + 1;
      }
      local_78 = uVar6 & 0xffff | uVar5 << 0x10;
      local_7c = ~local_84 + local_7c;
      if ((uVar5 & 0x10000) != 0) {
        local_7c = local_7c + 1;
      }
    }
    DAT_000cb458 = local_7c;
    DAT_000cb45c = local_78;
    if (DAT_0007cf4c != 0) {
      uVar2 = FUN_00050cd0(*(int *)(param_1 + 0x40) + 0x14);
      uVar3 = FUN_00050cd0(param_1 + 8);
      printf("transmit: at %ld %s->%s mode %d keyid %08x len %d\n",uVar1,uVar2,uVar3,param_2,param_3,iVar4 + 0x30);
    }
  }
  return;
}




void FUN_0000b560(void)

{
                    /* WARNING: Subroutine does not return */
  FUN_00019018();
}




void processEntry entry(undefined4 param_1,undefined4 param_2)

{
  __libc_start_main(FUN_0000b560,param_2,&stack0x00000004,FUN_0005b320,&DAT_0005b384,param_1);
                    /* WARNING: Subroutine does not return */
  abort();
}




/* WARNING: Removing unreachable block (ram,0x0000b5b8) */

void FUN_0000b5a4(void)

{
  __gmon_start__();
  return;
}




/* WARNING: Removing unreachable block (ram,0x0000b5e0) */
/* WARNING: Removing unreachable block (ram,0x0000b5e8) */
/* WARNING: Removing unreachable block (ram,0x0000b5ec) */

void FUN_0000b5c8(void)

{
  return;
}




void _FINI_0(void)

{
  if (DAT_0007cde0 != '\0') {
    return;
  }
  FUN_0000b5c8();
  DAT_0007cde0 = 1;
  return;
}




/* WARNING: Removing unreachable block (ram,0x0000b620) */
/* WARNING: Removing unreachable block (ram,0x0000b628) */
/* WARNING: Removing unreachable block (ram,0x0000b688) */
/* WARNING: Removing unreachable block (ram,0x0000b62c) */

void _INIT_0(void)

{
  return;
}




void FUN_0000b6a0(int param_1)

{
  bool bVar1;
  long lVar2;
  size_t sVar3;
  uint uVar4;
  int iVar5;
  char *pcVar6;
  int *piVar7;
  undefined4 local_28 [3];
  
  if (DAT_000cb868 == 0) {
    if (DAT_000cb864 == 0) {
      FUN_0004fe78(3,"Neither IPv4 nor IPv6 networking detected, fatal.");
                    /* WARNING: Subroutine does not return */
      exit(1);
    }
    if ((*(uint *)(DAT_0007954c + 0x10) & 0xf) == 0) {
LAB_0000b9a0:
      if (((*(uint *)(DAT_0007954c + 0x50) & 0xf) != 0) && (DAT_000cb864 == 0)) {
        FUN_0004fe78(4,"-6/--ipv6 ignored, IPv6 networking not found.");
      }
    }
    else {
      FUN_0004fe78(4,"-4/--ipv4 ignored, IPv4 networking not found.");
    }
  }
  else {
    if (DAT_000cb864 == 0) goto LAB_0000b9a0;
    if ((*(uint *)(DAT_0007954c + 0x10) & 0xf) == 0) {
      if ((*(uint *)(DAT_0007954c + 0x50) & 0xf) != 0) {
        DAT_000cb868 = 0;
      }
      uVar4 = *(uint *)(DAT_0007954c + 0x90);
      goto joined_r0x0000b95c;
    }
    DAT_000cb864 = 0;
  }
  uVar4 = *(uint *)(DAT_0007954c + 0x90);
joined_r0x0000b95c:
  if ((uVar4 & 0xf) == 0) {
    if ((*(uint *)(DAT_0007954c + 0xd0) & 0xf) != 0) {
      FUN_00026a68(0,3,0,0);
    }
    uVar4 = *(uint *)(DAT_0007954c + 0x110);
  }
  else {
    FUN_00026a68(0,3,1,0);
    uVar4 = *(uint *)(DAT_0007954c + 0x110);
  }
  if ((uVar4 & 0xf) != 0) {
    FUN_00026a68(0,1,1,0);
  }
  if ((*(uint *)(DAT_0007954c + 0x150) & 0xf) != 0) {
    DAT_000c9d68 = *(undefined4 *)(DAT_0007954c + 0x158);
  }
  if ((*(uint *)(DAT_0007954c + 0x210) & 0xf) != 0) {
    FUN_0002e368(1,*(undefined4 *)(DAT_0007954c + 0x218));
  }
  if ((*(uint *)(DAT_0007954c + 0x250) & 0xf) != 0) {
    DAT_0007d5e8 = 1;
  }
  if ((*(uint *)(DAT_0007954c + 0x290) & 0xf) != 0) {
    DAT_0007cf64 = *(undefined4 *)(DAT_0007954c + 0x298);
    DAT_0007cf58 = 1;
  }
  if ((*(uint *)(DAT_0007954c + 0x310) & 0xf) != 0) {
    FUN_0002e1e8(*(undefined4 *)(DAT_0007954c + 0x318));
  }
  if ((*(uint *)(DAT_0007954c + 0x490) & 0xf) != 0) {
    FUN_0002e368(3,*(undefined4 *)(DAT_0007954c + 0x498));
  }
  if ((*(uint *)(DAT_0007954c + 0x510) & 0xf) != 0) {
    DAT_0007d5ec = 1;
  }
  if ((*(uint *)(DAT_0007954c + 0x550) & 0xf) != 0) {
    pcVar6 = *(char **)(DAT_0007954c + 0x558);
    iVar5 = sscanf(pcVar6,"%lf",local_28);
    if (iVar5 == 1) {
      FUN_00026a68(local_28[0],4,0,0);
    }
    else {
      FUN_0004fe78(3,"command line broadcast delay value %s undecodable",pcVar6);
    }
  }
  if ((*(uint *)(DAT_0007954c + 0x5d0) & 0xf) != 0) {
    FUN_0002e368(2,*(undefined4 *)(DAT_0007954c + 0x5d8));
  }
  if ((*(uint *)(DAT_0007954c + 0x610) & 0xf) != 0) {
    iVar5 = **(int **)(DAT_0007954c + 0x61c);
    piVar7 = *(int **)(DAT_0007954c + 0x61c) + 2;
    do {
      while( true ) {
        pcVar6 = (char *)*piVar7;
        lVar2 = strtol(pcVar6,(char **)0x0,10);
        if (0xfffe < lVar2 - 1U) break;
        iVar5 = iVar5 + -1;
        FUN_0004de88(lVar2,1);
        piVar7 = piVar7 + 1;
        if (iVar5 < 1) goto LAB_0000b820;
      }
      iVar5 = iVar5 + -1;
      FUN_0004fe78(3,"command line trusted key %s is invalid",pcVar6);
      piVar7 = piVar7 + 1;
    } while (0 < iVar5);
  }
LAB_0000b820:
  if ((*(uint *)(DAT_0007954c + 0x650) & 0xf) != 0) {
    DAT_0007cf58 = 1;
    DAT_0007cf5c = (char *)FUN_0004f4e8(*(undefined4 *)(DAT_0007954c + 0x658));
    pcVar6 = rindex(DAT_0007cf5c,0x3a);
    if (pcVar6 == (char *)0x0) {
      DAT_0007cf60 = (char *)0x0;
    }
    else {
      DAT_0007cf60 = pcVar6 + 1;
      *pcVar6 = '\0';
    }
  }
  if ((*(uint *)(DAT_0007954c + 0x6d0) & 0xf) != 0) {
    iVar5 = **(int **)(DAT_0007954c + 0x6dc);
    piVar7 = *(int **)(DAT_0007954c + 0x6dc) + 2;
    do {
      pcVar6 = (char *)*piVar7;
      iVar5 = iVar5 + -1;
      sVar3 = strlen(pcVar6);
      FUN_0001ce68(pcVar6,sVar3 + 1,3);
      piVar7 = piVar7 + 1;
    } while (0 < iVar5);
  }
  if ((*(uint *)(DAT_0007954c + 0x710) & 0xf) != 0) {
    iVar5 = **(int **)(DAT_0007954c + 0x71c);
    piVar7 = *(int **)(DAT_0007954c + 0x71c) + 2;
    do {
      pcVar6 = (char *)*piVar7;
      iVar5 = iVar5 + -1;
      sVar3 = strlen(pcVar6);
      FUN_0001ce68(pcVar6,sVar3 + 1,0x23);
      piVar7 = piVar7 + 1;
    } while (0 < iVar5);
  }
  if ((*(uint *)(DAT_0007954c + 0x750) & 0xf) != 0) {
    DAT_0007a198 = 0;
    DAT_0007a1a8._0_4_ = 0;
    DAT_0007a1a8._4_4_ = 0x4082c000;
  }
  if ((*(uint *)(DAT_0007954c + 0x690) & 0xf) == 0) {
    bVar1 = false;
  }
  else {
    iVar5 = *(int *)(DAT_0007954c + 0x698);
    if (iVar5 < 0) {
      fprintf(stderr,"command line interface update interval %ld must not be negative\n",iVar5);
      FUN_0004fe78(3,"command line interface update interval %ld must not be negative",iVar5);
      bVar1 = true;
    }
    else {
      bVar1 = false;
      DAT_0007a4e8 = iVar5;
    }
  }
  if (bVar1 || param_1 != 0) {
    if (param_1 != 0) {
      fprintf(stderr,"argc after processing is <%d>\n",param_1);
    }
    FUN_0004c6c0(&DAT_00079508,2);
  }
  return;
}




void FUN_0000bbc8(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  
  iVar1 = FUN_00010db4();
  if (iVar1 == 0) {
    return;
  }
  do {
    iVar2 = *(int *)(iVar1 + 8);
    if (iVar2 == 0x13b) {
      FUN_00026a68(0,9,param_2,0);
LAB_0000bc14:
      iVar1 = FUN_00010d84(iVar1);
    }
    else {
      if (iVar2 < 0x13c) {
        if (iVar2 == 0x109) {
          FUN_00026a68(0,1,param_2,0,0x109,param_4);
        }
        else if (iVar2 == 0x110) {
          FUN_00026a68(0,0xd,param_2,0,0x109,param_4);
        }
        else {
          if (iVar2 != 0x105) goto LAB_0000bc08;
          FUN_00026a68(0,3,param_2,0,0x105,param_4);
        }
        goto LAB_0000bc14;
      }
      if (iVar2 == 0x162) {
        FUN_00026a68(0,8,param_2,0);
        goto LAB_0000bc14;
      }
      if (iVar2 == 0x17e) {
        FUN_00026a68(0,0xb,param_2,0,0x17e,param_4);
        goto LAB_0000bc14;
      }
      if (iVar2 != 0x155) {
LAB_0000bc08:
        FUN_0004fe78(3,"can not apply enable/disable token %d, unknown");
        goto LAB_0000bc14;
      }
      FUN_00026a68(0,10,param_2,0,0x155,param_4);
      iVar1 = FUN_00010d84(iVar1);
    }
    if (iVar1 == 0) {
      return;
    }
  } while( true );
}




undefined4 FUN_0000bd2c(char *param_1,ushort *param_2,int *param_3,int param_4)

{
  size_t sVar1;
  int iVar2;
  char *pcVar3;
  undefined *puVar4;
  char *__dest;
  addrinfo *local_460;
  ushort auStack_45c [14];
  addrinfo local_440;
  char acStack_420 [1028];
  
  local_440.ai_socktype = 0;
  local_440.ai_protocol = 0;
  local_440.ai_flags = 0;
  local_440.ai_addrlen = 0;
  local_440.ai_family = 0;
  local_440.ai_addr = (sockaddr *)0x0;
  local_440.ai_canonname = (char *)0x0;
  local_440.ai_next = (addrinfo *)0x0;
  sVar1 = strlen(param_1);
  if (0x3ff < sVar1) {
    (*DAT_0007c9fc)("ntp_config.c",0x10f1,2,"strlen(nameornum) < sizeof(lookbuf)");
    return 0;
  }
  iVar2 = FUN_00014720(param_1,auStack_45c);
  __dest = param_1;
  if (iVar2 != 0) {
    local_440.ai_flags = 4;
    local_440.ai_family = (int)auStack_45c[0];
    if (*param_1 == '[') {
      __dest = acStack_420;
      strncpy(__dest,param_1 + 1,0x400);
      pcVar3 = strchr(__dest,0x5d);
      if (pcVar3 != (char *)0x0) {
        *pcVar3 = '\0';
      }
      pcVar3 = strchr(__dest,0x25);
      if (pcVar3 == (char *)0x0) goto LAB_0000be24;
    }
    else {
      pcVar3 = strchr(param_1,0x25);
      if (pcVar3 == (char *)0x0) goto LAB_0000be24;
      strncpy(acStack_420,param_1,0x400);
      pcVar3 = strchr(acStack_420,0x25);
    }
    __dest = acStack_420;
    *pcVar3 = '\0';
  }
LAB_0000be24:
  if (local_440.ai_family == 10) {
    if (DAT_000cb864 == 0) {
      return 0;
    }
  }
  else if (local_440.ai_family == 0) {
    if (DAT_000cb864 == 0) {
      local_440.ai_family = 2;
    }
    else if (DAT_000cb868 == 0) {
      local_440.ai_family = 10;
    }
    else if ((*param_2 & 0xfff7) == 2) {
      local_440.ai_family = (uint)*param_2;
    }
  }
  local_440.ai_socktype = 2;
  if (3 < DAT_0007cf4c) {
    if (local_440.ai_family == 0) {
      puVar4 = &DAT_000665cc;
    }
    else {
      puVar4 = &DAT_0005b5a0;
      if (local_440.ai_family == 2) {
        puVar4 = &DAT_0005b5a4;
      }
    }
    printf("getaddrinfo %s%s\n",puVar4,__dest);
  }
  iVar2 = getaddrinfo(__dest,"ntp",&local_440,&local_460);
  if ((iVar2 == 0) && ((local_460->ai_family != 10 || (DAT_000cb864 != 0)))) {
    *param_3 = (int)local_460;
    return 1;
  }
  if (param_4 == 0) {
    if (0 < DAT_0007cf4c) {
      printf("getaddrinfo: \"%s\" invalid host address.\n",__dest);
    }
  }
  else {
    FUN_0004fe78(3,"getaddrinfo: \"%s\" invalid host address, ignored",__dest);
  }
  if (iVar2 != 0) {
    return 0;
  }
  freeaddrinfo(local_460);
  return 0xffffffff;
}




void FUN_0000bff0(void)

{
  int iVar1;
  
  if (DAT_000c9d6c != (FILE *)0x0) {
    fclose(DAT_000c9d6c);
  }
  DAT_000c9d6c = (FILE *)0x0;
  iVar1 = unlink((char *)&DAT_0007cde4);
  if (iVar1 == 0) {
    return;
  }
  FUN_0004fe78(4,"Unable to remove temporary resolver file %s, %m",&DAT_0007cde4);
  return;
}




void FUN_0000c040(void)

{
  memset(&DAT_000c9cc0,0,0xa8);
  DAT_000c9ce4 = FUN_00010ed0();
  DAT_000c9ce8 = FUN_00010ed0();
  DAT_000c9cf8 = FUN_00010ed0();
  DAT_000c9cf0 = FUN_00010ed0();
  DAT_000c9cf4 = FUN_00010ed0();
  DAT_000c9cfc = FUN_00010ed0();
  DAT_000c9d04 = FUN_00010ed0();
  DAT_000c9d08 = FUN_00010ed0();
  DAT_000c9d0c = FUN_00010ed0();
  DAT_000c9d18 = FUN_00010ed0();
  DAT_000c9d1c = FUN_00010ed0();
  DAT_000c9d14 = FUN_00010ed0();
  DAT_000c9d10 = FUN_00010ed0();
  DAT_000c9d44 = FUN_00010ed0();
  DAT_000c9d4c = FUN_00010ed0();
  DAT_000c9d48 = FUN_00010ed0();
  DAT_000c9d50 = FUN_00010ed0();
  DAT_000c9d54 = FUN_00010ed0();
  DAT_000c9d58 = FUN_00010ed0();
  DAT_000c9d5c = FUN_00010ed0();
  DAT_000c9d60 = FUN_00010ed0();
  DAT_000c9d28 = FUN_00010ed0();
  DAT_000c9d3c = FUN_00010ed0();
  return;
}




int FUN_0000c118(undefined4 param_1,void *param_2)

{
  int iVar1;
  undefined4 uVar2;
  addrinfo *__ai;
  addrinfo *local_1c [2];
  
  iVar1 = FUN_0000bd2c(param_1,param_2,local_1c,1);
  __ai = local_1c[0];
  if (iVar1 == 1) {
    memcpy(param_2,local_1c[0]->ai_addr,local_1c[0]->ai_addrlen);
    if (1 < DAT_0007cf4c) {
      uVar2 = FUN_00050cd0(param_2);
      printf("getnetnum given %s, got %s\n",param_1,uVar2);
      __ai = local_1c[0];
    }
    freeaddrinfo(__ai);
  }
  return iVar1;
}




int FUN_0000c1a0(char *param_1)

{
  int iVar1;
  size_t __n;
  char *__s2;
  char *pcVar2;
  char *__s1;
  int *piVar3;
  
  piVar3 = (int *)&DAT_00079430;
  pcVar2 = DAT_00079430;
  if (DAT_00079430 != (char *)0x0) {
    do {
      iVar1 = strcmp(param_1,pcVar2);
      if (iVar1 == 0) {
        if (piVar3[1] != 0) {
          return piVar3[1];
        }
        break;
      }
      piVar3 = piVar3 + 2;
      pcVar2 = (char *)*piVar3;
    } while ((char *)*piVar3 != (char *)0x0);
  }
  pcVar2 = DAT_00079480;
  __s1 = param_1;
  if (DAT_00079480 != (char *)0x0) {
    piVar3 = (int *)&DAT_00079480;
    do {
      __n = strlen(pcVar2);
      iVar1 = strncmp(param_1,pcVar2,__n);
      if (iVar1 == 0) {
        pcVar2 = (char *)piVar3[1];
        __s1 = param_1 + __n;
        break;
      }
      piVar3 = piVar3 + 2;
      pcVar2 = (char *)*piVar3;
    } while (pcVar2 != (char *)0x0);
  }
  if (pcRam000794a8 != (char *)0x0) {
    piVar3 = (int *)0x794a8;
    __s2 = pcRam000794a8;
    do {
      iVar1 = strcmp(__s1,__s2);
      if (iVar1 == 0) {
        if (piVar3[1] != 0) {
          return piVar3[1] << ((uint)pcVar2 & 0xff);
        }
        break;
      }
      piVar3 = piVar3 + 2;
      __s2 = (char *)*piVar3;
    } while (__s2 != (char *)0x0);
  }
  FUN_0004fe78(3,"logconfig: \'%s\' not recognized - ignored",param_1);
  return 0;
}




undefined4 FUN_0000c2a8(int param_1,FILE *param_2,int param_3)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  size_t sVar6;
  void *__ptr;
  void *__ptr_00;
  tm *__tp;
  char *pcVar7;
  int iVar8;
  undefined4 *puVar9;
  bool bVar10;
  double dVar11;
  char local_78 [84];
  
  if (0 < DAT_0007cf4c) {
    printf("dump_config_tree(%p)\n",param_1);
  }
  if (param_3 != 0) {
    __tp = localtime((time_t *)(param_1 + 0x20));
    sVar6 = strftime(local_78,0x50,"%Y-%m-%d %H:%M:%S",__tp);
    if (sVar6 == 0) {
      local_78[0] = '\0';
    }
    pcVar7 = "startup configuration file";
    if (*(int *)(param_1 + 8) == 1) {
      pcVar7 = "ntpq remote config from";
    }
    fprintf(param_2,"# %s %s %s\n",local_78,pcVar7,*(undefined4 *)(param_1 + 0x10));
  }
  for (piVar1 = (int *)FUN_00010db4(*(undefined4 *)(param_1 + 0x9c)); piVar1 != (int *)0x0;
      piVar1 = (int *)FUN_00010d84(piVar1)) {
LAB_0000c33c:
    iVar8 = *piVar1;
    if (iVar8 == 0x146) {
LAB_0000c364:
      uVar3 = FUN_000182b8();
      fprintf(param_2,"%s \"%s\"\n",uVar3,piVar1[2]);
      piVar1 = (int *)FUN_00010d84(piVar1);
      if (piVar1 == (int *)0x0) break;
      goto LAB_0000c33c;
    }
    if (iVar8 < 0x147) {
      if (iVar8 == 0x111) {
        uVar3 = FUN_000182b8();
        fprintf(param_2,"%s %d\n",uVar3,piVar1[2]);
        goto LAB_0000c32c;
      }
      if (iVar8 < 0x112) {
        if (iVar8 == 0x10e) {
LAB_0000c894:
          uVar3 = FUN_000182b8();
          fprintf(param_2,"%s %g\n",uVar3);
          goto LAB_0000c32c;
        }
        goto LAB_0000c318;
      }
      if ((iVar8 != 0x11f) && (iVar8 != 0x141)) goto LAB_0000c318;
      goto LAB_0000c364;
    }
    if (iVar8 == 0x179) goto LAB_0000c364;
    if (iVar8 < 0x17a) {
      if (iVar8 != 0x16b) goto LAB_0000c318;
      goto LAB_0000c364;
    }
    if ((iVar8 == 0x185) || (iVar8 == 0x193)) goto LAB_0000c894;
LAB_0000c318:
    uVar3 = FUN_0001821c();
    fprintf(param_2,"\n# dump error:\n# unknown vars token %s\n",uVar3);
LAB_0000c32c:
  }
  puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x84));
  if (puVar2 != (undefined4 *)0x0) {
    fwrite("logconfig",1,9,param_2);
    do {
      fprintf(param_2," %c%s",*puVar2,puVar2[2]);
      puVar2 = (undefined4 *)FUN_00010d84(puVar2);
    } while (puVar2 != (undefined4 *)0x0);
    fputc(10,param_2);
  }
  if (*(int *)(param_1 + 0x40) != 0) {
    fprintf(param_2,"statsdir \"%s\"\n");
  }
  puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x3c));
  if (puVar2 != (undefined4 *)0x0) {
    fwrite("statistics",1,10,param_2);
    do {
      uVar3 = FUN_000182b8(*puVar2);
      fprintf(param_2," %s",uVar3);
      puVar2 = (undefined4 *)FUN_00010d84(puVar2);
    } while (puVar2 != (undefined4 *)0x0);
    fputc(10,param_2);
  }
  for (puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x44)); puVar2 != (undefined4 *)0x0;
      puVar2 = (undefined4 *)FUN_00010d84(puVar2)) {
    piVar1 = (int *)FUN_00010db4(puVar2[1]);
    if (piVar1 != (int *)0x0) {
      uVar3 = FUN_000182b8(*puVar2);
      fprintf(param_2,"filegen %s",uVar3);
      do {
        while (iVar8 = *piVar1, iVar8 != 399) {
          if (iVar8 == 0x198) {
            uVar3 = FUN_000182b8(piVar1[2]);
            fprintf(param_2," %s",uVar3);
          }
          else if (iVar8 == 0x125) {
            fprintf(param_2," file %s",piVar1[2]);
          }
          else {
            uVar3 = FUN_0001821c(iVar8);
            uVar4 = FUN_000182b8(*puVar2);
            fprintf(param_2,"\n# dump error:\n# unknown filegen option token %s\nfilegen %s",uVar3,uVar4);
          }
          piVar1 = (int *)FUN_00010d84(piVar1);
          if (piVar1 == (int *)0x0) goto LAB_0000c510;
        }
        uVar3 = FUN_000182b8(piVar1[2]);
        fprintf(param_2," type %s",uVar3);
        piVar1 = (int *)FUN_00010d84(piVar1);
      } while (piVar1 != (int *)0x0);
    }
LAB_0000c510:
    fputc(10,param_2);
  }
  puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x68));
  if (puVar2 != (undefined4 *)0x0) {
    fwrite("crypto",1,6,param_2);
    do {
      uVar3 = FUN_000182b8(*puVar2);
      fprintf(param_2," %s %s",uVar3,puVar2[2]);
      puVar2 = (undefined4 *)FUN_00010d84(puVar2);
    } while (puVar2 != (undefined4 *)0x0);
    fputc(10,param_2);
  }
  if (*(int *)(param_1 + 0x78) != 0) {
    fprintf(param_2,"revoke %d\n");
  }
  if (*(int *)(param_1 + 0x70) != 0) {
    fprintf(param_2,"keysdir \"%s\"\n");
  }
  if (*(int *)(param_1 + 0x6c) != 0) {
    fprintf(param_2,"keys \"%s\"\n");
  }
  piVar1 = (int *)FUN_00010db4(*(undefined4 *)(param_1 + 0x7c));
  if (piVar1 != (int *)0x0) {
    fwrite("trustedkey",1,10,param_2);
    do {
      while (iVar8 = *piVar1, iVar8 == 0x69) {
        fprintf(param_2," %d",piVar1[2]);
LAB_0000c5f0:
        piVar1 = (int *)FUN_00010d84(piVar1);
        if (piVar1 == (int *)0x0) goto LAB_0000c648;
      }
      if (iVar8 != 0x2d) {
        fprintf(param_2,"\n# dump error:\n# unknown trustedkey attr %d\ntrustedkey",iVar8);
        goto LAB_0000c5f0;
      }
      fprintf(param_2," (%u ... %u)",(uint)piVar1[2] >> 0x10,piVar1[2] & 0xffff);
      piVar1 = (int *)FUN_00010d84(piVar1);
    } while (piVar1 != (int *)0x0);
LAB_0000c648:
    fputc(10,param_2);
  }
  if (*(int *)(param_1 + 0x60) != 0) {
    fprintf(param_2,"controlkey %d\n");
  }
  if (*(int *)(param_1 + 0x74) != 0) {
    fprintf(param_2,"requestkey %d\n");
  }
  iVar8 = 1;
  do {
    if (iVar8 == 0) {
      iVar5 = FUN_00010db4(*(undefined4 *)(param_1 + 0x5c));
      if (iVar5 != 0) {
        pcVar7 = "disable";
        goto LAB_0000c68c;
      }
    }
    else {
      iVar5 = FUN_00010db4(*(undefined4 *)(param_1 + 0x58));
      if (iVar5 != 0) {
        pcVar7 = "enable";
LAB_0000c68c:
        fprintf(param_2,pcVar7);
        do {
          uVar3 = FUN_000182b8(*(undefined4 *)(iVar5 + 8));
          fprintf(param_2," %s",uVar3);
          iVar5 = FUN_00010d84(iVar5);
        } while (iVar5 != 0);
        fputc(10,param_2);
      }
    }
    bVar10 = iVar8 == 0;
    iVar8 = iVar8 + -1;
    if (bVar10) {
      puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x38));
      if (puVar2 != (undefined4 *)0x0) {
        fwrite(&DAT_0005b8a0,1,3,param_2);
        do {
          switch(*puVar2) {
          case 0x10a:
          case 0x112:
          case 0x114:
          case 300:
          case 0x14c:
          case 0x14f:
          case 0x153:
          case 0x165:
            uVar3 = FUN_000182b8();
            fprintf(param_2," %s %d",uVar3,(int)(longlong)*(double *)(puVar2 + 2));
            break;
          default:
            uVar3 = FUN_0001821c();
            fprintf(param_2,"\n# dump error:\n# unknown tos token %s\ntos",uVar3);
            break;
          case 0x14d:
          case 0x150:
            uVar3 = FUN_000182b8();
            fprintf(param_2," %s %g",uVar3);
          }
          puVar2 = (undefined4 *)FUN_00010d84(puVar2);
        } while (puVar2 != (undefined4 *)0x0);
      }
      iVar8 = FUN_00010db4(*(undefined4 *)(param_1 + 0x38));
      if (iVar8 != 0) {
        fputc(10,param_2);
      }
      puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x54));
      if (puVar2 != (undefined4 *)0x0) {
        fwrite("tinker",1,6,param_2);
        do {
          uVar3 = FUN_000182b8(*puVar2);
          fprintf(param_2," %s %g",uVar3);
          puVar2 = (undefined4 *)FUN_00010d84(puVar2);
        } while (puVar2 != (undefined4 *)0x0);
        fputc(10,param_2);
      }
      if (*(int *)(param_1 + 0x2c) != 0) {
        fwrite("broadcastclient\n",1,0x10,param_2);
      }
      for (puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x24)); puVar2 != (undefined4 *)0x0;
          puVar2 = (undefined4 *)FUN_00010d84(puVar2)) {
        puVar9 = (undefined4 *)puVar2[1];
        pcVar7 = (char *)FUN_000182b8(*puVar2);
        fputs(pcVar7,param_2);
        iVar8 = puVar9[1];
        if (iVar8 == 2) {
          fwrite(&DAT_0005b930,1,3,param_2);
        }
        else if (iVar8 == 10) {
          fwrite(&DAT_0005b934,1,3,param_2);
        }
        else if (iVar8 != 0) {
          fprintf(param_2,"# dump error:\n# unknown peer family %d for:\npeer");
        }
        fprintf(param_2," %s",*puVar9);
        if (puVar2[3] != 0) {
          fprintf(param_2," minpoll %d");
        }
        if (puVar2[4] != 0) {
          fprintf(param_2," maxpoll %d");
        }
        iVar8 = puVar2[5];
        if (iVar8 != 0) {
          pcVar7 = (char *)*puVar9;
          sVar6 = strlen(pcVar7);
          if ((sVar6 < 9) || (iVar5 = memcmp(pcVar7,"127.127.",8), iVar5 != 0)) {
            fprintf(param_2," ttl %d",iVar8);
          }
          else {
            fprintf(param_2," mode %d",iVar8);
          }
        }
        if (puVar2[6] != 4) {
          fprintf(param_2," version %d");
        }
        if (puVar2[7] == 0) {
          dVar11 = *(double *)(puVar2 + 8);
        }
        else {
          fprintf(param_2," key %d");
          dVar11 = *(double *)(puVar2 + 8);
        }
        if (dVar11 != 0.0) {
          fprintf(param_2," bias %g",SUB84(dVar11,0),(int)((ulonglong)dVar11 >> 0x20));
        }
        for (piVar1 = (int *)FUN_00010db4(puVar2[2]); piVar1 != (int *)0x0; piVar1 = (int *)FUN_00010d84(piVar1)) {
          if (*piVar1 != 0x198) {
            (*DAT_0007c9fc)("ntp_config.c",0x35d,2,"408 == atrv->attr");
          }
          if (piVar1[4] != 0x135) {
            (*DAT_0007c9fc)("ntp_config.c",0x35e,2,"309 == atrv->type");
          }
          uVar3 = FUN_000182b8(piVar1[2]);
          fprintf(param_2," %s",uVar3);
        }
        fputc(10,param_2);
        for (puVar9 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x50)); puVar9 != (undefined4 *)0x0;
            puVar9 = (undefined4 *)FUN_00010d84(puVar9)) {
          while( true ) {
            pcVar7 = *(char **)*puVar9;
            iVar8 = strcmp(*(char **)puVar2[1],pcVar7);
            if (iVar8 != 0) break;
            fprintf(param_2,"fudge %s",pcVar7);
            for (piVar1 = (int *)FUN_00010db4(puVar9[1]); piVar1 != (int *)0x0; piVar1 = (int *)FUN_00010d84(piVar1)) {
              while (iVar8 = *piVar1, iVar8 != 0x175) {
                if (iVar8 < 0x176) {
                  if (iVar8 - 0x127U < 4) {
LAB_0000cef4:
                    uVar3 = FUN_000182b8();
                    fprintf(param_2," %s %d",uVar3,piVar1[2]);
                  }
                  else {
LAB_0000cbd0:
                    uVar3 = FUN_0001821c();
                    fprintf(param_2,"\n# dump error:\n# unknown fudge option %s\nfudge %s",uVar3,*(undefined4 *)*puVar9)
                    ;
                  }
                  goto LAB_0000cbec;
                }
                if (iVar8 == 0x182) goto LAB_0000cef4;
                if ((iVar8 < 0x182) || (1 < iVar8 - 0x186U)) goto LAB_0000cbd0;
                uVar3 = FUN_000182b8();
                fprintf(param_2," %s %g",uVar3);
                piVar1 = (int *)FUN_00010d84(piVar1);
                if (piVar1 == (int *)0x0) goto LAB_0000cc54;
              }
              uVar3 = FUN_000182b8(0x175);
              fprintf(param_2," %s %s",uVar3,piVar1[2]);
LAB_0000cbec:
            }
LAB_0000cc54:
            fputc(10,param_2);
            puVar9 = (undefined4 *)FUN_00010d84(puVar9);
            if (puVar9 == (undefined4 *)0x0) goto LAB_0000cc70;
          }
        }
LAB_0000cc70:
      }
      puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x30));
      if (puVar2 != (undefined4 *)0x0) {
        pcVar7 = "manycastserver %s";
        while( true ) {
          fprintf(param_2,pcVar7,*puVar2);
          puVar2 = (undefined4 *)FUN_00010d84(puVar2);
          if (puVar2 == (undefined4 *)0x0) break;
          pcVar7 = " %s";
        }
        fputc(10,param_2);
      }
      puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x34));
      if (puVar2 != (undefined4 *)0x0) {
        pcVar7 = "multicastclient %s";
        while( true ) {
          fprintf(param_2,pcVar7,*puVar2);
          puVar2 = (undefined4 *)FUN_00010d84(puVar2);
          if (puVar2 == (undefined4 *)0x0) break;
          pcVar7 = " %s";
        }
        fputc(10,param_2);
      }
      for (iVar8 = FUN_00010db4(*(undefined4 *)(param_1 + 0x28)); iVar8 != 0; iVar8 = FUN_00010d84(iVar8)) {
        fprintf(param_2,"unpeer %s\n",**(undefined4 **)(iVar8 + 4));
      }
      puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x48));
      if (puVar2 != (undefined4 *)0x0) {
        fwrite("discard",1,7,param_2);
        do {
          uVar3 = FUN_000182b8(*puVar2);
          fprintf(param_2," %s %d",uVar3,puVar2[2]);
          puVar2 = (undefined4 *)FUN_00010d84(puVar2);
        } while (puVar2 != (undefined4 *)0x0);
        fputc(10,param_2);
      }
      for (puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x4c)); puVar2 != (undefined4 *)0x0;
          puVar2 = (undefined4 *)FUN_00010d84(puVar2)) {
        if ((undefined4 *)*puVar2 == (undefined4 *)0x0) {
          pcVar7 = "default";
        }
        else {
          pcVar7 = *(char **)*puVar2;
        }
        fprintf(param_2,"restrict %s",pcVar7);
        if ((undefined4 *)puVar2[1] != (undefined4 *)0x0) {
          fprintf(param_2," mask %s",*(undefined4 *)puVar2[1]);
        }
        for (puVar9 = (undefined4 *)FUN_00010db4(puVar2[2]); puVar9 != (undefined4 *)0x0;
            puVar9 = (undefined4 *)FUN_00010d84(puVar9)) {
          uVar3 = FUN_000182b8(*puVar9);
          fprintf(param_2," %s",uVar3);
        }
        fputc(10,param_2);
      }
      for (piVar1 = (int *)FUN_00010db4(*(undefined4 *)(param_1 + 0xa0)); piVar1 != (int *)0x0;
          piVar1 = (int *)FUN_00010d84(piVar1)) {
        uVar3 = FUN_000182b8(piVar1[2]);
        if (*piVar1 == 0) {
          iVar8 = piVar1[1];
        }
        else {
          iVar8 = FUN_000182b8();
        }
        fprintf(param_2,"interface %s %s\n",uVar3,iVar8);
      }
      puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x8c));
      if (puVar2 != (undefined4 *)0x0) {
        fwrite("phone",1,5,param_2);
        do {
          fprintf(param_2," %s",*puVar2);
          puVar2 = (undefined4 *)FUN_00010d84(puVar2);
        } while (puVar2 != (undefined4 *)0x0);
        fputc(10,param_2);
      }
      iVar8 = FUN_00010db4(*(undefined4 *)(param_1 + 0x88));
      if (iVar8 != 0) {
        fwrite(&DAT_0005ba54,1,3,param_2);
        do {
          fprintf(param_2," %s",*(undefined4 *)(iVar8 + 8));
          iVar8 = FUN_00010d84(iVar8);
        } while (iVar8 != 0);
        fputc(10,param_2);
      }
      for (puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x90)); puVar2 != (undefined4 *)0x0;
          puVar2 = (undefined4 *)FUN_00010d84(puVar2)) {
        __ptr = (void *)FUN_000184fc(*puVar2);
        __ptr_00 = (void *)FUN_000184fc(puVar2[1]);
        fprintf(param_2,"setvar %s = %s",__ptr,__ptr_00);
        free(__ptr);
        free(__ptr_00);
        if (puVar2[2] != 0) {
          fwrite(" default",1,8,param_2);
        }
        fputc(10,param_2);
      }
      puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x94));
      if (puVar2 != (undefined4 *)0x0) {
        fwrite(&DAT_0005ba74,1,3,param_2);
        do {
          fprintf(param_2," %d",*puVar2);
          puVar2 = (undefined4 *)FUN_00010d84(puVar2);
        } while (puVar2 != (undefined4 *)0x0);
        fputc(10,param_2);
      }
      puVar2 = (undefined4 *)FUN_00010db4(*(undefined4 *)(param_1 + 0x98));
      do {
        if (puVar2 == (undefined4 *)0x0) {
          return 0;
        }
        puVar9 = (undefined4 *)*puVar2;
        fprintf(param_2,"trap %s",*puVar9);
        for (piVar1 = (int *)FUN_00010db4(puVar2[1]); piVar1 != (int *)0x0; piVar1 = (int *)FUN_00010d84(piVar1)) {
          while (iVar8 = *piVar1, iVar8 != 0x136) {
            if (iVar8 == 0x16d) {
              fprintf(param_2," port %d",piVar1[2]);
            }
            else {
              fprintf(param_2,"\n# dump error:\n# unknown trap token %d\ntrap %s",iVar8,*puVar9);
            }
            piVar1 = (int *)FUN_00010d84(piVar1);
            if (piVar1 == (int *)0x0) goto LAB_0000d1c0;
          }
          puVar9 = (undefined4 *)piVar1[2];
          fprintf(param_2," interface %s",*puVar9);
        }
LAB_0000d1c0:
        fputc(10,param_2);
        puVar2 = (undefined4 *)FUN_00010d84(puVar2);
      } while( true );
    }
  } while( true );
}




uint FUN_0000d3e0(undefined4 param_1,undefined4 param_2)

{
  uint uVar1;
  int *piVar2;
  uint uVar3;
  
  if (DAT_0007cdf8 == (int *)0x0) {
    uVar3 = 0;
  }
  else {
    uVar3 = 0;
    piVar2 = DAT_0007cdf8;
    do {
      uVar1 = FUN_0000c2a8(piVar2,param_1,param_2);
      piVar2 = (int *)*piVar2;
      uVar3 = uVar3 | uVar1;
    } while (piVar2 != (int *)0x0);
  }
  return uVar3;
}




void FUN_0000d434(void)

{
  char cVar1;
  uint uVar2;
  addrinfo *paVar3;
  undefined4 *__dest;
  FILE *pFVar4;
  int iVar5;
  undefined4 *puVar6;
  int iVar7;
  int *piVar8;
  char *pcVar9;
  size_t sVar10;
  size_t sVar11;
  int __fd;
  int iVar12;
  undefined4 *puVar13;
  uint uVar14;
  ushort uVar15;
  undefined4 uVar16;
  int iVar17;
  uint uVar18;
  undefined4 uVar19;
  char *pcVar20;
  int *piVar21;
  byte bVar22;
  undefined1 uVar23;
  int iVar24;
  int iVar25;
  int iVar26;
  bool bVar27;
  uint local_174;
  addrinfo *local_170;
  short asStack_16c [14];
  uint local_150;
  undefined4 local_14c;
  undefined4 local_148;
  undefined4 local_144;
  undefined4 local_140;
  undefined4 local_13c;
  undefined4 local_138;
  uint local_134;
  undefined4 local_130;
  undefined4 local_12c;
  undefined4 local_128;
  undefined4 local_124;
  undefined4 local_120;
  undefined4 local_11c;
  undefined4 local_118;
  undefined4 local_114;
  undefined4 local_110;
  undefined4 local_10c;
  undefined4 local_108;
  undefined4 local_104;
  undefined4 local_100;
  undefined4 local_fc;
  int *local_f8;
  int *local_f4;
  int *local_f0;
  int *local_ec;
  int *local_e8;
  int *local_e4;
  uint local_e0;
  undefined4 local_dc;
  undefined4 local_d8;
  undefined4 local_d4;
  undefined4 local_d0;
  undefined4 local_cc;
  undefined4 local_c8;
  uint local_c4;
  uint local_c0;
  uint local_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  uint local_a8;
  int local_a4;
  int local_a0;
  int local_9c;
  int local_98;
  int local_94;
  int local_90;
  uint local_8c;
  uint local_88;
  undefined4 local_84;
  undefined4 local_80;
  undefined4 local_7c;
  undefined4 local_78;
  undefined4 local_74;
  undefined1 uStack_70;
  byte local_6f;
  byte local_6e;
  int local_48;
  int local_44;
  int local_40;
  int local_3c;
  int local_38;
  undefined4 local_34 [4];
  
  __dest = (undefined4 *)FUN_0004f524(0xa8);
  memcpy(__dest,&DAT_000c9cc0,0xa8);
  memset(&DAT_000c9cc0,0,0xa8);
  puVar6 = DAT_0007cdf8;
  if (DAT_0007cdf8 == (undefined4 *)0x0) {
    puVar13 = &DAT_0007cdf8;
  }
  else {
    do {
      puVar13 = puVar6;
      puVar6 = (undefined4 *)*puVar13;
    } while ((undefined4 *)*puVar13 != (undefined4 *)0x0);
  }
  *__dest = 0;
  *puVar13 = __dest;
  if ((*(uint *)(DAT_0007954c + 0x590) & 0xf) != 0) {
    pFVar4 = fopen(*(char **)(DAT_0007954c + 0x598),"w");
    if (pFVar4 == (FILE *)0x0) {
      piVar8 = __errno_location();
      pFVar4 = stderr;
      uVar19 = *(undefined4 *)(DAT_0007954c + 0x598);
      iVar5 = *piVar8;
      pcVar9 = strerror(iVar5);
      fprintf(pFVar4,"can not create save file %s, error %d %s\n",uVar19,iVar5,pcVar9);
                    /* WARNING: Subroutine does not return */
      exit(iVar5);
    }
    iVar5 = FUN_0000d3e0(pFVar4,0);
    if (iVar5 == 0) {
      fprintf(stderr,"configuration saved to %s\n",*(undefined4 *)(DAT_0007954c + 0x598));
    }
    else {
      fprintf(stderr,"--saveconfigquit %s error %d\n",*(undefined4 *)(DAT_0007954c + 0x598),iVar5);
    }
                    /* WARNING: Subroutine does not return */
    exit(iVar5);
  }
  piVar8 = (int *)FUN_00010db4(__dest[0x28]);
  if (piVar8 != (int *)0x0) {
    if (((*(uint *)(DAT_0007954c + 0x390) & 0xf) == 0) && ((*(uint *)(DAT_0007954c + 0x2d0) & 0xf) == 0)) {
      do {
        pcVar9 = (char *)piVar8[1];
        local_174 = 0xffffffff;
        if (pcVar9 != (char *)0x0) {
          pcVar9 = (char *)FUN_0004f4e8(pcVar9);
        }
        iVar5 = *piVar8;
        if (iVar5 == 0x137) {
          uVar19 = 1;
        }
        else if (iVar5 < 0x138) {
          if (iVar5 == 0) {
            if (pcVar9 == (char *)0x0) {
              (*DAT_0007c9fc)("ntp_config.c",0x9b9,2,"if_name != ((void *)0)");
            }
            pcVar20 = strchr(pcVar9,0x2f);
            if (pcVar20 == (char *)0x0) {
              iVar5 = FUN_00014720(pcVar9,asStack_16c);
              if (iVar5 == 0) {
                uVar19 = 4;
              }
              else {
                uVar19 = 5;
              }
            }
            else {
              *pcVar20 = '\0';
              iVar5 = FUN_00014720(pcVar9,asStack_16c);
              if (iVar5 == 0) {
                uVar19 = 4;
                *pcVar20 = '/';
              }
              else {
                uVar19 = 5;
                sscanf(pcVar20 + 1,"%d",&local_174);
                uVar18 = local_174 | (int)local_174 >> 0x1f;
                if (asStack_16c[0] == 2) {
                  local_174 = 0x20;
                }
                else {
                  local_174 = 0x80;
                }
                if ((int)uVar18 < (int)local_174) {
                  local_174 = uVar18;
                }
              }
            }
          }
          else {
            if (iVar5 != 0x103) goto LAB_0000d560;
            uVar19 = 0;
          }
        }
        else if (iVar5 == 0x139) {
          uVar19 = 2;
        }
        else if (iVar5 == 0x195) {
          uVar19 = 3;
        }
        else {
LAB_0000d560:
          uVar19 = 0;
          (*DAT_0007c9fc)("ntp_config.c",0x9af,2,"0");
        }
        iVar5 = piVar8[2];
        if (iVar5 == 0x133) {
          uVar16 = 1;
        }
        else {
          if (iVar5 != 0x144) {
            if (iVar5 == 0x120) {
              uVar16 = 2;
              goto LAB_0000d5bc;
            }
            (*DAT_0007c9fc)("ntp_config.c",0x9e9,2,"0");
          }
          uVar16 = 0;
        }
LAB_0000d5bc:
        FUN_000148dc(uVar19,pcVar9,local_174,uVar16);
        FUN_0002d720(DAT_000cb548 + 2);
        if (pcVar9 != (char *)0x0) {
          free(pcVar9);
        }
        piVar8 = (int *)FUN_00010d84(piVar8);
      } while (piVar8 != (int *)0x0);
    }
    else {
      pcVar9 = "";
      if (DAT_000794d8 != 0) {
        pcVar9 = ", exiting";
      }
      FUN_0004fe78(3,"interface/nic rules are not allowed with --interface (-I) or --novirtualips (-L)%s",pcVar9);
      if (DAT_000794d8 != 0) {
LAB_0000d968:
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
    }
  }
  FUN_000142b8();
  if (__dest[0x10] != 0) {
    FUN_0002e368(2);
  }
  for (puVar6 = (undefined4 *)FUN_00010db4(__dest[0xf]); puVar6 != (undefined4 *)0x0;
      puVar6 = (undefined4 *)FUN_00010d84(puVar6)) {
    uVar19 = FUN_000182b8(*puVar6);
    iVar5 = FUN_0001e278();
    if (3 < DAT_0007cf4c) {
      printf("enabling filegen for %s statistics \'%s%s\'\n",uVar19,*(undefined4 *)(iVar5 + 4),
             *(undefined4 *)(iVar5 + 8));
    }
    *(byte *)(iVar5 + 0x11) = ~((byte)~(byte)(((uint)*(byte *)(iVar5 + 0x11) << 0x19) >> 0x18) >> 1);
  }
  for (puVar6 = (undefined4 *)FUN_00010db4(__dest[0x11]); puVar6 != (undefined4 *)0x0;
      puVar6 = (undefined4 *)FUN_00010d84(puVar6)) {
    iVar5 = FUN_000182b8(*puVar6);
    iVar7 = FUN_0001e278();
    bVar22 = *(byte *)(iVar7 + 0x11);
    uVar23 = *(undefined1 *)(iVar7 + 0x10);
    piVar8 = (int *)FUN_00010db4(puVar6[1]);
    bVar22 = bVar22 | 0x80;
    if (piVar8 != (int *)0x0) {
LAB_0000d750:
      iVar12 = *piVar8;
      if (iVar12 == 399) {
        iVar12 = piVar8[2];
        if (iVar12 == 0x15b) {
          uVar23 = 0xff;
        }
        else if (iVar12 < 0x15c) {
          if (iVar12 == 0x118) {
            uVar23 = 2;
          }
          else if (iVar12 == 0x156) {
            uVar23 = 4;
          }
          else {
            if (iVar12 != 0x102) goto LAB_0000d7c8;
            uVar23 = 6;
          }
        }
        else if (iVar12 == 0x194) {
          uVar23 = 3;
        }
        else if (iVar12 == 0x197) {
          uVar23 = 5;
        }
        else if (iVar12 == 0x16a) {
          uVar23 = 1;
        }
        else {
LAB_0000d7c8:
          (*DAT_0007c9fc)("ntp_config.c",0x808,2,"0");
        }
      }
      else {
        if (iVar12 != 0x198) {
          if (iVar12 != 0x125) {
            FUN_0004fe78(3,"Unknown filegen option token %d");
                    /* WARNING: Subroutine does not return */
            exit(1);
          }
          iVar5 = piVar8[2];
          piVar8 = (int *)FUN_00010d84(piVar8);
          goto joined_r0x0000d934;
        }
        iVar12 = piVar8[2];
        if (iVar12 == 0x122) {
          bVar22 = bVar22 | 0x80;
        }
        else {
          if (iVar12 < 0x123) {
            if (iVar12 == 0x11b) {
              bVar22 = bVar22 & 0x7f;
              goto LAB_0000d7e8;
            }
LAB_0000d95c:
            FUN_0004fe78(3,"Unknown filegen flag token %d");
            goto LAB_0000d968;
          }
          if (iVar12 == 0x143) {
            bVar22 = bVar22 | 1;
          }
          else {
            if (iVar12 != 0x159) goto LAB_0000d95c;
            bVar22 = bVar22 & 0xfe;
          }
        }
      }
LAB_0000d7e8:
      piVar8 = (int *)FUN_00010d84(piVar8);
joined_r0x0000d934:
      if (piVar8 == (int *)0x0) goto LAB_0000d7f8;
      goto LAB_0000d750;
    }
LAB_0000d7f8:
    FUN_0001e100(iVar7,iVar5,uVar23,bVar22);
  }
  iVar5 = __dest[0x1c];
  if (iVar5 != 0) {
    if (DAT_000794dc != &DAT_000794e0) {
      free(DAT_000794dc);
      iVar5 = __dest[0x1c];
    }
    DAT_000794dc = (undefined *)FUN_0004f4e8(iVar5);
  }
  iVar5 = __dest[0x20];
  if (iVar5 != 0) {
    if (DAT_000794e8 != &DAT_0007cdfc) {
      free(DAT_000794e8);
      iVar5 = __dest[0x20];
    }
    DAT_000794e8 = (undefined *)FUN_0004f4e8(iVar5);
  }
  if (__dest[0x1b] != 0) {
    FUN_0002e1e8();
  }
  if (__dest[0x18] != 0) {
    DAT_000caab0 = __dest[0x18];
  }
  iVar5 = DAT_000cb50c;
  if ((__dest[0x1d] != 0) && (iVar5 = __dest[0x1d], 3 < DAT_0007cf4c)) {
    printf("set info_auth_keyid to %08lx\n");
    iVar5 = __dest[0x1d];
  }
  DAT_000cb50c = iVar5;
  for (piVar8 = (int *)FUN_00010db4(__dest[0x1f]); piVar8 != (int *)0x0; piVar8 = (int *)FUN_00010d84(piVar8)) {
    if (*piVar8 == 0x69) {
      FUN_0004de88(piVar8[2],1);
    }
    else if (*piVar8 == 0x2d) {
      uVar14 = piVar8[2];
      for (uVar18 = uVar14 >> 0x10; uVar18 <= (uVar14 & 0xffff); uVar18 = uVar18 + 1 & 0xffff) {
        FUN_0004de88(uVar18,1);
      }
    }
  }
  DAT_000cab88 = DAT_000cb50c;
  if (DAT_000cb50c == 0) {
    DAT_000cab88 = 0xffff;
  }
  iVar5 = FUN_0004dd08(DAT_000cab88);
  if (iVar5 == 0) {
    local_174 = FUN_000504ec();
    DAT_000cab84 = 4;
    DAT_000cab80 = 0x10;
    FUN_0004e0e4(DAT_000cab88,4,&local_174,4);
    FUN_0004de88(DAT_000cab88,1);
  }
  else {
    DAT_000cab80 = 0x10;
    DAT_000cab84 = DAT_000cb748;
  }
  DAT_000cb50c = DAT_000cab88;
  puVar6 = (undefined4 *)FUN_00010db4(__dest[0xe]);
  if (puVar6 != (undefined4 *)0x0) {
    uVar19 = 0xffffffff;
    do {
      switch(*puVar6) {
      case 0x10a:
        uVar19 = 0x19;
        break;
      default:
        (*DAT_0007c9fc)("ntp_config.c",0x781,2,"0");
        break;
      case 0x112:
        uVar19 = 0x12;
        break;
      case 0x114:
        uVar19 = 0x13;
        break;
      case 300:
        uVar19 = 0x11;
        break;
      case 0x14c:
        uVar19 = 0xf;
        break;
      case 0x14d:
        uVar19 = 0x16;
        break;
      case 0x14f:
        uVar19 = 0xe;
        break;
      case 0x150:
        uVar19 = 0x15;
        break;
      case 0x153:
        uVar19 = 0x10;
        break;
      case 0x165:
        uVar19 = 0x1a;
      }
      FUN_00026a68((int)*(undefined8 *)(puVar6 + 2),uVar19,0,0);
      puVar6 = (undefined4 *)FUN_00010d84(puVar6);
    } while (puVar6 != (undefined4 *)0x0);
  }
  piVar8 = (int *)FUN_00010db4(__dest[0x12]);
  while (piVar8 != (int *)0x0) {
    iVar5 = *piVar8;
    if (iVar5 == 0x151) {
      DAT_0007a1cc = piVar8[2];
    }
    else if (iVar5 == 0x155) {
      DAT_0007a1d0 = piVar8[2];
    }
    else {
      if (iVar5 != 0x108) {
        FUN_0004fe78(3,"Unknown discard option token %d");
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      DAT_0007a1c8 = piVar8[2];
    }
    piVar8 = (int *)FUN_00010d84();
  }
  for (piVar8 = (int *)FUN_00010db4(__dest[0x13]); piVar8 != (int *)0x0; piVar8 = (int *)FUN_00010d84(piVar8)) {
    local_150 = 0;
    local_14c = 0;
    local_148 = 0;
    local_144 = 0;
    local_140 = 0;
    local_13c = 0;
    local_138 = 0;
    if (*piVar8 == 0) {
      bVar27 = true;
      local_134 = 0;
      local_130 = 0;
      local_12c = 0;
      local_128 = 0;
      local_124 = 0;
      local_120 = 0;
      local_11c = 0;
LAB_0000dfc4:
      puVar6 = (undefined4 *)FUN_00010db4(piVar8[2]);
      if (puVar6 == (undefined4 *)0x0) {
        uVar18 = 0;
        uVar14 = 0;
        uVar19 = 0;
      }
      else {
        uVar19 = 0;
        uVar18 = 0;
        do {
          switch(*puVar6) {
          case 299:
            uVar18 = uVar18 | 0x1000;
            break;
          default:
            (*DAT_0007c9fc)("ntp_config.c",0x8d4,2,"0");
            break;
          case 0x133:
            uVar18 = uVar18 | 1;
            break;
          case 0x13f:
            uVar18 = uVar18 | 0x400;
            break;
          case 0x140:
            uVar18 = uVar18 | 0x800;
            break;
          case 0x142:
            uVar18 = uVar18 | 0x20;
            break;
          case 0x148:
            uVar18 = uVar18 | 0x200;
            break;
          case 0x15a:
            uVar18 = uVar18 | 0x80;
            break;
          case 0x15c:
            uVar18 = uVar18 | 0x10;
            break;
          case 0x15d:
            uVar18 = uVar18 | 0x40;
            break;
          case 0x15f:
            uVar18 = uVar18 | 2;
            break;
          case 0x160:
            uVar18 = uVar18 | 0x100;
            break;
          case 0x161:
            uVar18 = uVar18 | 4;
            break;
          case 0x163:
            uVar19 = 0x2000;
            break;
          case 0x192:
            uVar18 = uVar18 | 8;
          }
          puVar6 = (undefined4 *)FUN_00010d84(puVar6);
        } while (puVar6 != (undefined4 *)0x0);
        uVar14 = uVar18 & 0x800;
      }
      if (bVar27) {
        local_150._0_2_ = 2;
        FUN_0002cc48(1,&local_150,&local_134,uVar19,uVar18);
        local_150 = CONCAT22(local_150._2_2_,10);
      }
      FUN_0002cc48(1,&local_150,&local_134,uVar19,uVar18);
      if ((uVar14 != 0) && (DAT_0007ce00 == 0)) {
        DAT_0007ce00 = 1;
        fprintf(stderr,"%s\n","mssntp restrict bit ignored, this ntpd was configured without --enable-ntp-signd.");
        FUN_0004fe78(4,"mssntp restrict bit ignored, this ntpd was configured without --enable-ntp-signd.");
      }
    }
    else {
      local_150 = *(uint *)(*piVar8 + 4) & 0xffff;
      iVar5 = FUN_0000c118(*(undefined4 *)*piVar8,&local_150);
      if (iVar5 == 1) {
        uVar19 = 0xfffffef4;
        local_130 = 0;
        local_12c = 0;
        local_134 = local_150 & 0xffff;
        local_128 = 0;
        if ((short)local_150 != 10) {
          uVar19 = 0xffffffff;
        }
        local_124 = 0;
        local_120 = 0;
        local_11c = 0;
        if ((short)local_150 == 10) {
          memset(&local_12c,0xff,0x10);
          uVar19 = local_130;
        }
        local_130 = uVar19;
        if (piVar8[1] != 0) {
          local_130 = 0;
          local_12c = 0;
          local_128 = 0;
          local_124 = 0;
          local_120 = 0;
          local_11c = 0;
          local_134 = ((undefined4 *)piVar8[1])[1] & 0xffff;
          iVar5 = FUN_0000c118(*(undefined4 *)piVar8[1],&local_134);
          if (iVar5 != 1) {
            FUN_0004fe78(3,"restrict: error in mask \'%s\' on line %d. Ignoring...",*(undefined4 *)piVar8[1],piVar8[3]);
            goto LAB_0000ddf0;
          }
        }
        bVar27 = false;
        goto LAB_0000dfc4;
      }
      FUN_0004fe78(3,"restrict: error in address \'%s\' on line %d. Ignoring...",*(undefined4 *)*piVar8,piVar8[3]);
    }
LAB_0000ddf0:
  }
  piVar8 = (int *)FUN_00010db4(__dest[0x15]);
  if (piVar8 != (int *)0x0) {
    uVar19 = 0xffffffff;
    do {
      iVar5 = *piVar8;
      if (iVar5 == 0x130) {
        uVar19 = 9;
      }
      else if (iVar5 < 0x131) {
        if (iVar5 == 0x11d) {
          uVar19 = 5;
        }
        else if (iVar5 == 0x12d) {
          uVar19 = 10;
        }
        else {
          if (iVar5 != 0x104) goto LAB_0000e358;
          uVar19 = 8;
        }
      }
      else if (iVar5 == 0x180) {
        uVar19 = 3;
      }
      else if (iVar5 == 0x181) {
        uVar19 = 6;
      }
      else if (iVar5 == 0x166) {
        uVar19 = 4;
      }
      else {
LAB_0000e358:
        (*DAT_0007c9fc)("ntp_config.c",0x94c,2,"0");
      }
      FUN_00020854((int)*(undefined8 *)(piVar8 + 2),uVar19);
      piVar8 = (int *)FUN_00010d84(piVar8);
    } while (piVar8 != (int *)0x0);
  }
  FUN_0000bbc8(__dest[0x16],1);
  FUN_0000bbc8(__dest[0x17],0);
  for (piVar8 = (int *)FUN_00010db4(__dest[0x21]); piVar8 != (int *)0x0; piVar8 = (int *)FUN_00010d84(piVar8)) {
    iVar5 = *piVar8;
    if (iVar5 == 0x2d) {
      uVar18 = FUN_0000c1a0(piVar8[2]);
      DAT_0007be6c = DAT_0007be6c & ~uVar18;
    }
    else if (iVar5 == 0x3d) {
      DAT_0007be6c = FUN_0000c1a0(piVar8[2]);
    }
    else if (iVar5 == 0x2b) {
      uVar18 = FUN_0000c1a0(piVar8[2]);
      DAT_0007be6c = uVar18 | DAT_0007be6c;
    }
  }
  puVar6 = (undefined4 *)FUN_00010db4(__dest[0x23]);
  if (puVar6 != (undefined4 *)0x0) {
    uVar18 = 0;
    do {
      if (uVar18 < 9) {
        uVar19 = FUN_0004f4e8(*puVar6);
        uVar14 = uVar18 + 1;
        (&DAT_0007ce04)[uVar18] = uVar19;
        (&DAT_0007ce04)[uVar14] = 0;
      }
      else {
        FUN_0004fe78(6,"phone: Number of phone entries exceeds %lu. Ignoring phone %s...",9,*puVar6);
        uVar14 = uVar18;
      }
      puVar6 = (undefined4 *)FUN_00010d84(puVar6);
      uVar18 = uVar14;
    } while (puVar6 != (undefined4 *)0x0);
  }
  puVar6 = (undefined4 *)FUN_00010db4(__dest[0x24]);
  if (puVar6 != (undefined4 *)0x0) {
    pcVar9 = (char *)0x0;
    do {
      sVar10 = strlen((char *)*puVar6);
      sVar11 = strlen((char *)puVar6[1]);
      sVar10 = sVar10 + sVar11 + 2;
      pcVar9 = (char *)FUN_0004f478(pcVar9,sVar10,0,0);
      snprintf(pcVar9,sVar10,"%s=%s",*puVar6,puVar6[1]);
      if (puVar6[2] == 0) {
        uVar19 = 0;
      }
      else {
        uVar19 = 0x20;
      }
      FUN_0001ce68(pcVar9,sVar10,uVar19);
      puVar6 = (undefined4 *)FUN_00010d84(puVar6);
    } while (puVar6 != (undefined4 *)0x0);
    if (pcVar9 != (char *)0x0) {
      free(pcVar9);
    }
  }
  puVar6 = (undefined4 *)FUN_00010db4(__dest[0x25]);
  if (puVar6 == (undefined4 *)0x0) {
    DAT_000cb4d4 = -1;
  }
  else {
    uVar18 = 0;
    do {
      if (uVar18 < 8) {
        (&DAT_000cb460)[uVar18] = (char)*puVar6;
        uVar18 = uVar18 + 1;
      }
      else {
        FUN_0004fe78(6,"ttl: Number of TTL entries exceeds %lu. Ignoring TTL %d...",8,*puVar6);
      }
      puVar6 = (undefined4 *)FUN_00010d84(puVar6);
    } while (puVar6 != (undefined4 *)0x0);
    DAT_000cb4d4 = uVar18 - 1;
  }
  local_118 = (uint)local_118._2_2_ << 0x10;
  for (puVar6 = (undefined4 *)FUN_00010db4(__dest[0x26]); puVar6 != (undefined4 *)0x0;
      puVar6 = (undefined4 *)FUN_00010d84(puVar6)) {
    piVar8 = (int *)FUN_00010db4(puVar6[1]);
    if (piVar8 == (int *)0x0) {
      local_fc = piVar8;
      local_f8 = piVar8;
      local_f4 = piVar8;
      local_f0 = piVar8;
      local_ec = piVar8;
      local_e8 = piVar8;
      local_e4 = piVar8;
      iVar5 = FUN_0000c118(*(undefined4 *)*puVar6,&local_fc);
      if (iVar5 == 1) {
        local_fc = (int *)CONCAT22(0xf48,(short)local_fc);
LAB_0000f73c:
        iVar5 = DAT_000ca608;
        if ((short)local_fc != 2) {
          iVar5 = DAT_000ca644;
        }
        goto LAB_0000e8dc;
      }
    }
    else {
      piVar21 = (int *)0x0;
      iVar5 = 0;
      uVar18 = 0;
      do {
        if (*piVar8 == 0x16d) {
          uVar18 = piVar8[2];
          if (0xfffe < uVar18 - 1) {
            FUN_0004fe78(3,"invalid port number %d, trap ignored");
            piVar21 = (int *)0x1;
            uVar18 = piVar8[2];
          }
          uVar18 = uVar18 & 0xffff;
        }
        else if (*piVar8 == 0x136) {
          local_114 = 0;
          local_110 = 0;
          local_10c = 0;
          local_108 = 0;
          local_104 = 0;
          local_100 = 0;
          local_118 = ((undefined4 *)piVar8[2])[1] & 0xffff;
          iVar5 = FUN_0000c118(*(undefined4 *)piVar8[2],&local_118);
          if (iVar5 != 1) goto LAB_0000e7c8;
          iVar5 = FUN_00015bd4(&local_118);
          if (iVar5 == 0) {
            uVar19 = FUN_00050cd0(&local_118);
            FUN_0004fe78(3,"can\'t find interface with address %s",uVar19);
            piVar21 = (int *)0x1;
          }
        }
        piVar8 = (int *)FUN_00010d84(piVar8);
      } while (piVar8 != (int *)0x0);
      if ((piVar21 == (int *)0x0) &&
         (local_fc = piVar21, local_f8 = piVar21, local_f4 = piVar21, local_f0 = piVar21, local_ec = piVar21,
         local_e8 = piVar21, local_e4 = piVar21, iVar7 = FUN_0000c118(*(undefined4 *)*puVar6,&local_fc), iVar7 == 1)) {
        if (uVar18 == 0) {
          uVar15 = 0xf48;
        }
        else {
          uVar15 = (ushort)(uVar18 << 8) | (ushort)(uVar18 >> 8);
        }
        local_fc = (int *)CONCAT22(uVar15,(short)local_fc);
        if (iVar5 == 0) goto LAB_0000f73c;
        local_fc = (int *)CONCAT22(uVar15,(undefined2)local_118);
LAB_0000e8dc:
        iVar5 = FUN_0001c824(&local_fc,iVar5,0,4);
        if (iVar5 == 0) {
          uVar19 = FUN_00050cd0(&local_fc);
          FUN_0004fe78(3,"can\'t set trap for %s",uVar19);
        }
      }
    }
LAB_0000e7c8:
  }
  for (piVar8 = (int *)FUN_00010db4(__dest[0x27]); piVar8 != (int *)0x0; piVar8 = (int *)FUN_00010d84(piVar8)) {
    iVar5 = *piVar8;
    if (iVar5 == 0x141) {
      FUN_0002e368(4,piVar8[2]);
      pcVar9 = DAT_000c9cbc;
    }
    else {
      pcVar9 = DAT_000c9cbc;
      if (iVar5 < 0x142) {
        if (iVar5 == 0x10e) {
          FUN_00026a68((int)*(undefined8 *)(piVar8 + 2),4,0,0);
          pcVar9 = DAT_000c9cbc;
        }
        else if (iVar5 < 0x10f) {
          if (iVar5 != 0x107) {
LAB_0000e814:
            FUN_0004fe78(3,"config_vars(): unexpected token %d");
            pcVar9 = DAT_000c9cbc;
          }
        }
        else if (iVar5 == 0x111) {
          FUN_00026a68(0,0x14,piVar8[2],0);
          pcVar9 = DAT_000c9cbc;
        }
        else {
          if (iVar5 != 0x11f) goto LAB_0000e814;
          if (*(char *)piVar8[2] == '\0') {
            DAT_000cb57c = 0;
            FUN_0004fe78(6,"config: driftfile disabled\n");
            pcVar9 = DAT_000c9cbc;
          }
          else {
            FUN_0002e368(1);
            pcVar9 = DAT_000c9cbc;
          }
        }
      }
      else if (iVar5 == 0x179) {
        if (DAT_000c9cbc != (char *)0x0) {
          free(DAT_000c9cbc);
        }
        pcVar20 = (char *)piVar8[2];
        pcVar9 = (char *)strlen(pcVar20);
        if (pcVar9 != (char *)0x0) {
          if ((pcVar20 + (int)pcVar9)[-1] == '/') {
            pcVar9 = (char *)FUN_0004f4e8(pcVar20);
          }
          else {
            DAT_000c9cbc = (char *)FUN_0004f524(pcVar9 + 2);
            snprintf(DAT_000c9cbc,(size_t)(pcVar9 + 2),"%s%c",piVar8[2],0x2f);
            pcVar9 = DAT_000c9cbc;
          }
        }
      }
      else if (iVar5 < 0x17a) {
        if (iVar5 == 0x146) {
          pFVar4 = fopen((char *)piVar8[2],"a");
          if (pFVar4 == (FILE *)0x0) {
            FUN_0004fe78(3,"Cannot open log file %s",piVar8[2]);
            pcVar9 = DAT_000c9cbc;
          }
          else {
            if ((DAT_0007be6c & 1) != 0) {
              FUN_0004fe78(5,"logging to file %s",piVar8[2]);
            }
            if (DAT_000cf6f0 != (FILE *)0x0) {
              iVar5 = fileno(DAT_000cf6f0);
              iVar7 = fileno(pFVar4);
              if (iVar5 != iVar7) {
                fclose(DAT_000cf6f0);
              }
            }
            DAT_0007be68 = 0;
            pcVar9 = DAT_000c9cbc;
            DAT_000cf6f0 = pFVar4;
          }
        }
        else {
          if (iVar5 != 0x16b) goto LAB_0000e814;
          FUN_0002e368(3,piVar8[2]);
          pcVar9 = DAT_000c9cbc;
        }
      }
      else if (iVar5 == 0x185) {
        FUN_00026a68((int)*(undefined8 *)(piVar8 + 2),0x17,0,0);
        pcVar9 = DAT_000c9cbc;
      }
      else {
        if (iVar5 != 0x193) goto LAB_0000e814;
        DAT_0007a5f0 = piVar8[2];
        DAT_0007a5f4 = piVar8[3];
      }
    }
    DAT_000c9cbc = pcVar9;
  }
  if (__dest[0xb] != 0) {
    FUN_00026a68(0,1,__dest[0xb],0);
  }
  puVar6 = (undefined4 *)FUN_00010db4(__dest[0xc]);
  if (puVar6 != (undefined4 *)0x0) {
    do {
      local_dc = 0;
      local_d8 = 0;
      local_d4 = 0;
      local_d0 = 0;
      local_cc = 0;
      local_c8 = 0;
      local_e0 = puVar6[1] & 0xffff;
      iVar5 = FUN_0000c118(*puVar6,&local_e0);
      if (iVar5 == 1) {
        FUN_00026a68(0,6,0,&local_e0);
      }
      puVar6 = (undefined4 *)FUN_00010d84(puVar6);
    } while (puVar6 != (undefined4 *)0x0);
    DAT_000cb4ac = 1;
  }
  puVar6 = (undefined4 *)FUN_00010db4(__dest[0xd]);
  if (puVar6 != (undefined4 *)0x0) {
    do {
      local_dc = 0;
      local_d8 = 0;
      local_d4 = 0;
      local_d0 = 0;
      local_cc = 0;
      local_c8 = 0;
      local_e0 = puVar6[1] & 0xffff;
      iVar5 = FUN_0000c118(*puVar6,&local_e0);
      if (iVar5 == 1) {
        FUN_00026a68(0,6,0,&local_e0);
      }
      puVar6 = (undefined4 *)FUN_00010d84(puVar6);
    } while (puVar6 != (undefined4 *)0x0);
    FUN_00026a68(0,6,1,0);
  }
  for (piVar8 = (int *)FUN_00010db4(__dest[9]); piVar8 != (int *)0x0; piVar8 = (int *)FUN_00010d84(piVar8)) {
    iVar5 = *piVar8;
    if (iVar5 == 0x16c) {
      iVar7 = 3;
      iVar5 = DAT_0007a2bc;
    }
    else if (iVar5 == 0x167) {
      iVar7 = 1;
      iVar5 = iVar7;
    }
    else if (iVar5 < 0x168) {
      if (iVar5 == 0x10c) {
        iVar7 = 5;
        iVar5 = 1;
      }
      else {
        if (iVar5 == 0x149) goto LAB_0000f1c8;
LAB_0000ebd4:
        iVar7 = -1;
        (*DAT_0007c9fc)("ntp_config.c",0xd2b,2,"hmode != -1");
        iVar5 = 1;
      }
    }
    else {
      if ((iVar5 != 0x16c) && (iVar5 != 0x17a)) goto LAB_0000ebd4;
LAB_0000f1c8:
      iVar7 = 3;
      iVar5 = 1;
    }
    iVar12 = FUN_00010db4(piVar8[2]);
    if (iVar12 == 0) {
      uVar18 = 0;
    }
    else {
      uVar18 = 0;
      do {
        iVar17 = *(int *)(iVar12 + 8);
        if (iVar17 == 0x15e) {
          uVar18 = uVar18 | 0x200;
        }
        else if (iVar17 < 0x15f) {
          if (iVar17 == 0x10f) {
            uVar18 = uVar18 | 0x40;
          }
          else if (iVar17 == 0x131) {
            uVar18 = uVar18 | 0x100;
          }
          else {
            if (iVar17 != 0x106) goto LAB_0000ec44;
            uVar18 = uVar18 | 0x800;
          }
        }
        else if (iVar17 == 0x16f) {
          uVar18 = uVar18 | 0x20;
        }
        else if (iVar17 < 0x170) {
          if (iVar17 == 0x16e) {
            uVar18 = uVar18 | 2;
          }
          else {
LAB_0000ec44:
            (*DAT_0007c9fc)("ntp_config.c",0xd34,2,"0");
          }
        }
        else if (iVar17 == 0x18c) {
          uVar18 = uVar18 | 0x400;
        }
        else {
          if (iVar17 != 0x196) goto LAB_0000ec44;
          uVar18 = uVar18 | 0x1000;
        }
        iVar12 = FUN_00010d84(iVar12);
      } while (iVar12 != 0);
    }
    iVar12 = 0;
    local_c0 = 0;
    local_bc = 0;
    local_b8 = 0;
    local_b4 = 0;
    local_b0 = 0;
    local_ac = 0;
    local_c4 = ((undefined4 *)piVar8[1])[1] & 0xffff;
    iVar17 = FUN_0000bd2c(*(undefined4 *)piVar8[1],&local_c4,&local_170,0);
    paVar3 = local_170;
    if (iVar17 != -1) {
      if (iVar17 == 1) {
        if (0 < iVar5) {
          do {
            if (local_170 == (addrinfo *)0x0) break;
            iVar12 = iVar12 + 1;
            memcpy(&local_c4,local_170->ai_addr,local_170->ai_addrlen);
            iVar17 = *piVar8;
            uVar14 = local_c4 & 0xffff;
            if (uVar14 == 2) {
              uVar2 = local_c0 << 0x18 | (local_c0 >> 8 & 0xff) << 0x10;
              if (((uVar2 == 0x7f7f0000) || (local_c0 << 0x18 != 0x7f000000)) ||
                 ((uVar2 | (local_c0 >> 0x10 & 0xff) << 8 | local_c0 >> 0x18) == 0x7f000001)) goto LAB_0000f0dc;
LAB_0000f10c:
              uVar19 = FUN_00050cd0(&local_c4);
              FUN_0004fe78(3,"attempt to configure invalid address %s",uVar19);
            }
            else {
LAB_0000f0dc:
              if ((iVar17 == 0x17a || iVar17 == 0x167) || (iVar17 == 0x16c)) {
                if (uVar14 == 2) {
                  bVar27 = (local_c0 & 0xf0) == 0xe0;
                }
                else {
                  bVar27 = (char)local_bc == -1;
                }
                if (bVar27) goto LAB_0000f10c;
              }
              if (iVar17 == 0x149) {
                if (uVar14 == 2) {
                  iVar17 = (local_c0 & 0xf0) * 0x1000000 + 0x20000000;
                  if (iVar17 != 0) {
                    iVar17 = 1;
                  }
                }
                else {
                  iVar17 = (local_bc & 0xff) - 0xff;
                  if (iVar17 != 0) {
                    iVar17 = 1;
                  }
                }
                if (iVar17 != 0) goto LAB_0000f10c;
              }
              if ((uVar14 != 10) || (DAT_000cb864 != 0)) {
                FUN_00022304(&local_c4,0,iVar7,piVar8[6],piVar8[3],piVar8[4],uVar18,piVar8[5],piVar8[7],&DAT_0005bee0);
              }
            }
            local_170 = local_170->ai_next;
          } while (iVar12 != iVar5);
        }
        freeaddrinfo(paVar3);
      }
      else {
        FUN_0004fe78(6,"Deferring DNS for %s %d",*(undefined4 *)piVar8[1],iVar5);
        iVar17 = piVar8[3];
        iVar24 = piVar8[4];
        uVar16 = *(undefined4 *)piVar8[1];
        uVar19 = ((undefined4 *)piVar8[1])[1];
        iVar25 = piVar8[5];
        iVar12 = piVar8[6];
        iVar26 = piVar8[7];
        if (DAT_000c9d6c == (FILE *)0x0) {
          DAT_0007cde4 = 0x706d742f;
          DAT_0007cde8 = 0x70746e2f;
          DAT_0007cdec = 0x58585858;
          DAT_0007cdf0 = 0x5858;
          DAT_0007cdf2 = 0;
          __fd = mkstemp((char *)&DAT_0007cde4);
          if (__fd != -1) {
            DAT_000c9d6c = fdopen(__fd,"r+");
          }
          if (DAT_000c9d6c == (FILE *)0x0) {
            FUN_0004fe78(3,"open failed for %s: %m",&DAT_0007cde4);
            goto LAB_0000eeb8;
          }
        }
        if (DAT_0007cf4c != 0) {
          printf("resolving %s\n",uVar16);
        }
        fprintf(DAT_000c9d6c,"%s %d %d %d %d %d %d %d %d %u %s\n",uVar16,iVar5,uVar19,iVar7,iVar12,iVar17,iVar24,uVar18,
                iVar25,iVar26,&DAT_0005bee0);
        if (1 < DAT_0007cf4c) {
          printf("config: %s %d %d %d %d %d %d %x %d %u %s\n",uVar16,iVar5,uVar19,iVar7,iVar12,iVar17,iVar24,uVar18,
                 iVar25,iVar26,&DAT_0005bee0);
        }
      }
    }
LAB_0000eeb8:
  }
  for (piVar8 = (int *)FUN_00010db4(__dest[10]); piVar8 != (int *)0x0; piVar8 = (int *)FUN_00010d84(piVar8)) {
    iVar5 = *piVar8;
    if (iVar5 == 0) {
      local_a8 = ((undefined4 *)piVar8[1])[1] & 0xffff;
      local_a4 = iVar5;
      local_a0 = iVar5;
      local_9c = iVar5;
      local_98 = iVar5;
      local_94 = iVar5;
      local_90 = iVar5;
      iVar5 = FUN_0000bd2c(*(undefined4 *)piVar8[1],&local_a8,&local_170,0);
      paVar3 = local_170;
      if (iVar5 == 1) {
        for (; local_170 != (addrinfo *)0x0; local_170 = local_170->ai_next) {
          memcpy(&local_a8,local_170->ai_addr,local_170->ai_addrlen);
          if (0 < DAT_0007cf4c) {
            uVar19 = FUN_00050cd0(&local_a8);
            printf("searching for %s\n",uVar19);
          }
          iVar5 = 0;
          do {
            iVar5 = FUN_00021500(&local_a8,iVar5,0xffffffff,0);
            if (iVar5 == 0) goto LAB_0000efe0;
          } while ((*(uint *)(iVar5 + 0x34) & 1) == 0);
          FUN_0002310c(iVar5,&DAT_0005bf38);
          FUN_000218bc(iVar5);
LAB_0000efe0:
        }
        freeaddrinfo(paVar3);
      }
    }
    else {
      iVar5 = FUN_00021604();
      if (iVar5 != 0) {
        FUN_0002310c(iVar5,&DAT_0005bf38);
        FUN_000218bc(iVar5);
      }
    }
  }
  for (puVar6 = (undefined4 *)FUN_00010db4(__dest[0x14]); puVar6 != (undefined4 *)0x0;
      puVar6 = (undefined4 *)FUN_00010d84(puVar6)) {
    local_8c = 0;
    local_88 = 0;
    local_84 = 0;
    local_80 = 0;
    local_7c = 0;
    local_78 = 0;
    local_74 = 0;
    iVar5 = FUN_0000c118(*(undefined4 *)*puVar6,&local_8c);
    if (((local_8c & 0xffff) == 2) && ((local_88 << 0x18 | (local_88 >> 8 & 0xff) << 0x10) == 0x7f7f0000)) {
      iVar5 = iVar5 + -1;
      if (iVar5 != 0) {
        iVar5 = 1;
      }
    }
    else {
      iVar5 = 1;
      uVar19 = FUN_00050cd0(&local_8c);
      FUN_0004fe78(3,"inappropriate address %s for the fudge command, line ignored",uVar19);
    }
    memset(&uStack_70,0,0x48);
    for (piVar8 = (int *)FUN_00010db4(puVar6[1]); piVar8 != (int *)0x0; piVar8 = (int *)FUN_00010d84(piVar8)) {
      iVar7 = *piVar8;
      if (iVar7 == 0x12a) {
        local_6e = ~((byte)~(byte)(((uint)local_6e << 0x19) >> 0x18) >> 1);
        if (piVar8[2] == 0) {
          local_6f = local_6f & 0xf7;
        }
        else {
          local_6f = local_6f | 8;
        }
      }
      else if (iVar7 < 299) {
        if (iVar7 == 0x128) {
          local_6e = local_6e | 0x20;
          if (piVar8[2] == 0) {
            local_6f = local_6f & 0xfd;
          }
          else {
            local_6f = local_6f | 2;
          }
        }
        else if (iVar7 < 0x129) {
          if (iVar7 != 0x127) goto LAB_0000f2f8;
          local_6e = local_6e | 0x10;
          if (piVar8[2] == 0) {
            local_6f = local_6f & 0xfe;
          }
          else {
            local_6f = local_6f | 1;
          }
        }
        else {
          local_6e = local_6e | 0x40;
          if (piVar8[2] == 0) {
            local_6f = local_6f & 0xfb;
          }
          else {
            local_6f = local_6f | 4;
          }
        }
      }
      else if (iVar7 == 0x182) {
        local_38 = piVar8[2];
        local_6e = local_6e | 4;
      }
      else if (iVar7 < 0x183) {
        if (iVar7 != 0x175) {
LAB_0000f2f8:
          uVar19 = FUN_00050cd0(&local_8c);
          FUN_0004fe78(3,"Unexpected fudge internal flag 0x%x for %s\n",iVar7,uVar19);
          iVar5 = *piVar8;
          if (iVar5 == 0) {
            iVar5 = 1;
          }
                    /* WARNING: Subroutine does not return */
          exit(iVar5);
        }
        local_34[0] = 0;
        local_6e = local_6e | 8;
        pcVar9 = (char *)piVar8[2];
        sVar10 = strlen(pcVar9);
        if (3 < sVar10) {
          sVar10 = 4;
        }
        memcpy(local_34,pcVar9,sVar10);
      }
      else if (iVar7 == 0x186) {
        local_48 = piVar8[2];
        local_44 = piVar8[3];
        local_6e = local_6e | 1;
      }
      else {
        if (iVar7 != 0x187) goto LAB_0000f2f8;
        local_40 = piVar8[2];
        local_3c = piVar8[3];
        local_6e = local_6e | 2;
      }
    }
    if (iVar5 == 0) {
      FUN_00027e00(&local_8c,&uStack_70,0);
    }
  }
  iVar5 = FUN_00010db4(__dest[0x22]);
  if (iVar5 != 0) {
    iVar7 = 0;
    do {
      pcVar9 = *(char **)(iVar5 + 8);
      iVar12 = strcmp(pcVar9,"lowdelay");
      if (iVar12 == 0) {
        iVar7 = 1;
      }
      else {
        iVar12 = strcmp(pcVar9,"throughput");
        if (iVar12 == 0) {
          iVar7 = 2;
        }
        else {
          iVar12 = strcmp(pcVar9,"reliability");
          if (iVar12 == 0) {
            iVar7 = 3;
          }
          else {
            iVar12 = strcmp(pcVar9,"mincost");
            if (iVar12 == 0) {
              iVar7 = 4;
            }
            else {
              iVar12 = strcmp(pcVar9,"routine");
              if (iVar12 == 0) {
LAB_0000f4b8:
                iVar7 = 5;
              }
              else if (*pcVar9 == 'c') {
                cVar1 = pcVar9[1];
                if (((cVar1 == 's') && (pcVar9[2] == '0')) && (pcVar9[3] == '\0')) goto LAB_0000f4b8;
                iVar12 = strcmp(pcVar9,"priority");
                if ((iVar12 == 0) || (((cVar1 == 's' && (pcVar9[2] == '1')) && (pcVar9[3] == '\0')))) goto LAB_0000f92c;
                iVar12 = strcmp(pcVar9,"immediate");
                if ((iVar12 == 0) || (((cVar1 == 's' && (pcVar9[2] == '2')) && (pcVar9[3] == '\0')))) goto LAB_0000f9a8;
                iVar12 = strcmp(pcVar9,"flash");
                if (iVar12 == 0) {
                  iVar7 = 8;
                }
                else if (((cVar1 == 's') && (pcVar9[2] == '3')) && (pcVar9[3] == '\0')) {
                  iVar7 = 8;
                }
              }
              else {
                iVar12 = strcmp(pcVar9,"priority");
                if (iVar12 == 0) {
LAB_0000f92c:
                  iVar7 = 6;
                }
                else {
                  iVar12 = strcmp(pcVar9,"immediate");
                  if (iVar12 == 0) {
LAB_0000f9a8:
                    iVar7 = 7;
                  }
                  else {
                    iVar12 = strcmp(pcVar9,"flash");
                    if (iVar12 == 0) {
                      iVar7 = 8;
                    }
                  }
                }
              }
            }
          }
        }
      }
      iVar12 = strcmp(pcVar9,"flashoverride");
      if (iVar12 == 0) {
LAB_0000f3f4:
        iVar7 = 9;
        iVar12 = iVar7;
      }
      else {
        if (*pcVar9 == 'c') {
          cVar1 = pcVar9[1];
          if (((cVar1 == 's') && (pcVar9[2] == '4')) && (pcVar9[3] == '\0')) goto LAB_0000f3f4;
          iVar12 = strcmp(pcVar9,"critical");
          if ((iVar12 != 0) && (((cVar1 != 's' || (pcVar9[2] != '5')) || (pcVar9[3] != '\0')))) {
            iVar12 = strcmp(pcVar9,"internetcontrol");
            if ((iVar12 != 0) && (((cVar1 != 's' || (pcVar9[2] != '6')) || (pcVar9[3] != '\0')))) {
              iVar12 = strcmp(pcVar9,"netcontrol");
              if ((iVar12 == 0) || (((cVar1 == 's' && (pcVar9[2] == '7')) && (pcVar9[3] == '\0')))) goto LAB_0000f8a0;
              goto LAB_0000f8fc;
            }
            goto LAB_0000f870;
          }
        }
        else {
          iVar12 = strcmp(pcVar9,"critical");
          if (iVar12 != 0) {
            iVar12 = strcmp(pcVar9,"internetcontrol");
            if (iVar12 == 0) {
LAB_0000f870:
              iVar7 = 0xb;
              iVar12 = iVar7;
            }
            else {
              iVar12 = strcmp(pcVar9,"netcontrol");
              if (iVar12 == 0) {
LAB_0000f8a0:
                iVar7 = 0xc;
                iVar12 = iVar7;
              }
              else {
LAB_0000f8fc:
                iVar12 = iVar7;
                if (iVar7 == 0) {
                  FUN_0004fe78(3,"parse error, qos %s not accepted\n",pcVar9);
                  iVar12 = DAT_000794fc;
                }
              }
            }
            goto LAB_0000f400;
          }
        }
        iVar7 = 10;
        iVar12 = iVar7;
      }
LAB_0000f400:
      DAT_000794fc = iVar12;
      iVar5 = FUN_00010d84(iVar5);
    } while (iVar5 != 0);
  }
  return;
}




undefined4 FUN_0000fa4c(undefined4 param_1)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00010ed0();
  FUN_00010dcc(uVar1,param_1);
  return uVar1;
}




void FUN_0000fa6c(undefined4 param_1)

{
  undefined4 *puVar1;
  undefined8 in_d0;
  
  puVar1 = (undefined4 *)FUN_00010d64(0x18);
  *puVar1 = param_1;
  *(undefined8 *)(puVar1 + 2) = in_d0;
  puVar1[4] = 0x11e;
  return;
}




void FUN_0000fa9c(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(0x18);
  *puVar1 = param_1;
  puVar1[2] = param_2;
  puVar1[4] = 0x135;
  return;
}




void FUN_0000fac4(undefined4 param_1,int param_2,uint param_3)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(0x18);
  *puVar1 = param_1;
  puVar1[2] = param_3 | param_2 << 0x10;
  puVar1[4] = 0x135;
  return;
}




undefined4 * FUN_0000faf4(undefined4 param_1,int param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(0x18);
  *puVar1 = param_1;
  if (param_2 == 0) {
    param_2 = FUN_0004f4e8(&DAT_000665cc);
  }
  puVar1[2] = param_2;
  puVar1[4] = 0x183;
  return puVar1;
}




void FUN_0000fb40(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(0x18);
  *puVar1 = param_1;
  puVar1[2] = param_2;
  puVar1[4] = 0x199;
  return;
}




void FUN_0000fb68(undefined4 param_1)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(4);
  *puVar1 = param_1;
  return;
}




void FUN_0000fb80(void)

{
  undefined8 *puVar1;
  undefined8 in_d0;
  
  puVar1 = (undefined8 *)FUN_00010d64(8);
  *puVar1 = in_d0;
  return;
}




void FUN_0000fba0(undefined4 param_1)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(4);
  *puVar1 = param_1;
  return;
}




void FUN_0000fbb8(int param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int *piVar1;
  
  if (param_1 == 0) {
    (*DAT_0007c9fc)("ntp_config.c",0x4e6,0,"((void *)0) != addr",param_4);
  }
  piVar1 = (int *)FUN_00010d64(8);
  *piVar1 = param_1;
  piVar1[1] = param_2;
  return;
}




void FUN_0000fc04(int *param_1)

{
  void *__ptr;
  
  if (param_1 == (int *)0x0) {
    (*DAT_0007c9fc)("ntp_config.c",0x4f6,0,"((void *)0) != my_node");
  }
  __ptr = (void *)*param_1;
  if (__ptr == (void *)0x0) {
    (*DAT_0007c9fc)("ntp_config.c",0x4f7,0,"((void *)0) != my_node->address");
    __ptr = (void *)*param_1;
  }
  free(__ptr);
  FUN_00010d7c(param_1);
  return;
}




undefined4 * FUN_0000fc80(undefined4 param_1,int param_2,int param_3)

{
  bool bVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  int *piVar4;
  int iVar5;
  
  puVar2 = (undefined4 *)FUN_00010d64(0x28);
  bVar1 = false;
  puVar2[6] = 4;
  puVar2[8] = 0;
  puVar2[9] = 0;
  puVar2[3] = 0;
  puVar2[4] = 0;
  puVar2[5] = 0;
  puVar2[7] = 0;
  uVar3 = FUN_00010ed0();
  *puVar2 = param_1;
  puVar2[1] = param_2;
  if (param_3 != 0) {
    param_2 = 0x152;
  }
  puVar2[2] = uVar3;
  if (param_3 != 0) {
    while (piVar4 = (int *)FUN_00010e58(param_3), piVar4 != (int *)0x0) {
      iVar5 = *piVar4;
      if (iVar5 == param_2) {
        iVar5 = piVar4[2];
        if (iVar5 < 3) {
          FUN_0004fe78(6,"minpoll: provided value (%d) is below minimum (%d)",iVar5,3);
          puVar2[3] = 3;
        }
        else {
          puVar2[3] = iVar5;
        }
LAB_0000fd18:
        FUN_00010d7c(piVar4);
      }
      else {
        if (iVar5 <= param_2) {
          if (iVar5 == 0x13c) {
            puVar2[7] = piVar4[2];
          }
          else if (iVar5 == 0x14e) {
            iVar5 = piVar4[2];
            if (iVar5 < 0x12) {
              puVar2[4] = iVar5;
            }
            else {
              FUN_0004fe78(6,"maxpoll: provided value (%d) is above maximum (%d)",iVar5,0x11);
              puVar2[4] = 0x11;
            }
          }
          else {
            if (iVar5 != 0x10b) goto LAB_0000fd00;
            iVar5 = piVar4[3];
            puVar2[8] = piVar4[2];
            puVar2[9] = iVar5;
          }
          goto LAB_0000fd18;
        }
        if (iVar5 == 0x18e) {
          if ((int)puVar2[5] < 8) {
LAB_0000fd58:
            puVar2[5] = piVar4[2];
          }
          else {
            FUN_0004fe78(3,"ttl: invalid argument");
            bVar1 = true;
          }
          goto LAB_0000fd18;
        }
        if (iVar5 < 399) {
          if (iVar5 == 0x154) goto LAB_0000fd58;
LAB_0000fd00:
          uVar3 = FUN_0001821c();
          bVar1 = true;
          FUN_0004fe78(3,"Unknown peer/server option token %s",uVar3);
          goto LAB_0000fd18;
        }
        if (iVar5 == 0x192) {
          puVar2[6] = piVar4[2];
          goto LAB_0000fd18;
        }
        if (iVar5 != 0x198) goto LAB_0000fd00;
        FUN_00010dcc(puVar2[2],piVar4);
      }
    }
    FUN_00010d2c(param_3);
    if (bVar1) {
      FUN_00010d7c(puVar2);
      puVar2 = (undefined4 *)0x0;
    }
  }
  return puVar2;
}




uint * FUN_0000fe58(undefined4 *param_1)

{
  uint *puVar1;
  ushort **ppuVar2;
  int iVar3;
  byte *pbVar4;
  uint uVar5;
  byte *__s;
  
  puVar1 = (uint *)FUN_00010d64(8);
  __s = (byte *)*param_1;
  uVar5 = (uint)*__s;
  if (uVar5 != 0) {
    ppuVar2 = __ctype_b_loc();
    pbVar4 = __s;
    do {
      if (((*ppuVar2)[uVar5] & 0x800) == 0) goto LAB_0000fea8;
      pbVar4 = pbVar4 + 1;
      uVar5 = (uint)*pbVar4;
    } while (uVar5 != 0);
  }
  iVar3 = sscanf((char *)__s,"%u",puVar1);
  if ((iVar3 == 1) && (*puVar1 < 0x10000)) {
    FUN_0000fc04(param_1);
    puVar1[1] = 0;
  }
  else {
LAB_0000fea8:
    puVar1[1] = (uint)param_1;
    *puVar1 = 0;
  }
  return puVar1;
}




void FUN_0000fef8(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(8);
  *puVar1 = param_1;
  puVar1[1] = param_2;
  return;
}




void FUN_0000ff14(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(0x10);
  *puVar1 = param_1;
  puVar1[1] = param_2;
  puVar1[2] = param_3;
  puVar1[3] = param_4;
  return;
}




void FUN_0000ff38(int *param_1)

{
  if (*param_1 != 0) {
    FUN_0000fc04();
  }
  if (param_1[1] != 0) {
    FUN_0000fc04();
  }
  if (param_1[2] != 0) {
    FUN_00010d2c();
    param_1[2] = 0;
  }
  FUN_00010d7c(param_1);
  return;
}




void FUN_00010600(char *param_1,undefined4 param_2,undefined4 param_3)

{
  char *pcVar1;
  undefined4 *puVar2;
  
  pcVar1 = strchr(param_1,0x3d);
  if (pcVar1 != (char *)0x0) {
    *pcVar1 = '\0';
  }
  puVar2 = (undefined4 *)FUN_00010d64(0xc);
  *puVar2 = param_1;
  puVar2[1] = param_2;
  puVar2[2] = param_3;
  return;
}




void FUN_0001063c(int param_1,int param_2,int param_3)

{
  int *piVar1;
  
  if (param_1 == 0 && param_2 == 0) {
    (*DAT_0007c9fc)("ntp_config.c",0x5e6,0,"match_class != 0 || if_name != ((void *)0)");
  }
  piVar1 = (int *)FUN_00010d64(0xc);
  *piVar1 = param_1;
  piVar1[1] = param_2;
  piVar1[2] = param_3;
  return;
}




void FUN_0001069c(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(8);
  *puVar1 = param_1;
  puVar1[1] = param_2;
  return;
}




undefined8 * FUN_000106b8(undefined4 param_1)

{
  undefined8 *puVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined8 in_d0;
  
  puVar1 = (undefined8 *)FUN_00010d64(0x30);
  *(undefined4 *)(puVar1 + 1) = 0;
  *(undefined4 *)((int)puVar1 + 0xc) = 0;
  *puVar1 = in_d0;
  *(undefined4 *)(puVar1 + 2) = 0;
  *(undefined4 *)((int)puVar1 + 0x14) = 0;
  *(undefined4 *)(puVar1 + 3) = 0;
  *(undefined4 *)((int)puVar1 + 0x1c) = 0;
  *(undefined4 *)(puVar1 + 4) = 0xd2f1a9fc;
  *(undefined4 *)((int)puVar1 + 0x24) = 0x3f50624d;
  *(undefined4 *)(puVar1 + 5) = 0xd2f1a9fc;
  *(undefined4 *)((int)puVar1 + 0x2c) = 0x3f50624d;
  puVar2 = (undefined4 *)FUN_00010db4(param_1);
  if (puVar2 == (undefined4 *)0x0) {
    return puVar1;
  }
  uVar3 = *puVar2;
  do {
    switch(uVar3) {
    case 0x1a0:
      uVar4 = puVar2[3];
      *(undefined4 *)(puVar1 + 1) = puVar2[2];
      *(undefined4 *)((int)puVar1 + 0xc) = uVar4;
      break;
    case 0x1a1:
      uVar4 = puVar2[3];
      *(undefined4 *)(puVar1 + 2) = puVar2[2];
      *(undefined4 *)((int)puVar1 + 0x14) = uVar4;
      break;
    case 0x1a2:
      uVar4 = puVar2[3];
      *(undefined4 *)(puVar1 + 3) = puVar2[2];
      *(undefined4 *)((int)puVar1 + 0x1c) = uVar4;
      break;
    case 0x1a3:
      uVar4 = puVar2[3];
      *(undefined4 *)(puVar1 + 4) = puVar2[2];
      *(undefined4 *)((int)puVar1 + 0x24) = uVar4;
      break;
    case 0x1a4:
      uVar4 = puVar2[3];
      *(undefined4 *)(puVar1 + 5) = puVar2[2];
      *(undefined4 *)((int)puVar1 + 0x2c) = uVar4;
      break;
    default:
      FUN_0004fe78(3,"Unknown script token %d");
      uVar3 = *puVar2;
    }
  } while( true );
}




undefined8 * FUN_0001079c(undefined4 *param_1,undefined4 param_2)

{
  FILE *__stream;
  undefined8 *puVar1;
  void *__dest;
  int iVar2;
  undefined4 uVar3;
  undefined8 in_d0;
  addrinfo *local_44;
  undefined4 local_40;
  undefined4 uStack_3c;
  undefined2 uStack_38;
  undefined1 local_36;
  char acStack_34 [20];
  
  puVar1 = (undefined8 *)FUN_00010d64(0x18);
  *puVar1 = in_d0;
  local_40 = 0x2e323931;
  uStack_3c = 0x2e383631;
  uStack_38 = 0x2e30;
  local_36 = 0;
  __dest = (void *)FUN_0004f524(0x1c);
  iVar2 = DAT_000794ec;
  if (param_1[1] == 0x183) {
    DAT_000794ec = DAT_000794ec + 1;
    snprintf(acStack_34,0x11,"%s%d",&local_40,iVar2);
    printf("Selecting ip address %s for hostname %s\n",acStack_34,*param_1);
    iVar2 = getaddrinfo(acStack_34,"ntp",(addrinfo *)0x0,&local_44);
  }
  else {
    iVar2 = getaddrinfo((char *)*param_1,"ntp",(addrinfo *)0x0,&local_44);
  }
  if (iVar2 == 0) {
    memcpy(__dest,local_44->ai_addr,local_44->ai_addrlen);
    __stream = stderr;
    uVar3 = FUN_00050cd0(__dest);
    fprintf(__stream,"Successful in setting ip address of simulated server to: %s\n",uVar3);
    freeaddrinfo(local_44);
    *(void **)(puVar1 + 1) = __dest;
    *(undefined4 *)((int)puVar1 + 0xc) = param_2;
    uVar3 = FUN_00010e58(param_2);
    *(undefined4 *)(puVar1 + 2) = uVar3;
    return puVar1;
  }
  fwrite("ERROR!! Could not get a new address\n",1,0x24,stderr);
                    /* WARNING: Subroutine does not return */
  exit(1);
}




void FUN_00010908(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_00010d64(8);
  *puVar1 = param_1;
  puVar1[1] = param_2;
  return;
}




void FUN_00010924(undefined4 param_1)

{
  undefined4 uVar1;
  char *local_bc;
  undefined4 local_b8;
  undefined4 local_b4;
  undefined4 local_b0;
  undefined4 local_ac;
  undefined4 local_a8;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 local_9c;
  char acStack_98 [128];
  
  uVar1 = FUN_00050cd0();
  snprintf(acStack_98,0x80,"remote config from %s",uVar1);
  DAT_000ca668 = &local_bc;
  DAT_000794d8 = 0;
  local_b8 = 0;
  local_ac = 0;
  local_a8 = 0;
  local_a4 = 0;
  local_a0 = 0;
  local_9c = 0;
  local_b4 = 1;
  local_b0 = 1;
  local_bc = acStack_98;
  FUN_0000c040();
  FUN_0001651c();
  DAT_000c9cc8 = 1;
  DAT_000c9ce0 = time((time_t *)0x0);
  FUN_00050cd0(param_1);
  DAT_000c9cd0 = FUN_0004f4e8();
  if (0 < DAT_0007cf4c) {
    puts("Finished Parsing!!");
  }
  FUN_0000d434();
  DAT_000794d8 = 1;
  return;
}




void FUN_000109fc(undefined4 param_1,undefined4 param_2)

{
  undefined4 *puVar1;
  size_t sVar2;
  undefined4 uVar3;
  int iVar4;
  __pid_t _Var5;
  char acStack_420 [1024];
  
  FUN_0005b388(&DAT_0000ff84);
  DAT_0007be6c = 0xf000;
  DAT_000c9d68 = "/etc/ntp.conf";
  DAT_000c9d6c = (FILE *)0x0;
  snprintf(acStack_420,0x400,"daemon_version=\"%s\"",DAT_00079e4c);
  sVar2 = strlen(acStack_420);
  FUN_0001ce68(acStack_420,sVar2 + 1);
  DAT_000c9afc = &LAB_0000bb88;
  strncpy(acStack_420,"settimeofday=\"UNKNOWN\"",0x400);
  sVar2 = strlen(acStack_420);
  FUN_0001ce68(acStack_420,sVar2 + 1);
  FUN_00020854(0,1);
  FUN_0000b6a0(param_1,param_2);
  FUN_0000c040();
  DAT_000ca57c = 0;
  uVar3 = FUN_0004f538(DAT_000c9d68);
  DAT_000c9ca0 = FUN_000182f0(uVar3,"r");
  if (DAT_000c9ca0 == 0) {
    uVar3 = FUN_0004f538(DAT_000c9d68);
    FUN_0004fe78(6,"getconfig: Couldn\'t open <%s>",uVar3);
    FUN_000142b8();
  }
  else {
    DAT_000c9cd0 = FUN_0004f4e8();
    DAT_000ca668 = (&DAT_000c9ca0)[DAT_000ca57c];
    DAT_000ca664 = (uint)(4 < DAT_0007cf4c);
    FUN_0001651c();
    if (0 < DAT_0007cf4c) {
      puts("Finished Parsing!!");
    }
    DAT_000c9cc8 = 0;
    DAT_000c9ce0 = time((time_t *)0x0);
    FUN_0000d434();
    while (DAT_000ca57c != -1) {
      puVar1 = &DAT_000c9ca0 + DAT_000ca57c;
      DAT_000ca57c = DAT_000ca57c + -1;
      FUN_000183c8(*puVar1);
    }
    if ((DAT_000c9d6c != (FILE *)0x0) && (DAT_000794f0 != 0)) {
      fclose(DAT_000c9d6c);
      DAT_000c9d6c = (FILE *)0x0;
      DAT_000cab7c = &DAT_0007cde4;
      FUN_0005131c(0x11,&LAB_0000bd1c);
      iVar4 = pipe(&DAT_000c9c98);
      if (iVar4 < 0) {
        FUN_0004fe78(3,"unable to open resolver pipe");
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      _Var5 = fork();
      if (_Var5 == 0) {
        closelog();
        FUN_00016060(0);
        FUN_0005131c(0x11,0);
        FUN_00018e8c("ntpd_intres",0);
        FUN_00018efc();
        FUN_0001f310();
        FUN_0004fe78(3,"call to ntp_intres lost");
        FUN_0000bff0();
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      if (_Var5 == -1) {
        FUN_0004fe78(3,"fork() failed, can\'t start ntp_intres: %m");
        FUN_0005131c(0x11,0);
        FUN_0000bff0();
      }
      else {
        close(DAT_000c9c98);
      }
    }
  }
  return;
}




void FUN_00010d2c(void *param_1)

{
  undefined4 *__ptr;
  
  __ptr = *(undefined4 **)((int)param_1 + 4);
  while (__ptr != (undefined4 *)0x0) {
    *(undefined4 *)((int)param_1 + 4) = *__ptr;
    free(__ptr);
    __ptr = *(undefined4 **)((int)param_1 + 4);
  }
  free(param_1);
  return;
}




undefined4 * FUN_00010d64(int param_1)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_0004f524(param_1 + 8);
  *puVar1 = 0;
  return puVar1 + 2;
}




void FUN_00010d7c(int param_1)

{
  free((void *)(param_1 + -8));
  return;
}




int FUN_00010d84(int param_1)

{
  int iVar1;
  
  iVar1 = *(int *)(param_1 + -8);
  if (iVar1 != 0) {
    iVar1 = iVar1 + 8;
  }
  return iVar1;
}




int FUN_00010db4(int param_1)

{
  int iVar1;
  
  if (param_1 == 0) {
    return 0;
  }
  iVar1 = *(int *)(param_1 + 4);
  if (iVar1 != 0) {
    iVar1 = iVar1 + 8;
  }
  return iVar1;
}




undefined4 * FUN_00010dcc(undefined4 *param_1,int param_2)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  undefined4 uVar5;
  
  if ((int *)param_1[1] == (int *)0x0) {
    uVar5 = 0;
LAB_00010e4c:
    *(undefined4 *)(param_2 + -8) = uVar5;
    param_1[1] = param_2 + -8;
  }
  else {
    piVar1 = (int *)param_1[1];
    piVar4 = (int *)0x0;
    do {
      piVar3 = piVar1;
      iVar2 = (*(code *)*param_1)(param_2,piVar3 + 2);
      if (iVar2 < 1) {
        if (piVar4 == (int *)0x0) {
          uVar5 = param_1[1];
          goto LAB_00010e4c;
        }
        break;
      }
      piVar4 = piVar3;
      piVar1 = (int *)*piVar3;
    } while ((int *)*piVar3 != (int *)0x0);
    *(int *)(param_2 + -8) = *piVar4;
    *piVar4 = param_2 + -8;
  }
  param_1[2] = param_1[2] + 1;
  return param_1;
}




undefined4 * FUN_00010e58(int param_1)

{
  undefined4 *puVar1;
  
  puVar1 = *(undefined4 **)(param_1 + 4);
  if (puVar1 == (undefined4 *)0x0) {
    return (undefined4 *)0x0;
  }
  *(undefined4 *)(param_1 + 4) = *puVar1;
  *(int *)(param_1 + 8) = *(int *)(param_1 + 8) + -1;
  return puVar1 + 2;
}




void FUN_00010e88(undefined4 param_1,int param_2)

{
  undefined4 *puVar1;
  
  if (param_2 != 0) {
    while (puVar1 = *(undefined4 **)(param_2 + 4), puVar1 != (undefined4 *)0x0) {
      *(undefined4 *)(param_2 + 4) = *puVar1;
      *(int *)(param_2 + 8) = *(int *)(param_2 + 8) + -1;
      FUN_00010dcc(param_1,puVar1 + 2);
    }
  }
  FUN_00010d2c(param_2);
  return;
}




void FUN_00010ed0(void)

{
  undefined4 *puVar1;
  
  puVar1 = (undefined4 *)FUN_0004f524(0xc);
  *puVar1 = &LAB_00010d00;
  puVar1[1] = 0;
  puVar1[2] = 0;
  return;
}




void FUN_00010ee0(int param_1)

{
  undefined4 uVar1;
  char *pcVar2;
  undefined4 uVar3;
  
  pcVar2 = "Listen and drop";
  uVar3 = *(undefined4 *)(param_1 + 0x10);
  if (*(int *)(param_1 + 0xb0) == 0) {
    pcVar2 = "Listen normally";
  }
  uVar1 = FUN_00050cd0(param_1 + 0x14);
  FUN_0004fe78(6,"%s on %d %s %s UDP %d",pcVar2,uVar3,param_1 + 0x68,uVar1,
               *(ushort *)(param_1 + 0x16) << 8 | *(ushort *)(param_1 + 0x16) >> 8);
  return;
}




void FUN_00010f54(uint param_1)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  uint uVar7;
  undefined4 *puVar8;
  bool bVar9;
  
  puVar5 = &DAT_000ca610;
  puVar8 = DAT_000ca610;
  if (DAT_000ca610[1] != param_1) {
    puVar8 = (undefined4 *)*DAT_000ca610;
    puVar5 = DAT_000ca610;
    if ((undefined4 *)*DAT_000ca610 == (undefined4 *)0x0) {
      return;
    }
    while (puVar6 = puVar8, puVar6[1] != param_1) {
      puVar8 = (undefined4 *)*puVar6;
      puVar5 = puVar6;
      if ((undefined4 *)*puVar6 == (undefined4 *)0x0) {
        return;
      }
    }
    puVar8 = (undefined4 *)*puVar5;
  }
  iVar4 = puVar8[2];
  *puVar5 = *puVar8;
  *puVar8 = 0;
  if ((iVar4 != 0) && (iVar4 != 1)) {
    FUN_0004fe78(3,"internal error - illegal descriptor type %d - EXITING");
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  close(puVar8[1]);
  free(puVar8);
  uVar2 = param_1 + 0x1f;
  if (-1 < (int)param_1) {
    uVar2 = param_1;
  }
  bVar9 = param_1 != DAT_000ca604;
  (&DAT_000ca584)[(int)uVar2 >> 5] = (&DAT_000ca584)[(int)uVar2 >> 5] & ~(1 << ((int)param_1 % 0x20 & 0xffU));
  if (bVar9) {
    return;
  }
  if (param_1 == 0) {
    return;
  }
  uVar2 = param_1;
  if (0x400 < (int)param_1) {
    (*DAT_0007c9fc)("ntp_io.c",0x108c,2,"maxactivefd - 1 < 1024");
    uVar2 = DAT_000ca604;
  }
  uVar7 = uVar2 - 1;
  uVar3 = uVar2;
  uVar1 = DAT_000ca604;
  if (-1 < (int)uVar7) {
    do {
      uVar3 = uVar7;
      uVar1 = uVar7;
      if (((int)(&DAT_000ca584)[(int)uVar7 >> 5] >> (uVar7 & 0x1f) & 1U) != 0) break;
      bVar9 = uVar7 != 0;
      uVar7 = uVar7 - 1;
      uVar3 = uVar2;
      uVar1 = DAT_000ca604;
    } while (bVar9);
  }
  DAT_000ca604 = uVar1;
  if (param_1 != uVar3) {
    return;
  }
  (*DAT_0007c9fc)("ntp_io.c",0x1092,2,"fd != maxactivefd");
  return;
}




void FUN_000110ec(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  
  puVar3 = &DAT_000ca618;
  puVar2 = DAT_000ca618;
  if (param_1 == DAT_000ca618) {
LAB_00011144:
    *puVar3 = *puVar2;
    *puVar2 = 0;
  }
  else if (DAT_000ca618 != (undefined4 *)0x0) {
    puVar2 = (undefined4 *)*DAT_000ca618;
    puVar3 = DAT_000ca618;
    while (puVar1 = puVar2, puVar1 != (undefined4 *)0x0) {
      if (param_1 == puVar1) {
        puVar2 = (undefined4 *)*puVar3;
        goto LAB_00011144;
      }
      if (puVar1 == (undefined4 *)0x0) break;
      puVar3 = puVar1;
      puVar2 = (undefined4 *)*puVar1;
    }
  }
  if (param_1[1] != -1) {
    FUN_00010f54();
  }
  param_1[1] = 0xffffffff;
  return;
}




undefined4 FUN_00011174(short *param_1)

{
  int iVar1;
  
  if (*param_1 == 2) {
    if (*(int *)(param_1 + 2) != 0) {
      return 0;
    }
  }
  else if ((*param_1 != 10) || (iVar1 = memcmp(param_1 + 4,in6addr_any,0x10), iVar1 != 0)) {
    return 0;
  }
  return 1;
}




void FUN_000111cc(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  int *piVar4;
  int local_1c [2];
  
  if (DAT_000ca654 != (int *)0x0) {
    piVar4 = DAT_000ca654;
    local_1c[0] = param_1;
    do {
      if ((piVar4[0x23] & 0x80U) == 0) {
        if (3 < DAT_0007cf4c) {
          uVar2 = FUN_00050cd0(piVar4 + 5);
          pcVar3 = "on";
          if (local_1c[0] == 0) {
            pcVar3 = "off";
          }
          printf("setting SO_REUSEADDR on %.16s@%s to %s\n",piVar4 + 0x1a,uVar2,pcVar3);
        }
        if (piVar4[2] != -1) {
          iVar1 = setsockopt(piVar4[2],1,2,local_1c,4);
          if (iVar1 != 0) {
            uVar2 = FUN_00050cd0(piVar4 + 5);
            pcVar3 = "on";
            if (local_1c[0] == 0) {
              pcVar3 = "off";
            }
            FUN_0004fe78(3,"set_reuseaddr: setsockopt(%s, SO_REUSEADDR, %s) failed: %m",uVar2,pcVar3);
          }
        }
      }
      piVar4 = (int *)*piVar4;
    } while (piVar4 != (int *)0x0);
  }
  return;
}




undefined4 FUN_000112c0(int param_1,int param_2,short *param_3)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 local_14;
  
  local_14 = 1;
  if (*param_3 == 2) {
    iVar1 = setsockopt(param_2,1,6,&local_14,4);
    if (iVar1 == 0) {
      if (1 < DAT_0007cf4c) {
        uVar2 = FUN_00050cd0(param_3);
        printf("Broadcast enabled on socket %d for address %s\n",param_2,uVar2);
      }
    }
    else {
      uVar2 = FUN_00050cd0(param_3);
      FUN_0004fe78(3,"setsockopt(SO_BROADCAST) enable failure on address %s: %m",uVar2);
    }
  }
  DAT_000ca628 = 1;
  *(uint *)(param_1 + 0x8c) = *(uint *)(param_1 + 0x8c) | 0x20;
  return 1;
}




void FUN_00011384(int param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  char *pcVar3;
  int *piVar4;
  int iVar5;
  int local_c;
  
  if (param_1 == 2) {
    piVar4 = &DAT_000ca608;
  }
  else {
    piVar4 = &DAT_000ca644;
  }
  iVar5 = *piVar4;
  if ((iVar5 != 0) && (*(int *)(iVar5 + 8) != -1)) {
    local_c = param_2;
    iVar1 = setsockopt(*(int *)(iVar5 + 8),1,2,&local_c,4);
    if (iVar1 != 0) {
      pcVar3 = "off";
      if (local_c != 0) {
        pcVar3 = "on";
      }
      FUN_0004fe78(3,"set_wildcard_reuse: setsockopt(SO_REUSEADDR, %s) failed: %m",pcVar3);
    }
    if (3 < DAT_0007cf4c) {
      pcVar3 = "off";
      if (local_c != 0) {
        pcVar3 = "on";
      }
      uVar2 = FUN_00050cd0(iVar5 + 0x14);
      printf("set SO_REUSEADDR to %s on %s\n",pcVar3,uVar2);
    }
  }
  return;
}




int FUN_00011458(short *param_1)

{
  short sVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  int *piVar5;
  bool bVar6;
  
  if (3 < DAT_0007cf4c) {
    uVar4 = FUN_00050cd0();
    printf("Searching for addr %s in list of addresses - ",uVar4);
  }
  iVar2 = DAT_0007cf4c;
  if (DAT_000ca64c != (int *)0x0) {
    sVar1 = *param_1;
    piVar5 = DAT_000ca64c;
    do {
      if ((short)piVar5[1] == sVar1) {
        if (sVar1 == 2) {
          bVar6 = piVar5[2] == *(int *)(param_1 + 2);
        }
        else {
          iVar3 = memcmp(piVar5 + 3,param_1 + 4,0x10);
          if (iVar3 != 0) goto LAB_0001148c;
          bVar6 = piVar5[7] == *(int *)(param_1 + 0xc);
        }
        if (bVar6) {
          if (3 < iVar2) {
            puts("FOUND");
          }
          return piVar5[8];
        }
      }
LAB_0001148c:
      piVar5 = (int *)*piVar5;
    } while (piVar5 != (int *)0x0);
  }
  if (iVar2 < 4) {
    return 0;
  }
  puts("NOT FOUND");
  return 0;
}




void * FUN_0001155c(void *param_1)

{
  undefined4 uVar1;
  void *__s;
  
  __s = (void *)FUN_0004f524(0xbc);
  if (param_1 == (void *)0x0) {
    memset(__s,0,0xbc);
    *(undefined4 *)((int)__s + 8) = 0xffffffff;
    *(undefined4 *)((int)__s + 0xc) = 0xffffffff;
    *(undefined2 *)((int)__s + 0x8a) = DAT_0007ce30;
  }
  else {
    memcpy(__s,param_1,0xbc);
  }
  uVar1 = DAT_000cb548;
  *(int *)((int)__s + 0x10) = DAT_0007ce34;
  DAT_0007ce34 = DAT_0007ce34 + 1;
  *(undefined4 *)((int)__s + 0x9c) = uVar1;
  return __s;
}




int FUN_000115d4(int param_1)

{
  int iVar1;
  int iVar2;
  
  if (param_1 < 0) {
    (*DAT_0007c9fc)("ntp_io.c",0x19e,0,"(int)fd >= 0");
  }
  if (DAT_000794f8 == -1) {
    iVar1 = getdtablesize();
    if ((iVar1 < 0x1a) && (iVar1 = getdtablesize(), iVar1 < 10)) {
      iVar1 = 0;
    }
    else {
      iVar1 = getdtablesize();
      if (iVar1 < 0x1a) {
        iVar1 = getdtablesize();
        iVar1 = iVar1 + -10;
      }
      else {
        iVar1 = 0x10;
      }
    }
    DAT_000794f8 = iVar1;
    iVar2 = getdtablesize();
    FUN_0004fe78(7,"ntp_io: estimated max descriptors: %d, initial socket boundary: %d",iVar2,iVar1);
  }
  if (-1 < param_1) {
    do {
      if (DAT_000794f8 <= param_1) {
        return param_1;
      }
      iVar1 = fcntl(param_1,0);
      iVar2 = 0;
      if (iVar1 != -1) {
        close(param_1);
        return iVar1;
      }
      if (9 < DAT_000794f8) {
        iVar2 = DAT_000794f8 + -10;
      }
      DAT_000794f8 = iVar2;
      FUN_0004fe78(7,"ntp_io: selecting new socket boundary: %d",iVar2);
    } while (0 < DAT_000794f8);
  }
  return param_1;
}




void FUN_00011704(byte *param_1)

{
  uint uVar1;
  byte *pbVar2;
  byte *pbVar3;
  
  pbVar2 = param_1 + 1;
  uVar1 = 1;
  printf("%02x",(uint)*param_1);
  while (pbVar3 = pbVar2, pbVar2 != param_1 + 0x1c) {
    while( true ) {
      uVar1 = uVar1 + 1;
      pbVar2 = pbVar3 + 1;
      printf("%02x",(uint)*pbVar3);
      if ((uVar1 & 3) != 0) break;
      putchar(0x20);
      pbVar3 = pbVar2;
      if (pbVar2 == param_1 + 0x1c) goto LAB_0001175c;
    }
  }
LAB_0001175c:
  putchar(10);
  return;
}




void FUN_0001176c(int param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  char *pcVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  int iVar10;
  
  uVar4 = *(undefined4 *)(param_1 + 0xc);
  iVar5 = param_1 + 0x14;
  uVar3 = *(undefined4 *)(param_1 + 0x10);
  uVar7 = *(undefined4 *)(param_1 + 8);
  uVar9 = *(undefined4 *)(param_1 + 0x8c);
  iVar6 = param_1 + 0x68;
  uVar8 = *(undefined4 *)(param_1 + 0xac);
  uVar1 = FUN_00050cd0(iVar5);
  iVar10 = iVar6;
  printf("%sinterface #%d: fd=%d, bfd=%d, name=%s, flags=0x%x, ifindex=%u, sin=%s",param_2,uVar3,uVar7,uVar4,iVar6,uVar9
         ,uVar8,uVar1);
  if (*(short *)(param_1 + 0x88) == 2) {
    if ((*(uint *)(param_1 + 0x8c) & 8) != 0) {
      uVar3 = FUN_00050cd0(param_1 + 0x4c);
      printf(", bcast=%s",uVar3);
    }
    uVar3 = FUN_00050cd0(param_1 + 0x30);
    printf(", mask=%s",uVar3);
  }
  pcVar2 = "Enabled";
  if (*(int *)(param_1 + 0xb0) != 0) {
    pcVar2 = "Disabled";
  }
  printf(", %s:%s",pcVar2,param_3,"Disabled",uVar4,iVar10,uVar9,uVar8,uVar1);
  if (DAT_0007cf4c < 5) {
    return;
  }
  printf("Dumping interface: %p\n",param_1);
  printf("fd = %d\n",*(undefined4 *)(param_1 + 8));
  printf("bfd = %d\n",*(undefined4 *)(param_1 + 0xc));
  uVar1 = FUN_00050cd0(iVar5);
  printf("sin = %s,\n",uVar1);
  FUN_00011704(iVar5);
  uVar1 = FUN_00050cd0(param_1 + 0x4c);
  printf("bcast = %s,\n",uVar1);
  FUN_00011704(param_1 + 0x4c);
  uVar1 = FUN_00050cd0(param_1 + 0x30);
  printf("mask = %s,\n",uVar1);
  FUN_00011704(param_1 + 0x30);
  printf("name = %s\n",iVar6);
  printf("flags = 0x%08x\n",*(undefined4 *)(param_1 + 0x8c));
  printf("last_ttl = %d\n",*(undefined4 *)(param_1 + 0x90));
  printf("addr_refid = %08x\n",*(undefined4 *)(param_1 + 0x94));
  printf("num_mcast = %d\n",*(undefined4 *)(param_1 + 0x98));
  printf("received = %ld\n",*(undefined4 *)(param_1 + 0xa0));
  printf("sent = %ld\n",*(undefined4 *)(param_1 + 0xa4));
  printf("notsent = %ld\n",*(undefined4 *)(param_1 + 0xa8));
  printf("ifindex = %u\n",*(undefined4 *)(param_1 + 0xac));
  printf("peercnt = %u\n",*(undefined4 *)(param_1 + 0xb8));
  printf("phase = %u\n",(uint)*(ushort *)(param_1 + 0x8a));
  return;
}




void FUN_000119c4(undefined4 *param_1)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint *puVar6;
  int iVar7;
  int *piVar8;
  char *pcVar9;
  uint *puVar10;
  undefined *puVar11;
  short sVar12;
  uint uVar13;
  uint *puVar14;
  undefined4 uVar15;
  char *pcVar16;
  int iVar17;
  short *psVar18;
  uint uVar19;
  bool bVar20;
  uint *puVar21;
  uint uVar22;
  char *pcVar23;
  int *local_40;
  uint local_3c;
  uint local_34;
  uint local_30;
  uint local_2c;
  
  psVar18 = (short *)(param_1 + 5);
  uVar2 = FUN_0004d0b4(psVar18);
  *param_1 = DAT_000ca654;
  DAT_000ca62c = DAT_000ca62c + 1;
  DAT_000ca654 = param_1;
  param_1[0x25] = uVar2;
  if (param_1[0x2c] != 0) {
    return;
  }
  if ((param_1[0x23] & 0x14) != 0x10) {
    return;
  }
  local_3c = 0;
  local_34 = local_3c;
  local_2c = local_3c;
  if (*(short *)(param_1 + 0x22) == 2) {
    local_40 = &DAT_000ca634;
  }
  else if (*(short *)(param_1 + 0x22) == 10) {
    if ((param_1[7] & 0xc0ff) == 0x80fe) {
      local_3c = 1;
    }
    else {
      local_3c = (uint)((param_1[7] & 0xc0ff) == 0xc0fe);
    }
    local_40 = &DAT_000ca630;
    local_2c = ((uint)*(byte *)(param_1 + 9) << 0x1e) >> 0x1f;
    local_34 = (uint)(param_1[0x23] << 0x16) >> 0x1f;
  }
  else {
    local_40 = &DAT_000ca630;
  }
  if (3 < DAT_0007cf4c) {
    uVar2 = FUN_00050cd0(psVar18);
    pcVar16 = "";
    pcVar23 = " privacy";
    if (local_34 == 0) {
      pcVar23 = pcVar16;
    }
    pcVar9 = " link/scope-local";
    if (local_3c == 0) {
      pcVar9 = pcVar16;
    }
    if (local_2c != 0) {
      pcVar16 = " univ-IID";
    }
    printf("add_interface mcast-capable %s%s%s%s\n",uVar2,pcVar9,pcVar16,pcVar23);
  }
  iVar5 = *local_40;
  if (*local_40 == 0) {
    if (local_3c == 0) {
      iVar5 = 0;
LAB_00011e6c:
      param_1[1] = iVar5;
      *local_40 = (int)param_1;
      goto LAB_00011df0;
    }
  }
  else {
    do {
      iVar17 = *(int *)(iVar5 + 4);
      if ((*(short *)(param_1 + 0x22) == *(short *)(iVar5 + 0x88)) &&
         (iVar3 = strcmp((char *)(param_1 + 0x1a),(char *)(iVar5 + 0x68)), iVar3 == 0)) {
        iVar3 = iVar5 + 0x14;
        if (*psVar18 != *(short *)(param_1 + 0xc)) {
          (*DAT_0007c9fc)("ntp_io.c",0x2ef,0,"((a)->sa.sa_family) == ((a_mask)->sa.sa_family)");
        }
        sVar12 = *(short *)(iVar5 + 0x30);
        if (*(short *)(iVar5 + 0x14) != sVar12) {
          (*DAT_0007c9fc)("ntp_io.c",0x2f0,0,"((b)->sa.sa_family) == ((b_mask)->sa.sa_family)");
          sVar12 = *(short *)(iVar5 + 0x30);
        }
        if (*(short *)(param_1 + 0xc) == sVar12) {
          if (sVar12 == 2) {
            iVar4 = param_1[0xd] - *(int *)(iVar5 + 0x34);
            if (iVar4 != 0) {
              iVar4 = 1;
            }
          }
          else {
            iVar4 = memcmp(param_1 + 0xe,(void *)(iVar5 + 0x38),0x10);
            if (iVar4 != 0) goto LAB_00011b18;
            iVar4 = param_1[0x12] - *(int *)(iVar5 + 0x48);
            if (iVar4 != 0) {
              iVar4 = 1;
            }
          }
          if (iVar4 != 0) goto LAB_00011b18;
          if (*psVar18 == 10) {
            puVar14 = param_1 + 7;
            iVar4 = 0x10;
          }
          else {
            puVar14 = param_1 + 6;
            iVar4 = 4;
          }
          puVar21 = (uint *)((int)puVar14 + iVar4);
          if (*psVar18 == 10) {
            puVar6 = (uint *)(iVar5 + 0x1c);
            puVar10 = param_1 + 0xe;
          }
          else {
            puVar6 = (uint *)(iVar5 + 0x18);
            puVar10 = param_1 + 0xd;
          }
          if (puVar14 < puVar21) {
            uVar13 = (*puVar14 ^ *puVar6) & *puVar10;
            while (uVar13 == 0) {
              puVar14 = puVar14 + 1;
              if (puVar21 <= puVar14) goto LAB_00011da0;
              puVar6 = puVar6 + 1;
              puVar10 = puVar10 + 1;
              uVar13 = (*puVar6 ^ *puVar14) & *puVar10;
            }
            goto LAB_00011b18;
          }
LAB_00011da0:
          bVar20 = true;
        }
        else {
LAB_00011b18:
          bVar20 = false;
        }
        if (*(short *)(param_1 + 0x22) == 10) {
          uVar13 = *(uint *)(iVar5 + 0x1c) & 0xc0ff;
          if (uVar13 == 0x80fe) {
            uVar13 = 0;
            local_30 = 1;
          }
          else {
            local_30 = (uint)(uVar13 == 0xc0fe);
            uVar13 = local_3c & (local_30 ^ 1);
          }
          uVar22 = ((uint)*(byte *)(iVar5 + 0x24) << 0x1e) >> 0x1f;
          uVar19 = (uint)(*(int *)(iVar5 + 0x8c) << 0x16) >> 0x1f;
        }
        else {
          uVar19 = 0;
          local_30 = 0;
          uVar22 = 0;
          uVar13 = local_3c;
        }
        if (3 < DAT_0007cf4c) {
          uVar2 = FUN_00050cd0(iVar3);
          pcVar16 = "";
          pcVar23 = " privacy";
          if (uVar19 == 0) {
            pcVar23 = pcVar16;
          }
          pcVar9 = " link/scope-local";
          if (local_30 == 0) {
            pcVar9 = pcVar16;
          }
          if (uVar22 != 0) {
            pcVar16 = " univ-IID";
          }
          printf("add_interface mcast-capable scan %s%s%s%s\n",uVar2,pcVar9,pcVar16,pcVar23);
        }
        iVar4 = DAT_0007cf4c;
        if (uVar13 != 0) {
LAB_00011fd0:
          if (DAT_0007cf4c < 4) {
            return;
          }
          uVar2 = FUN_00050cd0(psVar18);
          puVar11 = &DAT_0005c814;
          if (local_3c != 0) {
            puVar11 = &DAT_0005c80c;
          }
          uVar15 = FUN_00050cd0(iVar3);
          printf("did not add %s to %s of IPv6 multicast-capable list which already has %s\n",uVar2,puVar11,uVar15);
          return;
        }
        if (bVar20) {
          if ((((uVar19 ^ 1) & local_34) != 0) || ((uVar22 & (local_2c ^ 1)) != 0)) goto LAB_00011fd0;
          if (((local_30 & (local_3c ^ 1)) == 0) && ((uVar19 & (local_34 ^ 1)) == 0)) {
            local_30 = (uVar22 ^ 1) & local_2c;
            goto joined_r0x00011c44;
          }
        }
        else {
          local_30 = local_30 & (local_3c ^ 1);
joined_r0x00011c44:
          if (local_30 == 0) goto LAB_00011a70;
        }
        iVar7 = *local_40;
        piVar8 = local_40;
        if (iVar7 == iVar5) {
LAB_00011bb8:
          *piVar8 = *(int *)(iVar5 + 4);
          *(undefined4 *)(iVar5 + 4) = 0;
          if (3 < iVar4) {
            pcVar16 = "removed";
LAB_0001203c:
            uVar2 = FUN_00050cd0(iVar3);
            uVar15 = FUN_00050cd0(psVar18);
            printf("%s %s from IPv6 multicast-capable list to add %s\n",pcVar16,uVar2,uVar15);
          }
        }
        else {
          if (iVar7 != 0) {
            for (iVar1 = *(int *)(iVar7 + 4); iVar1 != 0; iVar1 = *(int *)(iVar1 + 4)) {
              if (iVar1 == iVar5) {
                piVar8 = (int *)(iVar7 + 4);
                iVar5 = iVar1;
                goto LAB_00011bb8;
              }
              if (iVar1 == 0) break;
              iVar7 = iVar1;
            }
          }
          if (3 < DAT_0007cf4c) {
            pcVar16 = "Failed to remove";
            goto LAB_0001203c;
          }
        }
      }
LAB_00011a70:
      iVar5 = iVar17;
    } while (iVar17 != 0);
    iVar5 = *local_40;
    if (local_3c == 0) goto LAB_00011e6c;
    if (iVar5 != 0) {
      do {
        iVar17 = iVar5;
        iVar5 = *(int *)(iVar17 + 4);
      } while (iVar5 != 0);
      local_40 = (int *)(iVar17 + 4);
    }
  }
  param_1[1] = 0;
  *local_40 = (int)param_1;
LAB_00011df0:
  if (3 < DAT_0007cf4c) {
    uVar2 = FUN_00050cd0(psVar18);
    puVar11 = &DAT_0005c80c;
    if (local_3c == 0) {
      puVar11 = &DAT_0005c814;
    }
    pcVar16 = "b->used - b->current >= 6";
    if (*(short *)(param_1 + 0x22) == 2) {
      pcVar16 = "b->used - b->current >= 4";
    }
    printf("added %s to %s of IPv%s multicast-capable unicast local address list\n",uVar2,puVar11,pcVar16 + 0x18);
  }
  if (*(short *)(param_1 + 5) == 2) {
    iVar5 = setsockopt(param_1[2],0,0x20,param_1 + 6,4);
    if (iVar5 != 0) {
      uVar2 = FUN_00050cd0(psVar18);
      FUN_0004fe78(3,"setsockopt IP_MULTICAST_IF %s fails: %m",uVar2);
      return;
    }
  }
  else if ((*(short *)(param_1 + 5) == 10) && (iVar5 = setsockopt(param_1[2],0x29,0x11,param_1 + 0x2b,4), iVar5 != 0)) {
    uVar15 = param_1[0x2b];
    uVar2 = FUN_00050cd0(psVar18);
    FUN_0004fe78(3,"setsockopt IPV6_MULTICAST_IF %u for %s fails: %m",uVar15,uVar2);
    return;
  }
  return;
}




void FUN_00012224(uint param_1,undefined4 param_2)

{
  uint uVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)FUN_0004f524(0xc);
  puVar2[1] = param_1;
  puVar2[2] = param_2;
  *puVar2 = DAT_000ca610;
  DAT_000ca610 = puVar2;
  if (param_1 < 0x400) {
    uVar1 = param_1;
    if ((int)param_1 < (int)DAT_000ca604) {
      uVar1 = DAT_000ca604;
    }
    DAT_000ca604 = uVar1;
    (&DAT_000ca584)[(int)param_1 >> 5] = (&DAT_000ca584)[(int)param_1 >> 5] | 1 << (param_1 & 0x1f);
    return;
  }
  FUN_0004fe78(3,"Too many sockets in use, FD_SETSIZE %d exceeded",0x400);
                    /* WARNING: Subroutine does not return */
  exit(1);
}




char * FUN_000122b0(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  if (param_1 == 1) {
    return "ignore";
  }
  if (param_1 != 0) {
    if (param_1 != 2) {
      if (0 < DAT_0007cf4c) {
        printf("fatal: unknown nic_rule_action %d\n",param_1,param_3,DAT_0007cf4c,param_4);
      }
      (*DAT_0007c9fc)("ntp_io.c",0x52e,1,"0");
      return "ERROR";
    }
    return "drop";
  }
  return "listen";
}




int FUN_00012344(char *param_1,int *param_2,uint param_3)

{
  bool bVar1;
  undefined4 uVar2;
  int iVar3;
  char *pcVar4;
  int *piVar5;
  int iVar6;
  undefined1 auStack_80 [24];
  undefined1 auStack_68 [24];
  int local_50;
  int local_4c;
  int local_48;
  int local_44;
  int local_40;
  int local_3c;
  int local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  
  if (3 < DAT_0007cf4c) {
    pcVar4 = "wildcard";
    if (param_1 != (char *)0x0) {
      pcVar4 = param_1;
    }
    uVar2 = FUN_00050cd0(param_2);
    printf("interface_action: %s %s ",pcVar4,uVar2);
  }
  iVar3 = FUN_00011174(param_2);
  if ((param_3 & 4) == 0) {
    bVar1 = false;
  }
  else {
    if ((short)*param_2 == 2) {
      if (DAT_0007cf4c < 4) {
        return 0;
      }
      puts("IPv4 loopback - listen");
      return 0;
    }
    bVar1 = true;
  }
  if (DAT_000ca624 != (int *)0x0) {
    piVar5 = DAT_000ca624;
    do {
      switch(piVar5[2]) {
      case 0:
        if (!bVar1 && iVar3 == 0) {
          if (3 < DAT_0007cf4c) {
            uVar2 = FUN_000122b0(piVar5[1]);
            printf("nic all %s\n",uVar2);
          }
          goto LAB_00012534;
        }
        break;
      case 1:
        if ((short)*param_2 == 2) {
          if (3 < DAT_0007cf4c) {
            uVar2 = FUN_000122b0(piVar5[1]);
            printf("nic ipv4 %s\n",uVar2);
          }
          goto LAB_00012534;
        }
        break;
      case 2:
        if ((short)*param_2 == 10) {
          if (3 < DAT_0007cf4c) {
            uVar2 = FUN_000122b0(piVar5[1]);
            printf("nic ipv6 %s\n",uVar2);
          }
          goto LAB_00012534;
        }
        break;
      case 3:
        if (iVar3 != 0) {
          if (3 < DAT_0007cf4c) {
            uVar2 = FUN_000122b0(piVar5[1]);
            printf("nic wildcard %s\n",uVar2);
          }
          goto LAB_00012534;
        }
        break;
      case 4:
        if ((param_1 != (char *)0x0) && (iVar6 = strcasecmp(param_1,(char *)piVar5[3]), iVar6 == 0)) {
          if (3 < DAT_0007cf4c) {
            uVar2 = FUN_000122b0(piVar5[1]);
            printf("interface name match - %s\n",uVar2);
          }
          goto LAB_00012534;
        }
        break;
      case 5:
        iVar6 = piVar5[0xb];
        if (iVar6 == -1) {
          if ((short)piVar5[4] == (short)*param_2) {
            if ((short)piVar5[4] == 2) {
              iVar6 = param_2[1] - piVar5[5];
            }
            else {
              iVar6 = memcmp(param_2 + 2,piVar5 + 6,0x10);
              if (iVar6 != 0) break;
              iVar6 = param_2[6] - piVar5[10];
            }
            if (iVar6 == 0) {
              if (3 < DAT_0007cf4c) {
                uVar2 = FUN_000122b0(piVar5[1]);
                printf("address match - %s\n",uVar2);
              }
LAB_00012534:
              return piVar5[1];
            }
          }
        }
        else {
          local_50 = *param_2;
          local_4c = param_2[1];
          local_48 = param_2[2];
          local_44 = param_2[3];
          local_34 = 0;
          local_30 = 0;
          local_40 = param_2[4];
          local_3c = param_2[5];
          local_38 = param_2[6];
          local_2c = 0;
          FUN_00056944(auStack_80,&local_50);
          local_34 = 0;
          local_30 = 0;
          local_2c = 0;
          local_50 = piVar5[4];
          local_4c = piVar5[5];
          local_48 = piVar5[6];
          local_44 = piVar5[7];
          local_38 = piVar5[10];
          local_40 = piVar5[8];
          local_3c = piVar5[9];
          FUN_00056944(auStack_68,&local_50);
          iVar6 = FUN_000563ec(auStack_80,auStack_68,iVar6);
          if (iVar6 != 0) {
            if (3 < DAT_0007cf4c) {
              uVar2 = FUN_000122b0(piVar5[1]);
              printf("subnet address match - %s\n",uVar2);
            }
            goto LAB_00012534;
          }
        }
      }
      piVar5 = (int *)*piVar5;
    } while (piVar5 != (int *)0x0);
  }
  if (bVar1) {
    if (DAT_0007cf4c < 4) {
      return 0;
    }
    puts("default loopback listen");
    return 0;
  }
  if (iVar3 != 0) {
    if (DAT_0007cf4c < 4) {
      return 2;
    }
    puts("default wildcard drop");
    return 2;
  }
  if (((DAT_00079500 == 0) && (param_1 != (char *)0x0)) && (pcVar4 = strchr(param_1,0x3a), pcVar4 != (char *)0x0)) {
    if (3 < DAT_0007cf4c) {
      puts("virtual ip - ignore");
      return 1;
    }
  }
  else {
    if (DAT_000ca624 == (int *)0x0) {
      if (DAT_0007cf4c < 4) {
        return 0;
      }
      puts("default listen");
      return 0;
    }
    if (3 < DAT_0007cf4c) {
      puts("implicit ignore");
      return 1;
    }
  }
  return 1;
}




void FUN_000127d4(undefined4 *param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  
  iVar1 = FUN_00011458();
  if (iVar1 == 0) {
    puVar3 = (undefined4 *)FUN_0004f524(0x24);
    uVar2 = param_1[1];
    uVar4 = param_1[2];
    uVar5 = param_1[3];
    puVar3[1] = *param_1;
    puVar3[2] = uVar2;
    puVar3[3] = uVar4;
    puVar3[4] = uVar5;
    iVar1 = DAT_0007cf4c;
    uVar2 = param_1[4];
    uVar4 = param_1[5];
    uVar5 = param_1[6];
    puVar3[8] = param_2;
    puVar3[5] = uVar2;
    puVar3[6] = uVar4;
    puVar3[7] = uVar5;
    *puVar3 = DAT_000ca64c;
    DAT_000ca64c = puVar3;
    if (iVar1 < 4) {
      return;
    }
    uVar2 = FUN_00050cd0(param_1);
    printf("Added addr %s to list of addresses\n",uVar2);
    return;
  }
  if (DAT_0007cf4c < 4) {
    return;
  }
  uVar2 = FUN_00050cd0(param_1);
  printf("WARNING: Attempt to add duplicate addr %s to address list\n",uVar2);
  return;
}




bool FUN_00012884(short *param_1)

{
  undefined4 uVar1;
  bool bVar2;
  
  if (*param_1 == 2) {
    bVar2 = (*(uint *)(param_1 + 2) & 0xf0) == 0xe0;
  }
  else {
    bVar2 = (char)param_1[4] == -1;
  }
  if ((bVar2 == false) && (3 < DAT_0007cf4c)) {
    uVar1 = FUN_00050cd0();
    printf("address %s is not multicast\n",uVar1);
    return false;
  }
  return bVar2;
}




ssize_t FUN_00012900(int param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  ssize_t sVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  char *pcVar6;
  int *piVar7;
  uint uVar8;
  uint *puVar9;
  void *pvVar10;
  double dVar11;
  socklen_t local_684;
  iovec local_680;
  msghdr local_678;
  sockaddr sStack_65c;
  uint local_640 [384];
  
  iVar1 = FUN_00050a8c();
  if (iVar1 != 0) {
    local_678.msg_flags = *(int *)(param_2 + 0xb0);
    if (local_678.msg_flags == 0) {
      local_680.iov_base = (void *)(iVar1 + 0x5c);
      pvVar10 = (void *)(iVar1 + 8);
      local_684 = 0x1c;
      local_678.msg_iov = &local_680;
      local_678.msg_namelen = 0x1c;
      local_678.msg_control = local_640;
      local_680.iov_len = 1000;
      local_678.msg_iovlen = 1;
      local_678.msg_controllen = 0x600;
      local_678.msg_name = pvVar10;
      sVar2 = recvmsg(param_1,&local_678,0);
      *(ssize_t *)(iVar1 + 0x58) = sVar2;
      if (sVar2 != 0) {
        if (sVar2 == -1) {
          piVar7 = __errno_location();
          if (*piVar7 == 0xb) goto LAB_00012b68;
        }
        else if (-1 < sVar2) {
          if (2 < DAT_0007cf4c) {
            uVar3 = FUN_00050cd0(pvVar10);
            printf("read_network_packet: fd=%d length %d from %s\n",param_1,sVar2,uVar3);
          }
          *(int *)(iVar1 + 0x40) = param_2;
          *(int *)(iVar1 + 0x44) = param_1;
          if ((0xb < local_678.msg_controllen) && ((uint *)local_678.msg_control != (uint *)0x0)) {
            puVar9 = (uint *)local_678.msg_control;
            if (*(uint *)((int)local_678.msg_control + 8) == 0x1d) goto LAB_00012bb0;
            do {
              if (3 < DAT_0007cf4c) {
                printf("fetch_timestamp: skipping control message 0x%x\n");
              }
              while( true ) {
                uVar8 = *puVar9;
                puVar9 = (uint *)((int)puVar9 + (uVar8 + 3 & 0xfffffffc));
                if (((uVar8 < 0xc) || ((uint *)((int)local_678.msg_control + local_678.msg_controllen) < puVar9 + 3)) ||
                   ((uint *)((int)local_678.msg_control + local_678.msg_controllen) <
                    (uint *)((int)puVar9 + (*puVar9 + 3 & 0xfffffffc)))) goto LAB_00012adc;
                if (puVar9[2] != 0x1d) break;
LAB_00012bb0:
                if (3 < DAT_0007cf4c) {
                  printf("fetch_timestamp: system network time stamp: %ld.%06ld\n",puVar9[3],puVar9[4]);
                }
                uVar8 = puVar9[4];
                param_3 = puVar9[3] + 0x83aa7e80;
                iVar5 = FUN_000504ec();
                dVar11 = (((double)(longlong)(int)uVar8 +
                          ((double)(longlong)iVar5 + (double)(longlong)iVar5) * 2.3283064365386963e-10) / 1000000.0) *
                         4294967296.0;
                param_4 = (uint)(0.0 < dVar11) * (int)(longlong)dVar11;
              }
            } while( true );
          }
LAB_00012adc:
          *(code **)(iVar1 + 0x54) = FUN_00025508;
          *(int *)(iVar1 + 0x4c) = param_3;
          *(int *)(iVar1 + 0x50) = param_4;
          FUN_00050a30(iVar1);
          *(int *)(param_2 + 0xa0) = *(int *)(param_2 + 0xa0) + 1;
          DAT_000ca640 = DAT_000ca640 + 1;
          return sVar2;
        }
        uVar3 = FUN_00050cd0(pvVar10);
        FUN_0004fe78(3,"recvfrom(%s) fd=%d: %m",uVar3,param_1);
        if (4 < DAT_0007cf4c) {
          printf("read_network_packet: fd=%d dropped (bad recvfrom)\n",param_1);
        }
      }
LAB_00012b68:
      FUN_000509c4(iVar1);
      return sVar2;
    }
    FUN_000509c4();
  }
  local_684 = 0x1c;
  sVar2 = recvfrom(param_1,local_640,1000,0,&sStack_65c,&local_684);
  if (3 < DAT_0007cf4c) {
    pcVar6 = "drop";
    if (*(int *)(param_2 + 0xb0) != 0) {
      pcVar6 = "ignore";
    }
    uVar3 = FUN_000508d8();
    uVar4 = FUN_00050cd0(&sStack_65c);
    printf("%s on (%lu) fd=%d from %s\n",pcVar6,uVar3,param_1,uVar4);
  }
  if (*(int *)(param_2 + 0xb0) == 0) {
    piVar7 = &DAT_000ca620;
  }
  else {
    piVar7 = &DAT_000ca650;
  }
  *piVar7 = *piVar7 + 1;
  return sVar2;
}




void FUN_00012c84(int param_1)

{
  int iVar1;
  
  iVar1 = fcntl(param_1,4,0x800);
  if (-1 < iVar1) {
    return;
  }
  FUN_0004fe78(3,"fcntl(O_NONBLOCK) fails on fd #%d: %m",param_1);
                    /* WARNING: Subroutine does not return */
  exit(1);
}




int FUN_00012cbc(sockaddr *param_1,int param_2,int param_3,int param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  char *pcVar7;
  socklen_t __len;
  char *pcVar8;
  sa_family_t sVar9;
  bool bVar10;
  undefined8 uVar11;
  undefined4 local_38;
  undefined4 local_34;
  char local_30 [20];
  
  local_38 = 1;
  local_34 = 0;
  if ((param_1->sa_family == 10) && (DAT_000cb864 == 0)) {
    return -1;
  }
  iVar1 = socket((uint)param_1->sa_family,2,0);
  if (iVar1 == -1) {
    piVar4 = __errno_location();
    pcVar8 = "";
    if (param_1->sa_family == 10) {
      pcVar8 = "6";
    }
    iVar1 = *piVar4;
    uVar5 = FUN_00050cd0(param_1);
    FUN_0004fe78(3,"socket(AF_INET%s, SOCK_DGRAM, 0) failed on address %s: %m",pcVar8,uVar5);
    if (iVar1 == 0x5d || iVar1 == 0x61) {
      return -1;
    }
    if (iVar1 == 0x60) {
      return -1;
    }
    *piVar4 = iVar1;
    FUN_0004fe78(3,
                 "unexpected socket() error %m code %d (not EPROTONOSUPPORT nor EAFNOSUPPORT nor EPFNOSUPPORT) - exiting"
                 ,iVar1);
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  iVar1 = FUN_000115d4();
  if (param_3 == 0) {
    iVar2 = setsockopt(iVar1,1,2,&local_38,4);
    if (iVar2 != 0) {
      pcVar8 = "on";
LAB_00012eb8:
      uVar5 = FUN_00050cd0(param_1);
      FUN_0004fe78(3,"setsockopt SO_REUSEADDR %s fails for address %s: %m",pcVar8,uVar5);
      close(iVar1);
      return -1;
    }
  }
  else {
    iVar2 = setsockopt(iVar1,1,2,&local_34,4);
    if (iVar2 != 0) {
      pcVar8 = "off";
      goto LAB_00012eb8;
    }
  }
  sVar9 = param_1->sa_family;
  if (sVar9 == 2) {
    iVar2 = setsockopt(iVar1,0,1,&DAT_000794fc,4);
    uVar5 = DAT_000794fc;
    if (iVar2 != 0) {
      uVar6 = FUN_00050cd0(param_1);
      FUN_0004fe78(3,"setsockopt IP_TOS (%02x) fails on address %s: %m",uVar5,uVar6);
    }
    if (param_2 != 0) {
      FUN_000112c0(param_4,iVar1,param_1);
    }
    sVar9 = param_1->sa_family;
  }
  if (sVar9 == 10) {
    iVar2 = FUN_00055f6c();
    if ((iVar2 == 0) && (iVar2 = setsockopt(iVar1,0x29,0x1a,&local_38,4), iVar2 != 0)) {
      uVar5 = FUN_00050cd0(param_1);
      FUN_0004fe78(3,"setsockopt IPV6_V6ONLY on fails on address %s: %m",uVar5);
    }
    sVar9 = param_1->sa_family;
  }
  iVar2 = FUN_00011174(param_1);
  if (iVar2 == 0) {
    FUN_00011384(sVar9,1);
    sVar9 = param_1->sa_family;
  }
  if (sVar9 == 2) {
    __len = 0x10;
  }
  else {
    __len = 0x1c;
  }
  iVar2 = bind(iVar1,param_1,__len);
  iVar3 = FUN_00011174(param_1);
  if (iVar3 == 0) {
    FUN_00011384(param_1->sa_family);
  }
  if (iVar2 < 0) {
    if ((param_3 == 0) || (1 < DAT_0007cf4c)) {
      sVar9 = param_1->sa_family;
      if ((sVar9 == 2) || (*(int *)(param_1[1].sa_data + 6) == 0)) {
        local_30[0] = '\0';
      }
      else {
        snprintf(local_30,0x10,"%%%d");
        sVar9 = param_1->sa_family;
      }
      pcVar8 = "";
      if (sVar9 == 10) {
        pcVar8 = "6";
      }
      uVar5 = FUN_00050cd0(param_1);
      if (param_1->sa_family == 2) {
        bVar10 = (*(uint *)(param_1->sa_data + 2) & 0xf0) == 0xe0;
      }
      else {
        bVar10 = param_1->sa_data[6] == -1;
      }
      pcVar7 = "";
      if (bVar10) {
        pcVar7 = " (multicast)";
      }
      FUN_0004fe78(3,"bind(%d) AF_INET%s %s%s#%d%s flags 0x%x failed: %m",iVar1,pcVar8,uVar5,local_30,
                   *(ushort *)param_1->sa_data << 8 | *(ushort *)param_1->sa_data >> 8,pcVar7,
                   *(undefined4 *)(param_4 + 0x8c));
    }
    close(iVar1);
    return -1;
  }
  iVar2 = setsockopt(iVar1,1,0x1d,&local_38,4);
  if (iVar2 == 0) {
    if (DAT_0007cf4c < 4) goto LAB_00012dc0;
    uVar5 = FUN_00050cd0(param_1);
    printf("setsockopt SO_TIMESTAMP enabled on fd %d address %s\n",iVar1,uVar5);
  }
  else {
    uVar5 = FUN_00050cd0(param_1);
    FUN_0004fe78(7,"setsockopt SO_TIMESTAMP on fails on address %s: %m",uVar5);
  }
  if (3 < DAT_0007cf4c) {
    pcVar8 = "";
    if (param_1->sa_family == 10) {
      pcVar8 = "6";
    }
    uVar11 = FUN_00050cd0(param_1);
    uVar5 = (undefined4)((ulonglong)uVar11 >> 0x20);
    bVar10 = param_1->sa_family != 2;
    if (bVar10) {
      uVar5 = *(undefined4 *)(param_1[1].sa_data + 6);
    }
    if (!bVar10) {
      uVar5 = 0;
    }
    printf("bind(%d) AF_INET%s, addr %s%%%d#%d, flags 0x%x\n",iVar1,pcVar8,(int)uVar11,uVar5,
           (*(ushort *)param_1->sa_data & 0xff) << 8 | (uint)(*(ushort *)param_1->sa_data >> 8),
           *(undefined4 *)(param_4 + 0x8c));
  }
LAB_00012dc0:
  FUN_00012c84(iVar1);
  FUN_00012224(iVar1,0);
  if (3 < DAT_0007cf4c) {
    iVar2 = fcntl(iVar1,3,0);
    printf("flags for fd %d: 0x%x\n",iVar1,iVar2);
    return iVar1;
  }
  return iVar1;
}




int FUN_000131c8(short *param_1)

{
  short sVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  int *piVar5;
  bool bVar6;
  
  if (3 < DAT_0007cf4c) {
    uVar4 = FUN_00050cd0();
    printf("Finding addr %s with flags %d in list: ",uVar4,0x40);
  }
  iVar2 = DAT_0007cf4c;
  if (DAT_000ca64c != (int *)0x0) {
    sVar1 = *param_1;
    piVar5 = DAT_000ca64c;
    do {
      if ((short)piVar5[1] == sVar1) {
        if (sVar1 == 2) {
          bVar6 = piVar5[2] == *(int *)(param_1 + 2);
        }
        else {
          iVar3 = memcmp(piVar5 + 3,param_1 + 4,0x10);
          if (iVar3 != 0) goto LAB_000131fc;
          bVar6 = piVar5[7] == *(int *)(param_1 + 0xc);
        }
        if ((bVar6) && ((*(uint *)(piVar5[8] + 0x8c) & 0x40) != 0)) {
          if (iVar2 < 4) {
            return piVar5[8];
          }
          puts("FOUND");
          return piVar5[8];
        }
      }
LAB_000131fc:
      piVar5 = (int *)*piVar5;
    } while (piVar5 != (int *)0x0);
  }
  if (iVar2 < 4) {
    return 0;
  }
  puts("NOT FOUND");
  return 0;
}




int FUN_000132e0(code *param_1,undefined4 param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  char *pcVar8;
  uint uVar9;
  undefined4 uVar10;
  uint uVar11;
  undefined4 *puVar12;
  char *pcVar13;
  undefined4 *puVar14;
  uint uVar15;
  undefined4 *local_1cc;
  int local_1c4;
  undefined4 local_1b4;
  undefined4 *local_1b0;
  undefined1 local_1ac;
  uint local_1a8;
  undefined4 local_1a4;
  undefined4 local_1a0;
  undefined4 local_19c;
  undefined4 local_198;
  undefined4 local_194;
  undefined4 local_190;
  uint local_18c;
  undefined4 local_188;
  undefined4 local_184;
  undefined4 local_180;
  undefined4 local_17c;
  undefined4 local_178;
  undefined4 local_174;
  char acStack_170 [32];
  uint local_150;
  uint local_14c;
  uint local_148;
  undefined4 local_118;
  uint local_ec;
  undefined4 local_e8;
  undefined1 auStack_e4 [8];
  undefined4 local_dc;
  undefined4 local_d8;
  undefined2 local_d0;
  undefined2 local_ce;
  uint local_cc;
  undefined1 local_c8 [20];
  undefined2 local_b4;
  undefined2 local_b2;
  undefined2 local_98;
  undefined2 local_96;
  undefined4 local_94;
  char acStack_7c [31];
  undefined1 local_5d;
  undefined2 local_5c;
  ushort local_5a;
  uint local_58;
  undefined4 local_38;
  int local_34;
  
  if (2 < DAT_0007cf4c) {
    printf("update_interfaces(%d)\n",0x7b);
  }
  local_1b4 = 0;
  iVar2 = FUN_000520bc(0xffffffff,&local_1b4);
  if (iVar2 == 0) {
    DAT_0007ce30 = DAT_0007ce30 ^ 1;
    iVar2 = FUN_000523c8(local_1b4);
    if (iVar2 == 0) {
      iVar2 = 0;
      local_1c4 = 0;
      do {
        while( true ) {
          iVar3 = FUN_00052370(local_1b4,acStack_170);
          if (iVar3 != 0) goto LAB_00013544;
          if ((local_14c & 0xfffffff7) == 2) break;
LAB_000134e8:
          iVar3 = FUN_00052468(local_1b4);
          if (iVar3 != 0) goto LAB_00013544;
        }
        if (local_14c != 2) {
          if ((local_14c != 10) || (DAT_000cb864 != 0)) goto LAB_00013378;
          goto LAB_000134e8;
        }
        if (DAT_000cb868 != 0) {
LAB_00013378:
          uVar11 = 0;
          memset(auStack_e4,0,0xbc);
          local_5a = DAT_0007ce30;
          local_dc = 0xffffffff;
          local_d8 = 0xffffffff;
          local_18c = 0;
          local_188 = 0;
          local_184 = 0;
          local_180 = 0x1000000;
          strncpy(acStack_7c,acStack_170,0x20);
          uVar1 = local_ec;
          local_5d = 0;
          uVar15 = local_150 & 0xffff;
          local_ce = 0x7b00;
          local_d0 = (undefined2)local_150;
          local_38 = local_e8;
          local_b2 = 0x7b00;
          local_96 = 0x7b00;
          if (uVar15 == 2) {
            local_cc = local_148;
            uVar11 = local_ec & 8;
            if (uVar11 != 0) {
              uVar11 = 8;
              local_94 = local_118;
            }
          }
          else if (uVar15 != 10) {
            uVar11 = 0;
          }
          if ((local_ec & 0x20) == 0) {
            uVar9 = 0;
          }
          else {
            uVar9 = 0x200;
          }
          local_58 = uVar9 | local_ec & 0x17 | uVar11;
          local_b4 = local_d0;
          local_98 = local_d0;
          local_5c = local_d0;
          if ((local_ec & 4) != 0) {
            if (uVar15 == 2) {
              if ((local_cc & 0xff) != 0x7f) goto LAB_0001348c;
            }
            else {
              iVar3 = memcmp(&local_18c,local_c8,0x10);
              if (iVar3 != 0) {
LAB_0001348c:
                local_58 = uVar9 | uVar1 & 0x13 | uVar11;
              }
            }
          }
          iVar3 = FUN_00012344(acStack_7c,&local_d0,local_58);
          if (iVar3 != 1) {
            if (iVar3 == 0) {
              local_34 = 0;
            }
            else if (iVar3 == 2) {
              local_34 = 1;
            }
            if (3 < DAT_0007cf4c) {
              FUN_0001176c(auStack_e4,"examining ","\n");
            }
            if ((local_58 & 1) == 0) {
              if (3 < DAT_0007cf4c) {
                uVar4 = FUN_00050cd0(&local_d0);
                printf("skipping interface %s (%s) - DOWN\n",acStack_7c,uVar4);
              }
            }
            else {
              iVar3 = FUN_00011174(&local_d0);
              if (iVar3 == 0) {
                puVar12 = (undefined4 *)FUN_00011458(&local_d0);
                if (((puVar12 == (undefined4 *)0x0) || ((puVar12[0x23] & 0x80) != 0)) || (puVar12[2] == -1)) {
                  if (1 < DAT_0007cf4c) {
                    uVar4 = FUN_00050cd0(&local_d0);
                    printf("create_interface(%s#%d)\n",uVar4,0x7b);
                  }
                  puVar12 = (undefined4 *)FUN_0001155c(auStack_e4);
                  puVar14 = puVar12 + 5;
                  iVar3 = FUN_00012cbc(puVar14,0,0,puVar12);
                  puVar12[2] = iVar3;
                  if (iVar3 != -1) {
                    FUN_00010ee0(puVar12);
                  }
                  if (((puVar12[0x23] & 8) != 0) && (puVar12[3] != -1)) {
                    uVar4 = FUN_00050cd0(puVar12 + 0x13);
                    FUN_0004fe78(6,"Listening on broadcast address %s#%d",uVar4,0x7b);
                  }
                  if ((puVar12[2] == -1) && (puVar12[3] == -1)) {
                    uVar10 = puVar12[4];
                    uVar4 = FUN_00050cd0(puVar14);
                    FUN_0004fe78(3,"unable to create socket on %s (%d) for %s#%d",puVar12 + 0x1a,uVar10,uVar4,0x7b);
                    free(puVar12);
                    if (2 < DAT_0007cf4c) {
                      FUN_0001176c(auStack_e4,"updating "," new - creation FAILED");
                    }
                    uVar4 = FUN_00050cd0(&local_d0);
                    FUN_0004fe78(6,"failed to init interface for address %s",uVar4);
                  }
                  else {
                    local_1a4 = 0;
                    local_1a0 = 0;
                    local_19c = 0;
                    local_198 = 0;
                    local_194 = 0;
                    local_190 = 0;
                    local_1a8 = (uint)*(ushort *)(puVar12 + 5);
                    if (*(ushort *)(puVar12 + 5) == 10) {
                      memset(&local_1a0,0xff,0x10);
                    }
                    else {
                      local_1a4 = 0xffffffff;
                    }
                    FUN_0002cc48(1,puVar14,&local_1a8,0x3000,1);
                    if (((DAT_000ca61c == (undefined4 *)0x0) && (*(short *)(puVar12 + 0x22) == 2)) &&
                       ((puVar12[0x23] & 4) != 0)) {
                      DAT_000ca61c = puVar12;
                    }
                    FUN_000127d4(puVar14,puVar12);
                    FUN_000119c4(puVar12);
                    if (1 < DAT_0007cf4c) {
                      FUN_0001176c(puVar12,"created ","\n");
                    }
                    local_1ac = 2;
                    local_1b0 = puVar12;
                    if (param_1 != (code *)0x0) {
                      (*param_1)(param_2,&local_1b0);
                    }
                    if (3 < DAT_0007cf4c) {
                      uVar4 = FUN_00050cd0(puVar14);
                      printf("refreshing peers due to new addr %s\n",uVar4);
                    }
                    if (DAT_0007cf4c < 3) {
                      iVar2 = 1;
                      local_1c4 = iVar2;
                    }
                    else {
                      iVar2 = 1;
                      FUN_0001176c(puVar12,"updating "," new - created\n");
                      local_1c4 = 1;
                    }
                  }
                }
                else {
                  pcVar13 = (char *)(puVar12 + 0x1a);
                  if (*(ushort *)((int)puVar12 + 0x8a) == DAT_0007ce30) {
                    strncpy(pcVar13,"*multiple*",0x20);
LAB_00013b30:
                    if (3 < DAT_0007cf4c) {
                      FUN_0001176c(puVar12,"updating "," present\n");
                    }
                    iVar3 = puVar12[0x2c];
                  }
                  else {
                    strncpy(pcVar13,acStack_7c,0x20);
                    iVar3 = DAT_0007cf4c;
                    if (puVar12[0x2c] == local_34) goto LAB_00013b30;
                    puVar12[0x2c] = local_34;
                    if (3 < iVar3) {
                      iVar2 = 1;
                      uVar4 = FUN_00050cd0(puVar12 + 5);
                      printf("refreshing peers due to %s ignore_packets change to %d\n",uVar4,puVar12[0x2c]);
                      goto LAB_00013b30;
                    }
                    iVar2 = 1;
                    iVar3 = local_34;
                  }
                  if (local_34 != iVar3) {
                    uVar4 = FUN_00050cd0(&local_d0);
                    FUN_0004fe78(3,
                                 "WARNING: conflicting enable configuration for interfaces %s and %s for address %s - unsupported configuration - address DISABLED"
                                 ,acStack_7c,pcVar13,uVar4);
                    puVar12[0x2c] = 1;
                  }
                  local_1ac = 1;
                  *(ushort *)((int)puVar12 + 0x8a) = DAT_0007ce30;
                  local_1b0 = puVar12;
                  if (param_1 != (code *)0x0) {
                    (*param_1)(param_2,&local_1b0);
                  }
                }
              }
            }
          }
          goto LAB_000134e8;
        }
        iVar3 = FUN_00052468(local_1b4);
      } while (iVar3 == 0);
    }
    else {
      iVar2 = 0;
      local_1c4 = 0;
    }
LAB_00013544:
    FUN_00052510(&local_1b4);
    puVar12 = DAT_000ca654;
    while (puVar14 = puVar12, puVar14 != (undefined4 *)0x0) {
      puVar12 = (undefined4 *)*puVar14;
      if (((puVar14[0x23] & 0x180) == 0) && (*(ushort *)((int)puVar14 + 0x8a) != DAT_0007ce30)) {
        if (2 < DAT_0007cf4c) {
          FUN_0001176c(puVar14,"updating ","GONE - deleting\n");
        }
        if (DAT_000ca654 == puVar14) {
          puVar5 = &DAT_000ca654;
          puVar6 = DAT_000ca654;
LAB_000135e4:
          *puVar5 = *puVar6;
          *puVar6 = 0;
        }
        else if (DAT_000ca654 != (undefined4 *)0x0) {
          puVar6 = (undefined4 *)*DAT_000ca654;
          puVar5 = DAT_000ca654;
          while (puVar7 = puVar6, puVar7 != (undefined4 *)0x0) {
            if (puVar7 == puVar14) {
              puVar6 = (undefined4 *)*puVar5;
              goto LAB_000135e4;
            }
            if (puVar7 == (undefined4 *)0x0) break;
            puVar5 = puVar7;
            puVar6 = (undefined4 *)*puVar7;
          }
        }
        if ((puVar14[0x2c] == 0) && ((puVar14[0x23] & 0x10) != 0)) {
          puVar5 = &DAT_000ca630;
          if (*(short *)(puVar14 + 0x22) == 2) {
            puVar5 = &DAT_000ca634;
          }
          puVar7 = (undefined4 *)*puVar5;
          puVar6 = puVar14;
          if (puVar14 == puVar7) {
LAB_00013674:
            *puVar5 = puVar6[1];
            puVar6[1] = 0;
          }
          else if (puVar7 == (undefined4 *)0x0) {
            puVar6 = (undefined4 *)0x0;
          }
          else {
            for (puVar6 = (undefined4 *)puVar7[1]; puVar6 != (undefined4 *)0x0; puVar6 = (undefined4 *)puVar6[1]) {
              if (puVar6 == puVar14) {
                puVar5 = puVar7 + 1;
                goto LAB_00013674;
              }
              if (puVar6 == (undefined4 *)0x0) break;
              puVar7 = puVar6;
            }
          }
          if (3 < DAT_0007cf4c) {
            uVar4 = FUN_00050cd0(puVar14 + 5);
            pcVar13 = "b->used - b->current >= 6";
            pcVar8 = "removed from";
            if (puVar6 == (undefined4 *)0x0) {
              pcVar8 = "not found on";
            }
            if (*(short *)(puVar14 + 0x22) == 2) {
              pcVar13 = "b->used - b->current >= 4";
            }
            printf("%s %s IPv%s multicast-capable unicast local address list\n",uVar4,pcVar8,pcVar13 + 0x18);
          }
        }
        local_1cc = puVar14 + 5;
        puVar5 = &DAT_000ca64c;
        puVar6 = DAT_000ca64c;
        do {
          while (iVar2 = DAT_0007cf4c, puVar14 == (undefined4 *)puVar6[8]) {
            *puVar5 = *puVar6;
            *puVar6 = 0;
            if (3 < iVar2) {
              uVar4 = FUN_00050cd0(puVar6 + 1);
              printf("Deleted addr %s for interface #%d %s from list of addresses\n",uVar4,puVar14[4],puVar14 + 0x1a);
            }
            free(puVar6);
            puVar5 = &DAT_000ca64c;
            puVar6 = DAT_000ca64c;
          }
          puVar7 = (undefined4 *)*puVar6;
          puVar5 = puVar6;
          puVar6 = puVar7;
        } while (puVar7 != (undefined4 *)0x0);
        if (puVar14[2] != -1) {
          uVar10 = puVar14[4];
          uVar4 = FUN_00050cd0(local_1cc);
          FUN_0004fe78(6,
                       "Deleting interface #%d %s, %s#%d, interface stats: received=%ld, sent=%ld, dropped=%ld, active_time=%ld secs"
                       ,uVar10,puVar14 + 0x1a,uVar4,
                       *(ushort *)((int)puVar14 + 0x16) << 8 | *(ushort *)((int)puVar14 + 0x16) >> 8,puVar14[0x28],
                       puVar14[0x29],puVar14[0x2a],DAT_000cb548 - puVar14[0x27]);
          FUN_00010f54(puVar14[2]);
        }
        if (puVar14[3] != -1) {
          uVar4 = FUN_00050cd0(puVar14 + 0x13);
          FUN_0004fe78(6,"Deleting broadcast address %s#%d from interface #%d %s",uVar4,
                       *(ushort *)((int)puVar14 + 0x4e) << 8 | *(ushort *)((int)puVar14 + 0x4e) >> 8,puVar14[4],
                       puVar14 + 0x1a);
          FUN_00010f54(puVar14[3]);
        }
        DAT_000ca62c = DAT_000ca62c + -1;
        FUN_00020e9c(puVar14);
        local_188 = 0;
        local_184 = 0;
        local_180 = 0;
        local_17c = 0;
        local_178 = 0;
        local_174 = 0;
        local_18c = (uint)*(ushort *)(puVar14 + 5);
        if (*(ushort *)(puVar14 + 5) == 10) {
          memset(&local_184,0xff,0x10);
        }
        else {
          local_188 = 0xffffffff;
        }
        FUN_0002cc48(4,local_1cc,&local_18c,0x3000,1);
        if (3 < DAT_0007cf4c) {
          uVar4 = FUN_00050cd0(local_1cc);
          printf("refreshing peers due to deleted addr %s",uVar4);
        }
        local_1ac = 3;
        local_1b0 = puVar14;
        if (param_1 != (code *)0x0) {
          (*param_1)(param_2,&local_1b0);
        }
        while (puVar14[0x2d] != 0) {
          FUN_00021778(puVar14[0x2d],0);
        }
        if (puVar14 == DAT_000ca61c) {
          DAT_000ca61c = (undefined4 *)0x0;
        }
        iVar2 = 1;
        free(puVar14);
      }
    }
    if (iVar2 != 0) {
      FUN_00021ae0();
      FUN_0004fe78(6,"peers refreshed");
    }
  }
  else {
    local_1c4 = 0;
  }
  return local_1c4;
}




/* WARNING: Type propagation algorithm not settling */

int * FUN_00013e90(sockaddr *param_1,uint param_2,int param_3)

{
  byte bVar1;
  bool bVar2;
  bool bVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  uint *puVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  sockaddr *psVar10;
  socklen_t __len;
  int *piVar11;
  uint uVar12;
  byte *pbVar13;
  uint uVar14;
  byte *pbVar15;
  int *piVar16;
  byte bVar17;
  char cVar18;
  uint uVar19;
  uint local_90;
  uint local_8c;
  socklen_t local_84 [2];
  sockaddr local_7c;
  uint local_60;
  uint local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  uint local_44;
  uint uStack_40;
  undefined4 local_3c;
  undefined4 uStack_38;
  undefined4 local_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  
  if (3 < DAT_0007cf4c) {
    uVar9 = FUN_00050cd0();
    printf("Finding interface for addr %s in list of addresses\n",uVar9);
  }
  iVar4 = socket((uint)param_1->sa_family,2,0);
  if (iVar4 != -1) {
    if (param_3 != 0) {
      local_84[1] = 1;
      setsockopt(iVar4,1,6,local_84 + 1,4);
    }
    if (param_1->sa_family == 2) {
      __len = 0x10;
    }
    else {
      __len = 0x1c;
    }
    iVar5 = connect(iVar4,param_1,__len);
    if (iVar5 == -1) {
      close(iVar4);
      return (int *)0x0;
    }
    local_84[0] = 0x1c;
    iVar5 = getsockname(iVar4,&local_7c,local_84);
    close(iVar4);
    if (iVar5 != -1) {
      if (3 < DAT_0007cf4c) {
        uVar9 = FUN_00050cd0(param_1);
        uVar8 = FUN_00050cd0(&local_7c);
        printf("findlocalinterface: kernel maps %s to %s\n",uVar9,uVar8);
      }
      piVar6 = (int *)FUN_00011458(&local_7c);
      if (((piVar6 != (int *)0x0) && ((param_2 & piVar6[0x23]) == 0)) && (piVar6[0x2c] == 0)) {
        return piVar6;
      }
      if (DAT_000ca654 != (int *)0x0) {
        piVar16 = (int *)0x0;
        piVar6 = DAT_000ca654;
        do {
          if (((piVar6[0x2c] != 0) || (uVar19 = (uint)local_7c.sa_family, *(ushort *)(piVar6 + 0x22) != uVar19)) ||
             ((piVar6[0x23] & 0x84U) != 0)) goto LAB_00013f74;
          if (*(ushort *)(piVar6 + 5) != uVar19) {
            (*DAT_0007c9fc)("ntp_io.c",0xefe,0,"((a1)->sa.sa_family) == ((a2)->sa.sa_family)");
            uVar19 = (uint)local_7c.sa_family;
          }
          local_5c = 0;
          local_58 = 0;
          local_54 = 0;
          local_50 = 0;
          local_4c = 0;
          local_48 = 0;
          local_60 = uVar19;
          if (uVar19 == 2) {
            uVar12 = piVar6[6];
            uVar14 = local_7c.sa_data._2_4_ << 0x18 | ((uint)local_7c.sa_data._2_4_ >> 8 & 0xff) << 0x10 |
                     ((uint)local_7c.sa_data._2_4_ >> 0x10 & 0xff) << 8 | (uint)local_7c.sa_data._2_4_ >> 0x18;
            uVar12 = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
            if (uVar12 < uVar14) {
              uVar14 = uVar14 - uVar12;
            }
            else {
              uVar14 = uVar12 - uVar14;
            }
            local_5c = uVar14 << 0x18 | (uVar14 >> 8 & 0xff) << 0x10 | (uVar14 >> 0x10 & 0xff) << 8 | uVar14 >> 0x18;
          }
          else {
            bVar3 = false;
            iVar4 = 0;
            bVar2 = false;
            puVar7 = &local_60;
            psVar10 = &local_7c;
            piVar11 = piVar6 + 5;
            do {
              if (bVar2) {
                bVar17 = *(byte *)((int)(piVar6 + 5) + (int)piVar11 + (-0xc - (int)piVar6));
                bVar1 = psVar10->sa_data[6];
                cVar18 = bVar1 - bVar17;
                if (bVar3) {
LAB_00014048:
                  bVar3 = true;
                  *(char *)(puVar7 + 2) = cVar18;
                  bVar2 = true;
                }
                else {
LAB_00014094:
                  bVar2 = true;
                  *(byte *)(puVar7 + 2) = bVar17 - bVar1;
                }
              }
              else {
                bVar17 = *(byte *)((int)piVar6 + iVar4 + 0x1c);
                bVar1 = psVar10->sa_data[6];
                if (bVar1 != bVar17) {
                  bVar3 = bVar17 < bVar1;
                  cVar18 = bVar1 - bVar17;
                  if (bVar17 < bVar1) goto LAB_00014048;
                  goto LAB_00014094;
                }
                *(bool *)(puVar7 + 2) = bVar2;
              }
              iVar4 = iVar4 + 1;
              puVar7 = (uint *)((int)puVar7 + 1);
              piVar11 = (int *)((int)piVar11 + 1);
              psVar10 = (sockaddr *)((int)&psVar10->sa_family + 1);
            } while (iVar4 != 0x10);
          }
          if (piVar16 == (int *)0x0) {
LAB_0001423c:
            local_90 = uVar19;
            local_44 = local_60;
            uStack_40 = local_5c;
            local_3c = local_58;
            uStack_38 = local_54;
            local_34 = local_50;
            uStack_30 = local_4c;
            uStack_2c = local_48;
            piVar16 = piVar6;
            local_8c = local_5c;
          }
          else {
            if (uVar19 != local_90) {
              (*DAT_0007c9fc)("ntp_io.c",0xf31,0,"((d1)->sa.sa_family) == ((d2)->sa.sa_family)");
              uVar19 = local_60 & 0xffff;
            }
            if (uVar19 == 2) {
              if ((local_5c << 0x18 | (local_5c >> 8 & 0xff) << 0x10 | (local_5c >> 0x10 & 0xff) << 8 | local_5c >> 0x18
                  ) < (local_8c << 0x18 | (local_8c >> 8 & 0xff) << 0x10 | (local_8c >> 0x10 & 0xff) << 8 |
                      local_8c >> 0x18)) goto LAB_0001423c;
            }
            else {
              if ((local_58 & 0xff) < (local_3c & 0xff)) goto LAB_0001423c;
              if ((local_58 & 0xff) <= (local_3c & 0xff)) {
                pbVar13 = (byte *)&local_3c;
                pbVar15 = (byte *)&local_58;
                do {
                  pbVar15 = pbVar15 + 1;
                  pbVar13 = pbVar13 + 1;
                  if (*pbVar15 < *pbVar13) goto LAB_0001423c;
                } while ((*pbVar15 <= *pbVar13) && (pbVar15 != (byte *)((int)&local_4c + 3)));
              }
            }
          }
LAB_00013f74:
          piVar6 = (int *)*piVar6;
        } while (piVar6 != (int *)0x0);
        if (piVar16 != (int *)0x0) {
          if (3 < DAT_0007cf4c) {
            uVar9 = FUN_00050cd0(&local_7c);
            uVar8 = FUN_00050cd0(piVar16 + 5);
            printf("findclosestinterface(%s) -> %s\n",uVar9,uVar8);
          }
          if (piVar16[0x2c] == 0) {
            return piVar16;
          }
          return (int *)0x0;
        }
      }
      if (3 < DAT_0007cf4c) {
        uVar9 = FUN_00050cd0(&local_7c);
        printf("findclosestinterface(%s) failed\n",uVar9);
      }
    }
  }
  return (int *)0x0;
}




void FUN_000142b0(void)

{
  FUN_00050918(10);
  return;
}




void FUN_000142b8(void)

{
  int iVar1;
  int iVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  char *pcVar5;
  sockaddr local_50;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  
  if ((DAT_0007ce38 == 0) && ((*(uint *)(DAT_0007954c + 0x590) & 0xf) == 0)) {
    puVar4 = (undefined4 *)0xca580;
    DAT_0007ce38 = 1;
    DAT_000ca604 = 0;
    do {
      puVar4 = puVar4 + 1;
      *puVar4 = 0;
    } while (puVar4 != (undefined4 *)&DAT_000ca600);
    if (1 < DAT_0007cf4c) {
      printf("create_sockets(%d)\n",0x7b);
    }
    local_50.sa_data[10] = '\0';
    local_50.sa_data[0xb] = '\0';
    local_50.sa_data[0xc] = '\0';
    local_50.sa_data[0xd] = '\0';
    local_40 = 0;
    local_3c = 0;
    local_38 = 0;
    local_34 = 0;
    local_30 = 0;
    local_2c = 0;
    if (DAT_000cb868 != 0) {
      local_50.sa_data[10] = '\x02';
      local_50.sa_data[0xb] = '\0';
      local_50.sa_data[0xc] = '\0';
      local_50.sa_data[0xd] = '{';
      iVar1 = FUN_00012344(0,local_50.sa_data + 10,0);
      if (iVar1 != 1) {
        iVar2 = FUN_0001155c(0);
        strncpy((char *)(iVar2 + 0x68),"v4wildcard",0x20);
        pcVar5 = (char *)(iVar2 + 0x14);
        *(undefined4 *)pcVar5 = local_50.sa_data._10_4_;
        *(undefined4 *)(iVar2 + 0x18) = local_40;
        *(undefined4 *)(iVar2 + 0x1c) = local_3c;
        *(undefined4 *)(iVar2 + 0x20) = local_38;
        *(undefined4 *)(iVar2 + 0x24) = local_34;
        *(undefined4 *)(iVar2 + 0x28) = local_30;
        *(undefined4 *)(iVar2 + 0x2c) = local_2c;
        *(undefined2 *)(iVar2 + 0x4e) = 0x7b00;
        *(undefined2 *)(iVar2 + 0x88) = 2;
        *(undefined4 *)(iVar2 + 0x34) = 0xffffffff;
        *(undefined2 *)(iVar2 + 0x30) = 2;
        *(uint *)(iVar2 + 0xb0) = (uint)(iVar1 == 2);
        *(undefined2 *)(iVar2 + 0x4c) = 2;
        *(undefined4 *)(iVar2 + 0x50) = 0;
        *(undefined4 *)(iVar2 + 0x8c) = 0x89;
        iVar1 = FUN_00012cbc(pcVar5,0,1,iVar2);
        *(int *)(iVar2 + 8) = iVar1;
        if (iVar1 == -1) goto LAB_000146a0;
        DAT_0007ce3c = iVar2;
        DAT_000ca608 = iVar2;
        FUN_000127d4(pcVar5,iVar2);
        FUN_000119c4(iVar2);
        FUN_00010ee0(iVar2);
        if (1 < DAT_0007cf4c) {
          FUN_0001176c(iVar2,"created ","\n");
        }
      }
    }
    if (DAT_000cb864 != 0) {
      local_40 = 0;
      local_3c = in6addr_any._0_4_;
      local_38 = in6addr_any._4_4_;
      local_34 = in6addr_any._8_4_;
      local_30 = in6addr_any._12_4_;
      local_2c = 0;
      local_50.sa_data[10] = '\n';
      local_50.sa_data[0xb] = '\0';
      local_50.sa_data[0xc] = '\0';
      local_50.sa_data[0xd] = '{';
      iVar1 = FUN_00012344(0,local_50.sa_data + 10,0);
      if (iVar1 != 1) {
        iVar2 = FUN_0001155c(0);
        strncpy((char *)(iVar2 + 0x68),"v6wildcard",0x20);
        pcVar5 = (char *)(iVar2 + 0x14);
        *(undefined4 *)pcVar5 = local_50.sa_data._10_4_;
        *(undefined4 *)(iVar2 + 0x18) = local_40;
        *(undefined4 *)(iVar2 + 0x1c) = local_3c;
        *(undefined4 *)(iVar2 + 0x20) = local_38;
        *(undefined4 *)(iVar2 + 0x24) = local_34;
        *(undefined4 *)(iVar2 + 0x28) = local_30;
        *(undefined4 *)(iVar2 + 0x2c) = local_2c;
        *(undefined2 *)(iVar2 + 0x88) = 10;
        *(undefined2 *)(iVar2 + 0x30) = 10;
        memset((void *)(iVar2 + 0x38),0xff,0x10);
        *(undefined4 *)(iVar2 + 0x8c) = 0x81;
        *(uint *)(iVar2 + 0xb0) = (uint)(iVar1 == 2);
        iVar1 = FUN_00012cbc(pcVar5,0,1,iVar2);
        *(int *)(iVar2 + 8) = iVar1;
        if (iVar1 == -1) {
LAB_000146a0:
          uVar3 = FUN_00050cd0(pcVar5);
          FUN_0004fe78(3,"unable to bind to wildcard address %s - another process may be running - EXITING",uVar3);
                    /* WARNING: Subroutine does not return */
          exit(1);
        }
        DAT_0007ce40 = iVar2;
        DAT_000ca644 = iVar2;
        FUN_000127d4(pcVar5,iVar2);
        FUN_000119c4(iVar2);
        FUN_00010ee0(iVar2);
        if (1 < DAT_0007cf4c) {
          FUN_0001176c(iVar2,"created ","\n");
        }
      }
    }
    FUN_000132e0(0,0);
    FUN_000111cc(0);
    if (1 < DAT_0007cf4c) {
      printf("create_sockets: Total interfaces = %d\n",DAT_000ca62c);
    }
    iVar1 = socket(0x10,3,0);
    if (iVar1 < 0) {
      FUN_0004fe78(3,"unable to open routing socket (%m) - using polled interface update");
    }
    else {
      iVar1 = FUN_000115d4();
      local_50.sa_data[2] = '\0';
      local_50.sa_data[3] = '\0';
      local_50.sa_data[4] = '\0';
      local_50.sa_data[5] = '\0';
      local_50.sa_family = 0x10;
      local_50.sa_data[0] = '\0';
      local_50.sa_data[1] = '\0';
      local_50.sa_data[6] = 'q';
      local_50.sa_data[7] = '\a';
      local_50.sa_data[8] = '\0';
      local_50.sa_data[9] = '\0';
      iVar2 = bind(iVar1,&local_50,0xc);
      if (iVar2 < 0) {
        FUN_0004fe78(3,"bind failed on routing socket (%m) - using polled interface update");
      }
      else {
        FUN_00012c84(iVar1);
        puVar4 = (undefined4 *)FUN_0004f524(0x10);
        memset(puVar4,0,0x10);
        puVar4[1] = iVar1;
        puVar4[3] = &LAB_000120cc;
        *puVar4 = DAT_000ca618;
        DAT_000ca618 = puVar4;
        FUN_00012224(iVar1,0);
        FUN_0004fe78(6,"Listening on routing socket on fd #%d for interface updates",iVar1);
      }
    }
    if (2 < DAT_0007cf4c) {
      printf("io_open_sockets: maxactivefd %d\n",DAT_000ca604);
    }
  }
  return;
}




undefined4 FUN_00014720(char *param_1,undefined2 *param_2)

{
  int iVar1;
  size_t sVar2;
  char *pcVar3;
  undefined4 uVar4;
  undefined4 local_a4;
  undefined4 local_a0;
  undefined4 uStack_9c;
  undefined4 uStack_98;
  undefined4 uStack_94;
  char acStack_90 [128];
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("ntp_io.c",0x31c,0,"host != ((void *)0)");
  }
  if (param_2 == (undefined2 *)0x0) {
    (*DAT_0007c9fc)("ntp_io.c",0x31d,0,"addr != ((void *)0)");
  }
  memset(param_2,0,0x1c);
  iVar1 = inet_pton(2,param_1,&local_a4);
  if (iVar1 == 1) {
    *param_2 = 2;
    *(undefined4 *)(param_2 + 2) = local_a4;
    uVar4 = 1;
  }
  else {
    sVar2 = strlen(param_1);
    if (sVar2 < 0x80) {
      if (*param_1 == '[') {
        strncpy(acStack_90,param_1 + 1,0x80);
        pcVar3 = strchr(acStack_90,0x5d);
        if (pcVar3 != (char *)0x0) {
          *pcVar3 = '\0';
        }
      }
      else {
        strncpy(acStack_90,param_1,0x80);
      }
      pcVar3 = strchr(acStack_90,0x25);
      if (pcVar3 != (char *)0x0) {
        *pcVar3 = '\0';
      }
      iVar1 = inet_pton(10,acStack_90,&local_a0);
      if (iVar1 == 1) {
        *param_2 = 10;
        *(undefined4 *)(param_2 + 4) = local_a0;
        *(undefined4 *)(param_2 + 6) = uStack_9c;
        *(undefined4 *)(param_2 + 8) = uStack_98;
        *(undefined4 *)(param_2 + 10) = uStack_94;
        return 1;
      }
    }
    uVar4 = 0;
  }
  return uVar4;
}




void FUN_000148dc(int param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 *__s;
  undefined4 uVar1;
  int iVar2;
  
  __s = (undefined4 *)FUN_0004f524(0x30);
  memset(__s,0,0x30);
  __s[0xb] = param_3;
  __s[2] = param_1;
  __s[1] = param_4;
  if (param_1 == 4) {
    if (param_2 == 0) {
      (*DAT_0007c9fc)("ntp_io.c",0x512,0,"((void *)0) != if_name");
    }
    uVar1 = FUN_0004f4e8(param_2);
    __s[3] = uVar1;
  }
  else if (param_1 == 5) {
    if (param_2 == 0) {
      (*DAT_0007c9fc)("ntp_io.c",0x515,0,"((void *)0) != if_name");
    }
    iVar2 = FUN_00014720(param_2,__s + 4);
    if (iVar2 == 0) {
      (*DAT_0007c9fc)("ntp_io.c",0x518,0,"is_ip");
    }
  }
  else if (param_2 != 0) {
    (*DAT_0007c9fc)("ntp_io.c",0x51a,0,"((void *)0) == if_name");
  }
  *__s = DAT_000ca624;
  DAT_000ca624 = __s;
  return;
}




void FUN_00014a04(void)

{
  int local_c [2];
  
  if (DAT_000ca648 == 0) {
    local_c[0] = FUN_000132e0();
    if (local_c[0] != 0) {
      FUN_0004fe78(7,"new interface(s) found: waking up resolver");
      write(DAT_000c9c9c,local_c,1);
    }
  }
  return;
}




void FUN_00014a64(undefined2 *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  memset(param_1,0,0x1c);
  *param_1 = (short)*param_2;
  if (*param_2 == 2) {
    *(int *)(param_1 + 2) = param_2[1];
    return;
  }
  if (*param_2 != 10) {
    return;
  }
  iVar1 = param_2[2];
  iVar2 = param_2[3];
  iVar3 = param_2[4];
  *(int *)(param_1 + 4) = param_2[1];
  *(int *)(param_1 + 6) = iVar1;
  *(int *)(param_1 + 8) = iVar2;
  *(int *)(param_1 + 10) = iVar3;
  return;
}




void FUN_00014ac8(int param_1,undefined4 param_2)

{
  FUN_000112c0(param_1,*(undefined4 *)(param_1 + 8),param_2);
  return;
}




void FUN_00014ae4(int param_1,short *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  short sVar4;
  undefined4 uVar5;
  undefined4 local_14;
  
  sVar4 = *(short *)(param_1 + 0x14);
  local_14 = 0;
  if (*param_2 != sVar4) {
    (*DAT_0007c9fc)("ntp_io.c",0x955,0,"((maddr)->sa.sa_family) == ((&iface->sin)->sa.sa_family)");
    sVar4 = *(short *)(param_1 + 0x14);
  }
  if (sVar4 == 2) {
    iVar3 = setsockopt(*(int *)(param_1 + 8),0,0x22,&local_14,4);
  }
  else {
    if (sVar4 != 10) {
      return;
    }
    iVar3 = setsockopt(*(int *)(param_1 + 8),0x29,0x13,&local_14,4);
  }
  if (iVar3 != 0) {
    uVar5 = *(undefined4 *)(param_1 + 8);
    uVar1 = FUN_00050cd0(param_1 + 0x14);
    uVar2 = FUN_00050cd0(param_2);
    FUN_0004fe78(3,"setsockopt IP_MULTICAST_LOOP failed: %m on socket %d, addr %s for multicast address %s",uVar5,uVar1,
                 uVar2);
  }
  return;
}




void FUN_00014de8(short *param_1)

{
  short sVar1;
  int iVar2;
  undefined4 uVar3;
  void *__ptr;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined4 uStack_28;
  undefined4 local_24;
  
  iVar2 = FUN_00012884();
  if (iVar2 == 0) {
    return;
  }
  iVar2 = FUN_000131c8(param_1);
  if (iVar2 != 0) {
    uVar3 = FUN_00050cd0(param_1);
    FUN_0004fe78(6,"Duplicate request found for multicast address %s",uVar3);
    return;
  }
  __ptr = (void *)FUN_0001155c();
  puVar6 = (undefined4 *)((int)__ptr + 0x14);
  uVar3 = *(undefined4 *)(param_1 + 2);
  uVar4 = *(undefined4 *)(param_1 + 4);
  uVar5 = *(undefined4 *)(param_1 + 6);
  *puVar6 = *(undefined4 *)param_1;
  *(undefined4 *)((int)__ptr + 0x18) = uVar3;
  *(undefined4 *)((int)__ptr + 0x1c) = uVar4;
  *(undefined4 *)((int)__ptr + 0x20) = uVar5;
  uVar3 = *(undefined4 *)(param_1 + 10);
  uVar4 = *(undefined4 *)(param_1 + 0xc);
  *(undefined4 *)((int)__ptr + 0x24) = *(undefined4 *)(param_1 + 8);
  *(undefined4 *)((int)__ptr + 0x28) = uVar3;
  *(undefined4 *)((int)__ptr + 0x2c) = uVar4;
  sVar1 = *(short *)((int)__ptr + 0x14);
  *(undefined2 *)((int)__ptr + 0x16) = 0x7b00;
  *(short *)((int)__ptr + 0x88) = sVar1;
  *(short *)((int)__ptr + 0x30) = sVar1;
  if (sVar1 == 10) {
    memset((void *)((int)__ptr + 0x38),0xff,0x10);
  }
  else {
    *(undefined4 *)((int)__ptr + 0x34) = 0xffffffff;
  }
  FUN_000111cc(1);
  *(undefined4 *)((int)__ptr + 0xc) = 0xffffffff;
  iVar2 = FUN_00012cbc(puVar6,0,0,__ptr);
  *(int *)((int)__ptr + 8) = iVar2;
  if (iVar2 == -1) {
    free(__ptr);
    __ptr = DAT_0007ce3c;
    if (((*param_1 != 2) && (__ptr = DAT_0007ce40, *param_1 != 10)) || (__ptr == (void *)0x0)) {
      uVar3 = FUN_00050cd0(param_1);
      FUN_0004fe78(3,"No multicast socket available to use for address %s",uVar3);
      return;
    }
    uVar3 = *(undefined4 *)(param_1 + 2);
    uVar4 = *(undefined4 *)(param_1 + 4);
    uVar5 = *(undefined4 *)(param_1 + 6);
    puVar6 = (undefined4 *)((int)__ptr + 0x14);
    *(undefined4 *)((int)__ptr + 0x4c) = *(undefined4 *)param_1;
    *(undefined4 *)((int)__ptr + 0x50) = uVar3;
    *(undefined4 *)((int)__ptr + 0x54) = uVar4;
    *(undefined4 *)((int)__ptr + 0x58) = uVar5;
    uVar3 = *(undefined4 *)(param_1 + 10);
    uVar4 = *(undefined4 *)(param_1 + 0xc);
    *(undefined4 *)((int)__ptr + 0x5c) = *(undefined4 *)(param_1 + 8);
    *(undefined4 *)((int)__ptr + 0x60) = uVar3;
    *(undefined4 *)((int)__ptr + 100) = uVar4;
    uVar3 = FUN_00050cd0(param_1);
    FUN_0004fe78(3,"multicast address %s using wildcard interface #%d %s",uVar3,*(undefined4 *)((int)__ptr + 0x10),
                 (int)__ptr + 0x68);
  }
  else {
    *(undefined4 *)((int)__ptr + 0xb0) = 0;
    *(uint *)((int)__ptr + 0x8c) = *(uint *)((int)__ptr + 0x8c) | 0x100;
    strncpy((char *)((int)__ptr + 0x68),"multicast",0x20);
    if (1 < DAT_0007cf4c) {
      FUN_0001176c(__ptr,"multicast add ","\n");
    }
    FUN_000119c4(__ptr);
    FUN_00010ee0(__ptr);
  }
  if (*param_1 == 2) {
    local_3c = *(undefined4 *)(param_1 + 2);
    local_38 = 0;
    iVar2 = setsockopt(*(int *)((int)__ptr + 8),0,0x23,&local_3c,8);
    if (iVar2 != 0) {
      uVar7 = *(undefined4 *)((int)__ptr + 8);
      uVar5 = FUN_00050cd0(puVar6);
      uVar4 = local_38;
      uVar3 = local_3c;
      uVar8 = FUN_00050cd0(param_1);
      FUN_0004fe78(3,"setsockopt IP_ADD_MEMBERSHIP failed: %m on socket %d, addr %s for %x / %x (%s)",uVar7,uVar5,uVar3,
                   uVar4,uVar8);
LAB_00015148:
      uVar5 = FUN_00050cd0(puVar6);
      uVar8 = FUN_00050cd0(param_1);
      FUN_0004fe78(3,"Failed to join %s socket to multicast group %s",uVar5,uVar8,uVar3,uVar4);
      goto LAB_00014f54;
    }
    if (3 < DAT_0007cf4c) {
      uVar7 = *(undefined4 *)((int)__ptr + 8);
      uVar5 = FUN_00050cd0(puVar6);
      uVar4 = local_38;
      uVar3 = local_3c;
      uVar8 = FUN_00050cd0(param_1);
      printf("Added IPv4 multicast membership on socket %d, addr %s for %x / %x (%s)\n",uVar7,uVar5,uVar3,uVar4,uVar8);
    }
  }
  else if (*param_1 == 10) {
    local_24 = *(undefined4 *)((int)__ptr + 0xac);
    local_34 = *(undefined4 *)(param_1 + 4);
    uStack_30 = *(undefined4 *)(param_1 + 6);
    uStack_2c = *(undefined4 *)(param_1 + 8);
    uStack_28 = *(undefined4 *)(param_1 + 10);
    iVar2 = setsockopt(*(int *)((int)__ptr + 8),0x29,0x14,&local_34,0x14);
    if (iVar2 != 0) {
      uVar8 = *(undefined4 *)((int)__ptr + 8);
      uVar5 = FUN_00050cd0(puVar6);
      uVar3 = local_24;
      uVar4 = FUN_00050cd0(param_1);
      FUN_0004fe78(3,"setsockopt IPV6_JOIN_GROUP failed: %m on socket %d, addr %s for interface %u (%s)",uVar8,uVar5,
                   uVar3,uVar4);
      goto LAB_00015148;
    }
    if (3 < DAT_0007cf4c) {
      uVar8 = *(undefined4 *)((int)__ptr + 8);
      uVar4 = FUN_00050cd0(puVar6);
      uVar3 = local_24;
      uVar5 = FUN_00050cd0(param_1);
      printf("Added IPv6 multicast group on socket %d, addr %s for interface %u (%s)\n",uVar8,uVar4,uVar3,uVar5);
    }
  }
  *(uint *)((int)__ptr + 0x8c) = *(uint *)((int)__ptr + 0x8c) | 0x40;
  *(int *)((int)__ptr + 0x98) = *(int *)((int)__ptr + 0x98) + 1;
  uVar3 = FUN_00050cd0(puVar6);
  uVar4 = FUN_00050cd0(param_1);
  FUN_0004fe78(6,"Joined %s socket to multicast group %s",uVar3,uVar4);
LAB_00014f54:
  FUN_000127d4(param_1,__ptr);
  return;
}




void FUN_000154a4(sockaddr *param_1,int param_2,int param_3,void *param_4,size_t param_5)

{
  bool bVar1;
  bool bVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  ssize_t sVar5;
  int iVar6;
  undefined4 uVar7;
  char *pcVar8;
  socklen_t __addr_len;
  int local_34 [2];
  undefined1 local_29 [5];
  
  if (param_1->sa_family == 2) {
    if ((*(uint *)(param_1->sa_data + 2) & 0xf0) == 0xe0) {
      bVar1 = true;
      param_2 = DAT_000ca634;
      goto LAB_000154dc;
    }
  }
  else if (param_1->sa_data[6] == -1) {
    bVar1 = true;
    param_2 = DAT_000ca630;
    goto LAB_000154dc;
  }
  bVar1 = false;
LAB_000154dc:
  local_34[0] = param_3;
  if (param_2 == 0) {
    if (1 < DAT_0007cf4c) {
      pcVar8 = "";
      if (bVar1) {
        pcVar8 = "\tMCAST\t***** ";
      }
      uVar7 = FUN_00050cd0(param_1);
      printf("%ssendpkt(dst=%s, ttl=%d, len=%d): no interface - IGNORED\n",pcVar8,uVar7,local_34[0],param_5);
    }
  }
  else {
    do {
      if (1 < DAT_0007cf4c) {
        uVar7 = *(undefined4 *)(param_2 + 8);
        pcVar8 = "\tMCAST\t***** ";
        if (!bVar1) {
          pcVar8 = "";
        }
        uVar3 = FUN_00050cd0(param_1);
        uVar4 = FUN_00050cd0(param_2 + 0x14);
        printf("%ssendpkt(%d, dst=%s, src=%s, ttl=%d, len=%d)\n",pcVar8,uVar7,uVar3,uVar4,local_34[0],param_5);
      }
      bVar2 = bVar1;
      if (local_34[0] < 1) {
        bVar2 = false;
      }
      if ((bVar2) && (local_34[0] != *(int *)(param_2 + 0x90))) {
        if (*(short *)(param_2 + 0x14) == 2) {
          local_29[0] = (undefined1)local_34[0];
          iVar6 = setsockopt(*(int *)(param_2 + 8),0,0x21,local_29,1);
joined_r0x000156b8:
          if (iVar6 != 0) {
            uVar7 = FUN_00050cd0(param_2 + 0x14);
            FUN_0004fe78(3,"setsockopt IP_MULTICAST_TTL/IPV6_MULTICAST_HOPS fails on address %s: %m",uVar7);
            goto LAB_000155c4;
          }
        }
        else if (*(short *)(param_2 + 0x14) == 10) {
          iVar6 = setsockopt(*(int *)(param_2 + 8),0x29,0x12,local_34,4);
          goto joined_r0x000156b8;
        }
        *(int *)(param_2 + 0x90) = local_34[0];
      }
LAB_000155c4:
      if (param_1->sa_family == 2) {
        __addr_len = 0x10;
      }
      else {
        __addr_len = 0x1c;
      }
      sVar5 = sendto(*(int *)(param_2 + 8),param_4,param_5,0,param_1,__addr_len);
      if (sVar5 == -1) {
        *(int *)(param_2 + 0xa8) = *(int *)(param_2 + 0xa8) + 1;
        DAT_000ca658 = DAT_000ca658 + 1;
      }
      else {
        *(int *)(param_2 + 0xa4) = *(int *)(param_2 + 0xa4) + 1;
        DAT_000ca60c = DAT_000ca60c + 1;
      }
      if (bVar1) {
        param_2 = *(int *)(param_2 + 4);
      }
      bVar2 = bVar1;
      if (param_2 == 0) {
        bVar2 = false;
      }
    } while (bVar2);
  }
  return;
}




void FUN_00015730(undefined4 *param_1)

{
  undefined1 uVar1;
  int iVar2;
  ssize_t sVar3;
  int *piVar4;
  uint uVar5;
  undefined1 *puVar6;
  int iVar7;
  code *pcVar8;
  size_t __nbytes;
  uint uVar9;
  int iVar10;
  uint uVar11;
  int iVar12;
  int *piVar13;
  undefined1 auStack_4ac [4];
  timeval local_4a8;
  undefined4 local_4a0;
  undefined4 uStack_49c;
  undefined4 local_498;
  undefined4 uStack_494;
  fd_set local_490;
  undefined1 auStack_410 [1004];
  
  local_4a0 = *param_1;
  uStack_49c = param_1[1];
  DAT_000ca638 = DAT_000ca638 + 1;
  memcpy(&local_490,&DAT_000ca584,0x80);
  iVar10 = 0;
  local_4a8.tv_sec = 0;
  local_4a8.tv_usec = 0;
  iVar2 = select(DAT_000ca604 + 1,&local_490,(fd_set *)0x0,(fd_set *)0x0,&local_4a8);
  if (iVar2 < 0) {
    piVar13 = __errno_location();
    iVar10 = *piVar13;
    if (iVar10 != 4) {
      uVar11 = DAT_000ca604;
      if (0xfe < (int)DAT_000ca604) {
        uVar11 = 0xff;
      }
      iVar2 = DAT_000ca604 + 1;
      if ((int)uVar11 < 0) {
        puVar6 = &DAT_0007ce44;
      }
      else {
        puVar6 = (undefined1 *)((int)&DAT_0007ce40 + 3);
        uVar9 = uVar11;
        do {
          iVar12 = (int)uVar9 >> 5;
          uVar5 = uVar9 & 0x1f;
          uVar9 = uVar9 - 1;
          if (((int)(&DAT_000ca584)[iVar12] >> uVar5 & 1U) == 0) {
            uVar1 = 0x2d;
          }
          else {
            uVar1 = 0x23;
          }
          puVar6 = puVar6 + 1;
          *puVar6 = uVar1;
        } while (uVar9 != 0xffffffff);
        puVar6 = &DAT_0007ce45 + uVar11;
      }
      uVar11 = 0;
      *puVar6 = 0;
      FUN_0004fe78(3,"select(%d, %s, 0L, 0L, &0.0) error: %m",iVar2,&DAT_0007ce44);
      if ((iVar10 == 9) && (memcpy(&local_490,&DAT_000ca584,0x80), -1 < (int)DAT_000ca604)) {
        do {
          if (((local_490.fds_bits[(int)uVar11 >> 5] >> (uVar11 & 0x1f) & 1U) != 0) &&
             (sVar3 = read(uVar11,auStack_4ac,0), sVar3 == -1)) {
            FUN_0004fe78(3,"Bad file descriptor %d",uVar11);
          }
          uVar11 = uVar11 + 1;
        } while ((int)uVar11 <= (int)DAT_000ca604);
      }
    }
  }
  else if (iVar2 != 0) {
    DAT_000ca63c = DAT_000ca63c + 1;
    piVar13 = DAT_0007cf44;
    if (DAT_0007cf44 == (int *)0x0) {
      iVar10 = 0;
      piVar4 = DAT_000ca654;
    }
    else {
      do {
        iVar12 = piVar13[5];
        iVar2 = iVar12 + 0x1f;
        if (-1 < iVar12) {
          iVar2 = iVar12;
        }
        if ((local_490.fds_bits[iVar2 >> 5] >> (iVar12 % 0x20 & 0xffU) & 1U) != 0) {
          do {
            iVar10 = iVar10 + 1;
            local_498 = local_4a0;
            uStack_494 = uStack_49c;
            iVar2 = FUN_00050a8c();
            if (iVar2 == 0) {
              sVar3 = read(iVar12,auStack_410,1000);
              DAT_000ca620 = DAT_000ca620 + 1;
            }
            else {
              __nbytes = piVar13[4];
              if (999 < __nbytes - 1) {
                __nbytes = 1000;
              }
              sVar3 = read(iVar12,(void *)(iVar2 + 0x5c),__nbytes);
              if (sVar3 < 0) {
                piVar4 = __errno_location();
                if (*piVar4 != 0xb && *piVar4 != 4) {
                  FUN_0004fe78(3,"clock read fd %d: %m",iVar12);
                }
                FUN_000509c4(iVar2);
                piVar13 = (int *)*piVar13;
                goto joined_r0x0001593c;
              }
              iVar7 = piVar13[3];
              *(ssize_t *)(iVar2 + 0x58) = sVar3;
              *(int *)(iVar2 + 8) = iVar7;
              pcVar8 = (code *)piVar13[2];
              iVar7 = piVar13[1];
              *(undefined4 *)(iVar2 + 0x4c) = local_498;
              *(undefined4 *)(iVar2 + 0x50) = uStack_494;
              *(undefined4 *)(iVar2 + 0x40) = 0;
              *(int *)(iVar2 + 0x44) = iVar12;
              *(int *)(iVar2 + 0x54) = iVar7;
              if ((pcVar8 == (code *)0x0) || (iVar7 = (*pcVar8)(iVar2), iVar7 != 0)) {
                FUN_00050a30(iVar2);
                piVar13[6] = piVar13[6] + 1;
                DAT_000ca640 = DAT_000ca640 + 1;
              }
              else {
                FUN_000509c4(iVar2);
              }
            }
          } while (0 < sVar3);
        }
        piVar13 = (int *)*piVar13;
joined_r0x0001593c:
        piVar4 = DAT_000ca654;
      } while (piVar13 != (int *)0x0);
    }
    for (; piVar13 = DAT_000ca618, piVar4 != (int *)0x0; piVar4 = (int *)*piVar4) {
      iVar2 = 0;
      do {
        if (iVar2 == 0) {
          uVar11 = piVar4[2];
        }
        else {
          if ((piVar4[0x23] & 0x20U) == 0) break;
          uVar11 = piVar4[3];
        }
        if ((-1 < (int)uVar11) && ((local_490.fds_bits[(int)uVar11 >> 5] >> (uVar11 & 0x1f) & 1U) != 0)) {
          do {
            iVar10 = iVar10 + 1;
            iVar12 = FUN_00012900(uVar11,piVar4,local_4a0,uStack_49c);
          } while (0 < iVar12);
        }
        iVar2 = iVar2 + 1;
      } while (iVar2 != 2);
    }
    for (; piVar13 != (int *)0x0; piVar13 = (int *)*piVar13) {
      iVar12 = piVar13[1];
      iVar2 = iVar12 + 0x1f;
      if (-1 < iVar12) {
        iVar2 = iVar12;
      }
      if ((local_490.fds_bits[iVar2 >> 5] >> (iVar12 % 0x20 & 0xffU) & 1U) != 0) {
        iVar10 = iVar10 + 1;
        (*(code *)piVar13[3])(piVar13);
      }
    }
    if ((iVar10 == 0) && (DAT_0007cf4c != 0)) {
      FUN_0004fe78(7,"input_handler: select() returned 0");
    }
  }
  return;
}




int FUN_00015bd4(short *param_1)

{
  int iVar1;
  undefined4 uVar2;
  int *piVar3;
  undefined4 uVar4;
  
  iVar1 = FUN_00013e90(param_1,0x80,0);
  if (iVar1 == 0) {
    if (3 < DAT_0007cf4c) {
      uVar2 = FUN_00050cd0(param_1);
      printf("Found no interface for address %s - returning wildcard\n",uVar2);
    }
    if (*param_1 == 2) {
      piVar3 = &DAT_000ca608;
    }
    else {
      piVar3 = &DAT_000ca644;
    }
    return *piVar3;
  }
  if (3 < DAT_0007cf4c) {
    uVar4 = *(undefined4 *)(iVar1 + 0x10);
    uVar2 = FUN_00050cd0(param_1);
    printf("Found interface #%d %s for address %s\n",uVar4,iVar1 + 0x68,uVar2);
  }
  return iVar1;
}




int * FUN_00015c78(short *param_1)

{
  short sVar1;
  int *piVar2;
  int iVar3;
  short *psVar4;
  int iVar5;
  undefined4 uVar6;
  int *piVar7;
  bool bVar8;
  
  if (3 < DAT_0007cf4c) {
    uVar6 = FUN_00050cd0();
    printf("Finding broadcast/multicast interface for addr %s in list of addresses\n",uVar6);
  }
  piVar2 = (int *)FUN_00013e90(param_1,0x84,1);
  if (piVar2 == (int *)0x0) {
    if (DAT_000ca654 != (int *)0x0) {
      piVar2 = DAT_000ca654;
      do {
        if (((((piVar2[0x23] & 0x80U) == 0) && (piVar2[0x2c] == 0)) && ((short)piVar2[5] == *param_1)) &&
           ((piVar2[0x23] & 4U) == 0)) {
          iVar3 = FUN_00012884(param_1);
          if ((iVar3 == 0) || ((piVar2[0x23] & 0x10U) == 0)) {
            if (*param_1 == 2) {
              if ((((short)piVar2[0x13] == 2) && (piVar2[0x14] == *(uint *)(param_1 + 2))) ||
                 (((*(uint *)(param_1 + 2) ^ piVar2[6]) & piVar2[0xd]) == 0)) goto LAB_00015d90;
            }
            else if (*param_1 == 10) {
              if ((((short)piVar2[0x13] == 10) && (iVar3 = memcmp(piVar2 + 0x15,param_1 + 4,0x10), iVar3 == 0)) &&
                 (piVar2[0x19] == *(int *)(param_1 + 0xc))) goto LAB_00015d90;
              piVar7 = piVar2 + 5;
              psVar4 = (short *)FUN_0004fecc(piVar7);
              sVar1 = *psVar4;
              psVar4 = (short *)FUN_0004fecc(param_1);
              if (*psVar4 == sVar1) {
                psVar4 = (short *)FUN_0004fecc(piVar7);
                if (*psVar4 == 2) {
                  iVar3 = FUN_0004fecc(piVar7);
                  iVar5 = *(int *)(iVar3 + 4);
                  iVar3 = FUN_0004fecc(param_1);
                  bVar8 = iVar5 == *(int *)(iVar3 + 4);
                }
                else {
                  iVar3 = FUN_0004fecc(piVar7);
                  iVar5 = FUN_0004fecc(param_1);
                  iVar3 = memcmp((void *)(iVar3 + 8),(void *)(iVar5 + 8),0x10);
                  if (iVar3 != 0) goto LAB_00015cfc;
                  iVar3 = FUN_0004fecc(piVar7);
                  iVar5 = *(int *)(iVar3 + 0x18);
                  iVar3 = FUN_0004fecc(param_1);
                  bVar8 = iVar5 == *(int *)(iVar3 + 0x18);
                }
                if (bVar8) {
LAB_00015d90:
                  if (DAT_0007cf4c < 4) {
                    return piVar2;
                  }
                  printf("Found bcast-/mcast- interface index #%d %s\n",piVar2[4],piVar2 + 0x1a);
                  return piVar2;
                }
              }
            }
          }
          else if (((*param_1 != 10) || ((char)param_1[4] != -1)) ||
                  (((*(byte *)((int)param_1 + 9) & 0xf) != 2 || ((piVar2[7] & 0xc0ffU) == 0x80fe)))) goto LAB_00015d90;
        }
LAB_00015cfc:
        piVar2 = (int *)*piVar2;
      } while (piVar2 != (int *)0x0);
    }
    if (3 < DAT_0007cf4c) {
      uVar6 = FUN_00050cd0(param_1);
      printf("No bcast interface found for %s\n",uVar6);
    }
    if (*param_1 == 2) {
      piVar2 = &DAT_000ca608;
    }
    else {
      piVar2 = &DAT_000ca644;
    }
    piVar2 = (int *)*piVar2;
  }
  else if (3 < DAT_0007cf4c) {
    printf("Easily found bcast-/mcast- interface index #%d %s\n",piVar2[4],piVar2 + 0x1a);
  }
  return piVar2;
}




undefined4 FUN_00015fc4(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 *puVar1;
  
  puVar1 = param_1;
  *param_1 = DAT_0007cf44;
  DAT_0007cf44 = puVar1;
  FUN_00012224(param_1[5],1,param_1,&DAT_0007ce30,param_4);
  return 1;
}




void FUN_00015ff4(int *param_1)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  
  if (DAT_0007cf44 == param_1) {
    DAT_0007cf44 = (int *)*param_1;
  }
  else {
    if (DAT_0007cf44 == (int *)0x0) {
      return;
    }
    piVar3 = (int *)*DAT_0007cf44;
    piVar2 = DAT_0007cf44;
    while (piVar1 = piVar3, piVar1 != param_1) {
      if (piVar1 == (int *)0x0) {
        return;
      }
      piVar2 = piVar1;
      piVar3 = (int *)*piVar1;
    }
    *piVar2 = *param_1;
  }
  FUN_00010f54(param_1[5]);
  return;
}




void FUN_00016060(void)

{
  DAT_000ca604 = 0;
  if (DAT_000ca610 == 0) {
    return;
  }
  do {
    FUN_00010f54(*(undefined4 *)(DAT_000ca610 + 4));
  } while (DAT_000ca610 != 0);
  return;
}




void FUN_000160c0(short *param_1,short *param_2)

{
  short *psVar1;
  
  fwrite("Stack now",1,9,stderr);
  if (param_1 <= param_2) {
    do {
      psVar1 = param_1 + 1;
      fprintf(stderr," %d",(int)*param_1);
      param_1 = psVar1;
    } while (psVar1 <= param_2);
  }
  fputc(10,stderr);
  return;
}




void FUN_00016120(FILE *param_1,int param_2)

{
  char *__format;
  
  if (param_2 < 0xab) {
    __format = "token %s (";
  }
  else {
    __format = "nterm %s (";
  }
  fprintf(param_1,__format,(&DAT_0005de80)[param_2]);
  fputc(0x29,param_1);
  return;
}




void FUN_00016160(char *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  char *pcVar1;
  
  pcVar1 = "Deleting";
  if (param_1 != (char *)0x0) {
    pcVar1 = param_1;
  }
  if (DAT_000ca664 == 0) {
    return;
  }
  fprintf(stderr,"%s ",pcVar1,DAT_000ca664,param_4);
  FUN_00016120(stderr,param_2);
  fputc(10,stderr);
  return;
}




size_t FUN_000161c0(char *param_1,char *param_2)

{
  char *pcVar1;
  byte bVar2;
  char *pcVar3;
  size_t sVar4;
  
  if (*param_2 == '\"') {
    sVar4 = 0;
    pcVar3 = param_2;
    while (bVar2 = pcVar3[1], bVar2 != 0x27) {
      if (bVar2 < 0x28) {
        if (bVar2 == 0x22) {
          if (param_1 == (char *)0x0) {
            return sVar4;
          }
          param_1[sVar4] = '\0';
          return sVar4;
        }
LAB_0001620c:
        pcVar3 = pcVar3 + 1;
      }
      else {
        if (bVar2 == 0x2c) break;
        if (bVar2 != 0x5c) goto LAB_0001620c;
        pcVar1 = pcVar3 + 2;
        pcVar3 = pcVar3 + 2;
        if (*pcVar1 != '\\') break;
      }
      if (param_1 != (char *)0x0) {
        param_1[sVar4] = *pcVar3;
      }
      sVar4 = sVar4 + 1;
    }
  }
  if (param_1 != (char *)0x0) {
    pcVar3 = stpcpy(param_1,param_2);
    return (int)pcVar3 - (int)param_1;
  }
  sVar4 = strlen(param_2);
  return sVar4;
}




int FUN_00016268(undefined1 *param_1,int param_2,uint param_3)

{
  char *__src;
  uint uVar1;
  char *__dest;
  size_t sVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  uint *puVar6;
  undefined4 uVar7;
  short *psVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  bool bVar12;
  bool bVar13;
  char *local_84;
  undefined4 local_78 [5];
  uint local_64;
  char acStack_60 [4];
  char acStack_5c [4];
  char acStack_58 [4];
  char local_54 [4];
  char acStack_50 [4];
  undefined4 uStack_4c;
  
  uVar4 = 0x306;
  iVar10 = (int)(short)(&DAT_0005e2ac)[param_2];
  if (iVar10 + 0x90U < 0x307) {
    uVar3 = param_3;
    if (param_3 < 0x1a5) {
      uVar3 = (int)&DAT_0005de80 + param_3;
    }
    if (0x1a4 < param_3) {
      uVar4 = 2;
    }
    iVar9 = 0x277 - iVar10;
    if (param_3 < 0x1a5) {
      uVar4 = (uint)*(byte *)(uVar3 + 0x71c);
    }
    uVar7 = (&DAT_0005de80)[uVar4];
    uVar4 = FUN_000161c0(0,uVar7);
    if (iVar10 < 0) {
      iVar5 = -iVar10;
    }
    else {
      iVar5 = 0;
    }
    if (0xaa < iVar9) {
      iVar9 = 0xab;
    }
    local_64._0_1_ = 's';
    local_64._1_1_ = 'y';
    local_64._2_1_ = 'n';
    local_64._3_1_ = 't';
    acStack_60[0] = 'a';
    acStack_60[1] = 'x';
    acStack_60[2] = ' ';
    acStack_60[3] = 'e';
    acStack_5c[0] = 'r';
    acStack_5c[1] = 'r';
    acStack_5c[2] = 'o';
    acStack_5c[3] = 'r';
    acStack_58[0] = ',';
    acStack_58[1] = ' ';
    acStack_58[2] = 'u';
    acStack_58[3] = 'n';
    local_54[0] = 'e';
    local_54[1] = 'x';
    local_54[2] = 'p';
    local_54[3] = 'e';
    acStack_50[0] = 'c';
    acStack_50[1] = 't';
    acStack_50[2] = 'e';
    acStack_50[3] = 'd';
    uStack_4c._0_1_ = ' ';
    uStack_4c._1_1_ = '%';
    uStack_4c._2_1_ = 's';
    uStack_4c._3_1_ = '\0';
    uVar3 = uVar4;
    local_78[0] = uVar7;
    if (iVar5 < iVar9) {
      local_84 = ", expecting %s";
      __dest = (char *)((int)&uStack_4c + 3);
      psVar8 = (short *)("syntax error, unexpected %s" + (iVar5 + iVar10) * 2 + 0x1a);
      bVar12 = false;
      iVar11 = 1;
      do {
        while ((__src = local_84, psVar8 = psVar8 + 1, *psVar8 == iVar5 && (iVar5 != 1))) {
          iVar10 = iVar11 + 1;
          if (iVar11 == 5) {
            uStack_4c = uStack_4c & 0xffffff;
            iVar11 = 1;
            uVar3 = uVar4;
            goto LAB_000163b4;
          }
          uVar7 = (&DAT_0005de80)[iVar5];
          iVar5 = iVar5 + 1;
          local_78[iVar11] = uVar7;
          uVar1 = FUN_000161c0(0,uVar7);
          local_84 = " or %s";
          bVar13 = CARRY4(uVar1,uVar3);
          uVar3 = uVar1 + uVar3;
          if (bVar13) {
            bVar12 = true;
          }
          __dest = stpcpy(__dest,__src);
          iVar11 = iVar10;
          if (iVar5 == iVar9) goto LAB_000163b4;
        }
        iVar5 = iVar5 + 1;
      } while (iVar5 != iVar9);
    }
    else {
      bVar12 = false;
      iVar11 = 1;
    }
LAB_000163b4:
    sVar2 = strlen((char *)&local_64);
    iVar10 = sVar2 + uVar3;
    if (CARRY4(sVar2,uVar3)) {
      bVar12 = true;
    }
    if (bVar12) {
      iVar10 = -1;
    }
    else if (param_1 != (undefined1 *)0x0) {
      puVar6 = &local_64;
      uVar4 = local_64 & 0xff;
      iVar9 = 0;
      while (*param_1 = (char)uVar4, uVar4 != 0) {
        bVar12 = uVar4 == 0x25;
        uVar4 = (uint)*(byte *)((int)puVar6 + 1);
        if (((bVar12) && (uVar4 == 0x73)) && (iVar9 < iVar11)) {
          iVar5 = FUN_000161c0(param_1,local_78[iVar9]);
          uVar4 = (uint)*(byte *)((int)puVar6 + 2);
          puVar6 = (uint *)((int)puVar6 + 2);
          param_1 = param_1 + iVar5;
          iVar9 = iVar9 + 1;
        }
        else {
          param_1 = param_1 + 1;
          puVar6 = (uint *)((int)puVar6 + 1);
        }
      }
    }
  }
  else {
    iVar10 = 0;
  }
  return iVar10;
}




void FUN_00016478(undefined4 param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
  iVar1 = DAT_000ca668;
  uVar3 = *(undefined4 *)(DAT_000ca668 + 0x18);
  uVar2 = *(undefined4 *)(DAT_000ca668 + 0x14);
  *(undefined4 *)(DAT_000ca668 + 0x20) = uVar3;
  *(undefined4 *)(iVar1 + 0x1c) = uVar2;
  FUN_0004fe78(3,"line %d column %d %s",uVar2,uVar3,param_1);
  if (DAT_000794d8 == 0) {
    iVar1 = snprintf((char *)((int)&DAT_000ca170 + DAT_000ca574),0x400 - DAT_000ca574,"column %d %s",
                     *(undefined4 *)(DAT_000ca668 + 0x20),param_1);
    if (0 < iVar1) {
      DAT_000ca574 = iVar1 + DAT_000ca574;
    }
    DAT_000ca578 = DAT_000ca578 + 1;
  }
  return;
}




/* WARNING: Restarted to delay deadcode elimination for space: ram */

undefined4 FUN_0001651c(void)

{
  byte bVar1;
  char cVar2;
  short sVar3;
  FILE *__stream;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  double dVar7;
  undefined4 *puVar8;
  short *__dest;
  undefined4 uVar9;
  int iVar10;
  undefined4 uVar11;
  char *pcVar12;
  int iVar13;
  short *psVar14;
  uint uVar15;
  undefined4 uVar16;
  int iVar17;
  short *psVar18;
  short *psVar19;
  uint uVar20;
  uint *puVar21;
  uint *puVar22;
  uint uVar23;
  short *psVar24;
  bool bVar25;
  uint local_8e8;
  uint local_8e4;
  int local_8dc;
  undefined8 local_8d8;
  undefined1 *local_8d0;
  int local_8cc;
  uint *local_8c8;
  uint local_8c4;
  char acStack_8b8 [64];
  undefined1 auStack_878 [128];
  short local_7f8 [200];
  uint auStack_668 [401];
  
  if (DAT_000ca664 != 0) {
    fwrite("Starting parse\n",1,0xf,stderr);
  }
  psVar19 = local_7f8;
  DAT_000ca660 = 0;
  local_8c8 = auStack_668;
  local_8e4 = 0;
  local_8cc = 0;
  local_8d0 = auStack_878;
  DAT_000ca66c = 0xfffffffe;
  local_8c4 = 0x80;
  local_8e8 = 200;
  local_8dc = 199;
  psVar18 = (short *)0x0;
  puVar21 = local_8c8;
  psVar24 = psVar19;
LAB_000165a8:
  *psVar19 = (short)psVar18;
  __dest = psVar24;
  if (psVar24 + local_8dc <= psVar19) {
    iVar17 = (int)psVar19 - (int)psVar24 >> 1;
    if (local_8e8 < 1000) {
      local_8e8 = local_8e8 << 1;
      if (999 < local_8e8) {
        local_8e8 = 1000;
      }
      __dest = (short *)FUN_0004f524(local_8e8 * 10 + 7);
      if (__dest != (short *)0x0) {
        puVar22 = (uint *)(__dest + local_8e8);
        memcpy(__dest,psVar24,(iVar17 + 1) * 2);
        memcpy(puVar22,local_8c8,(iVar17 + 1) * 8);
        if (psVar24 != local_7f8) {
          free(psVar24);
        }
        psVar19 = __dest + iVar17;
        puVar21 = puVar22 + iVar17 * 2;
        if (DAT_000ca664 != 0) {
          fprintf(stderr,"Stack size increased to %lu\n",local_8e8);
        }
        local_8dc = local_8e8 - 1;
        local_8c8 = puVar22;
        if (psVar19 < __dest + local_8dc) goto LAB_0001666c;
        uVar16 = 1;
        goto LAB_00016da8;
      }
    }
LAB_000171f0:
    __dest = psVar24;
    uVar16 = 2;
    FUN_00016478("memory exhausted");
LAB_00016da8:
    if (DAT_000ca66c == 0xfffffffe) goto LAB_00016dc8;
    goto LAB_00016dbc;
  }
LAB_0001666c:
  if (DAT_000ca664 != 0) {
    fprintf(stderr,"Entering state %d\n",psVar18);
  }
  if (psVar18 == (short *)0xa8) {
    uVar16 = 0;
    goto LAB_00016da8;
  }
  iVar17 = (int)psVar18 * 2;
  sVar3 = (&DAT_0005e2ac)[(int)psVar18];
  psVar24 = __dest;
  if (sVar3 == -0x91) {
LAB_00016700:
    uVar23 = (uint)(ushort)(&DAT_0005f140)[(int)psVar18];
    if (uVar23 != 0) {
LAB_00016724:
      iVar17 = uVar23 * 2;
      bVar1 = (&DAT_0005f430)[uVar23];
      uVar15 = (uint)bVar1;
      dVar7 = *(double *)(puVar21 + (1 - uVar15) * 2);
      if ((DAT_000ca664 != 0) &&
         (fprintf(stderr,"Reducing stack by rule %d (line %lu):\n",uVar23 - 1,(uint)*(ushort *)(&DAT_0005f53c + iVar17))
         , uVar15 != 0)) {
        uVar20 = 0;
        psVar18 = (short *)(&UNK_0005f754 + (*(ushort *)(&DAT_0005fc98 + iVar17) - 1) * 2);
        do {
          uVar20 = uVar20 + 1;
          fprintf(stderr,"   $%d = ",uVar20);
          psVar18 = psVar18 + 1;
          FUN_00016120(stderr,(int)*psVar18);
          fputc(10,stderr);
        } while (uVar15 != uVar20);
      }
      iVar10 = DAT_000ca57c;
      uVar6 = DAT_000c9d60;
      uVar5 = DAT_000c9d5c;
      uVar4 = DAT_000c9d58;
      uVar11 = DAT_000c9d10;
      uVar9 = DAT_000c9d0c;
      uVar16 = DAT_000c9d04;
      local_8d8._4_4_ = (uint)((ulonglong)dVar7 >> 0x20);
      iVar13 = DAT_000ca57c;
      puVar8 = DAT_000ca668;
      switch(uVar23) {
      case 5:
        FUN_0004fe78(3,"syntax error in %s line %d, column %d",*DAT_000ca668,DAT_000ca668[7],DAT_000ca668[8]);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x13:
        iVar10 = FUN_0000fc80(puVar21[-4],puVar21[-2],*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        if (iVar10 != 0) {
          FUN_00010dcc(DAT_000c9ce4);
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0x14:
        iVar10 = FUN_0000fc80(puVar21[-2],*puVar21,0);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        if (iVar10 != 0) {
          FUN_00010dcc(DAT_000c9ce4);
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0x1b:
        uVar16 = FUN_0000fbb8(*puVar21,puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x1c:
        uVar16 = FUN_0000fbb8(*puVar21,0);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x1d:
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,2);
        dVar7 = local_8d8;
        break;
      case 0x1e:
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,10);
        dVar7 = local_8d8;
        break;
      case 0x1f:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x20:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x23:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x24:
        uVar16 = FUN_0000fa9c(0x198,*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x2d:
        uVar16 = FUN_0000fa9c(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x34:
        iVar10 = FUN_0000fe58(*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        if (iVar10 != 0) {
          FUN_00010dcc(DAT_000c9ce8);
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0x37:
        DAT_000c9cec = 1;
        break;
      case 0x38:
        FUN_00010e88(DAT_000c9cf0,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x39:
        FUN_00010e88(DAT_000c9cf4,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x3a:
        uVar16 = FUN_0000fa9c(puVar21[-2],*puVar21);
        FUN_00010dcc(uVar5,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x3b:
        DAT_000c9d20 = *puVar21;
        break;
      case 0x3c:
        DAT_000c9d24 = DAT_000c9d24 + 1;
        FUN_00010e88(DAT_000c9d28,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x3d:
        DAT_000c9d2c = *puVar21;
        break;
      case 0x3e:
        DAT_000c9d30 = *puVar21;
        break;
      case 0x3f:
        DAT_000c9d34 = *puVar21;
        break;
      case 0x40:
        DAT_000c9d38 = *puVar21;
        break;
      case 0x41:
        DAT_000c9d3c = *puVar21;
        break;
      case 0x42:
        DAT_000c9d40 = *puVar21;
        break;
      case 0x43:
        uVar16 = FUN_00010ed0();
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x44:
        if (*puVar21 == 0) {
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,puVar21[-2]);
          dVar7 = local_8d8;
        }
        else {
          uVar16 = FUN_00010dcc(puVar21[-2]);
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0x45:
        uVar16 = FUN_0000faf4(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x46:
        DAT_000c9d38 = *puVar21;
        local_8d8 = (double)((ulonglong)local_8d8._4_4_ << 0x20);
        FUN_0004fe78(4,"\'crypto revoke %d\' is deprecated, please use \'revoke %d\' instead.",DAT_000c9d38);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x4d:
        FUN_00010e88(DAT_000c9cf8,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x4e:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x4f:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x50:
        uVar16 = FUN_0000fa6c(SUB84((double)(longlong)(int)*puVar21,0),puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x51:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x52:
        uVar16 = FUN_0000fa6c(SUB84((double)(longlong)(int)*puVar21,0),puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x5c:
        FUN_00010e88(DAT_000c9cfc,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x5d:
        if (DAT_000794d8 == 0) {
          free((void *)*puVar21);
          FUN_00016478("statsdir remote configuration ignored");
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        else {
          DAT_000c9d00 = *puVar21;
        }
        break;
      case 0x5e:
        uVar9 = FUN_0000fef8(puVar21[-2],*puVar21);
        FUN_00010dcc(uVar16,uVar9);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x5f:
        uVar23 = puVar21[-2];
        uVar16 = FUN_0000fb68(*puVar21);
        uVar16 = FUN_00010dcc(uVar23,uVar16);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x60:
        FUN_0000fb68(*puVar21);
        uVar16 = FUN_0000fa4c();
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x69:
        uVar16 = FUN_00010ed0();
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x6a:
        if (*puVar21 == 0) {
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,puVar21[-2]);
          dVar7 = local_8d8;
        }
        else {
          uVar16 = FUN_00010dcc();
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0x6b:
        if (DAT_000794d8 == 0) {
          local_8d8 = (double)((ulonglong)local_8d8._4_4_ << 0x20);
          free((void *)*puVar21);
          FUN_00016478("filegen file remote config ignored");
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        else {
          uVar16 = FUN_0000faf4(puVar21[-2],*puVar21);
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0x6c:
        if (DAT_000794d8 == 0) {
          local_8d8 = (double)((ulonglong)local_8d8._4_4_ << 0x20);
          FUN_00016478("filegen type remote config ignored");
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        else {
          uVar16 = FUN_0000fa9c(puVar21[-2],*puVar21);
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0x6d:
        if (DAT_000794d8 == 0) {
          pcVar12 = "filegen nolink remote config ignored";
          local_8d8 = (double)((ulonglong)local_8d8._4_4_ << 0x20);
          if (*puVar21 == 0x143) {
            pcVar12 = "filegen link remote config ignored";
          }
          FUN_00016478(pcVar12);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        else {
          uVar16 = FUN_0000fa9c(0x198,*puVar21);
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0x6e:
        uVar16 = FUN_0000fa9c(0x198,*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x7a:
        FUN_00010e88(DAT_000c9d08,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x7b:
        uVar16 = FUN_0000ff14(puVar21[-2],0,*puVar21,DAT_000ca668[2]);
        FUN_00010dcc(uVar9,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x7c:
        uVar16 = FUN_0000ff14(0,0,*puVar21,DAT_000ca668[2]);
        FUN_00010dcc(uVar9,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x7d:
        uVar16 = FUN_0004f4e8("0.0.0.0");
        uVar16 = FUN_0000fbb8(uVar16,2);
        uVar11 = FUN_0004f4e8("0.0.0.0");
        uVar11 = FUN_0000fbb8(uVar11,2);
        uVar16 = FUN_0000ff14(uVar16,uVar11,*puVar21,DAT_000ca668[2]);
        FUN_00010dcc(uVar9,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x7e:
        uVar16 = FUN_0004f4e8(&DAT_00060760);
        uVar16 = FUN_0000fbb8(uVar16,10);
        uVar11 = FUN_0004f4e8(&DAT_00060760);
        uVar11 = FUN_0000fbb8(uVar11,10);
        uVar16 = FUN_0000ff14(uVar16,uVar11,*puVar21,DAT_000ca668[2]);
        FUN_00010dcc(uVar9,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x7f:
        uVar16 = FUN_0000ff14(puVar21[-6],puVar21[-2],*puVar21,DAT_000ca668[2]);
        FUN_00010dcc(uVar9,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x80:
        uVar16 = FUN_00010ed0();
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x81:
        uVar23 = puVar21[-2];
        uVar16 = FUN_0000fb68(*puVar21);
        uVar16 = FUN_00010dcc(uVar23,uVar16);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x90:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x91:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x92:
        uVar16 = FUN_0000fa9c(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x96:
        uVar16 = FUN_0001069c(puVar21[-2],*puVar21);
        FUN_00010dcc(uVar11,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x97:
        FUN_00010dcc(puVar21[-2],*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x98:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x99:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x9a:
        uVar16 = FUN_0000fa9c(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x9b:
        uVar16 = FUN_0000fa9c(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x9c:
        uVar16 = FUN_0000faf4(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xa3:
        FUN_00010e88(DAT_000c9d18,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xa4:
        FUN_00010e88(DAT_000c9d1c,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xa5:
        if (*puVar21 == 0) {
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,puVar21[-2]);
          dVar7 = local_8d8;
        }
        else {
          uVar16 = FUN_00010dcc(puVar21[-2]);
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0xa6:
        if (*puVar21 == 0) {
          uVar16 = FUN_00010ed0();
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        else {
          uVar16 = FUN_0000fa4c();
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0xa7:
        uVar16 = FUN_0000fa9c(0x198,*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xa8:
        if (DAT_000794d8 == 0) {
          local_8d8 = (double)((ulonglong)local_8d8._4_4_ << 0x20);
          FUN_00016478("enable/disable stats remote config ignored");
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        else {
          uVar16 = FUN_0000fa9c(0x198,*puVar21);
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0xaf:
        FUN_00010e88(DAT_000c9d14,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xb0:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xb1:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xb2:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xbb:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-2]);
        FUN_00010dcc(DAT_000c9d5c,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xbc:
        uVar16 = FUN_0000faf4(puVar21[-2],*puVar21);
        FUN_00010dcc(DAT_000c9d5c,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xbd:
        if (DAT_000794d8 == 0) {
          free((void *)*puVar21);
          uVar16 = FUN_000182b8(puVar21[-2]);
          snprintf(acStack_8b8,0x40,"%s remote config ignored",uVar16);
          FUN_00016478(acStack_8b8);
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        else {
          uVar16 = FUN_0000faf4(puVar21[-2],*puVar21);
          FUN_00010dcc(DAT_000c9d5c,uVar16);
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0xbe:
        if (DAT_000794d8 == 0) {
          FUN_00016478("remote includefile ignored");
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        else if (DAT_000ca57c < 5) {
          uVar16 = FUN_0004f538(puVar21[-2]);
          uVar16 = FUN_000182f0(uVar16,"r");
          iVar13 = DAT_000ca57c + 1;
          (&DAT_000c9ca0)[iVar10 + 1] = uVar16;
          __stream = stderr;
          puVar8 = (undefined4 *)(&DAT_000c9ca0)[iVar13];
          if ((undefined4 *)(&DAT_000c9ca0)[iVar13] == (undefined4 *)0x0) {
            uVar16 = FUN_0004f538(puVar21[-2]);
            fprintf(__stream,"getconfig: Couldn\'t open <%s>\n",uVar16);
            uVar16 = FUN_0004f538(puVar21[-2]);
            FUN_0004fe78(3,"getconfig: Couldn\'t open <%s>\n",uVar16);
            iVar13 = DAT_000ca57c;
            puVar8 = DAT_000ca668;
          }
        }
        else {
          fwrite("getconfig: Maximum include file level exceeded.\n",1,0x30,stderr);
          FUN_0004fe78(3,"getconfig: Maximum include file level exceeded.\n");
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0xbf:
        while (iVar13 = DAT_000ca57c, puVar8 = DAT_000ca668, DAT_000ca57c != -1) {
          puVar8 = &DAT_000c9ca0 + DAT_000ca57c;
          DAT_000ca57c = DAT_000ca57c + -1;
          FUN_000183c8(*puVar8);
        }
        break;
      case 0xc0:
        uVar16 = FUN_0000fa9c(puVar21[-2],*puVar21);
        FUN_00010dcc(uVar5,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xc2:
        FUN_00010e88(DAT_000c9d44,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xc3:
        FUN_00010e88(DAT_000c9d4c,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xc4:
        FUN_00010dcc(DAT_000c9d50,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xc5:
        uVar16 = FUN_0001069c(*puVar21,0);
        FUN_00010dcc(uVar4,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xc6:
        uVar16 = FUN_0001069c(puVar21[-2],*puVar21);
        FUN_00010dcc(uVar4,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 199:
        FUN_00010e88(DAT_000c9d54,*puVar21);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xcf:
        uVar16 = FUN_0000faf4(0x11f,*puVar21);
        FUN_00010dcc(uVar5,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xd0:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,0x193);
        FUN_00010dcc(uVar5,uVar16);
        uVar16 = DAT_000c9d5c;
        uVar9 = FUN_0000faf4(0x11f,puVar21[-2]);
        FUN_00010dcc(uVar16,uVar9);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xd1:
        uVar16 = FUN_0000faf4(0x11f,&DAT_0005feb0);
        FUN_00010dcc(uVar5,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xd2:
        uVar16 = FUN_00010600(puVar21[-6],puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xd4:
        local_8d8 = (double)((ulonglong)local_8d8._4_4_ << 0x20);
        dVar7 = local_8d8;
        break;
      case 0xd5:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xd6:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xd7:
        uVar16 = FUN_0000fa9c(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xd8:
        uVar16 = FUN_0000fb40(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xd9:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xda:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xdb:
        cVar2 = *(char *)*puVar21;
        if ((cVar2 == '-' || cVar2 == '+') || (cVar2 == '=')) {
          uVar16 = FUN_0004f4e8((char *)*puVar21 + 1);
          uVar16 = FUN_0000faf4(cVar2,uVar16);
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        }
        else {
          FUN_00016478("Logconfig prefix is not \'+\', \'-\' or \'=\'\n");
          local_8d8 = dVar7;
        }
        free((void *)*puVar21);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xdc:
        uVar16 = FUN_0001063c(*puVar21,0,puVar21[-2]);
        FUN_00010dcc(uVar6,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xdd:
        uVar16 = FUN_0001063c(0,*puVar21,puVar21[-2]);
        FUN_00010dcc(uVar6,uVar16);
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xe7:
        uVar23 = puVar21[-2];
        uVar16 = FUN_0000fb68(*puVar21);
        uVar16 = FUN_00010dcc(uVar23,uVar16);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xe8:
        FUN_0000fb68(*puVar21);
        uVar16 = FUN_0000fa4c();
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xe9:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xea:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xeb:
        uVar16 = FUN_0000fa9c(0x69,*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xed:
        uVar16 = FUN_0000fac4(0x2d,(short)puVar21[-6],(short)puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xee:
        uVar23 = puVar21[-2];
        uVar16 = FUN_0000fba0(*puVar21);
        uVar16 = FUN_00010dcc(uVar23,uVar16);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xef:
        FUN_0000fba0(*puVar21);
        uVar16 = FUN_0000fa4c();
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xf0:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xf1:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xf2:
        if (*puVar21 < 2) {
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,*puVar21);
          dVar7 = local_8d8;
        }
        else {
          local_8d8 = (double)CONCAT44(local_8d8._4_4_,1);
          FUN_00016478("Integer value is not boolean (0 or 1). Assuming 1");
          dVar7 = local_8d8;
          iVar13 = DAT_000ca57c;
          puVar8 = DAT_000ca668;
        }
        break;
      case 0xf3:
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,1);
        dVar7 = local_8d8;
        break;
      case 0xf4:
        local_8d8 = (double)((ulonglong)local_8d8._4_4_ << 0x20);
        dVar7 = local_8d8;
        break;
      case 0xf5:
        dVar7 = (double)(longlong)(int)*puVar21;
        break;
      case 0xf7:
        DAT_000c9d64 = FUN_00010908(puVar21[-4],puVar21[-2]);
        DAT_000794f4 = 1;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xf8:
        DAT_000794f4 = 0;
        break;
      case 0xf9:
        uVar16 = FUN_00010dcc(puVar21[-4],puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xfa:
        uVar16 = FUN_0000fa4c(puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xfb:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-4]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xfc:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-4]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xfd:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xfe:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0xff:
        uVar16 = FUN_0001079c((int)*(undefined8 *)(puVar21 + -4),puVar21[-8],puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x100:
        dVar7 = *(double *)(puVar21 + -2);
        break;
      case 0x101:
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,*puVar21);
        dVar7 = local_8d8;
        break;
      case 0x102:
        uVar16 = FUN_00010dcc(puVar21[-2],*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x103:
        uVar16 = FUN_0000fa4c(*puVar21);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x104:
        uVar16 = FUN_000106b8((int)*(undefined8 *)(puVar21 + -6),puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x105:
        uVar16 = FUN_00010dcc(puVar21[-4],puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x106:
        uVar16 = FUN_0000fa4c(puVar21[-2]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x107:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-4]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x108:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-4]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x109:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-4]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x10a:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-4]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
        break;
      case 0x10b:
        uVar16 = FUN_0000fa6c((int)*(undefined8 *)puVar21,puVar21[-4]);
        local_8d8 = (double)CONCAT44(local_8d8._4_4_,uVar16);
        dVar7 = local_8d8;
        iVar13 = DAT_000ca57c;
        puVar8 = DAT_000ca668;
      }
      DAT_000ca668 = puVar8;
      DAT_000ca57c = iVar13;
      local_8d8 = dVar7;
      if (DAT_000ca664 == 0) {
        puVar21 = puVar21 + (short)(ushort)bVar1 * -2;
        psVar19 = psVar19 + -(int)(short)(ushort)bVar1;
        uVar23 = (uint)*(ushort *)(&DAT_0005feb4 + iVar17);
      }
      else {
        puVar21 = puVar21 + (short)(ushort)bVar1 * -2;
        fprintf(stderr,"%s ","-> $$ =");
        psVar19 = psVar19 + -(int)(short)(ushort)bVar1;
        uVar23 = (uint)*(ushort *)(&DAT_0005feb4 + iVar17);
        FUN_00016120(stderr,uVar23);
        fputc(10,stderr);
        if (DAT_000ca664 != 0) {
          FUN_000160c0(__dest,psVar19);
        }
      }
      iVar17 = (uVar23 - 0xab) * 2;
      sVar3 = *psVar19;
      puVar21[2] = (uint)local_8d8;
      puVar21[3] = local_8d8._4_4_;
      puVar22 = puVar21 + 2;
      uVar23 = (int)*(short *)(&DAT_000600cc + iVar17) + (int)sVar3;
      if ((uVar23 < 0x277) && (iVar10 = uVar23 * 2, (int)*(short *)(&DAT_0005e760 + iVar10) == (int)sVar3)) {
        psVar14 = (short *)(int)*(short *)(&DAT_0005ec50 + iVar10);
      }
      else {
        psVar14 = (short *)(int)*(short *)(&DAT_00060180 + iVar17);
      }
      goto LAB_00016c24;
    }
LAB_00016c48:
    if (local_8cc == 0) {
      DAT_000ca660 = DAT_000ca660 + 1;
      uVar23 = FUN_00016268(0,psVar18,DAT_000ca66c);
      bVar25 = 0xfffffffe < local_8c4;
      if (local_8c4 != 0xffffffff) {
        bVar25 = uVar23 <= local_8c4;
      }
      if (!bVar25) {
        local_8c4 = uVar23 * 2;
        if (local_8c4 < uVar23) {
          local_8c4 = 0xffffffff;
        }
        if (local_8d0 != auStack_878) {
          free(local_8d0);
        }
        local_8d0 = (undefined1 *)FUN_0004f524(local_8c4);
        if (local_8d0 == (undefined1 *)0x0) {
          local_8c4 = 0x80;
          local_8d0 = auStack_878;
        }
      }
      uVar15 = uVar23;
      if (uVar23 != 0) {
        uVar15 = 1;
      }
      if (local_8c4 < uVar23) {
        uVar23 = 0;
      }
      else {
        uVar23 = uVar15 & 1;
      }
      if (uVar23 != 0) {
        FUN_00016268(local_8d0,psVar18,DAT_000ca66c);
        FUN_00016478(local_8d0);
        goto LAB_00016c70;
      }
      FUN_00016478("syntax error");
      if (uVar15 == 0) goto LAB_00016c70;
      goto LAB_000171f0;
    }
    if (local_8cc == 3) {
      if ((int)DAT_000ca66c < 1) {
        if (DAT_000ca66c == 0) {
          uVar16 = 1;
LAB_00016dbc:
          FUN_00016160("Cleanup: discarding lookahead",local_8e4);
LAB_00016dc8:
          if (DAT_000ca664 != 0) {
            FUN_000160c0(__dest,psVar19);
          }
          for (; __dest != psVar19; psVar19 = psVar19 + -1) {
            FUN_00016160("Cleanup: popping",*(undefined2 *)(&DAT_00060234 + *psVar19 * 2));
          }
          if (__dest != local_7f8) {
            free(__dest);
          }
          if (local_8d0 != auStack_878) {
            free(local_8d0);
          }
          return uVar16;
        }
      }
      else {
        FUN_00016160("Error: discarding",local_8e4);
        DAT_000ca66c = 0xfffffffe;
      }
    }
LAB_00016c70:
    do {
      psVar14 = psVar19 + -1;
      uVar23 = (int)*(short *)((int)&DAT_0005e2ac + iVar17) + 1;
      if (*(short *)((int)&DAT_0005e2ac + iVar17) != -0x91) {
        iVar10 = uVar23 * 2;
        if (((uVar23 < 0x277) && (*(short *)(&DAT_0005e760 + iVar10) == 1)) &&
           (psVar18 = (short *)(int)*(short *)(&DAT_0005ec50 + iVar10), 0 < (int)psVar18)) goto code_r0x00016d0c;
      }
      puVar21 = puVar21 + -2;
      if (__dest == psVar19) {
        uVar16 = 1;
        psVar19 = __dest;
        goto LAB_00016da8;
      }
      FUN_00016160("Error: popping",*(undefined2 *)(&DAT_00060234 + iVar17));
      sVar3 = psVar19[-1];
      if (DAT_000ca664 != 0) {
        FUN_000160c0(__dest,psVar14);
      }
      iVar17 = (int)sVar3 << 1;
      psVar19 = psVar14;
    } while( true );
  }
  if (DAT_000ca66c == 0xfffffffe) {
    if (DAT_000ca664 != 0) {
      fwrite("Reading a token: ",1,0x11,stderr);
    }
    DAT_000ca66c = FUN_0001858c();
    if (0 < (int)DAT_000ca66c) goto LAB_000166b4;
LAB_00016ecc:
    DAT_000ca66c = 0;
    if (DAT_000ca664 == 0) {
      local_8e4 = 0;
    }
    else {
      local_8e4 = 0;
      fwrite("Now at end of input.\n",1,0x15,stderr);
    }
  }
  else {
    if ((int)DAT_000ca66c < 1) goto LAB_00016ecc;
LAB_000166b4:
    if (DAT_000ca66c < 0x1a5) {
      local_8e4 = (uint)(byte)(&DAT_0005e59c)[DAT_000ca66c];
    }
    else {
      local_8e4 = 2;
    }
    if (DAT_000ca664 != 0) {
      fprintf(stderr,"%s ","Next token is");
      FUN_00016120(stderr,local_8e4);
      fputc(10,stderr);
    }
  }
  uVar23 = (int)sVar3 + local_8e4;
  if (0x276 < uVar23) goto LAB_00016700;
  iVar10 = uVar23 * 2;
  uVar23 = (uint)*(short *)(&DAT_0005e760 + iVar10);
  if (uVar23 != local_8e4) goto LAB_00016700;
  psVar14 = (short *)(int)*(short *)(&DAT_0005ec50 + iVar10);
  if ((int)psVar14 < 1) {
    if (psVar14 == (short *)0xfffffff9 || psVar14 == (short *)0x0) goto LAB_00016c48;
    uVar23 = -(int)psVar14;
    goto LAB_00016724;
  }
  if (local_8cc != 0) {
    local_8cc = local_8cc + -1;
  }
  if (DAT_000ca664 != 0) {
    fprintf(stderr,"%s ","Shifting");
    FUN_00016120(stderr,uVar23);
    fputc(10,stderr);
  }
  DAT_000ca66c = 0xfffffffe;
  puVar21[2] = DAT_000ca670;
  puVar21[3] = DAT_000ca674;
  puVar22 = puVar21 + 2;
  local_8e4 = uVar23;
LAB_00016c24:
  psVar19 = psVar19 + 1;
  psVar18 = psVar14;
  puVar21 = puVar22;
  goto LAB_000165a8;
code_r0x00016d0c:
  puVar22 = puVar21 + 2;
  local_8cc = DAT_000ca664;
  if (DAT_000ca664 == 0) {
    local_8cc = 3;
    psVar14 = psVar18;
  }
  puVar21[2] = DAT_000ca670;
  puVar21[3] = DAT_000ca674;
  if (DAT_000ca664 != 0) {
    fprintf(stderr,"%s ","Shifting");
    local_8cc = 3;
    FUN_00016120(stderr,*(undefined2 *)(&DAT_00060234 + (int)psVar18 * 2));
    fputc(10,stderr);
    psVar14 = psVar18;
  }
  goto LAB_00016c24;
}




undefined4 FUN_0001821c(uint param_1)

{
  uint uVar1;
  
  if (param_1 < 0x1a5) {
    uVar1 = (uint)(byte)(&DAT_0005e59c)[param_1];
  }
  else {
    uVar1 = 2;
  }
  return (&DAT_0005de80)[uVar1];
}




undefined4 FUN_0001823c(void)

{
  ushort **ppuVar1;
  uint uVar2;
  byte *pbVar3;
  
  pbVar3 = &DAT_000ca678;
  uVar2 = (uint)DAT_000ca678;
  if (uVar2 != 0) {
    ppuVar1 = __ctype_b_loc();
    do {
      if (((*ppuVar1)[uVar2] & 0x2000) == 0) {
        DAT_000ca670 = FUN_0004f4e8(&DAT_000ca678);
        return 0x183;
      }
      pbVar3 = pbVar3 + 1;
      uVar2 = (uint)*pbVar3;
    } while (uVar2 != 0);
  }
  DAT_000ca670 = 0x19a;
  return 0x19a;
}




char * FUN_000182b8(int param_1)

{
  char *pcVar1;
  
  if (param_1 - 0x102U < 0xa3) {
    pcVar1 = (&PTR_s_age_00061628)[param_1 - 0x102U];
    if ((&PTR_s_age_00061628)[param_1 - 0x102U] == (char *)0x0) {
      pcVar1 = "(keyword not found)";
    }
    return pcVar1;
  }
  return "(keyword not found)";
}




undefined4 * FUN_000182f0(char *param_1,char *param_2)

{
  undefined4 *__ptr;
  FILE *pFVar1;
  
  __ptr = (undefined4 *)FUN_0004f524(0x24);
  __ptr[3] = 0;
  __ptr[4] = 0;
  __ptr[6] = 0;
  *__ptr = param_1;
  __ptr[2] = 1;
  pFVar1 = fopen(param_1,param_2);
  __ptr[1] = pFVar1;
  if (pFVar1 == (FILE *)0x0) {
    free(__ptr);
    __ptr = (undefined4 *)0x0;
  }
  return __ptr;
}




int FUN_000183c8(void *param_1)

{
  int iVar1;
  
  iVar1 = fclose(*(FILE **)((int)param_1 + 4));
  if (iVar1 == 0) {
    free(param_1);
  }
  return iVar1;
}




uint FUN_000183f0(void)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  
  iVar1 = DAT_000ca668;
  if (DAT_000794d8 == 0) {
    if ((&DAT_000c9d70)[DAT_000ca570] == '\0') {
      uVar2 = 0xffffffff;
    }
    else {
      iVar3 = DAT_000ca570 + 1;
      iVar4 = *(int *)(DAT_000ca668 + 0xc) + 1;
      *(int *)(DAT_000ca668 + 0xc) = iVar4;
      uVar2 = (uint)(byte)(&DAT_000c9d70)[DAT_000ca570];
      DAT_000ca570 = iVar3;
      if (uVar2 == 10) {
        *(int *)(iVar1 + 0x10) = iVar4;
        *(undefined4 *)(iVar1 + 0xc) = 1;
        *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + 1;
      }
    }
    return uVar2;
  }
  uVar2 = fgetc(*(FILE **)(DAT_000ca668 + 4));
  iVar3 = *(int *)(iVar1 + 0xc) + 1;
  *(int *)(iVar1 + 0xc) = iVar3;
  if (uVar2 != 10) {
    return uVar2;
  }
  *(int *)(iVar1 + 0x10) = iVar3;
  *(undefined4 *)(iVar1 + 0xc) = 1;
  *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + 1;
  return 10;
}




void FUN_00018488(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  bool bVar4;
  
  iVar2 = DAT_000ca668;
  if (DAT_000794d8 == 0) {
    bVar4 = param_1 == 10;
    if (bVar4) {
      param_1 = -1;
      iVar3 = *(int *)(DAT_000ca668 + 0x10);
      *(int *)(DAT_000ca668 + 8) = *(int *)(DAT_000ca668 + 8) + -1;
      *(int *)(iVar2 + 0xc) = iVar3;
    }
    else {
      iVar3 = *(int *)(DAT_000ca668 + 0xc);
    }
    if (bVar4) {
      *(int *)(iVar2 + 0x10) = param_1;
    }
    *(int *)(iVar2 + 0xc) = iVar3 + -1;
    DAT_000ca570 = DAT_000ca570 + -1;
    return;
  }
  if (param_1 == 10) {
    piVar1 = (int *)(DAT_000ca668 + 8);
    iVar3 = *(int *)(DAT_000ca668 + 0x10);
    *(undefined4 *)(DAT_000ca668 + 0x10) = 0xffffffff;
    *(int *)(iVar2 + 8) = *piVar1 + -1;
  }
  else {
    iVar3 = *(int *)(DAT_000ca668 + 0xc);
  }
  *(int *)(iVar2 + 0xc) = iVar3 + -1;
  ungetc(param_1,*(FILE **)(iVar2 + 4));
  return;
}




char * FUN_000184fc(char *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  size_t sVar1;
  char *__dest;
  size_t sVar2;
  char *pcVar3;
  size_t __n;
  
  sVar1 = strlen(param_1);
  __n = sVar1 + 3;
  __dest = (char *)FUN_0004f524(__n);
  if ((*param_1 != '\"') &&
     ((sVar2 = strcspn(param_1,"{}(),;|="), sVar2 < sVar1 || (pcVar3 = strchr(param_1,0x20), pcVar3 != (char *)0x0)))) {
    snprintf(__dest,__n,"\"%s\"",param_1,param_4);
    return __dest;
  }
  strncpy(__dest,param_1,__n);
  return __dest;
}




/* WARNING: Type propagation algorithm not settling */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Restarted to delay deadcode elimination for space: ram */

uint FUN_0001858c(void)

{
  undefined4 *puVar1;
  byte bVar2;
  bool bVar3;
  uint uVar4;
  ushort **ppuVar5;
  char *pcVar6;
  int iVar7;
  undefined4 uVar8;
  __int32_t **pp_Var9;
  long lVar10;
  int *piVar11;
  byte *pbVar12;
  uint uVar13;
  byte *pbVar14;
  uint uVar15;
  ushort *puVar16;
  uint uVar17;
  int iVar18;
  
  bVar3 = false;
LAB_000185ac:
  do {
    uVar4 = FUN_000183f0();
    while( true ) {
      if (uVar4 == 0xffffffff) {
        if (DAT_000794d8 == 0) {
          return 0;
        }
        if (DAT_000ca57c == 0) {
          return 0;
        }
        FUN_000183c8((&DAT_000c9ca0)[DAT_000ca57c]);
        DAT_000ca57c = DAT_000ca57c - 1;
        DAT_000ca668 = (&DAT_000c9ca0)[DAT_000ca57c];
        goto LAB_000185f8;
      }
      ppuVar5 = __ctype_b_loc();
      if (((*ppuVar5)[uVar4] & 0x2000) == 0) {
        if (DAT_000794f4 == 0) {
          if (uVar4 == 0x3b) goto LAB_000185ec;
        }
        else if (uVar4 == 10) goto LAB_000185ec;
        pcVar6 = strchr("{}(),;|=",uVar4);
        if ((pcVar6 == (char *)0x0) || (DAT_0007cf48 != 0)) {
          uVar17 = 0;
          FUN_00018488(uVar4);
          iVar7 = DAT_000ca668;
          puVar1 = (undefined4 *)(DAT_000ca668 + 0xc);
          *(undefined4 *)(DAT_000ca668 + 0x14) = *(undefined4 *)(DAT_000ca668 + 8);
          *(undefined4 *)(iVar7 + 0x18) = *puVar1;
          goto LAB_000186ac;
        }
        if (uVar4 == 0x3d) {
          DAT_0007cf48 = 1;
        }
        bVar3 = false;
        DAT_000ca678 = (byte)uVar4;
        DAT_000ca679 = '\0';
        goto LAB_00018750;
      }
      if (DAT_000794f4 == 0) break;
      if (uVar4 == 10) goto LAB_000185ec;
      uVar4 = FUN_000183f0();
    }
  } while (uVar4 != 0x3b);
LAB_000185ec:
  DAT_0007cf48 = 0;
LAB_000185f8:
  bVar3 = false;
  goto LAB_000185fc;
LAB_000186ac:
  iVar7 = FUN_000183f0();
  if (iVar7 == -1) goto LAB_0001884c;
  (&DAT_000ca678)[uVar17] = (byte)iVar7;
  if (((*ppuVar5)[iVar7] & 0x2000) != 0) {
    if (iVar7 != 0x22) goto LAB_000186e8;
    goto LAB_00018790;
  }
  if (DAT_000794f4 == 0) {
    if (iVar7 == 0x3b) goto LAB_000186e8;
  }
  else if (iVar7 == 10) goto LAB_000186e8;
  if (iVar7 == 0x22) goto LAB_00018790;
  if ((DAT_0007cf48 == 0) && (pcVar6 = strchr("{}(),;|=",iVar7), pcVar6 != (char *)0x0)) goto LAB_00018844;
  if (iVar7 == 0x23) goto LAB_00018814;
  uVar17 = uVar17 + 1;
  if (uVar17 == 0x401) goto LAB_000187b8;
  goto LAB_000186ac;
LAB_00018790:
  iVar7 = FUN_000183f0();
  if (iVar7 != -1) {
    if (iVar7 != 10 && iVar7 != 0x22) goto code_r0x000187a8;
    if (iVar7 == 0x22) {
      iVar7 = FUN_000183f0();
      bVar3 = true;
LAB_00018844:
      if (iVar7 == -1) goto LAB_0001884c;
    }
    else {
      bVar3 = true;
    }
    goto LAB_000186e8;
  }
  goto LAB_000188c4;
code_r0x000187a8:
  (&DAT_000ca678)[uVar17] = (byte)iVar7;
  uVar17 = uVar17 + 1;
  if (0x400 < uVar17) {
LAB_000187b8:
    DAT_000ca6aa = 0;
    FUN_0004fe78(3,"configuration item on line %d longer than limit of %lu, began with \'%s\'",
                 *(undefined4 *)(DAT_000ca668 + 8),0x400,&DAT_000ca678);
    if (DAT_000794d8 == 0) {
      _DAT_000ca670 = (double)((ulonglong)_DAT_000ca670 & 0xffffffff00000000);
      return 0;
    }
                    /* WARNING: Subroutine does not return */
    exit(0x400);
  }
  goto LAB_00018790;
LAB_000188c4:
  bVar3 = true;
  FUN_00018488(10);
  goto LAB_000186f0;
  while (iVar7 != 10) {
LAB_00018814:
    iVar7 = FUN_000183f0();
    if (iVar7 == -1) goto LAB_0001884c;
  }
  iVar7 = 10;
LAB_000186e8:
  FUN_00018488(iVar7);
LAB_000186f0:
  (&DAT_000ca678)[uVar17] = 0;
  if (uVar17 != 0) goto code_r0x00018704;
  goto LAB_000185ac;
LAB_0001884c:
  FUN_00018488(10);
  goto LAB_000186f0;
code_r0x00018704:
  if ((DAT_0007cf48 != 0) || (bVar3)) {
    if (DAT_000ca678 != 0x2d) {
LAB_00018738:
      if (DAT_0007cf48 == 1) {
        DAT_0007cf48 = 0;
      }
      goto LAB_00018744;
    }
    if (DAT_000ca679 == '4') {
      uVar4 = 0x138;
      bVar3 = false;
    }
    else {
      if (DAT_000ca679 != '6') goto LAB_00018738;
      uVar4 = 0x13a;
      bVar3 = false;
    }
  }
  else {
    uVar17 = (uint)DAT_000ca678;
    if (uVar17 != 0) {
      uVar4 = 0x2e6;
      iVar7 = 0;
      iVar18 = 0;
      uVar13 = uVar17;
      do {
        uVar15 = *(uint *)(&UNK_000618c0 + uVar4 * 4);
        if ((uVar15 & 0xff) == uVar13) {
          if (((&DAT_000ca679)[iVar7] == '\0') && (uVar13 = (uVar15 << 0x16) >> 0x1e, uVar13 != 3)) {
            bVar3 = false;
            DAT_0007cf48 = uVar13;
            goto LAB_00018750;
          }
          iVar7 = iVar18 + 1;
          uVar15 = uVar15 << 0xb;
          uVar13 = (uint)(byte)(&DAT_000ca679)[iVar18];
          iVar18 = iVar7;
          if (uVar13 == 0) break;
        }
        uVar4 = uVar15 >> 0x15;
      } while (uVar4 != 0);
    }
    uVar4 = (uint)(uVar17 == 0x2d);
    pbVar12 = &DAT_000ca678 + uVar4;
    uVar13 = (uint)(&DAT_000ca678)[uVar4];
    if (uVar13 != 0) {
      puVar16 = *ppuVar5;
      do {
        uVar15 = puVar16[uVar13] & 0x800;
        if ((puVar16[uVar13] & 0x800) == 0) {
          if (uVar17 == 0x2b) {
            uVar4 = 1;
          }
          pbVar12 = &DAT_000ca678 + uVar4;
          bVar2 = (&DAT_000ca678)[uVar4];
          goto joined_r0x00018a48;
        }
        uVar13 = (uint)pbVar12[1];
        pbVar12 = pbVar12 + 1;
      } while (uVar13 != 0);
    }
    piVar11 = __errno_location();
    *piVar11 = 0;
    lVar10 = strtol((char *)&DAT_000ca678,(char **)0x0,10);
    _DAT_000ca670 = (double)CONCAT44(DAT_000ca674,lVar10);
    if ((lVar10 == 0) && (*piVar11 == 0x16 || *piVar11 == 0x22)) {
      FUN_0004fe78(3,"Integer cannot be represented: %s",&DAT_000ca678);
                    /* WARNING: Subroutine does not return */
      exit(1);
    }
    uVar4 = 0x135;
    bVar3 = true;
  }
  goto LAB_0001875c;
joined_r0x00018a48:
  uVar4 = (uint)bVar2;
  if (uVar4 == 0) goto LAB_00018744;
  if ((puVar16[uVar4] & 0x800) == 0) {
    if (uVar4 == 0x2e) {
      bVar2 = pbVar12[1];
      pbVar12 = pbVar12 + -0xca678;
      goto joined_r0x00018a9c;
    }
    goto LAB_00018744;
  }
  bVar2 = pbVar12[1];
  uVar15 = uVar15 + 1;
  pbVar12 = pbVar12 + 1;
  goto joined_r0x00018a48;
joined_r0x00018a9c:
  uVar4 = (uint)bVar2;
  if (uVar4 == 0) goto LAB_00018bbc;
  if ((puVar16[uVar4] & 0x800) == 0) {
    if ((uVar15 == 0) || (pp_Var9 = __ctype_tolower_loc(), (*pp_Var9)[uVar4] != 0x65)) goto LAB_00018744;
    pbVar14 = pbVar12 + 2;
    uVar4 = (uint)(byte)(&DAT_000ca67a)[(int)pbVar12];
    if (uVar4 == 0x2b || uVar4 == 0x2d) {
      pbVar14 = pbVar12 + 3;
      uVar4 = (uint)pbVar12[0xca67b];
    }
    if (uVar4 == 0) goto LAB_00018bc4;
    pbVar14 = &DAT_000ca678 + (int)pbVar14;
    goto LAB_00018b20;
  }
  uVar15 = uVar15 + 1;
  bVar2 = (&DAT_000ca67a)[(int)pbVar12];
  pbVar12 = pbVar12 + 1;
  goto joined_r0x00018a9c;
LAB_00018bbc:
  if (uVar15 != 0) goto LAB_00018bc4;
LAB_00018744:
  uVar4 = FUN_0001823c();
  bVar3 = true;
LAB_00018750:
  if (uVar4 == 0x19a) {
LAB_000185fc:
    if (DAT_0007cf4c < 4) {
      uVar4 = 0x19a;
    }
    else {
      uVar4 = 0x19a;
      puts("\t<end of command>");
    }
    goto LAB_00018610;
  }
  goto LAB_0001875c;
  while( true ) {
    pbVar14 = pbVar14 + 1;
    uVar4 = (uint)*pbVar14;
    if (uVar4 == 0) break;
LAB_00018b20:
    if ((puVar16[uVar4] & 0x800) == 0) goto LAB_00018744;
  }
LAB_00018bc4:
  piVar11 = __errno_location();
  *piVar11 = 0;
  _DAT_000ca670 = strtod((char *)&DAT_000ca678,(char **)0x0);
  if ((_DAT_000ca670 == 0.0) && (*piVar11 == 0x22)) {
    FUN_0004fe78(3,"Double too large to represent: %s",&DAT_000ca678);
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  uVar4 = 0x11e;
  bVar3 = true;
LAB_0001875c:
  if (3 < DAT_0007cf4c) {
    uVar8 = FUN_0001821c(uVar4);
    printf("yylex: lexeme \'%s\' -> %s\n",&DAT_000ca678,uVar8);
  }
LAB_00018610:
  if (!bVar3) {
    _DAT_000ca670 = (double)CONCAT44(DAT_000ca674,uVar4);
  }
  return uVar4;
}




void FUN_00018c60(void)

{
  int *piVar1;
  undefined4 in_r3;
  int iVar2;
  
  piVar1 = __errno_location();
  iVar2 = *piVar1;
  if (0 < DAT_0007cf4c) {
    DAT_0007cf4c = DAT_0007cf4c + -1;
    FUN_0004fe78(7,"debug lowered to %d",DAT_0007cf4c,&DAT_0007cf4c,in_r3);
  }
  *piVar1 = iVar2;
  return;
}




void FUN_00018ca8(void)

{
  int *piVar1;
  undefined4 in_r3;
  int iVar2;
  
  piVar1 = __errno_location();
  iVar2 = *piVar1;
  if (DAT_0007cf4c < 0xff) {
    DAT_0007cf4c = DAT_0007cf4c + 1;
    FUN_0004fe78(7,"debug raised to %d",DAT_0007cf4c,&DAT_0007cf4c,in_r3);
  }
  *piVar1 = iVar2;
  return;
}




void FUN_00018cf0(undefined4 param_1,undefined4 param_2,char *param_3,__gnuc_va_list param_4)

{
  char acStack_110 [256];
  
  if (DAT_0007cf50 < 100) {
    FUN_0004fe78(3,"%s:%d: unexpected error:",param_1,param_2);
    vsnprintf(acStack_110,0x100,param_3,param_4);
    FUN_0004fe78(3,acStack_110);
    DAT_0007cf50 = DAT_0007cf50 + 1;
    if (DAT_0007cf50 == 100) {
      FUN_0004fe78(3,"Too many errors.  Shutting up.");
    }
  }
  return;
}




void FUN_00018d7c(undefined4 param_1,undefined4 param_2,char *param_3,__gnuc_va_list param_4)

{
  char acStack_118 [260];
  
  FUN_0005164c(0);
  FUN_0004fe78(3,"%s:%d: fatal error:",param_1,param_2);
  vsnprintf(acStack_118,0x100,param_3,param_4);
  FUN_0004fe78(3,acStack_118);
  FUN_0004fe78(3,"exiting (due to fatal error in library)");
                    /* WARNING: Subroutine does not return */
  abort();
}




void FUN_00018de8(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uVar1;
  
  FUN_00051514(0);
  uVar1 = FUN_00051534(param_3);
  FUN_0004fe78(3,"%s:%d: %s(%s) failed",param_1,param_2,uVar1,param_4);
  FUN_0004fe78(3,"exiting (due to assertion failure)");
                    /* WARNING: Subroutine does not return */
  abort();
}




void FUN_00018e44(int param_1)

{
  FUN_0004fe78(5,"ntpd exiting on signal %d",param_1);
  if (param_1 == 0) {
    return;
  }
  if (param_1 != 7) {
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  puts("\nfinish(SIGBUS)");
                    /* WARNING: Subroutine does not return */
  exit(0);
}




void FUN_00018e8c(char *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  char *pcVar1;
  
  pcVar1 = strrchr(param_1,0x2f);
  if (pcVar1 != (char *)0x0) {
    param_1 = pcVar1 + 1;
  }
  openlog(param_1,9,0x18);
  setlogmask(0xff);
  if (param_2 == 0) {
    return;
  }
  if ((DAT_0007be6c & 1) == 0) {
    return;
  }
  FUN_0004fe78(5,"%s",DAT_00079e4c,param_4);
  return;
}




void FUN_00018efc(void)

{
  int iVar1;
  int iVar2;
  FILE *__stream;
  char *__s1;
  
  if ((*(uint *)(DAT_0007954c + 0x350) & 0xf) == 0) {
    return;
  }
  __s1 = *(char **)(DAT_0007954c + 0x358);
  iVar1 = strcmp(__s1,"stderr");
  __stream = stderr;
  if ((iVar1 != 0) && (iVar1 = strcmp(__s1,"stdout"), __stream = stdout, iVar1 != 0)) {
    __stream = fopen(__s1,"a");
  }
  if (__stream == (FILE *)0x0) {
    FUN_0004fe78(3,"Cannot open log file %s",__s1);
    return;
  }
  if ((DAT_0007be6c & 1) != 0) {
    FUN_0004fe78(5,"logging to file %s",__s1);
  }
  if (DAT_000cf6f0 != (FILE *)0x0) {
    iVar1 = fileno(DAT_000cf6f0);
    iVar2 = fileno(__stream);
    if (iVar1 != iVar2) {
      fclose(DAT_000cf6f0);
    }
  }
  DAT_000cf6f0 = __stream;
  DAT_0007be68 = 0;
  return;
}




void FUN_00019018(int param_1,undefined4 *param_2)

{
  int iVar1;
  __mode_t __mask;
  __uid_t _Var2;
  undefined4 uVar3;
  ushort **ppuVar4;
  char *pcVar5;
  int *piVar6;
  byte *pbVar7;
  code *pcVar8;
  int iVar9;
  int iVar10;
  sched_param local_d8;
  int local_d4;
  int local_d0;
  undefined1 auStack_cc [8];
  undefined1 auStack_c4 [28];
  fd_set fStack_a8;
  
  DAT_000caa7c = *param_2;
  DAT_000caa98 = 1;
  iVar1 = FUN_0004ffc0(&DAT_00079508,param_1,param_2);
  FUN_00018e8c(DAT_000caa7c,1);
  __mask = umask(0);
  if (__mask == 0) {
    __mask = 0x12;
  }
  umask(__mask);
  _Var2 = getuid();
  if ((_Var2 != 0) && ((*(uint *)(DAT_0007954c + 0x590) & 0xf) == 0)) {
    FUN_0004fe78(3,"ntpd: must be run as root, not uid %ld",_Var2);
    printf("must be run as root, not uid %ld\n",_Var2);
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  DAT_0007cf4c = (uint)*(ushort *)(DAT_0007954c + 0x18e);
  if (DAT_0007cf4c != 0) {
    puts(DAT_00079e4c);
  }
  FUN_00018efc();
  if (((((*(uint *)(DAT_0007954c + 0x410) & 0xf) != 0) || ((*(uint *)(DAT_0007954c + 0x510) & 0xf) != 0)) ||
      (DAT_0007cf4c != 0)) || ((*(uint *)(DAT_0007954c + 0x590) & 0xf) != 0)) {
    DAT_0007cf54 = 1;
  }
  if ((*(uint *)(DAT_0007954c + 0x390) & 0xf) != 0) {
    DAT_00079500 = 0;
  }
  if ((*(uint *)(DAT_0007954c + 0x2d0) & 0xf) != 0) {
    iVar9 = **(int **)(DAT_0007954c + 0x2dc);
    iVar10 = iVar9 + -1;
    piVar6 = *(int **)(DAT_0007954c + 0x2dc) + 2;
    if (0 < iVar9) {
      do {
        iVar9 = FUN_00014720(*piVar6,auStack_c4);
        iVar10 = iVar10 + -1;
        if (iVar9 == 0) {
          uVar3 = 4;
        }
        else {
          uVar3 = 5;
        }
        FUN_000148dc(uVar3,*piVar6,0xffffffff);
        piVar6 = piVar6 + 1;
      } while (iVar10 != -1);
    }
  }
  if ((*(uint *)(DAT_0007954c + 0x450) & 0xf) != 0) {
    DAT_00079504 = 0;
  }
  if ((*(uint *)(DAT_0007954c + 0x4d0) & 0xf) != 0) {
    DAT_000c9cb8 = *(int *)(DAT_0007954c + 0x4d8);
    DAT_00079504 = 0;
    DAT_0007ce2c = 1;
  }
  FUN_0004cba8(&local_d4);
  FUN_000505a4(local_d0 * local_d4);
  if (DAT_0007cf54 == 0) {
    FUN_00051514(FUN_00018de8);
    FUN_0005164c(FUN_00018d7c);
    FUN_0005162c(FUN_00018cf0);
    daemon(0,0);
  }
  FUN_0005131c(1,FUN_00018e44);
  FUN_0005131c(2,FUN_00018e44);
  FUN_0005131c(3,FUN_00018e44);
  FUN_0005131c(0xf,FUN_00018e44);
  FUN_0005131c(7,FUN_00018e44);
  FUN_0005131c(10,FUN_00018ca8);
  FUN_0005131c(0xc,FUN_00018c60);
  FUN_0005131c(0xd,1);
  FUN_0004dc58();
  FUN_0002d808();
  FUN_0002c9cc();
  FUN_00020d28();
  FUN_0002d304();
  FUN_0004f7c0();
  FUN_0002c294();
  FUN_0001cbe8();
  FUN_00021400();
  FUN_000270e4();
  if (1 < (int)DAT_0007cf4c) {
    pcVar5 = "Leave priority alone";
    if (DAT_00079504 == 0) {
      pcVar5 = "Attempt to set priority";
    }
    FUN_0004fe78(7,"set_process_priority: %s: priority_done is <%d>",pcVar5,DAT_00079504);
  }
  if (DAT_00079504 == 0) {
    iVar9 = sched_get_priority_max(1);
    local_d8.__sched_priority = iVar9;
    if (DAT_0007ce2c != 0) {
      iVar10 = sched_get_priority_min(1);
      local_d8.__sched_priority = iVar9;
      if ((DAT_000c9cb8 <= iVar9) && (local_d8.__sched_priority = iVar10, iVar10 < DAT_000c9cb8)) {
        local_d8.__sched_priority = DAT_000c9cb8;
      }
    }
    iVar9 = sched_setscheduler(0,1,&local_d8);
    if (iVar9 == -1) {
      FUN_0004fe78(3,"sched_setscheduler(): %m");
    }
    else {
      DAT_00079504 = DAT_00079504 + 1;
    }
    if (DAT_00079504 == 0) {
      iVar9 = setpriority(PRIO_PROCESS,0,-0xc);
      if (iVar9 == -1) {
        FUN_0004fe78(3,"setpriority() error: %m");
      }
      else {
        DAT_00079504 = DAT_00079504 + 1;
      }
      if (DAT_00079504 == 0) {
        FUN_0004fe78(3,"set_process_priority: No way found to improve our priority");
      }
    }
  }
  FUN_000266e0();
  FUN_000142b0();
  FUN_0001fbf0();
  FUN_00020d7c(1);
  FUN_000109fc(param_1 - iVar1,param_2 + iVar1);
  FUN_0001d3d8(6,0,0);
  FUN_00020854((int)DAT_0007a5f8,2);
  DAT_000caa98 = 0;
  if (DAT_0007cf58 == 0) goto LAB_000192a8;
  iVar1 = prctl(8,1,0,0,0);
  pbVar7 = DAT_0007cf5c;
  if (iVar1 == -1) {
    FUN_0004fe78(3,"prctl( PR_SET_KEEPCAPS, 1L ) failed: %m");
                    /* WARNING: Subroutine does not return */
    exit(-1);
  }
  if (DAT_0007cf5c != (byte *)0x0) {
    ppuVar4 = __ctype_b_loc();
    if ((((*ppuVar4)[*pbVar7] & 0x800) == 0) ||
       (DAT_000caa84 = strtoul((char *)pbVar7,&DAT_000caa8c,0), *DAT_000caa8c != '\0')) {
      piVar6 = __errno_location();
      pbVar7 = DAT_0007cf5c;
      *piVar6 = 0;
      DAT_000caa94 = getpwnam((char *)pbVar7);
      if (DAT_000caa94 == (passwd *)0x0) {
        if (*piVar6 == 0) {
          pcVar5 = "Cannot find user `%s\'";
        }
        else {
          pcVar5 = "getpwnam(%s) failed: %m";
        }
        FUN_0004fe78(3,pcVar5,DAT_0007cf5c);
        goto LAB_000197e4;
      }
      DAT_000caa88 = DAT_000caa94->pw_gid;
      DAT_000caa84 = DAT_000caa94->pw_uid;
    }
    else {
      DAT_000caa94 = getpwuid(DAT_000caa84);
      if (DAT_000caa94 == (passwd *)0x0) {
        piVar6 = __errno_location();
        pcVar5 = "Cannot find user ID %s";
        pbVar7 = DAT_0007cf5c;
        goto LAB_00019658;
      }
      DAT_0007cf5c = (byte *)__strdup(DAT_000caa94->pw_name);
      if (DAT_0007cf5c == (byte *)0x0) {
        FUN_0004fe78(3,"strdup() failed: %m");
                    /* WARNING: Subroutine does not return */
        exit(-1);
      }
      DAT_000caa88 = DAT_000caa94->pw_gid;
    }
  }
  pbVar7 = DAT_0007cf60;
  if ((DAT_0007cf60 != (byte *)0x0) &&
     ((ppuVar4 = __ctype_b_loc(), ((*ppuVar4)[*pbVar7] & 0x800) == 0 ||
      (DAT_000caa88 = strtoul((char *)pbVar7,&DAT_000caa8c,0), *DAT_000caa8c != '\0')))) {
    DAT_000caa90 = getgrnam((char *)DAT_0007cf60);
    if (DAT_000caa90 == (group *)0x0) {
      piVar6 = __errno_location();
      pcVar5 = "Cannot find group `%s\'";
      pbVar7 = DAT_0007cf60;
LAB_00019658:
      *piVar6 = 0;
      FUN_0004fe78(3,pcVar5,pbVar7);
                    /* WARNING: Subroutine does not return */
      exit(-1);
    }
    DAT_000caa88 = DAT_000caa90->gr_gid;
  }
  if (DAT_0007cf64 != (char *)0x0) {
    iVar1 = chdir(DAT_0007cf64);
    if (iVar1 != 0) {
      FUN_0004fe78(3,"Cannot chdir() to `%s\': %m",DAT_0007cf64);
                    /* WARNING: Subroutine does not return */
      exit(-1);
    }
    iVar1 = chroot(DAT_0007cf64);
    if (iVar1 != 0) {
      FUN_0004fe78(3,"Cannot chroot() to `%s\': %m",DAT_0007cf64);
                    /* WARNING: Subroutine does not return */
      exit(-1);
    }
    iVar1 = chdir("/");
    if (iVar1 != 0) {
      FUN_0004fe78(3,"Cannot chdir() to`root after chroot(): %m");
LAB_000197e4:
                    /* WARNING: Subroutine does not return */
      exit(-1);
    }
  }
  if ((DAT_0007cf5c != (byte *)0x0) && (iVar1 = initgroups((char *)DAT_0007cf5c,DAT_000caa88), iVar1 != 0)) {
    FUN_0004fe78(3,"Cannot initgroups() to user `%s\': %m",DAT_0007cf5c);
                    /* WARNING: Subroutine does not return */
    exit(-1);
  }
  if (DAT_0007cf60 != (byte *)0x0) {
    iVar1 = setgid(DAT_000caa88);
    if (iVar1 != 0) {
      FUN_0004fe78(3,"Cannot setgid() to group `%s\': %m",DAT_0007cf60);
                    /* WARNING: Subroutine does not return */
      exit(-1);
    }
    if ((DAT_0007cf60 != (byte *)0x0) && (iVar1 = setegid(DAT_000caa88), iVar1 != 0)) {
      FUN_0004fe78(3,"Cannot setegid() to group `%s\': %m",DAT_0007cf60);
                    /* WARNING: Subroutine does not return */
      exit(-1);
    }
  }
  if (DAT_0007cf5c != (byte *)0x0) {
    iVar1 = setuid(DAT_000caa84);
    if (iVar1 != 0) {
      FUN_0004fe78(3,"Cannot setuid() to user `%s\': %m",DAT_0007cf5c);
                    /* WARNING: Subroutine does not return */
      exit(-1);
    }
    if ((DAT_0007cf5c != (byte *)0x0) && (iVar1 = seteuid(DAT_000caa84), iVar1 != 0)) {
      FUN_0004fe78(3,"Cannot seteuid() to user `%s\': %m",DAT_0007cf5c);
                    /* WARNING: Subroutine does not return */
      exit(-1);
    }
  }
  if (DAT_000ca648 == 0) {
LAB_00019908:
    if (DAT_0007a4e8 == 0) goto LAB_0001978c;
    pcVar5 = "cap_sys_time,cap_net_bind_service=ipe";
  }
  else {
    if (DAT_0007a4e8 != 0) {
      DAT_0007a4e8 = 0;
      FUN_0004fe78(6,"running in unprivileged mode disables dynamic interface tracking");
      goto LAB_00019908;
    }
LAB_0001978c:
    pcVar5 = "cap_sys_time=ipe";
  }
  iVar1 = cap_from_text(pcVar5);
  if (iVar1 == 0) {
    FUN_0004fe78(3,"cap_from_text() failed: %m");
                    /* WARNING: Subroutine does not return */
    exit(-1);
  }
  iVar9 = cap_set_proc();
  if (iVar9 == -1) {
    FUN_0004fe78(3,"cap_set_proc() failed to drop root privileges: %m");
                    /* WARNING: Subroutine does not return */
    exit(-1);
  }
  cap_free(iVar1);
LAB_000192a8:
  DAT_000caa80 = 0;
  do {
    if (DAT_000cb570 != 0) {
      DAT_000caa80 = 1;
      DAT_000cb570 = 0;
    }
    if (DAT_000caa80 == 0) {
      iVar1 = FUN_00050bd4();
      if (iVar1 == 0) {
        memcpy(&fStack_a8,&DAT_000ca584,0x80);
        iVar1 = select(DAT_000ca604 + 1,&fStack_a8,(fd_set *)0x0,(fd_set *)0x0,(timeval *)0x0);
        if (iVar1 < 1) {
          if ((iVar1 == -1) && (piVar6 = __errno_location(), *piVar6 != 4)) {
            FUN_0004fe78(3,"select() error: %m");
          }
          else if (5 < (int)DAT_0007cf4c) {
            FUN_0004fe78(7,"select(): nfound=%d, error: %m",iVar1);
          }
        }
        else {
          FUN_0004cba8(auStack_cc);
          FUN_00015730(auStack_cc);
        }
        if (DAT_000cb570 != 0) {
          DAT_000caa80 = 1;
          DAT_000cb570 = 0;
        }
      }
      if (DAT_000caa80 != 0) goto LAB_000192e4;
    }
    else {
LAB_000192e4:
      FUN_0002d3ac();
      DAT_000caa80 = 0;
    }
    iVar1 = FUN_00050af4();
    while (iVar1 != 0) {
      if (DAT_000cb570 == 0) {
        if (DAT_000caa80 != 0) goto LAB_00019344;
        pcVar8 = *(code **)(iVar1 + 0x54);
      }
      else {
        DAT_000caa80 = 1;
        DAT_000cb570 = 0;
LAB_00019344:
        FUN_0002d3ac();
        pcVar8 = *(code **)(iVar1 + 0x54);
        DAT_000caa80 = 0;
      }
      if (pcVar8 == (code *)0x0) {
        FUN_0004fe78(3,"receive buffer corruption - receiver found to be NULL - ABORTING");
                    /* WARNING: Subroutine does not return */
        abort();
      }
      (*pcVar8)(iVar1);
      FUN_000509c4(iVar1);
      iVar1 = FUN_00050af4();
    }
  } while( true );
}




void FUN_00019af8(int param_1)

{
  uint uVar1;
  short extraout_r2;
  short sVar2;
  uint *puVar3;
  int *piVar4;
  uint *puVar5;
  int iVar6;
  uint *puVar7;
  undefined4 *puVar8;
  
  puVar5 = DAT_0007cf6c;
  puVar3 = DAT_0007cf6c;
  if ((param_1 == 0) && (DAT_0007cf70 != 0)) {
    puVar3 = (uint *)((int)DAT_0007cf6c + 2);
    puVar7 = puVar3;
    *(undefined1 *)DAT_0007cf6c = 0xd;
    DAT_0007cf6c = puVar7;
    *(undefined1 *)((int)puVar5 + 1) = 10;
  }
  puVar7 = puVar3 + -0x1f3e0;
  puVar5 = puVar3 + -0x1f3dd;
  uVar1 = DAT_0007d184;
  for (; DAT_0007d184 = uVar1, ((uint)puVar5 & 3) != 0; puVar5 = (uint *)((int)puVar5 + 1)) {
    DAT_0007cf6c = (uint *)((int)puVar3 + 1);
    *(undefined1 *)puVar3 = 0;
    puVar3 = DAT_0007cf6c;
    uVar1 = DAT_0007d184;
  }
  DAT_0007cf7c = (ushort)(byte)((uint)DAT_0007d17c >> 8) | (ushort)((int)DAT_0007d17c << 8);
  DAT_0007cf75 = ~((byte)~(byte)((uint)(param_1 * 0x2000000) >> 0x18) >> 1) | DAT_0007d178 & 0x1f;
  DAT_0007cf7e = (ushort)(byte)((uint)puVar7 >> 8) | (short)puVar7 * 0x100;
  if (DAT_0007d180 == '\0') {
    if ((DAT_0007d181 == '\0') || (DAT_000cb46c == 0)) {
      FUN_000154a4(DAT_0007d188,DAT_0007d18c,0xfffffffa,&DAT_0007cf74,puVar5);
    }
    else {
      for (; ((uint)puVar5 & 7) != 0; puVar5 = (uint *)((int)puVar5 + 1)) {
        *(undefined1 *)DAT_0007cf6c = 0;
        DAT_0007cf6c = (uint *)((int)DAT_0007cf6c + 1);
      }
      *DAT_0007cf6c = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 | (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
      iVar6 = FUN_0004e458(uVar1,&DAT_0007cf74,puVar5);
      FUN_000154a4(DAT_0007d188,DAT_0007d18c,0xfffffffb,&DAT_0007cf74,(undefined1 *)((int)puVar5 + iVar6));
    }
    if (param_1 == 0) {
      piVar4 = &DAT_000caab8;
    }
    else {
      piVar4 = &DAT_000caab4;
    }
    *piVar4 = *piVar4 + 1;
  }
  else {
    puVar8 = &DAT_000caadc;
    iVar6 = 0;
    do {
      if ((*(byte *)((int)puVar8 + 0x32) & 1) != 0) {
        DAT_0007cf74 = DAT_000cb4b0 << 6 | 6U | (*(byte *)((int)puVar8 + 0x33) & 7) << 3;
        DAT_0007cf76 = *(ushort *)(puVar8 + 0xc) << 8 | *(ushort *)(puVar8 + 0xc) >> 8;
        FUN_000154a4(&DAT_000caadc + iVar6 * 0xd,puVar8[7],0xfffffffc,&DAT_0007cf74,puVar5);
        sVar2 = extraout_r2;
        if (param_1 == 0) {
          sVar2 = *(short *)(puVar8 + 0xc);
        }
        DAT_000caaac = DAT_000caaac + 1;
        if (param_1 == 0) {
          *(short *)(puVar8 + 0xc) = sVar2 + 1;
        }
      }
      iVar6 = iVar6 + 1;
      puVar8 = puVar8 + 0xd;
    } while (iVar6 != 3);
  }
  DAT_0007cf6c = (uint *)&DAT_0007cf80;
  DAT_0007d17c = (undefined1 *)((int)DAT_0007d17c + (int)puVar7);
  return;
}




void FUN_00019d60(void *param_1,size_t param_2,int param_3)

{
  int iVar1;
  undefined *__dest;
  
  if (param_3 == 0) {
    DAT_0007cf70 = 1;
    if (DAT_0007cf6c == &DAT_0007cf80) {
      iVar1 = 3;
      __dest = &DAT_0007cf80;
    }
    else {
      *DAT_0007cf6c = 0x2c;
      if (DAT_0007d190 + 2 + param_2 < 0x48) {
        __dest = DAT_0007cf6c + 2;
        DAT_0007d190 = DAT_0007d190 + 2;
        DAT_0007cf6c[1] = 0x20;
        iVar1 = 3;
        DAT_0007cf6c = __dest;
      }
      else {
        __dest = DAT_0007cf6c + 3;
        DAT_0007d190 = 0;
        DAT_0007cf6c[1] = 0xd;
        DAT_0007cf6c[2] = 10;
        iVar1 = 3;
        DAT_0007cf6c = __dest;
      }
    }
  }
  else {
    iVar1 = 0;
    __dest = DAT_0007cf6c;
  }
  if (DAT_0007d194 < __dest + iVar1 + param_2) {
    FUN_00019af8(0x20);
    __dest = DAT_0007cf6c;
  }
  memmove(__dest,param_1,param_2);
  DAT_0007cf6c = __dest + param_2;
  DAT_0007d190 = param_2 + DAT_0007d190;
  return;
}




void FUN_00019e64(char *param_1,undefined4 param_2)

{
  char cVar1;
  char *pcVar2;
  size_t sVar3;
  char *__s;
  char local_d8 [200];
  
  cVar1 = *param_1;
  pcVar2 = local_d8;
  while (cVar1 != '\0') {
    *pcVar2 = cVar1;
    param_1 = param_1 + 1;
    pcVar2 = pcVar2 + 1;
    cVar1 = *param_1;
  }
  __s = pcVar2 + 1;
  *pcVar2 = '=';
  if (199 < (uint)((int)__s - (int)local_d8)) {
    (*DAT_0007c9fc)("ntp_control.c",0x4a9,2,"(cp - buffer) < sizeof(buffer)");
  }
  snprintf(__s,(size_t)(&stack0xfffffff0 + -(int)__s),"%ld",param_2);
  sVar3 = strlen(__s);
  FUN_00019d60(local_d8,__s + (sVar3 - (int)local_d8),0);
  return;
}




void FUN_00019f28(char *param_1,undefined4 param_2,int param_3)

{
  char cVar1;
  char *pcVar2;
  undefined4 uVar3;
  size_t sVar4;
  char *__s;
  char local_d8 [200];
  
  cVar1 = *param_1;
  pcVar2 = local_d8;
  while (cVar1 != '\0') {
    *pcVar2 = cVar1;
    param_1 = param_1 + 1;
    pcVar2 = pcVar2 + 1;
    cVar1 = *param_1;
  }
  __s = pcVar2 + 1;
  *pcVar2 = '=';
  if (param_3 == 0) {
    uVar3 = FUN_00050054(param_2);
  }
  else {
    uVar3 = FUN_00050cd0(param_3);
  }
  if (199 < (uint)((int)__s - (int)local_d8)) {
    (*DAT_0007c9fc)("ntp_control.c",0x4e3,2,"(cp - buffer) < sizeof(buffer)");
  }
  snprintf(__s,(size_t)(&stack0xfffffff0 + -(int)__s),"%s",uVar3);
  sVar4 = strlen(__s);
  FUN_00019d60(local_d8,__s + (sVar4 - (int)local_d8),0);
  return;
}




void FUN_0001a010(byte *param_1,uint param_2)

{
  ushort **ppuVar1;
  ushort *puVar2;
  byte bVar3;
  byte *pbVar4;
  uint uVar5;
  byte *pbVar6;
  byte *pbVar7;
  byte *pbVar8;
  bool bVar9;
  bool bVar10;
  undefined4 local_24;
  byte local_20 [16];
  
  bVar3 = *param_1;
  if (bVar3 == 0) {
    pbVar6 = local_20;
  }
  else {
    pbVar6 = local_20;
    do {
      pbVar6 = pbVar6 + 1;
      pbVar6[-1] = bVar3;
      if (pbVar6 == &stack0xfffffff0) {
        return;
      }
      param_1 = param_1 + 1;
      bVar3 = *param_1;
    } while (bVar3 != 0);
  }
  pbVar7 = pbVar6 + 1;
  *pbVar6 = 0x3d;
  if (pbVar7 < &stack0xfffffff0) {
    uVar5 = param_2 & 0xff;
    pbVar8 = pbVar7;
    local_24 = param_2;
    if (uVar5 != 0) {
      ppuVar1 = __ctype_b_loc();
      puVar2 = *ppuVar1;
      pbVar4 = (byte *)((int)&local_24 + 1);
      pbVar6 = pbVar6 + 2;
      do {
        pbVar8 = pbVar6;
        if ((puVar2[uVar5] & 0x4000) == 0) {
          pbVar8[-1] = 0x2e;
        }
        else {
          pbVar8[-1] = (byte)uVar5;
        }
        bVar10 = pbVar4 <= local_20;
        bVar9 = local_20 == pbVar4;
        if (bVar10 && !bVar9) {
          bVar10 = pbVar8 <= &stack0xfffffff0;
          bVar9 = &stack0xfffffff0 == pbVar8;
        }
        if (!bVar10 || bVar9) break;
        uVar5 = (uint)*pbVar4;
        pbVar4 = pbVar4 + 1;
        pbVar6 = pbVar8 + 1;
      } while (uVar5 != 0);
    }
    if (pbVar8 <= &stack0xfffffff0) {
      pbVar7 = pbVar8;
    }
    FUN_00019d60(local_20,(int)pbVar7 - (int)local_20,0);
  }
  return;
}




void FUN_0001a104(char *param_1,undefined4 *param_2)

{
  size_t sVar1;
  char *pcVar2;
  char cVar3;
  char *__s;
  char local_d8 [200];
  
  cVar3 = *param_1;
  if (cVar3 == '\0') {
    pcVar2 = local_d8;
  }
  else {
    pcVar2 = local_d8;
    do {
      pcVar2 = pcVar2 + 1;
      pcVar2[-1] = cVar3;
      param_1 = param_1 + 1;
      cVar3 = *param_1;
    } while (cVar3 != '\0');
  }
  __s = pcVar2 + 1;
  *pcVar2 = '=';
  if (199 < (uint)((int)__s - (int)local_d8)) {
    (*DAT_0007c9fc)("ntp_control.c",0x4c3,2,"(cp - buffer) < sizeof(buffer)");
  }
  snprintf(__s,(size_t)(&stack0xfffffff0 + -(int)__s),"0x%08lx.%08lx",*param_2,param_2[1]);
  sVar1 = strlen(__s);
  FUN_00019d60(local_d8,__s + (sVar1 - (int)local_d8),0);
  return;
}




void FUN_0001a1d0(char *param_1,void *param_2,undefined1 *param_3)

{
  char cVar1;
  char *pcVar2;
  char *__dest;
  undefined1 *__n;
  char local_1a8 [399];
  undefined1 uStack_19;
  
  cVar1 = *param_1;
  pcVar2 = local_1a8;
  while (cVar1 != '\0') {
    *pcVar2 = cVar1;
    param_1 = param_1 + 1;
    pcVar2 = pcVar2 + 1;
    cVar1 = *param_1;
  }
  if (param_3 != (undefined1 *)0x0) {
    __dest = pcVar2 + 2;
    *pcVar2 = '=';
    pcVar2[1] = '\"';
    __n = &uStack_19 + -(int)__dest;
    if (param_3 <= &uStack_19 + -(int)__dest) {
      __n = param_3;
    }
    pcVar2 = __dest + (int)(__n + 1);
    memcpy(__dest,param_2,(size_t)__n);
    __dest[(int)__n] = '\"';
  }
  FUN_00019d60(local_1a8,(int)pcVar2 - (int)local_1a8,0);
  return;
}




void FUN_0001a270(char *param_1)

{
  size_t sVar1;
  char *pcVar2;
  char cVar3;
  char *__s;
  char local_e0 [200];
  undefined1 auStack_18 [4];
  
  cVar3 = *param_1;
  if (cVar3 == '\0') {
    pcVar2 = local_e0;
  }
  else {
    pcVar2 = local_e0;
    do {
      pcVar2 = pcVar2 + 1;
      pcVar2[-1] = cVar3;
      param_1 = param_1 + 1;
      cVar3 = *param_1;
    } while (cVar3 != '\0');
  }
  __s = pcVar2 + 1;
  *pcVar2 = '=';
  if (199 < (uint)((int)__s - (int)local_e0)) {
    (*DAT_0007c9fc)("ntp_control.c",0x43a,2,"(cp - buffer) < sizeof(buffer)");
  }
  snprintf(__s,(size_t)(auStack_18 + -(int)__s),"%.3f");
  sVar1 = strlen(__s);
  FUN_00019d60(local_e0,__s + (sVar1 - (int)local_e0),0);
  return;
}




void FUN_0001a33c(char *param_1,int param_2)

{
  tm *ptVar1;
  size_t sVar2;
  char cVar3;
  char *__s;
  char *pcVar4;
  int local_dc;
  char local_d8 [200];
  
  cVar3 = *param_1;
  if (cVar3 == '\0') {
    pcVar4 = local_d8;
  }
  else {
    pcVar4 = local_d8;
    do {
      pcVar4 = pcVar4 + 1;
      pcVar4[-1] = cVar3;
      param_1 = param_1 + 1;
      cVar3 = *param_1;
    } while (cVar3 != '\0');
  }
  local_dc = param_2 + 0x7c558180;
  __s = pcVar4 + 1;
  *pcVar4 = '=';
  ptVar1 = gmtime(&local_dc);
  if (ptVar1 != (tm *)0x0) {
    if (199 < (uint)((int)__s - (int)local_d8)) {
      (*DAT_0007c9fc)("ntp_control.c",0x472,2,"(cp - buffer) < sizeof(buffer)");
    }
    snprintf(__s,(size_t)(&stack0xfffffff0 + -(int)__s),"%04d%02d%02d%02d%02d",ptVar1->tm_year + 0x76c,
             ptVar1->tm_mon + 1,ptVar1->tm_mday,ptVar1->tm_hour,ptVar1->tm_min);
    sVar2 = strlen(__s);
    FUN_00019d60(local_d8,__s + (sVar2 - (int)local_d8),0);
  }
  return;
}




void FUN_0001a444(char *param_1,undefined4 param_2)

{
  char cVar1;
  char *pcVar2;
  size_t sVar3;
  char *__s;
  char local_d8 [200];
  
  cVar1 = *param_1;
  pcVar2 = local_d8;
  while (cVar1 != '\0') {
    *pcVar2 = cVar1;
    param_1 = param_1 + 1;
    pcVar2 = pcVar2 + 1;
    cVar1 = *param_1;
  }
  __s = pcVar2 + 1;
  *pcVar2 = '=';
  if (199 < (uint)((int)__s - (int)local_d8)) {
    (*DAT_0007c9fc)("ntp_control.c",0x453,2,"(cp - buffer) < sizeof(buffer)");
  }
  snprintf(__s,(size_t)(&stack0xfffffff0 + -(int)__s),"%lu",param_2);
  sVar3 = strlen(__s);
  FUN_00019d60(local_d8,__s + (sVar3 - (int)local_d8),0);
  return;
}




void FUN_0001a508(undefined4 param_1)

{
  ushort uVar1;
  undefined *puVar2;
  size_t sVar3;
  uint uVar4;
  int iVar5;
  char *pcVar6;
  char *pcVar7;
  int iVar8;
  char *pcVar9;
  char *pcVar10;
  char acStack_1ec [4];
  char acStack_1e8 [464];
  
  pcVar9 = DAT_00079eec;
  pcVar7 = DAT_00079e4c;
  switch(param_1) {
  case 1:
    FUN_0001a444(DAT_00079e5c,DAT_000cb4b0);
    break;
  case 2:
    FUN_0001a444(DAT_00079e64,DAT_000cb4fc);
    break;
  case 3:
    FUN_00019e64(DAT_00079e6c,(int)DAT_000cb478);
    break;
  case 4:
    FUN_0001a270(SUB84(DAT_000cb4b8 * 1000.0,0),DAT_00079e74);
    break;
  case 5:
    FUN_0001a270(SUB84(DAT_000cb498 * 1000.0,0),DAT_00079e7c);
    break;
  case 6:
    if (DAT_000cb4fc - 2 < 0xe) {
      FUN_00019f28(DAT_00079e84,DAT_000cb4e0,0);
    }
    else {
      FUN_0001a010(DAT_00079e84,DAT_000cb4e0);
    }
    break;
  case 7:
    FUN_0001a104(DAT_00079e8c,&DAT_000cb500);
    break;
  case 8:
    FUN_0001a444(DAT_00079e94,DAT_000cabc8);
    break;
  case 9:
    uVar4 = DAT_000cb470;
    if (DAT_000cb470 != 0) {
      uVar4 = (uint)*(ushort *)(DAT_000cb470 + 0x2c);
    }
    FUN_0001a444(DAT_00079e9c,uVar4);
    break;
  case 10:
    FUN_0001a270(SUB84(DAT_000cabd0 * 1000.0,0),DAT_00079ea4);
    break;
  case 0xb:
    FUN_0001a270(SUB84(DAT_000caba8 * 1000000.0,0),DAT_00079eac);
    break;
  case 0xc:
    FUN_0001a270(SUB84(DAT_000cb4e8 * 1000.0,0),DAT_00079eb4);
    break;
  case 0xd:
    FUN_0001a270(SUB84(DAT_000cabb0 * 1000.0,0),DAT_00079ebc);
    break;
  case 0xe:
    FUN_0004cba8(acStack_1ec);
    FUN_0001a104(DAT_00079ec4,acStack_1ec);
    break;
  case 0xf:
    sVar3 = strlen(&DAT_0007d29c);
    FUN_0001a1d0(DAT_00079ecc,&DAT_0007d29c,sVar3);
    break;
  case 0x10:
    snprintf(acStack_1ec,0x100,"%s/%s",&DAT_0007d198,&DAT_0007d21a);
    sVar3 = strlen(acStack_1ec);
    FUN_0001a1d0(DAT_00079ed4,acStack_1ec,sVar3);
    break;
  case 0x11:
    sVar3 = strlen(DAT_00079e4c);
    FUN_0001a1d0(DAT_00079edc,pcVar7,sVar3);
    break;
  case 0x12:
    FUN_0001a270(SUB84(DAT_000caba0 * 1000000.0,0),DAT_00079ee4);
    break;
  case 0x13:
    sVar3 = strlen(DAT_00079eec);
    if (acStack_1ec + sVar3 + 4 <= &stack0xffffffe8) {
      snprintf(acStack_1ec,0x1d4,"%s=\"",pcVar9);
      sVar3 = strlen(acStack_1ec);
      pcVar9 = acStack_1ec + sVar3;
      puVar2 = &DAT_00079e50;
      pcVar7 = pcVar9;
      uVar1 = DAT_00079e52;
      while ((uVar1 & 0x80) == 0) {
        if ((uVar1 & 0x40) == 0) {
          pcVar10 = *(char **)(puVar2 + 4);
          sVar3 = strlen(pcVar10);
          if (&stack0xffffffe8 <= pcVar7 + sVar3 + 1) break;
          pcVar6 = pcVar7;
          if (pcVar7 != pcVar9) {
            pcVar6 = pcVar7 + 1;
            *pcVar7 = ',';
          }
          pcVar7 = pcVar6 + sVar3;
          memcpy(pcVar6,pcVar10,sVar3);
        }
        uVar1 = *(ushort *)(puVar2 + 10);
        puVar2 = puVar2 + 8;
      }
      if ((DAT_0007d320 != 0) && (uVar1 = *(ushort *)(DAT_0007d320 + 2), iVar8 = DAT_0007d320, (uVar1 & 0x80) == 0)) {
        do {
          if (((uVar1 & 0x40) == 0) && (pcVar10 = *(char **)(iVar8 + 4), pcVar10 != (char *)0x0)) {
            pcVar6 = pcVar10;
            if (*pcVar10 == '\0' || *pcVar10 == '=') {
              sVar3 = 0;
              iVar5 = 1;
            }
            else {
              do {
                pcVar6 = pcVar6 + 1;
              } while (*pcVar6 != '=' && *pcVar6 != '\0');
              sVar3 = (int)pcVar6 - (int)pcVar10;
              iVar5 = sVar3 + 1;
            }
            if (&stack0xffffffe8 <= pcVar7 + iVar5) break;
            pcVar6 = pcVar7;
            if (pcVar7 != pcVar9) {
              pcVar6 = pcVar7 + 1;
              *pcVar7 = ',';
              pcVar10 = *(char **)(iVar8 + 4);
            }
            pcVar7 = pcVar6 + sVar3;
            memcpy(pcVar6,pcVar10,sVar3);
          }
          if ((iVar8 + 8 == 0) || (uVar1 = *(ushort *)(iVar8 + 10), iVar8 = iVar8 + 8, (uVar1 & 0x80) != 0)) break;
        } while( true );
      }
      if (pcVar7 + 2 < &stack0xffffffe8) {
        *pcVar7 = '\"';
        pcVar7[1] = '\0';
        FUN_00019d60(acStack_1ec,(int)(pcVar7 + 1) - (int)acStack_1ec,0);
      }
    }
    break;
  case 0x14:
    if (DAT_000cabcc != 0) {
      FUN_0001a444(DAT_00079ef4);
    }
    break;
  case 0x15:
    if (DAT_000cb4d8 != 0) {
      FUN_0001a33c(DAT_00079efc);
    }
    break;
  case 0x16:
    if (DAT_000cb4f0 != 0) {
      FUN_0001a33c(DAT_00079f04);
    }
    break;
  case 0x17:
    FUN_0001a444(DAT_00079f0c,DAT_0007a1c8);
  }
  return;
}




void FUN_0001aa84(char *param_1,int param_2,int param_3)

{
  size_t sVar1;
  char cVar2;
  uint uVar3;
  uint extraout_r3;
  char *__s;
  int iVar4;
  int iVar5;
  bool bVar6;
  char local_f0 [200];
  
  cVar2 = *param_1;
  if (cVar2 == '\0') {
    __s = local_f0;
  }
  else {
    __s = local_f0;
    do {
      __s = __s + 1;
      __s[-1] = cVar2;
      param_1 = param_1 + 1;
      cVar2 = *param_1;
    } while (cVar2 != '\0');
  }
  iVar4 = param_3;
  do {
    bVar6 = iVar4 == 0;
    iVar4 = iVar4 + -1;
    uVar3 = (int)__s - (int)local_f0;
    iVar5 = 0x38;
    if (bVar6) {
      iVar4 = 7;
    }
    else {
      iVar5 = iVar4 * 8;
    }
    if (199 < uVar3) {
      (*DAT_0007c9fc)("ntp_control.c",0x529,2,"(cp - buffer) < sizeof(buffer)");
      uVar3 = extraout_r3;
    }
    snprintf(__s,(size_t)(&stack0xffffffd8 + -(int)__s)," %.2f",uVar3,*(double *)(param_2 + iVar5) * 1000.0);
    sVar1 = strlen(__s);
    __s = __s + sVar1;
  } while (param_3 != iVar4);
  FUN_00019d60(local_f0,(int)__s - (int)local_f0,0);
  return;
}




void FUN_0001ab88(char *param_1,undefined4 param_2)

{
  char cVar1;
  char *pcVar2;
  size_t sVar3;
  char *__s;
  char local_d8 [200];
  
  cVar1 = *param_1;
  pcVar2 = local_d8;
  while (cVar1 != '\0') {
    *pcVar2 = cVar1;
    param_1 = param_1 + 1;
    pcVar2 = pcVar2 + 1;
    cVar1 = *param_1;
  }
  __s = pcVar2 + 1;
  *pcVar2 = '=';
  if (199 < (uint)((int)__s - (int)local_d8)) {
    (*DAT_0007c9fc)("ntp_control.c",0x48f,2,"(cp - buffer) < sizeof(buffer)");
  }
  snprintf(__s,(size_t)(&stack0xfffffff0 + -(int)__s),"0x%lx",param_2);
  sVar3 = strlen(__s);
  FUN_00019d60(local_d8,__s + (sVar3 - (int)local_d8),0);
  return;
}




void FUN_0001ac4c(undefined4 param_1,int param_2)

{
  ushort uVar1;
  undefined4 uVar2;
  size_t sVar3;
  uint uVar4;
  int iVar5;
  char *__dest;
  char *pcVar6;
  char *__s;
  char *pcVar7;
  char acStack_1ec [4];
  char acStack_1e8 [464];
  
  pcVar6 = DAT_0007a044;
  switch(param_1) {
  case 1:
    FUN_0001a444(DAT_00079f24,((*(uint *)(param_2 + 0x34) ^ 2) << 0x1e) >> 0x1f);
    break;
  case 2:
    iVar5 = *(int *)(param_2 + 100);
    if (iVar5 != 0) {
      iVar5 = 1;
    }
    FUN_0001a444(DAT_00079f2c,iVar5);
    break;
  case 3:
    FUN_0001a444(DAT_00079f34,(uint)(*(int *)(param_2 + 0x34) << 0x1d) >> 0x1f);
    break;
  case 4:
    FUN_00019f28(DAT_00079f3c,0,param_2 + 0xc);
    break;
  case 5:
    FUN_0001a444(DAT_00079f44,*(ushort *)(param_2 + 0xe) << 8 | *(ushort *)(param_2 + 0xe) >> 8);
    break;
  case 6:
    if (*(int *)(param_2 + 0x28) == 0) {
      iVar5 = 0;
    }
    else {
      iVar5 = *(int *)(param_2 + 0x28) + 0x14;
    }
    FUN_00019f28(DAT_00079f4c,0,iVar5);
    break;
  case 7:
    uVar4 = *(uint *)(param_2 + 0x28);
    uVar2 = DAT_00079f54;
    if (uVar4 != 0) {
      uVar4 = (*(ushort *)(uVar4 + 0x16) & 0xff) << 8 | (uint)(*(ushort *)(uVar4 + 0x16) >> 8);
    }
    goto LAB_0001ad74;
  case 8:
    FUN_0001a444(DAT_00079f5c,*(undefined1 *)(param_2 + 0x43));
    break;
  case 9:
    FUN_0001a444(DAT_00079f64,*(undefined1 *)(param_2 + 0x2f));
    break;
  case 10:
    FUN_0001a444(DAT_00079f6c,*(undefined1 *)(param_2 + 0x45));
    break;
  case 0xb:
    FUN_0001a444(DAT_00079f74,*(undefined1 *)(param_2 + 0x46));
    break;
  case 0xc:
    FUN_0001a444(DAT_00079f7c,*(undefined1 *)(param_2 + 0x30));
    break;
  case 0xd:
    FUN_00019e64(DAT_00079f84,(int)*(char *)(param_2 + 0x47));
    break;
  case 0xe:
    FUN_0001a270(SUB84(*(double *)(param_2 + 0x48) * 1000.0,0),DAT_00079f8c);
    break;
  case 0xf:
    FUN_0001a270(SUB84(*(double *)(param_2 + 0x50) * 1000.0,0),DAT_00079f94);
    break;
  case 0x10:
    if (((*(uint *)(param_2 + 0x34) & 8) == 0) && (*(byte *)(param_2 + 0x45) - 2 < 0xe)) {
      FUN_00019f28(DAT_00079f9c,*(undefined4 *)(param_2 + 0x58));
    }
    else {
      FUN_0001a010(DAT_00079f9c,*(undefined4 *)(param_2 + 0x58));
    }
    break;
  case 0x11:
    FUN_0001a104(DAT_00079fa4,param_2 + 0x5c);
    break;
  case 0x12:
    FUN_0001a104(DAT_00079fac,param_2 + 0x188);
    break;
  case 0x13:
    FUN_0001a104(DAT_00079fb4,param_2 + 0x180);
    break;
  case 0x14:
    if (*(double *)(param_2 + 0x1b8) != 0.0) {
      FUN_0001a270(SUB84(*(double *)(param_2 + 0x1b8) * 1000.0,0),DAT_00079fbc);
    }
    break;
  case 0x15:
    FUN_0001ab88(DAT_00079fc4,*(undefined1 *)(param_2 + 0x6a));
    break;
  case 0x16:
    FUN_0001a444(DAT_00079fcc,*(undefined4 *)(param_2 + 0x1fc));
    break;
  case 0x17:
    FUN_0001a444(DAT_00079fd4,*(int *)(param_2 + 0x208) - DAT_000cb548);
    break;
  case 0x18:
    FUN_0001a270(SUB84(*(double *)(param_2 + 0x1a0) * 1000.0,0),DAT_00079fdc);
    break;
  case 0x19:
    FUN_0001a270(SUB84(*(double *)(param_2 + 0x198) * 1000.0,0),DAT_00079fe4);
    break;
  case 0x1a:
    FUN_0001a270(SUB84(*(double *)(param_2 + 0x1a8) * 1000.0,0),DAT_00079fec);
    break;
  case 0x1b:
    FUN_0001a270(SUB84(*(double *)(param_2 + 0x1b0) * 1000.0,0),DAT_00079ff4);
    break;
  case 0x1c:
    uVar4 = *(uint *)(param_2 + 100);
    uVar2 = DAT_00079ffc;
    if (0xffff < uVar4) {
      FUN_0001ab88(DAT_00079ffc);
      return;
    }
    goto LAB_0001ad74;
  case 0x1d:
    FUN_0001aa84(DAT_0007a004,param_2 + 0x88,*(undefined4 *)(param_2 + 0x80));
    break;
  case 0x1e:
    FUN_0001aa84(DAT_0007a00c,param_2 + 200,*(undefined4 *)(param_2 + 0x80));
    break;
  case 0x1f:
    FUN_0001a444(DAT_0007a014,*(undefined1 *)(param_2 + 0x44));
    break;
  case 0x20:
    FUN_0001a444(DAT_0007a01c,*(undefined4 *)(param_2 + 0x224));
    break;
  case 0x21:
    uVar4 = *(uint *)(param_2 + 0x220);
    uVar2 = DAT_0007a024;
    goto LAB_0001ad74;
  case 0x22:
    FUN_0001aa84(DAT_0007a02c,param_2 + 0x108,*(undefined4 *)(param_2 + 0x80));
    break;
  case 0x23:
    FUN_0001ab88(DAT_0007a034,*(undefined4 *)(param_2 + 0x6c));
    break;
  case 0x24:
    if (*(byte *)(param_2 + 0x3b) != 0) {
      FUN_00019e64(DAT_0007a03c,(&DAT_000cb460)[*(byte *)(param_2 + 0x3b)]);
    }
    break;
  case 0x25:
    sVar3 = strlen(DAT_0007a044);
    if (acStack_1ec + sVar3 + 4 <= &stack0xffffffe8) {
      snprintf(acStack_1ec,0x1d4,"%s=\"",pcVar6);
      sVar3 = strlen(acStack_1ec);
      pcVar7 = acStack_1ec + sVar3;
      pcVar6 = pcVar7;
      if ((DAT_00079f1a & 0x80) == 0) {
        iVar5 = 0x79f20;
        uVar1 = DAT_00079f1a;
        do {
          if ((uVar1 & 0x40) == 0) {
            __s = *(char **)(iVar5 + -4);
            sVar3 = strlen(__s);
            if (&stack0xffffffe8 <= pcVar6 + sVar3 + 1) break;
            __dest = pcVar6;
            if (pcVar6 != pcVar7) {
              __dest = pcVar6 + 1;
              *pcVar6 = ',';
            }
            pcVar6 = __dest + sVar3;
            memcpy(__dest,__s,sVar3);
          }
          uVar1 = *(ushort *)(iVar5 + 2);
          iVar5 = iVar5 + 8;
        } while ((uVar1 & 0x80) == 0);
      }
      if (pcVar6 + 2 < &stack0xffffffe8) {
        *pcVar6 = '\"';
        pcVar6[1] = '\0';
        FUN_00019d60(acStack_1ec,(int)(pcVar6 + 1) - (int)acStack_1ec,0);
      }
    }
    break;
  case 0x26:
    if (0.0 < *(double *)(param_2 + 0x1d8)) {
      FUN_0001a270(SUB84(*(double *)(param_2 + 0x1d8) / 1000.0,0),DAT_0007a04c);
    }
    break;
  case 0x27:
    if (0.0 < *(double *)(param_2 + 0x1f0)) {
      FUN_0001a270(SUB84(*(double *)(param_2 + 0x1f0) / 1000.0,0),DAT_0007a054);
    }
    break;
  case 0x28:
    uVar4 = *(uint *)(param_2 + 0x200);
    uVar2 = DAT_0007a05c;
LAB_0001ad74:
    FUN_0001a444(uVar2,uVar4);
    break;
  case 0x29:
    if (*(double *)(param_2 + 0x1c0) != 0.0) {
      FUN_0001a270(SUB84(*(double *)(param_2 + 0x1c0) * 1000.0,0),DAT_0007a064);
    }
  }
  return;
}




void FUN_0001b264(undefined4 param_1,undefined1 *param_2,int param_3)

{
  ushort uVar1;
  byte bVar2;
  size_t sVar3;
  char *pcVar4;
  int iVar5;
  byte *pbVar6;
  byte *pbVar7;
  int iVar8;
  byte *pbVar9;
  char *pcVar10;
  byte abStack_1f4 [4];
  byte abStack_1f0 [464];
  byte abStack_20 [4];
  
  pcVar10 = DAT_0007a0dc;
  switch(param_1) {
  case 1:
    if (((param_3 != 0) || (*(char **)(param_2 + 0x20) == (char *)0x0)) || (**(char **)(param_2 + 0x20) == '\0')) {
      FUN_0001a444(DAT_0007a07c,*param_2);
    }
    break;
  case 2:
    FUN_0001a1d0(DAT_0007a084,*(undefined4 *)(param_2 + 8),*(undefined2 *)(param_2 + 4));
    break;
  case 3:
    FUN_0001a444(DAT_0007a08c,*(undefined4 *)(param_2 + 0xc));
    break;
  case 4:
    FUN_0001a444(DAT_0007a094,*(undefined4 *)(param_2 + 0x10));
    break;
  case 5:
    FUN_0001a444(DAT_0007a09c,*(undefined4 *)(param_2 + 0x14));
    break;
  case 6:
    FUN_0001a444(DAT_0007a0a4,*(undefined4 *)(param_2 + 0x18));
    break;
  case 7:
    if ((param_3 != 0) || ((param_2[2] & 1) != 0)) {
      FUN_0001a270(SUB84(*(double *)(param_2 + 0x28) * 1000.0,0),DAT_0007a0ac);
    }
    break;
  case 8:
    if ((param_3 != 0) || ((param_2[2] & 2) != 0)) {
      FUN_0001a270(SUB84(*(double *)(param_2 + 0x30) * 1000.0,0),DAT_0007a0b4);
    }
    break;
  case 9:
    if ((param_3 != 0) || ((param_2[2] & 4) != 0)) {
      FUN_00019e64(DAT_0007a0bc,*(undefined4 *)(param_2 + 0x38));
    }
    break;
  case 10:
    if ((param_3 != 0) || ((param_2[2] & 8) != 0)) {
      if (*(int *)(param_2 + 0x38) < 2) {
        FUN_0001a010(DAT_0007a0c4,*(undefined4 *)(param_2 + 0x3c));
      }
      else {
        FUN_00019f28(DAT_0007a0c4,*(undefined4 *)(param_2 + 0x3c),0);
      }
    }
    break;
  case 0xb:
    if ((param_3 != 0) || ((param_2[2] & 0xf0) != 0)) {
      FUN_0001a444(DAT_0007a0cc,param_2[1]);
    }
    break;
  case 0xc:
    pcVar10 = *(char **)(param_2 + 0x20);
    if ((pcVar10 == (char *)0x0) || (*pcVar10 == '\0')) {
      if (param_3 != 0) {
        FUN_0001a1d0(DAT_0007a0d4,&DAT_000665cc,0);
      }
    }
    else {
      sVar3 = strlen(pcVar10);
      FUN_0001a1d0(DAT_0007a0d4,pcVar10,sVar3);
    }
    break;
  case 0xd:
    sVar3 = strlen(DAT_0007a0dc);
    if (abStack_1f4 + sVar3 + 4 <= abStack_20) {
      snprintf((char *)abStack_1f4,0x1d4,"%s=\"",pcVar10);
      sVar3 = strlen((char *)abStack_1f4);
      pbVar9 = abStack_1f4 + sVar3;
      pbVar7 = pbVar9;
      if ((DAT_0007a072 & 0x80) == 0) {
        iVar8 = 0x7a078;
        uVar1 = DAT_0007a072;
        do {
          if ((uVar1 & 0x40) == 0) {
            pcVar10 = *(char **)(iVar8 + -4);
            sVar3 = strlen(pcVar10);
            if (abStack_20 <= pbVar7 + sVar3 + 1) break;
            pbVar6 = pbVar7;
            if (pbVar7 != pbVar9) {
              pbVar6 = pbVar7 + 1;
              *pbVar7 = 0x2c;
            }
            pbVar7 = pbVar6 + sVar3;
            memcpy(pbVar6,pcVar10,sVar3);
          }
          uVar1 = *(ushort *)(iVar8 + 2);
          iVar8 = iVar8 + 8;
        } while ((uVar1 & 0x80) == 0);
      }
      iVar8 = *(int *)(param_2 + 0x44);
      if (iVar8 != 0) {
        uVar1 = *(ushort *)(iVar8 + 2);
        bVar2 = (byte)uVar1;
        if ((uVar1 & 0x80) == 0) {
          do {
            if (((uVar1 & 0x40) == 0) && (pcVar10 = *(char **)(iVar8 + 4), pcVar10 != (char *)0x0)) {
              pcVar4 = pcVar10;
              if (*pcVar10 == '\0' || *pcVar10 == '=') {
                sVar3 = 0;
                iVar5 = 1;
              }
              else {
                do {
                  pcVar4 = pcVar4 + 1;
                } while (*pcVar4 != '=' && *pcVar4 != '\0');
                sVar3 = (int)pcVar4 - (int)pcVar10;
                iVar5 = sVar3 + 1;
              }
              if (abStack_20 <= pbVar7 + iVar5) break;
              pbVar6 = pbVar7;
              if (pbVar7 != pbVar9) {
                pbVar6 = pbVar7 + 1;
                *pbVar7 = 0x2c;
                pcVar10 = *(char **)(iVar8 + 4);
              }
              memcpy(pbVar6,pcVar10,sVar3);
              pbVar7 = pbVar6 + sVar3;
              *pbVar7 = bVar2 & 0x80;
            }
            if ((iVar8 + 8 == 0) || (uVar1 = *(ushort *)(iVar8 + 10), iVar8 = iVar8 + 8, (uVar1 & 0x80) != 0)) break;
          } while( true );
        }
      }
      if (pbVar7 + 2 < abStack_20) {
        *pbVar7 = 0x22;
        pbVar7[1] = 0;
        FUN_00019d60(abStack_1f4,(int)(pbVar7 + 1) - (int)abStack_1f4,0);
      }
    }
  }
  return;
}




void FUN_0001b684(undefined4 param_1)

{
  int iVar1;
  
  if (2 < DAT_0007cf4c) {
    printf("sending control error %d\n",param_1);
  }
  DAT_0007cf78 = (ushort)param_1 & 0xff;
  DAT_0007cf7e = 0;
  DAT_0007cf75 = ~((byte)~(byte)(((DAT_0007d178 & 0x1f) << 0x1a) >> 0x18) >> 2);
  if ((DAT_0007d181 == '\0') || (DAT_000cb46c == 0)) {
    FUN_000154a4(DAT_0007d188,DAT_0007d18c,0xfffffffd,&DAT_0007cf74,0xc);
  }
  else {
    iVar1 = FUN_0004e458(DAT_0007d184,&DAT_0007cf74,0xc);
    FUN_000154a4(DAT_0007d188,DAT_0007d18c,0xfffffffe,&DAT_0007cf74,iVar1 + 0xc);
  }
  DAT_000caaa8 = DAT_000caaa8 + 1;
  return;
}




undefined * FUN_0001b77c(undefined *param_1,undefined4 *param_2)

{
  byte bVar1;
  ushort uVar2;
  byte *pbVar3;
  ushort **ppuVar4;
  ushort *puVar5;
  uint uVar6;
  byte *pbVar7;
  byte *pbVar8;
  uint uVar9;
  byte *pbVar10;
  
  pbVar3 = DAT_0007d3a8;
  pbVar8 = DAT_0007d3a4;
  pbVar10 = DAT_0007d3a4;
  if (DAT_0007d3a4 < DAT_0007d3a8) {
    do {
      pbVar10 = pbVar8 + 1;
      uVar9 = (uint)*pbVar8;
      if (uVar9 != 0x2c) {
        ppuVar4 = __ctype_b_loc();
        puVar5 = *ppuVar4;
        if ((puVar5[uVar9] & 0x2000) == 0) {
          if (pbVar3 <= pbVar8) {
            DAT_0007d3a4 = pbVar8;
            return (undefined *)(puVar5[uVar9] & 0x2000);
          }
          if (param_1 == (undefined *)0x0) {
            DAT_0007d3a4 = pbVar8;
            return &DAT_0007a0e8;
          }
          uVar2 = *(ushort *)(param_1 + 2);
          goto joined_r0x0001b810;
        }
      }
      pbVar8 = pbVar10;
    } while (pbVar10 != pbVar3);
  }
  DAT_0007d3a4 = pbVar10;
  return (undefined *)0x0;
joined_r0x0001b810:
  if ((uVar2 & 0x80) != 0) {
    DAT_0007d3a4 = pbVar8;
    return param_1;
  }
  if (((uVar2 & 0x40) == 0) && (pbVar10 = *(byte **)(param_1 + 4), *pbVar10 == uVar9)) {
    uVar6 = uVar9;
    DAT_0007d3a4 = pbVar8;
    if (uVar9 != 0 && uVar9 != 0x3d) {
      do {
        DAT_0007d3a4 = DAT_0007d3a4 + 1;
        pbVar10 = pbVar10 + 1;
        uVar6 = (uint)*pbVar10;
        if ((uVar6 == 0x3d || uVar6 == 0) || (DAT_0007d3a4 == pbVar3)) break;
      } while (*DAT_0007d3a4 == uVar6);
    }
    if (uVar6 == 0 || uVar6 == 0x3d) {
      if (DAT_0007d3a4 < pbVar3) {
        do {
          pbVar10 = DAT_0007d3a4 + 1;
          if ((puVar5[*DAT_0007d3a4] & 0x2000) == 0) break;
          DAT_0007d3a4 = pbVar10;
        } while (pbVar10 != pbVar3);
      }
      if (DAT_0007d3a4 == pbVar3) {
        DAT_0007d324 = 0;
        *param_2 = &DAT_0007d324;
        return param_1;
      }
      if (*DAT_0007d3a4 == 0x2c) {
        if (DAT_0007d3a4 < pbVar3) {
          DAT_0007d3a4 = DAT_0007d3a4 + 1;
        }
        DAT_0007d324 = 0;
        *param_2 = &DAT_0007d324;
        return param_1;
      }
      if (*DAT_0007d3a4 == 0x3d) {
        pbVar10 = DAT_0007d3a4 + 1;
        if (pbVar3 <= pbVar10) goto LAB_0001b9c4;
        goto LAB_0001b8fc;
      }
    }
  }
  uVar2 = *(ushort *)(param_1 + 10);
  param_1 = param_1 + 8;
  goto joined_r0x0001b810;
LAB_0001b934:
  pbVar10 = pbVar10 + 1;
  if (pbVar10 == pbVar3) goto LAB_0001b9cc;
  if (*pbVar10 == 0x2c) goto LAB_0001ba18;
  pbVar8 = pbVar7 + 1;
  *pbVar7 = *pbVar10;
  pbVar7 = pbVar8;
  if ((byte *)0x7d3a3 < pbVar8) {
    FUN_0001b684(2);
    DAT_000caad0 = DAT_000caad0 + 1;
    return (undefined *)0x0;
  }
  goto LAB_0001b934;
LAB_0001ba18:
  pbVar10 = pbVar10 + 1;
  goto LAB_0001b9cc;
  while (pbVar10 = pbVar7, pbVar7 != pbVar3) {
LAB_0001b8fc:
    pbVar7 = pbVar10 + 1;
    bVar1 = *pbVar10;
    if ((puVar5[bVar1] & 0x2000) == 0) {
      if (pbVar10 < pbVar3) {
        if (bVar1 == 0x2c) {
          pbVar7 = &DAT_0007d324;
          goto LAB_0001ba18;
        }
        pbVar7 = &DAT_0007d325;
        DAT_0007d324 = bVar1;
        DAT_0007d3a4 = pbVar8;
        goto LAB_0001b934;
      }
      break;
    }
  }
LAB_0001b9c4:
  pbVar7 = &DAT_0007d324;
LAB_0001b9cc:
  *pbVar7 = 0;
  if ((byte *)((int)&DAT_0007d320 + 3) < pbVar7 + -1) {
    do {
      if (((*ppuVar4)[pbVar7[-1]] & 0x2000) == 0) break;
      pbVar7 = pbVar7 + -1;
      *pbVar7 = 0;
    } while (pbVar7 != &DAT_0007d324);
  }
  DAT_0007d3a4 = pbVar10;
  *param_2 = &DAT_0007d324;
  return param_1;
}




undefined4 * FUN_0001ba48(short *param_1,int param_2)

{
  int iVar1;
  undefined2 *puVar2;
  undefined4 *puVar3;
  bool bVar4;
  
  puVar2 = &DAT_000cab10;
  puVar3 = &DAT_000caadc;
  do {
    if ((((*(byte *)(puVar2 + -1) & 1) != 0) && (param_1[1] == puVar2[-0x19])) && (puVar2[-0x1a] == *param_1)) {
      if (puVar2[-0x1a] == 2) {
        bVar4 = *(int *)(param_1 + 2) == *(int *)(puVar2 + -0x18);
      }
      else {
        iVar1 = memcmp(param_1 + 4,puVar3 + 2,0x10);
        if (iVar1 != 0) goto LAB_0001ba80;
        bVar4 = *(int *)(param_1 + 0xc) == *(int *)(puVar2 + -0xe);
      }
      if ((bVar4) && (*(int *)(puVar2 + -0xc) == param_2)) {
        return puVar3;
      }
    }
LAB_0001ba80:
    puVar3 = puVar3 + 0xd;
    puVar2 = puVar2 + 0x1a;
    if (&DAT_000cab78 <= puVar3) {
      return (undefined4 *)0x0;
    }
  } while( true );
}




void FUN_0001bd68(int param_1,undefined4 param_2)

{
  byte bVar1;
  short sVar2;
  ushort *puVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  int iVar8;
  ushort *puVar9;
  uint uVar10;
  uint uVar7;
  
  if (2 < DAT_0007cf4c) {
    puts("in process_control()");
  }
  DAT_0007d188 = param_1 + 8;
  uVar10 = *(uint *)(param_1 + 0x58);
  DAT_0007d18c = *(undefined4 *)(param_1 + 0x40);
  DAT_000caaa0 = DAT_000caaa0 + 1;
  if (((uVar10 < 0xc) || (bVar1 = *(byte *)(param_1 + 0x5d), (bVar1 & 0xe0) != 0)) ||
     (sVar2 = *(short *)(param_1 + 100), sVar2 != 0)) {
    if (0 < DAT_0007cf4c) {
      puts("invalid format in control packet");
      uVar10 = *(uint *)(param_1 + 0x58);
    }
    if (uVar10 < 0xc) {
      DAT_000caad8 = DAT_000caad8 + 1;
    }
    bVar1 = *(byte *)(param_1 + 0x5d);
    if ((bVar1 & 0x80) != 0) {
      DAT_000caa9c = DAT_000caa9c + 1;
    }
    if ((bVar1 & 0x20) != 0) {
      DAT_000caabc = DAT_000caabc + 1;
    }
    if ((bVar1 & 0x40) != 0) {
      DAT_000caacc = DAT_000caacc + 1;
    }
    if (*(short *)(param_1 + 100) != 0) {
      DAT_000caac8 = DAT_000caac8 + 1;
    }
  }
  else {
    uVar6 = (uint)*(byte *)(param_1 + 0x5c) << 0x1a;
    uVar7 = uVar6 >> 0x1d;
    DAT_0007d3ae = (byte)(uVar6 >> 0x1d);
    if (uVar7 - 1 < 4) {
      DAT_0007cf7a = *(ushort *)(param_1 + 0x62);
      DAT_0007cf76 = *(undefined2 *)(param_1 + 0x5e);
      DAT_0007d17c = 0;
      DAT_0007cf74 = DAT_000cb4b0 << 6 | 6U | (byte)(uVar7 << 3);
      DAT_0007d180 = 0;
      DAT_0007d3ac = DAT_0007cf7a << 8 | DAT_0007cf7a >> 8;
      DAT_0007d181 = 0;
      uVar6 = (*(ushort *)(param_1 + 0x66) & 0xff) << 8 | (uint)(*(ushort *)(param_1 + 0x66) >> 8);
      DAT_0007d184 = 0;
      DAT_0007d3af = '\0';
      DAT_0007cf70 = 0;
      DAT_0007d190 = 0;
      DAT_0007cf6c = &DAT_0007cf80;
      DAT_0007d194 = &DAT_0007d154;
      DAT_0007cf78 = sVar2;
      DAT_0007d178 = bVar1;
      if (((uVar10 & 3) != 0) && (2 < DAT_0007cf4c)) {
        printf("Control packet length %d unrounded\n",uVar10);
        uVar10 = *(uint *)(param_1 + 0x58);
      }
      if (((int)(uVar10 - 0xc) < (int)uVar6) || ((uVar10 & 3) != 0)) {
        FUN_0001b684(2);
        DAT_000caac4 = DAT_000caac4 + 1;
      }
      else {
        uVar7 = uVar6 + 0x13 & 0xfffffff8;
        iVar8 = uVar10 - uVar7;
        if ((iVar8 - 4U < 0x15) && (DAT_000cb46c != 0)) {
          uVar4 = *(uint *)(param_1 + 0x5c + uVar7);
          DAT_0007d184 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
          DAT_0007d181 = 1;
          if (2 < DAT_0007cf4c) {
            printf("recv_len %d, properlen %d, wants auth with keyid %08x, MAC length=%d\n",uVar10,uVar7,DAT_0007d184,
                   iVar8);
          }
          iVar5 = FUN_0004e030(DAT_0007d184);
          if (iVar5 == 0) {
            if (2 < DAT_0007cf4c) {
              printf("invalid keyid %08x\n",DAT_0007d184);
            }
          }
          else {
            iVar8 = FUN_0004e4e4(DAT_0007d184,param_1 + 0x5c,*(int *)(param_1 + 0x58) - iVar8,iVar8);
            if (iVar8 == 0) {
              if (2 < DAT_0007cf4c) {
                puts("authentication failed");
              }
              DAT_0007d184 = 0;
            }
            else {
              if (2 < DAT_0007cf4c) {
                puts("authenticated okay");
              }
              DAT_0007d3af = '\x01';
            }
          }
        }
        DAT_0007d3a4 = param_1 + 0x68;
        DAT_0007d3a8 = param_1 + uVar6 + 0x68;
        if (DAT_0007a0f0 == 0xffff) {
LAB_0001c028:
          DAT_000caaa4 = DAT_000caaa4 + 1;
          FUN_0001b684(3);
          return;
        }
        if (DAT_0007a0f0 == DAT_0007d178) {
          puVar9 = &DAT_0007a0f0;
        }
        else {
          puVar3 = &DAT_0007a0f8;
          do {
            puVar9 = puVar3;
            if (*puVar9 == 0xffff) goto LAB_0001c028;
            puVar3 = puVar9 + 4;
          } while (*puVar9 != (ushort)DAT_0007d178);
        }
        if (2 < DAT_0007cf4c) {
          printf("opcode %d, found command handler\n");
        }
        if ((puVar9[1] == 1) && ((DAT_0007d3af == '\0' || (DAT_0007d184 != DAT_000caab0)))) {
          FUN_0001b684(1);
          return;
        }
        (**(code **)(puVar9 + 2))(param_1,param_2);
      }
    }
    else {
      if (0 < DAT_0007cf4c) {
        printf("unknown version %d in control packet\n");
      }
      DAT_000cab78 = DAT_000cab78 + 1;
    }
  }
  return;
}




uint FUN_0001c1bc(int param_1)

{
  uint uVar1;
  
  uVar1 = (uint)*(byte *)(param_1 + 0x68);
  if ((*(uint *)(param_1 + 0x34) & 2) == 0) {
    uVar1 = uVar1 | 0x80;
  }
  if (*(int *)(param_1 + 100) != 0) {
    uVar1 = uVar1 | 0x40;
  }
  if ((*(uint *)(param_1 + 0x34) & 4) != 0) {
    uVar1 = uVar1 | 0x20;
  }
  if (*(char *)(param_1 + 0x6a) != '\0') {
    uVar1 = uVar1 | 0x10;
  }
  if ((*(byte *)(param_1 + 0x38) & 0x16) != 0) {
    uVar1 = uVar1 | 8;
  }
  return *(byte *)(param_1 + 0x39) & 0xf | (*(byte *)(param_1 + 0x3a) & 0xf) << 4 | uVar1 << 8;
}




uint FUN_0001c21c(void)

{
  uint uVar1;
  
  uVar1 = DAT_000cb470;
  if (DAT_000cb470 != 0) {
    if (*(byte *)(DAT_000cb470 + 0x42) == 0) {
      if (*(byte *)(DAT_000cb470 + 0x40) < 0x2d) {
        uVar1 = ((byte)(&DAT_00063698)[*(byte *)(DAT_000cb470 + 0x40)] & 0x3f) << 8;
      }
      else {
        uVar1 = 0;
      }
    }
    else {
      uVar1 = (*(byte *)(DAT_000cb470 + 0x42) & 0x3f) << 8;
    }
  }
  return (DAT_0007d3b1 & 0xf | (DAT_0007d3b0 & 0xf) << 4 | (uint)DAT_000cb4b0 << 0xe | uVar1) & 0xffff;
}




void FUN_0001c2a8(void)

{
  ushort uVar1;
  uint uVar2;
  char cVar3;
  int iVar4;
  char *pcVar5;
  ushort *puVar6;
  uint uVar7;
  size_t sVar8;
  int iVar9;
  char *pcVar10;
  bool bVar11;
  undefined1 auStack_24 [8];
  
  if (DAT_0007d3ac == 0) {
    iVar4 = FUN_0001c21c();
    if (DAT_0007d3af != '\0') {
      DAT_0007d3b0 = 0;
    }
    DAT_0007cf78 = (ushort)(iVar4 << 8) | (ushort)((uint)iVar4 >> 8);
    if ((DAT_0007d320 == 0) || ((*(ushort *)(DAT_0007d320 + 2) & 0x80) != 0)) {
      sVar8 = 0x2a;
    }
    else {
      iVar4 = DAT_0007d320 + 0x10;
      uVar2 = *(ushort *)(DAT_0007d320 + 2) & 0x80;
      do {
        uVar7 = uVar2;
        puVar6 = (ushort *)(iVar4 + -6);
        iVar4 = iVar4 + 8;
        uVar2 = uVar7 + 1;
      } while ((*puVar6 & 0x80) == 0);
      sVar8 = uVar7 + 0x2b;
    }
    bVar11 = false;
    pcVar5 = (char *)FUN_0004f524(sVar8);
    memset(pcVar5,0,sVar8);
    while (puVar6 = (ushort *)FUN_0001b77c(&DAT_00079e50,auStack_24), puVar6 != (ushort *)0x0) {
      if ((puVar6[1] & 0x80) == 0) {
        pcVar5[*puVar6] = '\x01';
      }
      else {
        puVar6 = (ushort *)FUN_0001b77c(DAT_0007d320,auStack_24);
        if (puVar6 == (ushort *)0x0) break;
        uVar1 = puVar6[1];
        bVar11 = (uVar1 & 0x80) == 0;
        if (bVar11) {
          uVar1 = *puVar6;
        }
        if (!bVar11) {
          FUN_0001b684(5);
          free(pcVar5);
          return;
        }
        pcVar5[uVar1 + 0x18] = '\x01';
      }
      bVar11 = true;
    }
    if (bVar11) {
      iVar4 = 1;
      pcVar10 = pcVar5;
      do {
        while (pcVar10 = pcVar10 + 1, *pcVar10 != '\0') {
          iVar9 = iVar4 + 1;
          FUN_0001a508(iVar4);
          iVar4 = iVar9;
          if (iVar9 == 0x18) goto LAB_0001c4bc;
        }
        iVar4 = iVar4 + 1;
      } while (iVar4 != 0x18);
LAB_0001c4bc:
      if (DAT_0007d320 != 0) {
        uVar1 = *(ushort *)(DAT_0007d320 + 2);
        uVar2 = uVar1 & 0x80;
        iVar4 = DAT_0007d320;
        while ((uVar1 & 0x80) == 0) {
          if (pcVar5[uVar2 + 0x18] != '\0') {
            pcVar10 = *(char **)(iVar4 + 4);
            sVar8 = strlen(pcVar10);
            FUN_00019d60(pcVar10,sVar8,0);
          }
          iVar4 = DAT_0007d320 + (uVar2 + 1) * 8;
          if (DAT_0007d320 == 0) break;
          uVar2 = uVar2 + 1;
          uVar1 = *(ushort *)(iVar4 + 2);
        }
      }
    }
    else {
      if (DAT_0007a148 != '\0') {
        pcVar10 = &DAT_0007a148;
        do {
          FUN_0001a508();
          pcVar10 = pcVar10 + 1;
        } while (*pcVar10 != '\0');
      }
      if (DAT_0007d320 != 0) {
        uVar1 = *(ushort *)(DAT_0007d320 + 2);
        iVar4 = DAT_0007d320;
        while ((uVar1 & 0x80) == 0) {
          if ((uVar1 & 0x20) != 0) {
            pcVar10 = *(char **)(iVar4 + 4);
            sVar8 = strlen(pcVar10);
            FUN_00019d60(pcVar10,sVar8,0);
          }
          if (iVar4 + 8 == 0) break;
          uVar1 = *(ushort *)(iVar4 + 10);
          iVar4 = iVar4 + 8;
        }
      }
    }
    free(pcVar5);
  }
  else {
    iVar4 = FUN_00021604(DAT_0007d3ac);
    if (iVar4 == 0) {
      FUN_0001b684(4);
      return;
    }
    FUN_0001c1bc();
    bVar11 = false;
    if (DAT_0007d3af != '\0') {
      *(undefined1 *)(iVar4 + 0x3a) = 0;
    }
    pcVar5 = (char *)FUN_0004f524(0x2a);
    memset(pcVar5,0,0x2a);
    while (puVar6 = (ushort *)FUN_0001b77c(&DAT_00079f18,auStack_24), puVar6 != (ushort *)0x0) {
      bVar11 = true;
      if ((puVar6[1] & 0x80) != 0) {
        FUN_0001b684(5);
        free(pcVar5);
        return;
      }
      pcVar5[*puVar6] = '\x01';
    }
    if (bVar11) {
      iVar9 = 1;
      pcVar10 = pcVar5;
      do {
        pcVar10 = pcVar10 + 1;
        if (*pcVar10 != '\0') {
          FUN_0001ac4c(iVar9,iVar4);
        }
        iVar9 = iVar9 + 1;
      } while (iVar9 != 0x2a);
    }
    else if (DAT_0007a160 != '\0') {
      pcVar10 = &DAT_0007a160;
      cVar3 = DAT_0007a160;
      do {
        FUN_0001ac4c(cVar3,iVar4);
        pcVar10 = pcVar10 + 1;
        cVar3 = *pcVar10;
      } while (cVar3 != '\0');
    }
    free(pcVar5);
  }
  FUN_00019af8(0);
  return;
}




void FUN_0001c7c0(void)

{
  int iVar1;
  
  if (DAT_0007d3ac == 0) {
    iVar1 = FUN_0001c21c();
    DAT_0007cf78 = (ushort)(iVar1 << 8) | (ushort)((uint)iVar1 >> 8);
  }
  else {
    iVar1 = FUN_00021604();
    if (iVar1 == 0) {
      FUN_0001b684(4);
      return;
    }
    iVar1 = FUN_0001c1bc();
    DAT_0007cf78 = (ushort)(iVar1 << 8) | (ushort)((uint)iVar1 >> 8);
  }
  FUN_00019af8(0);
  return;
}




undefined4 FUN_0001c824(undefined4 *param_1,undefined4 param_2,int param_3,undefined1 param_4)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 *puVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 *puVar10;
  undefined4 *puVar11;
  bool bVar12;
  
  iVar4 = FUN_0001ba48();
  uVar2 = DAT_000cb548;
  if (iVar4 != 0) {
    if (param_3 == 1) {
      if ((*(byte *)(iVar4 + 0x32) & 4) != 0) {
        return 1;
      }
      *(undefined1 *)(iVar4 + 0x32) = 1;
    }
    else if (param_3 == 2) {
      if ((*(byte *)(iVar4 + 0x32) & 4) != 0) {
        return 1;
      }
      *(undefined1 *)(iVar4 + 0x32) = 3;
    }
    else if (param_3 == 0) {
      *(undefined1 *)(iVar4 + 0x32) = 5;
    }
    uVar2 = DAT_000cb548;
    *(int *)(iVar4 + 0x2c) = *(int *)(iVar4 + 0x2c) + 1;
    *(uint *)(iVar4 + 0x20) = uVar2;
    return 1;
  }
  puVar6 = &DAT_000caadc;
  puVar10 = (undefined4 *)0x0;
  do {
    bVar1 = *(byte *)((int)puVar6 + 0x32);
    puVar11 = puVar6;
    if (((bVar1 & 5) == 1) && (uVar2 < puVar6[8] + 0xe10)) {
      DAT_000caad4 = DAT_000caad4 + -1;
      *(undefined1 *)((int)puVar6 + 0x32) = 0;
    }
    else if (((bVar1 & 1) != 0) && (puVar11 = puVar10, (bVar1 & 4) == 0)) {
      if (param_3 == 0) {
        puVar11 = puVar6;
        if (puVar10 != (undefined4 *)0x0) {
          if ((*(byte *)((int)puVar10 + 0x32) & 2) != 0) {
            bVar1 = bVar1 & 2;
            goto joined_r0x0001c9f4;
          }
          if ((bVar1 & 2) == 0) goto LAB_0001c910;
        }
      }
      else if (((param_3 == 1) && ((bVar1 & 2) != 0)) && (puVar11 = puVar6, puVar10 != (undefined4 *)0x0)) {
        bVar1 = *(byte *)((int)puVar10 + 0x32) & 1;
joined_r0x0001c9f4:
        puVar11 = puVar10;
        if (bVar1 != 0) {
LAB_0001c910:
          puVar11 = puVar10;
          if ((uint)puVar10[10] < (uint)puVar6[10]) {
            puVar11 = puVar6;
          }
        }
      }
    }
    uVar3 = DAT_000cb548;
    puVar6 = puVar6 + 0xd;
    puVar10 = puVar11;
    if ((undefined4 *)0xcab77 < puVar6) {
      if (puVar11 != (undefined4 *)0x0) {
        bVar12 = param_3 == 0;
        puVar11[0xb] = 0;
        puVar11[10] = uVar3;
        puVar11[8] = uVar3;
        puVar11[9] = 0;
        *(undefined2 *)(puVar11 + 0xc) = 1;
        uVar5 = param_1[1];
        uVar7 = param_1[2];
        uVar9 = param_1[3];
        *puVar11 = *param_1;
        puVar11[1] = uVar5;
        puVar11[2] = uVar7;
        puVar11[3] = uVar9;
        if (bVar12) {
          uVar9 = 5;
        }
        uVar5 = param_1[4];
        uVar7 = param_1[5];
        uVar8 = param_1[6];
        puVar11[7] = param_2;
        *(undefined1 *)((int)puVar11 + 0x33) = param_4;
        if (bVar12) {
          *(char *)((int)puVar11 + 0x32) = (char)uVar9;
        }
        puVar11[4] = uVar5;
        puVar11[5] = uVar7;
        puVar11[6] = uVar8;
        if (!bVar12) {
          if (param_3 == 2) {
            *(undefined1 *)((int)puVar11 + 0x32) = 3;
          }
          else {
            *(undefined1 *)((int)puVar11 + 0x32) = 1;
          }
        }
        DAT_000caad4 = DAT_000caad4 + 1;
        return 1;
      }
      return 0;
    }
  } while( true );
}




undefined4 FUN_0001ca7c(undefined4 param_1,undefined4 param_2,int param_3)

{
  int iVar1;
  
  iVar1 = FUN_0001ba48();
  if ((iVar1 != 0) && (((*(byte *)(iVar1 + 0x32) & 4) == 0 || (param_3 == 0)))) {
    *(undefined1 *)(iVar1 + 0x32) = 0;
    DAT_000caad4 = DAT_000caad4 + -1;
    return 1;
  }
  return 0;
}




void FUN_0001cad0(int param_1,uint param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  if ((param_2 & 0x200) == 0) {
    uVar2 = 1;
  }
  else {
    uVar2 = 2;
  }
  iVar1 = FUN_0001ca7c(param_1 + 8,*(undefined4 *)(param_1 + 0x40),uVar2);
  if (iVar1 == 0) {
    FUN_0001b684(4);
  }
  FUN_00019af8(0);
  return;
}




void FUN_0001cb08(void)

{
  DAT_000caac0 = DAT_000cb548;
  DAT_000caac4 = 0;
  DAT_000caad0 = 0;
  DAT_000caaa0 = 0;
  DAT_000caab8 = 0;
  DAT_000caab4 = 0;
  DAT_000caaa8 = 0;
  DAT_000caad8 = 0;
  DAT_000caa9c = 0;
  DAT_000caabc = 0;
  DAT_000caacc = 0;
  DAT_000caac8 = 0;
  DAT_000cab78 = 0;
  DAT_000caaa4 = 0;
  DAT_000caaac = 0;
  return;
}




void FUN_0001cbe8(void)

{
  uname((utsname *)&DAT_0007d198);
  FUN_0001cb08();
  DAT_0007d3b1 = 0;
  DAT_0007d3b0 = 0;
  DAT_000caab0 = 0;
  DAT_000caad4 = 0;
  DAT_000cab0e = 0;
  DAT_000cab42 = 0;
  DAT_000cab76 = 0;
  return;
}




undefined4 FUN_0001cc3c(int *param_1,undefined4 param_2,undefined2 param_3)

{
  ushort *puVar1;
  void *__dest;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  size_t __n;
  void *__src;
  undefined2 uVar6;
  uint uVar7;
  uint uVar8;
  
  __src = (void *)*param_1;
  if (__src == (void *)0x0) {
    uVar6 = 0;
    iVar4 = FUN_0004f524(0x10);
    iVar3 = 8;
    *param_1 = iVar4;
    __n = 0;
  }
  else {
    if ((*(ushort *)((int)__src + 2) & 0x80) == 0) {
      iVar3 = (int)__src + 0x10;
      uVar8 = *(ushort *)((int)__src + 2) & 0x80;
      do {
        uVar7 = uVar8;
        puVar1 = (ushort *)(iVar3 + -6);
        uVar8 = uVar7 + 1;
        iVar3 = iVar3 + 8;
      } while ((*puVar1 & 0x80) == 0);
      __n = uVar8 * 8;
      uVar6 = (undefined2)uVar8;
      iVar4 = (uVar7 + 3) * 8;
      iVar3 = (uVar7 + 2) * 8;
    }
    else {
      uVar6 = 0;
      iVar3 = 8;
      __n = 0;
      iVar4 = 0x10;
    }
    __dest = (void *)FUN_0004f524(iVar4);
    *param_1 = (int)__dest;
    memmove(__dest,__src,__n);
    free(__src);
    iVar4 = *param_1;
  }
  *(undefined2 *)(iVar4 + __n) = uVar6;
  uVar2 = FUN_0004f524(param_2);
  *(undefined4 *)(iVar4 + __n + 4) = uVar2;
  iVar4 = *param_1;
  *(undefined2 *)(iVar4 + iVar3) = 0;
  *(undefined4 *)(iVar4 + iVar3 + 4) = 0;
  iVar5 = *param_1;
  *(undefined2 *)(iVar4 + __n + 2) = param_3;
  *(undefined2 *)(iVar5 + iVar3 + 2) = 0x80;
  return *(undefined4 *)(iVar5 + __n + 4);
}




void FUN_0001ce68(char *param_1,size_t param_2,undefined4 param_3)

{
  char cVar1;
  int iVar2;
  void *pvVar3;
  char *pcVar4;
  char *pcVar5;
  char *__ptr;
  
  if (param_1 == (char *)0x0 || param_2 == 0) {
    return;
  }
  if ((DAT_0007d320 != 0) && ((*(ushort *)(DAT_0007d320 + 2) & 0x80) == 0)) {
    __ptr = *(char **)(DAT_0007d320 + 4);
    iVar2 = DAT_0007d320;
    do {
      if (__ptr == (char *)0x0) {
        pvVar3 = (void *)FUN_0004f524(param_2);
        memmove(pvVar3,param_1,param_2);
        *(void **)(iVar2 + 4) = pvVar3;
        *(short *)(iVar2 + 2) = (short)param_3;
        return;
      }
      pcVar5 = param_1;
      if (*__ptr == '=') {
LAB_0001cdc8:
        if (*pcVar5 == '=') {
          free(__ptr);
          pvVar3 = (void *)FUN_0004f524(param_2);
          memmove(pvVar3,param_1,param_2);
          *(void **)(iVar2 + 4) = pvVar3;
          *(short *)(iVar2 + 2) = (short)param_3;
          return;
        }
      }
      else if (*param_1 == *__ptr) {
        pcVar4 = __ptr;
        pcVar5 = param_1 + 1;
        do {
          pcVar4 = pcVar4 + 1;
          if (*pcVar4 == '=') goto LAB_0001cdc8;
          cVar1 = *pcVar5;
          pcVar5 = pcVar5 + 1;
        } while (cVar1 == *pcVar4);
      }
      if ((*(ushort *)(iVar2 + 10) & 0x80) != 0) break;
      __ptr = *(char **)(iVar2 + 0xc);
      iVar2 = iVar2 + 8;
    } while( true );
  }
  pvVar3 = (void *)FUN_0001cc3c(&DAT_0007d320,param_2,param_3);
  memmove(pvVar3,param_1,param_2);
  return;
}




void FUN_0001d200(void)

{
  int iVar1;
  size_t sVar2;
  size_t sVar3;
  char *__s;
  char *pcVar4;
  char *pcVar5;
  char cVar7;
  char *local_20;
  uint local_1c [2];
  char *pcVar6;
  
  local_1c[0] = 0;
  if (DAT_0007d3ac == 0) {
    iVar1 = FUN_0001c21c();
    DAT_0007cf78 = (ushort)(iVar1 << 8) | (ushort)((uint)iVar1 >> 8);
    while (iVar1 = FUN_0001b77c(&DAT_00079e50,&local_20), iVar1 != 0) {
      if ((*(ushort *)(iVar1 + 2) & 0x80) == 0) {
        if ((*(ushort *)(iVar1 + 2) & 2) != 0) {
          if ((*local_20 != '\0') && (iVar1 = FUN_0004d104(local_20,local_1c), iVar1 != 0)) {
            if ((local_1c[0] & 0xfffffffc) == 0) {
              FUN_0001b684();
              return;
            }
            FUN_0001b684(6);
            return;
          }
          FUN_0001b684(2);
          return;
        }
        goto LAB_0001d348;
      }
      iVar1 = FUN_0001b77c(DAT_0007d320,&local_20);
      if (iVar1 == 0) break;
      if ((*(ushort *)(iVar1 + 2) & 0x80) != 0) {
        FUN_0001b684(5);
        return;
      }
      if ((*(ushort *)(iVar1 + 2) & 2) == 0) goto LAB_0001d348;
      sVar2 = strlen(*(char **)(iVar1 + 4));
      sVar3 = strlen(local_20);
      __s = (char *)FUN_0004f524(sVar2 + sVar3 + 2);
      pcVar4 = *(char **)(iVar1 + 4);
      cVar7 = *pcVar4;
      pcVar6 = __s;
      pcVar5 = __s;
      if (cVar7 != '\0' && cVar7 != '=') {
        do {
          pcVar5 = pcVar6 + 1;
          *pcVar6 = cVar7;
          pcVar4 = pcVar4 + 1;
          cVar7 = *pcVar4;
          pcVar6 = pcVar5;
        } while (cVar7 != '=' && cVar7 != '\0');
      }
      *pcVar5 = '=';
      strcat(pcVar5 + 1,local_20);
      sVar2 = strlen(__s);
      FUN_0001ce68(__s,sVar2 + 1,*(undefined2 *)(iVar1 + 2));
      free(__s);
    }
    FUN_00019af8(0);
  }
  else {
LAB_0001d348:
    FUN_0001b684(1);
  }
  return;
}




void FUN_0001d394(void *param_1)

{
  ushort *puVar1;
  int iVar2;
  
  if (param_1 != (void *)0x0) {
    if ((*(ushort *)((int)param_1 + 2) & 0x80) == 0) {
      iVar2 = (int)param_1 + 8;
      do {
        free(*(void **)(iVar2 + -4));
        puVar1 = (ushort *)(iVar2 + 2);
        iVar2 = iVar2 + 8;
      } while ((*puVar1 & 0x80) == 0);
    }
    free(param_1);
    return;
  }
  return;
}




void FUN_0001d3d8(uint param_1,int param_2,int param_3)

{
  ushort uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  size_t sVar5;
  int iVar6;
  char cVar7;
  int iVar8;
  char *__s;
  uint uVar9;
  undefined1 auStack_168 [64];
  byte local_128;
  char local_127;
  int local_124;
  char acStack_120 [260];
  
  if (param_2 == 0) {
    if ((uint)DAT_0007d3b1 == (param_1 & 0xff)) {
      if (0xe < DAT_0007d3b0) {
        return;
      }
      DAT_0007d3b0 = DAT_0007d3b0 + 1;
    }
    else {
      DAT_0007d3b0 = 1;
    }
    DAT_0007d3b1 = (byte)param_1;
    uVar2 = FUN_0001c21c();
    uVar3 = FUN_000512ec(param_1);
    uVar9 = param_1;
    snprintf(acStack_120,0x100,"0.0.0.0 %04x %02x %s",uVar2,param_1,uVar3);
    if (param_3 != 0) {
      sVar5 = strlen(acStack_120);
      snprintf(acStack_120 + sVar5,0x100 - sVar5," %s",param_3,uVar9,uVar3);
    }
    uVar9 = DAT_0007be6c & 2;
  }
  else {
    if ((uint)*(byte *)(param_2 + 0x39) == (param_1 & 0x7f)) {
      cVar7 = '\x01';
    }
    else {
      if (0xe < *(byte *)(param_2 + 0x3a)) {
        return;
      }
      cVar7 = *(byte *)(param_2 + 0x3a) + 1;
    }
    *(char *)(param_2 + 0x39) = (char)(param_1 & 0x7f);
    *(char *)(param_2 + 0x3a) = cVar7;
    if ((*(short *)(param_2 + 0xc) == 2) &&
       ((*(uint *)(param_2 + 0x10) << 0x18 | (*(uint *)(param_2 + 0x10) >> 8 & 0xff) << 0x10) == 0x7f7f0000)) {
      uVar2 = FUN_00050bec(param_2 + 0xc);
    }
    else {
      uVar2 = FUN_00050cd0();
    }
    uVar3 = FUN_0001c1bc(param_2);
    uVar4 = FUN_000512ec(param_1);
    uVar9 = param_1;
    snprintf(acStack_120,0x100,"%s %04x %02x %s",uVar2,uVar3,param_1,uVar4);
    if (param_3 != 0) {
      sVar5 = strlen(acStack_120);
      snprintf(acStack_120 + sVar5,0x100 - sVar5," %s",param_3,uVar3,uVar9,uVar4);
    }
    uVar9 = DAT_0007be6c & 0x20;
  }
  if (uVar9 != 0) {
    FUN_0004fe78(6,acStack_120);
  }
  FUN_0002e018(acStack_120);
  if (DAT_0007cf4c != 0) {
    printf("event at %lu %s\n",DAT_000cb548,acStack_120);
  }
  if (0 < DAT_000caad4) {
    DAT_0007d178 = 7;
    DAT_0007cf6c = &DAT_0007cf80;
    DAT_0007d17c = 0;
    DAT_0007d194 = &DAT_0007d154;
    DAT_0007d181 = 0;
    DAT_0007d180 = 1;
    if ((param_1 & 0x80) == 0) {
      DAT_0007cf7a = 0;
      iVar6 = FUN_0001c21c();
      DAT_0007cf78 = (ushort)(iVar6 << 8) | (ushort)((uint)iVar6 >> 8);
      iVar6 = 1;
      do {
        iVar8 = iVar6 + 1;
        FUN_0001a508(iVar6);
        iVar6 = iVar8;
      } while (iVar8 != 0x18);
    }
    else {
      if (param_2 == 0) {
        (*DAT_0007c9fc)("ntp_control.c",0xbdc,2,"peer != ((void *)0)");
      }
      DAT_0007cf7a = *(ushort *)(param_2 + 0x2c) << 8 | *(ushort *)(param_2 + 0x2c) >> 8;
      iVar6 = FUN_0001c1bc(param_2);
      DAT_0007cf78 = (ushort)(iVar6 << 8) | (ushort)((uint)iVar6 >> 8);
      iVar6 = 1;
      do {
        iVar8 = iVar6 + 1;
        FUN_0001ac4c(iVar6,param_2);
        iVar6 = iVar8;
      } while (iVar8 != 0x2a);
      if (param_1 == 0x8b) {
        local_124 = 0;
        FUN_00027e00(param_2 + 0xc,0,auStack_168);
        FUN_0001ab88("refclockstatus",local_128 & 0xf | local_127 << 4);
        iVar6 = 1;
        do {
          iVar8 = iVar6 + 1;
          FUN_0001b264(iVar6,auStack_168,0);
          iVar6 = iVar8;
        } while (iVar8 != 0xe);
        if (local_124 != 0) {
          uVar1 = *(ushort *)(local_124 + 2);
          iVar6 = local_124;
          while ((uVar1 & 0x80) == 0) {
            if ((uVar1 & 0x20) != 0) {
              __s = *(char **)(iVar6 + 4);
              sVar5 = strlen(__s);
              FUN_00019d60(__s,sVar5,0);
            }
            if (iVar6 + 8 == 0) break;
            uVar1 = *(ushort *)(iVar6 + 10);
            iVar6 = iVar6 + 8;
          }
        }
        FUN_0001d394(local_124);
      }
    }
    FUN_00019af8(0);
  }
  return;
}




void FUN_0001d7a0(void)

{
  ushort uVar1;
  bool bVar2;
  uint uVar3;
  char cVar4;
  char *__s;
  ushort *puVar5;
  uint uVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  size_t sVar10;
  char *pcVar11;
  undefined1 auStack_5c [4];
  undefined1 auStack_58 [64];
  byte local_18;
  byte local_17;
  int local_14;
  
  if (DAT_0007d3ac == 0) {
    if ((DAT_000cb470 == 0) || (iVar8 = DAT_000cb470, (*(uint *)(DAT_000cb470 + 0x34) & 8) == 0)) {
      piVar7 = &DAT_000cb038;
      do {
        piVar7 = piVar7 + 1;
        for (iVar8 = *piVar7; iVar8 != 0; iVar8 = *(int *)(iVar8 + 4)) {
          if ((*(uint *)(iVar8 + 0x34) & 8) != 0) goto LAB_0001d7d8;
        }
      } while (piVar7 != (int *)&DAT_000cb238);
LAB_0001d908:
      FUN_0001b684(4);
      return;
    }
  }
  else {
    iVar8 = FUN_00021604();
    if (iVar8 == 0) goto LAB_0001d908;
    if ((*(uint *)(iVar8 + 0x34) & 8) == 0) {
      FUN_0001b684(4);
      return;
    }
  }
LAB_0001d7d8:
  local_14 = 0;
  FUN_00027e00(iVar8 + 0xc,0,auStack_58);
  DAT_0007cf78 = (local_18 & 0xf | (local_17 & 0xf) << 4) << 8;
  if ((local_14 == 0) || ((*(ushort *)(local_14 + 2) & 0x80) != 0)) {
    sVar10 = 0xe;
  }
  else {
    iVar8 = local_14 + 0x10;
    uVar3 = *(ushort *)(local_14 + 2) & 0x80;
    do {
      uVar6 = uVar3;
      puVar5 = (ushort *)(iVar8 + -6);
      iVar8 = iVar8 + 8;
      uVar3 = uVar6 + 1;
    } while ((*puVar5 & 0x80) == 0);
    sVar10 = uVar6 + 0xf;
  }
  bVar2 = false;
  __s = (char *)FUN_0004f524(sVar10);
  memset(__s,0,sVar10);
  while (puVar5 = (ushort *)FUN_0001b77c(&DAT_0007a070,auStack_5c), puVar5 != (ushort *)0x0) {
    if ((puVar5[1] & 0x80) == 0) {
      __s[*puVar5] = '\x01';
    }
    else {
      puVar5 = (ushort *)FUN_0001b77c(local_14,auStack_5c);
      if (puVar5 == (ushort *)0x0) break;
      if ((puVar5[1] & 0x80) != 0) {
        FUN_0001b684(5);
        free(__s);
        FUN_0001d394(local_14);
        return;
      }
      __s[*puVar5 + 0xe] = '\x01';
    }
    bVar2 = true;
  }
  if (bVar2) {
    iVar8 = 1;
    pcVar11 = __s;
    do {
      while (pcVar11 = pcVar11 + 1, *pcVar11 == '\0') {
        iVar8 = iVar8 + 1;
        if (iVar8 == 0xe) goto LAB_0001d9a0;
      }
      iVar9 = iVar8 + 1;
      FUN_0001b264(iVar8,auStack_58,1);
      iVar8 = iVar9;
    } while (iVar9 != 0xe);
LAB_0001d9a0:
    if (local_14 != 0) {
      uVar1 = *(ushort *)(local_14 + 2);
      uVar3 = uVar1 & 0x80;
      iVar8 = local_14;
      iVar9 = local_14;
      while ((uVar1 & 0x80) == 0) {
        if (__s[uVar3 + 0xe] != '\0') {
          pcVar11 = *(char **)(iVar8 + 4);
          sVar10 = strlen(pcVar11);
          FUN_00019d60(pcVar11,sVar10,0);
          iVar9 = local_14;
        }
        iVar8 = iVar9 + (uVar3 + 1) * 8;
        if (iVar9 == 0) break;
        uVar3 = uVar3 + 1;
        uVar1 = *(ushort *)(iVar8 + 2);
      }
    }
  }
  else {
    if (DAT_0007a184 != '\0') {
      pcVar11 = &DAT_0007a184;
      cVar4 = DAT_0007a184;
      do {
        FUN_0001b264(cVar4,auStack_58,0);
        pcVar11 = pcVar11 + 1;
        cVar4 = *pcVar11;
      } while (cVar4 != '\0');
    }
    if (local_14 != 0) {
      uVar1 = *(ushort *)(local_14 + 2);
      iVar8 = local_14;
      while ((uVar1 & 0x80) == 0) {
        if ((uVar1 & 0x20) != 0) {
          pcVar11 = *(char **)(iVar8 + 4);
          sVar10 = strlen(pcVar11);
          FUN_00019d60(pcVar11,sVar10,0);
        }
        if (iVar8 + 8 == 0) break;
        uVar1 = *(ushort *)(iVar8 + 10);
        iVar8 = iVar8 + 8;
      }
    }
  }
  free(__s);
  FUN_0001d394(local_14);
  FUN_00019af8(0);
  return;
}




void FUN_0001dae8(int *param_1,int param_2)

{
  byte bVar1;
  size_t sVar2;
  size_t sVar3;
  char *__s;
  char *__s_00;
  int iVar4;
  FILE *pFVar5;
  int *piVar6;
  char *__s_01;
  __pid_t _Var7;
  int iVar8;
  int iVar9;
  uint uVar10;
  undefined1 auStack_98 [2];
  short local_96;
  byte local_93;
  undefined1 local_92;
  undefined1 local_91;
  undefined1 local_90;
  ushort local_8c;
  ushort local_8a;
  byte local_88;
  byte local_87;
  stat sStack_80;
  
  if (-1 < *(char *)((int)param_1 + 0x11)) {
    if ((FILE *)*param_1 == (FILE *)0x0) {
      return;
    }
    fclose((FILE *)*param_1);
    *param_1 = 0;
    return;
  }
  bVar1 = *(byte *)(param_1 + 4);
  if (bVar1 == 4) {
    FUN_0004e8ec(param_2,auStack_98);
    local_96 = (local_96 + 1) - (ushort)local_93;
    local_93 = 1;
LAB_0001dba4:
    local_90 = 0;
    local_91 = 0;
    local_92 = 0;
    iVar8 = FUN_0004ecd0(auStack_98);
LAB_0001dbbc:
    if ((*param_1 != 0) && (param_1[3] == iVar8)) {
      return;
    }
  }
  else {
    if (bVar1 < 5) {
      if (bVar1 == 2) {
        FUN_0004e8ec(param_2,auStack_98);
      }
      else {
        if (bVar1 < 3) {
          if (bVar1 != 1) goto LAB_0001db48;
          iVar8 = getpid();
          goto LAB_0001dbbc;
        }
        iVar8 = FUN_0004ef18(param_2);
        FUN_0004e8ec((param_2 + 0x3c) - (uint)(param_2 - iVar8) % 0x93a80,auStack_98);
      }
      goto LAB_0001dba4;
    }
    if (bVar1 == 6) {
      iVar8 = (DAT_000cb548 / 0x15180) * 0x15180;
      goto LAB_0001dbbc;
    }
    if (bVar1 < 6) {
      iVar8 = FUN_0004ef18(param_2);
      goto LAB_0001dbbc;
    }
    if (bVar1 != 0xff) {
LAB_0001db48:
      iVar8 = -1;
      goto LAB_0001dbbc;
    }
    if (*param_1 != 0) {
      return;
    }
    iVar8 = -1;
  }
  if (0 < DAT_0007cf4c) {
    printf("filegen  %0x %lu %lu %lu\n",(uint)*(byte *)(param_1 + 4),param_2,param_1[3],iVar8);
  }
  sVar2 = strlen((char *)param_1[1]);
  sVar3 = strlen((char *)param_1[2]);
  iVar9 = sVar3 + sVar2;
  __s = (char *)FUN_0004f524(iVar9 + 1U);
  snprintf(__s,iVar9 + 1U,"%s%s",param_1[1],param_1[2]);
  bVar1 = *(byte *)(param_1 + 4);
  if (bVar1 == 4) {
    FUN_0004e8ec(iVar8,&local_8c);
    __s_00 = (char *)FUN_0004f524(iVar9 + 8U);
    snprintf(__s_00,iVar9 + 8U,"%s%c%04d%02d",__s,0x2e,(uint)local_8c,(uint)local_88);
    goto LAB_0001dc84;
  }
  if (bVar1 < 5) {
    if (bVar1 == 2) {
      FUN_0004e8ec(iVar8,&local_8c);
      __s_00 = (char *)FUN_0004f524(iVar9 + 10U);
      snprintf(__s_00,iVar9 + 10U,"%s%c%04d%02d%02d",__s,0x2e,(uint)local_8c,(uint)local_88,(uint)local_87);
      goto LAB_0001dc84;
    }
    if (2 < bVar1) {
      FUN_0004e8ec(iVar8,&local_8c);
      __s_00 = (char *)FUN_0004f524(iVar9 + 9U);
      uVar10 = local_8a / 7;
      snprintf(__s_00,iVar9 + 9U,"%s%c%04dw%02d",__s,0x2e,(uint)local_8c,
               (uVar10 + (local_8a - uVar10 >> 1)) * 0x4000 >> 0x10);
      goto LAB_0001dc84;
    }
    if (bVar1 == 1) {
      __s_00 = (char *)FUN_0004f524(iVar9 + 0xdU);
      snprintf(__s_00,iVar9 + 0xdU,"%s%c#%ld",__s,0x2e,iVar8);
      goto LAB_0001dc84;
    }
LAB_0001dc60:
    FUN_0004fe78(3,"unsupported file generations type %d for \"%s\" - reverting to FILEGEN_NONE",bVar1,__s);
    *(undefined1 *)(param_1 + 4) = 0xff;
  }
  else {
    if (bVar1 == 6) {
      __s_00 = (char *)FUN_0004f524(iVar9 + 0xeU);
      snprintf(__s_00,iVar9 + 0xeU,"%s%ca%08ld",__s,0x2e,iVar8);
      goto LAB_0001dc84;
    }
    if (bVar1 < 6) {
      FUN_0004e8ec(iVar8,&local_8c);
      __s_00 = (char *)FUN_0004f524(iVar9 + 6U);
      snprintf(__s_00,iVar9 + 6U,"%s%c%04d",__s,0x2e,(uint)local_8c);
      goto LAB_0001dc84;
    }
    if (bVar1 != 0xff) goto LAB_0001dc60;
  }
  __s_00 = (char *)FUN_0004f4e8(__s);
LAB_0001dc84:
  if ((char)param_1[4] != -1) {
    iVar4 = __xstat(3,__s,&sStack_80);
    if (iVar4 == 0) {
      if ((sStack_80.st_mode & 0xf000) == 0x8000) {
        if (sStack_80.st_nlink < 2) {
          __s_01 = (char *)FUN_0004f524(iVar9 + 0x17U);
          _Var7 = getpid();
          iVar4 = DAT_0007d3b4;
          DAT_0007d3b4 = DAT_0007d3b4 + 1;
          snprintf(__s_01,iVar9 + 0x17U,"%s%c%dC%lu",__s,0x2e,_Var7,iVar4);
          iVar9 = rename(__s,__s_01);
          if (iVar9 != 0) {
            FUN_0004fe78(3,"couldn\'t save %s: %m",__s);
          }
          free(__s_01);
        }
        else {
          iVar9 = unlink(__s);
          if (iVar9 != 0) {
            FUN_0004fe78(3,"couldn\'t unlink %s: %m",__s);
          }
        }
      }
      else {
        FUN_0004fe78(3,"expected regular file for %s (found mode 0%lo)",__s);
      }
    }
    else {
      piVar6 = __errno_location();
      if (*piVar6 != 2) {
        FUN_0004fe78(3,"stat(%s) failed: %m",__s);
      }
    }
  }
  pFVar5 = fopen(__s_00,"a");
  if (3 < DAT_0007cf4c) {
    printf("opening filegen (type=%d/id=%lu) \"%s\"\n",(uint)*(byte *)(param_1 + 4),iVar8,__s_00);
  }
  if (pFVar5 == (FILE *)0x0) {
    piVar6 = __errno_location();
    if (*piVar6 != 2) {
      FUN_0004fe78(3,"can\'t open %s: %m",__s_00);
    }
  }
  else {
    if ((FILE *)*param_1 != (FILE *)0x0) {
      fclose((FILE *)*param_1);
    }
    *param_1 = (int)pFVar5;
    param_1[3] = iVar8;
    if ((((*(byte *)((int)param_1 + 0x11) & 1) != 0) && (iVar8 = link(__s_00,__s), iVar8 != 0)) &&
       (piVar6 = __errno_location(), *piVar6 != 0x11)) {
      FUN_0004fe78(3,"can\'t link(%s, %s): %m",__s_00,__s);
    }
  }
  free(__s);
  free(__s_00);
  return;
}




void FUN_0001e100(undefined4 *param_1,char *param_2,uint param_3,uint param_4)

{
  int iVar1;
  char *__s;
  FILE *__stream;
  undefined4 uVar2;
  char *__s2;
  undefined4 local_28 [2];
  
  __s2 = (char *)param_1[2];
  iVar1 = strcmp(param_2,__s2);
  if (((((iVar1 != 0) || (*(byte *)(param_1 + 4) != param_3)) || (*(byte *)((int)param_1 + 0x11) != param_4)) &&
      (((char *)param_1[1] != (char *)0x0 && (*(char *)param_1[1] != '\0')))) && (__s = param_2, param_2 != (char *)0x0)
     ) {
    do {
      if (((*__s == '.') && (__s[1] == '.')) && (__s[2] == '\0' || __s[2] == '/')) {
        return;
      }
      __s = strchr(__s,0x2f);
    } while (__s != (char *)0x0);
    __stream = (FILE *)*param_1;
    if (__stream != (FILE *)0x0) {
      fclose(__stream);
      __s2 = (char *)param_1[2];
      *param_1 = 0;
    }
    if (2 < DAT_0007cf4c) {
      printf("configuring filegen:\n\tprefix:\t%s\n\tbasename:\t%s -> %s\n\ttype:\t%d -> %d\n\tflag: %x -> %x\n",
             param_1[1],__s2,param_2,(uint)*(byte *)(param_1 + 4),param_3,(uint)*(byte *)((int)param_1 + 0x11),param_4);
      __s2 = (char *)param_1[2];
    }
    iVar1 = strcmp(__s2,param_2);
    if (iVar1 != 0) {
      free(__s2);
      uVar2 = FUN_0004f4e8(param_2);
      param_1[2] = uVar2;
    }
    *(char *)(param_1 + 4) = (char)param_3;
    *(char *)((int)param_1 + 0x11) = (char)param_4;
    if (__stream != (FILE *)0x0) {
      FUN_0004cba8(local_28);
      FUN_0001dae8(param_1,local_28[0]);
    }
  }
  return;
}




undefined4 FUN_0001e278(char *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = DAT_0007d3b8;
  if (DAT_0007d3b8 != (undefined4 *)0x0) {
    do {
      if (((char *)*puVar2 == param_1) || (iVar1 = strcmp(param_1,(char *)*puVar2), iVar1 == 0)) {
        if (3 < DAT_0007cf4c) {
          printf("filegen_get(%s) = %p\n",param_1,puVar2[1],DAT_0007cf4c,param_4);
          return puVar2[1];
        }
        return puVar2[1];
      }
      puVar2 = (undefined4 *)puVar2[2];
    } while (puVar2 != (undefined4 *)0x0);
  }
  if (3 < DAT_0007cf4c) {
    printf("filegen_get(%s) = NULL\n",param_1);
    return 0;
  }
  return 0;
}




void FUN_0001e328(undefined4 param_1,char *param_2,undefined4 *param_3)

{
  undefined4 uVar1;
  char *__s1;
  int iVar2;
  undefined4 *puVar3;
  int *piVar4;
  
  if (3 < DAT_0007cf4c) {
    printf("filegen_register(%s, %p)\n");
  }
  param_3[1] = param_1;
  *param_3 = 0;
  uVar1 = FUN_0004f4e8(param_2);
  param_3[3] = 0;
  *(undefined1 *)(param_3 + 4) = 2;
  puVar3 = DAT_0007d3b8;
  *(undefined1 *)((int)param_3 + 0x11) = 1;
  param_3[2] = uVar1;
  if (puVar3 == (undefined4 *)0x0) {
    piVar4 = (int *)&DAT_0007d3b8;
  }
  else {
    __s1 = (char *)*puVar3;
    piVar4 = (int *)&DAT_0007d3b8;
    while( true ) {
      if ((__s1 == param_2) || (iVar2 = strcmp(__s1,param_2), iVar2 == 0)) {
        if (4 < DAT_0007cf4c) {
          printf("replacing filegen %p\n",puVar3[1]);
        }
        *(undefined4 **)(*piVar4 + 4) = param_3;
        return;
      }
      piVar4 = puVar3 + 2;
      puVar3 = (undefined4 *)puVar3[2];
      if (puVar3 == (undefined4 *)0x0) break;
      __s1 = (char *)*puVar3;
    }
  }
  iVar2 = FUN_0004f524(0xc);
  *piVar4 = iVar2;
  *(undefined4 *)(iVar2 + 8) = 0;
  puVar3 = (undefined4 *)*piVar4;
  uVar1 = FUN_0004f4e8(param_2);
  iVar2 = DAT_0007cf4c;
  *puVar3 = uVar1;
  *(undefined4 **)(*piVar4 + 4) = param_3;
  if (iVar2 < 6) {
    return;
  }
  puts("adding new filegen");
  return;
}




void FUN_0001e458(char *param_1)

{
  char *__s1;
  undefined4 *__ptr;
  int iVar1;
  undefined4 *puVar2;
  
  if (3 < DAT_0007cf4c) {
    printf("filegen_unregister(%s)\n",param_1);
  }
  if (DAT_0007d3b8 != (undefined4 *)0x0) {
    __s1 = (char *)*DAT_0007d3b8;
    puVar2 = &DAT_0007d3b8;
    __ptr = DAT_0007d3b8;
    while ((__s1 != param_1 && (iVar1 = strcmp(__s1,param_1), iVar1 != 0))) {
      puVar2 = __ptr + 2;
      __ptr = (undefined4 *)__ptr[2];
      if (__ptr == (undefined4 *)0x0) {
        return;
      }
      __s1 = (char *)*__ptr;
    }
    *puVar2 = __ptr[2];
    iVar1 = __ptr[1];
    free((void *)*__ptr);
    free(__ptr);
    free(*(void **)(iVar1 + 8));
    return;
  }
  return;
}




undefined4 FUN_0001e504(undefined4 *param_1)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  undefined4 uVar4;
  
  puVar3 = &DAT_0007d3bc;
  if (DAT_0007d3bc != param_1) {
    if (DAT_0007d3bc == (undefined4 *)0x0) goto LAB_0001e554;
    puVar2 = (undefined4 *)*DAT_0007d3bc;
    puVar3 = DAT_0007d3bc;
    while (puVar1 = puVar2, puVar1 != param_1) {
      if (puVar1 == (undefined4 *)0x0) goto LAB_0001e554;
      puVar3 = puVar1;
      puVar2 = (undefined4 *)*puVar1;
    }
  }
  *puVar3 = *param_1;
LAB_0001e554:
  uVar4 = *param_1;
  if ((void *)param_1[1] != (void *)0x0) {
    free((void *)param_1[1]);
  }
  free(param_1);
  return uVar4;
}




void FUN_0001e584(void)

{
  __pid_t _Var1;
  
  _Var1 = getppid();
  if (_Var1 != 1) {
    return;
  }
  FUN_0004fe78(6,"parent died before we finished, exiting");
                    /* WARNING: Subroutine does not return */
  exit(0);
}




/* WARNING: Type propagation algorithm not settling */

undefined4 FUN_0001e5ac(void *param_1)

{
  uint uVar1;
  int iVar2;
  ssize_t sVar3;
  int *piVar4;
  char *pcVar5;
  addrinfo **ppaVar6;
  uint *puVar7;
  uint uVar8;
  uint uVar9;
  size_t __n;
  uint *puVar10;
  addrinfo *local_1b4;
  timeval local_1b0;
  uint local_1a8;
  uint local_1a4;
  addrinfo local_1a0;
  fd_set local_180;
  byte local_100;
  byte local_ff;
  undefined2 local_fe;
  ushort local_fc;
  ushort local_fa;
  undefined1 auStack_f8 [168];
  uint auStack_50 [2];
  uint local_48;
  undefined1 local_44 [4];
  uint local_40 [7];
  
  FUN_0001e584();
  if (DAT_0007a194 != -1) {
LAB_0001e5cc:
    ppaVar6 = &local_1a0.ai_next;
    local_1b0.tv_sec = 0;
    local_1b0.tv_usec = 0;
    do {
      ppaVar6 = ppaVar6 + 1;
      *ppaVar6 = (addrinfo *)0x0;
    } while (ppaVar6 != (addrinfo **)(local_180.fds_bits + 0x1f));
    iVar2 = DAT_0007a194 + 0x1f;
    if (-1 < DAT_0007a194) {
      iVar2 = DAT_0007a194;
    }
    local_180.fds_bits[iVar2 >> 5] = local_180.fds_bits[iVar2 >> 5] | 1 << (DAT_0007a194 % 0x20 & 0xffU);
    while (iVar2 = select(DAT_0007a194 + 1,&local_180,(fd_set *)0x0,(fd_set *)0x0,&local_1b0), 0 < iVar2) {
      recv(DAT_0007a194,&local_100,0xd8,0);
      ppaVar6 = &local_1a0.ai_next;
      do {
        ppaVar6 = ppaVar6 + 1;
        *ppaVar6 = (addrinfo *)0x0;
      } while (ppaVar6 != (addrinfo **)(local_180.fds_bits + 0x1f));
      iVar2 = DAT_0007a194 + 0x1f;
      if (-1 < DAT_0007a194) {
        iVar2 = DAT_0007a194;
      }
      local_180.fds_bits[iVar2 >> 5] = local_180.fds_bits[iVar2 >> 5] | 1 << (DAT_0007a194 % 0x20 & 0xffU);
    }
    memset(&local_100,0,0xd8);
    local_100 = 0x17;
    local_ff = 0x80;
    local_fe = 0xa03;
    local_fc = 0x100;
    local_fa = 0xa800;
    memcpy(auStack_f8,param_1,0xa8);
    if ((DAT_000cb46c == 0) || (DAT_000cab80 < 0x11)) {
      puVar7 = local_40;
      puVar10 = &local_48;
      __n = 0xc0;
    }
    else {
      if ((undefined1 *)0xd8 < local_44 + (DAT_000cab80 - (int)&local_100)) {
        FUN_0004fe78(3,"intres total_len %lu limit is %lu (%lu octet digest)\n",
                     local_44 + (DAT_000cab80 - (int)&local_100),0xd8,DAT_000cab80);
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      puVar7 = &local_48;
      puVar10 = auStack_50;
      __n = 0xb8;
    }
    *puVar7 = DAT_000cab88 << 0x18 | (DAT_000cab88 >> 8 & 0xff) << 0x10 | (DAT_000cab88 >> 0x10 & 0xff) << 8 |
              DAT_000cab88 >> 0x18;
    FUN_0004cba8(&local_1a8);
    uVar8 = (local_1a4 >> 0x10) + 0x800;
    uVar9 = local_1a4 & 0xffff | uVar8 * 0x10000;
    if ((uVar8 & 0x10000) != 0) {
      local_1a8 = local_1a8 + 1;
    }
    *puVar10 = local_1a8 << 0x18 | (local_1a8 >> 8 & 0xff) << 0x10 | (local_1a8 >> 0x10 & 0xff) << 8 | local_1a8 >> 0x18
    ;
    puVar10[1] = local_1a4 << 0x18 | ((local_1a4 & 0xff00) >> 8) << 0x10 | (uVar8 & 0xff) << 8 | uVar8 * 0x10000 >> 0x18
    ;
    local_1a4 = uVar9;
    if (DAT_000cb46c != 0) {
      iVar2 = FUN_0004e458(DAT_000cab88,&local_100,__n);
      if (iVar2 != DAT_000cab80 + 4) {
        FUN_0004fe78(3,"intres maclen %d expected %lu\n",iVar2);
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      __n = __n + iVar2;
    }
    sVar3 = send(DAT_0007a194,&local_100,__n,0);
    if (sVar3 < 0) {
      FUN_0004fe78(3,"send to NTP server failed: %m");
    }
    else {
      do {
        uVar8 = 0;
LAB_0001e8b4:
        do {
          uVar9 = uVar8 + 1;
          local_180.fds_bits[uVar8] = 0;
          uVar8 = uVar9;
        } while (uVar9 < 0x20);
        uVar8 = 0;
        iVar2 = DAT_0007a194 + 0x1f;
        if (-1 < DAT_0007a194) {
          iVar2 = DAT_0007a194;
        }
        local_1b0.tv_usec = 0;
        local_180.fds_bits[iVar2 >> 5] = local_180.fds_bits[iVar2 >> 5] | 1 << (DAT_0007a194 % 0x20 & 0xffU);
        local_1b0.tv_sec = 2;
        iVar2 = select(DAT_0007a194 + 1,&local_180,(fd_set *)0x0,(fd_set *)0x0,&local_1b0);
        if (iVar2 < 0) {
          piVar4 = __errno_location();
          if (*piVar4 == 4) {
            return 0;
          }
          FUN_0004fe78(3,"select() fails: %m");
          return 0;
        }
        if (iVar2 == 0) {
          if (DAT_0007cf4c == 0) {
            return 0;
          }
          FUN_0004fe78(6,"ntp_intres select() returned 0.");
          return 0;
        }
        uVar9 = recv(DAT_0007a194,&local_100,0xd8,0);
        if (0 < (int)uVar9) {
          if (uVar9 < 8) {
            FUN_0004fe78(3,"received runt response (%d octets)");
            uVar8 = 0;
          }
          else {
            uVar9 = (uint)local_100;
            if ((local_100 & 0x80) != 0) {
              if ((local_100 & 0x40) != 0) {
                if (1 < DAT_0007cf4c) {
                  FUN_0004fe78(6,"received fragmented packet");
                }
                goto LAB_0001e8b4;
              }
              uVar8 = (uVar9 << 0x1a) >> 0x1d;
              if ((uVar8 - 2 < 3) && ((uVar9 & 7) == 7)) {
                if ((local_ff & 0x7f) == 0) {
                  if (local_fe == 0xa03) {
                    uVar8 = (local_fc & 0xff) << 8;
                    uVar9 = uVar8 & 0xfff | (uint)(local_fc >> 8);
                    if (uVar9 == 0) {
                      uVar1 = (local_fa & 0xff) << 8;
                      if ((uVar1 >> 0xc == 0) && ((uVar1 & 0xfff) == 0 && local_fa >> 8 == 0)) {
                        switch(uVar8 >> 0xc) {
                        case 0:
                        case 4:
                          return 1;
                        case 1:
                          FUN_0004fe78(3,"ntp_intres.request: implementation mismatch");
                          return 0;
                        case 2:
                          FUN_0004fe78(3,"ntp_intres.request: request unknown");
                          return 0;
                        case 3:
                          FUN_0004fe78(3,"ntp_intres.request: format error");
                          return 0;
                        default:
                          FUN_0004fe78(3,"ntp_intres.request: unknown error code %d");
                          return 0;
                        case 7:
                          FUN_0004fe78(3,"ntp_intres.request: permission denied");
                          return 0;
                        }
                      }
                    }
                    if (1 < DAT_0007cf4c) {
                      uVar8 = (local_fa & 0xff) << 8;
                      FUN_0004fe78(6,"nitems (%d) mbz (%d) or itemsize (%d) nonzero",uVar9,uVar8 >> 0xc,
                                   uVar8 & 0xfff | (uint)(local_fa >> 8));
                      uVar8 = 0;
                      goto LAB_0001e8b4;
                    }
                  }
                  else if (1 < DAT_0007cf4c) {
                    FUN_0004fe78(6,"implementation (%d) or request (%d) incorrect",(undefined1)local_fe,local_fe._1_1_);
                  }
                }
                else if (1 < DAT_0007cf4c) {
                  FUN_0004fe78(6,"nonzero sequence number (%d)");
                  uVar8 = 0;
                  goto LAB_0001e8b4;
                }
              }
              else if (1 < DAT_0007cf4c) {
                FUN_0004fe78(6,"version (%d/%d) or mode (%d/%d) incorrect",uVar8,4,uVar9 & 7,7);
                uVar8 = 0;
                goto LAB_0001e8b4;
              }
              uVar8 = 0;
              goto LAB_0001e8b4;
            }
            if (1 < DAT_0007cf4c) {
              FUN_0004fe78(6,"received non-response packet");
              uVar8 = 0;
            }
          }
          goto LAB_0001e8b4;
        }
      } while (uVar9 == 0);
      FUN_0004fe78(3,"recv() fails: %m");
    }
    return 0;
  }
  local_1a0.ai_flags = 0;
  local_1a0.ai_protocol = 0;
  local_1a0.ai_addrlen = 0;
  local_1a0.ai_addr = (sockaddr *)0x0;
  local_1a0.ai_canonname = (char *)0x0;
  local_1a0.ai_next = (addrinfo *)0x0;
  local_1a0.ai_family = 2;
  local_1a0.ai_socktype = 2;
  iVar2 = getaddrinfo("127.0.0.1","ntp",&local_1a0,&local_1b4);
  if (iVar2 == 0) {
    DAT_0007a194 = socket(local_1b4->ai_family,local_1b4->ai_socktype,0);
    if (DAT_0007a194 != -1) {
      if (0x3ff < DAT_0007a194) {
        FUN_0004fe78(3,"socket fd %d too large, FD_SETSIZE %d",DAT_0007a194,0x400);
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      iVar2 = fcntl(DAT_0007a194,4,0x800);
      if (iVar2 == -1) {
        FUN_0004fe78(3,"fcntl(O_NONBLOCK) failed: %m");
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      iVar2 = connect(DAT_0007a194,local_1b4->ai_addr,local_1b4->ai_addrlen);
      if (iVar2 == -1) {
        FUN_0004fe78(3,"openntp: connect() failed: %m");
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      freeaddrinfo(local_1b4);
      goto LAB_0001e5cc;
    }
    FUN_0004fe78(3,"socket() failed: %m",0xffffffff);
  }
  else if (iVar2 == -0xb) {
    FUN_0004fe78(3,"getaddrinfo(%s) failed: %m","127.0.0.1");
  }
  else {
    pcVar5 = gai_strerror(iVar2);
    FUN_0004fe78(3,"getaddrinfo(%s) failed: %s","127.0.0.1",pcVar5);
  }
                    /* WARNING: Subroutine does not return */
  exit(1);
}




void FUN_0001ed5c(int param_1)

{
  undefined4 uVar1;
  int iVar2;
  int *piVar3;
  socklen_t __salen;
  short sVar4;
  undefined4 uVar5;
  char *pcVar6;
  char *pcVar7;
  int *piVar8;
  int iVar9;
  undefined4 uVar10;
  int __errnum;
  sockaddr *psVar11;
  addrinfo *local_4c;
  addrinfo local_48;
  
  if (1 < DAT_0007cf4c) {
    pcVar6 = "without";
    if (param_1 != 0) {
      pcVar6 = "with";
    }
    FUN_0004fe78(6,"Running doconfigure %s DNS",pcVar6);
  }
  piVar8 = (int *)DAT_0007d3bc;
  if (param_1 != 0) {
    __res_init();
    piVar8 = (int *)DAT_0007d3bc;
  }
joined_r0x0001eda8:
  do {
    if (piVar8 == (int *)0x0) {
      return;
    }
    if (1 < DAT_0007cf4c) {
      uVar10 = piVar8[1];
      uVar1 = FUN_00050cd0(piVar8 + 0x2e);
      FUN_0004fe78(6,"doconfigure: <%s> has peeraddr %s",uVar10,uVar1);
    }
    sVar4 = *(short *)(piVar8 + 0x2e);
    if (param_1 != 0) {
      if (sVar4 == 2) {
        iVar2 = 1 - piVar8[0x2f];
        if (1 < (uint)piVar8[0x2f]) {
          iVar2 = 0;
        }
      }
      else {
        if (((piVar8[0x30] != 0) || (piVar8[0x31] != 0)) || (piVar8[0x32] != 0)) goto LAB_0001ee14;
        iVar2 = 1 - piVar8[0x33];
        if (1 < (uint)piVar8[0x33]) {
          iVar2 = 0;
        }
      }
      if (iVar2 != 0) {
        FUN_0001e584();
        if (piVar8[1] == 0) {
          if (*(short *)(piVar8 + 0x2e) == 2) {
            iVar2 = 1 - piVar8[0x2f];
            if (1 < (uint)piVar8[0x2f]) {
              iVar2 = 0;
            }
LAB_0001f0d8:
            if (iVar2 == 0) goto LAB_0001f0e0;
            FUN_0004fe78(3,"findhostaddr: both ce_name and ce_peeraddr are undefined!");
LAB_0001f1b0:
            FUN_0004fe78(3,"couldn\'t resolve `%s\', giving up on it",piVar8[1]);
            piVar8 = (int *)FUN_0001e504(piVar8);
            goto joined_r0x0001eda8;
          }
          if (((piVar8[0x30] == 0) && (piVar8[0x31] == 0)) && (piVar8[0x32] == 0)) {
            iVar2 = 1 - piVar8[0x33];
            if (1 < (uint)piVar8[0x33]) {
              iVar2 = 0;
            }
            goto LAB_0001f0d8;
          }
LAB_0001f0e0:
          if (1 < DAT_0007cf4c) {
            uVar1 = FUN_00050cd0((sockaddr *)(piVar8 + 0x2e));
            printf("findhostaddr: Resolving <%s>\n",uVar1);
          }
          uVar1 = FUN_0004f524(0x40);
          if (*(short *)(piVar8 + 0x2e) == 2) {
            __salen = 0x10;
          }
          else {
            __salen = 0x1c;
          }
          piVar8[1] = uVar1;
          iVar2 = getnameinfo((sockaddr *)(piVar8 + 0x2e),__salen,(char *)(piVar8 + 1),0x40,(char *)0x0,0,0);
          if (iVar2 != 0) goto LAB_0001f148;
LAB_0001f07c:
          if (DAT_0007cf4c < 2) goto LAB_0001ef08;
          pcVar6 = "name";
          if (piVar8[1] == 0) {
            pcVar6 = "address";
          }
          printf("findhostaddr: %s resolved.\n",pcVar6);
          sVar4 = *(short *)(piVar8 + 0x2e);
        }
        else {
          if (*(short *)(piVar8 + 0x2e) == 2) {
            iVar2 = piVar8[0x2f];
            if (iVar2 != 0) {
              iVar2 = 1;
            }
LAB_0001efb4:
            if (iVar2 != 0) goto LAB_0001eefc;
            if (1 < DAT_0007cf4c) {
              printf("findhostaddr: Resolving <%s>\n");
            }
            local_48.ai_family = piVar8[0x2d];
            local_48.ai_flags = 0;
            local_48.ai_addrlen = 0;
            local_48.ai_addr = (sockaddr *)0x0;
            local_48.ai_canonname = (char *)0x0;
            local_48.ai_next = (addrinfo *)0x0;
            local_48.ai_socktype = 2;
            if (DAT_000cb864 == 0) {
              local_48.ai_family = 2;
            }
            local_48.ai_protocol = 0x11;
            iVar2 = getaddrinfo((char *)piVar8[1],(char *)0x0,&local_48,&local_4c);
            if (iVar2 == 0) {
              psVar11 = local_4c->ai_addr;
              uVar1 = *(undefined4 *)(psVar11->sa_data + 2);
              uVar10 = *(undefined4 *)(psVar11->sa_data + 6);
              uVar5 = *(undefined4 *)(psVar11->sa_data + 10);
              piVar8[0x2e] = *(undefined4 *)psVar11;
              piVar8[0x2f] = uVar1;
              piVar8[0x30] = uVar10;
              piVar8[0x31] = uVar5;
              uVar1 = *(undefined4 *)(psVar11[1].sa_data + 2);
              uVar10 = *(undefined4 *)(psVar11[1].sa_data + 6);
              piVar8[0x32] = *(undefined4 *)(psVar11 + 1);
              piVar8[0x33] = uVar1;
              piVar8[0x34] = uVar10;
              if (*(short *)(piVar8 + 0x2e) == 2) {
                piVar8[0x26] = 0;
                piVar8[2] = piVar8[0x2f];
              }
              else {
                piVar8[0x26] = 1;
                piVar8[0x28] = piVar8[0x30];
                piVar8[0x29] = piVar8[0x31];
                piVar8[0x2a] = piVar8[0x32];
                piVar8[0x2b] = piVar8[0x33];
              }
              freeaddrinfo(local_4c);
              goto LAB_0001f07c;
            }
LAB_0001f148:
            switch(iVar2) {
            case -0xb:
              if (DAT_0007cf4c < 1) goto LAB_0001ef08;
              piVar3 = __errno_location();
              iVar9 = 1;
              __errnum = *piVar3;
              pcVar6 = strerror(__errnum);
              printf("intres: EAI_SYSTEM errno %d (%s) means try again, right?\n",__errnum,pcVar6);
              break;
            default:
              iVar9 = 0;
              break;
            case -5:
            case -2:
              pcVar6 = " EAI_NODATA";
              if (iVar2 == -2) {
                pcVar6 = "";
              }
              pcVar7 = " (permanent)";
              if (DAT_0007d3c0 == 0) {
                pcVar7 = "";
              }
              FUN_0004fe78(3,"host name not found%s%s: %s",pcVar6,pcVar7,piVar8[1]);
              iVar9 = 1 - DAT_0007d3c0;
              if (1 < DAT_0007d3c0) {
                iVar9 = 0;
              }
              break;
            case -4:
              iVar9 = 1;
              break;
            case -3:
              iVar9 = 1;
              DAT_0007d3c0 = 1;
            }
            if (1 < DAT_0007cf4c) {
              printf("intres: got error status of: %d\n",iVar2);
            }
            if (iVar9 == 0) goto LAB_0001f1b0;
          }
          else {
            if (((piVar8[0x30] == 0) && (piVar8[0x31] == 0)) && (piVar8[0x32] == 0)) {
              iVar2 = piVar8[0x33];
              if (iVar2 != 0) {
                iVar2 = 1;
              }
              goto LAB_0001efb4;
            }
LAB_0001eefc:
            FUN_0004fe78(3,"findhostaddr: both ce_name and ce_peeraddr are defined...");
          }
LAB_0001ef08:
          sVar4 = *(short *)(piVar8 + 0x2e);
        }
        if (sVar4 == 2) {
          iVar2 = piVar8[0x2f];
          if (iVar2 != 0) {
            iVar2 = 1;
          }
LAB_0001f0c0:
          if (iVar2 == 0) goto LAB_0001ee14;
        }
        else if (((piVar8[0x30] == 0) && (piVar8[0x31] == 0)) && (piVar8[0x32] == 0)) {
          iVar2 = piVar8[0x33];
          if (iVar2 != 0) {
            iVar2 = 1;
          }
          goto LAB_0001f0c0;
        }
        uVar10 = piVar8[1];
        uVar1 = FUN_00050cd0(piVar8 + 0x2e);
        FUN_0004fe78(6,"DNS %s -> %s",uVar10,uVar1);
        sVar4 = *(short *)(piVar8 + 0x2e);
      }
    }
LAB_0001ee14:
    if (sVar4 == 2) {
      iVar2 = piVar8[0x2f];
      if (iVar2 != 0) {
        iVar2 = 1;
      }
LAB_0001ee88:
      if (iVar2 != 0) {
        iVar2 = FUN_0001e5ac(piVar8 + 2);
        goto joined_r0x0001ee9c;
      }
LAB_0001ee50:
      piVar8 = (int *)*piVar8;
    }
    else {
      if (((piVar8[0x30] == 0) && (piVar8[0x31] == 0)) && (piVar8[0x32] == 0)) {
        iVar2 = piVar8[0x33];
        if (iVar2 != 0) {
          iVar2 = 1;
        }
        goto LAB_0001ee88;
      }
      iVar2 = FUN_0001e5ac(piVar8 + 2);
joined_r0x0001ee9c:
      if (iVar2 == 0) {
        if (1 < DAT_0007cf4c) {
          FUN_0004fe78(6,"doconfigure: request() FAILED, maybe next time.");
        }
        goto LAB_0001ee50;
      }
      piVar8 = (int *)FUN_0001e504(piVar8);
    }
  } while( true );
}




/* WARNING: Restarted to delay deadcode elimination for space: ram */

void FUN_0001f310(void)

{
  undefined4 uVar1;
  undefined4 uVar2;
  char *__src;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  fd_set *pfVar11;
  int iVar12;
  FILE *__stream;
  char *pcVar13;
  fd_set *pfVar14;
  int iVar15;
  undefined4 *puVar16;
  undefined4 uVar17;
  int *piVar18;
  char *pcVar19;
  undefined4 *puVar20;
  fd_set *pfVar21;
  char cVar22;
  undefined4 *puVar23;
  byte bVar24;
  char **ppcVar25;
  char *pcVar26;
  __suseconds_t *p_Var27;
  int local_28c;
  timeval local_288;
  char *local_280 [11];
  undefined1 auStack_254 [4];
  undefined4 local_250;
  undefined4 local_24c;
  undefined4 local_248;
  undefined4 local_244;
  undefined4 local_240;
  undefined4 local_23c;
  uint local_238;
  undefined4 local_234;
  undefined4 local_230;
  undefined4 uStack_22c;
  fd_set local_228 [4];
  
  if (1 < DAT_0007cf4c) {
    FUN_0004fe78(6,"NTP_INTRES running");
  }
  if ((DAT_000cb46c != 0) && (iVar12 = FUN_0004e030(DAT_000cab88), iVar12 == 0)) {
    FUN_0004fe78(3,"invalid request keyid %08x",DAT_000cab88);
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  __stream = fopen(DAT_000cab7c,"r");
  pcVar19 = DAT_000cab7c;
  if (__stream == (FILE *)0x0) {
    FUN_0004fe78(3,"can\'t open configuration file %s: %m",DAT_000cab7c);
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  puVar16 = DAT_0007d3bc;
  do {
    DAT_0007d3bc = puVar16;
    pcVar13 = fgets((char *)local_228,0x200,__stream);
    if (pcVar13 == (char *)0x0) {
      fclose(__stream);
      if ((DAT_0007cf4c == 0) && (iVar12 = unlink(DAT_000cab7c), iVar12 != 0)) {
        FUN_0004fe78(4,"unable to remove intres request file %s, %m",DAT_000cab7c);
      }
      DAT_0007d3c4 = 0;
      DAT_0007d3c8 = 2;
      DAT_0007d3cc = 2;
      do {
        iVar12 = DAT_0007d3c4;
        FUN_0001e584();
        if (iVar12 == 0) {
          sleep(2);
          FUN_0001ed5c(1);
          DAT_0007d3c4 = DAT_0007d3c8;
          if (2 < DAT_0007cf4c) {
            FUN_0004fe78(6,"resolve_timer: 0->%d");
          }
          DAT_0007d3cc = 2;
          if (DAT_0007d3c8 < 0x20) {
            DAT_0007d3c8 = DAT_0007d3c8 << 1;
          }
        }
        else if (DAT_0007d3cc == 0) {
          FUN_0001ed5c();
          DAT_0007d3cc = 2;
          if (2 < DAT_0007cf4c) {
            FUN_0004fe78(6,"config_timer: 0->%d");
          }
        }
        puVar16 = DAT_0007d3bc;
        if (DAT_0007d3bc == (undefined4 *)0x0) {
LAB_0001f794:
                    /* WARNING: Subroutine does not return */
          exit((int)puVar16);
        }
        iVar12 = 0x1e;
        do {
          puVar16 = &uStack_22c;
          local_288.tv_usec = 0;
          do {
            puVar16 = puVar16 + 1;
            *puVar16 = 0;
          } while (puVar16 != local_228[0].fds_bits + 0x1f);
          iVar15 = DAT_000c9c98 + 0x1f;
          if (-1 < DAT_000c9c98) {
            iVar15 = DAT_000c9c98;
          }
          local_228[0].fds_bits[iVar15 >> 5] = local_228[0].fds_bits[iVar15 >> 5] | 1 << (DAT_000c9c98 % 0x20 & 0xffU);
          local_288.tv_sec = iVar12;
          local_28c = select(DAT_000c9c98 + 1,local_228,(fd_set *)0x0,(fd_set *)0x0,&local_288);
          if (local_28c == 0) break;
          if (0 < local_28c) {
            read(DAT_000c9c98,&local_28c,4);
            DAT_0007d3c4 = 0;
            break;
          }
          piVar18 = __errno_location();
          if (*piVar18 != 4) {
            pcVar19 = strerror(*piVar18);
            FUN_0004fe78(3,"ntp_intres: Error from select: %s",pcVar19);
            puVar16 = (undefined4 *)0x1;
            goto LAB_0001f794;
          }
          iVar12 = iVar12 + -1;
        } while (iVar12 != 0);
        if (0 < DAT_0007d3cc) {
          DAT_0007d3cc = DAT_0007d3cc + -1;
        }
        if (0 < DAT_0007d3c4) {
          DAT_0007d3c4 = DAT_0007d3c4 + -1;
        }
      } while( true );
    }
    p_Var27 = &local_288.tv_usec;
    ppcVar25 = local_280;
    pfVar14 = local_228;
    do {
      cVar22 = (char)pfVar14->fds_bits[0];
      if (cVar22 == '\t' || cVar22 == ' ') {
        do {
          pfVar14 = (fd_set *)((int)pfVar14->fds_bits + 1);
          cVar22 = (char)pfVar14->fds_bits[0];
        } while (cVar22 == ' ' || cVar22 == '\t');
      }
      if (cVar22 == '\n' || cVar22 == '\0') {
        FUN_0004fe78(3,"tokenizing error in file `%s\', quitting",pcVar19);
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      cVar22 = *(char *)((int)pfVar14->fds_bits + 1);
      pfVar21 = (fd_set *)((int)pfVar14->fds_bits + 1);
      if (cVar22 == ' ' || cVar22 == '\t') {
LAB_0001f438:
        if (cVar22 == '\n' || cVar22 == '\0') goto LAB_0001f618;
        *(undefined1 *)pfVar21->fds_bits = 0;
        pfVar21 = (fd_set *)((int)pfVar21->fds_bits + 1);
      }
      else {
        if ((cVar22 != '\n') && (cVar22 != '\0')) {
          pfVar11 = (fd_set *)((int)pfVar14->fds_bits + 2);
          do {
            pfVar21 = pfVar11;
            cVar22 = (char)pfVar21->fds_bits[0];
            if (cVar22 == '\t' || cVar22 == ' ') goto LAB_0001f438;
          } while ((cVar22 != '\n') && (pfVar11 = (fd_set *)((int)pfVar21->fds_bits + 1), cVar22 != '\0'));
        }
LAB_0001f618:
        *(undefined1 *)pfVar21->fds_bits = 0;
      }
      p_Var27 = p_Var27 + 1;
      *p_Var27 = (__suseconds_t)pfVar14;
      pfVar14 = pfVar21;
    } while ((char **)p_Var27 != local_280 + 10);
    iVar12 = 1;
    do {
      ppcVar25 = ppcVar25 + 1;
      pcVar26 = *ppcVar25;
      iVar15 = FUN_0004d1c0(pcVar26,auStack_254 + iVar12 * 4);
      uVar10 = local_230;
      uVar9 = local_234;
      uVar8 = local_23c;
      uVar7 = local_240;
      uVar6 = local_244;
      uVar5 = local_248;
      uVar4 = local_24c;
      uVar3 = local_250;
      __src = local_280[10];
      pcVar13 = local_280[0];
      if (iVar15 == 0) {
        FUN_0004fe78(3,"format error for integer token `%s\', file `%s\', quitting",pcVar26,pcVar19);
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      iVar12 = iVar12 + 1;
    } while (iVar12 != 10);
    if ((local_238 & 0x20) == 0) {
      bVar24 = 0;
    }
    else {
      bVar24 = 2;
    }
    if ((local_238 & 0x200) != 0) {
      bVar24 = bVar24 | 0x10;
    }
    if ((local_238 & 0x40) != 0) {
      bVar24 = bVar24 | 4;
    }
    if ((local_238 & 0x100) != 0) {
      bVar24 = bVar24 | 8;
    }
    if (1 < DAT_0007cf4c) {
      FUN_0004fe78(6,"intres: <%s> %d %d %d %d %d %d %x %d %x %s",local_280[0],local_250,local_24c,local_248,local_244,
                   local_240,local_23c,bVar24,local_234,local_230,local_280[10]);
    }
    puVar16 = (undefined4 *)FUN_0004f524(0xd4);
    uVar17 = FUN_0004f4e8(pcVar13);
    puVar16[1] = uVar17;
    puVar16[2] = 0;
    uVar2 = in6addr_any._12_4_;
    uVar1 = in6addr_any._8_4_;
    uVar17 = in6addr_any._4_4_;
    puVar16[0x28] = in6addr_any._0_4_;
    puVar16[0x29] = uVar17;
    puVar16[0x2a] = uVar1;
    puVar16[0x2b] = uVar2;
    memset(puVar16 + 0x2e,0,0x1c);
    *(char *)(puVar16 + 3) = (char)uVar5;
    *(char *)((int)puVar16 + 0xe) = (char)uVar7;
    *(char *)((int)puVar16 + 0xf) = (char)uVar8;
    *(char *)((int)puVar16 + 0xd) = (char)uVar6;
    puVar16[0x2c] = uVar3;
    puVar16[0x2d] = uVar4;
    *(char *)((int)puVar16 + 0x11) = (char)uVar9;
    *(byte *)(puVar16 + 4) = bVar24;
    puVar16[5] = uVar10;
    strncpy((char *)(puVar16 + 6),__src,0x7f);
    *(undefined1 *)((int)puVar16 + 0x97) = 0;
    *puVar16 = 0;
    puVar23 = DAT_0007d3bc;
    if (DAT_0007d3bc != (undefined4 *)0x0) {
      do {
        puVar20 = puVar23;
        puVar23 = (undefined4 *)*puVar20;
      } while (puVar23 != (undefined4 *)0x0);
      *puVar20 = puVar16;
      puVar16 = DAT_0007d3bc;
    }
  } while( true );
}




void FUN_0001f8f0(int param_1)

{
  undefined8 in_d0;
  
  if (1 < DAT_0007cf4c) {
    printf("local_clock: mu %lu state %d poll %d count %d\n",DAT_000cb548 - DAT_0007d3d0,param_1,(uint)DAT_000cabc8,
           DAT_000cabbc);
  }
  if ((param_1 != DAT_000cabb8) && (param_1 != 2)) {
    FUN_0001d3d8(param_1,0,0);
  }
  DAT_0007d3d8 = in_d0;
  DAT_000cabd0 = in_d0;
  DAT_000cabb8 = param_1;
  DAT_0007d3d0 = DAT_000cb548;
  return;
}




void FUN_0001f9e4(void)

{
  int iVar1;
  double in_d0;
  char acStack_68 [80];
  
  iVar1 = DAT_000cabd8;
  DAT_000caba8 = in_d0;
  if ((DAT_000cabd8 == 0) || (iVar1 = DAT_0007a198, DAT_0007a198 == 0)) {
    snprintf(acStack_68,0x50,"ntpd %.3f PPM",iVar1,in_d0 * 1000000.0);
    FUN_0001d3d8(2,0,acStack_68);
  }
  else {
    memset(&DAT_0007d568,0,0x80);
    DAT_0007d568 = 2;
    DAT_0007d570 = (undefined4)(longlong)(in_d0 * 65536000000.0);
    ntp_adjtime(&DAT_0007d568);
    snprintf(acStack_68,0x50,"kernel %.3f PPM");
    FUN_0001d3d8(2,0,acStack_68);
  }
  return;
}




/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 FUN_0001fae8(void)

{
  double in_d0;
  
  if ((DAT_000cabd8 != 0) && (DAT_0007a198 != 0)) {
    memset(&DAT_0007d568,0,0x80);
    ntp_adjtime(&DAT_0007d568);
    DAT_0007d3d8 = (double)(longlong)DAT_0007d56c / 1000000000.0;
    DAT_000caba8 = (double)(longlong)DAT_0007d570 / 65536000000.0;
  }
  FUN_0001f9e4(SUB84((in_d0 - DAT_0007d3d8) / (double)(uint)(DAT_000cb548 - DAT_0007d3d0) + DAT_000caba8,0));
  _DAT_000cb580 = 0;
  DAT_000cb584 = 0;
  return SUB84(DAT_000caba8,0);
}




void FUN_0001fbf0(void)

{
  DAT_000cabc8 = (char)DAT_0007a1c8;
  if ((char)DAT_000cb478 < 0) {
    DAT_000cabb0 = 1.0 / (double)(longlong)(1 << (-(int)(char)DAT_000cb478 & 0xffU));
  }
  else {
    DAT_000cabb0 = (double)(longlong)(1 << (uint)DAT_000cb478);
  }
  return;
}




/* WARNING: Removing unreachable block (ram,0x00020688) */
/* WARNING: Removing unreachable block (ram,0x00020674) */
/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x000200f0 */
/* WARNING: Heritage AFTER dead removal. Example location: r0x0007d57c : 0x000205d0 */
/* WARNING: Restarted to delay deadcode elimination for space: ram */
/* WARNING: Restarted to delay deadcode elimination for space: register */
/* WARNING: Exceeded maximum restarts with more pending */

undefined4 FUN_0001fc5c(int param_1)

{
  byte bVar1;
  int iVar2;
  uint uVar3;
  double *pdVar4;
  uint uVar5;
  undefined4 uVar6;
  uint uVar7;
  bool bVar8;
  undefined4 uVar9;
  double in_d0;
  double dVar10;
  double dVar11;
  double dVar12;
  double dVar13;
  double dVar14;
  char acStack_90 [84];
  
  dVar13 = DAT_0007d5f8;
  if (DAT_0007a19c == 0) {
    FUN_0002dcc8(DAT_000cabc8);
    return 0;
  }
  dVar11 = ABS(in_d0);
  if (((DAT_0007a1a0 < dVar11) && (0.0 < DAT_0007a1a0)) && (DAT_0007d5e8 == 0)) {
    snprintf(acStack_90,0x50,"%+.0f s; set clock manually within %.0f s.");
    FUN_0001d3d8(7,0,acStack_90);
    return 0xffffffff;
  }
  if (DAT_0007d5ec != 0) {
    if ((dVar11 <= DAT_0007a1a8) || (DAT_0007a1a8 <= 0.0)) {
      FUN_0004cce4();
      FUN_0004fe78(5,"ntpd: time slew %+.6f s");
      printf("ntpd: time slew %+.6fs\n");
    }
    else {
      FUN_0004cde0();
      FUN_0004fe78(5,"ntpd: time set %+.6f s");
      printf("ntpd: time set %+.6fs\n");
    }
    FUN_0002dcc8(DAT_000cabc8);
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  dVar12 = in_d0;
  if (DAT_0007d5f0 != 0) {
    dVar11 = *(double *)(param_1 + 0x1a0);
    pdVar4 = (double *)(DAT_0007d5f0 + DAT_0007d5f4 * 8);
    bVar8 = dVar11 < *pdVar4;
    if (bVar8) {
      *pdVar4 = dVar11;
    }
    if (bVar8) {
      dVar11 = *(double *)(param_1 + 0x1a0);
    }
    if (dVar11 < dVar13) {
      dVar13 = dVar11;
      DAT_0007d5f8 = dVar11;
    }
    if (0.0 < in_d0) {
      dVar12 = -((dVar11 - dVar13) * 0.5);
    }
    else {
      dVar12 = (dVar11 - dVar13) * 0.5;
    }
    dVar12 = in_d0 + dVar12;
    if (DAT_0007cf4c != 0) {
      printf("local_clock: size %d mindly %.6f huffpuff %.6f\n",DAT_0007d600,SUB84(dVar13,0),
             (int)((ulonglong)dVar13 >> 0x20));
    }
    dVar11 = ABS(dVar12);
  }
  dVar13 = DAT_000caba8;
  bVar1 = *(byte *)(param_1 + 0x31);
  uVar5 = (uint)bVar1;
  uVar7 = (uint)DAT_000cabc8;
  if (uVar5 <= uVar7) {
    uVar5 = uVar7;
    bVar1 = DAT_000cabc8;
  }
  DAT_000cabc8 = bVar1;
  if (*(byte *)(param_1 + 0x32) < uVar5) {
    DAT_000cabc8 = *(byte *)(param_1 + 0x32);
  }
  dVar10 = (double)(uint)(DAT_000cb548 - DAT_0007d3d0);
  uVar9 = SUB84(dVar12,0);
  if ((dVar11 <= DAT_0007a1a8) || (DAT_0007a1a8 <= 0.0)) {
    if ((char)DAT_000cb478 < 0) {
      dVar11 = 1.0 / (double)(longlong)(1 << (-(int)(char)DAT_000cb478 & 0xffU));
    }
    else {
      dVar11 = (double)(longlong)(1 << (uint)DAT_000cb478);
    }
    if (dVar11 < ABS(dVar12 - DAT_000cabd0)) {
      dVar11 = dVar12 - DAT_000cabd0;
    }
    dVar11 = SQRT(DAT_000cabb0 * DAT_000cabb0 + (dVar11 * dVar11 - DAT_000cabb0 * DAT_000cabb0) * 0.125);
    DAT_000cabb0 = dVar11;
    if (DAT_000cabb8 == 2) {
      FUN_0001f8f0(uVar9,5);
      uVar6 = 1;
    }
    else if (DAT_000cabb8 == 4) {
      if (dVar10 < DAT_0007a1b0) {
        return 0;
      }
      uVar6 = 1;
      FUN_0001fae8(uVar9);
      FUN_0001f8f0(0,5);
      dVar13 = dVar11;
    }
    else if (DAT_000cabb8 == 1) {
      FUN_0001f8f0(uVar9,4);
      uVar6 = 1;
    }
    else {
      uVar5 = (uint)DAT_000cabc8;
      DAT_0007d5e8 = 0;
      if (uVar5 < DAT_0007a1b8) {
        dVar11 = (double)(longlong)(1 << uVar5);
      }
      else {
        dVar11 = (double)(longlong)(1 << uVar5);
        dVar13 = dVar10;
        if (dVar10 < dVar11) {
          dVar13 = dVar11;
        }
        dVar13 = DAT_000caba8 +
                 ((dVar12 - (double)CONCAT44(DAT_0007d3d8._4_4_,(undefined4)DAT_0007d3d8)) / dVar13) * 0.25;
      }
      uVar6 = 1;
      dVar14 = (double)(longlong)(1 << (uint)DAT_0007a1b8);
      if (dVar14 < dVar10) {
        dVar10 = dVar14;
      }
      FUN_0001f8f0(uVar9,5);
      dVar13 = dVar13 + (dVar12 * dVar10) / (dVar11 * 64.0 * dVar11 * 64.0);
    }
  }
  else {
    if (DAT_000cabb8 == 4) {
      if (dVar10 < DAT_0007a1b0) {
        return 0;
      }
      FUN_0001fae8(uVar9);
      dVar13 = (double)CONCAT44((int)((ulonglong)in_d0 >> 0x20),uVar9);
LAB_00020324:
      if (dVar10 < DAT_0007a1b0) {
        return 0;
      }
    }
    else {
      if (DAT_000cabb8 == 5) {
        snprintf(acStack_90,0x50,"%+.6f s");
        FUN_0001d3d8(3,0,acStack_90);
        DAT_000cabb8 = 3;
        return 0;
      }
      if (DAT_000cabb8 == 3) goto LAB_00020324;
    }
    snprintf(acStack_90,0x50,"%+.6f s");
    FUN_0001d3d8(0xc,0,acStack_90);
    FUN_0004cde0(uVar9);
    FUN_0002d284();
    DAT_000cabbc = 0;
    if ((char)DAT_000cb478 < 0) {
      DAT_000cabb0 = 1.0 / (double)(longlong)(1 << (-(int)(char)DAT_000cb478 & 0xffU));
    }
    else {
      DAT_000cabb0 = (double)(longlong)(1 << (uint)DAT_000cb478);
    }
    if ((DAT_000cabb8 == 1) || ((double)(uint)(DAT_000cb548 - DAT_0007d604) < DAT_0007a1b0 + DAT_0007a1b0)) {
      FUN_0001f8f0(0,4);
      return 2;
    }
    DAT_0007d604 = DAT_000cb548;
    uVar6 = 2;
    FUN_0001f8f0(0,5);
  }
  if ((DAT_000cabd8 != 0) && (DAT_0007a198 != 0)) {
    memset(&DAT_0007d568,0,0x80);
    if (DAT_000cab98 == 0) {
      dVar13 = 0.5;
      DAT_0007d580 = (uint)DAT_000cabc8;
      DAT_0007d568 = 0x203d;
      DAT_0007d57c = 1;
      if ((double)CONCAT44(DAT_0007d3d8._4_4_,(undefined4)DAT_0007d3d8) < 0.0) {
        dVar13 = -0.5;
      }
      dVar11 = (DAT_000cb498 + DAT_000cb4b8 * 0.5) * 1000000.0;
      DAT_0007d56c = (undefined4)
                     (longlong)(dVar13 + (double)CONCAT44(DAT_0007d3d8._4_4_,(undefined4)DAT_0007d3d8) * 1000000000.0);
      DAT_0007d574 = (uint)(0.0 < dVar11) * (int)(longlong)dVar11;
      DAT_0007d578 = (uint)(0.0 < DAT_000cabb0 * 1000000.0) * (int)(longlong)(DAT_000cabb0 * 1000000.0);
      if (DAT_000cabc4 == 0) {
        uVar5 = 1;
        if ((DAT_000cabc0 & 4) != 0) {
          FUN_0001d3d8(0xd,0,"PPS disabled");
          uVar5 = DAT_0007d57c & 0xfffffff9;
        }
      }
      else if ((DAT_000cabc0 & 4) == 0) {
        FUN_0001d3d8(0xd,0,"PPS enabled");
        uVar5 = DAT_0007d57c | 6;
      }
      else {
        uVar5 = 7;
      }
      DAT_0007d57c = uVar5;
      if (DAT_000cb4b0 == '\x01') {
        DAT_0007d57c = DAT_0007d57c | 0x10;
      }
      else if (DAT_000cb4b0 == '\x02') {
        DAT_0007d57c = DAT_0007d57c | 0x20;
      }
    }
    else {
      DAT_0007d568 = 0x10;
    }
    iVar2 = ntp_adjtime(&DAT_0007d568);
    if ((iVar2 == 5) && ((DAT_0007d57c & 0x100) == 0)) {
      FUN_0001d3d8(0xd,0,"PPS no signal");
    }
    bVar8 = (DAT_0007d57c & 4) != 0;
    iVar2 = DAT_0007d570;
    if (bVar8) {
      iVar2 = DAT_0007d59c;
    }
    dVar13 = (double)(longlong)DAT_0007d570 / 65536000000.0;
    if (bVar8) {
      DAT_000cabb0 = (double)(longlong)iVar2 / 1000000000.0;
    }
    DAT_000cabc0 = DAT_0007d57c;
    if (DAT_0007d608 != DAT_000cabcc) {
      DAT_0007d608 = DAT_000cabcc;
      DAT_0007d580 = DAT_000cabcc;
      DAT_0007d568 = 0x80;
      ntp_adjtime(&DAT_0007d568);
    }
  }
  if (0.0005 < ABS(dVar13)) {
    FUN_0004fe78(5,"frequency error %.0f PPM exceeds tolerance %.0f PPM",SUB84(dVar13 * 1000000.0,0),
                 (int)((ulonglong)(dVar13 * 1000000.0) >> 0x20));
  }
  dVar11 = dVar13 - DAT_000caba8;
  if (0.0005 < dVar13) {
    DAT_000caba8 = 0.0005;
  }
  else {
    DAT_000caba8 = dVar13;
    if (dVar13 < -0.0005) {
      DAT_000caba8 = -0.0005;
    }
  }
  DAT_000caba0 = SQRT(DAT_000caba0 * DAT_000caba0 + (dVar11 * dVar11 - DAT_000caba0 * DAT_000caba0) * 0.125);
  dVar13 = (double)CONCAT44(DAT_0007d3d8._4_4_,(undefined4)DAT_0007d3d8);
  DAT_000cb58c = 1;
  uVar5 = (uint)DAT_000cabc8;
  if (DAT_000cabb0 * 4.0 <= ABS(dVar13)) {
    DAT_000cabbc = DAT_000cabbc + uVar5 * -2;
    if ((DAT_000cabbc + 0x1e < 0 == SCARRY4(DAT_000cabbc,0x1e)) ||
       (DAT_000cabbc = -0x1e, uVar5 <= *(byte *)(param_1 + 0x31))) goto LAB_000200c0;
    uVar3 = uVar5 - 1;
  }
  else {
    DAT_000cabbc = uVar5 + DAT_000cabbc;
    if ((DAT_000cabbc < 0x1f) || (DAT_000cabbc = 0x1e, *(byte *)(param_1 + 0x32) <= uVar5)) goto LAB_000200c0;
    uVar3 = uVar5 + 1;
  }
  uVar5 = uVar3 & 0xff;
  DAT_000cabc8 = (byte)uVar3;
  DAT_000cabbc = 0;
LAB_000200c0:
  if (uVar7 != uVar5) {
    FUN_00022f68(param_1);
    uVar5 = (uint)DAT_000cabc8;
    dVar13 = (double)CONCAT44(DAT_0007d3d8._4_4_,(undefined4)DAT_0007d3d8);
  }
  FUN_0002dcc8(SUB84(dVar13,0),(int)((ulonglong)dVar13 >> 0x20),SUB84(DAT_000caba8,0),
               (int)((ulonglong)DAT_000caba8 >> 0x20),SUB84(DAT_000cabb0,0),(int)((ulonglong)DAT_000cabb0 >> 0x20),
               SUB84(DAT_000caba0,0),uVar5);
  if (DAT_0007cf4c != 0) {
    printf("local_clock: offset %.9f jit %.9f freq %.3f stab %.3f poll %d\n",(uint)DAT_000cabc8,(undefined4)DAT_0007d3d8
           ,DAT_0007d3d8._4_4_);
  }
  return uVar6;
}




void FUN_00020730(void)

{
  double dVar1;
  
  DAT_000cb498 = DAT_000cb498 + DAT_0007a1c0;
  if (DAT_0007a19c == 0) {
    return;
  }
  if (DAT_0007d5ec != 0) {
    return;
  }
  if ((DAT_000cabd8 != 0) && (DAT_0007a198 != 0)) {
    return;
  }
  dVar1 = DAT_0007d3d8 / ((double)(longlong)(1 << (uint)DAT_000cabc8) * 16.0);
  DAT_0007d3d8 = DAT_0007d3d8 - dVar1;
  FUN_0004cce4(SUB84(dVar1 + DAT_000caba8,0));
  return;
}




void FUN_000207d8(void)

{
  int iVar1;
  int extraout_r1;
  double *pdVar2;
  double *pdVar3;
  double dVar4;
  double dVar5;
  
  iVar1 = DAT_0007d600;
  pdVar3 = DAT_0007d5f0;
  if (DAT_0007d5f0 == (double *)0x0) {
    return;
  }
  FUN_0005aa04(DAT_0007d5f4 + 1,DAT_0007d600);
  dVar4 = 1000000000.0;
  DAT_0007d5f8 = 1000000000.0;
  DAT_0007d5f4 = extraout_r1;
  pdVar3[extraout_r1] = 1000000000.0;
  if (iVar1 < 1) {
    return;
  }
  pdVar2 = pdVar3 + iVar1;
  do {
    dVar5 = *pdVar3;
    pdVar3 = pdVar3 + 1;
    if (dVar5 < dVar4) {
      dVar4 = dVar5;
    }
  } while (pdVar3 != pdVar2);
  DAT_0007d5f8 = dVar4;
  return;
}




void FUN_00020854(undefined4 param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar4;
  int iVar5;
  double in_d0;
  undefined4 *puVar3;
  
  if (1 < DAT_0007cf4c) {
    printf("loop_config: item %d freq %f\n",param_1);
  }
  iVar5 = DAT_0007d5ec;
  switch(param_1) {
  case 1:
    if (DAT_0007d5ec == 0) {
      DAT_000cabd8 = 1;
      memset(&DAT_0007d568,0,0x80);
      DAT_0007d580 = (uint)DAT_000cabc8;
      DAT_0007d57c = 1;
      DAT_0007d690 = iVar5;
      DAT_0007d568 = 0x3d;
      DAT_0007d60c = &DAT_0001f9c0;
      DAT_0007d574 = 0x10;
      DAT_0007d578 = 0x10;
      iVar1 = sigaction(0x1f,(sigaction *)&DAT_0007d60c,(sigaction *)&DAT_0007d698);
      if (iVar1 != 0) {
        FUN_0004fe78(3,"sigaction() fails to save SIGSYS trap: %m");
        DAT_000cabd8 = iVar5;
      }
      iVar5 = __sigsetjmp(&DAT_0007d3e0,1);
      if (iVar5 == 0) {
        ntp_adjtime(&DAT_0007d568);
      }
      iVar5 = sigaction(0x1f,(sigaction *)&DAT_0007d698,(sigaction *)0x0);
      if (iVar5 == 0) {
        DAT_000cabc0 = DAT_0007d57c;
        if (DAT_000cabd8 != 0) {
          if ((DAT_0007d57c & 0x8000) != 0) {
            DAT_000cab98 = 1;
          }
          FUN_0001d3d8(0xd,0,"kernel time sync enabled");
        }
      }
      else {
        FUN_0004fe78(3,"sigaction() fails to restore SIGSYS trap: %m");
        DAT_000cabc0 = DAT_0007d57c;
        DAT_000cabd8 = 0;
      }
    }
    break;
  case 2:
    if ((0.0005 < in_d0) || (in_d0 < -0.0005)) {
      FUN_0001f9e4(0);
      FUN_0001f8f0(0,1);
    }
    else {
      FUN_0001f9e4();
      FUN_0001f8f0(0,2);
    }
    break;
  case 3:
    DAT_0007a1a8 = in_d0;
    if ((in_d0 == 0.0) || (0.5 < in_d0)) {
      DAT_0007a198 = 0;
    }
    break;
  case 4:
    DAT_0007a1a0 = in_d0;
    break;
  case 5:
    DAT_0007a1c0 = in_d0 / 1000000.0;
    break;
  case 6:
    DAT_0007a1b0 = in_d0;
    break;
  default:
    FUN_0004fe78(5,"loop_config: unsupported option %d",param_1);
    break;
  case 8:
    DAT_0007a1b8 = (0.0 < in_d0) * (char)(longlong)in_d0;
    break;
  case 9:
    if (in_d0 < 900.0) {
      in_d0 = 900.0;
    }
    DAT_0007d600 = (int)(longlong)(in_d0 / 900.0);
    DAT_0007d5f0 = (undefined4 *)FUN_0004f524(DAT_0007d600 << 3);
    if (0 < DAT_0007d600) {
      puVar4 = DAT_0007d5f0 + DAT_0007d600 * 2;
      puVar2 = DAT_0007d5f0;
      do {
        puVar3 = puVar2 + 2;
        *puVar2 = 0;
        puVar2[1] = 0x41cdcd65;
        puVar2 = puVar3;
      } while (puVar3 != puVar4);
    }
    DAT_0007d5f8._0_4_ = 0;
    DAT_0007d5f8._4_4_ = 0x41cdcd65;
    break;
  case 10:
    FUN_0001f9e4(SUB84(in_d0 / 1000000.0,0));
    FUN_0001f8f0(0,2);
    break;
  case 0xb:
    if ((DAT_000cabd8 != 0) && (DAT_0007a198 != 0)) {
      memset(&DAT_0007d568,0,0x80);
      DAT_0007d568 = 0x10;
      DAT_0007d57c = 0x40;
      ntp_adjtime(&DAT_0007d568);
      FUN_0001d3d8(0xd,0,"kernel time sync disabledx");
    }
    break;
  case 0xc:
    DAT_000cab90 = in_d0 / 1000000.0;
  }
  return;
}




void FUN_00020c80(undefined4 *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  
  iVar1 = FUN_0002e254(param_1 + 8);
  puVar2 = (undefined4 *)(&DAT_0007d728)[iVar1];
  if (puVar2 == param_1) {
    (&DAT_0007d728)[iVar1] = *puVar2;
    return;
  }
  do {
    puVar3 = (undefined4 *)*puVar2;
    if (puVar3 == param_1) {
      *puVar2 = *param_1;
      return;
    }
    puVar2 = puVar3;
  } while (puVar3 != (undefined4 *)0x0);
  return;
}




void FUN_00020cd0(void)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int *piVar4;
  
  piVar2 = (int *)FUN_0004f524(0xb40);
  iVar1 = (int)DAT_0007d928;
  piVar3 = piVar2;
  DAT_0007d928 = piVar2;
  do {
    piVar4 = piVar3 + 0x12;
    *piVar3 = (int)piVar4;
    piVar3 = piVar4;
  } while (piVar4 != piVar2 + 0x2be);
  piVar2[0x2be] = iVar1;
  DAT_0007d92c = DAT_0007d92c + 0x28;
  DAT_0007d930 = DAT_0007d930 + 1;
  return;
}




void FUN_00020d28(void)

{
  DAT_0007d934 = 0;
  DAT_0007d92c = 0;
  DAT_0007d930 = 0;
  DAT_0007d928 = 0;
  DAT_000cac24 = 0;
  memset(&DAT_0007d728,0,0x200);
  memset(&DAT_000cabdc,0,0x48);
  return;
}




void FUN_00020d7c(uint param_1)

{
  if (DAT_000cac24 == 0) {
    if (param_1 != 0) {
      if (DAT_0007d934 == 0) {
        DAT_0007d92c = 0;
        DAT_0007d930 = 0;
        DAT_0007d928 = 0;
        FUN_00020cd0();
        DAT_0007d934 = 1;
      }
      DAT_000cabe0 = &DAT_000cabdc;
      DAT_000cabe4 = &DAT_000cabdc;
      DAT_000cac24 = param_1;
    }
  }
  else {
    DAT_000cac24 = param_1 | DAT_000cac24;
  }
  return;
}




void FUN_00020e9c(int param_1)

{
  undefined4 *puVar1;
  int iVar2;
  undefined4 *puVar3;
  
  puVar3 = DAT_000cabe0;
  if (DAT_000cabe0 != (undefined4 *)&DAT_000cabdc) {
    do {
      if (puVar3[0xf] == param_1) {
        iVar2 = puVar3[2];
        *(undefined4 *)(iVar2 + 4) = puVar3[1];
        *(int *)(puVar3[1] + 8) = iVar2;
        FUN_00020c80(puVar3);
        puVar1 = puVar3;
        *puVar3 = DAT_0007d928;
        DAT_0007d928 = puVar1;
      }
      puVar1 = puVar3 + 1;
      puVar3 = (undefined4 *)*puVar1;
    } while ((undefined4 *)*puVar1 != (undefined4 *)&DAT_000cabdc);
    return;
  }
  return;
}




uint FUN_00020f08(int param_1,uint param_2)

{
  undefined4 *puVar1;
  undefined2 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined1 uVar6;
  int iVar7;
  int *piVar8;
  int iVar9;
  uint uVar10;
  byte bVar11;
  bool bVar12;
  uint local_44;
  int local_40;
  int iStack_3c;
  int iStack_38;
  int local_34;
  int iStack_30;
  int local_2c;
  
  if (DAT_000cac24 == 0) {
    return param_2;
  }
  local_44 = *(uint *)(param_1 + 8);
  local_40 = *(int *)(param_1 + 0xc);
  iStack_3c = *(int *)(param_1 + 0x10);
  iStack_38 = *(int *)(param_1 + 0x14);
  local_34 = *(int *)(param_1 + 0x18);
  iStack_30 = *(int *)(param_1 + 0x1c);
  local_2c = *(int *)(param_1 + 0x20);
  iVar3 = FUN_0002e254(&local_44);
  iVar5 = local_2c;
  iVar7 = local_40;
  bVar11 = *(byte *)(param_1 + 0x5c) & 7;
  piVar8 = (int *)(&DAT_0007d728)[iVar3];
  if (piVar8 != (int *)0x0) {
    uVar10 = local_44 & 0xffff;
    do {
      if (*(ushort *)(piVar8 + 8) == uVar10) {
        if (uVar10 == 2) {
          bVar12 = piVar8[9] == iVar7;
        }
        else {
          iVar4 = memcmp(piVar8 + 10,&iStack_3c,0x10);
          if (iVar4 != 0) goto LAB_00020f84;
          bVar12 = piVar8[0xe] == iVar5;
        }
        iVar4 = DAT_000cb548;
        if (bVar12) {
          piVar8[3] = param_2;
          piVar8[5] = piVar8[5] + 1;
          iVar9 = iVar4 - piVar8[7];
          iVar3 = piVar8[1];
          piVar8[7] = iVar4;
          uVar2 = *(undefined2 *)(param_1 + 10);
          *(byte *)((int)piVar8 + 0x42) = bVar11;
          *(undefined2 *)(piVar8 + 0x10) = uVar2;
          bVar11 = *(byte *)(param_1 + 0x5c);
          *(int *)(iVar3 + 8) = piVar8[2];
          iVar5 = piVar8[2];
          iVar7 = piVar8[4];
          piVar8[2] = (int)&DAT_000cabdc;
          *(int *)(iVar5 + 4) = iVar3;
          iVar5 = (int)DAT_000cabe0;
          iVar7 = iVar7 - iVar9;
          piVar8[4] = iVar7;
          if (iVar7 < 0) {
            iVar7 = 0;
            piVar8[4] = 0;
          }
          piVar8[1] = iVar5;
          puVar1 = (undefined4 *)((int)DAT_000cabe0 + 8);
          DAT_000cabe0 = piVar8;
          *puVar1 = piVar8;
          iVar4 = DAT_0007cf4c;
          iVar3 = 1 << (DAT_0007a1c8 & 0xff);
          *(byte *)((int)piVar8 + 0x43) = (byte)(((uint)bVar11 << 0x1a) >> 0x1d);
          iVar7 = iVar3 + iVar7;
          iVar5 = iVar3 * 8;
          if (1 < iVar4) {
            printf("restrict: interval %d headway %d limit %d\n",iVar9,iVar7,iVar5);
          }
          if ((1 << (DAT_0007a1cc & 0xff) <= iVar9 + 1) && (iVar7 + iVar3 * -8 < 0 != SBORROW4(iVar7,iVar5))) {
            uVar10 = piVar8[3];
            piVar8[4] = iVar7 + -2;
            piVar8[3] = uVar10 & 0xfffffbdf;
            return uVar10 & 0xfffffbdf;
          }
          if (iVar5 <= piVar8[4]) {
            uVar10 = piVar8[3];
            piVar8[3] = uVar10 & 0xfffffbff;
            return uVar10 & 0xfffffbff;
          }
          piVar8[4] = iVar3 * 9;
          return piVar8[3];
        }
      }
LAB_00020f84:
      piVar8 = (int *)*piVar8;
    } while (piVar8 != (int *)0x0);
  }
  piVar8 = DAT_000cabe4;
  if (DAT_0007d928 == (int *)0x0) {
    if (599 < DAT_0007d92c) {
      iVar7 = FUN_000504ec();
      if ((double)(uint)(DAT_000cb548 - piVar8[7]) / (double)(longlong)DAT_0007a1d0 <
          (double)(longlong)iVar7 * 1.1641532182693481e-10) {
        return param_2 & 0xfffffbdf;
      }
      DAT_000cabe4 = (int *)piVar8[2];
      DAT_000cabe4[1] = (int)&DAT_000cabdc;
      FUN_00020c80(piVar8);
      goto LAB_00021120;
    }
    FUN_00020cd0();
  }
  piVar8 = DAT_0007d928;
  DAT_0007d928 = (int *)*piVar8;
LAB_00021120:
  iVar7 = DAT_000cb548;
  piVar8[4] = 0;
  piVar8[6] = iVar7;
  piVar8[7] = iVar7;
  piVar8[5] = 1;
  piVar8[3] = param_2 & 0xfffffbdf;
  memset(piVar8 + 8,0,0x1c);
  piVar8[8] = local_44;
  piVar8[9] = local_40;
  piVar8[10] = iStack_3c;
  piVar8[0xb] = iStack_38;
  piVar8[0xc] = local_34;
  piVar8[0xd] = iStack_30;
  piVar8[0xe] = local_2c;
  uVar2 = *(undefined2 *)(param_1 + 10);
  *(byte *)((int)piVar8 + 0x42) = bVar11;
  *(undefined2 *)(piVar8 + 0x10) = uVar2;
  *(byte *)((int)piVar8 + 0x43) = (byte)(((uint)*(byte *)(param_1 + 0x5c) << 0x1a) >> 0x1d);
  iVar5 = *(int *)(param_1 + 0x40);
  uVar10 = *(uint *)(iVar5 + 0x8c);
  piVar8[0xf] = iVar5;
  iVar7 = (int)DAT_000cabe0;
  if (((uVar10 & 0x40) == 0) || (*(int *)(param_1 + 0x44) != *(int *)(iVar5 + 8))) {
    if (*(int *)(iVar5 + 0xc) == *(int *)(param_1 + 0x44)) {
      uVar6 = 4;
    }
    else {
      uVar6 = 1;
    }
  }
  else {
    uVar6 = 2;
  }
  *(undefined1 *)(piVar8 + 0x11) = uVar6;
  uVar10 = piVar8[3];
  *piVar8 = (&DAT_0007d728)[iVar3];
  (&DAT_0007d728)[iVar3] = piVar8;
  piVar8[1] = iVar7;
  piVar8[2] = (int)&DAT_000cabdc;
  puVar1 = (undefined4 *)((int)DAT_000cabe0 + 8);
  DAT_000cabe0 = piVar8;
  *puVar1 = piVar8;
  return uVar10;
}




char FUN_000212a0(int param_1)

{
  uint uVar1;
  char cVar2;
  
  uVar1 = *(uint *)(param_1 + 0x6c);
  cVar2 = (uVar1 & 0x200) == 0;
  if ((uVar1 & 0x1000) == 0) {
    cVar2 = cVar2 + '\x01';
  }
  if ((uVar1 & 0x800) == 0) {
    cVar2 = cVar2 + '\x01';
  }
  if ((uVar1 & 0x400) == 0) {
    cVar2 = cVar2 + '\x01';
  }
  if ((*(byte *)(param_1 + 0x68) < 3) || (cVar2 = cVar2 + '\x01', *(byte *)(param_1 + 0x68) != 5)) {
    cVar2 = cVar2 + '\x01';
  }
  return cVar2;
}




int FUN_000212ec(short *param_1,int param_2,uint param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  
  iVar4 = DAT_000ca644;
  if ((*param_1 == 2) &&
     (iVar3 = DAT_000ca61c, iVar4 = DAT_000ca608,
     (*(uint *)(param_1 + 2) << 0x18 | (*(uint *)(param_1 + 2) >> 8 & 0xff) << 0x10) == 0x7f7f0000)) {
LAB_0002131c:
    if (iVar3 != iVar4) goto LAB_00021324;
  }
  else {
    if ((param_3 & 0x36) != 0) {
      iVar3 = FUN_00015c78(param_1);
      if (iVar3 == 0) {
        if (3 < DAT_0007cf4c) {
          uVar1 = FUN_00050cd0(param_1);
          printf("No *-cast local address found for address %s\n",uVar1);
        }
      }
      else if (3 < DAT_0007cf4c) {
        uVar1 = FUN_00050cd0(iVar3 + 0x14);
        uVar2 = FUN_00050cd0(param_1);
        printf("Found *-cast interface %s for address %s\n",uVar1,uVar2);
      }
      goto LAB_0002131c;
    }
    iVar3 = param_2;
    if (param_2 != 0) goto LAB_0002131c;
  }
  iVar3 = FUN_00015bd4(param_1);
LAB_00021324:
  if ((iVar3 != 0) && ((*(uint *)(iVar3 + 0x8c) & 0x80) != 0)) {
    iVar3 = 0;
  }
  return iVar3;
}




void FUN_00021400(void)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  memset(&DAT_000cb23c,0,0x200);
  memset(&DAT_000cae34,0,0x200);
  memset(&DAT_000cb03c,0,0x200);
  memset(&DAT_000cac34,0,0x200);
  iVar1 = 0;
  DAT_0007d938 = (undefined4 *)0x0;
  DAT_000cb038 = 0;
  DAT_000cb43c = 0;
  DAT_000cb448 = 0;
  DAT_000cac2c = 0;
  iVar2 = 0;
  do {
    iVar3 = iVar2 + 1;
    *(undefined4 **)((int)&DAT_0007d940 + iVar1) = DAT_0007d938;
    iVar1 = iVar1 + 0x240;
    DAT_0007d938 = &DAT_0007d940 + iVar2 * 0x90;
    iVar2 = iVar3;
  } while (iVar3 != 0xf);
  DAT_000cac30 = 0xf;
  DAT_000cb440 = 0xf;
  do {
    DAT_0007fb00 = FUN_000504ec();
  } while (DAT_0007fb00 == 0);
  return;
}




int * FUN_00021500(short *param_1,int *param_2,uint param_3,uint param_4)

{
  short sVar1;
  int iVar2;
  bool bVar3;
  
  if (param_2 == (int *)0x0) {
    iVar2 = FUN_0002e254();
    param_2 = (int *)(&DAT_000cb23c)[iVar2];
  }
  else {
    param_2 = (int *)*param_2;
  }
  if (param_2 != (int *)0x0) {
    sVar1 = param_1[1];
    do {
      if ((*(short *)((int)param_2 + 0xe) == sVar1) && ((short)param_2[3] == *param_1)) {
        if ((short)param_2[3] == 2) {
          bVar3 = *(int *)(param_1 + 2) == param_2[4];
        }
        else {
          iVar2 = memcmp(param_1 + 4,param_2 + 5,0x10);
          if (iVar2 != 0) goto LAB_00021538;
          bVar3 = *(int *)(param_1 + 0xc) == param_2[9];
        }
        if (bVar3) {
          if (param_3 == 0xffffffff) {
            return param_2;
          }
          if (*(byte *)((int)param_2 + 0x2f) == param_3) {
            return param_2;
          }
          if (((*(byte *)(param_2 + 0xe) & 0x20) != 0) && ((param_4 & 0x20) != 0)) {
            return param_2;
          }
        }
      }
LAB_00021538:
      param_2 = (int *)*param_2;
    } while (param_2 != (int *)0x0);
  }
  return param_2;
}




int FUN_00021604(uint param_1)

{
  int iVar1;
  
  iVar1 = (&DAT_000cb03c)[param_1 & 0x7f];
  DAT_000cac2c = DAT_000cac2c + 1;
  for (; (iVar1 != 0 && (*(ushort *)(iVar1 + 0x2c) != param_1)); iVar1 = *(int *)(iVar1 + 4)) {
  }
  return iVar1;
}




void FUN_00021654(void)

{
  int *piVar1;
  int *piVar2;
  int *piVar3;
  
  piVar3 = (int *)&DAT_000cb238;
  do {
    piVar3 = piVar3 + 1;
    piVar1 = (int *)*piVar3;
    while (piVar2 = piVar1, piVar1 != (int *)0x0) {
      while (piVar1 = (int *)*piVar2, (*(byte *)(piVar2 + 0xe) & 0x16) == 0) {
        FUN_0002310c(piVar2,&DAT_00064a20);
        piVar2 = piVar1;
        if (piVar1 == (int *)0x0) goto LAB_00021698;
      }
    }
LAB_00021698:
    if (piVar3 == (int *)&DAT_000cb438) {
      if (DAT_0007cf4c != 0) {
        printf("clear_all: at %lu\n",DAT_000cb548);
        return;
      }
      return;
    }
  } while( true );
}




int FUN_000216d8(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  int *piVar6;
  
  iVar2 = FUN_000212a0();
  piVar6 = (int *)&DAT_000cb238;
  iVar5 = 100;
  do {
    piVar6 = piVar6 + 1;
    piVar1 = (int *)*piVar6;
    while (piVar1 != (int *)0x0) {
      piVar4 = (int *)*piVar1;
      iVar3 = FUN_000212a0(piVar1);
      piVar1 = piVar4;
      if ((iVar3 < iVar5) && ((*(uint *)(param_1 + 0x34) & 2) != 0)) {
        iVar5 = iVar3;
      }
    }
  } while (piVar6 != (int *)&DAT_000cb438);
  if (DAT_0007cf4c != 0) {
    printf("score_all: at %lu score %d min %d\n",DAT_000cb548,iVar2,iVar5,param_4);
  }
  if (iVar2 != iVar5) {
    iVar5 = 0;
  }
  return iVar5;
}




void FUN_00021778(int param_1,int param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  char *pcVar3;
  int iVar4;
  int *piVar5;
  int iVar6;
  
  iVar6 = *(int *)(param_1 + 0x28);
  if ((iVar6 != param_2) &&
     ((((param_2 == 0 || ((*(uint *)(param_1 + 0x34) & 0x10) == 0)) || ((*(uint *)(param_2 + 0x8c) & 0x100) == 0)) ||
      (*(char *)(param_1 + 0x2f) != '\x03')))) {
    if (iVar6 != 0) {
      iVar4 = *(int *)(iVar6 + 0xb4);
      *(int *)(iVar6 + 0xb8) = *(int *)(iVar6 + 0xb8) + -1;
      if (iVar4 == param_1) {
        piVar5 = (int *)(iVar6 + 0xb4);
LAB_00021804:
        iVar6 = *piVar5;
        *piVar5 = *(int *)(iVar6 + 8);
        *(undefined4 *)(iVar6 + 8) = 0;
      }
      else if (iVar4 != 0) {
        for (iVar6 = *(int *)(iVar4 + 8); iVar6 != 0; iVar6 = *(int *)(iVar6 + 8)) {
          if (iVar6 == param_1) {
            piVar5 = (int *)(iVar4 + 8);
            goto LAB_00021804;
          }
          if (iVar6 == 0) break;
          iVar4 = iVar6;
        }
      }
      uVar1 = FUN_00050cd0(param_1 + 0xc);
      uVar2 = FUN_00050cd0(*(int *)(param_1 + 0x28) + 0x14);
      if (param_2 == 0) {
        pcVar3 = "(none)";
      }
      else {
        pcVar3 = (char *)FUN_00050cd0(param_2 + 0x14);
      }
      FUN_0004fe78(6,"%s interface %s -> %s",uVar1,uVar2,pcVar3);
    }
    *(int *)(param_1 + 0x28) = param_2;
    if (param_2 != 0) {
      iVar6 = *(int *)(param_2 + 0xb8);
      *(undefined4 *)(param_1 + 8) = *(undefined4 *)(param_2 + 0xb4);
      *(int *)(param_2 + 0xb4) = param_1;
      *(int *)(param_2 + 0xb8) = iVar6 + 1;
    }
  }
  return;
}




void FUN_000218bc(int *param_1)

{
  int iVar1;
  undefined4 uVar2;
  int *piVar3;
  int *piVar4;
  uint uVar5;
  int *piVar6;
  char acStack_68 [80];
  
  piVar6 = param_1 + 3;
  snprintf(acStack_68,0x50,"assoc %d",(uint)*(ushort *)(param_1 + 0xb));
  FUN_0001d3d8(0x82,param_1,acStack_68);
  FUN_00021778(param_1,0);
  iVar1 = FUN_0002e254(piVar6);
  uVar5 = param_1[0xd];
  DAT_000cb448 = DAT_000cb448 + 1;
  (&DAT_000cae34)[iVar1] = (&DAT_000cae34)[iVar1] + -1;
  DAT_000cac28 = DAT_000cac28 + -1;
  if ((uVar5 & 2) != 0) {
    DAT_000cb444 = DAT_000cb444 + -1;
  }
  if ((uVar5 & 8) != 0) {
    FUN_00027130(param_1);
  }
  param_1[0x84] = 0;
  piVar3 = (int *)(&DAT_000cb23c)[iVar1];
  if ((int *)(&DAT_000cb23c)[iVar1] == param_1) {
    piVar4 = &DAT_000cb23c + iVar1;
    piVar3 = param_1;
  }
  else {
    do {
      piVar4 = piVar3;
      if ((piVar4 == (int *)0x0) || (*piVar4 == 0)) {
        (&DAT_000cae34)[iVar1] = (&DAT_000cae34)[iVar1] + 1;
        uVar2 = FUN_00050cd0(piVar6);
        FUN_0004fe78(3,"peer struct for %s not in table!",uVar2);
        goto LAB_000219c0;
      }
      piVar3 = (int *)*piVar4;
    } while (piVar3 != param_1);
  }
  *piVar4 = *piVar3;
  *piVar3 = 0;
LAB_000219c0:
  uVar5 = *(ushort *)(param_1 + 0xb) & 0x7f;
  piVar3 = (int *)(&DAT_000cb03c)[uVar5];
  iVar1 = *(int *)(&DAT_000cac34 + uVar5 * 4);
  *(int *)(&DAT_000cac34 + uVar5 * 4) = iVar1 + -1;
  if (piVar3 == param_1) {
    piVar3 = &DAT_000cb03c + uVar5;
LAB_00021a24:
    iVar1 = *piVar3;
    *piVar3 = *(int *)(iVar1 + 4);
    *(undefined4 *)(iVar1 + 4) = 0;
  }
  else {
    if (piVar3 != (int *)0x0) {
      for (piVar4 = (int *)piVar3[1]; piVar4 != (int *)0x0; piVar4 = (int *)piVar4[1]) {
        if (param_1 == piVar4) {
          piVar3 = piVar3 + 1;
          goto LAB_00021a24;
        }
        if (piVar4 == (int *)0x0) break;
        piVar3 = piVar4;
      }
    }
    *(int *)(&DAT_000cac34 + uVar5 * 4) = iVar1;
    uVar2 = FUN_00050cd0(piVar6);
    FUN_0004fe78(3,"peer struct for %s not in association table!",uVar2);
  }
  piVar6 = param_1;
  *param_1 = (int)DAT_0007d938;
  DAT_0007d938 = piVar6;
  DAT_000cb440 = DAT_000cb440 + 1;
  return;
}




void FUN_00021ae0(void)

{
  int *piVar1;
  int iVar2;
  undefined4 uVar3;
  undefined *puVar4;
  undefined4 uVar5;
  byte bVar6;
  int iVar7;
  int iVar8;
  int *piVar9;
  undefined4 uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  int *local_2c;
  
  local_2c = (int *)&DAT_000cb238;
  do {
    local_2c = local_2c + 1;
    piVar9 = (int *)*local_2c;
    while (piVar1 = piVar9, piVar1 != (int *)0x0) {
      iVar7 = (int)(piVar1 + 3);
      piVar9 = (int *)*piVar1;
      iVar2 = FUN_000212ec(iVar7,0,*(undefined1 *)(piVar1 + 0xe));
      if (DAT_0007cf4c < 4) {
        if (iVar2 != 0) {
LAB_00021b38:
          if (3 < DAT_0007cf4c) {
            uVar5 = *(undefined4 *)(iVar2 + 8);
            uVar11 = *(undefined4 *)(iVar2 + 0xc);
            uVar10 = *(undefined4 *)(iVar2 + 0x8c);
            uVar12 = *(undefined4 *)(iVar2 + 0xac);
            uVar3 = FUN_00050cd0(iVar2 + 0x14);
            printf("fd=%d, bfd=%d, name=%.16s, flags=0x%x, ifindex=%u, sin=%s",uVar5,uVar11,iVar2 + 0x68,uVar10,uVar12,
                   uVar3);
            if ((*(uint *)(iVar2 + 0x8c) & 8) != 0) {
              if (DAT_0007cf4c < 4) goto LAB_00021b40;
              uVar3 = FUN_00050cd0(iVar2 + 0x4c);
              printf(", bcast=%s",uVar3);
            }
            if (3 < DAT_0007cf4c) {
              uVar3 = FUN_00050cd0(iVar2 + 0x30);
              printf(", mask=%s\n",uVar3);
            }
          }
        }
      }
      else {
        if (piVar1[10] == 0) {
          puVar4 = &UNK_0005de78;
        }
        else {
          puVar4 = (undefined *)FUN_00050cd0(piVar1[10] + 0x14);
        }
        uVar3 = FUN_00050cd0(iVar7);
        printf("peer_refresh_interface: %s->%s mode %d vers %d poll %d %d flags 0x%x 0x%x ttl %d key %08x: new interface: "
               ,puVar4,uVar3,(uint)*(byte *)((int)piVar1 + 0x2f),(uint)*(byte *)((int)piVar1 + 0x2e),
               (uint)*(byte *)((int)piVar1 + 0x31),(uint)*(byte *)((int)piVar1 + 0x32),piVar1[0xd],
               (uint)*(byte *)(piVar1 + 0xe),(uint)*(byte *)((int)piVar1 + 0x3b),piVar1[0x19]);
        if (iVar2 != 0) goto LAB_00021b38;
        if (3 < DAT_0007cf4c) {
          puts("<NONE>");
        }
      }
LAB_00021b40:
      iVar8 = piVar1[10];
      FUN_00021778(piVar1,iVar2);
      if (piVar1[10] != 0) {
        bVar6 = *(byte *)(piVar1 + 0xe);
        if (((iVar8 != piVar1[10]) && ((bVar6 & 0x10) == 0)) && (*(char *)(piVar1 + 0x11) != '\x05')) {
          FUN_0002310c(piVar1,&DAT_00064b9c);
          bVar6 = *(byte *)(piVar1 + 0xe);
        }
        if ((bVar6 & 4) != 0) {
          FUN_00014ac8(piVar1[10],iVar7);
          bVar6 = *(byte *)(piVar1 + 0xe);
        }
        if ((bVar6 & 2) != 0) {
          FUN_00014ae4(piVar1[10],iVar7);
        }
      }
    }
    if (local_2c == (int *)&DAT_000cb438) {
      return;
    }
  } while( true );
}




undefined4 *
FUN_00021d24(short *param_1,int param_2,undefined4 param_3,undefined1 param_4,uint param_5,uint param_6,uint param_7,
            byte param_8,undefined1 param_9,undefined4 param_10)

{
  undefined1 uVar1;
  short sVar2;
  int iVar3;
  int iVar4;
  undefined *puVar5;
  undefined4 *puVar6;
  undefined4 uVar7;
  undefined4 *puVar8;
  undefined4 uVar9;
  uint extraout_r2;
  undefined4 *puVar10;
  undefined4 uVar11;
  uint uVar12;
  uint uVar13;
  int iVar14;
  char acStack_78 [84];
  
  uVar13 = (uint)param_8;
  if (param_2 == 0) {
    iVar3 = FUN_00021500();
    if (iVar3 != 0) {
      return (undefined4 *)0x0;
    }
  }
  else {
    iVar3 = FUN_00021500(param_1,0,param_3,uVar13);
    if (iVar3 != 0) {
      iVar14 = *(int *)(iVar3 + 0x28);
      if (iVar14 != param_2) {
        do {
          if (((param_8 & 0x20) != 0) && ((*(byte *)(iVar3 + 0x38) & 0x20) != 0)) {
            return (undefined4 *)0x0;
          }
          iVar4 = DAT_000ca608;
          if (*param_1 != 2) {
            iVar4 = DAT_000ca644;
          }
          if ((iVar4 == param_2) && (iVar4 = FUN_00015bd4(param_1), iVar14 == iVar4)) {
            return (undefined4 *)0x0;
          }
          iVar3 = FUN_00021500(param_1,iVar3,param_3,uVar13);
          if (iVar3 == 0) goto LAB_00021e00;
          iVar14 = *(int *)(iVar3 + 0x28);
        } while (iVar14 != param_2);
      }
      return (undefined4 *)0x0;
    }
  }
LAB_00021e00:
  if (DAT_000cb440 == 0) {
    puVar6 = (undefined4 *)FUN_0004f524(0xb40);
    *puVar6 = DAT_0007d938;
    puVar6[0x90] = puVar6;
    puVar6[0x120] = puVar6 + 0x90;
    puVar6[0x1b0] = puVar6 + 0x120;
    DAT_0007d938 = puVar6 + 0x240;
    *DAT_0007d938 = puVar6 + 0x1b0;
    DAT_000cac30 = DAT_000cac30 + 5;
    DAT_000cb440 = DAT_000cb440 + 5;
  }
  puVar6 = DAT_0007d938;
  if (DAT_0007d938 != (undefined4 *)0x0) {
    puVar10 = (undefined4 *)*DAT_0007d938;
    *DAT_0007d938 = 0;
    DAT_0007d938 = puVar10;
  }
  DAT_000cb440 = DAT_000cb440 + -1;
  DAT_000cac28 = DAT_000cac28 + 1;
  if ((param_7 & 2) != 0) {
    DAT_000cb444 = DAT_000cb444 + 1;
  }
  memset(puVar6,0,0x240);
  *(short *)(puVar6 + 0xb) = DAT_0007fb00;
  sVar2 = DAT_0007fb00 + 1;
  if ((short)(DAT_0007fb00 + 1) == 0) {
    sVar2 = DAT_0007fb00 + 2;
  }
  DAT_0007fb00 = sVar2;
  if (2 < DAT_0007cf4c) {
    uVar7 = FUN_00050cd0(param_1);
    printf("newpeer: cast flags: 0x%x for address: %s\n",uVar13,uVar7);
  }
  puVar10 = puVar6 + 3;
  uVar7 = *(undefined4 *)(param_1 + 2);
  uVar9 = *(undefined4 *)(param_1 + 4);
  uVar11 = *(undefined4 *)(param_1 + 6);
  *puVar10 = *(undefined4 *)param_1;
  puVar6[4] = uVar7;
  puVar6[5] = uVar9;
  puVar6[6] = uVar11;
  uVar7 = *(undefined4 *)(param_1 + 10);
  uVar9 = *(undefined4 *)(param_1 + 0xc);
  puVar6[7] = *(undefined4 *)(param_1 + 8);
  puVar6[8] = uVar7;
  puVar6[9] = uVar9;
  uVar7 = FUN_000212ec(param_1,param_2,uVar13);
  FUN_00021778(puVar6,uVar7);
  *(char *)((int)puVar6 + 0x2f) = (char)param_3;
  *(undefined1 *)((int)puVar6 + 0x2e) = param_4;
  uVar13 = extraout_r2;
  if (param_5 == 0) {
    uVar13 = 6;
  }
  puVar6[0xd] = param_7;
  if (param_5 == 0) {
    *(char *)((int)puVar6 + 0x31) = (char)uVar13;
  }
  else {
    if ((int)param_5 < 0x11) {
      uVar13 = param_5 & 0xff;
    }
    else {
      uVar13 = 0x11;
    }
    *(char *)((int)puVar6 + 0x31) = (char)uVar13;
  }
  if (param_6 == 0) {
    uVar12 = 10;
    *(undefined1 *)((int)puVar6 + 0x32) = 10;
  }
  else {
    if ((int)param_6 < 4) {
      uVar12 = 3;
    }
    else {
      uVar12 = param_6 & 0xff;
    }
    *(char *)((int)puVar6 + 0x32) = (char)uVar12;
  }
  iVar3 = puVar6[10];
  if (uVar12 < uVar13) {
    *(char *)((int)puVar6 + 0x31) = (char)uVar12;
  }
  if (iVar3 == 0) {
    if (2 < DAT_0007cf4c) {
      puts("newpeer: local interface currently not bound");
    }
  }
  else if (2 < DAT_0007cf4c) {
    uVar9 = *(undefined4 *)(iVar3 + 8);
    uVar7 = FUN_00050cd0(iVar3 + 0x14);
    printf("newpeer: using fd %d and our addr %s\n",uVar9,uVar7);
  }
  if (((param_8 & 4) != 0) && (puVar6[10] != 0)) {
    FUN_00014ac8(puVar6[10],param_1);
  }
  uVar1 = DAT_000cb478;
  if ((param_8 & 2) == 0) {
    *(byte *)(puVar6 + 0xe) = param_8;
    *(undefined1 *)((int)puVar6 + 0x3b) = param_9;
    puVar6[0x19] = param_10;
    *(undefined1 *)((int)puVar6 + 0x47) = uVar1;
    *(undefined1 *)(puVar6 + 0xc) = *(undefined1 *)((int)puVar6 + 0x31);
    if ((param_8 & 0x10) == 0) {
      if ((param_8 & 4) == 0) {
        puVar8 = &DAT_00064c40;
      }
      else {
        puVar8 = (undefined4 *)&UNK_00064c38;
      }
      FUN_0002310c(puVar6,puVar8);
      goto LAB_00021fd8;
    }
  }
  else {
    if (puVar6[10] != 0) {
      FUN_00014ae4(puVar6[10],param_1);
    }
    uVar1 = DAT_000cb478;
    *(byte *)(puVar6 + 0xe) = param_8;
    *(undefined1 *)((int)puVar6 + 0x3b) = param_9;
    puVar6[0x19] = param_10;
    *(undefined1 *)((int)puVar6 + 0x47) = uVar1;
    *(undefined1 *)(puVar6 + 0xc) = *(undefined1 *)((int)puVar6 + 0x31);
    if ((param_8 & 0x10) == 0) {
      FUN_0002310c(puVar6,&DAT_00064c30);
      goto LAB_00021fd8;
    }
  }
  FUN_0002310c(puVar6,&DAT_00064c28);
LAB_00021fd8:
  uVar7 = DAT_000cb548;
  if (DAT_0007d5ec != 0) {
    DAT_000cb480 = DAT_000cb480 + 1;
  }
  puVar6[0x85] = DAT_000cb548;
  puVar6[0x87] = uVar7;
  puVar6[0x86] = uVar7;
  if ((*(short *)(puVar6 + 3) == 2) && ((puVar6[4] << 0x18 | ((uint)puVar6[4] >> 8 & 0xff) << 0x10) == 0x7f7f0000)) {
    if (param_6 == 0) {
      *(undefined1 *)((int)puVar6 + 0x32) = *(undefined1 *)((int)puVar6 + 0x31);
    }
    iVar3 = FUN_00027184(puVar6);
    if (iVar3 == 0) {
      FUN_00021778(puVar6,0);
      *puVar6 = DAT_0007d938;
      DAT_0007d938 = puVar6;
      DAT_000cb440 = DAT_000cb440 + 1;
      return (undefined4 *)0x0;
    }
  }
  iVar3 = FUN_0002e254(puVar10);
  uVar13 = *(ushort *)(puVar6 + 0xb) & 0x7f;
  iVar14 = (&DAT_000cae34)[iVar3];
  *puVar6 = (&DAT_000cb23c)[iVar3];
  (&DAT_000cb23c)[iVar3] = puVar6;
  (&DAT_000cae34)[iVar3] = iVar14 + 1;
  iVar3 = *(int *)(&DAT_000cac34 + uVar13 * 4);
  puVar6[1] = (&DAT_000cb03c)[uVar13];
  (&DAT_000cb03c)[uVar13] = puVar6;
  *(int *)(&DAT_000cac34 + uVar13 * 4) = iVar3 + 1;
  snprintf(acStack_78,0x50,"assoc %d");
  FUN_0001d3d8(0x81,puVar6,acStack_78);
  if (0 < DAT_0007cf4c) {
    if (puVar6[10] == 0) {
      puVar5 = &UNK_0005de78;
    }
    else {
      puVar5 = (undefined *)FUN_00050cd0(puVar6[10] + 0x14);
    }
    uVar7 = FUN_00050cd0(puVar10);
    printf("newpeer: %s->%s mode %d vers %d poll %d %d flags 0x%x 0x%x ttl %d key %08x\n",puVar5,uVar7,
           (uint)*(byte *)((int)puVar6 + 0x2f),(uint)*(byte *)((int)puVar6 + 0x2e),(uint)*(byte *)((int)puVar6 + 0x31),
           (uint)*(byte *)((int)puVar6 + 0x32),puVar6[0xd],(uint)*(byte *)(puVar6 + 0xe),
           (uint)*(byte *)((int)puVar6 + 0x3b),puVar6[0x19]);
  }
  return puVar6;
}




void FUN_00022304(void)

{
  undefined4 in_stack_00000010;
  undefined4 uStack00000014;
  
  uStack00000014 = in_stack_00000010;
  FUN_00021d24();
  return;
}




int FUN_000224f4(int param_1)

{
  uint uVar1;
  uint uVar2;
  int *piVar3;
  int iVar4;
  
  iVar4 = 0;
  do {
    if (*(int *)((int)&DAT_000cae34 + iVar4) != 0) {
      for (piVar3 = *(int **)((int)&DAT_000cb23c + iVar4); piVar3 != (int *)0x0; piVar3 = (int *)*piVar3) {
        if ((*(byte *)(piVar3 + 0xe) & 0x10) != 0) {
          uVar1 = *(uint *)(param_1 + 0x74);
          uVar2 = *(uint *)(param_1 + 0x78);
          if ((piVar3[0x62] ==
               (uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 | (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18)) &&
             (piVar3[99] == (uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 | (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18))
             ) {
            return (int)piVar3;
          }
        }
      }
    }
    iVar4 = iVar4 + 4;
    if (iVar4 == 0x200) {
      return 0;
    }
  } while( true );
}




int FUN_00022588(int param_1,int param_2,int *param_3)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  uint uVar4;
  int *piVar5;
  bool bVar6;
  
  do {
    DAT_000cb43c = DAT_000cb43c + 1;
    iVar1 = FUN_0002e254(param_1 + 8);
    piVar5 = (int *)(&DAT_000cb23c)[iVar1];
joined_r0x000225d8:
    if (piVar5 == (int *)0x0) {
      *param_3 = *(int *)(&DAT_0007a1d4 + param_2 * 4);
      return 0;
    }
    if (*(short *)(piVar5 + 3) != *(short *)(param_1 + 8)) {
LAB_000225e0:
      piVar5 = (int *)*piVar5;
      goto joined_r0x000225d8;
    }
    if (*(short *)(piVar5 + 3) == 2) {
      bVar6 = *(int *)(param_1 + 0xc) == piVar5[4];
    }
    else {
      iVar1 = memcmp((void *)(param_1 + 0x10),piVar5 + 5,0x10);
      if (iVar1 != 0) goto LAB_000225e0;
      bVar6 = *(int *)(param_1 + 0x20) == piVar5[9];
    }
    if ((!bVar6) || (*(short *)(param_1 + 10) != *(short *)((int)piVar5 + 0xe))) goto LAB_000225e0;
    iVar1 = *(int *)(&DAT_0007a1d4 + ((uint)*(byte *)((int)piVar5 + 0x2f) * 7 + param_2) * 4);
    *param_3 = iVar1;
    if ((param_2 != 4) || (iVar1 != 1)) {
      if (iVar1 == -1) {
        return 0;
      }
      if (iVar1 != 0) goto LAB_00022674;
      goto LAB_000225e0;
    }
    uVar3 = *(uint *)(param_1 + 0x74);
    uVar4 = *(uint *)(param_1 + 0x78);
    if (((piVar5[0x62] != (uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 | (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18))
        || (piVar5[99] != (uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18)))
       && (iVar1 = FUN_000224f4(param_1), iVar1 != 0)) {
      *param_3 = -1;
      return 0;
    }
LAB_00022674:
    if ((piVar5[10] == *(int *)(param_1 + 0x40)) || (FUN_00021778(piVar5), piVar5[10] != *(int *)(param_1 + 0x40))) {
      return (int)piVar5;
    }
    if (0 < DAT_0007cf4c) {
      uVar2 = FUN_00050cd0(piVar5 + 3);
      printf("Changed %s local address to match response\n",uVar2);
    }
  } while( true );
}




undefined4 FUN_00022758(int param_1)

{
  double dVar1;
  double dVar2;
  
  dVar2 = *(double *)(param_1 + 0x1b0) + (*(double *)(param_1 + 0x1a0) + *(double *)(param_1 + 0x48)) * 0.5 +
          *(double *)(param_1 + 0x50) + (double)(uint)(DAT_000cb548 - *(int *)(param_1 + 0x1f8)) * DAT_0007a1c0 +
          *(double *)(param_1 + 0x1a8);
  dVar1 = DAT_0007a298;
  if (DAT_0007a298 <= dVar2) {
    dVar1 = dVar2;
  }
  return SUB84(dVar1,0);
}




uint FUN_000227c8(int param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  undefined4 uVar4;
  undefined4 extraout_s1;
  
  if (*(char *)(param_1 + 0x43) == '\x03') {
    uVar3 = (uint)*(byte *)(param_1 + 0x45);
  }
  else {
    uVar3 = (uint)*(byte *)(param_1 + 0x45);
    if ((DAT_0007fb08 <= (int)uVar3) && ((int)uVar3 < DAT_0007a2a0)) {
      uVar2 = 0;
      goto LAB_000227f8;
    }
  }
  uVar2 = 0x200;
LAB_000227f8:
  if (((*(uint *)(param_1 + 0x34) & 8) == 0) &&
     (uVar4 = FUN_00022758(param_1),
     DAT_0007a2a8 + (double)(longlong)(1 << (uint)*(byte *)(param_1 + 0x30)) * DAT_0007a1c0 <=
     (double)CONCAT44(extraout_s1,uVar4))) {
    uVar2 = uVar2 | 0x400;
  }
  if (((1 < uVar3) &&
      (((iVar1 = *(int *)(param_1 + 0x28), iVar1 != 0 && ((*(uint *)(iVar1 + 0x8c) & 0x100) == 0)) ||
       (iVar1 = FUN_00015bd4(param_1 + 0xc), iVar1 != 0)))) && (*(int *)(param_1 + 0x58) == *(int *)(iVar1 + 0x94))) {
    uVar2 = uVar2 | 0x800;
  }
  if ((*(char *)(param_1 + 0x6a) == '\0') || ((*(uint *)(param_1 + 0x34) & 0x200) != 0)) {
    uVar2 = uVar2 | 0x1000;
  }
  *(uint *)(param_1 + 0x6c) = uVar2 | *(uint *)(param_1 + 0x6c) & 0xffffe1ff;
  return uVar2;
}




void FUN_000228d8(int param_1)

{
  char *pcVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  uint uVar4;
  uint *puVar5;
  int iVar6;
  undefined4 uVar7;
  uint uVar8;
  uint uVar9;
  uint local_7c;
  uint local_78;
  uint local_74;
  uint local_70;
  byte local_6c;
  char local_6b;
  undefined1 local_6a;
  undefined1 local_69;
  uint local_68;
  uint local_64;
  undefined4 local_60;
  uint local_5c;
  uint local_58;
  uint local_54;
  uint local_50;
  uint local_4c;
  uint local_48;
  uint local_44;
  uint local_40;
  
  if (*(int *)(param_1 + 0x28) == 0) {
    return;
  }
  uVar4 = *(uint *)(param_1 + 0x180);
  local_5c = DAT_000cb500 << 0x18 | (DAT_000cb500 >> 8 & 0xff) << 0x10 | (DAT_000cb500 >> 0x10 & 0xff) << 8 |
             DAT_000cb500 >> 0x18;
  local_58 = DAT_000cb504 << 0x18 | (DAT_000cb504 >> 8 & 0xff) << 0x10 | (DAT_000cb504 >> 0x10 & 0xff) << 8 |
             DAT_000cb504 >> 0x18;
  local_4c = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  uVar4 = *(uint *)(param_1 + 0x184);
  local_6b = DAT_000cb4fc;
  if (DAT_000cb4fc == '\x10') {
    local_6b = '\0';
  }
  local_48 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  uVar9 = (uint)(longlong)(DAT_000cb4b8 * 65536.0);
  local_69 = DAT_000cb478;
  local_6a = *(undefined1 *)(param_1 + 0x30);
  local_60 = DAT_000cb4e0;
  local_6c = (*(byte *)(param_1 + 0x2e) & 7) << 3 | DAT_000cb4b0 << 6 | *(byte *)(param_1 + 0x2f) & 7;
  uVar8 = *(uint *)(param_1 + 0x170);
  uVar4 = *(uint *)(param_1 + 0x174);
  local_50 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  local_54 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
  uVar4 = (uint)(0.0 < DAT_000cb498 * 65536.0) * (int)(longlong)(DAT_000cb498 * 65536.0);
  local_68 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
  local_64 = uVar4 * 0x1000000 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  if (*(int *)(param_1 + 100) == 0) {
    FUN_0004cba8(&local_7c);
    iVar6 = *(int *)(param_1 + 0x7c);
    if (iVar6 == 0) {
      local_44 = local_7c << 0x18 | (local_7c >> 8 & 0xff) << 0x10 | (local_7c >> 0x10 & 0xff) << 8 | local_7c >> 0x18;
      *(uint *)(param_1 + 0x188) = local_7c;
      *(uint *)(param_1 + 0x18c) = local_78;
      local_40 = local_78 << 0x18 | (local_78 >> 8 & 0xff) << 0x10 | (local_78 >> 0x10 & 0xff) << 8 | local_78 >> 0x18;
    }
    else if (*(char *)(param_1 + 0x2f) == '\x05') {
      local_44 = local_7c << 0x18 | (local_7c >> 8 & 0xff) << 0x10 | (local_7c >> 0x10 & 0xff) << 8 | local_7c >> 0x18;
      local_40 = local_78 << 0x18 | (local_78 >> 8 & 0xff) << 0x10 | (local_78 >> 0x10 & 0xff) << 8 | local_78 >> 0x18;
      if (iVar6 < 1) {
        uVar4 = *(uint *)(param_1 + 0x188);
        uVar8 = *(uint *)(param_1 + 0x18c);
      }
      else {
        uVar4 = *(uint *)(param_1 + 400);
        uVar8 = *(uint *)(param_1 + 0x194);
      }
      local_54 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
      local_50 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
    }
    else {
      if (iVar6 < 1) {
        uVar4 = *(uint *)(param_1 + 0x188);
        uVar8 = *(uint *)(param_1 + 0x18c);
      }
      else {
        uVar4 = *(uint *)(param_1 + 400);
        uVar8 = *(uint *)(param_1 + 0x194);
      }
      local_44 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
      local_40 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
    }
    *(undefined4 *)(param_1 + 0x1d0) = 0x30;
    FUN_000154a4(param_1 + 0xc,*(undefined4 *)(param_1 + 0x28),(&DAT_000cb460)[*(byte *)(param_1 + 0x3b)],&local_6c,0x30
                );
    *(int *)(param_1 + 0x220) = *(int *)(param_1 + 0x220) + 1;
    *(int *)(param_1 + 0x200) = *(int *)(param_1 + 0x200) + (1 << *(sbyte *)(param_1 + 0x31)) + -2;
    FUN_0004cba8(&local_74);
    iVar6 = *(int *)(param_1 + 0x7c);
    if (iVar6 != 0) {
      if (iVar6 < 1) {
        puVar5 = (uint *)(param_1 + 400);
      }
      else {
        puVar5 = (uint *)(param_1 + 0x188);
      }
      *puVar5 = local_74;
      puVar5[1] = local_70;
      *(int *)(param_1 + 0x7c) = -iVar6;
    }
    if (local_78 == 0) {
      local_74 = local_74 - local_7c;
    }
    else {
      uVar8 = (local_70 >> 0x10) + (-local_78 >> 0x10);
      uVar4 = (local_70 & 0xffff) + (-local_78 & 0xffff);
      if ((uVar4 & 0x10000) != 0) {
        uVar8 = uVar8 + 1;
      }
      local_74 = ~local_7c + local_74;
      if ((uVar8 & 0x10000) != 0) {
        local_74 = local_74 + 1;
      }
      local_70 = uVar4 & 0xffff | uVar8 << 0x10;
    }
    if ((int)local_74 < 0) {
      if (local_70 == 0) {
        uVar4 = -local_74;
        uVar8 = 0;
      }
      else {
        uVar8 = -local_70;
        uVar4 = ~local_74;
      }
      *(double *)(param_1 + 0x1b8) = -((double)(longlong)(int)uVar4 + (double)uVar8 * 2.3283064365386963e-10);
    }
    else {
      *(double *)(param_1 + 0x1b8) = (double)(longlong)(int)local_74 + (double)local_70 * 2.3283064365386963e-10;
    }
    uVar7 = DAT_000cb548;
    if (DAT_0007cf4c != 0) {
      if (*(int *)(param_1 + 0x28) == 0) {
        pcVar1 = "-";
      }
      else {
        pcVar1 = (char *)FUN_00050cd0(*(int *)(param_1 + 0x28) + 0x14);
      }
      uVar2 = FUN_00050cd0(param_1 + 0xc);
      printf("transmit: at %ld %s->%s mode %d len %d\n",uVar7,pcVar1,uVar2,(uint)*(byte *)(param_1 + 0x2f),0x30);
    }
    return;
  }
  FUN_0004cba8(&local_7c);
  iVar6 = *(int *)(param_1 + 0x7c);
  if (iVar6 == 0) {
    local_44 = local_7c << 0x18 | (local_7c >> 8 & 0xff) << 0x10 | (local_7c >> 0x10 & 0xff) << 8 | local_7c >> 0x18;
    *(uint *)(param_1 + 0x188) = local_7c;
    *(uint *)(param_1 + 0x18c) = local_78;
    local_40 = local_78 << 0x18 | (local_78 >> 8 & 0xff) << 0x10 | (local_78 >> 0x10 & 0xff) << 8 | local_78 >> 0x18;
  }
  else if (*(char *)(param_1 + 0x2f) == '\x05') {
    local_44 = local_7c << 0x18 | (local_7c >> 8 & 0xff) << 0x10 | (local_7c >> 0x10 & 0xff) << 8 | local_7c >> 0x18;
    local_40 = local_78 << 0x18 | (local_78 >> 8 & 0xff) << 0x10 | (local_78 >> 0x10 & 0xff) << 8 | local_78 >> 0x18;
    if (iVar6 < 1) {
      uVar4 = *(uint *)(param_1 + 0x188);
      uVar8 = *(uint *)(param_1 + 0x18c);
    }
    else {
      uVar4 = *(uint *)(param_1 + 400);
      uVar8 = *(uint *)(param_1 + 0x194);
    }
    local_54 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
    local_50 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
  }
  else {
    if (iVar6 < 1) {
      uVar4 = *(uint *)(param_1 + 0x188);
      uVar8 = *(uint *)(param_1 + 0x18c);
    }
    else {
      uVar4 = *(uint *)(param_1 + 400);
      uVar8 = *(uint *)(param_1 + 0x194);
    }
    local_44 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
    local_40 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
  }
  uVar7 = *(undefined4 *)(param_1 + 100);
  iVar6 = FUN_0004e458(uVar7,&local_6c,0x30);
  if (iVar6 == 0) {
    FUN_0001d3d8(0x8c,param_1,"no key");
    *(uint *)(param_1 + 0x6c) = *(uint *)(param_1 + 0x6c) | 0x10;
    *(int *)(param_1 + 0x22c) = *(int *)(param_1 + 0x22c) + 1;
    return;
  }
  uVar4 = iVar6 + 0x30;
  if (0x4c < uVar4) {
    FUN_0004fe78(3,"proto: buffer overflow %u",uVar4);
                    /* WARNING: Subroutine does not return */
    exit(-1);
  }
  *(uint *)(param_1 + 0x1d0) = uVar4;
  FUN_000154a4(param_1 + 0xc,*(undefined4 *)(param_1 + 0x28),(&DAT_000cb460)[*(byte *)(param_1 + 0x3b)],&local_6c,uVar4)
  ;
  *(int *)(param_1 + 0x220) = *(int *)(param_1 + 0x220) + 1;
  *(int *)(param_1 + 0x200) = *(int *)(param_1 + 0x200) + (1 << *(sbyte *)(param_1 + 0x31)) + -2;
  FUN_0004cba8(&local_74);
  iVar6 = *(int *)(param_1 + 0x7c);
  if (iVar6 != 0) {
    if (iVar6 < 1) {
      puVar5 = (uint *)(param_1 + 400);
    }
    else {
      puVar5 = (uint *)(param_1 + 0x188);
    }
    *puVar5 = local_74;
    puVar5[1] = local_70;
    *(int *)(param_1 + 0x7c) = -iVar6;
  }
  if (local_78 == 0) {
    local_74 = local_74 - local_7c;
  }
  else {
    uVar9 = (local_70 >> 0x10) + (-local_78 >> 0x10);
    uVar8 = (local_70 & 0xffff) + (-local_78 & 0xffff);
    if ((uVar8 & 0x10000) != 0) {
      uVar9 = uVar9 + 1;
    }
    local_74 = ~local_7c + local_74;
    local_70 = uVar8 & 0xffff | uVar9 << 0x10;
    if ((uVar9 & 0x10000) != 0) {
      local_74 = local_74 + 1;
    }
  }
  if ((int)local_74 < 0) {
    if (local_70 == 0) {
      uVar8 = -local_74;
      uVar9 = 0;
    }
    else {
      uVar9 = -local_70;
      uVar8 = ~local_74;
    }
    *(double *)(param_1 + 0x1b8) = -((double)(longlong)(int)uVar8 + (double)uVar9 * 2.3283064365386963e-10);
  }
  else {
    *(double *)(param_1 + 0x1b8) = (double)(longlong)(int)local_74 + (double)local_70 * 2.3283064365386963e-10;
  }
  uVar2 = DAT_000cb548;
  if (DAT_0007cf4c != 0) {
    if (*(int *)(param_1 + 0x28) == 0) {
      pcVar1 = "-";
    }
    else {
      pcVar1 = (char *)FUN_00050cd0(*(int *)(param_1 + 0x28) + 0x14);
    }
    uVar3 = FUN_00050cd0(param_1 + 0xc);
    printf("transmit: at %ld %s->%s mode %d keyid %08x len %d\n",uVar2,pcVar1,uVar3,(uint)*(byte *)(param_1 + 0x2f),
           uVar7,uVar4);
    return;
  }
  return;
}




void FUN_00022f68(int param_1,uint param_2)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  int iVar8;
  
  uVar5 = DAT_000cb548;
  if ((*(byte *)(param_1 + 0x38) & 0x20) == 0) {
    uVar3 = (uint)*(byte *)(param_1 + 0x31);
    if ((int)(uint)*(byte *)(param_1 + 0x32) <= (int)param_2) {
      param_2 = (uint)*(byte *)(param_1 + 0x32);
    }
    if ((int)param_2 < (int)uVar3) {
      param_2 = uVar3;
    }
  }
  else {
    uVar3 = (uint)*(byte *)(param_1 + 0x31);
    param_2 = uVar3;
  }
  iVar8 = *(int *)(param_1 + 0x200);
  uVar4 = param_2 & 0xff;
  iVar1 = 1 << (DAT_0007a1cc & 0xff);
  iVar6 = iVar8 - (7 << uVar3);
  *(char *)(param_1 + 0x30) = (char)param_2;
  if (iVar6 < iVar1) {
    iVar6 = iVar1;
  }
  uVar7 = uVar5 + iVar6;
  if (*(int *)(param_1 + 0x74) < 1) {
    uVar5 = uVar3;
    if (((*(int *)(param_1 + 0x78) < 1) && (uVar5 = uVar4, *(char *)(param_1 + 0x6a) != '\0')) &&
       (uVar5 = (uint)*(byte *)(param_1 + 0x46), uVar4 < *(byte *)(param_1 + 0x46))) {
      uVar5 = uVar4;
    }
    if ((*(uint *)(param_1 + 0x34) & 8) == 0) {
      uVar4 = FUN_000504ec();
      iVar8 = *(int *)(param_1 + 0x200);
      uVar3 = (uint)*(byte *)(param_1 + 0x31);
      uVar5 = ((uVar4 & 0xff | 0x1000) << uVar5) >> 0xc;
    }
    else {
      uVar5 = 1 << uVar5;
    }
    uVar5 = uVar5 + *(int *)(param_1 + 0x204);
    if (uVar5 < uVar7) {
      uVar5 = uVar7;
    }
    *(uint *)(param_1 + 0x208) = uVar5;
    if (0 < iVar8 - (1 << uVar3)) {
      *(uint *)(param_1 + 0x208) = uVar5 + iVar1;
    }
  }
  else {
    if (uVar5 < *(uint *)(param_1 + 0x208)) {
      return;
    }
    if ((*(uint *)(param_1 + 0x34) & 8) == 0) {
      *(uint *)(param_1 + 0x208) = uVar7;
    }
    else {
      *(uint *)(param_1 + 0x208) = uVar5 + 1;
    }
  }
  if (1 < DAT_0007cf4c) {
    uVar2 = FUN_00050cd0(param_1 + 0xc);
    printf("poll_update: at %lu %s poll %d burst %d retry %d head %d early %lu next %lu\n",DAT_000cb548,uVar2,
           (uint)*(byte *)(param_1 + 0x30),*(undefined4 *)(param_1 + 0x74),*(undefined4 *)(param_1 + 0x78),
           *(undefined4 *)(param_1 + 0x200),uVar7 - DAT_000cb548,*(int *)(param_1 + 0x208) - DAT_000cb548);
  }
  return;
}




void FUN_0002310c(int param_1,undefined4 *param_2)

{
  byte bVar1;
  undefined4 uVar2;
  uint uVar3;
  undefined4 *puVar4;
  int extraout_r1;
  int iVar5;
  int iVar6;
  bool bVar7;
  double dVar8;
  
  memset((void *)(param_1 + 0x68),0,400);
  *(undefined1 *)(param_1 + 0x46) = *(undefined1 *)(param_1 + 0x32);
  *(undefined4 *)(param_1 + 0x1b0) = 0;
  *(undefined4 *)(param_1 + 0x1b4) = 0x40300000;
  *(undefined1 *)(param_1 + 0x30) = *(undefined1 *)(param_1 + 0x31);
  uVar2 = FUN_000227c8(param_1);
  bVar1 = DAT_000cb478;
  iVar5 = (int)(char)DAT_000cb478;
  *(undefined4 *)(param_1 + 0x6c) = uVar2;
  if (iVar5 < 0) {
    dVar8 = 1.0 / (double)(longlong)(1 << (-iVar5 & 0xffU));
  }
  else {
    dVar8 = (double)(longlong)(1 << (uint)bVar1);
  }
  uVar3 = *(uint *)(param_1 + 0x34);
  puVar4 = (undefined4 *)(param_1 + 0x108);
  iVar6 = 0;
  *(double *)(param_1 + 0x1a8) = dVar8;
  iVar5 = param_1;
  if ((uVar3 & 0x1000) != 0) {
    *(undefined4 *)(param_1 + 0x7c) = 1;
  }
  do {
    *(char *)(iVar5 + 0x168) = (char)iVar6;
    iVar6 = iVar6 + 1;
    *puVar4 = 0;
    puVar4[1] = 0x40300000;
    puVar4 = puVar4 + 2;
    iVar5 = iVar5 + 1;
  } while (iVar6 != 8);
  if ((uVar3 & 8) == 0) {
    *(undefined1 *)(param_1 + 0x45) = 0x10;
    *(undefined1 *)(param_1 + 0x43) = 3;
    *(undefined4 *)(param_1 + 0x58) = *param_2;
  }
  iVar5 = DAT_000cb548;
  bVar7 = DAT_000caa98 == 0;
  *(int *)(param_1 + 0x204) = DAT_000cb548;
  *(int *)(param_1 + 0x1f8) = iVar5;
  *(int *)(param_1 + 0x208) = iVar5;
  if (bVar7) {
    if (*(char *)(param_1 + 0x2f) == '\x02') {
      *(int *)(param_1 + 0x208) = iVar5 + (1 << (DAT_0007a1cc & 0xff));
    }
    else {
      uVar2 = FUN_000504ec();
      FUN_0005aa04(uVar2,DAT_000cac28);
      *(int *)(param_1 + 0x208) = extraout_r1 + iVar5;
    }
  }
  else {
    *(int *)(param_1 + 0x208) = DAT_000cac28 + iVar5;
  }
  if (DAT_0007cf4c != 0) {
    printf("peer_clear: at %ld next %ld associd %d refid %s\n",DAT_000cb548,*(undefined4 *)(param_1 + 0x208),
           (uint)*(ushort *)(param_1 + 0x2c),param_2);
  }
  return;
}




/* WARNING: Removing unreachable block (ram,0x00024390) */
/* WARNING: Removing unreachable block (ram,0x00024654) */
/* WARNING: Removing unreachable block (ram,0x000243b8) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Restarted to delay deadcode elimination for space: ram */

void FUN_000232c4(void)

{
  byte bVar1;
  void *pvVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  undefined8 *puVar6;
  uint uVar7;
  undefined4 uVar8;
  int iVar9;
  undefined8 *puVar10;
  int iVar11;
  int *piVar12;
  int *piVar13;
  double *pdVar14;
  undefined4 *puVar15;
  int iVar16;
  int iVar17;
  uint uVar18;
  int *piVar19;
  int iVar20;
  int iVar21;
  undefined4 uVar22;
  int *piVar23;
  int *piVar24;
  int iVar25;
  undefined8 *puVar26;
  undefined8 *puVar27;
  bool bVar28;
  undefined4 uVar29;
  undefined4 extraout_s1;
  undefined4 extraout_s1_00;
  undefined4 extraout_s1_01;
  double dVar30;
  double dVar31;
  double dVar32;
  double dVar33;
  undefined8 uVar34;
  double dVar35;
  double dVar36;
  double dVar37;
  undefined8 uVar38;
  double dVar39;
  int local_39c;
  int *local_398;
  int local_394;
  int local_390;
  int local_38c;
  int *local_384;
  uint local_380 [2];
  undefined8 local_378;
  undefined8 local_1e8;
  
  iVar3 = DAT_000cb470;
  iVar21 = DAT_0007fb0c;
  piVar13 = (int *)0xcae30;
  iVar20 = 0;
  DAT_000cb4d0 = 0;
  do {
    piVar13 = piVar13 + 1;
    iVar20 = iVar20 + *piVar13;
  } while (piVar13 != (int *)&DAT_000cb030);
  if (DAT_0007fb0c < iVar20) {
    if (0 < DAT_0007fb0c) {
      free(DAT_0007fb10);
      free(DAT_0007fb14);
      free(DAT_0007fb18);
    }
    do {
      DAT_0007fb20 = DAT_0007fb20 + 0xf0;
      DAT_0007fb24 = DAT_0007fb24 + 0x14;
      iVar21 = iVar21 + 5;
      DAT_0007fb1c = DAT_0007fb1c + 0x3c;
    } while (iVar21 < iVar20);
    DAT_0007fb0c = iVar21;
    DAT_0007fb10 = (void *)FUN_0004f524(DAT_0007fb20);
    DAT_0007fb14 = (int *)FUN_0004f524(DAT_0007fb1c);
    DAT_0007fb18 = (int *)FUN_0004f524(DAT_0007fb24);
  }
  iVar21 = 0;
  local_394 = 0;
  dVar30 = 8589934590.0;
  local_384 = (int *)&DAT_000cb238;
  local_390 = 0;
  local_398 = (int *)&DAT_000cb238;
  local_38c = 0;
  local_39c = 0;
  do {
    local_398 = local_398 + 1;
    for (piVar13 = (int *)*local_398; piVar13 != (int *)0x0; piVar13 = (int *)*piVar13) {
      *(undefined1 *)((int)piVar13 + 0x69) = 0;
      iVar20 = FUN_000227c8(piVar13);
      piVar19 = DAT_0007fb18;
      if (iVar20 == 0) {
        if (*(byte *)((int)piVar13 + 0x45) == DAT_0007a2b0) {
          if (piVar13[10] == 0) {
            uVar18 = 0xffffffff;
          }
          else {
            uVar18 = *(uint *)(piVar13[10] + 0x94);
            uVar18 = uVar18 << 0x18 | (uVar18 >> 8 & 0xff) << 0x10 | (uVar18 >> 0x10 & 0xff) << 8 | uVar18 >> 0x18;
          }
          uVar7 = FUN_0004d0b4(piVar13 + 3);
          uVar7 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 | (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
          if ((uVar7 < uVar18) && (dVar33 = (double)uVar7, dVar33 < dVar30)) {
            dVar30 = dVar33;
            local_38c = (int)piVar13;
          }
        }
        else if ((int)(uint)*(byte *)((int)piVar13 + 0x45) <= (int)DAT_0007a2b0) {
          if ((piVar13[0xd] & 0x20U) == 0) {
            if (*(char *)(piVar13 + 0x10) == '\x01') {
              if (local_394 == 0) {
                local_394 = (int)piVar13;
              }
            }
            else {
              if (*(char *)(piVar13 + 0x10) != '\x12') goto LAB_00023474;
              if (local_390 == 0) {
                local_390 = (int)piVar13;
              }
            }
          }
          else {
LAB_00023474:
            dVar32 = *(double *)(piVar13 + 0x66);
            *(undefined1 *)((int)piVar13 + 0x69) = 1;
            piVar19[local_39c] = (int)piVar13;
            local_39c = local_39c + 1;
            uVar29 = FUN_00022758(piVar13);
            piVar19 = DAT_0007fb14;
            pvVar2 = DAT_0007fb10;
            dVar33 = (double)CONCAT44(extraout_s1,uVar29);
            iVar20 = iVar21 + -1;
            dVar32 = dVar32 + dVar33;
            if (iVar20 == -1) {
LAB_00023518:
              pdVar14 = (double *)((int)pvVar2 + iVar21 * 0x10);
              piVar19[2] = iVar21;
              *pdVar14 = dVar32;
              *(undefined4 *)(pdVar14 + 1) = 1;
LAB_00023538:
              dVar37 = (dVar32 - dVar33) - dVar33;
              pdVar14 = (double *)((int)pvVar2 + (iVar21 + 1) * 0x10);
              piVar19[1] = iVar21 + 1;
              *pdVar14 = dVar32 - dVar33;
              *(undefined4 *)(pdVar14 + 1) = 0;
              iVar20 = 0;
            }
            else {
              iVar4 = DAT_0007fb14[iVar20];
              iVar9 = iVar21;
              if (dVar32 < *(double *)((int)DAT_0007fb10 + iVar4 * 0x10)) {
                piVar24 = DAT_0007fb14 + iVar20;
                do {
                  iVar9 = iVar20;
                  iVar20 = iVar9 + -1;
                  piVar19[iVar9 + 3] = iVar4;
                  if (iVar20 == -1) goto LAB_00023518;
                  piVar24 = piVar24 + -1;
                  iVar4 = *piVar24;
                } while (dVar32 < *(double *)((int)pvVar2 + iVar4 * 0x10));
              }
              dVar31 = dVar32 - dVar33;
              pdVar14 = (double *)((int)pvVar2 + iVar21 * 0x10);
              piVar19[iVar9 + 2] = iVar21;
              *pdVar14 = dVar32;
              *(undefined4 *)(pdVar14 + 1) = 1;
              iVar4 = piVar19[iVar20];
              iVar9 = iVar20 * 4;
              if (dVar31 < *(double *)((int)pvVar2 + iVar4 * 0x10)) {
                piVar24 = piVar19 + iVar20;
                do {
                  iVar9 = iVar20 + 2;
                  iVar20 = iVar20 + -1;
                  piVar19[iVar9] = iVar4;
                  if (iVar20 == -1) goto LAB_00023538;
                  iVar9 = (-4 - (int)piVar19) + (int)piVar24;
                  piVar24 = piVar24 + -1;
                  iVar4 = *piVar24;
                } while (dVar31 < *(double *)((int)pvVar2 + iVar4 * 0x10));
              }
              dVar37 = dVar31 - dVar33;
              pdVar14 = (double *)((int)pvVar2 + (iVar21 + 1) * 0x10);
              piVar19[iVar20 + 2] = iVar21 + 1;
              *pdVar14 = dVar31;
              *(undefined4 *)(pdVar14 + 1) = 0;
              iVar9 = *(int *)((int)piVar19 + iVar9);
              if (dVar37 < *(double *)((int)pvVar2 + iVar9 * 0x10)) {
                piVar24 = piVar19 + iVar20;
                do {
                  iVar4 = iVar20 + 1;
                  iVar20 = iVar20 + -1;
                  piVar19[iVar4] = iVar9;
                  if (iVar20 == -1) {
                    iVar20 = 0;
                    goto LAB_00023550;
                  }
                  piVar24 = piVar24 + -1;
                  iVar9 = *piVar24;
                } while (dVar37 < *(double *)((int)pvVar2 + iVar9 * 0x10));
              }
              iVar20 = (iVar20 + 1) * 4;
            }
LAB_00023550:
            iVar9 = iVar21 + 2;
            pdVar14 = (double *)((int)pvVar2 + iVar9 * 0x10);
            iVar21 = iVar21 + 3;
            *(int *)((int)piVar19 + iVar20) = iVar9;
            *pdVar14 = dVar37;
            *(undefined4 *)(pdVar14 + 1) = 0xffffffff;
          }
        }
      }
    }
  } while (local_398 != (int *)&DAT_000cb438);
  if ((2 < DAT_0007cf4c) && (iVar21 != 0)) {
    iVar20 = 0;
    do {
      piVar13 = DAT_0007fb14 + iVar20;
      iVar20 = iVar20 + 1;
      puVar15 = (undefined4 *)((int)DAT_0007fb10 + *piVar13 * 0x10);
      printf("select: endpoint %2d %.6f\n",puVar15[2],*puVar15,puVar15[1]);
    } while (iVar20 != iVar21);
  }
  iVar20 = DAT_000cb548;
  piVar13 = DAT_0007fb18;
  dVar33 = DAT_0007a2a8;
  dVar30 = DAT_0007a1c0;
  if (local_39c == 0) {
    local_398 = (int *)0x0;
LAB_000237ec:
    piVar13 = DAT_0007fb18;
    local_1e8._0_4_ = 0;
    local_1e8._4_4_ = 0;
    local_378._0_4_ = 0;
    local_378._4_4_ = 0;
    if (((local_390 == 0) && (local_390 = local_394, local_394 == 0)) && (local_390 = local_38c, local_38c == 0)) {
      iVar21 = 0;
      iVar20 = 0;
      goto LAB_00023888;
    }
    iVar21 = 1;
    *DAT_0007fb18 = local_390;
    iVar20 = 0;
  }
  else {
    iVar25 = iVar21 + -1;
    iVar4 = 0;
    dVar32 = -1000000000.0;
    dVar31 = 1000000000.0;
    iVar9 = local_39c;
    do {
      if (iVar21 == 0) {
        iVar5 = 0;
      }
      else {
        pdVar14 = (double *)((int)DAT_0007fb10 + *DAT_0007fb14 * 0x10);
        dVar31 = *pdVar14;
        iVar16 = *(int *)(pdVar14 + 1);
        iVar11 = -iVar16;
        if (iVar11 < iVar9) {
          iVar5 = 0;
          iVar17 = iVar5;
          piVar19 = DAT_0007fb14;
          do {
            iVar17 = iVar17 + 1;
            if (iVar16 == 0) {
              iVar5 = iVar5 + 1;
            }
            if (iVar17 == iVar21) break;
            piVar19 = piVar19 + 1;
            pdVar14 = (double *)((int)DAT_0007fb10 + *piVar19 * 0x10);
            dVar31 = *pdVar14;
            iVar16 = *(int *)(pdVar14 + 1);
            iVar11 = iVar11 - iVar16;
          } while (iVar11 < iVar9);
        }
        else {
          iVar5 = 0;
        }
      }
      if (iVar25 != -1) {
        pdVar14 = (double *)((int)DAT_0007fb10 + DAT_0007fb14[iVar25] * 0x10);
        dVar32 = *pdVar14;
        iVar16 = *(int *)(pdVar14 + 1);
        iVar11 = iVar25;
        piVar19 = DAT_0007fb14 + iVar25;
        for (iVar17 = iVar16; iVar17 < iVar9; iVar17 = iVar17 + iVar16) {
          if (iVar16 == 0) {
            iVar5 = iVar5 + 1;
          }
          bVar28 = iVar11 == 0;
          iVar11 = iVar11 + -1;
          if (bVar28) break;
          piVar19 = piVar19 + -1;
          pdVar14 = (double *)((int)DAT_0007fb10 + *piVar19 * 0x10);
          dVar32 = *pdVar14;
          iVar16 = *(int *)(pdVar14 + 1);
        }
      }
      if ((iVar5 <= iVar4) && (dVar31 < dVar32)) break;
      iVar4 = iVar4 + 1;
      iVar9 = iVar9 + -1;
    } while (iVar4 != (local_39c - 1U >> 1) + 1);
    iVar21 = 0;
    local_398 = (int *)0x0;
    piVar24 = DAT_0007fb18 + local_39c;
    piVar19 = DAT_0007fb18;
    do {
      while( true ) {
        piVar23 = piVar19 + 1;
        iVar9 = *piVar19;
        piVar19 = piVar23;
        if ((local_39c != 1) && ((*(double *)(iVar9 + 0x198) <= dVar31 || (dVar32 <= *(double *)(iVar9 + 0x198)))))
        break;
        uVar18 = *(uint *)(iVar9 + 0x34);
LAB_0002378c:
        if ((uVar18 & 0x80) == 0) {
          uVar29 = FUN_00022758(iVar9);
          dVar37 = ((double)CONCAT44(extraout_s1_00,uVar29) + (double)(uint)(*(int *)(iVar9 + 0x208) - iVar20) * dVar30)
                   / dVar33 + (double)*(byte *)(iVar9 + 0x45);
          if (iVar21 < 0x32) {
            iVar4 = iVar21;
            if (iVar21 != 0) goto LAB_00023cd4;
            iVar21 = 1;
LAB_00023d60:
            iVar25 = 0;
            iVar4 = 0;
          }
          else {
            iVar4 = iVar21 + -1;
            if ((double)(&local_378)[iVar4] <= dVar37) goto LAB_000237a4;
LAB_00023cd4:
            dVar35 = (double)(&local_378)[iVar4 + -1];
            if (dVar37 < dVar35) {
              iVar21 = iVar4 + 1;
              puVar6 = &local_1e8 + iVar21;
              pdVar14 = (double *)(&local_378 + iVar21);
              piVar12 = piVar13 + iVar4;
              iVar25 = iVar4 + -1;
              do {
                iVar4 = iVar25;
                uVar34 = (&local_1e8)[iVar4];
                *piVar12 = piVar12[-1];
                puVar6 = puVar6 + -1;
                *puVar6 = uVar34;
                pdVar14[-1] = dVar35;
                if (iVar4 == 0) goto LAB_00023d60;
                dVar35 = pdVar14[-3];
                pdVar14 = pdVar14 + -1;
                piVar12 = piVar12 + -1;
                iVar25 = iVar4 + -1;
              } while (dVar37 < dVar35);
              iVar25 = iVar4 << 2;
            }
            else {
              iVar25 = iVar4 << 2;
              iVar21 = iVar4 + 1;
            }
          }
          *(int *)((int)piVar13 + iVar25) = iVar9;
          uVar29 = *(undefined4 *)(iVar9 + 0x1a8);
          uVar22 = *(undefined4 *)(iVar9 + 0x1ac);
          (&local_378)[iVar4] = dVar37;
          *(undefined4 *)(&local_1e8 + iVar4) = uVar29;
          *(undefined4 *)((int)&local_1e8 + iVar4 * 8 + 4) = uVar22;
        }
        else if (local_398 == (int *)0x0) {
          local_398 = (int *)iVar9;
        }
LAB_000237a4:
        if (piVar23 == piVar24) goto LAB_000237e0;
      }
      uVar18 = *(uint *)(iVar9 + 0x34);
      if ((uVar18 & 0x400) != 0) goto LAB_0002378c;
    } while (piVar23 != piVar24);
LAB_000237e0:
    iVar20 = iVar21;
    if (iVar21 == 0) goto LAB_000237ec;
  }
  puVar6 = &local_378;
  iVar9 = 0;
  do {
    iVar4 = DAT_0007cf4c;
    *(undefined1 *)(piVar13[iVar9] + 0x69) = 3;
    if (1 < iVar4) {
      uVar29 = FUN_00050cd0(piVar13[iVar9] + 0xc);
      printf("select: survivor %s %f\n",uVar29,*(undefined4 *)puVar6,*(undefined4 *)((int)puVar6 + 4));
    }
    iVar9 = iVar9 + 1;
    puVar6 = puVar6 + 1;
    piVar13 = DAT_0007fb18;
  } while (iVar9 < iVar21);
LAB_00023888:
  iVar9 = iVar21 << 2;
  if (iVar21 < 1) goto LAB_00023ac4;
LAB_00023898:
  iVar25 = 0;
  iVar4 = 0;
  uVar29 = 0;
  uVar22 = 0;
  dVar30 = -1000000000.0;
  dVar33 = 1000000000.0;
  do {
    if ((double)(&local_1e8)[iVar25] < dVar33) {
      dVar33 = (double)(&local_1e8)[iVar25];
    }
    if (iVar21 == 1) {
      dVar32 = 0.0;
    }
    else {
      dVar32 = 0.0;
      piVar13 = DAT_0007fb18;
      do {
        piVar19 = piVar13 + 1;
        dVar31 = *(double *)(*piVar13 + 0x198) - *(double *)(DAT_0007fb18[iVar25] + 0x198);
        dVar32 = dVar32 + dVar31 * dVar31;
        piVar13 = piVar19;
      } while (piVar19 != (int *)((int)DAT_0007fb18 + iVar9));
      dVar32 = SQRT(dVar32 / (double)(longlong)(iVar21 + -1));
      iVar20 = iVar21;
    }
    dVar31 = dVar32 * (double)(&local_378)[iVar25];
    if (dVar30 < dVar31) {
      iVar4 = iVar25;
    }
    iVar25 = iVar25 + 1;
    if (dVar30 < dVar31) {
      uVar22 = (undefined4)((ulonglong)dVar32 >> 0x20);
      uVar29 = SUB84(dVar32,0);
      dVar30 = dVar31;
    }
  } while (iVar25 != iVar21);
  do {
    piVar13 = DAT_0007fb18;
    iVar25 = DAT_0007a2b4;
    if ((char)DAT_000cb478 < 0) {
      dVar30 = 1.0 / (double)(longlong)(1 << (-(int)(char)DAT_000cb478 & 0xffU));
      if (dVar32 <= dVar30) {
        dVar32 = dVar30;
      }
    }
    else if (dVar32 <= (double)(longlong)(1 << (uint)DAT_000cb478)) {
      dVar32 = (double)(longlong)(1 << (uint)DAT_000cb478);
    }
    if ((iVar21 <= DAT_0007a2b4) || (iVar21 <= DAT_0007a2b8)) {
      dVar32 = 0.0;
LAB_00023e04:
      iVar9 = 0;
      DAT_0007fb28 = 0;
      if (0 < iVar21) {
        iVar4 = 0;
        iVar5 = 0;
        do {
          iVar11 = *(int *)((int)piVar13 + iVar9);
          *(undefined4 *)(iVar11 + 0x1fc) = 0;
          *(undefined1 *)(iVar11 + 0x69) = 4;
          DAT_0007fb28 = iVar5;
          if ((*(char *)(iVar11 + 0x43) == '\x01') && (DAT_0007fb28 = iVar21, (*(uint *)(iVar11 + 0x34) & 8) == 0)) {
            DAT_0007fb28 = iVar5 + 1;
          }
          iVar9 = iVar9 + 4;
          if ((*(uint *)(iVar11 + 0x34) & 0x20) != 0) {
            iVar4 = iVar11;
          }
          iVar5 = DAT_0007fb28;
        } while (iVar9 != iVar21 * 4);
        DAT_000cb4d0 = iVar21 + DAT_000cb4d0;
        if (iVar21 < iVar25) {
LAB_00023fcc:
          piVar13 = (int *)0x0;
          iVar21 = DAT_0007cf4c;
        }
        else {
          piVar13 = (int *)*DAT_0007fb18;
          iVar21 = (int)piVar13;
          if (iVar3 == 0 || (int *)iVar3 == piVar13) {
            _DAT_0007fb30 = 0.0;
            if (piVar13 == (int *)0x0) goto LAB_00023fcc;
LAB_00023ee4:
            piVar13 = (int *)iVar21;
            if (iVar4 == 0) goto LAB_000242f0;
LAB_00023eec:
            _DAT_0007fb30 = 0.0;
            *(undefined1 *)(iVar4 + 0x69) = 6;
            _DAT_000cb4c8 = *(double *)(iVar4 + 0x198);
            DAT_000cb4e8 = *(double *)(iVar4 + 0x1a8);
            piVar13 = (int *)iVar4;
          }
          else {
            dVar30 = ABS(*(double *)((int)piVar13 + 0x198) - *(double *)(iVar3 + 0x198));
            if (DAT_0007a298 <= dVar30) {
              _DAT_0007fb30 = 0.0;
              goto LAB_00023ee4;
            }
            dVar33 = DAT_0007a298;
            if (_DAT_0007fb30 != 0.0) {
              dVar33 = _DAT_0007fb30 * 0.5;
            }
            _DAT_0007fb30 = dVar33;
            if (DAT_0007cf4c != 0) {
              printf("select: clockhop %d %.6f %.6f\n",iVar20,SUB84(dVar30,0),(int)((ulonglong)dVar30 >> 0x20),dVar33);
            }
            iVar21 = iVar3;
            if (ABS(dVar30) < _DAT_0007fb30) goto LAB_00023ee4;
            _DAT_0007fb30 = 0.0;
            if (iVar4 != 0) goto LAB_00023eec;
LAB_000242f0:
            iVar21 = DAT_000cb4d0;
            *(undefined1 *)((int)piVar13 + 0x69) = 6;
            if (iVar21 < 1) {
              dVar31 = 0.0;
              dVar30 = dVar31;
              dVar33 = dVar31;
            }
            else {
              dVar31 = 0.0;
              piVar24 = DAT_0007fb18 + iVar21;
              dVar37 = *(double *)(*DAT_0007fb18 + 0x198);
              piVar19 = DAT_0007fb18;
              dVar30 = dVar31;
              dVar33 = dVar31;
              do {
                piVar23 = piVar19 + 1;
                iVar21 = *piVar19;
                uVar29 = FUN_00022758(iVar21);
                dVar35 = (double)CONCAT44(extraout_s1_01,uVar29);
                dVar36 = *(double *)(iVar21 + 0x198);
                dVar39 = dVar36 - dVar37;
                dVar31 = dVar31 + (dVar39 * dVar39) / dVar35;
                dVar33 = dVar33 + dVar36 / dVar35;
                dVar30 = dVar30 + 1.0 / dVar35;
                piVar19 = piVar23;
              } while (piVar23 != piVar24);
            }
            _DAT_000cb4c8 = dVar33 / dVar30;
            DAT_000cb4e8 = SQRT(dVar32 * dVar32 + SQRT(dVar31 / dVar30) * SQRT(dVar31 / dVar30));
          }
          iVar21 = DAT_0007cf4c;
          if (DAT_0007cf4c != 0) {
            printf("select: combine offset %.9f jitter %.9f\n",DAT_000cb4e8._4_4_,DAT_000cb4c8,DAT_000cb4cc,
                   DAT_000cb4e8._0_4_,DAT_000cb4e8._4_4_);
            iVar21 = DAT_0007cf4c;
          }
        }
        DAT_0007cf4c = iVar21;
        if ((local_398 == (int *)0x0) || (0.4 <= ABS(_DAT_000cb4c8))) {
          if (piVar13 == (int *)0x0) {
LAB_00023f68:
            if (iVar3 != 0) {
              FUN_0001d3d8(8,0,0);
            }
            DAT_000cb470 = 0;
            do {
              local_384 = local_384 + 1;
              for (piVar13 = (int *)*local_384; piVar13 != (int *)0x0; piVar13 = (int *)*piVar13) {
                *(undefined1 *)(piVar13 + 0x1a) = *(undefined1 *)((int)piVar13 + 0x69);
              }
            } while (local_384 != (int *)&DAT_000cb438);
            return;
          }
        }
        else {
          if ((*(char *)((int)local_398 + 0x40) == '\x16') && (iVar4 == 0)) {
            if (piVar13 != (int *)0x0) goto LAB_00024058;
            if (DAT_0007a2b4 != 0) goto LAB_00023f68;
          }
          _DAT_0007fb30 = 0.0;
          *(undefined1 *)((int)local_398 + 0x69) = 7;
          _DAT_000cb4c8 = *(double *)((int)local_398 + 0x198);
          DAT_000cb4e8 = *(double *)((int)local_398 + 0x1a8);
          piVar13 = local_398;
          if (iVar21 != 0) {
            printf("select: pps offset %.9f jitter %.9f\n");
          }
        }
LAB_00024058:
        uVar18 = *(uint *)((int)piVar13 + 0x70);
        if (uVar18 <= DAT_000cb4a8) {
          return;
        }
        if ((int *)iVar3 != piVar13) {
          FUN_0001d3d8(0x8a,piVar13,0);
          uVar18 = *(uint *)((int)piVar13 + 0x70);
        }
        do {
          local_384 = local_384 + 1;
          for (piVar19 = (int *)*local_384; piVar19 != (int *)0x0; piVar19 = (int *)*piVar19) {
            *(undefined1 *)(piVar19 + 0x1a) = *(undefined1 *)((int)piVar19 + 0x69);
          }
        } while (local_384 != (int *)&DAT_000cb438);
        if (DAT_000cabc8 < *(byte *)((int)piVar13 + 0x31)) {
          DAT_000cabc8 = *(byte *)((int)piVar13 + 0x31);
        }
        if (*(byte *)((int)piVar13 + 0x32) < DAT_000cabc8) {
          DAT_000cabc8 = *(byte *)((int)piVar13 + 0x32);
        }
        DAT_000cb470 = (int)piVar13;
        DAT_000cb4a8 = uVar18;
        FUN_00022f68(piVar13,DAT_000cabc8);
        bVar1 = *(byte *)((int)piVar13 + 0x45);
        if (bVar1 < 0xf) {
          DAT_000cb4fc = bVar1 + 1;
        }
        else {
          DAT_000cb4fc = '\x10';
        }
        if ((bVar1 & 0xef) == 0) {
          DAT_000cb4e0 = *(undefined4 *)((int)piVar13 + 0x58);
        }
        else {
          DAT_000cb4e0 = FUN_0004d0b4((int)piVar13 + 0xc);
        }
        DAT_000cb500 = *(undefined4 *)((int)piVar13 + 0x180);
        DAT_000cb504 = *(undefined4 *)((int)piVar13 + 0x184);
        DAT_000cb4b8 = *(double *)((int)piVar13 + 0x1a0) + *(double *)((int)piVar13 + 0x48);
        DAT_000cb498 = ABS(_DAT_000cb4c8) + DAT_000cb4e8 + *(double *)((int)piVar13 + 0x1b0) + DAT_000cb4b8 * 0.5 +
                       (double)(uint)(DAT_000cb548 - *(int *)((int)piVar13 + 0x1f8)) * DAT_0007a1c0 +
                       *(double *)((int)piVar13 + 0x50);
        if (DAT_0007cf4c != 0) {
          printf("clock_update: at %lu sample %lu associd %d\n",DAT_000cb548,*(undefined4 *)((int)piVar13 + 0x70),
                 (uint)*(ushort *)((int)piVar13 + 0x2c));
        }
        iVar21 = FUN_0001fc5c(SUB84(_DAT_000cb4c8,0),piVar13);
        if (iVar21 != 1) {
          if (iVar21 == 2) {
            FUN_00021654();
            if ((char)DAT_000cb478 < 0) {
              DAT_000cb4e8 = 1.0 / (double)(longlong)(1 << (-(int)(char)DAT_000cb478 & 0xffU));
            }
            else {
              DAT_000cb4e8 = (double)(longlong)(1 << (uint)DAT_000cb478);
            }
            DAT_000cb498 = 0.0;
            DAT_000cb4b0 = '\x03';
            DAT_000cb4b8 = 0.0;
            DAT_000cb4e0 = 0x50455453;
            DAT_000cb4fc = '\x10';
            DAT_000cb500 = 0;
            DAT_000cb504 = 0;
            DAT_000cb56c = 0;
            return;
          }
          if (iVar21 != -1) {
            return;
          }
                    /* WARNING: Subroutine does not return */
          exit(-1);
        }
        if (DAT_000cb4b0 == '\x03') {
          DAT_000cb4b0 = '\0';
        }
        FUN_0004cba8(local_380);
        uVar18 = local_380[0];
        if (DAT_000cb4d8 != 0) {
          if (local_380[0] < DAT_000cb4d8) {
            DAT_000cabcc = DAT_000cb450 + -1;
            if (DAT_000cb56c == 0) {
              FUN_0001d3d8(9,0,0);
            }
            DAT_000cb56c = DAT_000cb4d8 - local_380[0];
            return;
          }
          DAT_000cabcc = DAT_000cb450;
          return;
        }
        if (DAT_000cb4d0 / 2 < DAT_0007fb28) {
          iVar21 = FUN_0002e0d0(local_380[0]);
          DAT_000cb454 = iVar21 + uVar18;
          if (DAT_000cb454 <= local_380[0]) {
            return;
          }
          if (DAT_000cb56c == 0) {
            FUN_0001d3d8(0x89,piVar13);
          }
          DAT_000cb56c = DAT_000cb454 - local_380[0];
          return;
        }
        if (DAT_000cb56c == 0) {
          return;
        }
        FUN_0001d3d8(10,0,0);
        DAT_000cb56c = 0;
        return;
      }
      iVar4 = 0;
      goto LAB_00023fcc;
    }
    if ((dVar32 <= dVar33) || ((*(uint *)(DAT_0007fb18[iVar4] + 0x34) & 0x420) != 0)) goto LAB_00023e04;
    if (2 < DAT_0007cf4c) {
      uVar8 = FUN_00050cd0(DAT_0007fb18[iVar4] + 0xc);
      printf("select: drop %s seljit %.6f jit %.6f\n",uVar8,uVar29,uVar22,dVar33);
    }
    if (DAT_0007a2bc < iVar21) {
      *(undefined1 *)(DAT_0007fb18[iVar4] + 0x69) = 5;
    }
    iVar20 = iVar4 + 1;
    if (iVar20 < iVar21) {
      piVar19 = DAT_0007fb18 + iVar4;
      puVar27 = &local_378 + iVar20;
      puVar10 = &local_1e8 + iVar20;
      puVar6 = &local_378 + iVar4;
      puVar26 = &local_1e8 + iVar4;
      iVar25 = 0;
      piVar13 = piVar19;
      do {
        piVar13 = piVar13 + 1;
        uVar38 = *puVar27;
        puVar27 = puVar27 + 1;
        uVar34 = *puVar10;
        puVar10 = puVar10 + 1;
        *(int *)((int)piVar19 + iVar25) = *piVar13;
        iVar25 = iVar25 + 4;
        *puVar6 = uVar38;
        puVar6 = puVar6 + 1;
        *puVar26 = uVar34;
        puVar26 = puVar26 + 1;
        iVar20 = iVar21;
      } while (iVar25 != ((iVar21 + -1) - iVar4) * 4);
    }
    iVar21 = iVar21 + -1;
    iVar9 = iVar9 + -4;
    if (0 < iVar21) goto LAB_00023898;
LAB_00023ac4:
    uVar29 = 0;
    uVar22 = 0;
    dVar32 = 0.0;
    iVar4 = 0;
    dVar33 = 1000000000.0;
  } while( true );
}




/* WARNING: Removing unreachable block (ram,0x00024b48) */
/* WARNING: Removing unreachable block (ram,0x00024aec) */
/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00024a7c */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_000246a0(int param_1)

{
  uint uVar1;
  double *pdVar2;
  uint uVar3;
  double *pdVar4;
  int *piVar5;
  int iVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  bool bVar13;
  double in_d0;
  undefined8 in_d1;
  undefined8 in_d2;
  double dVar14;
  double dVar15;
  double dVar16;
  double dVar17;
  int iStack_ec;
  int local_e8 [8];
  double local_c8 [7];
  undefined8 local_90;
  char acStack_88 [84];
  
  iVar9 = DAT_000cb548;
  dVar16 = DAT_0007a1c0;
  iVar6 = *(int *)(param_1 + 0x80);
  pdVar2 = (double *)&local_90;
  uVar3 = DAT_000cb548 - *(int *)(param_1 + 0x1f8);
  iVar11 = param_1 + iVar6 * 8;
  *(int *)(param_1 + (iVar6 + 0x52) * 4) = DAT_000cb548;
  *(double *)(iVar11 + 200) = in_d0;
  *(undefined8 *)(iVar11 + 0x88) = in_d1;
  *(undefined8 *)(iVar11 + 0x108) = in_d2;
  uVar1 = (uint)(byte)DAT_0007a1b8;
  *(int *)(param_1 + 0x1f8) = iVar9;
  iVar11 = 7;
  iVar6 = (iVar6 + 1) % 8;
  *(int *)(param_1 + 0x80) = iVar6;
  do {
    pdVar4 = (double *)(param_1 + (iVar6 + 0x21) * 8);
    if (iVar11 != 0) {
      dVar15 = (double)uVar3 * dVar16 + *pdVar4;
    }
    else {
      dVar15 = *pdVar4;
    }
    if (iVar11 != 0) {
      *pdVar4 = dVar15;
    }
    if (16.0 <= dVar15) {
      *(undefined8 *)(param_1 + (iVar6 + 0x21) * 8) = 0x4030000000000000;
      *pdVar2 = 16.0;
    }
    else {
      iVar10 = param_1 + iVar6 * 8;
      if ((uint)(1 << uVar1) < (uint)(iVar9 - *(int *)(param_1 + (iVar6 + 0x52) * 4))) {
        *pdVar2 = *(double *)(iVar10 + 0x88) + dVar15;
      }
      else {
        uVar7 = *(undefined4 *)(iVar10 + 0x8c);
        *(undefined4 *)pdVar2 = *(undefined4 *)(iVar10 + 0x88);
        *(undefined4 *)((int)pdVar2 + 4) = uVar7;
      }
    }
    dVar15 = DAT_0007a2a8;
    local_e8[iVar11] = iVar6;
    iVar11 = iVar11 + -1;
    pdVar2 = pdVar2 + -1;
    iVar6 = (iVar6 + 1) % 8;
  } while (iVar11 != -1);
  if (DAT_000cb4b0 != '\x03') {
    pdVar2 = local_c8;
    iVar9 = 1;
    piVar5 = local_e8;
    do {
      pdVar2 = pdVar2 + 1;
      iVar6 = 0;
      iVar11 = 0;
      pdVar4 = local_c8;
      do {
        dVar16 = *pdVar4;
        iVar11 = iVar11 + 1;
        if (*pdVar2 < dVar16) {
          iVar12 = *(int *)((int)local_e8 + iVar6);
          *pdVar4 = *pdVar2;
          iVar10 = piVar5[1];
          *pdVar2 = dVar16;
          *(int *)((int)local_e8 + iVar6) = iVar10;
          piVar5[1] = iVar12;
        }
        iVar6 = iVar6 + 4;
        pdVar4 = pdVar4 + 1;
      } while (iVar11 < iVar9);
      iVar9 = iVar9 + 1;
      piVar5 = piVar5 + 1;
    } while (iVar9 != 8);
  }
  pdVar2 = local_c8;
  piVar5 = &iStack_ec;
  iVar11 = 0;
  iVar9 = param_1;
  do {
    dVar16 = *pdVar2;
    pdVar2 = pdVar2 + 1;
    piVar5 = piVar5 + 1;
    *(char *)(iVar9 + 0x168) = (char)*piVar5;
    if ((dVar16 < 16.0) && ((iVar11 < 2 || (dVar16 < dVar15)))) {
      iVar11 = iVar11 + 1;
    }
    iVar9 = iVar9 + 1;
  } while (piVar5 != local_e8 + 7);
  dVar16 = 0.0;
  *(undefined8 *)(param_1 + 0x1a8) = 0;
  *(undefined8 *)(param_1 + 0x1b0) = 0;
  iVar9 = 7;
  do {
    iVar10 = iVar9 + -1;
    iVar6 = param_1 + local_e8[iVar9] * 8;
    dVar16 = (dVar16 + *(double *)(iVar6 + 0x108)) * 0.5;
    if (iVar9 < iVar11) {
      dVar15 = *(double *)(iVar6 + 200) - *(double *)(param_1 + (local_e8[0] + 0x19) * 8);
      *(double *)(param_1 + 0x1a8) = *(double *)(param_1 + 0x1a8) + dVar15 * dVar15;
    }
    iVar9 = iVar10;
  } while (iVar10 != -1);
  *(double *)(param_1 + 0x1b0) = dVar16;
  if (iVar11 != 0) {
    bVar13 = iVar11 == 1;
    if (!bVar13) {
      dVar16 = *(double *)(param_1 + 0x1a8);
      iVar6 = iVar11 + -1;
    }
    if (bVar13) {
      in_d0 = *(double *)(param_1 + 0x1a8);
    }
    iVar9 = param_1 + local_e8[0] * 8;
    dVar15 = *(double *)(iVar9 + 200);
    if (!bVar13) {
      in_d0 = (double)CONCAT44((int)((ulonglong)in_d0 >> 0x20),iVar6);
    }
    dVar14 = *(double *)(param_1 + 0x198);
    uVar7 = *(undefined4 *)(iVar9 + 0x88);
    uVar8 = *(undefined4 *)(iVar9 + 0x8c);
    *(double *)(param_1 + 0x198) = dVar15;
    if (!bVar13) {
      in_d0 = (double)(longlong)SUB84(in_d0,0);
    }
    *(undefined4 *)(param_1 + 0x1a0) = uVar7;
    *(undefined4 *)(param_1 + 0x1a4) = uVar8;
    if (!bVar13) {
      in_d0 = dVar16 / in_d0;
    }
    if (!bVar13) {
      *(double *)(param_1 + 0x1a8) = in_d0;
    }
    dVar16 = DAT_0007a2a8;
    if ((char)DAT_000cb478 < 0) {
      dVar17 = 1.0 / (double)(longlong)(1 << (-(int)(char)DAT_000cb478 & 0xffU));
    }
    else {
      dVar17 = (double)(longlong)(1 << (uint)DAT_000cb478);
    }
    if (dVar17 < SQRT(in_d0)) {
      dVar17 = SQRT(*(double *)(param_1 + 0x1a8));
    }
    bVar13 = DAT_0007a2a8 <= *(double *)(param_1 + 0x1b0);
    *(double *)(param_1 + 0x1a8) = dVar17;
    if (((bVar13) || (dVar16 <= *(double *)(param_1 + local_e8[0] * 8 + 0x108))) ||
       (ABS(dVar14 - dVar15) <= dVar17 * 3.0)) {
      uVar1 = *(uint *)(param_1 + 0x70);
      uVar3 = *(uint *)(param_1 + (local_e8[0] + 0x52) * 4);
    }
    else {
      uVar1 = *(uint *)(param_1 + 0x70);
      uVar3 = *(uint *)(param_1 + (local_e8[0] + 0x52) * 4);
      dVar16 = (double)(longlong)(1 << (uint)*(byte *)(param_1 + 0x30));
      if ((double)(uVar3 - uVar1) < dVar16 + dVar16) {
        snprintf(acStack_88,0x50,"%.6f s");
        FUN_0001d3d8(0x8d,param_1,acStack_88);
        return;
      }
    }
    if (uVar3 <= uVar1) {
      if (DAT_0007cf4c == 0) {
        return;
      }
      printf("clock_filter: old sample %lu\n",DAT_000cb548 - uVar3);
      return;
    }
    *(uint *)(param_1 + 0x70) = uVar3;
    uVar7 = FUN_0001c1bc(param_1);
    FUN_0002dbd4((int)*(undefined8 *)(param_1 + 0x198),(int)((ulonglong)*(undefined8 *)(param_1 + 0x198) >> 0x20),
                 (int)*(undefined8 *)(param_1 + 0x1a0),(int)((ulonglong)*(undefined8 *)(param_1 + 0x1a0) >> 0x20),
                 (int)*(undefined8 *)(param_1 + 0x1b0),(int)((ulonglong)*(undefined8 *)(param_1 + 0x1b0) >> 0x20),
                 (int)*(undefined8 *)(param_1 + 0x1a8),param_1 + 0xc,uVar7);
    if (DAT_0007cf4c != 0) {
      iStack_ec = *(int *)(param_1 + 0x1ac);
      printf("clock_filter: n %d off %.6f del %.6f dsp %.6f jit %.6f\n",iVar11,*(undefined4 *)(param_1 + 0x198),
             *(undefined4 *)(param_1 + 0x19c));
    }
    if ((*(int *)(param_1 + 0x74) != 0) && (DAT_000cb4b0 != '\x03')) {
      return;
    }
  }
  FUN_000232c4();
  return;
}




void FUN_00024b88(int param_1,byte *param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  int iVar5;
  char *__format;
  byte bVar6;
  uint uVar7;
  uint uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  bool bVar14;
  double dVar15;
  double dVar16;
  uint local_158;
  uint local_154;
  uint local_150;
  uint local_14c;
  uint local_148;
  uint local_144;
  uint local_140;
  uint local_13c;
  char acStack_138 [260];
  
  uVar7 = *(uint *)(param_2 + 4);
  uVar2 = *(uint *)(param_2 + 8);
  DAT_000cb474 = DAT_000cb474 + 1;
  *(int *)(param_1 + 0x228) = *(int *)(param_1 + 0x228) + 1;
  uVar11 = (uint)param_2[1];
  uVar4 = *(uint *)(param_2 + 0x24);
  uVar13 = uVar11;
  if (0xf < uVar11) {
    uVar13 = 0x10;
  }
  local_154 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  iVar5 = *(int *)(param_1 + 0x28);
  bVar6 = *param_2;
  if (uVar11 == 0) {
    uVar13 = 0x10;
  }
  uVar4 = *(uint *)(param_2 + 0x10);
  if (uVar11 == 0) {
    uVar11 = uVar13;
  }
  uVar12 = *(uint *)(param_2 + 0x14);
  uVar3 = *(uint *)(param_2 + 0x20);
  if (iVar5 != 0) {
    iVar5 = iVar5 + 0x14;
  }
  uVar8 = *(uint *)(param_2 + 0x28);
  local_140 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  uVar4 = *(uint *)(param_2 + 0x2c);
  local_13c = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
  dVar16 = (double)(uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 | (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18) *
           1.52587890625e-05;
  uVar12 = *(uint *)(param_2 + 0x18);
  uVar7 = *(uint *)(param_2 + 0x1c);
  local_158 = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 | (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
  local_150 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
  local_14c = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  local_148 = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
  local_144 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 | (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
  bVar1 = bVar6 >> 6;
  dVar15 = (double)(uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 | (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18) *
           1.52587890625e-05;
  FUN_0002de88(param_1 + 0xc,iVar5,&local_148,&local_158,&local_150,(undefined4 *)(param_1 + 0x180));
  *(byte *)(param_1 + 0x43) = bVar1;
  *(char *)(param_1 + 0x45) = (char)uVar13;
  *(byte *)(param_1 + 0x44) = bVar6 & 7;
  bVar6 = param_2[3];
  *(double *)(param_1 + 0x48) = dVar16;
  *(byte *)(param_1 + 0x47) = bVar6;
  uVar9 = *(undefined4 *)(param_2 + 0xc);
  *(uint *)(param_1 + 0x5c) = local_140;
  *(uint *)(param_1 + 0x60) = local_13c;
  uVar13 = local_13c;
  if (*(int *)(param_1 + 0x78) < 1) {
    uVar13 = (uint)*(byte *)(param_1 + 0x30);
  }
  *(undefined4 *)(param_1 + 0x58) = uVar9;
  *(double *)(param_1 + 0x50) = dVar15;
  if (0 < *(int *)(param_1 + 0x78)) {
    uVar13 = (uint)*(byte *)(param_1 + 0x30);
    *(undefined4 *)(param_1 + 0x78) = 0;
    if (*(char *)(param_1 + 0x6a) == '\0') {
      *(undefined4 *)(param_1 + 0x74) = 5;
    }
    else {
      iVar5 = 1 << (uVar13 - *(byte *)(param_1 + 0x31) & 0xff);
      if (7 < iVar5) {
        iVar5 = 8;
      }
      *(int *)(param_1 + 0x74) = iVar5 + -1;
      if (iVar5 + -1 < 1) goto LAB_00024d08;
    }
    *(undefined4 *)(param_1 + 0x208) = DAT_000cb548;
  }
LAB_00024d08:
  FUN_00022f68(param_1,uVar13);
  if (((bVar1 == 3) || ((int)uVar11 < DAT_0007fb08)) || (DAT_0007a2a0 <= (int)uVar11)) {
    uVar11 = *(uint *)(param_1 + 0x6c) | 0x20;
    *(uint *)(param_1 + 0x6c) = uVar11;
  }
  else {
    uVar11 = *(uint *)(param_1 + 0x6c);
  }
  bVar14 = 16.0 <= dVar15 + dVar16 * 0.5;
  if (bVar14) {
    uVar11 = uVar11 | 0x40;
  }
  if (bVar14) {
    *(uint *)(param_1 + 0x6c) = uVar11;
  }
  iVar5 = DAT_0007cf4c;
  if ((uVar11 & 0x1ff) != 0) {
    *(int *)(param_1 + 0x238) = *(int *)(param_1 + 0x238) + 1;
    if (iVar5 == 0) {
      return;
    }
    printf("packet: flash header %04x\n");
    return;
  }
  bVar6 = *(byte *)(param_1 + 0x6a);
  if (bVar6 == 0) {
    FUN_0001d3d8(0x84,param_1);
    bVar6 = *(byte *)(param_1 + 0x6a);
    *(undefined4 *)(param_1 + 0x21c) = DAT_000cb548;
  }
  *(byte *)(param_1 + 0x6a) = bVar6 | 1;
  if (*(int *)(param_1 + 0x7c) == 0) {
    if (*(char *)(param_1 + 0x44) == '\x05') {
      uVar11 = *(uint *)(param_1 + 0x34);
      if ((uVar11 & 0x2000) == 0) {
        if (*(int *)(param_1 + 0x184) == 0) {
          uVar4 = local_150 - *(int *)(param_1 + 0x180);
          uVar2 = local_14c;
        }
        else {
          uVar13 = -*(int *)(param_1 + 0x184);
          uVar2 = (local_14c & 0xffff) + (uVar13 & 0xffff);
          uVar13 = (local_14c >> 0x10) + (uVar13 >> 0x10);
          if ((uVar2 & 0x10000) != 0) {
            uVar13 = uVar13 + 1;
          }
          uVar4 = ~*(uint *)(param_1 + 0x180) + local_150;
          uVar2 = uVar2 & 0xffff | uVar13 << 0x10;
          if ((uVar13 & 0x10000) != 0) {
            uVar4 = uVar4 + 1;
          }
        }
        if ((int)uVar4 < 0) {
          dVar15 = 2.3283064365386963e-10;
          if (uVar2 == 0) {
            uVar4 = -uVar4;
            uVar2 = 0;
          }
          else {
            uVar2 = -uVar2;
            uVar4 = ~uVar4;
          }
          dVar16 = -((double)(longlong)(int)uVar4 + (double)uVar2 * 2.3283064365386963e-10);
        }
        else {
          dVar15 = 2.3283064365386963e-10;
          dVar16 = (double)(longlong)(int)uVar4 + (double)uVar2 * 2.3283064365386963e-10;
        }
      }
      else {
        if (*(int *)(param_1 + 0x18c) == 0) {
          uVar4 = local_148 - *(int *)(param_1 + 0x188);
          uVar2 = local_144;
        }
        else {
          uVar13 = -*(int *)(param_1 + 0x18c);
          uVar2 = (local_144 & 0xffff) + (uVar13 & 0xffff);
          uVar13 = (local_144 >> 0x10) + (uVar13 >> 0x10);
          if ((uVar2 & 0x10000) != 0) {
            uVar13 = uVar13 + 1;
          }
          uVar4 = ~*(uint *)(param_1 + 0x188) + local_148;
          uVar2 = uVar2 & 0xffff | uVar13 << 0x10;
          if ((uVar13 & 0x10000) != 0) {
            uVar4 = uVar4 + 1;
          }
        }
        if ((int)uVar4 < 0) {
          if (uVar2 == 0) {
            uVar4 = -uVar4;
            uVar2 = 0;
          }
          else {
            uVar2 = -uVar2;
            uVar4 = ~uVar4;
          }
          dVar15 = -((double)(longlong)(int)uVar4 + (double)uVar2 * 2.3283064365386963e-10);
        }
        else {
          dVar15 = (double)(longlong)(int)uVar4 + (double)uVar2 * 2.3283064365386963e-10;
        }
        if (*(int *)(param_1 + 0x194) == 0) {
          uVar4 = local_148 - *(int *)(param_1 + 400);
          uVar13 = local_144;
        }
        else {
          uVar13 = -*(int *)(param_1 + 0x194);
          uVar2 = (local_144 >> 0x10) + (uVar13 >> 0x10);
          uVar13 = (local_144 & 0xffff) + (uVar13 & 0xffff);
          if ((uVar13 & 0x10000) != 0) {
            uVar2 = uVar2 + 1;
          }
          uVar4 = ~*(uint *)(param_1 + 400) + local_148;
          uVar13 = uVar13 & 0xffff | uVar2 << 0x10;
          if ((uVar2 & 0x10000) != 0) {
            uVar4 = uVar4 + 1;
          }
        }
        if ((int)uVar4 < 0) {
          if (uVar13 == 0) {
            uVar4 = -uVar4;
            uVar13 = 0;
          }
          else {
            uVar13 = -uVar13;
            uVar4 = ~uVar4;
          }
          dVar16 = -((double)(longlong)(int)uVar4 + (double)uVar13 * 2.3283064365386963e-10);
        }
        else {
          dVar16 = (double)(longlong)(int)uVar4 + (double)uVar13 * 2.3283064365386963e-10;
        }
        *(uint *)(param_1 + 0x188) = local_150;
        *(uint *)(param_1 + 0x18c) = local_14c;
        *(undefined4 *)(param_1 + 400) = *(undefined4 *)(param_1 + 0x180);
        *(undefined4 *)(param_1 + 0x194) = *(undefined4 *)(param_1 + 0x184);
        if ((dVar15 < 0.0) || (1.0 < dVar15)) {
          __format = "offset %.6f delay %.6f";
          uVar10 = (undefined4)((ulonglong)dVar16 >> 0x20);
          uVar9 = SUB84(dVar16,0);
          goto LAB_00024e90;
        }
        *(double *)(param_1 + 0x1b8) = dVar15;
      }
      bVar14 = (uVar11 & 0x10) == 0;
      if (!bVar14) {
        dVar15 = *(double *)(param_1 + 0x198);
      }
      if (bVar14) {
        dVar15 = *(double *)(param_1 + 0x1a0);
      }
      else {
        *(uint *)(param_1 + 0x34) = uVar11 & 0xffffffef;
        dVar15 = (dVar15 - dVar16) + (dVar15 - dVar16);
      }
      if (!bVar14) {
        *(double *)(param_1 + 0x1a0) = dVar15;
      }
      dVar16 = dVar16 + dVar15 * 0.5;
    }
    else {
      if (*(int *)(param_1 + 0x184) == 0) {
        uVar2 = local_150 - *(int *)(param_1 + 0x180);
        uVar13 = local_14c;
      }
      else {
        uVar11 = -*(int *)(param_1 + 0x184);
        uVar13 = (local_14c & 0xffff) + (uVar11 & 0xffff);
        uVar11 = (local_14c >> 0x10) + (uVar11 >> 0x10);
        if ((uVar13 & 0x10000) != 0) {
          uVar11 = uVar11 + 1;
        }
        uVar2 = ~*(uint *)(param_1 + 0x180) + local_150;
        uVar13 = uVar13 & 0xffff | uVar11 << 0x10;
        if ((uVar11 & 0x10000) != 0) {
          uVar2 = uVar2 + 1;
        }
      }
      if ((int)uVar2 < 0) {
        if (uVar13 == 0) {
          uVar2 = -uVar2;
          uVar13 = 0;
        }
        else {
          uVar13 = -uVar13;
          uVar2 = ~uVar2;
        }
        dVar15 = -((double)(longlong)(int)uVar2 + (double)uVar13 * 2.3283064365386963e-10);
      }
      else {
        dVar15 = (double)(longlong)(int)uVar2 + (double)uVar13 * 2.3283064365386963e-10;
      }
      if (local_144 == 0) {
        uVar2 = local_158 - local_148;
        uVar13 = local_154;
      }
      else {
        uVar13 = (local_154 & 0xffff) + (-local_144 & 0xffff);
        uVar11 = (local_154 >> 0x10) + (-local_144 >> 0x10);
        if ((uVar13 & 0x10000) != 0) {
          uVar11 = uVar11 + 1;
        }
        uVar2 = ~local_148 + local_158;
        uVar13 = uVar13 & 0xffff | uVar11 << 0x10;
        if ((uVar11 & 0x10000) != 0) {
          uVar2 = uVar2 + 1;
        }
      }
      if ((int)uVar2 < 0) {
        if (uVar13 == 0) {
          uVar2 = -uVar2;
          uVar13 = 0;
        }
        else {
          uVar13 = -uVar13;
          uVar2 = ~uVar2;
        }
        dVar16 = -((double)(longlong)(int)uVar2 + (double)uVar13 * 2.3283064365386963e-10);
      }
      else {
        dVar16 = (double)(longlong)(int)uVar2 + (double)uVar13 * 2.3283064365386963e-10;
      }
      dVar16 = (dVar16 + dVar15) * 0.5;
    }
    goto LAB_00024fb0;
  }
  if (*(int *)(param_1 + 0x184) == 0) {
    uVar11 = local_150 - *(int *)(param_1 + 0x180);
    uVar13 = local_14c;
  }
  else {
    uVar11 = -*(int *)(param_1 + 0x184);
    uVar13 = (local_14c & 0xffff) + (uVar11 & 0xffff);
    uVar2 = (local_14c >> 0x10) + (uVar11 >> 0x10);
    if ((uVar13 & 0x10000) != 0) {
      uVar2 = uVar2 + 1;
    }
    uVar11 = ~*(uint *)(param_1 + 0x180) + local_150;
    uVar13 = uVar13 & 0xffff | uVar2 << 0x10;
    if ((uVar2 & 0x10000) != 0) {
      uVar11 = uVar11 + 1;
    }
  }
  if ((int)uVar11 < 0) {
    if (uVar13 == 0) {
      uVar11 = -uVar11;
      uVar13 = 0;
    }
    else {
      uVar13 = -uVar13;
      uVar11 = ~uVar11;
    }
    dVar15 = -((double)(longlong)(int)uVar11 + (double)uVar13 * 2.3283064365386963e-10);
  }
  else {
    dVar15 = (double)(longlong)(int)uVar11 + (double)uVar13 * 2.3283064365386963e-10;
  }
  uVar11 = local_154;
  if (*(int *)(param_1 + 0x7c) < 1) {
    if (*(int *)(param_1 + 0x18c) != 0) {
      uVar11 = -*(int *)(param_1 + 0x18c);
      uVar13 = (local_154 & 0xffff) + (uVar11 & 0xffff);
      uVar2 = (local_154 >> 0x10) + (uVar11 >> 0x10);
      uVar11 = *(uint *)(param_1 + 0x188);
      if ((uVar13 & 0x10000) != 0) {
        uVar2 = uVar2 + 1;
      }
      goto LAB_0002515c;
    }
    uVar4 = local_158 - *(int *)(param_1 + 0x188);
  }
  else if (*(int *)(param_1 + 0x194) == 0) {
    uVar4 = local_158 - *(int *)(param_1 + 400);
  }
  else {
    uVar11 = -*(int *)(param_1 + 0x194);
    uVar13 = (local_154 & 0xffff) + (uVar11 & 0xffff);
    uVar2 = (local_154 >> 0x10) + (uVar11 >> 0x10);
    uVar11 = *(uint *)(param_1 + 400);
    if ((uVar13 & 0x10000) != 0) {
      uVar2 = uVar2 + 1;
    }
LAB_0002515c:
    uVar4 = ~uVar11 + local_158;
    uVar11 = uVar13 & 0xffff | uVar2 << 0x10;
    if ((uVar2 & 0x10000) != 0) {
      uVar4 = uVar4 + 1;
    }
  }
  if ((int)uVar4 < 0) {
    if (uVar11 == 0) {
      uVar4 = -uVar4;
      uVar11 = 0;
    }
    else {
      uVar11 = -uVar11;
      uVar4 = ~uVar4;
    }
    dVar16 = -((double)(longlong)(int)uVar4 + (double)uVar11 * 2.3283064365386963e-10);
  }
  else {
    dVar16 = (double)(longlong)(int)uVar4 + (double)uVar11 * 2.3283064365386963e-10;
  }
  if ((dVar16 - dVar15 < 0.0) || (1.0 < dVar16 - dVar15)) {
    uVar10 = (undefined4)((ulonglong)dVar16 >> 0x20);
    uVar9 = SUB84(dVar16,0);
    __format = "t21 %.6f t34 %.6f";
LAB_00024e90:
    sprintf(acStack_138,__format,uVar9,uVar10,dVar15);
    FUN_0001d3d8(0x8f,param_1,acStack_138);
    return;
  }
  dVar16 = (dVar16 + dVar15) * 0.5;
LAB_00024fb0:
  FUN_000246a0(SUB84(dVar16 + *(double *)(param_1 + 0x1c0),0),param_1);
  if ((((*(uint *)(param_1 + 0x34) & 0x10) != 0) && (*(char *)(param_1 + 0x2f) == '\x03')) &&
     (uVar11 = FUN_000227c8(param_1), (uVar11 & 0x400) == 0)) {
    *(undefined1 *)(param_1 + 0x2f) = 6;
  }
  return;
}




void FUN_00025508(int param_1)

{
  double dVar1;
  uint uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  byte bVar10;
  byte bVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  int iVar16;
  uint uVar17;
  uint uVar18;
  int iVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  int iVar23;
  uint uVar24;
  bool bVar25;
  uint local_68;
  uint local_60;
  undefined4 local_3c;
  uint local_38;
  uint local_34;
  uint local_30;
  uint local_2c;
  
  local_3c = 0;
  DAT_000cb4a0 = DAT_000cb4a0 + 1;
  if ((ushort)(*(ushort *)(param_1 + 10) << 8 | *(ushort *)(param_1 + 10) >> 8) < 0x7b) goto LAB_00025544;
  iVar16 = param_1 + 8;
  uVar2 = FUN_0002ca18(iVar16);
  iVar23 = DAT_000cb548;
  if (1 < DAT_0007cf4c) {
    uVar3 = FUN_00050cd0(*(int *)(param_1 + 0x40) + 0x14);
    uVar4 = FUN_00050cd0(iVar16);
    printf("receive: at %ld %s<-%s flags %x restrict %03x\n",iVar23,uVar3,uVar4,
           *(undefined4 *)(*(int *)(param_1 + 0x40) + 0x8c),uVar2);
  }
  uVar21 = (uint)*(byte *)(param_1 + 0x5d);
  bVar11 = *(byte *)(param_1 + 0x5c);
  if (uVar21 == 0) {
    uVar21 = 0x10;
  }
  if ((uVar2 & 1) != 0) goto LAB_00025784;
  uVar20 = bVar11 & 7;
  if (uVar20 == 7) {
    if ((uVar2 & 0x40) == 0) {
      FUN_0002c308(param_1,((uVar2 ^ 0x80) << 0x18) >> 0x1f);
      return;
    }
    goto LAB_00025784;
  }
  if (uVar20 == 6) {
    if ((uVar2 & 0x40) == 0) {
      FUN_0001bd68(param_1,uVar2);
      return;
    }
    goto LAB_00025784;
  }
  if (((uVar2 & 2) != 0) ||
     (((uVar2 & 0x1000) != 0 && (iVar23 = FUN_000504ec(), (double)(longlong)iVar23 / 2147483647.0 < 0.1))))
  goto LAB_00025784;
  uVar22 = ((uint)bVar11 << 0x1a) >> 0x1d;
  if (uVar22 == 4) {
    DAT_000cb484 = DAT_000cb484 + 1;
    if ((bVar11 & 7) == 0) goto LAB_00025544;
  }
  else {
    if (((uVar2 & 8) != 0) || (uVar22 == 0)) goto LAB_00025544;
    DAT_000cb4c0 = DAT_000cb4c0 + 1;
    if ((bVar11 & 7) == 0) {
      if (uVar22 != 1) goto LAB_00025544;
      uVar20 = 3;
    }
  }
  iVar23 = param_1 + 0x5c;
  uVar24 = *(uint *)(param_1 + 0x58) - 0x30;
  if (uVar24 != 0) {
    if (((uVar24 & 3) == 0) && (3 < uVar24)) {
      uVar18 = 0x30;
      while( true ) {
        if (uVar24 < 0x19) {
          uVar6 = uVar18 + 3;
          if (-1 < (int)uVar18) {
            uVar6 = uVar18;
          }
          uVar6 = *(uint *)(iVar23 + ((int)uVar6 >> 2) * 4);
          local_60 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 | (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
          goto LAB_000256fc;
        }
        uVar6 = uVar18 + 3;
        if (-1 < (int)uVar18) {
          uVar6 = uVar18;
        }
        uVar9 = *(uint *)(iVar23 + ((int)uVar6 >> 2) * 4);
        uVar6 = uVar9 >> 0x18;
        uVar9 = (uVar9 >> 0x10 & 0xff) << 8 | uVar6;
        uVar18 = uVar18 + uVar9;
        uVar24 = uVar24 - uVar9;
        if ((((uVar6 & 3) != 0) || (uVar9 < 4)) || (*(uint *)(param_1 + 0x58) < uVar18)) break;
        if (uVar24 == 0) goto LAB_000256e8;
        if (((uVar24 & 3) != 0) || (uVar24 < 4)) break;
      }
    }
LAB_00025544:
    DAT_000cb490 = DAT_000cb490 + 1;
    return;
  }
  uVar18 = 0x30;
LAB_000256e8:
  if ((uVar2 & 4) != 0) goto LAB_00025784;
  uVar24 = 0;
  local_60 = 0;
LAB_000256fc:
  uVar2 = FUN_00020f08(param_1,uVar2);
  if ((uVar2 & 0x20) != 0) {
    DAT_000cb4c4 = DAT_000cb4c4 + 1;
    if ((uVar2 & 0x400) == 0) {
      return;
    }
    if (uVar20 - 4 < 2) {
      return;
    }
    local_68 = uVar2;
    if (uVar20 != 3) {
      FUN_0000b1d8(param_1,1,local_60,uVar2);
      return;
    }
    goto LAB_00025f54;
  }
  iVar5 = FUN_00022588(param_1,uVar20,&local_3c);
  iVar8 = DAT_000cb548;
  uVar9 = *(uint *)(param_1 + 0x7c);
  uVar6 = *(uint *)(param_1 + 0x80);
  uVar12 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
  uVar9 = *(uint *)(param_1 + 0x84);
  uVar6 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 | (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
  uVar13 = *(uint *)(param_1 + 0x88);
  uVar9 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
  uVar14 = uVar13 << 0x18 | (uVar13 >> 8 & 0xff) << 0x10 | (uVar13 >> 0x10 & 0xff) << 8 | uVar13 >> 0x18;
  uVar13 = *(uint *)(param_1 + 0x74);
  iVar7 = *(int *)(param_1 + 0x40) + 0x14;
  uVar15 = *(uint *)(param_1 + 0x78);
  uVar13 = uVar13 << 0x18 | (uVar13 >> 8 & 0xff) << 0x10 | (uVar13 >> 0x10 & 0xff) << 8 | uVar13 >> 0x18;
  uVar15 = uVar15 << 0x18 | (uVar15 >> 8 & 0xff) << 0x10 | (uVar15 >> 0x10 & 0xff) << 8 | uVar15 >> 0x18;
  local_38 = uVar12;
  local_34 = uVar6;
  local_30 = uVar9;
  local_2c = uVar14;
  if (uVar24 == 0) {
    uVar17 = 0;
    if (DAT_0007cf4c != 0) {
      uVar3 = FUN_00050cd0(iVar7);
      uVar4 = FUN_00050cd0(iVar16);
      printf("receive: at %ld %s<-%s mode %d len %d\n",iVar8,uVar3,uVar4,uVar20,uVar18);
    }
  }
  else if (uVar24 == 4) {
    if (DAT_0007cf4c == 0) {
      uVar17 = 3;
    }
    else {
      iVar19 = uVar18 + 4;
      uVar17 = 3;
      uVar3 = FUN_00050cd0(iVar7);
      uVar4 = FUN_00050cd0(iVar16);
LAB_00025ea0:
      printf("receive: at %ld %s<-%s mode %d keyid %08x len %d auth %d\n",iVar8,uVar3,uVar4,uVar20,local_60,iVar19,
             uVar17);
    }
  }
  else {
    iVar19 = FUN_0004e4e4(local_60,iVar23,uVar18,uVar24);
    iVar8 = DAT_000cb548;
    if (iVar19 == 0) {
      uVar17 = 2;
    }
    else {
      uVar17 = 1;
    }
    if (DAT_0007cf4c != 0) {
      uVar3 = FUN_00050cd0(iVar7);
      uVar4 = FUN_00050cd0(iVar16);
      iVar19 = uVar18 + uVar24;
      goto LAB_00025ea0;
    }
  }
  local_68 = uVar2 & 0xfffff3ff;
  bVar11 = bVar11 >> 6;
  switch(local_3c) {
  case 1:
    break;
  case 3:
    if ((*(uint *)(*(int *)(param_1 + 0x40) + 0x8c) & 0x40) == 0) {
      if ((uVar2 & 4) == 0) {
        bVar25 = uVar17 < 2;
      }
      else {
        bVar25 = uVar17 == 1;
      }
      if (bVar25) {
LAB_00025f54:
        FUN_0000b1d8(param_1,4,local_60,local_68);
        return;
      }
      if (uVar17 == 2) {
        FUN_0000b1d8(param_1,4,0,local_68);
        DAT_000cb4f8 = DAT_000cb4f8 + 1;
        return;
      }
    }
    else if (DAT_000cb4ac != 0) {
      if ((((DAT_000cb4b0 != '\x03') && (DAT_000cb4fc < uVar21)) &&
          ((DAT_0007fb38 != 0 || ((uint)DAT_000cb4fc != uVar21 + 1)))) &&
         (*(int *)(*(int *)(param_1 + 0x40) + 0x94) != *(int *)(param_1 + 0x68))) {
        if ((uVar2 & 4) == 0) {
          bVar25 = uVar17 < 2;
        }
        else {
          bVar25 = uVar17 == 1;
        }
        if (!bVar25) {
          return;
        }
        goto LAB_00025f54;
      }
      goto switchD_0002591c_caseD_ffffffff;
    }
LAB_00025784:
    DAT_000cb4dc = DAT_000cb4dc + 1;
    return;
  case 4:
    if ((uVar2 & 0x14) == 0 && DAT_000cb46c == 0) {
      uVar18 = (uint)(1 < uVar17);
    }
    else {
      uVar18 = uVar17 - 1;
      if (uVar18 != 0) {
        uVar18 = 1;
      }
    }
    if (uVar18 != 0) goto LAB_00025784;
    if (((bVar11 == 3) || ((int)uVar21 < DAT_0007fb08)) || (DAT_0007a2a0 <= (int)uVar21))
    goto switchD_0002591c_caseD_ffffffff;
    iVar8 = FUN_000224f4(param_1);
    if (iVar8 == 0) goto LAB_00025784;
    iVar5 = FUN_00021d24(iVar16,*(undefined4 *)(param_1 + 0x40),3,uVar22,6,10,2,0x41,0,local_60);
    if (iVar5 == 0) goto switchD_0002591c_caseD_ffffffff;
    uVar22 = *(uint *)(iVar8 + 0x34);
    bVar25 = (uVar22 & 0x100) != 0;
    if (bVar25) {
      uVar22 = *(uint *)(iVar5 + 0x34);
    }
    *(undefined1 *)(iVar5 + 0x31) = *(undefined1 *)(iVar8 + 0x31);
    if (bVar25) {
      *(uint *)(iVar5 + 0x34) = uVar22 | 0x100;
    }
    *(undefined1 *)(iVar5 + 0x32) = *(undefined1 *)(iVar8 + 0x32);
    break;
  case 5:
    if ((uVar2 & 0x14) == 0 && DAT_000cb46c == 0) {
      uVar18 = (uint)(1 < uVar17);
    }
    else {
      uVar18 = uVar17 - 1;
      if (uVar18 != 0) {
        uVar18 = 1;
      }
    }
    if (uVar18 != 0) {
      if ((uVar2 & 4) == 0) {
        bVar25 = uVar17 < 2;
      }
      else {
        bVar25 = uVar17 == 1;
      }
      if (bVar25) {
        FUN_0000b1d8(param_1,2,local_60,local_68);
        return;
      }
      if (uVar17 == 2) {
        FUN_0000b1d8(param_1,1,0,local_68);
        DAT_000cb4dc = DAT_000cb4dc + 1;
      }
    }
    if (((bVar11 != 3) && (((int)uVar21 < DAT_0007fb08 || (DAT_0007a2a0 <= (int)uVar21)))) ||
       (iVar5 = FUN_00021d24(iVar16,*(undefined4 *)(param_1 + 0x40),2,uVar22,*(undefined1 *)(param_1 + 0x5e),10,2,1,0,
                             local_60), iVar5 == 0)) goto switchD_0002591c_caseD_ffffffff;
    break;
  case 6:
    if (DAT_000cb4f4 == 0) goto LAB_00025784;
    if ((uVar2 & 0x14) == 0 && DAT_000cb46c == 0) {
      uVar18 = (uint)(1 < uVar17);
    }
    else {
      uVar18 = uVar17 - 1;
      if (uVar18 != 0) {
        uVar18 = 1;
      }
    }
    if (uVar18 != 0) goto LAB_00025784;
    if (((bVar11 == 3) || ((int)uVar21 < DAT_0007fb08)) || (DAT_0007a2a0 <= (int)uVar21))
    goto switchD_0002591c_caseD_ffffffff;
    iVar8 = *(int *)(param_1 + 0x40);
    if ((*(uint *)(iVar8 + 0x8c) & 0x40) != 0) {
      iVar8 = 0;
    }
    if (DAT_000cb488 == 0.0) {
      iVar23 = FUN_00021d24(iVar16,iVar8,3,uVar22,*(undefined1 *)(param_1 + 0x5e),*(undefined1 *)(param_1 + 0x5e),0x112,
                            0x20,0,local_60);
      if (iVar23 != 0) {
        return;
      }
      goto LAB_00025784;
    }
    iVar5 = FUN_00021d24(iVar16,iVar8,6,uVar22,*(undefined1 *)(param_1 + 0x5e),*(undefined1 *)(param_1 + 0x5e),2,0x20,0,
                         local_60);
    dVar1 = DAT_000cb488;
    if (iVar5 == 0) goto LAB_00025784;
    *(double *)(iVar5 + 0x1a0) = DAT_000cb488;
    *(double *)(iVar5 + 0x1c0) = -(dVar1 * 0.5);
    break;
  default:
switchD_0002591c_caseD_ffffffff:
    DAT_000cb47c = DAT_000cb47c + 1;
    return;
  }
  uVar18 = *(uint *)(iVar5 + 0x34);
  bVar25 = (uVar18 & 0x4000) != 0;
  uVar22 = *(uint *)(iVar5 + 0x6c) & 0xfffffe00;
  if (bVar25) {
    uVar18 = uVar18 & 0xffffbfff;
  }
  *(uint *)(iVar5 + 0x6c) = uVar22;
  if (bVar25) {
    uVar22 = uVar22 | 4;
    *(uint *)(iVar5 + 0x34) = uVar18;
  }
  if (bVar25) {
    *(uint *)(iVar5 + 0x6c) = uVar22;
  }
  *(int *)(iVar5 + 0x224) = *(int *)(iVar5 + 0x224) + 1;
  if ((uVar9 == 0) && (uVar14 == 0)) {
    *(uint *)(iVar5 + 0x6c) = *(uint *)(iVar5 + 0x6c) | 4;
    if (*(int *)(iVar5 + 0x7c) != 0) goto LAB_00025b20;
    if (uVar20 != 5) goto LAB_00025ff0;
  }
  else {
    if ((*(uint *)(iVar5 + 0x178) == uVar9) && (*(uint *)(iVar5 + 0x17c) == uVar14)) {
      *(uint *)(iVar5 + 0x6c) = *(uint *)(iVar5 + 0x6c) | 1;
      *(int *)(iVar5 + 0x234) = *(int *)(iVar5 + 0x234) + 1;
      return;
    }
    if (uVar20 == 5) {
      if (((uVar13 != 0) || (uVar15 != 0)) && ((*(uint *)(iVar5 + 0x34) & 0x2000) == 0)) {
        *(uint *)(iVar5 + 0x188) = local_30;
        *(uint *)(iVar5 + 0x18c) = local_2c;
        uVar3 = *(undefined4 *)(param_1 + 0x4c);
        uVar4 = *(undefined4 *)(param_1 + 0x50);
        *(uint *)(iVar5 + 0x34) = *(uint *)(iVar5 + 0x34) | 0x2000;
        *(undefined4 *)(iVar5 + 400) = uVar3;
        *(undefined4 *)(iVar5 + 0x194) = uVar4;
        FUN_0001d3d8(0x8e,iVar5);
        return;
      }
      if (*(int *)(iVar5 + 0x7c) != 0) goto LAB_00025b20;
    }
    else {
      iVar16 = *(int *)(iVar5 + 0x7c);
      if (iVar16 == 0) {
        if ((*(uint *)(iVar5 + 0x188) == uVar13) && (*(uint *)(iVar5 + 0x18c) == uVar15)) {
          *(undefined4 *)(iVar5 + 0x18c) = 0;
          *(undefined4 *)(iVar5 + 0x188) = 0;
        }
        else {
          *(int *)(iVar5 + 0x230) = *(int *)(iVar5 + 0x230) + 1;
          *(uint *)(iVar5 + 0x6c) = *(uint *)(iVar5 + 0x6c) | 2;
          if (((*(uint *)(iVar5 + 0x180) != 0) || (*(int *)(iVar5 + 0x184) != 0)) &&
             ((*(uint *)(iVar5 + 0x180) == uVar13 && (*(uint *)(iVar5 + 0x184) == uVar15)))) {
            *(undefined4 *)(iVar5 + 0x7c) = 1;
            FUN_0001d3d8(0x8e,iVar5,0);
            iVar16 = *(int *)(iVar5 + 0x7c);
            goto LAB_000260b8;
          }
        }
      }
      else {
        if ((((uVar13 == 0) && (uVar15 == 0)) || ((uVar12 == 0 && (uVar6 == 0)))) ||
           ((*(uint *)(iVar5 + 0x180) == 0 && (*(int *)(iVar5 + 0x184) == 0)))) {
          *(uint *)(iVar5 + 0x6c) = *(uint *)(iVar5 + 0x6c) | 4;
        }
        else {
          if ((*(uint *)(iVar5 + 0x180) == uVar13) && (*(uint *)(iVar5 + 0x184) == uVar15)) goto LAB_00025b20;
          *(int *)(iVar5 + 0x230) = *(int *)(iVar5 + 0x230) + 1;
          *(uint *)(iVar5 + 0x34) = *(uint *)(iVar5 + 0x34) | 0x4000;
          *(uint *)(iVar5 + 0x6c) = *(uint *)(iVar5 + 0x6c) | 2;
        }
LAB_000260b8:
        if (iVar16 != 0) goto LAB_00025b20;
      }
LAB_00025ff0:
      *(uint *)(iVar5 + 0x170) = local_30;
      *(uint *)(iVar5 + 0x174) = local_2c;
    }
  }
  uVar3 = *(undefined4 *)(param_1 + 0x50);
  *(undefined4 *)(iVar5 + 0x180) = *(undefined4 *)(param_1 + 0x4c);
  *(undefined4 *)(iVar5 + 0x184) = uVar3;
LAB_00025b20:
  *(uint *)(iVar5 + 0x178) = local_30;
  *(uint *)(iVar5 + 0x17c) = local_2c;
  if (uVar17 == 3) {
    FUN_0001d3d8(0x8c,iVar5,"crypto_NAK");
    uVar2 = *(uint *)(iVar5 + 0x34);
    *(uint *)(iVar5 + 0x6c) = *(uint *)(iVar5 + 0x6c) | 0x10;
    *(int *)(iVar5 + 0x22c) = *(int *)(iVar5 + 0x22c) + 1;
  }
  else {
    if ((uVar24 == 0) && ((uVar2 & 4) == 0)) {
      if (uVar17 < 2) {
        iVar16 = 0;
      }
      else {
        iVar16 = 1;
      }
    }
    else {
      iVar16 = uVar17 - 1;
      if (iVar16 != 0) {
        iVar16 = 1;
      }
    }
    if (iVar16 == 0) {
      bVar10 = *(byte *)(param_1 + 0x5e);
      if (*(byte *)(param_1 + 0x5e) <= *(byte *)(iVar5 + 0x31)) {
        bVar10 = *(byte *)(iVar5 + 0x31);
      }
      *(byte *)(iVar5 + 0x46) = bVar10;
      if (((uVar20 == 4 && bVar11 == 3) && (uVar21 == 0x10)) &&
         (iVar16 = memcmp((void *)(param_1 + 0x68),&DAT_00064cc0,4), iVar16 == 0)) {
        *(int *)(iVar5 + 0x23c) = *(int *)(iVar5 + 0x23c) + 1;
        FUN_0001d3d8(0x87,iVar5,0);
        uVar2 = (uint)*(byte *)(iVar5 + 0x31);
        if (uVar2 < *(byte *)(param_1 + 0x5e)) {
          uVar2 = (uint)*(byte *)(iVar5 + 0x46);
          *(byte *)(iVar5 + 0x31) = *(byte *)(iVar5 + 0x46);
        }
        *(int *)(iVar5 + 0x200) = 9 << uVar2;
        *(undefined4 *)(iVar5 + 0x78) = 0;
        *(undefined4 *)(iVar5 + 0x74) = 0;
        FUN_00022f68(iVar5,*(undefined1 *)(param_1 + 0x5e));
        return;
      }
      uVar3 = *(undefined4 *)(param_1 + 0x58);
      *(int *)(iVar5 + 0x218) = DAT_000cb548;
      if (uVar17 == 1) {
        uVar2 = *(uint *)(iVar5 + 0x34) | 4;
      }
      else {
        uVar2 = *(uint *)(iVar5 + 0x34) & 0xfffffffb;
      }
      *(uint *)(iVar5 + 0x34) = uVar2;
      FUN_00024b88(iVar5,iVar23,uVar3);
      iVar23 = DAT_000cb548;
      if (*(int *)(iVar5 + 0x7c) == 0) {
        return;
      }
      bVar11 = *(byte *)(iVar5 + 0x46);
      if (*(byte *)(iVar5 + 0x30) <= bVar11) {
        bVar11 = *(byte *)(iVar5 + 0x30);
      }
      iVar16 = *(int *)(iVar5 + 0x208);
      *(uint *)(iVar5 + 0x170) = local_38;
      *(uint *)(iVar5 + 0x174) = local_34;
      uVar3 = *(undefined4 *)(param_1 + 0x50);
      if ((uint)(iVar16 - iVar23) < (uint)((1 << (uint)bVar11) / 2)) {
        iVar16 = iVar16 + 1;
      }
      else {
        iVar16 = iVar16 + -1;
      }
      *(undefined4 *)(iVar5 + 0x180) = *(undefined4 *)(param_1 + 0x4c);
      *(undefined4 *)(iVar5 + 0x184) = uVar3;
      *(int *)(iVar5 + 0x208) = iVar16;
      return;
    }
    FUN_0001d3d8(0x8c,iVar5,"digest");
    *(uint *)(iVar5 + 0x6c) = *(uint *)(iVar5 + 0x6c) | 0x10;
    *(int *)(iVar5 + 0x22c) = *(int *)(iVar5 + 0x22c) + 1;
    if (uVar20 - 1 < 2) {
      FUN_0000b1d8(param_1,1,0,local_68);
    }
    uVar2 = *(uint *)(iVar5 + 0x34);
  }
  if ((uVar2 & 2) == 0) {
    return;
  }
  FUN_000218bc(iVar5);
  return;
}




/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00026660 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_000263e4(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,int param_5)

{
  byte bVar1;
  undefined4 uVar2;
  int iVar3;
  char cVar4;
  int iVar5;
  uint uVar6;
  bool bVar7;
  
  uVar2 = DAT_000cb548;
  iVar3 = DAT_0007a2c0;
  bVar1 = *(byte *)(param_5 + 0x38);
  uVar6 = (uint)*(byte *)(param_5 + 0x30);
  if ((bVar1 & 6) != 0) {
    bVar7 = DAT_000cb4b0 != '\x03';
    *(undefined4 *)(param_5 + 0x204) = DAT_000cb548;
    if (bVar7) {
      FUN_000228d8();
    }
    goto LAB_0002641c;
  }
  if ((bVar1 & 0x10) != 0) {
    iVar5 = *(int *)(param_5 + 0x1fc);
    *(undefined4 *)(param_5 + 0x204) = DAT_000cb548;
    if (iVar3 < iVar5) {
      *(uint *)(param_5 + 0x1fc) = bVar1 & 6;
      *(char *)(param_5 + 0x3b) = (char)(bVar1 & 6);
      FUN_000228d8();
      iVar5 = *(int *)(param_5 + 0x1fc);
    }
    else if ((DAT_000cb4d0 < DAT_0007a2b8) || (DAT_000cac28 < DAT_0007a2bc)) {
      if ((int)(uint)*(byte *)(param_5 + 0x3b) < DAT_000cb4d4) {
        *(byte *)(param_5 + 0x3b) = *(byte *)(param_5 + 0x3b) + 1;
      }
      FUN_000228d8(param_5);
      iVar5 = *(int *)(param_5 + 0x1fc);
    }
    *(int *)(param_5 + 0x1fc) = iVar5 + 1;
    FUN_00022f68(param_5,uVar6);
    return;
  }
  if (*(int *)(param_5 + 0x74) == 0) {
    cVar4 = *(char *)(param_5 + 0x6a);
    bVar1 = cVar4 << 1;
    *(int *)(param_5 + 0x1fc) = *(int *)(param_5 + 0x1fc) + 1;
    *(byte *)(param_5 + 0x6a) = bVar1;
    *(undefined4 *)(param_5 + 0x204) = uVar2;
    if (((bVar1 & 0xe) == 0) && (FUN_000246a0(0,param_2,0,param_4,0), *(char *)(param_5 + 0x6a) == '\0')) {
      if (cVar4 != '\0') {
        FUN_0001d3d8(0x83,param_5);
      }
      if ((*(uint *)(param_5 + 0x34) & 0x100) != 0) {
        iVar3 = *(int *)(param_5 + 0x78);
joined_r0x00026530:
        if (iVar3 == 0) {
          *(undefined4 *)(param_5 + 0x78) = 3;
        }
      }
    }
    else {
      uVar6 = (uint)DAT_000cabc8;
      if (((*(uint *)(param_5 + 0x34) & 2) == 0) || (*(char *)(param_5 + 0x2f) != '\x03')) {
        *(undefined4 *)(param_5 + 0x1fc) = 0;
      }
      if (((*(uint *)(param_5 + 0x34) & 0x40) != 0) && (*(int *)(param_5 + 0x78) == 0)) {
        iVar3 = FUN_000227c8(param_5);
        goto joined_r0x00026530;
      }
    }
    if ((*(int *)(param_5 + 0x1fc) < 10) || (uVar6 = uVar6 + 1, (*(uint *)(param_5 + 0x34) & 2) == 0))
    goto LAB_00026558;
    FUN_0001d3d8(0x85,param_5,"timeout");
    if (*(char *)(param_5 + 0x2f) != '\x03') {
LAB_0002663c:
      FUN_0002310c(param_5,"TIME");
      FUN_000218bc(param_5);
      return;
    }
    cVar4 = '\x03';
    if (DAT_0007a2bc < DAT_000cac28) {
      iVar3 = FUN_000216d8(param_5);
      if (iVar3 != 0) goto LAB_0002663c;
      goto LAB_00026558;
    }
  }
  else {
    iVar3 = *(int *)(param_5 + 0x74) + -1;
    *(int *)(param_5 + 0x74) = iVar3;
    if (((iVar3 == 0) && (DAT_0007d5ec != 0)) && (DAT_000cb480 = DAT_000cb480 + -1, DAT_000cb480 == 0)) {
      FUN_0004fe78(5,"ntpd: no servers found");
      puts("ntpd: no servers found");
                    /* WARNING: Subroutine does not return */
      exit(0);
    }
LAB_00026558:
    cVar4 = *(char *)(param_5 + 0x2f);
  }
  if (0 < *(int *)(param_5 + 0x78)) {
    *(int *)(param_5 + 0x78) = *(int *)(param_5 + 0x78) + -1;
  }
  if (cVar4 != '\x06') {
    FUN_000228d8(param_5);
  }
LAB_0002641c:
  FUN_00022f68(param_5,uVar6);
  return;
}




void FUN_000266e0(void)

{
  uint uVar1;
  char cVar2;
  int iVar3;
  uint uVar4;
  double dVar5;
  double dVar6;
  undefined1 auStack_58 [8];
  uint local_50;
  uint local_4c;
  uint local_48;
  uint local_44;
  
  dVar5 = 0.02;
  DAT_000cb4e0 = 0x54494e49;
  iVar3 = 0;
  DAT_000cb504 = 0;
  DAT_000cb470 = 0;
  DAT_000cb500 = 0;
  DAT_000cb4b8._0_4_ = 0;
  DAT_000cb4b8._4_4_ = 0;
  DAT_000cb4b0 = 3;
  DAT_000cb4fc = 0x10;
  DAT_000cb498._0_4_ = 0;
  DAT_000cb498._4_4_ = 0;
  DAT_000cb4e8._0_4_ = 0;
  DAT_000cb4e8._4_4_ = 0;
  FUN_0004cba8(&local_48);
  do {
    FUN_0004cba8(&local_50);
    if (local_44 == 0) {
      local_48 = local_50 - local_48;
      uVar4 = local_4c;
      if (-1 < (int)local_48) goto LAB_000267a0;
LAB_00026990:
      if (uVar4 == 0) {
        local_48 = -local_48;
        uVar4 = 0;
      }
      else {
        uVar4 = -uVar4;
        local_48 = ~local_48;
      }
      dVar6 = -((double)(longlong)(int)local_48 + (double)uVar4 * 2.3283064365386963e-10);
    }
    else {
      uVar4 = (local_4c & 0xffff) + (-local_44 & 0xffff);
      uVar1 = (local_4c >> 0x10) + (-local_44 >> 0x10);
      if ((uVar4 & 0x10000) != 0) {
        uVar1 = uVar1 + 1;
      }
      local_48 = ~local_48 + local_50;
      uVar4 = uVar4 & 0xffff | uVar1 << 0x10;
      if ((uVar1 & 0x10000) != 0) {
        local_48 = local_48 + 1;
      }
      if ((int)local_48 < 0) goto LAB_00026990;
LAB_000267a0:
      dVar6 = (double)(longlong)(int)local_48 + (double)uVar4 * 2.3283064365386963e-10;
    }
    local_44 = local_4c;
    local_48 = local_50;
    if (1e-07 <= dVar6) {
      iVar3 = iVar3 + 1;
      if (dVar6 < dVar5) {
        dVar5 = dVar6;
      }
      if (4 < iVar3) {
        DAT_000c9ad8 = dVar5;
        FUN_0004fe78(5,"proto: precision = %.3f usec",SUB84(dVar5 * 1000000.0,0),
                     (int)((ulonglong)(dVar5 * 1000000.0) >> 0x20));
        cVar2 = '\0';
        for (; dVar5 <= 1.0; dVar5 = dVar5 + dVar5) {
          cVar2 = cVar2 + '\x01';
        }
        if (1.0 - dVar5 * 0.5 < dVar5 - 1.0) {
          cVar2 = cVar2 + -1;
        }
        DAT_000cb478 = -cVar2;
        FUN_0004cba8(auStack_58);
        DAT_000cb468 = DAT_000cb548;
        DAT_000cb4d0 = 0;
        DAT_000cb4ac = 0;
        DAT_000cb4f4 = 0;
        DAT_000cb4c0 = 0;
        DAT_000cb4a0 = 0;
        DAT_000cb474 = 0;
        DAT_000cb484 = 0;
        DAT_000cb47c = 0;
        DAT_000cb4dc = 0;
        DAT_000cb490 = 0;
        DAT_000cb4c4 = 0;
        DAT_000cabc4 = 0;
        DAT_000cb4f8 = 0;
        DAT_000cb460 = 0;
        DAT_000cb461 = 0x20;
        DAT_000cb465 = 0xa0;
        DAT_000cb462 = 0x40;
        DAT_000cb466 = 0xc0;
        DAT_000cb463 = 0x60;
        DAT_000cb488 = 0;
        DAT_000cb464 = 0x80;
        DAT_000cb467 = 0xe0;
        DAT_000cb46c = 1;
        DAT_000cb588 = 1;
        DAT_000cb4d4 = 7;
        return;
      }
    }
  } while( true );
}




/* WARNING: Type propagation algorithm not settling */

void FUN_00026a68(undefined4 param_1,int param_2,short *param_3)

{
  short sVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  int *piVar7;
  undefined4 *puVar8;
  undefined4 *puVar9;
  uint uVar10;
  undefined4 uVar11;
  undefined4 *puVar12;
  uint uVar13;
  undefined4 uVar14;
  double in_d0;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  undefined8 local_20;
  
  if (1 < DAT_0007cf4c) {
    local_20 = in_d0;
    printf("proto_config: code %d value %lu dvalue %lf\n",param_1,param_2);
  }
  switch(param_1) {
  case 1:
    if (param_2 == 0) {
      DAT_000cb4f4 = 0;
      piVar7 = DAT_000ca654;
      do {
        if (piVar7 == (int *)0x0) {
          return;
        }
        while ((uVar10 = piVar7[0x23], (uVar10 & 0x80) != 0 || ((uVar10 & 0x20) == 0))) {
          piVar7 = (int *)*piVar7;
          if (piVar7 == (int *)0x0) {
            return;
          }
        }
        local_20 = (double)(CONCAT44(uVar10,(undefined4)local_20) & 0x80ffffffff);
        if ((short)piVar7[5] == 2) {
          iVar3 = setsockopt(piVar7[2],1,6,(void *)((int)&local_20 + 4),4);
          if (iVar3 == 0) {
            uVar10 = piVar7[0x23];
          }
          else {
            uVar5 = FUN_00050cd0(piVar7 + 5);
            FUN_0004fe78(3,"setsockopt(SO_BROADCAST) disable failure on address %s: %m",uVar5);
            uVar10 = piVar7[0x23];
          }
        }
        piVar7[0x23] = uVar10 & 0xffffffdf;
        piVar7 = (int *)*piVar7;
        DAT_000ca628 = 0;
      } while( true );
    }
    DAT_000cb4f4 = param_2;
    FUN_000111cc(1);
    if (DAT_000ca654 == (int *)0x0) {
      FUN_000111cc(0);
    }
    else {
      iVar3 = 0;
      piVar7 = DAT_000ca654;
      do {
        uVar10 = piVar7[0x23];
        if ((((uVar10 & 0x84) == 0) && (piVar7[0x2c] == 0)) && ((uVar10 & 8) != 0)) {
          if ((short)piVar7[5] != 2) {
            (*DAT_0007c9fc)("ntp_io.c",0xa40,0,"(2 == ((&interf->sin)->sa.sa_family))");
            uVar10 = piVar7[0x23];
          }
          if ((uVar10 & 0x20) == 0) {
            *(undefined2 *)(piVar7 + 0x22) = 2;
            iVar4 = FUN_00012cbc(piVar7 + 0x13,1,0,piVar7);
            piVar7[3] = iVar4;
            if ((iVar4 != -1) || (iVar4 = FUN_000112c0(piVar7,piVar7[2],piVar7 + 5), iVar4 != 0)) {
              FUN_0004fe78(6,"io_setbclient: Opened broadcast client on interface #%d %s",piVar7[4],piVar7 + 0x1a);
              iVar4 = FUN_0004d0b4(piVar7 + 5);
              iVar3 = iVar3 + 1;
              piVar7[0x25] = iVar4;
            }
          }
          else {
            iVar3 = iVar3 + 1;
          }
        }
        piVar7 = (int *)*piVar7;
      } while (piVar7 != (int *)0x0);
      FUN_000111cc(0);
      if (iVar3 != 0) {
        if (DAT_0007cf4c < 1) {
          return;
        }
        puts("io_setbclient: Opened broadcast clients");
        return;
      }
    }
    FUN_0004fe78(3,"Unable to listen for broadcasts, no broadcast interfaces available");
    return;
  default:
    FUN_0004fe78(5,"proto: unsupported option %d",param_1);
    return;
  case 3:
    DAT_000cb46c = param_2;
    break;
  case 4:
    DAT_000cb488 = in_d0;
    break;
  case 6:
    if (param_3 != (short *)0x0) {
      FUN_00014de8(param_3);
    }
    DAT_000cb4f4 = 1;
    break;
  case 7:
    if (param_3 != (short *)0x0) {
      iVar3 = FUN_00012884();
      if (iVar3 == 0) {
        uVar5 = FUN_00050cd0(param_3);
        FUN_0004fe78(3,"invalid multicast address %s",uVar5);
      }
      else {
LAB_0001521c:
        iVar3 = FUN_000131c8(param_3);
        if (iVar3 != 0) {
          while( true ) {
            local_3c = 0;
            local_38 = 0;
            iVar4 = FUN_00011458(param_3);
            if (iVar4 == 0) break;
            if (*param_3 == 2) {
              local_3c = *(undefined4 *)(param_3 + 2);
              local_38 = *(undefined4 *)(iVar3 + 0x18);
              iVar4 = setsockopt(*(int *)(iVar3 + 8),0,0x24,&local_3c,8);
              if (iVar4 != 0) {
                uVar11 = *(undefined4 *)(iVar3 + 8);
                uVar5 = FUN_00050cd0(iVar3 + 0x14);
                uVar13 = *(uint *)(iVar3 + 0x18);
                uVar10 = *(uint *)(param_3 + 2);
                uVar6 = FUN_00050cd0(param_3);
                FUN_0004fe78(3,"setsockopt IP_DROP_MEMBERSHIP failed: %m on socket %d, addr %s for %x / %x (%s)",uVar11,
                             uVar5,uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 | (uVar10 >> 0x10 & 0xff) << 8 |
                                   uVar10 >> 0x18,
                             uVar13 << 0x18 | (uVar13 >> 8 & 0xff) << 0x10 | (uVar13 >> 0x10 & 0xff) << 8 |
                             uVar13 >> 0x18,uVar6);
                goto LAB_0001521c;
              }
            }
            else if (*param_3 == 10) {
              local_34 = *(undefined4 *)(param_3 + 4);
              uStack_30 = *(undefined4 *)(param_3 + 6);
              uStack_2c = *(undefined4 *)(param_3 + 8);
              iVar4 = setsockopt(*(int *)(iVar3 + 8),0x29,0x15,&local_34,0x14);
              if (iVar4 != 0) {
                uVar14 = *(undefined4 *)(iVar3 + 8);
                uVar5 = FUN_00050cd0(iVar3 + 0x14);
                uVar11 = *(undefined4 *)(iVar3 + 0xac);
                uVar6 = FUN_00050cd0(param_3);
                FUN_0004fe78(3,"setsockopt IPV6_LEAVE_GROUP failure: %m on socket %d, addr %s for %d (%s)",uVar14,uVar5,
                             uVar11,uVar6);
                goto LAB_0001521c;
              }
            }
            iVar4 = *(int *)(iVar3 + 0x98) + -1;
            *(int *)(iVar3 + 0x98) = iVar4;
            if (iVar4 != 0) goto LAB_0001521c;
            *(uint *)(iVar3 + 0x8c) = *(uint *)(iVar3 + 0x8c) & 0xffffffbf;
            iVar3 = FUN_000131c8(param_3);
            if (iVar3 == 0) goto LAB_00015288;
          }
          if (3 < DAT_0007cf4c) {
            uVar5 = FUN_00050cd0(param_3);
            printf("socket_multicast_disable(%s): not found\n",uVar5);
          }
          goto LAB_0001521c;
        }
LAB_00015288:
        sVar1 = *param_3;
        puVar9 = DAT_000ca64c;
        puVar12 = &DAT_000ca64c;
        do {
          puVar8 = puVar9;
          if (*(short *)(puVar8 + 1) == sVar1) {
            if (sVar1 == 2) {
              iVar3 = *(int *)(param_3 + 2) - puVar8[2];
              if (iVar3 != 0) {
                iVar3 = 1;
              }
            }
            else {
              iVar3 = memcmp(param_3 + 4,puVar8 + 3,0x10);
              if (iVar3 != 0) goto LAB_0001529c;
              iVar3 = *(int *)(param_3 + 0xc) - puVar8[7];
              if (iVar3 != 0) {
                iVar3 = 1;
              }
            }
            iVar4 = DAT_0007cf4c;
            if (iVar3 == 0) {
              puVar9 = (undefined4 *)*puVar12;
              *puVar12 = *puVar9;
              *puVar9 = 0;
              if (3 < iVar4) {
                uVar5 = FUN_00050cd0(param_3);
                printf("Deleted addr %s from list of addresses\n",uVar5);
              }
              free(puVar9);
              return;
            }
          }
LAB_0001529c:
          puVar9 = (undefined4 *)*puVar8;
          puVar12 = puVar8;
        } while ((undefined4 *)*puVar8 != (undefined4 *)0x0);
      }
      return;
    }
    break;
  case 8:
    DAT_0007a19c = param_2;
    break;
  case 9:
    DAT_0007a198 = param_2;
    break;
  case 10:
    if (param_2 != 0) {
      FUN_00020d7c();
      return;
    }
    if (((DAT_000cac24 != 0) && ((DAT_000cac24 & 1) != 0)) &&
       (DAT_000cac24 = DAT_000cac24 & 0xfffffffe, DAT_000cac24 == 0)) {
      puVar9 = &DAT_0007d728;
      do {
        piVar7 = (int *)*puVar9;
        puVar12 = puVar9 + 1;
        *puVar9 = 0;
        while (piVar2 = piVar7, piVar2 != (int *)0x0) {
          piVar7 = (int *)*piVar2;
          *piVar2 = (int)DAT_0007d928;
          DAT_0007d928 = piVar2;
        }
        puVar9 = puVar12;
      } while ((int **)puVar12 != &DAT_0007d928);
      DAT_000cabe0 = &DAT_000cabdc;
      DAT_000cabe4 = &DAT_000cabdc;
    }
    return;
  case 0xb:
    DAT_000cb588 = param_2;
    break;
  case 0xc:
    DAT_000cabc4 = param_2;
    break;
  case 0xd:
    DAT_000cb508 = param_2;
    break;
  case 0xe:
    DAT_0007a2b8 = (undefined4)(longlong)in_d0;
    break;
  case 0xf:
    DAT_0007a2bc = (undefined4)(longlong)in_d0;
    break;
  case 0x10:
    DAT_0007a2b4 = (undefined4)(longlong)in_d0;
    break;
  case 0x11:
    DAT_0007fb08 = (undefined4)(longlong)in_d0;
    break;
  case 0x12:
    DAT_0007a2a0 = (undefined4)(longlong)in_d0;
    break;
  case 0x13:
    DAT_0007fb38 = (undefined4)(longlong)in_d0;
    break;
  case 0x14:
    break;
  case 0x15:
    DAT_0007a298 = in_d0;
    break;
  case 0x16:
    DAT_0007a2a8 = in_d0;
    break;
  case 0x17:
    DAT_000c9ad8 = in_d0;
    break;
  case 0x19:
    DAT_0007a2c0 = (undefined4)(longlong)in_d0;
    break;
  case 0x1a:
    DAT_0007a2b0 = (undefined4)(longlong)in_d0;
  }
  return;
}




void FUN_00026d0c(void)

{
  DAT_000cb468 = DAT_000cb548;
  DAT_000cb4a0 = 0;
  DAT_000cb474 = 0;
  DAT_000cb484 = 0;
  DAT_000cb4c0 = 0;
  DAT_000cb47c = 0;
  DAT_000cb4dc = 0;
  DAT_000cb490 = 0;
  DAT_000cb4f8 = 0;
  DAT_000cb4c4 = 0;
  return;
}




/* WARNING: Removing unreachable block (ram,0x00027018) */
/* WARNING: Removing unreachable block (ram,0x00026fec) */

size_t FUN_00026dc8(int param_1)

{
  bool bVar1;
  uint uVar2;
  size_t sVar3;
  undefined8 *puVar4;
  uint uVar5;
  double *pdVar6;
  double *pdVar7;
  int iVar8;
  undefined4 uVar9;
  uint uVar10;
  size_t __nmemb;
  uint uVar11;
  int iVar12;
  uint uVar13;
  int iVar14;
  double dVar15;
  double dVar16;
  double dVar17;
  undefined8 uStack_208;
  
  iVar14 = *(int *)(param_1 + 0xcc);
  iVar12 = *(int *)(param_1 + 200);
  if (iVar14 != iVar12) {
    __nmemb = 0;
    puVar4 = &uStack_208;
    do {
      __nmemb = __nmemb + 1;
      iVar14 = (iVar14 + 1) % 0x3c;
      iVar8 = param_1 + iVar14 * 8;
      uVar9 = *(undefined4 *)(iVar8 + 0xfc);
      *(undefined4 *)puVar4 = *(undefined4 *)(iVar8 + 0xf8);
      *(undefined4 *)((int)puVar4 + 4) = uVar9;
      puVar4 = puVar4 + 1;
    } while (iVar14 != iVar12);
    *(int *)(param_1 + 0xcc) = iVar14;
    if (__nmemb != 0) {
      if (__nmemb != 1) {
        qsort(&uStack_208,__nmemb,8,(__compar_fn_t)&LAB_00026da0);
      }
      uVar5 = 0;
      uVar13 = __nmemb - (__nmemb * 4) / 10;
      sVar3 = __nmemb;
      while( true ) {
        uVar11 = sVar3;
        if (uVar11 - uVar5 <= uVar13) break;
        sVar3 = uVar11 - 1;
        if ((double)(&uStack_208)[uVar11 - 1] - (double)(&uStack_208)[uVar11 + uVar5 >> 1] <
            (double)(&uStack_208)[uVar11 + uVar5 >> 1] - (double)(&uStack_208)[uVar5]) {
          uVar5 = uVar5 + 1;
          sVar3 = uVar11;
        }
      }
      dVar16 = 0.0;
      *(undefined8 *)(param_1 + 0xe0) = 0;
      *(undefined8 *)(param_1 + 0xf0) = 0;
      dVar17 = dVar16;
      if (uVar5 < uVar11) {
        dVar16 = (double)(&uStack_208)[uVar5] + 0.0;
        *(double *)(param_1 + 0xe0) = dVar16;
        pdVar7 = (double *)(&uStack_208 + uVar5 + 1);
        uVar10 = uVar5 + 1;
        while (uVar10 != uVar11) {
          dVar15 = *pdVar7;
          pdVar6 = pdVar7 + 1;
          dVar16 = dVar16 + dVar15;
          if (uVar5 < uVar10) {
            dVar15 = dVar15 - pdVar7[-1];
          }
          uVar2 = uVar10 + 1;
          *(double *)(param_1 + 0xe0) = dVar16;
          if (uVar5 < uVar10) {
            dVar17 = dVar17 + dVar15 * dVar15;
          }
          bVar1 = uVar5 < uVar10;
          pdVar7 = pdVar6;
          uVar10 = uVar2;
          if (bVar1) {
            *(double *)(param_1 + 0xf0) = dVar17;
          }
        }
      }
      dVar15 = (double)uVar13;
      *(double *)(param_1 + 0xe0) = dVar16 / dVar15;
      if ((char)DAT_000cb478 < 0) {
        dVar16 = 1.0 / (double)(longlong)(1 << (-(int)(char)DAT_000cb478 & 0xffU));
      }
      else {
        dVar16 = (double)(longlong)(1 << (uint)DAT_000cb478);
      }
      if (dVar16 < SQRT(dVar17 / dVar15)) {
        dVar16 = SQRT(*(double *)(param_1 + 0xf0) / dVar15);
      }
      *(double *)(param_1 + 0xf0) = dVar16;
      if (DAT_0007cf4c == 0) {
        return __nmemb;
      }
      printf("refclock_sample: n %d offset %.6f disp %.6f jitter %.6f\n",__nmemb,*(undefined4 *)(param_1 + 0xe0),
             *(undefined4 *)(param_1 + 0xe4),*(undefined4 *)(param_1 + 0xe8),*(undefined4 *)(param_1 + 0xec),dVar16);
      return __nmemb;
    }
  }
  return 0;
}




void FUN_00027040(int param_1,uint param_2)

{
  undefined4 uVar1;
  int iVar2;
  
  iVar2 = *(int *)(param_1 + 0x3c);
  if (iVar2 == 0) {
    return;
  }
  switch(param_2) {
  case 1:
    *(int *)(iVar2 + 0x2fc) = *(int *)(iVar2 + 0x2fc) + 1;
    break;
  case 2:
    *(int *)(iVar2 + 0x300) = *(int *)(iVar2 + 0x300) + 1;
    break;
  case 5:
  case 6:
    *(int *)(iVar2 + 0x304) = *(int *)(iVar2 + 0x304) + 1;
  }
  if (*(byte *)(iVar2 + 0x22) < 0xf) {
    *(byte *)(iVar2 + 0x22) = *(byte *)(iVar2 + 0x22) + 1;
  }
  if (*(byte *)(iVar2 + 0x21) != param_2) {
    *(char *)(iVar2 + 0x21) = (char)param_2;
    uVar1 = FUN_00051310(param_2);
    FUN_0001d3d8(0x8b,param_1,uVar1);
    return;
  }
  return;
}




void FUN_000270e4(void)

{
  int iVar1;
  int *piVar2;
  
  if (DAT_0007a600 == 0) {
    return;
  }
  piVar2 = (int *)0x65b18;
  iVar1 = 0;
  do {
    piVar2 = piVar2 + 1;
    iVar1 = iVar1 + 1;
    if (*(code **)(*piVar2 + 0x10) != (code *)0x0) {
      (**(code **)(*piVar2 + 0x10))();
    }
  } while (iVar1 < (int)(uint)DAT_0007a600);
  return;
}




void FUN_00027130(int param_1)

{
  void *__ptr;
  
  __ptr = *(void **)(param_1 + 0x3c);
  if (__ptr == (void *)0x0) {
    return;
  }
  if (*(code **)((&DAT_00065b1c)[*(byte *)(param_1 + 0x40)] + 4) != (code *)0x0) {
    (**(code **)((&DAT_00065b1c)[*(byte *)(param_1 + 0x40)] + 4))(*(undefined1 *)(param_1 + 0x41),param_1);
    __ptr = *(void **)(param_1 + 0x3c);
  }
  free(__ptr);
  *(undefined4 *)(param_1 + 0x3c) = 0;
  return;
}




undefined4 FUN_00027184(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  undefined1 uVar2;
  undefined4 uVar3;
  void *__s;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint *puVar7;
  
  if (*(short *)(param_1 + 0xc) == 2) {
    uVar5 = *(uint *)(param_1 + 0x10);
    uVar1 = uVar5 >> 0x10 & 0xff;
    if ((uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10) == 0x7f7f0000) {
      uVar6 = (uint)DAT_0007a600;
      if (uVar1 < uVar6) {
        puVar7 = (uint *)(&DAT_00065b1c)[uVar1];
        uVar6 = *puVar7;
        if (uVar6 != 0) {
          __s = (void *)FUN_0004f524(0x308);
          memset(__s,0,0x308);
          uVar3 = DAT_000cb548;
          *(undefined1 *)(param_1 + 0x46) = *(undefined1 *)(param_1 + 0x32);
          *(undefined1 *)(param_1 + 0x43) = 3;
          *(char *)(param_1 + 0x41) = (char)(uVar5 >> 0x18);
          uVar2 = (undefined1)(uVar5 >> 0x10);
          *(undefined1 *)(param_1 + 0x40) = uVar2;
          *(undefined1 *)(param_1 + 0x45) = 0;
          *(void **)(param_1 + 0x3c) = __s;
          *(uint *)(param_1 + 0x34) = *(uint *)(param_1 + 0x34) | 8;
          *(undefined1 *)((int)__s + 0x23) = uVar2;
          *(undefined4 *)((int)__s + 0x2f4) = uVar3;
          if (*(char *)(param_1 + 0x2f) == '\x01') {
            *(undefined1 *)(param_1 + 0x44) = 2;
          }
          else {
            *(undefined1 *)(param_1 + 0x44) = 4;
          }
          iVar4 = (*(code *)*puVar7)(uVar5 >> 0x18,param_1);
          if (iVar4 == 0) {
            FUN_00027130(param_1);
            return 0;
          }
          *(undefined4 *)(param_1 + 0x58) = *(undefined4 *)((int)__s + 0x2ec);
          return 1;
        }
      }
      FUN_0004fe78(3,"refclock_newpeer: clock type %d invalid\n",uVar1,uVar6,param_4);
      return 0;
    }
  }
  uVar3 = FUN_00050cd0(param_1 + 0xc);
  FUN_0004fe78(3,"refclock_newpeer: clock address %s invalid",uVar3);
  return 0;
}




void FUN_000272d0(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  code *pcVar1;
  
  pcVar1 = *(code **)((&DAT_00065b1c)[*(byte *)(param_1 + 0x40)] + 0x18);
  if (pcVar1 == (code *)0x0) {
    return;
  }
  (*pcVar1)(*(undefined1 *)(param_1 + 0x41),param_1,(uint)*(byte *)(param_1 + 0x40),pcVar1,param_4);
  return;
}




/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x000273c0 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_00027300(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4,int param_5)

{
  byte bVar1;
  byte bVar2;
  undefined1 uVar3;
  byte bVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  
  bVar2 = *(byte *)(param_5 + 0x40);
  *(int *)(param_5 + 0x220) = *(int *)(param_5 + 0x220) + 1;
  uVar3 = *(undefined1 *)(param_5 + 0x41);
  FUN_0004cba8(param_5 + 0x178);
  uVar5 = DAT_000cb548;
  if (*(int *)(param_5 + 0x74) == 0) {
    if (DAT_0007cf4c != 0) {
      uVar6 = FUN_00050cd0(param_5 + 0xc);
      printf("refclock_transmit: at %ld %s\n",uVar5,uVar6);
    }
    bVar4 = *(byte *)(param_5 + 0x6a);
    bVar1 = bVar4 << 1;
    *(byte *)(param_5 + 0x6a) = bVar1;
    if ((bVar1 & 0xe) == 0) {
      FUN_000246a0(0,param_2,0,param_4,0,param_5);
      *(undefined4 *)(param_5 + 0x204) = DAT_000cb548;
      if (*(char *)(param_5 + 0x6a) == '\0') {
        if ((bVar4 & 0xfe) != 0) {
          FUN_0001d3d8(0x83,param_5);
          *(undefined4 *)(param_5 + 0x21c) = DAT_000cb548;
        }
        goto LAB_0002737c;
      }
    }
    else {
      *(undefined4 *)(param_5 + 0x204) = DAT_000cb548;
    }
    if ((*(uint *)(param_5 + 0x34) & 0x40) != 0) {
      *(undefined4 *)(param_5 + 0x74) = 5;
    }
  }
  else {
    *(int *)(param_5 + 0x74) = *(int *)(param_5 + 0x74) + -1;
  }
LAB_0002737c:
  if (*(code **)((&DAT_00065b1c)[bVar2] + 8) != (code *)0x0) {
    (**(code **)((&DAT_00065b1c)[bVar2] + 8))(uVar3,param_5);
  }
  FUN_00022f68(param_5,*(undefined1 *)(param_5 + 0x30));
  return;
}




int FUN_00027430(int param_1,int param_2,uint param_3,uint param_4,int param_5)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  double in_d0;
  double dVar5;
  
  *(uint *)(param_1 + 0xd8) = param_4;
  *(int *)(param_1 + 0xdc) = param_5;
  if (param_5 == 0) {
    param_4 = param_2 - param_4;
  }
  else {
    uVar2 = (param_3 & 0xffff) + (-param_5 & 0xffffU);
    uVar4 = (param_3 >> 0x10) + ((uint)-param_5 >> 0x10);
    if ((uVar2 & 0x10000) != 0) {
      uVar4 = uVar4 + 1;
    }
    param_4 = ~param_4 + param_2;
    param_3 = uVar2 & 0xffff | uVar4 << 0x10;
    if ((uVar4 & 0x10000) != 0) {
      param_4 = param_4 + 1;
    }
  }
  if ((int)param_4 < 0) {
    if (param_3 == 0) {
      param_4 = -param_4;
      param_3 = 0;
    }
    else {
      param_3 = -param_3;
      param_4 = ~param_4;
    }
    dVar5 = -((double)(longlong)(int)param_4 + (double)param_3 * 2.3283064365386963e-10);
  }
  else {
    dVar5 = (double)(longlong)(int)param_4 + (double)param_3 * 2.3283064365386963e-10;
  }
  iVar1 = *(int *)(param_1 + 0xcc);
  iVar3 = (*(int *)(param_1 + 200) + 1) % 0x3c;
  *(int *)(param_1 + 200) = iVar3;
  *(double *)(param_1 + iVar3 * 8 + 0xf8) = dVar5 + in_d0;
  if (iVar3 == iVar1) {
    iVar1 = (iVar3 + 1) * -0x77777777;
    *(int *)(param_1 + 0xcc) = (iVar3 + 1) % 0x3c;
  }
  return iVar1;
}




int FUN_00027578(int param_1)

{
  ulonglong uVar1;
  int iVar2;
  uint uVar3;
  double dVar4;
  int local_20;
  int local_1c;
  
  iVar2 = FUN_0004efc8(*(undefined4 *)(param_1 + 0xb0),*(undefined4 *)(param_1 + 0xb4),*(undefined4 *)(param_1 + 0xb8),
                       *(undefined4 *)(param_1 + 0xbc),0,*(undefined4 *)(param_1 + 0xd8),param_1 + 0xc4,&local_20);
  if (iVar2 != 0) {
    dVar4 = (double)(longlong)*(int *)(param_1 + 0xc0) / 1000000000.0;
    if (dVar4 < 0.0) {
      uVar1 = (ulonglong)-dVar4;
      uVar3 = (uint)uVar1;
      dVar4 = (-dVar4 - (double)(uVar1 & 0xffffffff)) * 4294967296.0;
      local_1c = (uint)(0.0 < dVar4) * (int)(longlong)dVar4;
      if (local_1c == 0) {
        uVar3 = -uVar3;
        local_1c = 0;
      }
      else {
        local_1c = -local_1c;
        uVar3 = ~uVar3;
      }
    }
    else {
      uVar3 = (uint)(longlong)dVar4;
      dVar4 = (dVar4 - (double)((longlong)dVar4 & 0xffffffff)) * 4294967296.0;
      local_1c = (uint)(0.0 < dVar4) * (int)(longlong)dVar4;
    }
    local_20 = local_20 + uVar3;
    FUN_00027430(param_1,local_20,local_1c,*(undefined4 *)(param_1 + 0xd8),*(undefined4 *)(param_1 + 0xdc));
    iVar2 = 1;
  }
  return iVar2;
}




void FUN_00027698(int param_1)

{
  FUN_00027578((int)*(undefined8 *)(param_1 + 0x2d8));
  return;
}




/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00027748 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_000276a0(int param_1)

{
  char cVar1;
  byte bVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  int iVar8;
  bool bVar9;
  undefined4 in_s3;
  double dVar10;
  double dVar11;
  
  uVar4 = DAT_000cb548;
  if (DAT_0007cf4c != 0) {
    uVar5 = FUN_00050cd0(param_1 + 0xc);
    printf("refclock_receive: at %lu %s\n",uVar4,uVar5);
  }
  iVar8 = *(int *)(param_1 + 0x3c);
  cVar1 = *(char *)(iVar8 + 0x20);
  *(char *)(param_1 + 0x43) = cVar1;
  uVar4 = DAT_000cb548;
  if (cVar1 == '\x03') {
    return;
  }
  bVar2 = *(byte *)(param_1 + 0x6a);
  *(int *)(param_1 + 0x224) = *(int *)(param_1 + 0x224) + 1;
  *(undefined4 *)(param_1 + 0x218) = uVar4;
  if (bVar2 == 0) {
    FUN_0001d3d8(0x84,param_1);
    bVar2 = *(byte *)(param_1 + 0x6a);
    *(undefined4 *)(param_1 + 0x21c) = DAT_000cb548;
  }
  *(byte *)(param_1 + 0x6a) = bVar2 | 1;
  uVar4 = *(undefined4 *)(iVar8 + 0xd4);
  uVar6 = *(undefined4 *)(iVar8 + 0xe8);
  uVar7 = *(undefined4 *)(iVar8 + 0xec);
  *(undefined4 *)(param_1 + 0x5c) = *(undefined4 *)(iVar8 + 0xd0);
  *(undefined4 *)(param_1 + 0x60) = uVar4;
  uVar4 = *(undefined4 *)(iVar8 + 0xd8);
  uVar5 = *(undefined4 *)(iVar8 + 0xdc);
  *(undefined4 *)(param_1 + 0x50) = uVar6;
  *(undefined4 *)(param_1 + 0x54) = uVar7;
  *(undefined4 *)(param_1 + 0x188) = uVar4;
  *(undefined4 *)(param_1 + 0x18c) = uVar5;
  FUN_0004cba8(param_1 + 0x180);
  iVar3 = FUN_00026dc8(iVar8);
  if (iVar3 == 0) {
    return;
  }
  FUN_000246a0((int)*(undefined8 *)(iVar8 + 0xe0),(int)((ulonglong)*(undefined8 *)(iVar8 + 0xe0) >> 0x20),0,in_s3,
               (int)*(undefined8 *)(iVar8 + 0xf0),param_1);
  if (DAT_000cb508 == 0) {
    return;
  }
  dVar11 = ABS(DAT_000cabd0);
  if (DAT_0007a298 <= dVar11) {
    return;
  }
  if (DAT_000cb470 == 0) {
    return;
  }
  if (*(char *)(DAT_000cb470 + 0x40) == '\x16') {
    bVar9 = *(char *)(param_1 + 0x40) != '\x16';
    dVar10 = DAT_0007a298;
    if (bVar9) {
      dVar10 = *(double *)(iVar8 + 0x2d8);
      dVar11 = 0.1;
    }
    if (bVar9) {
      dVar10 = dVar10 - *(double *)(iVar8 + 0xe0) * dVar11;
    }
    if (bVar9) {
      *(double *)(iVar8 + 0x2d8) = dVar10;
    }
    return;
  }
  return;
}




/* WARNING: Restarted to delay deadcode elimination for space: stack */

int FUN_00027824(int param_1,undefined1 *param_2,int param_3,uint *param_4)

{
  undefined4 uVar1;
  undefined1 *puVar2;
  uint uVar3;
  uint uVar4;
  undefined1 *puVar5;
  undefined4 uVar6;
  uint uVar7;
  int iVar8;
  uint uVar9;
  uint local_38;
  uint local_34;
  uint local_30;
  uint local_2c;
  
  iVar8 = param_1 + *(int *)(param_1 + 0x58) + 0x58;
  local_38 = *(uint *)(param_1 + 0x4c);
  local_34 = *(uint *)(param_1 + 0x50);
  uVar7 = iVar8 + 4;
  if (param_1 + 100U <= uVar7) {
    uVar9 = iVar8 - 4;
    iVar8 = FUN_0004e858(uVar9,&local_30);
    if (iVar8 != 0) {
      if (local_2c == 0) {
        local_38 = local_38 - local_30;
      }
      else {
        uVar4 = (local_34 & 0xffff) + (-local_2c & 0xffff);
        uVar3 = (local_34 >> 0x10) + (-local_2c >> 0x10);
        if ((uVar4 & 0x10000) != 0) {
          uVar3 = uVar3 + 1;
        }
        local_38 = ~local_30 + local_38;
        local_34 = uVar4 & 0xffff | uVar3 << 0x10;
        if ((uVar3 & 0x10000) != 0) {
          local_38 = local_38 + 1;
        }
      }
      if (local_38 == 0) {
        if (1 < DAT_0007cf4c) {
          uVar6 = *(undefined4 *)(param_1 + 0x44);
          uVar1 = FUN_0004fa94(0,local_34,6);
          printf("refclock_gtlin: fd %d ldisc %s",uVar6,uVar1);
          FUN_0004cba8(&local_38);
          if (local_2c == 0) {
            local_38 = local_38 - local_30;
          }
          else {
            uVar7 = (local_34 & 0xffff) + (-local_2c & 0xffff);
            uVar4 = (local_34 >> 0x10) + (-local_2c >> 0x10);
            if ((uVar7 & 0x10000) != 0) {
              uVar4 = uVar4 + 1;
            }
            local_34 = uVar7 & 0xffff | uVar4 << 0x10;
            local_38 = ~local_30 + local_38;
            if ((uVar4 & 0x10000) != 0) {
              local_38 = local_38 + 1;
            }
          }
          uVar1 = FUN_0004fa94(local_38,local_34,6);
          printf(" sigio %s\n",uVar1);
        }
        local_38 = local_30;
        local_34 = local_2c;
        uVar7 = uVar9;
      }
      else {
        local_38 = *(uint *)(param_1 + 0x4c);
        local_34 = *(uint *)(param_1 + 0x50);
      }
    }
  }
  if (param_3 <= (int)(uVar7 - (param_1 + 0x5cU))) {
    uVar7 = param_1 + param_3 + 0x5b;
  }
  if (param_1 + 0x5cU < uVar7) {
    puVar5 = (undefined1 *)(param_1 + 0x5b);
    puVar2 = param_2;
    do {
      puVar5 = puVar5 + 1;
      *puVar2 = *puVar5;
      puVar2 = puVar2 + 1;
    } while (puVar5 != (undefined1 *)(uVar7 - 1));
    iVar8 = (int)(param_2 + (uVar7 - param_1) + -0x5c) - (int)param_2;
    puVar2 = param_2 + (uVar7 - param_1) + -0x5c;
  }
  else {
    iVar8 = 0;
    puVar2 = param_2;
  }
  *puVar2 = 0;
  if (1 < DAT_0007cf4c) {
    uVar6 = *(undefined4 *)(param_1 + 0x44);
    uVar1 = FUN_0004f124(local_38,local_34,0,6,0);
    printf("refclock_gtraw: fd %d time %s timecode %d %s\n",uVar6,uVar1,iVar8,param_2);
  }
  *param_4 = local_38;
  param_4[1] = local_34;
  return iVar8;
}




int FUN_00027aac(undefined4 param_1,undefined1 *param_2,int param_3)

{
  int iVar1;
  byte *pbVar2;
  undefined1 *puVar3;
  undefined1 *puVar4;
  byte abStack_91 [129];
  
  iVar1 = FUN_00027824(param_1,abStack_91 + 1,0x7f);
  if (param_3 <= iVar1) {
    iVar1 = param_3 + -1;
  }
  if (abStack_91 + 1 < abStack_91 + iVar1 + 1) {
    pbVar2 = abStack_91;
    puVar3 = param_2;
    do {
      pbVar2 = pbVar2 + 1;
      puVar4 = puVar3;
      if ((*pbVar2 & 0x7f) - 0x20 < 0x5f) {
        puVar4 = puVar3 + 1;
        *puVar3 = (char)(*pbVar2 & 0x7f);
      }
      puVar3 = puVar4;
    } while (pbVar2 != abStack_91 + iVar1);
    if (puVar4 != param_2) {
      *puVar4 = 0;
      return (int)puVar4 - (int)param_2;
    }
  }
  return 0;
}




undefined4 FUN_00027b30(int param_1,speed_t param_2,uint param_3)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  cc_t *pcVar4;
  bool bVar5;
  uint local_50;
  termios local_4c;
  
  iVar1 = tcgetattr(param_1,&local_4c);
  if (iVar1 < 0) {
    FUN_0004fe78(3,"refclock_setup fd %d tcgetattr: %m",param_1);
    uVar2 = 0;
  }
  else {
    if (param_2 != 0) {
      local_50 = 0;
      local_4c.c_iflag = 0x105;
      local_4c.c_oflag = 0;
      if ((param_3 & 0x100) == 0) {
        local_4c.c_cflag = 0x8b0;
      }
      else {
        local_4c.c_cflag = 0xba0;
      }
      cfsetispeed(&local_4c,param_2);
      cfsetospeed(&local_4c,param_2);
      pcVar4 = &local_4c.c_line;
      do {
        pcVar4 = pcVar4 + 1;
        *pcVar4 = '\0';
      } while (pcVar4 != local_4c.c_cc + 0x1f);
      iVar1 = ioctl(param_1,0x5415,&local_50);
      if (iVar1 < 0) {
        FUN_0004fe78(3,"refclock_setup fd %d TIOCMGET: %m",param_1);
      }
      if (DAT_0007cf4c != 0) {
        printf("refclock_setup fd %d modem status: 0x%x\n",param_1,local_50);
      }
      if (((local_50 & 0x100) != 0) && ((param_3 & 0x80) != 0)) {
        local_4c.c_cflag = local_4c.c_cflag & 0xfffff7ff;
      }
    }
    bVar5 = (param_3 & 0x20) != 0;
    if (bVar5) {
      uVar3 = 0;
      local_4c.c_lflag = 0;
      local_4c.c_iflag = 0;
      local_4c.c_cc[6] = '\x01';
    }
    else {
      uVar3 = 2;
    }
    if (!bVar5) {
      local_4c.c_lflag = uVar3;
    }
    if ((param_3 & 0x40) != 0) {
      local_4c.c_lflag = local_4c.c_lflag | 8;
    }
    iVar1 = tcsetattr(param_1,0,&local_4c);
    if (iVar1 < 0) {
      FUN_0004fe78(3,"refclock_setup fd %d TCSANOW: %m",param_1);
      uVar2 = 0;
    }
    else {
      iVar1 = tcflush(param_1,2);
      if (iVar1 < 0) {
        FUN_0004fe78(3,"refclock_setup fd %d tcflush(): %m",param_1);
        uVar2 = 1;
      }
      else {
        uVar2 = 1;
      }
    }
  }
  return uVar2;
}




undefined4 FUN_00027ce4(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  if (DAT_0007cf4c != 0) {
    printf("refclock_ioctl: fd %d flags 0x%x\n",param_1,param_2,DAT_0007cf4c,param_4);
  }
  return 1;
}




int FUN_00027d18(char *param_1,undefined4 param_2,undefined4 param_3)

{
  int __fd;
  int iVar1;
  int *piVar2;
  ssize_t sVar3;
  undefined1 auStack_98 [132];
  
  __fd = open(param_1,0x902,0x1ff);
  if (__fd < 0) {
    iVar1 = 0;
    FUN_0004fe78(3,"refclock_open %s: %m",param_1);
  }
  else {
    if (__fd == 0) {
      (*DAT_0007c9fc)("ntp_refclock.c",0x2e3,2,"fd != 0");
    }
    iVar1 = FUN_00027b30(__fd,param_2,param_3);
    if ((iVar1 == 0) || (iVar1 = FUN_00027ce4(__fd,param_3), iVar1 == 0)) {
      close(__fd);
    }
    else {
      piVar2 = __errno_location();
      do {
        do {
          sVar3 = read(__fd,auStack_98,0x80);
        } while (0 < sVar3);
        iVar1 = __fd;
      } while (*piVar2 == 4);
    }
  }
  return iVar1;
}




void FUN_00027e00(short *param_1,int param_2,undefined1 *param_3,undefined4 param_4)

{
  undefined1 uVar1;
  int iVar2;
  byte bVar3;
  undefined4 uVar4;
  int iVar5;
  int iVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  uint uVar9;
  undefined4 uVar10;
  
  if (*param_1 != 2) {
    return;
  }
  uVar9 = *(uint *)(param_1 + 2);
  if ((uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10) != 0x7f7f0000) {
    return;
  }
  iVar2 = FUN_00021500(param_1,0,0xffffffff,0,param_4);
  if (iVar2 == 0) {
    return;
  }
  iVar5 = *(int *)(iVar2 + 0x3c);
  if (iVar5 == 0) {
    return;
  }
  if (param_2 != 0) {
    bVar3 = *(byte *)(param_2 + 2);
    if ((bVar3 & 1) != 0) {
      uVar4 = *(undefined4 *)(param_2 + 0x2c);
      *(undefined4 *)(iVar5 + 0x2d8) = *(undefined4 *)(param_2 + 0x28);
      *(undefined4 *)(iVar5 + 0x2dc) = uVar4;
      bVar3 = *(byte *)(param_2 + 2);
    }
    if ((bVar3 & 2) != 0) {
      uVar4 = *(undefined4 *)(param_2 + 0x34);
      *(undefined4 *)(iVar5 + 0x2e0) = *(undefined4 *)(param_2 + 0x30);
      *(undefined4 *)(iVar5 + 0x2e4) = uVar4;
      bVar3 = *(byte *)(param_2 + 2);
    }
    if ((bVar3 & 4) != 0) {
      uVar1 = *(undefined1 *)(param_2 + 0x38);
      *(undefined1 *)(iVar5 + 0x2e8) = uVar1;
      *(undefined1 *)(iVar2 + 0x45) = uVar1;
      bVar3 = *(byte *)(param_2 + 2);
    }
    if ((bVar3 & 8) != 0) {
      uVar4 = *(undefined4 *)(param_2 + 0x3c);
      *(undefined4 *)(iVar5 + 0x2ec) = uVar4;
      *(undefined4 *)(iVar2 + 0x58) = uVar4;
      bVar3 = *(byte *)(param_2 + 2);
    }
    if ((bVar3 & 0x10) != 0) {
      bVar3 = *(byte *)(iVar5 + 0x2f0) & 0xfe;
      *(byte *)(iVar5 + 0x2f0) = bVar3;
      *(byte *)(iVar5 + 0x2f0) = bVar3 | *(byte *)(param_2 + 1) & 1;
      bVar3 = *(byte *)(param_2 + 2);
    }
    if ((bVar3 & 0x20) != 0) {
      bVar3 = *(byte *)(iVar5 + 0x2f0) & 0xfd;
      *(byte *)(iVar5 + 0x2f0) = bVar3;
      *(byte *)(iVar5 + 0x2f0) = bVar3 | *(byte *)(param_2 + 1) & 2;
      bVar3 = *(byte *)(param_2 + 2);
    }
    if ((bVar3 & 0x40) != 0) {
      bVar3 = *(byte *)(iVar5 + 0x2f0) & 0xfb;
      *(byte *)(iVar5 + 0x2f0) = bVar3;
      *(byte *)(iVar5 + 0x2f0) = bVar3 | *(byte *)(param_2 + 1) & 4;
      bVar3 = *(byte *)(param_2 + 2);
    }
    if ((bVar3 & 0x80) != 0) {
      bVar3 = *(byte *)(iVar5 + 0x2f0) & 0xf7;
      *(byte *)(iVar5 + 0x2f0) = bVar3;
      *(byte *)(iVar5 + 0x2f0) = bVar3 | *(byte *)(param_2 + 1) & 8;
    }
  }
  if (param_3 != (undefined1 *)0x0) {
    param_3[2] = 0x8d;
    uVar8 = *(undefined4 *)(iVar5 + 0x2dc);
    uVar4 = *(undefined4 *)(iVar5 + 0x2e0);
    uVar7 = *(undefined4 *)(iVar5 + 0x2e4);
    uVar10 = *(undefined4 *)(iVar5 + 0x2ec);
    *(undefined4 *)(param_3 + 0x28) = *(undefined4 *)(iVar5 + 0x2d8);
    *(undefined4 *)(param_3 + 0x2c) = uVar8;
    *(undefined4 *)(param_3 + 0x30) = uVar4;
    *(undefined4 *)(param_3 + 0x34) = uVar7;
    bVar3 = *(byte *)(iVar5 + 0x2e8);
    *(undefined4 *)(param_3 + 0x3c) = uVar10;
    *(uint *)(param_3 + 0x38) = (uint)bVar3;
    param_3[1] = *(undefined1 *)(iVar5 + 0x2f0);
    iVar2 = DAT_000cb548;
    uVar4 = *(undefined4 *)(iVar5 + 0x304);
    uVar7 = *(undefined4 *)(iVar5 + 0x2fc);
    uVar8 = *(undefined4 *)(iVar5 + 0x300);
    iVar6 = *(int *)(iVar5 + 0x2f4);
    *(undefined4 *)(param_3 + 0xc) = *(undefined4 *)(iVar5 + 0x2f8);
    *(undefined4 *)(param_3 + 0x10) = uVar7;
    *(undefined4 *)(param_3 + 0x14) = uVar8;
    *(int *)(param_3 + 0x1c) = iVar2 - iVar6;
    *(undefined4 *)(param_3 + 0x18) = uVar4;
    param_3[0x41] = *(undefined1 *)(iVar5 + 0x22);
    param_3[0x40] = *(undefined1 *)(iVar5 + 0x21);
    *param_3 = *(undefined1 *)(iVar5 + 0x23);
    uVar4 = *(undefined4 *)(iVar5 + 0x24);
    uVar7 = *(undefined4 *)(iVar5 + 0xa8);
    *(int *)(param_3 + 8) = iVar5 + 0x28;
    *(undefined4 *)(param_3 + 0x20) = uVar4;
    *(short *)(param_3 + 4) = (short)uVar7;
  }
  if (*(code **)((&DAT_00065b1c)[uVar9 >> 0x10 & 0xff] + 0xc) == (code *)0x0) {
    return;
  }
  (**(code **)((&DAT_00065b1c)[uVar9 >> 0x10 & 0xff] + 0xc))(uVar9 >> 0x18,param_2,param_3);
  return;
}




void FUN_00028030(short *param_1,undefined1 *param_2)

{
  ulonglong uVar1;
  byte bVar2;
  int iVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined1 *puVar6;
  uint uVar7;
  uint uVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  double *pdVar11;
  uint uVar12;
  double dVar13;
  
  if (*param_1 == 2) {
    uVar8 = *(uint *)(param_1 + 2);
    if ((((uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10) == 0x7f7f0000) &&
        (iVar3 = FUN_00021500(param_1,0,0xffffffff,0), iVar3 != 0)) && (iVar3 = *(int *)(iVar3 + 0x3c), iVar3 != 0)) {
      *param_2 = 8;
      uVar9 = *(undefined4 *)(iVar3 + 0xac);
      uVar4 = *(undefined4 *)(iVar3 + 0xd0);
      uVar5 = *(undefined4 *)(iVar3 + 0xd4);
      *(undefined2 *)(param_2 + 2) = 0x3f;
      uVar10 = *(undefined4 *)(iVar3 + 0xb4);
      *(undefined4 *)(param_2 + 8) = uVar9;
      uVar9 = *(undefined4 *)(iVar3 + 0xb0);
      *(undefined4 *)(param_2 + 0x10) = uVar10;
      uVar10 = *(undefined4 *)(iVar3 + 0xc0);
      *(undefined4 *)(param_2 + 0xc) = uVar9;
      bVar2 = param_2[1];
      *(undefined4 *)(param_2 + 0x14) = *(undefined4 *)(iVar3 + 0xb8);
      uVar9 = *(undefined4 *)(iVar3 + 0xbc);
      *(undefined4 *)(param_2 + 0x48) = uVar4;
      *(undefined4 *)(param_2 + 0x4c) = uVar5;
      uVar4 = *(undefined4 *)(iVar3 + 0xd8);
      uVar5 = *(undefined4 *)(iVar3 + 0xdc);
      *(undefined4 *)(param_2 + 0x1c) = uVar10;
      uVar10 = *(undefined4 *)(iVar3 + 0xc4);
      *(undefined4 *)(param_2 + 0x18) = uVar9;
      uVar9 = *(undefined4 *)(iVar3 + 200);
      *(undefined4 *)(param_2 + 0x20) = uVar10;
      *(undefined4 *)(param_2 + 0x24) = uVar9;
      *(undefined4 *)(param_2 + 4) = 0xfffffffc;
      *(undefined4 *)(param_2 + 0x50) = uVar4;
      *(undefined4 *)(param_2 + 0x54) = uVar5;
      if (2 < bVar2) {
        pdVar11 = (double *)(iVar3 + 0xf8);
        uVar7 = 2;
        puVar6 = param_2;
        do {
          dVar13 = *pdVar11;
          pdVar11 = pdVar11 + 1;
          if (0.0 <= dVar13) {
            *(int *)(puVar6 + 0x58) = (int)(longlong)dVar13;
            dVar13 = (dVar13 - (double)((longlong)dVar13 & 0xffffffff)) * 4294967296.0;
            *(uint *)(puVar6 + 0x5c) = (uint)(0.0 < dVar13) * (int)(longlong)dVar13;
          }
          else {
            uVar1 = (ulonglong)-dVar13;
            uVar12 = (uint)uVar1;
            *(uint *)(puVar6 + 0x58) = uVar12;
            dVar13 = (-dVar13 - (double)(uVar1 & 0xffffffff)) * 4294967296.0;
            iVar3 = (uint)(0.0 < dVar13) * (int)(longlong)dVar13;
            *(int *)(puVar6 + 0x5c) = iVar3;
            if (iVar3 == 0) {
              *(uint *)(puVar6 + 0x58) = -uVar12;
            }
            else {
              *(int *)(puVar6 + 0x5c) = -iVar3;
              *(uint *)(puVar6 + 0x58) = ~uVar12;
            }
          }
          uVar7 = uVar7 + 1;
          puVar6 = puVar6 + 8;
        } while (uVar7 < bVar2);
      }
      if (*(code **)((&DAT_00065b1c)[uVar8 >> 0x10 & 0xff] + 0x14) != (code *)0x0) {
        (**(code **)((&DAT_00065b1c)[uVar8 >> 0x10 & 0xff] + 0x14))(uVar8 >> 0x18,param_2);
      }
    }
  }
  return;
}




undefined * FUN_0002824c(void)

{
  undefined *puVar1;
  byte bVar2;
  int iVar3;
  size_t sVar4;
  byte unaff_r7;
  bool bVar5;
  
  if (DAT_0007fd38 == 0) {
    DAT_0007fd44 = DAT_0007fd44 + 1;
    sVar4 = DAT_0007fd40;
  }
  else {
    if (2 < DAT_0007cf4c) {
      puts("request: sending pkt");
    }
    bVar5 = DAT_0007fd48 != 0;
    iVar3 = DAT_0007fd48;
    if (bVar5) {
      iVar3 = DAT_0007fd48 << 3;
    }
    bVar2 = (byte)iVar3;
    if (bVar5) {
      bVar2 = ~(~bVar2 & 0x38);
    }
    else {
      unaff_r7 = 0xd7;
    }
    DAT_0007fd4d = (byte)DAT_0007ff48 & 0x7f;
    DAT_0007fd4c = unaff_r7;
    if (bVar5) {
      DAT_0007fd4c = bVar2;
    }
    DAT_0007fd50 = (ushort)(byte)((uint)DAT_0007fd44 >> 8) | (ushort)(DAT_0007fd44 << 8);
    FUN_000154a4(DAT_0007ff4c,DAT_0007ff50,0xffffffff,&DAT_0007fd4c,DAT_0007fd3c + 8);
    sVar4 = DAT_0007fd40;
    DAT_000cb530 = DAT_000cb530 + 1;
    memcpy(&DAT_0007fd54,&DAT_0007fb44,DAT_0007fd40);
    DAT_0007fd3c = 0;
    DAT_0007fd44 = 1;
    DAT_0007ff48 = DAT_0007ff48 + 1;
    DAT_0007fd38 = 0;
  }
  DAT_0007fd3c = DAT_0007fd3c + sVar4;
  if ((int)(DAT_0007fd3c + sVar4) < 0x1f5) {
    if (3 < DAT_0007cf4c) {
      puts("request: giving him more data");
    }
    puVar1 = &DAT_0007fd54 + DAT_0007fd3c;
  }
  else {
    if (3 < DAT_0007cf4c) {
      puts("request: into extra buffer");
    }
    if (DAT_0007ff48 == 0x7f) {
      puVar1 = (undefined *)0x0;
    }
    else {
      puVar1 = &DAT_0007fb44;
      DAT_0007fd38 = 1;
    }
  }
  return puVar1;
}




void FUN_000283dc(undefined4 *param_1,int *param_2)

{
  ushort uVar1;
  uint uVar2;
  undefined4 uVar3;
  uint uVar4;
  uint uVar5;
  undefined4 uVar6;
  undefined4 *__s;
  int iVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  uint uVar13;
  uint uVar14;
  
  __s = (undefined4 *)*param_1;
  iVar7 = *param_2;
  memset(__s,0,0x88);
  if (*(short *)(iVar7 + 0x14) == 10) {
    if (DAT_0007ff54 == 0) {
      return;
    }
    __s[0xc] = 1;
    uVar11 = *(undefined4 *)(iVar7 + 0x20);
    uVar3 = *(undefined4 *)(iVar7 + 0x24);
    uVar6 = *(undefined4 *)(iVar7 + 0x28);
    uVar12 = 0x1000000;
    *__s = *(undefined4 *)(iVar7 + 0x1c);
    __s[1] = uVar11;
    __s[2] = uVar3;
    __s[3] = uVar6;
    uVar11 = *(undefined4 *)(iVar7 + 0x58);
    uVar3 = *(undefined4 *)(iVar7 + 0x5c);
    uVar6 = *(undefined4 *)(iVar7 + 0x60);
    __s[4] = *(undefined4 *)(iVar7 + 0x54);
    __s[5] = uVar11;
    __s[6] = uVar3;
    __s[7] = uVar6;
    uVar11 = *(undefined4 *)(iVar7 + 0x3c);
    uVar3 = *(undefined4 *)(iVar7 + 0x40);
    uVar6 = *(undefined4 *)(iVar7 + 0x44);
    __s[8] = *(undefined4 *)(iVar7 + 0x38);
    __s[9] = uVar11;
    __s[10] = uVar3;
    __s[0xb] = uVar6;
  }
  else {
    __s[0xc] = 0;
    uVar12 = 0;
    *__s = *(undefined4 *)(iVar7 + 0x18);
    __s[4] = *(undefined4 *)(iVar7 + 0x50);
    __s[8] = *(undefined4 *)(iVar7 + 0x34);
  }
  __s[0xc] = uVar12;
  strncpy((char *)(__s + 0xd),(char *)(iVar7 + 0x68),0x20);
  uVar1 = *(ushort *)(iVar7 + 0x88);
  uVar11 = *(undefined4 *)(iVar7 + 0xb0);
  uVar2 = *(uint *)(iVar7 + 0x90);
  uVar4 = *(uint *)(iVar7 + 0x8c);
  uVar9 = *(uint *)(iVar7 + 0x98);
  uVar13 = DAT_000cb548 - *(int *)(iVar7 + 0x9c);
  uVar10 = *(uint *)(iVar7 + 0xa0);
  uVar8 = *(uint *)(iVar7 + 0xa4);
  uVar14 = *(uint *)(iVar7 + 0xa8);
  __s[0x15] = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  uVar4 = *(uint *)(iVar7 + 0xac);
  __s[0x16] = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 | (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
  uVar2 = *(uint *)(iVar7 + 0x10);
  uVar5 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  *(char *)((int)__s + 0x82) = (char)uVar11;
  uVar4 = *(uint *)(iVar7 + 0xb8);
  __s[0x17] = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
  __s[0x18] = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 | (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
  __s[0x19] = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
  __s[0x1a] = uVar14 << 0x18 | (uVar14 >> 8 & 0xff) << 0x10 | (uVar14 >> 0x10 & 0xff) << 8 | uVar14 >> 0x18;
  __s[0x1d] = uVar5;
  __s[0x1c] = uVar5;
  __s[0x1b] = uVar13 * 0x1000000 | (uVar13 >> 8 & 0xff) << 0x10 | (uVar13 >> 0x10 & 0xff) << 8 | uVar13 >> 0x18;
  __s[0x1e] = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 | (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
  __s[0x1f] = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  *(ushort *)(__s + 0x20) = uVar1 << 8 | uVar1 >> 8;
  *(char *)((int)__s + 0x83) = (char)param_2[1];
  uVar11 = FUN_0002824c();
  *param_1 = uVar11;
  return;
}




void FUN_0002854c(int *param_1,undefined4 *param_2)

{
  ushort uVar1;
  ushort uVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  uint *puVar6;
  uint uVar7;
  
  if (*param_1 != 0) {
    FUN_0002854c();
  }
  iVar3 = DAT_0007ff54;
  puVar6 = (uint *)*param_2;
  uVar5 = param_1[3];
  *puVar6 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
  uVar1 = *(ushort *)(param_1 + 2);
  uVar5 = param_1[1];
  if (iVar3 != 0) {
    puVar6[4] = 0;
  }
  uVar2 = *(ushort *)((int)param_1 + 10);
  uVar7 = param_1[4];
  *(ushort *)(puVar6 + 3) = uVar1 << 8 | uVar1 >> 8;
  puVar6[1] = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 | (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
  puVar6[2] = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
  *(ushort *)((int)puVar6 + 0xe) = uVar2 << 8 | uVar2 >> 8;
  uVar4 = FUN_0002824c();
  *param_2 = uVar4;
  return;
}




void FUN_000285d4(int *param_1,int *param_2)

{
  ushort uVar1;
  ushort uVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  
  if (*param_1 != 0) {
    FUN_000285d4();
  }
  iVar8 = *param_2;
  iVar4 = param_1[4];
  iVar5 = param_1[5];
  iVar6 = param_1[6];
  *(int *)(iVar8 + 0x18) = param_1[3];
  *(int *)(iVar8 + 0x1c) = iVar4;
  *(int *)(iVar8 + 0x20) = iVar5;
  *(int *)(iVar8 + 0x24) = iVar6;
  iVar4 = param_1[7];
  iVar5 = param_1[8];
  iVar6 = param_1[9];
  iVar7 = param_1[10];
  *(undefined4 *)(iVar8 + 0x10) = 1;
  *(int *)(iVar8 + 0x28) = iVar4;
  *(int *)(iVar8 + 0x2c) = iVar5;
  *(int *)(iVar8 + 0x30) = iVar6;
  *(int *)(iVar8 + 0x34) = iVar7;
  uVar1 = *(ushort *)(param_1 + 2);
  uVar2 = *(ushort *)((int)param_1 + 10);
  uVar3 = param_1[1];
  *(uint *)(iVar8 + 8) = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 | (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
  *(ushort *)(iVar8 + 0xc) = uVar1 << 8 | uVar1 >> 8;
  *(ushort *)(iVar8 + 0xe) = uVar2 << 8 | uVar2 >> 8;
  iVar4 = FUN_0002824c();
  *param_2 = iVar4;
  return;
}




undefined * FUN_00028654(undefined4 param_1,undefined4 param_2,undefined1 *param_3,undefined1 *param_4,int param_5)

{
  if (3 < DAT_0007cf4c) {
    puts("request: preparing pkt");
  }
  DAT_0007ff4c = param_1;
  DAT_0007fd4e = *param_3;
  DAT_0007ff50 = param_2;
  DAT_0007fd40 = param_5;
  DAT_0007fd4f = *param_4;
  DAT_0007fd52 = (ushort)(byte)((uint)param_5 >> 8) | (ushort)(param_5 << 8);
  DAT_0007ff48 = 0;
  DAT_0007fd44 = 0;
  DAT_0007fd3c = 0;
  DAT_0007fd38 = 0;
  return &DAT_0007fd54;
}




void FUN_000286dc(undefined4 param_1,undefined4 param_2,undefined1 param_3,undefined1 param_4,int param_5)

{
  int iVar1;
  
  iVar1 = DAT_0007fd48;
  if (DAT_0007fd48 != 0) {
    iVar1 = DAT_0007fd48 << 3;
  }
  if (DAT_0007fd48 != 0) {
    DAT_0007fd4c = ~(~(byte)iVar1 & 0x78);
  }
  else {
    DAT_0007fd4c = 0x97;
  }
  DAT_0007fd50 = (ushort)(param_5 << 4) & 0xf0;
  DAT_0007fd52 = 0;
  DAT_0007fd4d = 0;
  DAT_0007fd4e = param_3;
  DAT_0007fd4f = param_4;
  FUN_000154a4(param_1,param_2,0xffffffff,&DAT_0007fd4c,8);
  (&DAT_000cb510)[param_5] = (&DAT_000cb510)[param_5] + 1;
  return;
}




void FUN_00028778(void)

{
  byte bVar1;
  int iVar2;
  bool bVar3;
  
  if (2 < DAT_0007cf4c) {
    printf("request: flushing packet, %d items\n",DAT_0007fd44);
  }
  if ((DAT_0007ff48 == 0) && (DAT_0007fd44 == 0)) {
    FUN_000286dc(DAT_0007ff4c,DAT_0007ff50,DAT_0007fd4e,DAT_0007fd4f,4);
  }
  else {
    DAT_0007fd4d = (byte)DAT_0007ff48 & 0x7f;
    bVar3 = DAT_0007fd48 != 0;
    iVar2 = DAT_0007fd48;
    if (bVar3) {
      iVar2 = DAT_0007fd48 << 3;
    }
    bVar1 = (byte)iVar2;
    if (bVar3) {
      bVar1 = ~bVar1 & 0x78;
    }
    if (bVar3) {
      DAT_0007fd4c = ~bVar1;
    }
    else {
      DAT_0007fd4c = 0x97;
    }
    DAT_0007fd50 = (ushort)(byte)((uint)DAT_0007fd44 >> 8) | (ushort)(DAT_0007fd44 << 8);
    FUN_000154a4(DAT_0007ff4c,DAT_0007ff50,0xffffffff,&DAT_0007fd4c,DAT_0007fd3c + 8);
    DAT_000cb530 = DAT_000cb530 + 1;
  }
  return;
}




void FUN_000288f4(undefined4 param_1,undefined4 param_2,int param_3)

{
  undefined1 uVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  byte bVar5;
  int *piVar6;
  int iVar7;
  int *piVar8;
  int iVar9;
  int iVar10;
  int *piVar11;
  undefined4 uVar12;
  
  if (DAT_0007ff54 == 0) {
    uVar12 = 8;
  }
  else {
    uVar12 = 0x20;
  }
  piVar2 = (int *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,uVar12);
  if (piVar2 != (int *)0x0) {
    piVar11 = (int *)&DAT_000cb238;
    iVar9 = 0;
    do {
      piVar11 = piVar11 + 1;
      piVar8 = (int *)*piVar11;
      piVar6 = piVar2;
      if (piVar2 != (int *)0x0) {
        piVar6 = (int *)0x1;
      }
      if (piVar8 != (int *)0x0 && piVar2 != (int *)0x0) {
        do {
          iVar10 = DAT_0007ff54;
          if ((short)piVar8[3] == 10) {
            if (DAT_0007ff54 == 0) {
              piVar6 = piVar2;
              if (piVar2 != (int *)0x0) {
                piVar6 = (int *)0x1;
              }
              break;
            }
            iVar10 = piVar8[5];
            iVar3 = piVar8[6];
            iVar4 = piVar8[7];
            iVar7 = piVar8[8];
            piVar2[2] = 1;
            piVar2[4] = iVar10;
            piVar2[5] = iVar3;
            piVar2[6] = iVar4;
            piVar2[7] = iVar7;
          }
          else {
            *piVar2 = piVar8[4];
            if (iVar10 != 0) {
              piVar2[2] = 0;
            }
          }
          *(undefined2 *)(piVar2 + 1) = *(undefined2 *)((int)piVar8 + 0xe);
          uVar1 = *(undefined1 *)((int)piVar8 + 0x2f);
          *(undefined1 *)((int)piVar2 + 7) = 0;
          *(undefined1 *)((int)piVar2 + 6) = uVar1;
          piVar6 = DAT_000cb470;
          if ((piVar8[0xd] & 1U) != 0) {
            *(undefined1 *)((int)piVar2 + 7) = 1;
          }
          if (piVar8 == piVar6) {
            *(byte *)((int)piVar2 + 7) = *(byte *)((int)piVar2 + 7) | 2;
          }
          bVar5 = *(byte *)(piVar8 + 0x1a);
          if (bVar5 == 4) {
            *(byte *)((int)piVar2 + 7) = *(byte *)((int)piVar2 + 7) | 0x40;
            bVar5 = *(byte *)(piVar8 + 0x1a);
          }
          if (5 < bVar5) {
            *(byte *)((int)piVar2 + 7) = ~((byte)~(byte)(((uint)*(byte *)((int)piVar2 + 7) << 0x19) >> 0x18) >> 1);
          }
          piVar2 = (int *)FUN_0002824c();
          piVar8 = (int *)*piVar8;
          piVar6 = piVar2;
          if (piVar2 != (int *)0x0) {
            piVar6 = (int *)0x1;
          }
        } while (piVar8 != (int *)0x0 && piVar2 != (int *)0x0);
      }
      iVar10 = iVar9 + 1;
      if (0x7f < iVar10) {
        piVar6 = (int *)0x0;
      }
      if (iVar10 == 0x7f || iVar9 + -0x7e < 0 != SBORROW4(iVar10,0x7f)) {
        piVar6 = (int *)((uint)piVar6 & 1);
      }
      iVar9 = iVar10;
    } while (piVar6 != (int *)0x0);
  }
  FUN_00028778();
  return;
}




void FUN_00028ae0(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  uint uVar28;
  uint uVar29;
  uint uVar30;
  uint uVar31;
  uint uVar32;
  uint uVar33;
  uint uVar34;
  uint uVar35;
  uint uVar36;
  uint *puVar37;
  uint uVar38;
  
  puVar37 = (uint *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,0x3c);
  uVar36 = DAT_000cab78;
  uVar35 = DAT_000caab8;
  uVar34 = DAT_000caaa0;
  uVar33 = DAT_000caa9c;
  uVar38 = DAT_000cb548 - DAT_000caac0;
  uVar1 = DAT_000caad0 >> 8;
  uVar9 = DAT_000caad0 >> 0x10;
  uVar17 = DAT_000caad0 >> 0x18;
  uVar25 = DAT_000caad0 << 0x18;
  uVar2 = DAT_000caabc >> 8;
  uVar10 = DAT_000caabc >> 0x10;
  uVar18 = DAT_000caabc >> 0x18;
  uVar26 = DAT_000caabc << 0x18;
  uVar3 = DAT_000caacc >> 8;
  uVar11 = DAT_000caacc >> 0x10;
  uVar19 = DAT_000caacc >> 0x18;
  uVar27 = DAT_000caacc << 0x18;
  uVar4 = DAT_000caac8 >> 8;
  uVar12 = DAT_000caac8 >> 0x10;
  uVar20 = DAT_000caac8 >> 0x18;
  uVar28 = DAT_000caac8 << 0x18;
  uVar5 = DAT_000caab4 >> 8;
  uVar13 = DAT_000caab4 >> 0x10;
  uVar21 = DAT_000caab4 >> 0x18;
  uVar29 = DAT_000caab4 << 0x18;
  uVar6 = DAT_000caaa8 >> 8;
  uVar14 = DAT_000caaa8 >> 0x10;
  uVar22 = DAT_000caaa8 >> 0x18;
  uVar30 = DAT_000caaa8 << 0x18;
  uVar7 = DAT_000caad8 >> 8;
  uVar15 = DAT_000caad8 >> 0x10;
  uVar23 = DAT_000caad8 >> 0x18;
  uVar31 = DAT_000caad8 << 0x18;
  uVar8 = DAT_000caaa4 >> 8;
  uVar16 = DAT_000caaa4 >> 0x10;
  uVar24 = DAT_000caaa4 >> 0x18;
  uVar32 = DAT_000caaa4 << 0x18;
  *puVar37 = uVar38 * 0x1000000 | (uVar38 >> 8 & 0xff) << 0x10 | (uVar38 >> 0x10 & 0xff) << 8 | uVar38 >> 0x18;
  puVar37[2] = uVar25 | (uVar1 & 0xff) << 0x10 | (uVar9 & 0xff) << 8 | uVar17;
  puVar37[1] = uVar34 << 0x18 | (uVar34 >> 8 & 0xff) << 0x10 | (uVar34 >> 0x10 & 0xff) << 8 | uVar34 >> 0x18;
  uVar9 = DAT_000caac4;
  uVar1 = DAT_000caaac;
  puVar37[3] = uVar35 << 0x18 | (uVar35 >> 8 & 0xff) << 0x10 | (uVar35 >> 0x10 & 0xff) << 8 | uVar35 >> 0x18;
  puVar37[4] = uVar29 | (uVar5 & 0xff) << 0x10 | (uVar13 & 0xff) << 8 | uVar21;
  puVar37[5] = uVar30 | (uVar6 & 0xff) << 0x10 | (uVar14 & 0xff) << 8 | uVar22;
  puVar37[6] = uVar31 | (uVar7 & 0xff) << 0x10 | (uVar15 & 0xff) << 8 | uVar23;
  puVar37[7] = uVar33 << 0x18 | (uVar33 >> 8 & 0xff) << 0x10 | (uVar33 >> 0x10 & 0xff) << 8 | uVar33 >> 0x18;
  puVar37[8] = uVar26 | (uVar2 & 0xff) << 0x10 | (uVar10 & 0xff) << 8 | uVar18;
  puVar37[9] = uVar27 | (uVar3 & 0xff) << 0x10 | (uVar11 & 0xff) << 8 | uVar19;
  puVar37[10] = uVar28 | (uVar4 & 0xff) << 0x10 | (uVar12 & 0xff) << 8 | uVar20;
  puVar37[0xb] = uVar36 << 0x18 | (uVar36 >> 8 & 0xff) << 0x10 | (uVar36 >> 0x10 & 0xff) << 8 | uVar36 >> 0x18;
  puVar37[0xc] = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
  puVar37[0xd] = uVar32 | (uVar8 & 0xff) << 0x10 | (uVar16 & 0xff) << 8 | uVar24;
  puVar37[0xe] = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 | (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
  FUN_0002824c();
  FUN_00028778();
  return;
}




void FUN_00028c74(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  uint uVar28;
  uint *puVar29;
  uint uVar30;
  
  puVar29 = (uint *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,0x24);
  uVar30 = DAT_000cb548 - DAT_0007fb40;
  uVar1 = DAT_000cb860 >> 8;
  uVar8 = DAT_000cb860 >> 0x10;
  uVar15 = DAT_000cb860 >> 0x18;
  uVar22 = DAT_000cb860 << 0x18;
  uVar2 = DAT_000cb740 >> 8;
  uVar9 = DAT_000cb740 >> 0x10;
  uVar16 = DAT_000cb740 >> 0x18;
  uVar23 = DAT_000cb740 << 0x18;
  uVar3 = DAT_000cb73c >> 8;
  uVar10 = DAT_000cb73c >> 0x10;
  uVar17 = DAT_000cb73c >> 0x18;
  uVar24 = DAT_000cb73c << 0x18;
  uVar4 = DAT_000cb750 >> 8;
  uVar11 = DAT_000cb750 >> 0x10;
  uVar18 = DAT_000cb750 >> 0x18;
  uVar25 = DAT_000cb750 << 0x18;
  uVar5 = DAT_000cb74c >> 8;
  uVar12 = DAT_000cb74c >> 0x10;
  uVar19 = DAT_000cb74c >> 0x18;
  uVar26 = DAT_000cb74c << 0x18;
  uVar6 = DAT_000cb854 >> 8;
  uVar13 = DAT_000cb854 >> 0x10;
  uVar20 = DAT_000cb854 >> 0x18;
  uVar27 = DAT_000cb854 << 0x18;
  uVar7 = DAT_000cb72c >> 8;
  uVar14 = DAT_000cb72c >> 0x10;
  uVar21 = DAT_000cb72c >> 0x18;
  uVar28 = DAT_000cb72c << 0x18;
  puVar29[1] = DAT_000cb744 << 0x18 | (DAT_000cb744 >> 8 & 0xff) << 0x10 | (DAT_000cb744 >> 0x10 & 0xff) << 8 |
               DAT_000cb744 >> 0x18;
  puVar29[2] = uVar22 | (uVar1 & 0xff) << 0x10 | (uVar8 & 0xff) << 8 | uVar15;
  puVar29[3] = uVar23 | (uVar2 & 0xff) << 0x10 | (uVar9 & 0xff) << 8 | uVar16;
  puVar29[4] = uVar24 | (uVar3 & 0xff) << 0x10 | (uVar10 & 0xff) << 8 | uVar17;
  puVar29[5] = uVar25 | (uVar4 & 0xff) << 0x10 | (uVar11 & 0xff) << 8 | uVar18;
  puVar29[6] = uVar26 | (uVar5 & 0xff) << 0x10 | (uVar12 & 0xff) << 8 | uVar19;
  puVar29[8] = uVar27 | (uVar6 & 0xff) << 0x10 | (uVar13 & 0xff) << 8 | uVar20;
  puVar29[7] = uVar28 | (uVar7 & 0xff) << 0x10 | (uVar14 & 0xff) << 8 | uVar21;
  *puVar29 = uVar30 * 0x1000000 | (uVar30 >> 8 & 0xff) << 0x10 | (uVar30 >> 0x10 & 0xff) << 8 | uVar30 >> 0x18;
  FUN_0002824c();
  FUN_00028778();
  return;
}




void FUN_00028e18(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  uint uVar5;
  uint uVar6;
  
  puVar4 = (uint *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,0x10);
  uVar5 = DAT_000cb548 - DAT_000cb540;
  uVar6 = uVar5 * 0x1000000 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
  uVar5 = DAT_000cb544 >> 8;
  uVar1 = DAT_000cb544 >> 0x10;
  uVar2 = DAT_000cb544 >> 0x18;
  uVar3 = DAT_000cb544 << 0x18;
  puVar4[2] = DAT_000cb54c << 0x18 | (DAT_000cb54c >> 8 & 0xff) << 0x10 | (DAT_000cb54c >> 0x10 & 0xff) << 8 |
              DAT_000cb54c >> 0x18;
  *puVar4 = uVar6;
  puVar4[3] = uVar3 | (uVar5 & 0xff) << 0x10 | (uVar1 & 0xff) << 8 | uVar2;
  puVar4[1] = uVar6;
  FUN_0002824c();
  FUN_00028778();
  return;
}




void FUN_00028e98(undefined4 param_1,undefined4 param_2,int param_3)

{
  ulonglong uVar1;
  uint *puVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  double dVar6;
  
  puVar2 = (uint *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,0x18);
  if (DAT_000cabd0 < 0.0) {
    uVar1 = (ulonglong)-DAT_000cabd0;
    uVar4 = (uint)uVar1;
    dVar6 = (-DAT_000cabd0 - (double)(uVar1 & 0xffffffff)) * 4294967296.0;
    iVar3 = (uint)(0.0 < dVar6) * (int)(longlong)dVar6;
    if (iVar3 == 0) {
      uVar4 = -uVar4;
      uVar5 = 0;
    }
    else {
      uVar5 = -iVar3;
      uVar5 = iVar3 * -0x1000000 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
      uVar4 = ~uVar4;
    }
  }
  else {
    uVar4 = (uint)(longlong)DAT_000cabd0;
    dVar6 = (DAT_000cabd0 - (double)((longlong)DAT_000cabd0 & 0xffffffff)) * 4294967296.0;
    uVar5 = (uint)(0.0 < dVar6) * (int)(longlong)dVar6;
    uVar5 = uVar5 * 0x1000000 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
  }
  puVar2[1] = uVar5;
  *puVar2 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  dVar6 = DAT_000caba8 * 1000000.0;
  if (dVar6 < 0.0) {
    uVar1 = (ulonglong)-dVar6;
    uVar4 = (uint)uVar1;
    dVar6 = (-dVar6 - (double)(uVar1 & 0xffffffff)) * 4294967296.0;
    iVar3 = (uint)(0.0 < dVar6) * (int)(longlong)dVar6;
    if (iVar3 == 0) {
      uVar4 = -uVar4;
      uVar5 = 0;
    }
    else {
      uVar5 = -iVar3;
      uVar5 = iVar3 * -0x1000000 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
      uVar4 = ~uVar4;
    }
  }
  else {
    uVar4 = (uint)(longlong)dVar6;
    dVar6 = (dVar6 - (double)((longlong)dVar6 & 0xffffffff)) * 4294967296.0;
    uVar5 = (uint)(0.0 < dVar6) * (int)(longlong)dVar6;
    uVar5 = uVar5 * 0x1000000 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
  }
  puVar2[3] = uVar5;
  uVar5 = DAT_000cb548 - DAT_000cb4a8;
  puVar2[5] = uVar5 * 0x1000000 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
  puVar2[2] = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  puVar2[4] = DAT_000cabbc << 0x18 | (DAT_000cabbc >> 8 & 0xff) << 0x10 | (DAT_000cabbc >> 0x10 & 0xff) << 8 |
              DAT_000cabbc >> 0x18;
  FUN_0002824c();
  FUN_00028778();
  return;
}




void FUN_0002904c(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  int *piVar6;
  int iVar7;
  uint uVar8;
  
  puVar5 = (uint *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,0x94);
  uVar4 = DAT_000cb448;
  uVar3 = DAT_000cb43c;
  uVar2 = DAT_000cb038;
  piVar6 = (int *)0xcae30;
  uVar8 = DAT_000cb548 - DAT_000cb034;
  iVar7 = DAT_000cb440 << 8;
  uVar1 = (uint)DAT_000cb440 >> 8;
  *(ushort *)(puVar5 + 1) = (ushort)(byte)((uint)DAT_000cac30 >> 8) | (ushort)(DAT_000cac30 << 8);
  *(ushort *)((int)puVar5 + 6) = (ushort)(byte)uVar1 | (ushort)iVar7;
  puVar5[2] = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 | (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
  *puVar5 = uVar8 * 0x1000000 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
  puVar5[4] = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 | (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18;
  puVar5[3] = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 | (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
  do {
    piVar6 = piVar6 + 1;
    iVar7 = *piVar6;
    if (0xff < iVar7) {
      iVar7 = -1;
    }
    *(char *)(puVar5 + 5) = (char)iVar7;
    puVar5 = (uint *)((int)puVar5 + 1);
  } while (piVar6 != (int *)&DAT_000cb030);
  FUN_0002824c();
  FUN_00028778();
  return;
}




void FUN_0002913c(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint *puVar18;
  int iVar19;
  uint uVar20;
  
  puVar18 = (uint *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,0x28);
  uVar20 = DAT_000cb548 - DAT_000ca614;
  *puVar18 = uVar20 * 0x1000000 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
  iVar19 = FUN_000508f8();
  *(ushort *)(puVar18 + 1) = (ushort)(byte)((uint)iVar19 >> 8) | (ushort)(iVar19 << 8);
  iVar19 = FUN_000508d8();
  *(ushort *)((int)puVar18 + 6) = (ushort)(byte)((uint)iVar19 >> 8) | (ushort)(iVar19 << 8);
  iVar19 = FUN_000508e8();
  *(ushort *)(puVar18 + 2) = (ushort)(byte)((uint)iVar19 >> 8) | (ushort)(iVar19 << 8);
  iVar19 = FUN_00050908();
  uVar17 = DAT_000ca658;
  uVar16 = DAT_000ca638;
  uVar20 = DAT_000ca620 >> 8;
  uVar4 = DAT_000ca620 >> 0x10;
  uVar8 = DAT_000ca620 >> 0x18;
  uVar12 = DAT_000ca620 << 0x18;
  uVar1 = DAT_000ca650 >> 8;
  uVar5 = DAT_000ca650 >> 0x10;
  uVar9 = DAT_000ca650 >> 0x18;
  uVar13 = DAT_000ca650 << 0x18;
  uVar2 = DAT_000ca640 >> 8;
  uVar6 = DAT_000ca640 >> 0x10;
  uVar10 = DAT_000ca640 >> 0x18;
  uVar14 = DAT_000ca640 << 0x18;
  uVar3 = DAT_000ca60c >> 8;
  uVar7 = DAT_000ca60c >> 0x10;
  uVar11 = DAT_000ca60c >> 0x18;
  uVar15 = DAT_000ca60c << 0x18;
  puVar18[9] = DAT_000ca63c << 0x18 | (DAT_000ca63c >> 8 & 0xff) << 0x10 | (DAT_000ca63c >> 0x10 & 0xff) << 8 |
               DAT_000ca63c >> 0x18;
  puVar18[3] = uVar12 | (uVar20 & 0xff) << 0x10 | (uVar4 & 0xff) << 8 | uVar8;
  puVar18[4] = uVar13 | (uVar1 & 0xff) << 0x10 | (uVar5 & 0xff) << 8 | uVar9;
  puVar18[5] = uVar14 | (uVar2 & 0xff) << 0x10 | (uVar6 & 0xff) << 8 | uVar10;
  puVar18[6] = uVar15 | (uVar3 & 0xff) << 0x10 | (uVar7 & 0xff) << 8 | uVar11;
  puVar18[7] = uVar17 << 0x18 | (uVar17 >> 8 & 0xff) << 0x10 | (uVar17 >> 0x10 & 0xff) << 8 | uVar17 >> 0x18;
  puVar18[8] = uVar16 << 0x18 | (uVar16 >> 8 & 0xff) << 0x10 | (uVar16 >> 0x10 & 0xff) << 8 | uVar16 >> 0x18;
  *(ushort *)((int)puVar18 + 10) = (ushort)(byte)((uint)iVar19 >> 8) | (ushort)(iVar19 << 8);
  FUN_0002824c();
  FUN_00028778();
  return;
}




void FUN_00029260(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  uint uVar15;
  uint uVar16;
  uint uVar17;
  uint uVar18;
  uint uVar19;
  uint uVar20;
  uint uVar21;
  uint uVar22;
  uint uVar23;
  uint uVar24;
  uint uVar25;
  uint uVar26;
  uint uVar27;
  uint uVar28;
  uint uVar29;
  uint uVar30;
  uint uVar31;
  uint uVar32;
  uint uVar33;
  uint uVar34;
  uint uVar35;
  uint uVar36;
  uint *puVar37;
  uint uVar38;
  
  puVar37 = (uint *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,0x2c);
  uVar38 = DAT_000cb548 - DAT_000cb468;
  uVar1 = DAT_000cb4dc >> 8;
  uVar10 = DAT_000cb4dc >> 0x10;
  uVar19 = DAT_000cb4dc >> 0x18;
  uVar28 = DAT_000cb4dc << 0x18;
  uVar2 = DAT_000cb4c4 >> 8;
  uVar11 = DAT_000cb4c4 >> 0x10;
  uVar20 = DAT_000cb4c4 >> 0x18;
  uVar29 = DAT_000cb4c4 << 0x18;
  uVar3 = DAT_000cb4c0 >> 8;
  uVar12 = DAT_000cb4c0 >> 0x10;
  uVar21 = DAT_000cb4c0 >> 0x18;
  uVar30 = DAT_000cb4c0 << 0x18;
  uVar4 = DAT_000cb4a0 >> 8;
  uVar13 = DAT_000cb4a0 >> 0x10;
  uVar22 = DAT_000cb4a0 >> 0x18;
  uVar31 = DAT_000cb4a0 << 0x18;
  uVar5 = DAT_000cb474 >> 8;
  uVar14 = DAT_000cb474 >> 0x10;
  uVar23 = DAT_000cb474 >> 0x18;
  uVar32 = DAT_000cb474 << 0x18;
  uVar6 = DAT_000cb484 >> 8;
  uVar15 = DAT_000cb484 >> 0x10;
  uVar24 = DAT_000cb484 >> 0x18;
  uVar33 = DAT_000cb484 << 0x18;
  uVar7 = DAT_000cb47c >> 8;
  uVar16 = DAT_000cb47c >> 0x10;
  uVar25 = DAT_000cb47c >> 0x18;
  uVar34 = DAT_000cb47c << 0x18;
  uVar8 = DAT_000cb490 >> 8;
  uVar17 = DAT_000cb490 >> 0x10;
  uVar26 = DAT_000cb490 >> 0x18;
  uVar35 = DAT_000cb490 << 0x18;
  uVar9 = DAT_000cb4f8 >> 8;
  uVar18 = DAT_000cb4f8 >> 0x10;
  uVar27 = DAT_000cb4f8 >> 0x18;
  uVar36 = DAT_000cb4f8 << 0x18;
  *puVar37 = DAT_000cb548 << 0x18 | (DAT_000cb548 >> 8 & 0xff) << 0x10 | (DAT_000cb548 >> 0x10 & 0xff) << 8 |
             DAT_000cb548 >> 0x18;
  puVar37[1] = uVar38 * 0x1000000 | (uVar38 >> 8 & 0xff) << 0x10 | (uVar38 >> 0x10 & 0xff) << 8 | uVar38 >> 0x18;
  puVar37[2] = uVar28 | (uVar1 & 0xff) << 0x10 | (uVar10 & 0xff) << 8 | uVar19;
  puVar37[3] = uVar30 | (uVar3 & 0xff) << 0x10 | (uVar12 & 0xff) << 8 | uVar21;
  puVar37[4] = uVar33 | (uVar6 & 0xff) << 0x10 | (uVar15 & 0xff) << 8 | uVar24;
  puVar37[5] = uVar34 | (uVar7 & 0xff) << 0x10 | (uVar16 & 0xff) << 8 | uVar25;
  puVar37[6] = uVar35 | (uVar8 & 0xff) << 0x10 | (uVar17 & 0xff) << 8 | uVar26;
  puVar37[7] = uVar32 | (uVar5 & 0xff) << 0x10 | (uVar14 & 0xff) << 8 | uVar23;
  puVar37[8] = uVar36 | (uVar9 & 0xff) << 0x10 | (uVar18 & 0xff) << 8 | uVar27;
  puVar37[10] = uVar29 | (uVar2 & 0xff) << 0x10 | (uVar11 & 0xff) << 8 | uVar20;
  puVar37[9] = uVar31 | (uVar4 & 0xff) << 0x10 | (uVar13 & 0xff) << 8 | uVar22;
  FUN_0002824c();
  FUN_00028778();
  return;
}




void FUN_00029370(undefined4 param_1,undefined4 param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  undefined1 uVar5;
  double dVar6;
  double dVar7;
  undefined1 uVar8;
  undefined4 *puVar9;
  uint uVar10;
  undefined4 uVar11;
  undefined4 uVar12;
  undefined4 uVar13;
  undefined4 uVar14;
  bool bVar15;
  uint uVar16;
  uint uVar17;
  double dVar18;
  double dVar19;
  
  if (DAT_0007ff54 == 0) {
    uVar14 = 0x38;
  }
  else {
    uVar14 = 0x50;
  }
  puVar9 = (undefined4 *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,uVar14);
  iVar4 = DAT_000cb470;
  iVar3 = DAT_0007ff54;
  if (DAT_000cb470 == 0) {
    *puVar9 = 0;
    if (iVar3 != 0) {
      puVar9[0xe] = 0;
    }
    *(undefined1 *)(puVar9 + 1) = 0;
  }
  else {
    if (*(short *)(DAT_000cb470 + 0xc) == 2) {
      bVar15 = DAT_0007ff54 != 0;
      *puVar9 = *(undefined4 *)(DAT_000cb470 + 0x10);
      if (bVar15) {
        puVar9[0xe] = 0;
      }
    }
    else if (DAT_0007ff54 != 0) {
      uVar14 = *(undefined4 *)(DAT_000cb470 + 0x14);
      uVar11 = *(undefined4 *)(DAT_000cb470 + 0x18);
      uVar12 = *(undefined4 *)(DAT_000cb470 + 0x1c);
      uVar13 = *(undefined4 *)(DAT_000cb470 + 0x20);
      puVar9[0xe] = 1;
      puVar9[0x10] = uVar14;
      puVar9[0x11] = uVar11;
      puVar9[0x12] = uVar12;
      puVar9[0x13] = uVar13;
    }
    *(undefined1 *)(puVar9 + 1) = *(undefined1 *)(iVar4 + 0x2f);
  }
  uVar8 = DAT_000cb4fc;
  uVar5 = DAT_000cb478;
  *(undefined1 *)((int)puVar9 + 5) = DAT_000cb4b0;
  *(undefined1 *)((int)puVar9 + 6) = uVar8;
  *(undefined1 *)((int)puVar9 + 7) = uVar5;
  dVar6 = DAT_000cb498;
  dVar19 = DAT_000cb4b8 * 65536.0;
  *(undefined1 *)(puVar9 + 8) = 0;
  dVar7 = DAT_000cb4e8;
  dVar18 = DAT_000caba0;
  bVar15 = DAT_000cb46c != 0;
  uVar16 = DAT_000cb504 >> 8;
  uVar17 = DAT_000cb504 >> 0x10;
  uVar1 = DAT_000cb504 >> 0x18;
  uVar2 = DAT_000cb504 << 0x18;
  puVar9[5] = DAT_000cb500 << 0x18 | (DAT_000cb500 >> 8 & 0xff) << 0x10 | (DAT_000cb500 >> 0x10 & 0xff) << 8 |
              DAT_000cb500 >> 0x18;
  uVar14 = DAT_000cb4e0;
  uVar10 = (uint)DAT_000cabc8;
  puVar9[6] = uVar2 | (uVar16 & 0xff) << 0x10 | (uVar17 & 0xff) << 8 | uVar1;
  puVar9[4] = uVar14;
  puVar9[7] = uVar10;
  uVar16 = (uint)(longlong)dVar19;
  uVar17 = (uint)(0.0 < dVar6 * 65536.0) * (int)(longlong)(dVar6 * 65536.0);
  puVar9[2] = uVar16 << 0x18 | (uVar16 >> 8 & 0xff) << 0x10 | (uVar16 >> 0x10 & 0xff) << 8 | uVar16 >> 0x18;
  uVar16 = (uint)(longlong)(dVar7 * 65536.0);
  puVar9[3] = uVar17 * 0x1000000 | (uVar17 >> 8 & 0xff) << 0x10 | (uVar17 >> 0x10 & 0xff) << 8 | uVar17 >> 0x18;
  uVar17 = (uint)(0.0 < dVar18 * 65536.0) * (int)(longlong)(dVar18 * 65536.0);
  puVar9[10] = uVar16 << 0x18 | (uVar16 >> 8 & 0xff) << 0x10 | (uVar16 >> 0x10 & 0xff) << 8 | uVar16 >> 0x18;
  puVar9[0xd] = uVar17 * 0x1000000 | (uVar17 >> 8 & 0xff) << 0x10 | (uVar17 >> 0x10 & 0xff) << 8 | uVar17 >> 0x18;
  if (bVar15) {
    *(undefined1 *)(puVar9 + 8) = 2;
  }
  if (DAT_000cb4f4 != 0) {
    *(byte *)(puVar9 + 8) = *(byte *)(puVar9 + 8) | 1;
  }
  if (DAT_000cb508 != 0) {
    *(byte *)(puVar9 + 8) = *(byte *)(puVar9 + 8) | 0x10;
  }
  if (DAT_0007a198 != 0) {
    *(byte *)(puVar9 + 8) = *(byte *)(puVar9 + 8) | 8;
  }
  puVar9[0xb] = 0;
  if (DAT_000cac24 != 0) {
    *(byte *)(puVar9 + 8) = *(byte *)(puVar9 + 8) | 0x40;
  }
  if (DAT_0007a19c != 0) {
    *(byte *)(puVar9 + 8) = *(byte *)(puVar9 + 8) | 4;
  }
  if (DAT_000cabc4 != 0) {
    *(byte *)(puVar9 + 8) = *(byte *)(puVar9 + 8) | 0x20;
  }
  if (DAT_000cb588 != 0) {
    *(byte *)(puVar9 + 8) = ~((byte)~(byte)(((uint)*(byte *)(puVar9 + 8) << 0x19) >> 0x18) >> 1);
  }
  dVar18 = DAT_000cb488 * 65536.0;
  puVar9[0xc] = DAT_000cb45c << 0x18 | (DAT_000cb45c >> 8 & 0xff) << 0x10 | (DAT_000cb45c >> 0x10 & 0xff) << 8 |
                DAT_000cb45c >> 0x18;
  uVar16 = (uint)(longlong)dVar18;
  puVar9[9] = uVar16 << 0x18 | (uVar16 >> 8 & 0xff) << 0x10 | (uVar16 >> 0x10 & 0xff) << 8 | uVar16 >> 0x18;
  FUN_0002824c();
  FUN_00028778();
  return;
}




void FUN_00029668(undefined4 param_1,undefined4 param_2,int param_3)

{
  ushort uVar1;
  undefined2 uVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  byte bVar10;
  int iVar11;
  int iVar12;
  uint uVar13;
  uint uVar14;
  undefined4 *puVar15;
  uint uVar16;
  uint uVar17;
  undefined4 uVar18;
  uint uVar19;
  uint uVar20;
  undefined2 local_44;
  ushort local_42;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  
  if (DAT_0007cf4c != 0) {
    puts("peer_stats: called");
  }
  uVar1 = *(ushort *)(param_3 + 4);
  puVar15 = (undefined4 *)(param_3 + 8);
  if (DAT_0007ff54 == 0) {
    uVar18 = 0x50;
  }
  else {
    uVar18 = 0x78;
  }
  piVar3 = (int *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,uVar18);
  uVar16 = (uVar1 & 0xf) << 8 | (uint)(uVar1 >> 8);
  while (uVar16 != 0) {
    while( true ) {
      uVar16 = uVar16 - 1;
      if (piVar3 == (int *)0x0) goto LAB_00029934;
      local_42 = *(ushort *)(puVar15 + 1);
      local_40 = 0;
      local_3c = 0;
      local_38 = 0;
      local_34 = 0;
      local_30 = 0;
      local_2c = 0;
      if ((DAT_0007ff54 == 0) || (puVar15[2] == 0)) {
        local_40 = *puVar15;
        local_44 = 2;
      }
      else {
        local_44 = 10;
        local_3c = puVar15[4];
        local_38 = puVar15[5];
        local_34 = puVar15[6];
        local_30 = puVar15[7];
      }
      if (0 < DAT_0007cf4c) {
        uVar18 = FUN_00050cd0(&local_44);
        printf("peer_stats: looking for %s, %d, %d\n",uVar18,(uint)*(ushort *)(puVar15 + 1),(uint)local_42);
      }
      puVar15 = (undefined4 *)
                ((int)puVar15 + ((*(ushort *)(param_3 + 6) & 0xf) << 8 | (uint)(*(ushort *)(param_3 + 6) >> 8)));
      iVar4 = FUN_00021500(&local_44,0,0xffffffff,0);
      if (iVar4 == 0) break;
      if (0 < DAT_0007cf4c) {
        uVar18 = FUN_00050cd0(&local_44);
        printf("peer_stats: found %s\n",uVar18);
      }
      if (*(short *)(iVar4 + 0xc) == 2) {
        iVar5 = *(int *)(iVar4 + 0x28);
        uVar17 = *(uint *)(iVar4 + 0x228);
        if (iVar5 == 0) {
          *piVar3 = 0;
        }
        else if (uVar17 == 0) {
          *piVar3 = *(int *)(iVar5 + 0x18);
        }
        else if ((*(char *)(iVar4 + 0x38) == '\x04') ||
                ((*(char *)(iVar4 + 0x38) != '\0' && (iVar7 = *(int *)(iVar5 + 0x18), *piVar3 = iVar7, iVar7 == 0)))) {
          *piVar3 = *(int *)(iVar5 + 0x50);
        }
        iVar5 = DAT_0007ff54;
        piVar3[1] = *(int *)(iVar4 + 0x10);
        if (iVar5 != 0) {
          piVar3[0x14] = 0;
        }
      }
      else {
        iVar5 = *(int *)(iVar4 + 0x28);
        if (iVar5 == 0) {
          memset(piVar3 + 0x16,0,0x10);
        }
        else {
          if (*(char *)(iVar4 + 0x38) == '\x04') {
            piVar6 = (int *)(iVar5 + 0x54);
          }
          else {
            piVar6 = (int *)(iVar5 + 0x1c);
          }
          iVar5 = piVar6[1];
          iVar7 = piVar6[2];
          iVar11 = piVar6[3];
          piVar3[0x16] = *piVar6;
          piVar3[0x17] = iVar5;
          piVar3[0x18] = iVar7;
          piVar3[0x19] = iVar11;
        }
        iVar5 = *(int *)(iVar4 + 0x14);
        iVar7 = *(int *)(iVar4 + 0x18);
        iVar11 = *(int *)(iVar4 + 0x1c);
        iVar12 = *(int *)(iVar4 + 0x20);
        piVar3[0x14] = 1;
        piVar3[0x1a] = iVar5;
        piVar3[0x1b] = iVar7;
        piVar3[0x1c] = iVar11;
        piVar3[0x1d] = iVar12;
        uVar17 = *(uint *)(iVar4 + 0x228);
      }
      iVar5 = DAT_000cb470;
      uVar2 = *(undefined2 *)(iVar4 + 0xe);
      *(undefined2 *)((int)piVar3 + 10) = 0;
      *(undefined2 *)(piVar3 + 2) = uVar2;
      uVar13 = *(uint *)(iVar4 + 0x34);
      if (iVar4 == iVar5) {
        uVar8 = 2;
        *(undefined2 *)((int)piVar3 + 10) = 2;
      }
      else {
        uVar8 = 0;
      }
      if ((uVar13 & 1) != 0) {
        uVar8 = uVar8 | 1;
        *(short *)((int)piVar3 + 10) = (short)uVar8;
      }
      iVar5 = *(int *)(iVar4 + 0x21c);
      if ((uVar13 & 8) != 0) {
        uVar8 = uVar8 | 8;
        *(short *)((int)piVar3 + 10) = (short)uVar8;
      }
      iVar7 = *(int *)(iVar4 + 0x218);
      if ((uVar13 & 0x20) != 0) {
        uVar8 = uVar8 | 0x10;
        *(short *)((int)piVar3 + 10) = (short)uVar8;
      }
      if ((uVar13 & 0x40) != 0) {
        uVar8 = uVar8 | 4;
        *(short *)((int)piVar3 + 10) = (short)uVar8;
      }
      if ((uVar13 & 0x100) != 0) {
        uVar8 = uVar8 | 0x100;
        *(short *)((int)piVar3 + 10) = (short)uVar8;
      }
      bVar10 = *(byte *)(iVar4 + 0x68);
      if (bVar10 == 4) {
        uVar8 = uVar8 | 0x40;
        *(short *)((int)piVar3 + 10) = (short)uVar8;
        bVar10 = *(byte *)(iVar4 + 0x68);
      }
      iVar11 = DAT_000cb548;
      if (5 < bVar10) {
        uVar8 = uVar8 | 0x80;
      }
      iVar12 = *(int *)(iVar4 + 0x208);
      piVar3[9] = uVar17 << 0x18 | (uVar17 >> 8 & 0xff) << 0x10 | (uVar17 >> 0x10 & 0xff) << 8 | uVar17 >> 0x18;
      uVar13 = iVar12 - iVar11;
      uVar17 = iVar11 - iVar7;
      uVar14 = iVar11 - iVar5;
      uVar19 = *(uint *)(iVar4 + 0x220);
      uVar9 = *(uint *)(iVar4 + 0x230);
      uVar20 = *(uint *)(iVar4 + 0x22c);
      piVar3[7] = uVar19 << 0x18 | (uVar19 >> 8 & 0xff) << 0x10 | (uVar19 >> 0x10 & 0xff) << 8 | uVar19 >> 0x18;
      uVar19 = *(uint *)(iVar4 + 0x234);
      piVar3[4] = uVar17 * 0x1000000 | (uVar17 >> 8 & 0xff) << 0x10 | (uVar17 >> 0x10 & 0xff) << 8 | uVar17 >> 0x18;
      uVar17 = *(uint *)(iVar4 + 0x238);
      piVar3[5] = uVar13 * 0x1000000 | (uVar13 >> 8 & 0xff) << 0x10 | (uVar13 >> 0x10 & 0xff) << 8 | uVar13 >> 0x18;
      uVar13 = *(uint *)(iVar4 + 0x23c);
      piVar3[6] = uVar14 * 0x1000000 | (uVar14 >> 8 & 0xff) << 0x10 | (uVar14 >> 0x10 & 0xff) << 8 | uVar14 >> 0x18;
      piVar3[0xb] = uVar20 << 0x18 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
      piVar3[0xc] = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
      piVar3[0xd] = uVar19 << 0x18 | (uVar19 >> 8 & 0xff) << 0x10 | (uVar19 >> 0x10 & 0xff) << 8 | uVar19 >> 0x18;
      piVar3[0x10] = uVar17 << 0x18 | (uVar17 >> 8 & 0xff) << 0x10 | (uVar17 >> 0x10 & 0xff) << 8 | uVar17 >> 0x18;
      piVar3[0x11] = uVar13 << 0x18 | (uVar13 >> 8 & 0xff) << 0x10 | (uVar13 >> 0x10 & 0xff) << 8 | uVar13 >> 0x18;
      *(ushort *)((int)piVar3 + 10) = (ushort)(uVar8 << 8) | (ushort)(uVar8 >> 8);
      *(undefined1 *)(piVar3 + 0x13) = *(undefined1 *)(iVar4 + 0x68);
      piVar3 = (int *)FUN_0002824c();
      if (uVar16 == 0) goto LAB_00029934;
    }
  }
LAB_00029934:
  FUN_00028778();
  return;
}




/* WARNING: Removing unreachable block (ram,0x00029fd4) */
/* WARNING: Removing unreachable block (ram,0x00029fe0) */

void FUN_000299fc(short *param_1,undefined4 param_2,int param_3)

{
  byte *pbVar1;
  ulonglong uVar2;
  undefined2 uVar3;
  ushort uVar4;
  int *piVar5;
  int iVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  byte bVar10;
  int iVar11;
  uint uVar12;
  int *piVar13;
  uint uVar14;
  int iVar15;
  int iVar16;
  int *piVar17;
  undefined4 uVar18;
  double dVar19;
  uint uVar20;
  double dVar21;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  
  iVar15 = param_3 + 0x28;
  uVar14 = (*(ushort *)(param_3 + 4) & 0xf) << 8 | (uint)(*(ushort *)(param_3 + 4) >> 8);
  if (DAT_0007ff54 == 0) {
    uVar18 = 0xf0;
  }
  else {
    uVar18 = 0x118;
  }
  piVar5 = (int *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,uVar18);
  while ((uVar14 != 0 && (uVar14 = uVar14 - 1, piVar5 != (int *)0x0))) {
    local_50 = 0;
    local_4c = 0;
    local_48 = 0;
    local_44 = 0;
    local_40 = 0;
    local_3c = 0;
    if ((DAT_0007ff54 == 0) || (*(int *)(iVar15 + -0x18) == 0)) {
      local_54 = CONCAT22(*(undefined2 *)(iVar15 + -0x1c),2);
      local_50 = *(undefined4 *)(iVar15 + -0x20);
    }
    else {
      local_54 = CONCAT22(*(undefined2 *)(iVar15 + -0x1c),10);
      local_40 = *(undefined4 *)(iVar15 + -4);
      local_44 = *(undefined4 *)(iVar15 + -8);
      local_48 = *(undefined4 *)(iVar15 + -0xc);
      local_4c = *(undefined4 *)(iVar15 + -0x10);
    }
    iVar6 = FUN_00021500(&local_54,0,0xffffffff,0);
    if (iVar6 != 0) {
      if (*param_1 == 10) {
        iVar11 = *(int *)(iVar6 + 0x28);
        if (iVar11 == 0) {
          memset(piVar5 + 0x3e,0,0x10);
        }
        else {
          if (*(char *)(iVar6 + 0x38) == '\x04') {
            iVar8 = *(int *)(iVar11 + 0x54);
            iVar16 = *(int *)(iVar11 + 0x58);
            iVar9 = *(int *)(iVar11 + 0x5c);
            iVar11 = *(int *)(iVar11 + 0x60);
          }
          else {
            iVar8 = *(int *)(iVar11 + 0x1c);
            iVar16 = *(int *)(iVar11 + 0x20);
            iVar9 = *(int *)(iVar11 + 0x24);
            iVar11 = *(int *)(iVar11 + 0x28);
          }
          piVar5[0x3e] = iVar8;
          piVar5[0x3f] = iVar16;
          piVar5[0x40] = iVar9;
          piVar5[0x41] = iVar11;
        }
        iVar11 = *(int *)(iVar6 + 0x14);
        iVar8 = *(int *)(iVar6 + 0x18);
        iVar16 = *(int *)(iVar6 + 0x1c);
        iVar9 = *(int *)(iVar6 + 0x20);
        piVar5[0x3c] = 1;
        piVar5[0x42] = iVar11;
        piVar5[0x43] = iVar8;
        piVar5[0x44] = iVar16;
        piVar5[0x45] = iVar9;
      }
      else {
        iVar11 = *(int *)(iVar6 + 0x28);
        if (iVar11 == 0) {
          *piVar5 = 0;
        }
        else if (*(int *)(iVar6 + 0x228) == 0) {
          *piVar5 = *(int *)(iVar11 + 0x18);
        }
        else if ((*(char *)(iVar6 + 0x38) == '\x04') ||
                ((*(char *)(iVar6 + 0x38) != '\0' && (iVar8 = *(int *)(iVar11 + 0x18), *piVar5 = iVar8, iVar8 == 0)))) {
          *piVar5 = *(int *)(iVar11 + 0x50);
        }
        iVar11 = DAT_0007ff54;
        piVar5[1] = *(int *)(iVar6 + 0x10);
        if (iVar11 != 0) {
          piVar5[0x3c] = 0;
        }
      }
      iVar11 = DAT_000cb470;
      uVar3 = *(undefined2 *)(iVar6 + 0xe);
      *(undefined1 *)((int)piVar5 + 10) = 0;
      *(undefined2 *)(piVar5 + 2) = uVar3;
      if (iVar6 == iVar11) {
        *(undefined1 *)((int)piVar5 + 10) = 2;
      }
      uVar12 = *(uint *)(iVar6 + 0x34);
      if ((uVar12 & 1) != 0) {
        *(byte *)((int)piVar5 + 10) = *(byte *)((int)piVar5 + 10) | 1;
        uVar12 = *(uint *)(iVar6 + 0x34);
      }
      if ((uVar12 & 8) != 0) {
        *(byte *)((int)piVar5 + 10) = *(byte *)((int)piVar5 + 10) | 8;
        uVar12 = *(uint *)(iVar6 + 0x34);
      }
      if ((uVar12 & 0x20) != 0) {
        *(byte *)((int)piVar5 + 10) = *(byte *)((int)piVar5 + 10) | 0x10;
        uVar12 = *(uint *)(iVar6 + 0x34);
      }
      if ((uVar12 & 0x40) != 0) {
        *(byte *)((int)piVar5 + 10) = *(byte *)((int)piVar5 + 10) | 4;
      }
      bVar10 = *(byte *)(iVar6 + 0x68);
      if (bVar10 == 4) {
        *(byte *)((int)piVar5 + 10) = *(byte *)((int)piVar5 + 10) | 0x40;
        bVar10 = *(byte *)(iVar6 + 0x68);
      }
      if (5 < bVar10) {
        *(byte *)((int)piVar5 + 10) = ~((byte)~(byte)(((uint)*(byte *)((int)piVar5 + 10) << 0x19) >> 0x18) >> 1);
      }
      *(undefined1 *)((int)piVar5 + 0xb) = *(undefined1 *)(iVar6 + 0x43);
      *(undefined1 *)(piVar5 + 3) = *(undefined1 *)(iVar6 + 0x2f);
      piVar5[7] = *(int *)(iVar6 + 100);
      *(undefined1 *)((int)piVar5 + 0xe) = *(undefined1 *)(iVar6 + 0x45);
      *(undefined1 *)((int)piVar5 + 0xf) = *(undefined1 *)(iVar6 + 0x46);
      *(undefined1 *)(piVar5 + 4) = *(undefined1 *)(iVar6 + 0x30);
      *(undefined1 *)((int)piVar5 + 0x11) = *(undefined1 *)(iVar6 + 0x47);
      *(undefined1 *)((int)piVar5 + 0x12) = *(undefined1 *)(iVar6 + 0x2e);
      *(undefined1 *)(piVar5 + 5) = *(undefined1 *)(iVar6 + 0x6a);
      *(char *)((int)piVar5 + 0x15) = (char)*(undefined4 *)(iVar6 + 0x1fc);
      *(char *)((int)piVar5 + 0x16) = (char)*(undefined4 *)(iVar6 + 0x6c);
      dVar21 = *(double *)(iVar6 + 0x1a0);
      *(short *)(piVar5 + 6) = (short)*(undefined4 *)(iVar6 + 0x6c);
      uVar12 = (uint)(longlong)(dVar21 * 65536.0);
      piVar5[0x3b] = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      *(undefined1 *)((int)piVar5 + 0x17) = *(undefined1 *)(iVar6 + 0x3b);
      dVar21 = *(double *)(iVar6 + 0x48) * 65536.0;
      uVar4 = *(ushort *)(iVar6 + 0x2c);
      uVar12 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
      dVar21 = *(double *)(iVar6 + 0x50) * 65536.0;
      uVar20 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
      piVar5[0xb] = uVar12 * 0x1000000 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      *(ushort *)((int)piVar5 + 0x1a) = uVar4 << 8 | uVar4 >> 8;
      piVar5[0xc] = uVar20 * 0x1000000 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
      piVar5[9] = *(int *)(iVar6 + 0x58);
      uVar20 = *(uint *)(iVar6 + 0x5c);
      uVar12 = *(uint *)(iVar6 + 0x60);
      piVar5[0xd] = uVar20 << 0x18 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
      uVar20 = *(uint *)(iVar6 + 0x188);
      piVar5[0xe] = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      uVar12 = *(uint *)(iVar6 + 0x18c);
      piVar5[0xf] = uVar20 << 0x18 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
      uVar20 = *(uint *)(iVar6 + 0x170);
      piVar5[0x10] = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      uVar12 = *(uint *)(iVar6 + 0x174);
      piVar5[0x11] = uVar20 << 0x18 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
      uVar20 = *(uint *)(iVar6 + 0x178);
      piVar5[0x12] = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      uVar12 = *(uint *)(iVar6 + 0x17c);
      piVar5[0x13] = uVar20 << 0x18 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
      piVar5[0x14] = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      iVar8 = *(int *)(iVar6 + 0x80) + -1;
      piVar7 = piVar5;
      iVar11 = iVar6;
      piVar13 = piVar5;
      piVar17 = piVar5;
      do {
        iVar16 = iVar8;
        if (-1 >= iVar8) {
          iVar16 = 7;
        }
        iVar16 = iVar6 + iVar16 * 8;
        if (-1 < iVar8) {
          iVar8 = iVar8 + -1;
        }
        else {
          iVar8 = 6;
        }
        uVar12 = (uint)(longlong)(*(double *)(iVar16 + 0x88) * 65536.0);
        piVar7[0x15] = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
        dVar21 = *(double *)(iVar16 + 200);
        if (0.0 <= dVar21) {
          uVar12 = (uint)(longlong)dVar21;
          dVar21 = (dVar21 - (double)((longlong)dVar21 & 0xffffffff)) * 4294967296.0;
          uVar20 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
          uVar20 = uVar20 * 0x1000000 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
        }
        else {
          uVar2 = (ulonglong)-dVar21;
          uVar12 = (uint)uVar2;
          dVar21 = (-dVar21 - (double)(uVar2 & 0xffffffff)) * 4294967296.0;
          iVar16 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
          if (iVar16 == 0) {
            uVar12 = -uVar12;
            uVar20 = 0;
          }
          else {
            uVar20 = -iVar16;
            uVar20 = iVar16 * -0x1000000 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
            uVar12 = ~uVar12;
          }
        }
        piVar7 = piVar7 + 1;
        piVar13[0x1e] = uVar20;
        piVar13[0x1d] = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
        piVar13 = piVar13 + 2;
        pbVar1 = (byte *)(iVar11 + 0x168);
        iVar11 = iVar11 + 1;
        uVar20 = *(int *)(iVar6 + 0x80) - (uint)*pbVar1;
        uVar12 = (uVar20 & 0xff) + 7;
        if ((uVar12 & 0xff) < 8) {
          *(char *)(piVar17 + 0x2d) = (char)uVar12;
        }
        else {
          *(char *)(piVar17 + 0x2d) = (char)uVar20 + -1;
        }
        piVar17 = (int *)((int)piVar17 + 1);
      } while (iVar11 != iVar6 + 8);
      dVar21 = *(double *)(iVar6 + 0x198);
      if (dVar21 < 0.0) {
        uVar2 = (ulonglong)-dVar21;
        uVar12 = (uint)uVar2;
        dVar21 = (-dVar21 - (double)(uVar2 & 0xffffffff)) * 4294967296.0;
        iVar11 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
        if (iVar11 == 0) {
          uVar12 = -uVar12;
          uVar20 = 0;
        }
        else {
          uVar20 = -iVar11;
          uVar20 = iVar11 * -0x1000000 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
          uVar12 = ~uVar12;
        }
      }
      else {
        uVar12 = (uint)(longlong)dVar21;
        dVar21 = (dVar21 - (double)((longlong)dVar21 & 0xffffffff)) * 4294967296.0;
        uVar20 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
        uVar20 = uVar20 * 0x1000000 | (uVar20 >> 8 & 0xff) << 0x10 | (uVar20 >> 0x10 & 0xff) << 8 | uVar20 >> 0x18;
      }
      piVar5[0x32] = uVar20;
      piVar5[0x31] = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      dVar21 = *(double *)(iVar6 + 0x1b0);
      uVar12 = (uint)(longlong)(*(double *)(iVar6 + 0x1a0) * 65536.0);
      piVar5[0x2f] = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      dVar19 = *(double *)(iVar6 + 0x1a8);
      dVar21 = SQRT(dVar21) * 65536.0;
      uVar12 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
      piVar5[0x30] = uVar12 * 0x1000000 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      dVar21 = SQRT(dVar19) * 65536.0;
      uVar12 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
      piVar5[0x33] = uVar12 * 0x1000000 | (uVar12 >> 8 & 0xff) << 0x10 | (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
      piVar5 = (int *)FUN_0002824c();
    }
    iVar15 = iVar15 + 0x20;
  }
  FUN_00028778();
  return;
}




/* WARNING: Removing unreachable block (ram,0x0002a354) */

void FUN_00029fec(undefined4 param_1,undefined4 param_2,int param_3)

{
  double *pdVar1;
  ulonglong uVar2;
  undefined1 uVar3;
  int *piVar4;
  int iVar5;
  byte bVar6;
  int *piVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int *piVar13;
  undefined4 uVar14;
  uint uVar15;
  double dVar16;
  int *local_3c;
  
  if (2 < DAT_0007cf4c) {
    puts("wants peer list summary");
  }
  if (DAT_0007ff54 == 0) {
    uVar14 = 0x20;
  }
  else {
    uVar14 = 0x48;
  }
  piVar4 = (int *)FUN_00028654(param_1,param_2,param_3 + 2,param_3 + 3,uVar14);
  if (piVar4 != (int *)0x0) {
    local_3c = (int *)&DAT_000cb238;
    iVar11 = 0;
    do {
      local_3c = local_3c + 1;
      piVar13 = (int *)*local_3c;
      piVar7 = piVar4;
      if (piVar4 != (int *)0x0) {
        piVar7 = (int *)0x1;
      }
      if (piVar13 != (int *)0x0 && piVar4 != (int *)0x0) {
        do {
          if (DAT_0007cf4c < 4) {
            if ((short)piVar13[3] == 10) goto LAB_0002a274;
LAB_0002a200:
            iVar12 = DAT_0007ff54;
            piVar4[1] = piVar13[4];
            iVar9 = piVar13[10];
            if (iVar12 != 0) {
              piVar4[8] = 0;
            }
            if (iVar9 == 0) {
              *piVar4 = 0;
            }
            else if (piVar13[0x8a] == 0) {
              *piVar4 = *(int *)(iVar9 + 0x18);
            }
            else if (((char)piVar13[0xe] == '\x04') ||
                    (((char)piVar13[0xe] != '\0' && (iVar12 = *(int *)(iVar9 + 0x18), *piVar4 = iVar12, iVar12 == 0))))
            {
              *piVar4 = *(int *)(iVar9 + 0x50);
            }
          }
          else {
            puts("sum: got one");
            if ((short)piVar13[3] != 10) goto LAB_0002a200;
LAB_0002a274:
            if (DAT_0007ff54 == 0) {
              piVar7 = piVar4;
              if (piVar4 != (int *)0x0) {
                piVar7 = (int *)0x1;
              }
              break;
            }
            iVar12 = piVar13[5];
            iVar9 = piVar13[6];
            iVar5 = piVar13[7];
            iVar10 = piVar13[8];
            piVar4[8] = 1;
            piVar4[0xe] = iVar12;
            piVar4[0xf] = iVar9;
            piVar4[0x10] = iVar5;
            piVar4[0x11] = iVar10;
            iVar12 = piVar13[10];
            if (iVar12 == 0) {
              memset(piVar4 + 10,0,0x10);
            }
            else {
              iVar9 = *(int *)(iVar12 + 0x20);
              iVar5 = *(int *)(iVar12 + 0x24);
              iVar10 = *(int *)(iVar12 + 0x28);
              piVar4[10] = *(int *)(iVar12 + 0x1c);
              piVar4[0xb] = iVar9;
              piVar4[0xc] = iVar5;
              piVar4[0xd] = iVar10;
            }
          }
          piVar7 = DAT_000cb470;
          *(undefined2 *)(piVar4 + 2) = *(undefined2 *)((int)piVar13 + 0xe);
          *(undefined1 *)((int)piVar4 + 10) = *(undefined1 *)((int)piVar13 + 0x45);
          *(char *)((int)piVar4 + 0xb) = (char)piVar13[0xc];
          *(undefined1 *)(piVar4 + 3) = *(undefined1 *)((int)piVar13 + 0x46);
          uVar3 = *(undefined1 *)((int)piVar13 + 0x6a);
          *(undefined1 *)((int)piVar4 + 0xe) = 0;
          *(undefined1 *)((int)piVar4 + 0xd) = uVar3;
          if (piVar13 == piVar7) {
            *(undefined1 *)((int)piVar4 + 0xe) = 2;
          }
          uVar8 = piVar13[0xd];
          if ((uVar8 & 1) != 0) {
            *(byte *)((int)piVar4 + 0xe) = *(byte *)((int)piVar4 + 0xe) | 1;
            uVar8 = piVar13[0xd];
          }
          if ((uVar8 & 8) != 0) {
            *(byte *)((int)piVar4 + 0xe) = *(byte *)((int)piVar4 + 0xe) | 8;
            uVar8 = piVar13[0xd];
          }
          if ((uVar8 & 0x20) != 0) {
            *(byte *)((int)piVar4 + 0xe) = *(byte *)((int)piVar4 + 0xe) | 0x10;
            uVar8 = piVar13[0xd];
          }
          if ((uVar8 & 0x40) != 0) {
            *(byte *)((int)piVar4 + 0xe) = *(byte *)((int)piVar4 + 0xe) | 4;
          }
          bVar6 = *(byte *)(piVar13 + 0x1a);
          if (bVar6 == 4) {
            *(byte *)((int)piVar4 + 0xe) = *(byte *)((int)piVar4 + 0xe) | 0x40;
            bVar6 = *(byte *)(piVar13 + 0x1a);
          }
          if (5 < bVar6) {
            *(byte *)((int)piVar4 + 0xe) = ~((byte)~(byte)(((uint)*(byte *)((int)piVar4 + 0xe) << 0x19) >> 0x18) >> 1);
          }
          *(undefined1 *)((int)piVar4 + 0xf) = *(undefined1 *)((int)piVar13 + 0x2f);
          dVar16 = *(double *)(piVar13 + 0x66);
          uVar8 = (uint)(longlong)(*(double *)(piVar13 + 0x68) * 65536.0);
          piVar4[4] = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
          if (dVar16 < 0.0) {
            uVar2 = (ulonglong)-dVar16;
            uVar8 = (uint)uVar2;
            dVar16 = (-dVar16 - (double)(uVar2 & 0xffffffff)) * 4294967296.0;
            iVar12 = (uint)(0.0 < dVar16) * (int)(longlong)dVar16;
            if (iVar12 == 0) {
              uVar8 = -uVar8;
              uVar15 = 0;
            }
            else {
              uVar15 = -iVar12;
              uVar15 = iVar12 * -0x1000000 | (uVar15 >> 8 & 0xff) << 0x10 | (uVar15 >> 0x10 & 0xff) << 8 |
                       uVar15 >> 0x18;
              uVar8 = ~uVar8;
            }
          }
          else {
            uVar8 = (uint)(longlong)dVar16;
            dVar16 = (dVar16 - (double)((longlong)dVar16 & 0xffffffff)) * 4294967296.0;
            uVar15 = (uint)(0.0 < dVar16) * (int)(longlong)dVar16;
            uVar15 = uVar15 * 0x1000000 | (uVar15 >> 8 & 0xff) << 0x10 | (uVar15 >> 0x10 & 0xff) << 8 | uVar15 >> 0x18;
          }
          piVar4[6] = uVar15;
          piVar4[5] = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
          pdVar1 = (double *)(piVar13 + 0x6c);
          piVar13 = (int *)*piVar13;
          uVar8 = (uint)(0.0 < SQRT(*pdVar1) * 65536.0) * (int)(longlong)(SQRT(*pdVar1) * 65536.0);
          piVar4[7] = uVar8 * 0x1000000 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
          piVar4 = (int *)FUN_0002824c();
          piVar7 = piVar4;
          if (piVar4 != (int *)0x0) {
            piVar7 = (int *)0x1;
          }
        } while (piVar13 != (int *)0x0 && piVar4 != (int *)0x0);
      }
      iVar12 = iVar11 + 1;
      if (0x7f < iVar12) {
        piVar7 = (int *)0x0;
      }
      if (iVar12 == 0x7f || iVar11 + -0x7e < 0 != SBORROW4(iVar12,0x7f)) {
        piVar7 = (int *)((uint)piVar7 & 1);
      }
      iVar11 = iVar12;
    } while (piVar7 != (int *)0x0);
  }
  FUN_00028778();
  return;
}




void FUN_0002a388(short *param_1,undefined4 param_2,byte *param_3,int param_4)

{
  int iVar1;
  undefined4 uVar2;
  short local_3c;
  short local_3a;
  int local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 local_24;
  
  local_3c = *param_1;
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  local_28 = 0;
  local_24 = 0;
  local_3a = 0x7b00;
  if ((ushort)((*(ushort *)(param_3 + 4) & 0xf) << 8 | *(ushort *)(param_3 + 4) >> 8) < 2) {
    iVar1 = DAT_000ca608;
    if (*(int *)(param_3 + 8) != 0) {
      iVar1 = *(int *)(param_3 + 8);
      if (local_3c != 2) {
        local_34 = *(undefined4 *)(param_3 + 0x18);
        local_30 = *(undefined4 *)(param_3 + 0x1c);
        local_2c = *(undefined4 *)(param_3 + 0x20);
        local_28 = *(undefined4 *)(param_3 + 0x24);
        iVar1 = local_38;
      }
      local_38 = iVar1;
      iVar1 = FUN_00015bd4(&local_3c);
      if (iVar1 == 0) {
        FUN_000286dc(param_1,param_2,param_3[2],param_3[3],4);
        return;
      }
    }
    if (local_3c == 2) {
      local_38 = *(int *)(param_3 + 0xc);
    }
    else {
      local_34 = *(undefined4 *)(param_3 + 0x28);
      local_30 = *(undefined4 *)(param_3 + 0x2c);
      local_2c = *(undefined4 *)(param_3 + 0x30);
      local_28 = *(undefined4 *)(param_3 + 0x34);
    }
    local_3a = *(short *)(param_3 + 0x10);
    if (local_3a == 0) {
      local_3a = 0xf48;
    }
    if (param_4 == 0) {
      iVar1 = FUN_0001ca7c(&local_3c,iVar1,0);
    }
    else {
      iVar1 = FUN_0001c824(&local_3c,iVar1,0,((uint)*param_3 << 0x1a) >> 0x1d);
    }
    if (iVar1 == 0) {
      uVar2 = 4;
    }
    else {
      uVar2 = 0;
    }
    FUN_000286dc(param_1,param_2,param_3[2],param_3[3],uVar2);
  }
  else {
    FUN_0004fe78(3,"do_setclr_trap: err_nitems > 1");
    FUN_000286dc(param_1,param_2,param_3[2],param_3[3],3);
  }
  return;
}




void FUN_0002a5a4(undefined4 param_1,undefined4 param_2,int param_3)

{
  FUN_0002e23c();
  FUN_000286dc(param_1,param_2,*(undefined1 *)(param_3 + 2),*(undefined1 *)(param_3 + 3),0);
  return;
}




void FUN_0002b7dc(undefined4 param_1,undefined4 param_2,int param_3,undefined4 param_4)

{
  undefined2 *puVar1;
  undefined2 *puVar2;
  ushort uVar3;
  ushort uVar4;
  ushort uVar5;
  uint uVar6;
  int iVar7;
  ushort uVar8;
  int *piVar9;
  int iVar10;
  undefined4 local_60;
  undefined4 local_5c;
  undefined4 local_58;
  undefined4 local_54;
  undefined4 local_50;
  undefined4 local_4c;
  undefined4 local_48;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  
  piVar9 = (int *)(param_3 + 8);
  uVar6 = (*(ushort *)(param_3 + 4) & 0xf) << 8 | (uint)(*(ushort *)(param_3 + 4) >> 8);
  uVar5 = *(ushort *)(param_3 + 0x10) << 8;
  uVar8 = *(ushort *)(param_3 + 0x12) << 8;
  uVar4 = *(ushort *)(param_3 + 0x12) >> 8;
  iVar10 = uVar6 - 1;
  uVar3 = uVar8 | uVar4;
  *(ushort *)(param_3 + 0x10) = uVar5 | *(ushort *)(param_3 + 0x10) >> 8;
  *(ushort *)(param_3 + 0x12) = uVar8 | uVar4;
  if (uVar6 == 0) {
    local_60 = 0;
    local_5c = 0;
    local_58 = 0;
    local_54 = 0;
    local_50 = 0;
    local_4c = 0;
    local_48 = 0;
    local_44 = 0;
    local_40 = 0;
    local_3c = 0;
    local_38 = 0;
    local_34 = 0;
    local_30 = 0;
    local_2c = 0;
LAB_0002ba38:
    FUN_000286dc(param_1,param_2,*(undefined1 *)(param_3 + 2),*(undefined1 *)(param_3 + 3),0);
    return;
  }
  iVar7 = iVar10;
  while( true ) {
    uVar8 = uVar3 & 0xdfff;
    if ((uVar3 & 0xdfff) != 0) {
      uVar8 = 1;
    }
    if ((uVar5 & 0xe000) != 0) {
      uVar8 = uVar8 | 2;
    }
    if (piVar9[1] != 0) break;
LAB_0002b8a4:
    iVar7 = iVar7 + -1;
    piVar9 = (int *)((int)piVar9 + ((*(ushort *)(param_3 + 6) & 0xf) << 8 | (uint)(*(ushort *)(param_3 + 6) >> 8)));
    if (iVar7 == -1) goto LAB_0002b92c;
    if (uVar8 != 0) goto LAB_0002b8e0;
    uVar3 = *(ushort *)((int)piVar9 + 10);
    uVar5 = *(ushort *)(piVar9 + 2);
  }
  if ((DAT_0007ff54 == 0) || (piVar9[3] == 0)) {
    if (*piVar9 == 0) {
      uVar8 = uVar8 | 8;
      goto LAB_0002b8d8;
    }
    goto LAB_0002b8a4;
  }
  if ((((piVar9[4] != 0) || (piVar9[5] != 0)) || (piVar9[6] != 0)) || (piVar9[7] != 0)) goto LAB_0002b8a4;
  uVar8 = uVar8 | 4;
LAB_0002b8d8:
  if (iVar7 == 0) {
LAB_0002b92c:
    if (uVar8 == 0) {
      iVar7 = param_3 + 0x38;
      local_60 = 0;
      local_5c = 0;
      local_58 = 0;
      local_54 = 0;
      local_50 = 0;
      local_4c = 0;
      local_48 = 0;
      local_44 = 0;
      local_40 = 0;
      local_3c = 0;
      local_38 = 0;
      local_34 = 0;
      local_30 = 0;
      local_2c = 0;
      do {
        if ((DAT_0007ff54 == 0) || (*(int *)(iVar7 + -0x24) == 0)) {
          local_5c = *(undefined4 *)(iVar7 + -0x30);
          local_40 = *(undefined4 *)(iVar7 + -0x2c);
          local_60 = CONCAT22(local_60._2_2_,2);
          local_44 = CONCAT22(local_44._2_2_,2);
        }
        else {
          local_58 = *(undefined4 *)(iVar7 + -0x20);
          local_54 = *(undefined4 *)(iVar7 + -0x1c);
          local_50 = *(undefined4 *)(iVar7 + -0x18);
          local_4c = *(undefined4 *)(iVar7 + -0x14);
          local_60 = CONCAT22(local_60._2_2_,10);
          local_44 = CONCAT22(local_44._2_2_,10);
          local_30 = *(undefined4 *)(iVar7 + -4);
          local_34 = *(undefined4 *)(iVar7 + -8);
          local_38 = *(undefined4 *)(iVar7 + -0xc);
          local_3c = *(undefined4 *)(iVar7 + -0x10);
        }
        puVar1 = (undefined2 *)(iVar7 + -0x28);
        iVar10 = iVar10 + -1;
        puVar2 = (undefined2 *)(iVar7 + -0x26);
        iVar7 = iVar7 + 0x30;
        FUN_0002cc48(param_4,&local_60,&local_44,*puVar2,*puVar1);
      } while (iVar10 != -1);
      goto LAB_0002ba38;
    }
  }
LAB_0002b8e0:
  FUN_0004fe78(3,"do_restrict: bad = %#x");
  FUN_000286dc(param_1,param_2,*(undefined1 *)(param_3 + 2),*(undefined1 *)(param_3 + 3),3);
  return;
}




/* WARNING: Restarted to delay deadcode elimination for space: ram */

void FUN_0002bcb0(undefined4 param_1,undefined4 param_2,int param_3)

{
  int iVar1;
  void *__src;
  uint uVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  undefined4 local_ec;
  uint local_e8;
  undefined4 local_e4;
  undefined4 local_e0;
  undefined4 local_dc;
  undefined4 local_d8;
  undefined4 local_d4;
  uint local_d0;
  undefined1 local_cc;
  undefined1 local_cb;
  undefined1 local_ca;
  undefined1 local_c9;
  byte local_c8;
  undefined1 local_c7;
  undefined4 local_c4;
  int local_40;
  undefined4 uStack_38;
  undefined4 uStack_34;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  
  memset(&local_d0,0,0xa8);
  __src = (void *)(param_3 + 8);
  uVar4 = (uint)(*(ushort *)(param_3 + 6) >> 8);
  uVar5 = (uint)*(ushort *)(param_3 + 6) << 8;
  memcpy(&local_d0,__src,uVar4 | uVar5 & 0xfff);
  uVar2 = (*(ushort *)(param_3 + 4) & 0xf) << 8 | (uint)(*(ushort *)(param_3 + 4) >> 8);
  iVar3 = uVar2 - 1;
  if (uVar2 != 0) {
    do {
      memset(&local_d0,0,0xa8);
      memcpy(&local_d0,__src,uVar4 | uVar5 & 0xfff);
      local_e8 = 0;
      local_e4 = 0;
      if ((local_c8 & 2) == 0) {
        uVar5 = 0;
      }
      else {
        uVar5 = 0x20;
      }
      local_e0 = 0;
      local_dc = 0;
      local_d8 = 0;
      if ((local_c8 & 4) != 0) {
        uVar5 = uVar5 | 0x40;
      }
      local_d4 = 0;
      if ((local_c8 & 8) != 0) {
        uVar5 = uVar5 | 0x100;
      }
      if ((DAT_0007ff54 == 0) || (local_40 == 0)) {
        local_e8 = local_d0;
        local_ec = 2;
        uVar4 = local_d0 << 0x18 | (local_d0 >> 8 & 0xff) << 0x10;
        if ((uVar4 != 0x7f7f0000) &&
           ((local_d0 << 0x18 == 0x7f000000 &&
            ((uVar4 | (local_d0 >> 0x10 & 0xff) << 8 | local_d0 >> 0x18) != 0x7f000001)))) {
          FUN_000286dc(param_1,param_2,*(undefined1 *)(param_3 + 2),*(undefined1 *)(param_3 + 3),3);
          return;
        }
      }
      else {
        local_ec = 10;
        local_e4 = uStack_38;
        local_e0 = uStack_34;
        local_dc = uStack_30;
        local_d8 = uStack_2c;
      }
      local_ec = CONCAT22(0x7b00,(undefined2)local_ec);
      iVar1 = FUN_00022304(&local_ec,0,local_cc,local_cb,local_ca,local_c9,uVar5,local_c7,local_c4,0);
      if (iVar1 == 0) {
        FUN_000286dc(param_1,param_2,*(undefined1 *)(param_3 + 2),*(undefined1 *)(param_3 + 3),4);
        return;
      }
      if (DAT_0007ff58 < DAT_000cb548) {
        DAT_0007ff58 = DAT_000cb548 + 0x1e;
        FUN_0002d720(DAT_000cb548);
        if (0 < DAT_0007cf4c) {
          puts("do_conf triggering interface rescan");
        }
      }
      iVar3 = iVar3 + -1;
      uVar4 = (uint)(*(ushort *)(param_3 + 6) >> 8);
      uVar5 = (uint)*(ushort *)(param_3 + 6) << 8;
      __src = (void *)((int)__src + (uVar4 | uVar5 & 0xfff));
    } while (iVar3 != -1);
  }
  FUN_000286dc(param_1,param_2,*(undefined1 *)(param_3 + 2),*(undefined1 *)(param_3 + 3),0);
  return;
}




void FUN_0002c294(void)

{
  DAT_000cb534 = 0;
  DAT_000cb530 = 0;
  DAT_0007fb40 = 0;
  DAT_000cb50c = 0;
  DAT_000cb510 = 0;
  DAT_000cb514 = 0;
  DAT_000cb518 = 0;
  DAT_000cb51c = 0;
  DAT_000cb520 = 0;
  DAT_000cb524 = 0;
  DAT_000cb528 = 0;
  DAT_000cb52c = 0;
  return;
}




void FUN_0002c308(int param_1,int param_2)

{
  byte bVar1;
  ushort uVar2;
  uint uVar3;
  uint uVar4;
  undefined4 uVar5;
  int iVar6;
  int iVar7;
  char cVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  uint uVar12;
  int iVar13;
  undefined4 uVar14;
  uint uVar15;
  ushort *puVar16;
  int iVar17;
  int iVar18;
  bool bVar19;
  double dVar20;
  undefined8 uVar21;
  
  uVar15 = *(uint *)(param_1 + 0x58);
  iVar13 = param_1 + 8;
  uVar14 = *(undefined4 *)(param_1 + 0x40);
  if (DAT_0007cf4c < 3) {
    bVar1 = *(byte *)(param_1 + 0x5c);
    uVar5 = DAT_0007fd48;
  }
  else {
    printf("process_private: impl %d req %d\n",(uint)*(byte *)(param_1 + 0x5e),(uint)*(byte *)(param_1 + 0x5f));
    bVar1 = *(byte *)(param_1 + 0x5c);
    uVar5 = DAT_0007fd48;
  }
  if ((bVar1 & 0x80) == 0) {
    if ((bVar1 & 0x40) == 0) {
      DAT_0007fd48 = ((uint)bVar1 << 0x1a) >> 0x1d;
      if (DAT_0007fd48 < 5) {
        if (DAT_0007fd48 == 0) {
          uVar14 = 4;
        }
        else if ((*(byte *)(param_1 + 0x5d) & 0x7f) == 0) {
          if ((*(ushort *)(param_1 + 0x60) & 0xf0) == 0) {
            uVar9 = (*(ushort *)(param_1 + 0x62) & 0xff) << 8;
            uVar4 = uVar9 | *(ushort *)(param_1 + 0x62) >> 8;
            if (uVar9 >> 0xc == 0) {
              if (7 < *(uint *)(param_1 + 0x58)) {
                uVar9 = (uint)*(byte *)(param_1 + 0x5e);
                if (uVar9 == 0) {
                  puVar16 = &DAT_0007a308;
                }
                else {
                  if (1 < uVar9 - 2) {
                    FUN_000286dc(iVar13,uVar14,uVar9,*(undefined1 *)(param_1 + 0x5f),1);
                    return;
                  }
                  puVar16 = &DAT_0007a314;
                }
                uVar2 = *puVar16;
                if (uVar2 != 0xffff) {
                  do {
                    if (uVar2 == *(byte *)(param_1 + 0x5f)) {
                      if (3 < DAT_0007cf4c) {
                        puts("found request in tables");
                        uVar4 = (*(ushort *)(param_1 + 0x62) & 0xff) << 8 | (uint)(*(ushort *)(param_1 + 0x62) >> 8);
                      }
                      uVar2 = puVar16[2];
                      uVar4 = uVar4 & 0xfff;
                      if ((((int)(short)uVar2 != uVar4) && ((int)(short)puVar16[3] != uVar4)) &&
                         ((*(short *)(param_1 + 0x5e) != 0xa03 || (uVar4 != 0x10)))) {
                        if (2 < DAT_0007cf4c) {
                          printf("process_private: wrong item size, received %d, should be %d or %d\n",uVar4,
                                 (int)(short)uVar2,(int)(short)puVar16[3]);
                        }
LAB_0002c534:
                        FUN_000286dc(iVar13,uVar14,*(undefined1 *)(param_1 + 0x5e),*(undefined1 *)(param_1 + 0x5f),3);
                        return;
                      }
                      if ((uVar2 != 0) &&
                         (uVar9 = ((*(ushort *)(param_1 + 0x60) & 0xf) << 8 | (uint)(*(ushort *)(param_1 + 0x60) >> 8))
                                  * uVar4, uVar15 - 8 <= uVar9 && uVar9 - (uVar15 - 8) != 0)) {
                        if (2 < DAT_0007cf4c) {
                          puts("process_private: not enough data");
                        }
                        goto LAB_0002c534;
                      }
                      cVar8 = *(char *)(param_1 + 0x5e);
                      if (cVar8 == '\x02') {
                        DAT_0007ff54 = 0;
                      }
                      else {
                        if (cVar8 != '\x03') goto LAB_0002c5b8;
                        DAT_0007ff54 = 1;
                      }
                      iVar17 = param_1 + 0x5c;
                      if ((puVar16[1] == 0) || (DAT_000cb46c == 0)) {
LAB_0002c6fc:
                        if (2 < DAT_0007cf4c) {
                          puts("process_private: all okay, into handler");
                        }
                        (**(code **)(puVar16 + 4))(iVar13,uVar14,iVar17);
                        return;
                      }
                      iVar6 = ((*(ushort *)(param_1 + 0x60) & 0xf) << 8 | (uint)(*(ushort *)(param_1 + 0x60) >> 8)) *
                              uVar4;
                      if (uVar15 < iVar6 + 0x24U) {
LAB_0002c5b8:
                        FUN_000286dc(iVar13,uVar14,cVar8,*(undefined1 *)(param_1 + 0x5f),3);
                        return;
                      }
                      uVar9 = iVar6 + 0x13U & 0xfffffffc;
                      if (uVar9 + 0x18 < uVar15) {
                        iVar6 = 0x14;
                      }
                      else {
                        iVar6 = uVar15 - uVar9;
                      }
                      iVar10 = (uVar15 - iVar6) + -8;
                      iVar18 = iVar17 + iVar10;
                      if (*(char *)(param_1 + 0x5d) < 0) {
                        uVar9 = *(uint *)(iVar18 + 8);
                        if ((DAT_000cb50c != 0) &&
                           (DAT_000cb50c ==
                            (uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18))
                           ) {
                          if (0xd8 < uVar15) {
                            if (4 < DAT_0007cf4c) {
                              printf("bad pkt length %lu\n",uVar15);
                            }
                            FUN_0004fe78(3,"process_private: bad pkt length %lu",uVar15);
                            cVar8 = *(char *)(param_1 + 0x5e);
                            goto LAB_0002c5b8;
                          }
                          if (param_2 != 0) {
                            uVar21 = FUN_0004dd08();
                            iVar7 = (int)((ulonglong)uVar21 >> 0x20);
                            if ((int)uVar21 != 0) {
                              bVar19 = *(int *)(param_1 + 0x50) == 0;
                              uVar9 = *(uint *)(iVar17 + iVar10);
                              if (bVar19) {
                                iVar7 = *(int *)(param_1 + 0x4c);
                              }
                              uVar4 = *(uint *)(iVar18 + 4);
                              uVar9 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 |
                                      uVar9 >> 0x18;
                              if (bVar19) {
                                uVar9 = uVar9 - iVar7;
                              }
                              uVar12 = uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10;
                              uVar3 = (uVar4 >> 0x10 & 0xff) << 8;
                              uVar11 = uVar12 | uVar3 | uVar4 >> 0x18;
                              if (!bVar19) {
                                uVar11 = -*(int *)(param_1 + 0x50);
                                uVar4 = (uVar11 & 0xffff) + (uVar3 | uVar4 >> 0x18);
                                uVar12 = (uVar11 >> 0x10) + (uVar12 >> 0x10);
                                if ((uVar4 & 0x10000) != 0) {
                                  uVar12 = uVar12 + 1;
                                }
                                uVar11 = uVar4 & 0xffff | uVar12 << 0x10;
                                uVar9 = uVar9 + ~*(uint *)(param_1 + 0x4c);
                                if ((uVar12 & 0x10000) != 0) {
                                  uVar9 = uVar9 + 1;
                                }
                              }
                              if ((int)uVar9 < 0) {
                                if (uVar11 == 0) {
                                  uVar9 = -uVar9;
                                }
                                else {
                                  uVar11 = -uVar11;
                                  uVar9 = ~uVar9;
                                }
                                dVar20 = -((double)(longlong)(int)uVar9 + (double)uVar11 * 2.3283064365386963e-10);
                              }
                              else {
                                dVar20 = (double)(longlong)(int)uVar9 + (double)uVar11 * 2.3283064365386963e-10;
                              }
                              if (ABS(dVar20) <= 10.0) {
                                iVar6 = FUN_0004e4e4(DAT_000cb50c,iVar17,uVar15 - iVar6,iVar6);
                                if (iVar6 != 0) goto LAB_0002c6fc;
                                if (4 < DAT_0007cf4c) {
                                  puts("authdecrypt failed");
                                }
                              }
                              else if (4 < DAT_0007cf4c) {
                                printf("xmit/rcv timestamp delta %g > INFO_TS_MAXSKEW %g\n",uVar11,SUB84(dVar20,0),
                                       (int)((ulonglong)dVar20 >> 0x20),0x4024000000000000);
                              }
                              FUN_000286dc(iVar13,uVar14,*(undefined1 *)(param_1 + 0x5e),*(undefined1 *)(param_1 + 0x5f)
                                           ,7);
                              return;
                            }
                          }
                          if (4 < DAT_0007cf4c) {
                            printf("failed auth mod_okay %d\n",param_2);
                          }
                          FUN_0004fe78(7,"process_private: failed auth mod_okay %d\n",param_2);
                          goto LAB_0002c6dc;
                        }
                      }
                      else {
                        uVar9 = *(uint *)(iVar18 + 8);
                      }
                      if (4 < DAT_0007cf4c) {
                        printf("failed auth %d info_auth_keyid %u pkt keyid %u maclen %lu\n",
                               (uint)(int)*(char *)(param_1 + 0x5d) >> 0x1f,DAT_000cb50c,
                               uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18
                               ,iVar6);
                        uVar9 = *(uint *)(iVar18 + 8);
                      }
                      FUN_0004fe78(7,"process_private: failed auth %d info_auth_keyid %u pkt keyid %u maclen %lu\n",
                                   (uint)(int)*(char *)(param_1 + 0x5d) >> 0x1f,DAT_000cb50c,
                                   uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 |
                                   uVar9 >> 0x18,iVar6);
LAB_0002c6dc:
                      FUN_000286dc(iVar13,uVar14,*(undefined1 *)(param_1 + 0x5e),*(undefined1 *)(param_1 + 0x5f),7);
                      return;
                    }
                    puVar16 = puVar16 + 6;
                    uVar2 = *puVar16;
                  } while (uVar2 != 0xffff);
                }
                FUN_000286dc(iVar13,uVar14,uVar9,*(undefined1 *)(param_1 + 0x5f),2);
                return;
              }
              uVar14 = 8;
            }
            else {
              uVar14 = 7;
            }
          }
          else {
            uVar14 = 6;
          }
        }
        else {
          uVar14 = 5;
        }
      }
      else {
        uVar14 = 3;
      }
    }
    else {
      uVar14 = 2;
    }
  }
  else {
    uVar14 = 1;
  }
  DAT_0007fd48 = uVar5;
  if (((DAT_0007be6c & 2) != 0) && (DAT_0007ff5c <= DAT_000cb548)) {
    uVar5 = FUN_00050cd0(iVar13);
    FUN_0004fe78(3,"process_private: drop test %d failed, pkt from %s",uVar14,uVar5);
    DAT_0007ff5c = DAT_000cb548 + 0x3c;
  }
  return;
}




void FUN_0002c978(void)

{
  if (DAT_0007ff60 == 0) {
    FUN_00020d7c(2);
  }
  DAT_0007ff60 = DAT_0007ff60 + 1;
  return;
}




void FUN_0002c9a8(void)

{
  int *piVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int *piVar4;
  
  DAT_0007ff60 = DAT_0007ff60 + -1;
  if (DAT_0007ff60 == 0) {
    DAT_0007ff60 = 0;
    if (((DAT_000cac24 != 0) && ((DAT_000cac24 & 2) != 0)) &&
       (DAT_000cac24 = DAT_000cac24 & 0xfffffffd, DAT_000cac24 == 0)) {
      puVar2 = &DAT_0007d728;
      do {
        piVar4 = (int *)*puVar2;
        puVar3 = puVar2 + 1;
        *puVar2 = 0;
        while (piVar1 = piVar4, piVar1 != (int *)0x0) {
          piVar4 = (int *)*piVar1;
          *piVar1 = (int)DAT_0007d928;
          DAT_0007d928 = piVar1;
        }
        puVar2 = puVar3;
      } while ((int **)puVar3 != &DAT_0007d928);
      DAT_000cabe0 = &DAT_000cabdc;
      DAT_000cabe4 = &DAT_000cabdc;
    }
    return;
  }
  return;
}




void FUN_0002c9cc(void)

{
  DAT_0007ff64 = DAT_000cb538;
  DAT_0007ff90 = DAT_000cb53c;
  DAT_0007ffbc = 2;
  DAT_000cb538 = &DAT_0007ff64;
  DAT_000cb53c = &DAT_0007ff90;
  return;
}




undefined2 FUN_0002ca18(short *param_1)

{
  byte *pbVar1;
  short sVar2;
  ushort uVar3;
  undefined2 uVar4;
  int iVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  undefined4 *puVar8;
  uint uVar9;
  byte local_30 [20];
  
  sVar2 = *param_1;
  DAT_0007ffc0 = DAT_0007ffc0 + 1;
  if (sVar2 == 2) {
    uVar9 = *(uint *)(param_1 + 2);
    if ((uVar9 << 0x18 & 0xf0000000) == 0xe0000000) {
      return 1;
    }
    puVar8 = DAT_000cb538;
    if (DAT_000cb538 != (undefined4 *)0x0) {
      do {
        puVar7 = (undefined4 *)*puVar8;
        if ((puVar8[3] ==
             ((uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 | (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18) & puVar8[4]))
           && (((*(ushort *)((int)puVar8 + 10) & 0x2000) == 0 ||
               ((ushort)(param_1[1] << 8 | (ushort)param_1[1] >> 8) == 0x7b)))) {
          puVar8[1] = puVar8[1] + 1;
          if (puVar8 != &DAT_0007ff64) goto LAB_0002cadc;
          DAT_0007ffc4 = DAT_0007ffc4 + 1;
          goto LAB_0002cae8;
        }
        puVar8 = puVar7;
      } while (puVar7 != (undefined4 *)0x0);
    }
    puVar8 = (undefined4 *)0x0;
    iRam00000004 = iRam00000004 + 1;
LAB_0002cadc:
    DAT_0007ffc8 = DAT_0007ffc8 + 1;
LAB_0002cae8:
    uVar4 = *(undefined2 *)(puVar8 + 2);
    sVar2 = *param_1;
  }
  else {
    uVar4 = 0;
  }
  if (sVar2 != 10) {
    return uVar4;
  }
  if ((char)param_1[4] == -1) {
    return 1;
  }
  uVar3 = param_1[1];
  puVar8 = DAT_000cb53c;
  do {
    puVar7 = puVar8;
    if (puVar7 == (undefined4 *)0x0) {
      puVar7 = (undefined4 *)0x0;
      iRam00000004 = iRam00000004 + 1;
      goto LAB_0002cba4;
    }
    puVar8 = (undefined4 *)*puVar7;
    if (puVar7 == puVar8) {
      (*DAT_0007c9fc)("ntp_restrict.c",0x123,2,"next != res");
    }
    iVar5 = 0;
    puVar6 = puVar7;
    do {
      pbVar1 = (byte *)(puVar6 + 7);
      puVar6 = (undefined4 *)((int)puVar6 + 1);
      local_30[iVar5] = *pbVar1 & *(byte *)((int)param_1 + iVar5 + 8);
      iVar5 = iVar5 + 1;
    } while (iVar5 != 0x10);
    iVar5 = memcmp(local_30,puVar7 + 3,0x10);
  } while ((iVar5 != 0) ||
          (((*(ushort *)((int)puVar7 + 10) & 0x2000) != 0 && ((ushort)(uVar3 << 8 | uVar3 >> 8) != 0x7b))));
  puVar7[1] = puVar7[1] + 1;
  if (puVar7 == &DAT_0007ff90) {
    DAT_0007ffc4 = DAT_0007ffc4 + 1;
  }
  else {
LAB_0002cba4:
    DAT_0007ffc8 = DAT_0007ffc8 + 1;
  }
  return *(undefined2 *)(puVar7 + 2);
}




void FUN_0002cc48(int param_1,short *param_2,int param_3,uint param_4,ushort param_5)

{
  byte *pbVar1;
  undefined2 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  undefined4 *puVar6;
  undefined4 *puVar7;
  uint uVar8;
  ushort uVar9;
  undefined4 *puVar10;
  uint uVar11;
  undefined4 uVar12;
  undefined4 *puVar13;
  size_t __n;
  bool bVar14;
  byte *pbVar15;
  undefined4 *puVar17;
  undefined4 local_54 [2];
  undefined4 local_4c;
  uint local_48 [3];
  undefined4 local_3c;
  byte bStack_39;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  byte *pbVar16;
  
  if (0 < DAT_0007cf4c) {
    uVar3 = FUN_00050cd0(param_2);
    uVar4 = FUN_00050cd0(param_3);
    printf("restrict: op %d addr %s mask %s mflags %08x flags %08x\n",param_1,uVar3,uVar4,param_4,(uint)param_5);
  }
  uVar2 = (undefined2)param_4;
  if (param_2 == (short *)0x0) {
    if (param_3 != 0) {
      (*DAT_0007c9fc)("ntp_restrict.c",0x1ea,0,"((void *)0) == resmask");
    }
    if (param_1 != 1) {
      (*DAT_0007c9fc)("ntp_restrict.c",0x1eb,0,"1 == op");
    }
    DAT_0007ffd4 = param_5;
    DAT_0007ffd6 = uVar2;
    DAT_0007ffd8 = 1;
    return;
  }
  local_54[0] = 0;
  local_54[1] = 0;
  local_4c = 0;
  local_48[0] = 0;
  local_48[1] = 0;
  local_48[2] = 0;
  local_3c = 0;
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  if (*param_2 == 2) {
    uVar8 = *(uint *)(param_2 + 2);
    uVar11 = *(uint *)(param_3 + 4);
    local_48[1] = uVar11 << 0x18 | (uVar11 >> 8 & 0xff) << 0x10 | (uVar11 >> 0x10 & 0xff) << 8 | uVar11 >> 0x18;
    local_48[0] = local_48[1] &
                  (uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 | (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18);
  }
  else {
    if (*param_2 == 10) {
      local_2c = *(undefined4 *)(param_3 + 0x14);
      local_30 = *(undefined4 *)(param_3 + 0x10);
      local_34 = *(undefined4 *)(param_3 + 0xc);
      local_38 = *(undefined4 *)(param_3 + 8);
      pbVar16 = &bStack_39;
      do {
        pbVar15 = pbVar16 + 1;
        pbVar1 = (byte *)(param_2 + 4);
        param_2 = (short *)((int)param_2 + 1);
        pbVar16[-0xf] = *pbVar1 & *pbVar15;
        pbVar16 = pbVar15;
      } while (pbVar15 != (byte *)((int)&local_2c + 3));
      bVar14 = true;
      __n = 0x20;
      local_4c = CONCAT22(uVar2,param_5);
      puVar13 = DAT_000cb53c;
      goto LAB_0002cd2c;
    }
    (*DAT_0007c9fc)("ntp_restrict.c",0x20c,0,"0");
  }
  bVar14 = false;
  __n = 8;
  local_4c = CONCAT22(uVar2,param_5);
  puVar13 = DAT_000cb538;
LAB_0002cd2c:
  while ((puVar13 != (undefined4 *)0x0 &&
         ((*(ushort *)((int)puVar13 + 10) != param_4 || (iVar5 = memcmp(puVar13 + 3,local_48,__n), iVar5 != 0))))) {
    puVar13 = (undefined4 *)*puVar13;
  }
  puVar6 = DAT_0007ffd0;
  puVar10 = DAT_0007ffcc;
  switch(param_1) {
  case 1:
    if (puVar13 == (undefined4 *)0x0) {
      if (bVar14) {
        if (DAT_0007ffcc == (undefined4 *)0x0) {
          puVar6 = (undefined4 *)FUN_0004f524(0x3c8);
          memset(puVar6,0,0x3c8);
          puVar13 = DAT_0007ffcc;
          puVar10 = puVar6 + 0xe7;
          do {
            DAT_0007ffcc = puVar10;
            *DAT_0007ffcc = puVar13;
            puVar13 = DAT_0007ffcc;
            puVar10 = DAT_0007ffcc + -0xb;
          } while (DAT_0007ffcc + -0xb != puVar6);
        }
        else {
          puVar13 = (undefined4 *)*DAT_0007ffcc;
          *DAT_0007ffcc = 0;
          DAT_0007ffcc = puVar13;
          puVar6 = puVar10;
        }
        puVar13 = local_54;
        puVar10 = puVar6;
        do {
          puVar17 = puVar10;
          puVar7 = puVar13;
          uVar3 = puVar7[1];
          uVar4 = puVar7[2];
          uVar12 = puVar7[3];
          *puVar17 = *puVar7;
          puVar17[1] = uVar3;
          puVar17[2] = uVar4;
          puVar17[3] = uVar12;
          puVar13 = puVar7 + 4;
          puVar10 = puVar17 + 4;
        } while (puVar7 + 4 != &local_34);
        puVar13 = &DAT_000cb53c;
        uVar3 = puVar7[5];
        uVar4 = puVar7[6];
        puVar17[4] = puVar7[4];
        puVar17[5] = uVar3;
        puVar17[6] = uVar4;
      }
      else {
        if (DAT_0007ffd0 == (undefined4 *)0x0) {
          puVar6 = (undefined4 *)FUN_0004f524(1000);
          memset(puVar6,0,1000);
          puVar13 = DAT_0007ffd0;
          puVar10 = puVar6 + 0xf5;
          do {
            DAT_0007ffd0 = puVar10;
            *DAT_0007ffd0 = puVar13;
            puVar13 = DAT_0007ffd0;
            puVar10 = DAT_0007ffd0 + -5;
          } while (DAT_0007ffd0 + -5 != puVar6);
        }
        else {
          puVar13 = (undefined4 *)*DAT_0007ffd0;
          *DAT_0007ffd0 = 0;
          DAT_0007ffd0 = puVar13;
        }
        puVar13 = &DAT_000cb538;
        *puVar6 = local_54[0];
        puVar6[1] = local_54[1];
        puVar6[2] = local_4c;
        puVar6[3] = local_48[0];
        puVar6[4] = local_48[1];
      }
      puVar10 = (undefined4 *)*puVar13;
      if (puVar10 == (undefined4 *)0x0) {
LAB_0002d06c:
        *puVar6 = puVar10;
        *puVar13 = puVar6;
      }
      else {
        puVar7 = puVar10;
        do {
          puVar10 = puVar7;
          if (bVar14) {
            iVar5 = memcmp(puVar6 + 3,puVar10 + 3,0x10);
            if (0 < iVar5) goto LAB_0002d06c;
            if (iVar5 == 0) {
              iVar5 = memcmp(puVar6 + 7,puVar10 + 7,0x10);
              if (0 < iVar5) goto LAB_0002d06c;
              if (iVar5 == 0) {
LAB_0002d0b8:
                if (*(ushort *)((int)puVar10 + 10) < *(ushort *)((int)puVar6 + 10)) goto LAB_0002d06c;
              }
            }
          }
          else {
            if ((uint)puVar10[3] < (uint)puVar6[3]) goto LAB_0002d06c;
            if ((uint)puVar10[3] <= (uint)puVar6[3]) {
              if ((uint)puVar10[4] < (uint)puVar6[4]) goto LAB_0002d06c;
              if ((uint)puVar10[4] <= (uint)puVar6[4]) goto LAB_0002d0b8;
            }
          }
          puVar7 = (undefined4 *)*puVar10;
          puVar13 = puVar10;
        } while ((undefined4 *)*puVar10 != (undefined4 *)0x0);
        *puVar6 = 0;
        *puVar10 = puVar6;
      }
      DAT_0007ffbc = DAT_0007ffbc + 1;
      if ((param_5 & 0x20) != 0) {
        FUN_0002c978();
      }
    }
    else {
      uVar9 = *(ushort *)(puVar13 + 2);
      if (((param_5 & 0x20) != 0) && ((uVar9 & 0x20) == 0)) {
        FUN_0002c978();
        uVar9 = *(ushort *)(puVar13 + 2);
      }
      *(ushort *)(puVar13 + 2) = uVar9 | param_5;
    }
    break;
  case 2:
    if (puVar13 != (undefined4 *)0x0) {
      uVar9 = *(ushort *)(puVar13 + 2);
      if (((uVar9 & 0x20) != 0) && ((param_5 & 0x20) != 0)) {
        FUN_0002c9a8();
        uVar9 = *(ushort *)(puVar13 + 2);
      }
      *(ushort *)(puVar13 + 2) = uVar9 & ~param_5;
    }
    break;
  case 3:
  case 4:
    if ((puVar13 != (undefined4 *)0x0) &&
       ((((param_1 == 4 || ((*(ushort *)((int)puVar13 + 10) & 0x1000) == 0)) && (puVar13 != &DAT_0007ff64)) &&
        (puVar13 != &DAT_0007ff90)))) {
      DAT_0007ffbc = DAT_0007ffbc + -1;
      if (*(short *)(puVar13 + 2) != 0) {
        FUN_0002c9a8();
      }
      puVar10 = &DAT_000cb538;
      if (bVar14) {
        puVar10 = &DAT_000cb53c;
      }
      puVar7 = (undefined4 *)*puVar10;
      puVar6 = puVar13;
      if (puVar13 == puVar7) {
LAB_0002ced4:
        *puVar10 = *puVar6;
        *puVar6 = 0;
      }
      else {
        if (puVar7 != (undefined4 *)0x0) {
          puVar10 = puVar7;
          for (puVar6 = (undefined4 *)*puVar7; puVar6 != (undefined4 *)0x0; puVar6 = (undefined4 *)*puVar6) {
            if (puVar6 == puVar13) goto LAB_0002ced4;
            if (puVar6 == (undefined4 *)0x0) break;
            puVar10 = puVar6;
          }
        }
        (*DAT_0007c9fc)("ntp_restrict.c",0xe4,2,"unlinked == res");
      }
      if (bVar14) {
        memset(puVar13,0,0x2c);
        puVar10 = &DAT_0007ffcc;
      }
      else {
        memset(puVar13,0,0x14);
        puVar10 = &DAT_0007ffd0;
      }
      *puVar13 = *puVar10;
      *puVar10 = puVar13;
    }
    break;
  default:
    (*DAT_0007c9fc)("ntp_restrict.c",0x253,2,"0");
  }
  return;
}




void FUN_0002d284(void)

{
  getitimer(ITIMER_REAL,(itimerval *)&DAT_000cb550);
  if (1 < DAT_000cb558) {
    DAT_000cb558 = 1;
  }
  if (DAT_000cb55c < 0) {
    DAT_000cb55c = 0;
  }
  if ((DAT_000cb558 == 0) && (DAT_000cb55c == 0)) {
    DAT_000cb55c = 0;
    DAT_000cb558 = 1;
  }
  DAT_000cb554 = 0;
  DAT_000cb550 = 1;
  setitimer(ITIMER_REAL,(itimerval *)&DAT_000cb550,(itimerval *)0x0);
  return;
}




void FUN_0002d304(void)

{
  DAT_000cb540 = 0;
  DAT_0007ffe0 = 0;
  DAT_0007ffe4 = 0;
  DAT_0007ffe8 = 0;
  DAT_0007ffdc = 1;
  DAT_000cb570 = 0;
  DAT_000cb54c = 0;
  DAT_000cb548 = 0;
  DAT_000cb560 = 0;
  DAT_000cb544 = 0;
  FUN_0005131c(0xe,&LAB_0002d244);
  DAT_000cb558 = 1;
  DAT_000cb550 = 1;
  DAT_000cb55c = 0;
  DAT_000cb554 = 0;
  setitimer(ITIMER_REAL,(itimerval *)&DAT_000cb550,(itimerval *)0x0);
  return;
}




void FUN_0002d3ac(void)

{
  uint *puVar1;
  uint uVar2;
  int *piVar3;
  int *piVar4;
  int *piVar5;
  
  DAT_000cb548 = DAT_000cb548 + 1;
  FUN_0004cba8(&DAT_000cb564);
  if (DAT_0007ffdc <= DAT_000cb548) {
    DAT_0007ffdc = DAT_0007ffdc + 1;
    FUN_00020730();
    piVar5 = (int *)&DAT_000cb238;
    do {
      piVar5 = piVar5 + 1;
      piVar3 = (int *)*piVar5;
      while (piVar3 != (int *)0x0) {
        while (puVar1 = (uint *)(piVar3 + 0xd), piVar3 = (int *)*piVar3, (*puVar1 & 8) != 0) {
          FUN_000272d0();
          if (piVar3 == (int *)0x0) goto LAB_0002d658;
        }
      }
LAB_0002d658:
    } while (piVar5 != (int *)&DAT_000cb438);
  }
  piVar5 = (int *)&DAT_000cb238;
  do {
    piVar5 = piVar5 + 1;
    piVar3 = (int *)*piVar5;
joined_r0x0002d3f0:
    piVar4 = piVar3;
    if (piVar3 != (int *)0x0) {
      do {
        piVar3 = (int *)*piVar4;
        if (((code *)piVar4[0x84] != (code *)0x0) && ((uint)piVar4[0x83] <= DAT_000cb548)) {
          (*(code *)piVar4[0x84])(piVar4);
        }
        uVar2 = DAT_000cb548;
        if (0 < piVar4[0x80]) {
          piVar4[0x80] = piVar4[0x80] + -1;
        }
        if ((uint)piVar4[0x82] <= uVar2) {
          if ((piVar4[0xd] & 8U) == 0) goto code_r0x0002d450;
          FUN_00027300(piVar4);
        }
        piVar4 = piVar3;
        if (piVar3 == (int *)0x0) break;
      } while( true );
    }
    if (piVar5 == (int *)&DAT_000cb438) {
      if (((int)DAT_0007a2b0 < 0x10) && (DAT_000cb470 == 0)) {
        if (DAT_000cb4b0 == '\x03') {
          DAT_000cb4b0 = '\0';
        }
        DAT_000cb4fc = (undefined1)DAT_0007a2b0;
        if ((DAT_0007a2b0 & 0xff) < 2) {
          DAT_000cb4e0 = (undefined1 *)0x504f4f4c;
        }
        else {
          DAT_000cb4e0 = &DAT_0100007f;
        }
        DAT_000cb4b8._0_4_ = 0;
        DAT_000cb4b8._4_4_ = 0;
        DAT_000cb4c8 = 0;
        DAT_000cb4cc = 0;
        DAT_000cb498._0_4_ = 0;
        DAT_000cb498._4_4_ = 0;
      }
      if (DAT_000cb56c != 0) {
        DAT_000cb56c = DAT_000cb56c - 1;
        if (DAT_000cb56c == 0) {
          DAT_000cabcc = DAT_000cb450;
          DAT_000cb4b0 = '\0';
          if ((DAT_000cabd8 == 0) || (DAT_0007a198 == 0)) {
            FUN_0004cde0(0);
          }
          FUN_0001d3d8(0xb,0,0);
        }
        else {
          if (DAT_000cb56c < 0x15180) {
            DAT_000cb4b0 = '\x01';
          }
          if (0 < DAT_000cb450) {
            DAT_000cabcc = DAT_000cb450 + -1;
          }
        }
      }
      if (DAT_0007ffe4 <= DAT_000cb548) {
        DAT_0007ffe4 = DAT_0007ffe4 + 900;
        FUN_000207d8();
      }
      if ((DAT_0007a4e8 != 0) && (DAT_0007ffe8 <= DAT_000cb548)) {
        DAT_0007ffe8 = DAT_000cb548 + DAT_0007a4e8;
        if (1 < DAT_0007cf4c) {
          puts("timer: interface update");
        }
        FUN_00014a04(0,0);
      }
      if (DAT_000cb548 < DAT_0007ffe0) {
        return;
      }
      DAT_0007ffe0 = DAT_0007ffe0 + 0xe10;
      FUN_0002d8bc();
      if (DAT_000cabcc == 0) {
        return;
      }
      if (DAT_000cb4f0 < DAT_000cb564) {
        FUN_0001d3d8(0xf,0,0);
        return;
      }
      return;
    }
  } while( true );
code_r0x0002d450:
  FUN_000263e4();
  goto joined_r0x0002d3f0;
}




void FUN_0002d720(undefined4 param_1)

{
  DAT_0007ffe8 = param_1;
  return;
}




void FUN_0002d768(void)

{
  undefined4 extraout_r1;
  undefined4 extraout_r2;
  undefined4 in_r3;
  
  if (DAT_000cb57c != (void *)0x0) {
    free(DAT_000cb57c);
    free(DAT_0007fff0);
    DAT_0007fff0 = (void *)0x0;
    DAT_000cb57c = (void *)0x0;
  }
  if (DAT_0007fff4 != (void *)0x0) {
    free(DAT_0007fff4);
    DAT_0007fff4 = (void *)0x0;
  }
  FUN_0001e458("peerstats");
  FUN_0001e458("loopstats");
  FUN_0001e458("clockstats");
  FUN_0001e458("rawstats");
  FUN_0001e458("sysstats");
  FUN_0001e458("protostats",extraout_r1,extraout_r2,in_r3);
  return;
}




void FUN_0002d808(void)

{
  DAT_000cb57c = 0;
  DAT_0007fff0 = 0;
  DAT_0007fff4 = 0;
  FUN_0001e328(s__var_NTP__0007a4f0,"peerstats",0x7fff8);
  FUN_0001e328(s__var_NTP__0007a4f0,"loopstats",&DAT_0008000c);
  FUN_0001e328(s__var_NTP__0007a4f0,"clockstats",&DAT_00080020);
  FUN_0001e328(s__var_NTP__0007a4f0,"rawstats",&DAT_00080034);
  FUN_0001e328(s__var_NTP__0007a4f0,"sysstats",&DAT_00080048);
  FUN_0001e328(s__var_NTP__0007a4f0,"protostats",&DAT_0008005c);
  FUN_0005b388(FUN_0002d768);
  return;
}




/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0002d8bc(void)

{
  uint uVar1;
  char *pcVar2;
  undefined4 uVar3;
  FILE *pFVar4;
  int iVar5;
  double dVar6;
  uint local_30;
  undefined4 local_2c;
  
  if (DAT_000cb588 != 0) {
    FUN_0004cba8(&local_30);
    FUN_0001dae8(&DAT_00080048,local_30);
    pFVar4 = DAT_00080048;
    uVar1 = local_30 / 0x15180;
    local_30 = local_30 % 0x15180;
    if (DAT_00080048 != (FILE *)0x0) {
      uVar3 = FUN_0004f124(local_30,local_2c,0,3,0);
      fprintf(pFVar4,"%lu %s %lu %lu %lu %lu %lu %lu %lu %lu %lu %lu %lu\n",uVar1 + 0x3aac,uVar3,
              DAT_000cb548 - DAT_000cb468,DAT_000cb4a0,DAT_000cb474,DAT_000cb484,DAT_000cb4c0,DAT_000cb4dc,DAT_000cb490,
              DAT_000cb4f8,DAT_000cb47c,DAT_000cb4c4,DAT_000cb4e4);
      fflush(DAT_00080048);
      FUN_00026d0c();
    }
  }
  dVar6 = DAT_00080070 - DAT_000caba8;
  DAT_00080070 = DAT_000caba8;
  if (((ABS(dVar6) <= DAT_0007a1c0) && (DAT_000cb57c != (char *)0x0)) && (DAT_000cb58c != 0)) {
    DAT_000cb58c = 0;
    _DAT_000cb580 = _DAT_000cb580 * 0.5;
    if (DAT_0007cf4c != 0) {
      printf("write_stats: wander %.6lf thresh %.6lf, freq %.6lf\n",0,SUB84(DAT_000caba0 * 1000000.0,0),
             (int)((ulonglong)(DAT_000caba0 * 1000000.0) >> 0x20),_DAT_000cb580 * 1000000.0,DAT_000caba8 * 1000000.0);
    }
    if (DAT_000cb4b0 != '\x03') {
      if (_DAT_000cb580 < DAT_000caba0) {
        _DAT_000cb580 = (double)CONCAT44(DAT_0007a5f4,DAT_0007a5f0);
        pFVar4 = fopen(DAT_0007fff0,"w");
        if (pFVar4 == (FILE *)0x0) {
          FUN_0004fe78(3,"frequency file %s: %m",DAT_0007fff0);
        }
        else {
          fprintf(pFVar4,"%.3f\n",SUB84(DAT_000caba8 * 1000000.0,0),(int)((ulonglong)(DAT_000caba8 * 1000000.0) >> 0x20)
                 );
          fclose(pFVar4);
          pcVar2 = DAT_0007fff0;
          iVar5 = rename(DAT_0007fff0,DAT_000cb57c);
          if (iVar5 != 0) {
            FUN_0004fe78(4,"Unable to rename temp drift file %s to %s, %m",pcVar2,DAT_000cb57c);
          }
        }
      }
    }
  }
  return;
}




void FUN_0002dbd4(undefined4 param_1,undefined4 param_2)

{
  uint uVar1;
  FILE *__stream;
  undefined4 uVar2;
  undefined4 uVar3;
  uint local_48;
  undefined4 local_44;
  
  if (DAT_000cb588 != 0) {
    FUN_0004cba8(&local_48);
    FUN_0001dae8(0x7fff8,local_48);
    __stream = DAT_0007fff8;
    uVar1 = local_48 / 0x15180;
    local_48 = local_48 % 0x15180;
    if (DAT_0007fff8 != (FILE *)0x0) {
      uVar2 = FUN_0004f124(local_48,local_44,0,3,0);
      uVar3 = FUN_00050cd0(param_1);
      fprintf(__stream,"%lu %s %s %x %.9f %.9f %.9f %.9f\n",uVar1 + 0x3aac,uVar2,uVar3,param_2);
      fflush(DAT_0007fff8);
    }
  }
  return;
}




void FUN_0002dcc8(void)

{
  uint uVar1;
  FILE *__stream;
  undefined4 uVar2;
  uint local_40;
  undefined4 local_3c;
  
  if (DAT_000cb588 != 0) {
    FUN_0004cba8(&local_40);
    FUN_0001dae8(&DAT_0008000c,local_40);
    __stream = DAT_0008000c;
    uVar1 = local_40 / 0x15180;
    local_40 = local_40 % 0x15180;
    if (DAT_0008000c != (FILE *)0x0) {
      uVar2 = FUN_0004f124(local_40,local_3c,0,3,0);
      fprintf(__stream,"%lu %s %.9f %.3f %.9f %.6f %d\n",uVar1 + 0x3aac,uVar2);
      fflush(DAT_0008000c);
    }
  }
  return;
}




void FUN_0002ddbc(undefined4 param_1,undefined4 param_2)

{
  uint uVar1;
  FILE *__stream;
  undefined4 uVar2;
  undefined4 uVar3;
  uint local_28;
  undefined4 local_24;
  
  if (DAT_000cb588 != 0) {
    FUN_0004cba8(&local_28);
    FUN_0001dae8(&DAT_00080020,local_28);
    __stream = DAT_00080020;
    uVar1 = local_28 / 0x15180;
    local_28 = local_28 % 0x15180;
    if (DAT_00080020 != (FILE *)0x0) {
      uVar2 = FUN_0004f124(local_28,local_24,0,3,0);
      uVar3 = FUN_00050cd0(param_1);
      fprintf(__stream,"%lu %s %s %s\n",uVar1 + 0x3aac,uVar2,uVar3,param_2);
      fflush(DAT_00080020);
    }
  }
  return;
}




void FUN_0002de88(undefined4 param_1,int param_2,undefined4 *param_3,undefined4 *param_4,undefined4 *param_5,
                 undefined4 *param_6)

{
  uint uVar1;
  FILE *__stream;
  undefined4 uVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  char *local_34;
  uint local_30;
  undefined4 local_2c;
  
  if (DAT_000cb588 != 0) {
    FUN_0004cba8(&local_30);
    FUN_0001dae8(&DAT_00080034,local_30);
    __stream = DAT_00080034;
    uVar1 = local_30 / 0x15180;
    local_30 = local_30 % 0x15180;
    if (DAT_00080034 != (FILE *)0x0) {
      uVar2 = FUN_0004f124(local_30,local_2c,0,3,0);
      uVar3 = FUN_00050cd0(param_1);
      if (param_2 == 0) {
        local_34 = "-";
      }
      else {
        local_34 = (char *)FUN_00050cd0(param_2);
      }
      uVar4 = FUN_0004f124(*param_3,param_3[1],0,9,0);
      uVar5 = FUN_0004f124(*param_4,param_4[1],0,9,0);
      uVar6 = FUN_0004f124(*param_5,param_5[1],0,9,0);
      uVar7 = FUN_0004f124(*param_6,param_6[1],0,9,0);
      fprintf(__stream,"%lu %s %s %s %s %s %s %s\n",uVar1 + 0x3aac,uVar2,uVar3,local_34,uVar4,uVar5,uVar6,uVar7);
      fflush(DAT_00080034);
    }
  }
  return;
}




void FUN_0002e018(undefined4 param_1)

{
  uint uVar1;
  FILE *__stream;
  undefined4 uVar2;
  uint local_20;
  undefined4 local_1c;
  
  if (DAT_000cb588 != 0) {
    FUN_0004cba8(&local_20);
    FUN_0001dae8(&DAT_0008005c,local_20);
    __stream = DAT_0008005c;
    uVar1 = local_20 / 0x15180;
    local_20 = local_20 % 0x15180;
    if (DAT_0008005c != (FILE *)0x0) {
      uVar2 = FUN_0004f124(local_20,local_1c,0,3,0);
      fprintf(__stream,"%lu %s %s\n",uVar1 + 0x3aac,uVar2,param_1);
      fflush(DAT_0008005c);
    }
  }
  return;
}




int FUN_0002e0d0(uint param_1)

{
  int *piVar1;
  uint uVar2;
  int local_70 [24];
  
  piVar1 = local_70;
  if (0xbc19137f < param_1) {
    param_1 = param_1 + 0x43e6ec80;
  }
  local_70[0] = 0x1f;
  local_70[1] = 0x1c;
  local_70[2] = 0x1f;
  local_70[3] = 0x1e;
  local_70[4] = 0x1f;
  local_70[5] = 0x1e;
  local_70[6] = 0x1f;
  local_70[7] = 0x1f;
  local_70[8] = 0x1e;
  local_70[9] = 0x1f;
  local_70[10] = 0x1e;
  local_70[0xb] = 0x1f;
  local_70[0xc] = 0x1f;
  local_70[0xd] = 0x1d;
  local_70[0xe] = 0x1f;
  local_70[0xf] = 0x1e;
  local_70[0x10] = 0x1f;
  local_70[0x11] = 0x1e;
  local_70[0x12] = 0x1f;
  local_70[0x13] = 0x1f;
  local_70[0x14] = 0x1e;
  local_70[0x15] = 0x1f;
  local_70[0x16] = 0x1e;
  local_70[0x17] = 0x1f;
  for (; 0x7861f7f < param_1; param_1 = param_1 + 0xf879e080) {
  }
  if (param_1 < 0x1e28500) {
    piVar1 = local_70 + 0xc;
  }
  else {
    for (param_1 = param_1 + 0xfe1d7b00; 0x1e1337f < param_1; param_1 = param_1 + 0xfe1ecc80) {
    }
  }
  uVar2 = *piVar1 * 0x15180;
  if (uVar2 <= param_1) {
    do {
      piVar1 = piVar1 + 1;
      param_1 = param_1 - uVar2;
      uVar2 = *piVar1 * 0x15180;
    } while (uVar2 < param_1 || uVar2 - param_1 == 0);
  }
  return (uVar2 - 0x15180) - param_1;
}




undefined4 FUN_0002e1e8(char *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  size_t sVar2;
  char *pcVar3;
  FILE *__stream;
  uint uVar4;
  byte *pbVar5;
  __int32_t **pp_Var6;
  char *pcVar7;
  uint uVar8;
  undefined4 uVar9;
  uint uVar10;
  char *pcStack_24c;
  char acStack_248 [4];
  char acStack_244 [4];
  char acStack_240 [4];
  char acStack_23c [4];
  undefined1 uStack_238;
  byte abStack_234 [20];
  char acStack_220 [520];
  undefined4 uStack_18;
  
  uStack_18 = param_4;
  sVar2 = strlen(param_1);
  if (sVar2 == 0) {
    return 0;
  }
  pcVar3 = (char *)FUN_0004f478(DAT_0007fff4,sVar2 + 1,0,0);
  DAT_0007fff4 = pcVar3;
  memmove(pcVar3,param_1,sVar2 + 1);
  __stream = fopen(pcVar3,"r");
  if (__stream == (FILE *)0x0) {
    FUN_0004fe78(3,"authreadkeys: file %s: %m",pcVar3);
    uVar9 = 0;
  }
  else {
    FUN_0004e2bc();
    while (pcStack_24c = fgets(acStack_220,0x200,__stream), pcStack_24c != (char *)0x0) {
      pcVar3 = (char *)FUN_0004e560(&pcStack_24c);
      if (pcVar3 != (char *)0x0) {
        uVar4 = strtol(pcVar3,(char **)0x0,10);
        if (uVar4 == 0) {
          FUN_0004fe78(3,"authreadkeys: cannot change key %s",pcVar3);
        }
        else if (uVar4 < 0x10000) {
          pbVar5 = (byte *)FUN_0004e560(&pcStack_24c);
          if (pbVar5 == (byte *)0x0) {
            FUN_0004fe78(3,"authreadkeys: no key type for key %d",uVar4);
          }
          else if ((*pbVar5 & 0xdf) == 0x4d) {
            pcVar3 = (char *)FUN_0004e560(&pcStack_24c);
            if (pcVar3 == (char *)0x0) {
              FUN_0004fe78(3,"authreadkeys: no key for key %d",uVar4);
            }
            else {
              sVar2 = strlen(pcVar3);
              if ((int)sVar2 < 0x15) {
                FUN_0004e0e4(uVar4,4,pcVar3,sVar2);
              }
              else {
                if (0x27 < sVar2) {
                  sVar2 = 0x28;
                }
                acStack_248[0] = '0';
                acStack_248[1] = '1';
                acStack_248[2] = '2';
                acStack_248[3] = '3';
                acStack_244[0] = '4';
                acStack_244[1] = '5';
                acStack_244[2] = '6';
                acStack_244[3] = '7';
                acStack_240[0] = '8';
                acStack_240[1] = '9';
                acStack_240[2] = 'a';
                acStack_240[3] = 'b';
                acStack_23c[0] = 'c';
                acStack_23c[1] = 'd';
                acStack_23c[2] = 'e';
                acStack_23c[3] = 'f';
                uStack_238 = 0;
                if (0 < (int)sVar2) {
                  pp_Var6 = __ctype_tolower_loc();
                  uVar10 = 0;
                  do {
                    pcVar7 = strchr(acStack_248,(*pp_Var6)[(byte)pcVar3[uVar10]]);
                    iVar1 = (int)uVar10 >> 1;
                    uVar8 = (int)pcVar7 - (int)acStack_248;
                    if (pcVar7 == (char *)0x0) {
                      FUN_0004fe78(3,"authreadkeys: invalid hex digit for key %d",uVar4);
                    }
                    else if ((uVar10 & 1) == 0) {
                      abStack_234[iVar1] = (byte)((uVar8 & 0xff) << 4);
                    }
                    else {
                      abStack_234[iVar1] = (byte)uVar8 | abStack_234[iVar1];
                    }
                    uVar10 = uVar10 + 1;
                  } while (sVar2 != uVar10);
                }
                FUN_0004e0e4(uVar4,4,abStack_234,(int)sVar2 / 2);
              }
            }
          }
          else {
            FUN_0004fe78(3,"authreadkeys: invalid type for key %d",uVar4);
          }
        }
        else {
          FUN_0004fe78(3,"authreadkeys: key %s > %d reserved for Autokey",pcVar3);
        }
      }
    }
    fclose(__stream);
    uVar9 = 1;
  }
  return uVar9;
}




undefined4 FUN_0002e23c(void)

{
  int iVar1;
  FILE *__stream;
  char *pcVar2;
  uint uVar3;
  byte *pbVar4;
  size_t sVar5;
  __int32_t **pp_Var6;
  char *pcVar7;
  uint uVar8;
  undefined4 uVar9;
  uint uVar10;
  char *local_24c;
  char local_248 [4];
  char acStack_244 [4];
  char acStack_240 [4];
  char acStack_23c [4];
  undefined1 local_238;
  byte local_234 [20];
  char acStack_220 [512];
  
  pcVar2 = DAT_0007fff4;
  if (DAT_0007fff4 == (char *)0x0) {
    return 0;
  }
  __stream = fopen(DAT_0007fff4,"r");
  if (__stream == (FILE *)0x0) {
    FUN_0004fe78(3,"authreadkeys: file %s: %m",pcVar2);
    uVar9 = 0;
  }
  else {
    FUN_0004e2bc();
    while (local_24c = fgets(acStack_220,0x200,__stream), local_24c != (char *)0x0) {
      pcVar2 = (char *)FUN_0004e560(&local_24c);
      if (pcVar2 != (char *)0x0) {
        uVar3 = strtol(pcVar2,(char **)0x0,10);
        if (uVar3 == 0) {
          FUN_0004fe78(3,"authreadkeys: cannot change key %s",pcVar2);
        }
        else if (uVar3 < 0x10000) {
          pbVar4 = (byte *)FUN_0004e560(&local_24c);
          if (pbVar4 == (byte *)0x0) {
            FUN_0004fe78(3,"authreadkeys: no key type for key %d",uVar3);
          }
          else if ((*pbVar4 & 0xdf) == 0x4d) {
            pcVar2 = (char *)FUN_0004e560(&local_24c);
            if (pcVar2 == (char *)0x0) {
              FUN_0004fe78(3,"authreadkeys: no key for key %d",uVar3);
            }
            else {
              sVar5 = strlen(pcVar2);
              if ((int)sVar5 < 0x15) {
                FUN_0004e0e4(uVar3,4,pcVar2,sVar5);
              }
              else {
                if (0x27 < sVar5) {
                  sVar5 = 0x28;
                }
                local_248[0] = '0';
                local_248[1] = '1';
                local_248[2] = '2';
                local_248[3] = '3';
                acStack_244[0] = '4';
                acStack_244[1] = '5';
                acStack_244[2] = '6';
                acStack_244[3] = '7';
                acStack_240[0] = '8';
                acStack_240[1] = '9';
                acStack_240[2] = 'a';
                acStack_240[3] = 'b';
                acStack_23c[0] = 'c';
                acStack_23c[1] = 'd';
                acStack_23c[2] = 'e';
                acStack_23c[3] = 'f';
                local_238 = 0;
                if (0 < (int)sVar5) {
                  pp_Var6 = __ctype_tolower_loc();
                  uVar10 = 0;
                  do {
                    pcVar7 = strchr(local_248,(*pp_Var6)[(byte)pcVar2[uVar10]]);
                    iVar1 = (int)uVar10 >> 1;
                    uVar8 = (int)pcVar7 - (int)local_248;
                    if (pcVar7 == (char *)0x0) {
                      FUN_0004fe78(3,"authreadkeys: invalid hex digit for key %d",uVar3);
                    }
                    else if ((uVar10 & 1) == 0) {
                      local_234[iVar1] = (byte)((uVar8 & 0xff) << 4);
                    }
                    else {
                      local_234[iVar1] = (byte)uVar8 | local_234[iVar1];
                    }
                    uVar10 = uVar10 + 1;
                  } while (sVar5 != uVar10);
                }
                FUN_0004e0e4(uVar3,4,local_234,(int)sVar5 / 2);
              }
            }
          }
          else {
            FUN_0004fe78(3,"authreadkeys: invalid type for key %d",uVar3);
          }
        }
        else {
          FUN_0004fe78(3,"authreadkeys: key %s > %d reserved for Autokey",pcVar2);
        }
      }
    }
    fclose(__stream);
    uVar9 = 1;
  }
  return uVar9;
}




byte FUN_0002e254(short *param_1)

{
  char *pcVar1;
  uint uVar2;
  byte bVar3;
  uint uVar4;
  
  bVar3 = (char)*param_1 * '%' + *(char *)((int)param_1 + 1);
  if (*param_1 == 2) {
    param_1 = param_1 + 2;
    uVar4 = 4;
  }
  else {
    if (*param_1 != 10) goto LAB_0002e280;
    param_1 = param_1 + 4;
    uVar4 = 0x10;
  }
  uVar2 = 0;
  do {
    pcVar1 = (char *)((int)param_1 + uVar2);
    uVar2 = uVar2 + 1;
    bVar3 = *pcVar1 + bVar3 * '%';
  } while (uVar2 < uVar4);
LAB_0002e280:
  return bVar3 & 0x7f;
}




undefined4 * FUN_0002e2c4(int param_1)

{
  tm *ptVar1;
  int local_c;
  
  local_c = param_1 + 0x7c558180;
  ptVar1 = gmtime(&local_c);
  if (ptVar1 == (tm *)0x0) {
    DAT_00080078._0_1_ = 'g';
    DAT_00080078._1_1_ = 'm';
    DAT_00080078._2_1_ = 't';
    DAT_00080078._3_1_ = 'i';
    DAT_0008007c._0_1_ = 'm';
    DAT_0008007c._1_1_ = 'e';
    DAT_0008007c._2_1_ = '(';
    DAT_0008007c._3_1_ = ')';
    DAT_00080080._0_1_ = ' ';
    DAT_00080080._1_1_ = 'e';
    DAT_00080080._2_1_ = 'r';
    DAT_00080080._3_1_ = 'r';
    DAT_00080084 = 0x726f;
    DAT_00080086 = 0;
  }
  else {
    snprintf((char *)&DAT_00080078,0x14,"%04d%02d%02d%02d%02d",ptVar1->tm_year + 0x76c,ptVar1->tm_mon + 1,
             ptVar1->tm_mday,ptVar1->tm_hour,ptVar1->tm_min);
  }
  return &DAT_00080078;
}




void FUN_0002e368(undefined4 param_1,char *param_2)

{
  FILE *pFVar1;
  char *pcVar2;
  size_t sVar3;
  int iVar4;
  __pid_t _Var5;
  void *__dest;
  int iVar6;
  bool bVar7;
  undefined4 local_164;
  undefined4 local_160;
  int local_15c;
  char local_158 [4];
  undefined2 local_154;
  undefined4 local_150 [2];
  char acStack_148 [20];
  char acStack_134 [20];
  char local_120;
  char local_11f;
  char acStack_11e [258];
  
  local_158[0] = '.';
  local_158[1] = 'T';
  local_158[2] = 'E';
  local_158[3] = 'M';
  local_154 = 0x50;
  switch(param_1) {
  case 1:
    if ((param_2 != (char *)0x0) && (sVar3 = strlen(param_2), sVar3 != 0)) {
      DAT_000cb57c = (char *)FUN_0004f478(DAT_000cb57c,sVar3 + 1,0,0);
      __dest = (void *)FUN_0004f478(DAT_0007fff0,sVar3 + 6,0,0);
      DAT_0007fff0 = __dest;
      memcpy(DAT_000cb57c,param_2,sVar3 + 1);
      memcpy(__dest,param_2,sVar3);
      *(char (*) [4])((int)__dest + sVar3) = local_158;
      pcVar2 = DAT_000cb57c;
      *(undefined2 *)((int)__dest + sVar3 + 4) = local_154;
      pFVar1 = fopen(pcVar2,"r");
      if (pFVar1 != (FILE *)0x0) {
        iVar6 = fscanf(pFVar1,"%lf",&DAT_0007a5f8);
        if (iVar6 == 1) {
          fclose(pFVar1);
          DAT_0007a5f8 = DAT_0007a5f8 / 1000000.0;
          DAT_00080070 = DAT_0007a5f8;
        }
        else {
          FUN_0004fe78(3,"format error frequency file %s",DAT_000cb57c);
          fclose(pFVar1);
        }
      }
    }
    break;
  case 2:
    sVar3 = strlen(param_2);
    if (sVar3 < 0x100) {
      if ((sVar3 == 0) || (param_2[sVar3 - 1] == '/')) {
        snprintf(s__var_NTP__0007a4f0,0x100,"%s",param_2);
      }
      else {
        snprintf(s__var_NTP__0007a4f0,0x100,"%s%c",param_2,0x2f);
      }
      FUN_0004cba8(local_150);
      if ((DAT_0007fffc == s__var_NTP__0007a4f0) && (DAT_0007fff8 != (FILE *)0x0)) {
        fclose(DAT_0007fff8);
        DAT_0007fff8 = (FILE *)0x0;
        FUN_0001dae8(0x7fff8,local_150[0]);
      }
      if ((DAT_00080010 == s__var_NTP__0007a4f0) && (DAT_0008000c != (FILE *)0x0)) {
        fclose(DAT_0008000c);
        DAT_0008000c = (FILE *)0x0;
        FUN_0001dae8(&DAT_0008000c,local_150[0]);
      }
      if ((DAT_00080024 == s__var_NTP__0007a4f0) && (DAT_00080020 != (FILE *)0x0)) {
        fclose(DAT_00080020);
        DAT_00080020 = (FILE *)0x0;
        FUN_0001dae8(&DAT_00080020,local_150[0]);
      }
      if ((DAT_00080038 == s__var_NTP__0007a4f0) && (DAT_00080034 != (FILE *)0x0)) {
        fclose(DAT_00080034);
        DAT_00080034 = (FILE *)0x0;
        FUN_0001dae8(&DAT_00080034,local_150[0]);
      }
      if ((DAT_0008004c == s__var_NTP__0007a4f0) && (DAT_00080048 != (FILE *)0x0)) {
        fclose(DAT_00080048);
        DAT_00080048 = (FILE *)0x0;
        FUN_0001dae8(&DAT_00080048,local_150[0]);
      }
      if ((DAT_00080060 == s__var_NTP__0007a4f0) && (DAT_0008005c != (FILE *)0x0)) {
        fclose(DAT_0008005c);
        DAT_0008005c = (FILE *)0x0;
        FUN_0001dae8(&DAT_0008005c,local_150[0]);
      }
    }
    else {
      FUN_0004fe78(3,"statsdir too long (>%d, sigh)",0xff);
    }
    break;
  case 3:
    pFVar1 = fopen(param_2,"w");
    if (pFVar1 == (FILE *)0x0) {
      FUN_0004fe78(3,"pid file %s: %m",param_2);
    }
    else {
      _Var5 = getpid();
      fprintf(pFVar1,"%d",_Var5);
      fclose(pFVar1);
    }
    break;
  case 4:
    pFVar1 = fopen(param_2,"r");
    if (pFVar1 == (FILE *)0x0) {
      FUN_0004fe78(3,"leapseconds file %s: %m",param_2);
    }
    else {
      local_15c = 0;
      local_164 = 0;
      local_160 = 0;
      iVar6 = 10;
      do {
        do {
          while( true ) {
            do {
              pcVar2 = fgets(&local_120,0xff,pFVar1);
              if (pcVar2 == (char *)0x0) {
                if (iVar6 != 10) {
                  DAT_000cb4d8 = local_164;
                  DAT_000cb450 = local_15c;
                  DAT_000cb4f0 = local_160;
                  pcVar2 = (char *)FUN_0002e2c4(local_164);
                  strcpy(acStack_148,pcVar2);
                  pcVar2 = (char *)FUN_0002e2c4(DAT_000cb4f0);
                  strcpy(acStack_134,pcVar2);
                  snprintf(&local_120,0x50,"%d leap %s expire %s",DAT_000cb450,acStack_148,acStack_134);
                  FUN_0001d3d8(0xe,0,&local_120);
                  goto LAB_0002e42c;
                }
                goto LAB_0002e4e0;
              }
            } while (local_120 == '\0');
            if (local_120 == '#') break;
LAB_0002e4b0:
            iVar4 = sscanf(&local_120,"%lu %d",&local_164,&local_15c);
            if ((iVar4 == 2) && (bVar7 = local_15c != iVar6, iVar6 = iVar6 + 1, bVar7)) goto LAB_0002e4e0;
          }
          sVar3 = strlen(&local_120);
        } while (sVar3 < 3);
        if (local_11f != '@' && local_11f != '$') goto LAB_0002e4b0;
        iVar4 = sscanf(acStack_11e,"%lu",&local_160);
      } while (iVar4 == 1);
LAB_0002e4e0:
      FUN_0004fe78(3,"format error leapseconds file %s",param_2);
LAB_0002e42c:
      fclose(pFVar1);
    }
  }
  return;
}




void FUN_0002e8c4(int param_1)

{
  void *__dest;
  int *piVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  int *piVar5;
  size_t __n;
  
  FUN_0004fe78(3,"Datum_PTS: Shutdown Datum PTS");
  if (DAT_000800b8 < 1) {
LAB_0002e924:
    FUN_0004fe78(3,"Datum_PTS: Could not shut down Datum PTS unit %d",param_1);
    return;
  }
  iVar2 = *DAT_000800b4;
  if (*(int *)(iVar2 + 0x24) == param_1) {
    __n = 0;
    iVar4 = 0;
  }
  else {
    iVar4 = 0;
    piVar1 = DAT_000800b4;
    do {
      iVar4 = iVar4 + 1;
      __n = iVar4 * 4;
      if (iVar4 == DAT_000800b8) goto LAB_0002e924;
      piVar1 = piVar1 + 1;
      iVar2 = *piVar1;
    } while (*(int *)(iVar2 + 0x24) != param_1);
  }
  FUN_00015ff4(iVar2 + 4);
  close(*(int *)(*(int *)((int)DAT_000800b4 + __n) + 0x20));
  piVar1 = DAT_000800b4;
  free(*(void **)((int)DAT_000800b4 + __n));
  if (DAT_000800b8 < 2) {
    free(piVar1);
    DAT_000800b4 = (int *)0x0;
    return;
  }
  __dest = (void *)FUN_0004f524((DAT_000800b8 + -1) * 4);
  if (iVar4 != 0) {
    memcpy(__dest,DAT_000800b4,__n);
  }
  if (iVar4 + 1 < DAT_000800b8) {
    iVar2 = DAT_000800b8 * 4;
    piVar5 = DAT_000800b4 + iVar4;
    piVar1 = (int *)((int)__dest + iVar4 * 4);
    do {
      piVar5 = piVar5 + 1;
      piVar3 = piVar1 + 1;
      *piVar1 = *piVar5;
      piVar1 = piVar3;
    } while (piVar3 != (int *)((int)__dest + iVar2 + -4));
  }
  free(DAT_000800b4);
  DAT_000800b4 = (int *)__dest;
  return;
}




undefined4 FUN_0002ea08(undefined4 param_1,undefined4 param_2)

{
  size_t __n;
  void *pvVar1;
  int iVar2;
  int iVar3;
  void *__dest;
  undefined4 uVar4;
  undefined4 *puVar5;
  termios local_64;
  
  iVar3 = open("/dev/datum",2);
  if (iVar3 < 0) {
    FUN_0004fe78(3,"Datum_PTS: open(\"%s\", O_RDWR) failed: %m","/dev/datum");
    uVar4 = 0;
  }
  else {
    __dest = (void *)FUN_0004f524((DAT_000800b8 + 1) * 4);
    __n = DAT_000800b8 * 4;
    if (0 < DAT_000800b8) {
      memcpy(__dest,DAT_000800b4,__n);
    }
    free(DAT_000800b4);
    DAT_000800b4 = __dest;
    uVar4 = FUN_0004f524(0x78);
    iVar2 = DAT_000800b8;
    pvVar1 = DAT_000800b4;
    *(undefined4 *)((int)__dest + __n) = uVar4;
    puVar5 = *(undefined4 **)((int)pvVar1 + iVar2 * 4);
    *(undefined8 *)(puVar5 + 0x1a) = 0;
    puVar5[0xf] = 0;
    puVar5[9] = param_1;
    puVar5[8] = iVar3;
    fcntl(iVar3,4,0);
    memset(&local_64,0,0x3c);
    local_64.c_cc[5] = '\x1e';
    local_64.c_cflag = 0x9bd;
    local_64.c_iflag = 1;
    tcsetattr(puVar5[8],0,&local_64);
    puVar5[5] = 0;
    *puVar5 = param_2;
    puVar5[4] = puVar5;
    puVar5[2] = FUN_0002eb7c;
    puVar5[6] = puVar5[8];
    iVar3 = FUN_00015fc4(puVar5 + 1);
    if (iVar3 == 0) {
      FUN_0004fe78(3,"Datum_PTS: Problem adding clock");
      close(puVar5[8]);
      uVar4 = 0;
    }
    else {
      uVar4 = 1;
      DAT_000800b8 = DAT_000800b8 + 1;
    }
  }
  return uVar4;
}




void FUN_0002eb7c(int param_1)

{
  undefined1 *puVar1;
  bool bVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  int iVar6;
  uint uVar7;
  undefined4 *puVar8;
  uint uVar9;
  int iVar10;
  double dVar11;
  
  puVar8 = *(undefined4 **)(param_1 + 8);
  iVar10 = *(int *)(param_1 + 0x58);
  uVar9 = (uint)*(byte *)((int)puVar8 + 0x65);
  if (uVar9 == 0) {
    uVar4 = *(undefined4 *)(param_1 + 0x50);
    puVar8[0xb] = *(undefined4 *)(param_1 + 0x4c);
    puVar8[0xc] = uVar4;
  }
  if (0 < iVar10) {
    iVar6 = 0;
    do {
      puVar1 = (undefined1 *)(param_1 + 0x5c + iVar6);
      iVar3 = iVar6 + uVar9;
      iVar6 = iVar6 + 1;
      *(undefined1 *)((int)puVar8 + iVar3 + 0x5d) = *puVar1;
    } while (iVar6 != iVar10);
  }
  *(char *)((int)puVar8 + 0x65) = (char)(uVar9 + iVar10);
  if ((uVar9 + iVar10 & 0xff) == 7) {
    iVar10 = (*(byte *)((int)puVar8 + 0x62) & 0xf) * 10 + (uint)(*(byte *)((int)puVar8 + 0x62) >> 4) * 100 +
             (uint)(*(byte *)((int)puVar8 + 99) >> 4);
    puVar8[0x15] = iVar10;
    puVar8[0x16] = iVar10 * 1000;
    puVar8[0x13] = (*(byte *)(puVar8 + 0x18) & 0xf) + (((uint)*(byte *)(puVar8 + 0x18) << 0x19) >> 0x1d) * 10;
    puVar8[0x14] = (*(byte *)((int)puVar8 + 0x61) & 0xf) + (((uint)*(byte *)((int)puVar8 + 0x61) << 0x19) >> 0x1d) * 10;
    puVar8[0x11] = (uint)(*(byte *)((int)puVar8 + 0x5e) >> 4) * 10 + (*(byte *)((int)puVar8 + 0x5d) & 0xf) * 100 +
                   (*(byte *)((int)puVar8 + 0x5e) & 0xf);
    puVar8[0x12] = (*(byte *)((int)puVar8 + 0x5f) & 0xf) + (((uint)*(byte *)((int)puVar8 + 0x5f) << 0x1a) >> 0x1e) * 10;
    iVar10 = FUN_0004efc8();
    if (iVar10 == 0) {
      FUN_0004fe78(3,"Datum_PTS: Bad clocktime");
      return;
    }
    uVar9 = puVar8[0x16];
    uVar7 = (&DAT_0007c19c)[(uVar9 << 0x10) >> 0x18] + (&DAT_0007c15c)[(uVar9 << 0xc) >> 0x1c] +
            (&DAT_0007c59c)[uVar9 & 0xff];
    puVar8[0xe] = uVar7;
    iVar10 = puVar8[0xd];
    uVar9 = puVar8[0xe];
    if (puVar8[0xc] == 0) {
      iVar10 = iVar10 - puVar8[0xb];
    }
    else {
      uVar9 = -puVar8[0xc];
      uVar5 = (uVar9 & 0xffff) + (uVar7 & 0xffff);
      uVar7 = (uVar9 >> 0x10) + (uVar7 >> 0x10);
      if ((uVar5 & 0x10000) != 0) {
        uVar7 = uVar7 + 1;
      }
      iVar10 = ~puVar8[0xb] + iVar10;
      uVar9 = uVar5 & 0xffff | uVar7 << 0x10;
      if ((uVar7 & 0x10000) != 0) {
        iVar10 = iVar10 + 1;
      }
    }
    uVar9 = iVar10 << 0x14 | uVar9 >> 0xc;
    puVar8[0x10] = puVar8[0x10] + 1;
    puVar8[0xd] = puVar8[0xb];
    puVar8[0xe] = puVar8[0xc];
    FUN_000276a0(*puVar8);
    dVar11 = (double)FixedToFP(CONCAT44(uVar9,uVar9),0x20,0x40,0x14,0,0);
    if (dVar11 < 0.0) {
      dVar11 = -dVar11;
    }
    if (*(double *)(puVar8 + 0x1a) == 0.0) {
      bVar2 = dVar11 < 0.1;
      if (bVar2) {
        dVar11 = dVar11 * dVar11;
      }
      else {
        puVar8[0x1a] = 0x47ae147c;
        puVar8[0x1b] = 0x3f847ae1;
      }
      if (bVar2) {
        *(double *)(puVar8 + 0x1a) = dVar11;
      }
    }
    else {
      if (dVar11 < 0.1) {
        dVar11 = dVar11 * 0.05 * dVar11;
      }
      else {
        dVar11 = 0.0005000000000000001;
      }
      *(double *)(puVar8 + 0x1a) = dVar11 + *(double *)(puVar8 + 0x1a) * 0.95;
    }
  }
  return;
}




undefined4 FUN_0002ef28(undefined4 param_1,int param_2)

{
  int iVar1;
  void *__s;
  int iVar2;
  tm *ptVar3;
  long lVar4;
  char *pcVar5;
  int iVar6;
  int iVar7;
  time_t tStack_38;
  char acStack_34 [20];
  
  snprintf(acStack_34,0x14,"/dev/dumbclock%d",param_1);
  if (DAT_0007cf4c != 0) {
    printf("starting Dumbclock with device %s\n",acStack_34);
  }
  iVar1 = FUN_00027d18(acStack_34,0xd,0);
  if (iVar1 != 0) {
    __s = (void *)FUN_0004f524(0x3c);
    memset(__s,0,0x3c);
    iVar7 = *(int *)(param_2 + 0x3c);
    *(void **)(iVar7 + 0x1c) = __s;
    *(int *)(iVar7 + 0xc) = param_2;
    *(int *)(iVar7 + 0x14) = iVar1;
    *(code **)(iVar7 + 4) = FUN_0002f06c;
    *(undefined4 *)(iVar7 + 0x10) = 0;
    iVar2 = FUN_00015fc4(iVar7);
    if (iVar2 == 0) {
      close(iVar1);
      *(undefined4 *)(iVar7 + 0x14) = 0xffffffff;
      free(__s);
      *(undefined4 *)(iVar7 + 0x1c) = 0;
      return 0;
    }
    time(&tStack_38);
    ptVar3 = localtime(&tStack_38);
    if (ptVar3 != (tm *)0x0) {
      iVar1 = ptVar3->tm_min;
      iVar2 = ptVar3->tm_hour;
      iVar6 = ptVar3->tm_mday;
      *(int *)((int)__s + 0x10) = ptVar3->tm_sec;
      *(int *)((int)__s + 0x14) = iVar1;
      *(int *)((int)__s + 0x18) = iVar2;
      *(int *)((int)__s + 0x1c) = iVar6;
      iVar1 = ptVar3->tm_year;
      iVar2 = ptVar3->tm_wday;
      iVar6 = ptVar3->tm_yday;
      *(int *)((int)__s + 0x20) = ptVar3->tm_mon;
      *(int *)((int)__s + 0x24) = iVar1;
      *(int *)((int)__s + 0x28) = iVar2;
      *(int *)((int)__s + 0x2c) = iVar6;
      lVar4 = ptVar3->tm_gmtoff;
      pcVar5 = ptVar3->tm_zone;
      *(int *)((int)__s + 0x30) = ptVar3->tm_isdst;
      *(long *)((int)__s + 0x34) = lVar4;
      *(char **)((int)__s + 0x38) = pcVar5;
      *(undefined1 *)(param_2 + 0x47) = 0xf3;
      *(char **)(iVar7 + 0x24) = "Dumb clock";
      builtin_strncpy((char *)(iVar7 + 0x2ec),"dumb",4);
      return 1;
    }
  }
  return 0;
}




void FUN_0002f06c(int param_1)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  tm *ptVar4;
  undefined4 uVar5;
  long lVar6;
  int iVar7;
  char *pcVar8;
  int iVar9;
  int iVar10;
  char *pcVar11;
  char *__s;
  int iVar12;
  int iVar13;
  int iVar14;
  bool bVar15;
  int local_70;
  int local_6c;
  int local_68;
  int local_64;
  int local_60;
  undefined4 local_5c;
  undefined4 uStack_58;
  tm local_54;
  
  iVar12 = *(int *)(param_1 + 8);
  iVar10 = *(int *)(iVar12 + 0x3c);
  __s = (char *)(iVar10 + 0x28);
  pcVar11 = *(char **)(iVar10 + 0x1c);
  uVar1 = FUN_00027aac(param_1,__s,0x80,&local_5c);
  if (uVar1 == 0) {
    if (*pcVar11 == '\0') {
      *pcVar11 = '\x01';
      *(undefined4 *)(pcVar11 + 4) = local_5c;
      *(undefined4 *)(pcVar11 + 8) = uStack_58;
    }
    else {
      *pcVar11 = '\0';
    }
  }
  else {
    uVar2 = *(undefined4 *)(pcVar11 + 4);
    uVar5 = *(undefined4 *)(pcVar11 + 8);
    *(uint *)(iVar10 + 0xa8) = uVar1 & 0xffff;
    *(undefined4 *)(iVar10 + 0xd8) = uVar2;
    *(undefined4 *)(iVar10 + 0xdc) = uVar5;
    *pcVar11 = '\x01';
    iVar3 = DAT_0007cf4c;
    *(undefined4 *)(pcVar11 + 4) = local_5c;
    *(undefined4 *)(pcVar11 + 8) = uStack_58;
    if (iVar3 != 0) {
      printf("dumbclock: timecode %d %s\n",*(undefined4 *)(iVar10 + 0xa8),__s);
    }
    iVar3 = sscanf(__s,"%02d:%02d:%02d",&local_70,&local_6c,&local_68);
    if (iVar3 == 3) {
      local_54.tm_wday = 0;
      local_54.tm_yday = 0;
      local_54.tm_gmtoff = 0;
      local_54.tm_zone = (char *)0x0;
      local_54.tm_mday = *(int *)(pcVar11 + 0x1c);
      local_54.tm_year = *(int *)(pcVar11 + 0x24);
      local_54.tm_mon = *(int *)(pcVar11 + 0x20);
      local_54.tm_sec = local_68;
      local_54.tm_isdst = -1;
      local_54.tm_hour = local_70;
      local_54.tm_min = local_6c;
      local_64 = mktime(&local_54);
      time(&local_60);
      local_60 = local_64 - local_60;
      if (local_60 < 0xe11) {
        if (local_60 != -0xe10 && 0xe0f < -local_60) {
          local_64 = local_64 + 0x15180;
        }
      }
      else {
        local_64 = local_64 + -0x15180;
      }
      ptVar4 = localtime(&local_64);
      if (ptVar4 != (tm *)0x0) {
        iVar3 = ptVar4->tm_min;
        iVar7 = ptVar4->tm_hour;
        iVar9 = ptVar4->tm_mday;
        *(int *)(pcVar11 + 0x10) = ptVar4->tm_sec;
        *(int *)(pcVar11 + 0x14) = iVar3;
        *(int *)(pcVar11 + 0x18) = iVar7;
        *(int *)(pcVar11 + 0x1c) = iVar9;
        iVar3 = ptVar4->tm_year;
        iVar7 = ptVar4->tm_wday;
        iVar9 = ptVar4->tm_yday;
        *(int *)(pcVar11 + 0x20) = ptVar4->tm_mon;
        *(int *)(pcVar11 + 0x24) = iVar3;
        *(int *)(pcVar11 + 0x28) = iVar7;
        *(int *)(pcVar11 + 0x2c) = iVar9;
        lVar6 = ptVar4->tm_gmtoff;
        pcVar8 = ptVar4->tm_zone;
        *(int *)(pcVar11 + 0x30) = ptVar4->tm_isdst;
        *(long *)(pcVar11 + 0x34) = lVar6;
        *(char **)(pcVar11 + 0x38) = pcVar8;
        ptVar4 = gmtime(&local_64);
        if (ptVar4 != (tm *)0x0) {
          iVar7 = ptVar4->tm_mon + 1;
          iVar9 = ptVar4->tm_year + 0x76c;
          uVar2 = FUN_000513cc(iVar9,iVar7,ptVar4->tm_mday);
          iVar3 = ptVar4->tm_hour;
          iVar14 = ptVar4->tm_min;
          bVar15 = DAT_0007cf4c != 0;
          iVar13 = ptVar4->tm_sec;
          *(int *)(iVar10 + 0xb4) = iVar3;
          *(int *)(iVar10 + 0xb8) = iVar14;
          *(int *)(iVar10 + 0xbc) = iVar13;
          *(undefined4 *)(iVar10 + 0xb0) = uVar2;
          if (bVar15) {
            printf("time is %04d/%02d/%02d %02d:%02d:%02d UTC\n",iVar9,iVar7,ptVar4->tm_mday,iVar3,iVar14,iVar13);
          }
          iVar3 = FUN_00027698(iVar10);
          if (iVar3 == 0) {
            FUN_00027040(iVar12,6);
            return;
          }
          *(undefined4 *)(iVar10 + 0xd0) = *(undefined4 *)(iVar10 + 0xd8);
          *(undefined4 *)(iVar10 + 0xd4) = *(undefined4 *)(iVar10 + 0xdc);
          FUN_000276a0(iVar12);
          FUN_0002ddbc(iVar12 + 0xc,__s);
          pcVar11[0xc] = (char)*(undefined4 *)(iVar10 + 0xb4);
          return;
        }
      }
      FUN_00027040(iVar12,3);
    }
    else if (pcVar11[0xd] == '\0') {
      FUN_00027040(iVar12,2);
    }
    else {
      pcVar11[0xd] = pcVar11[0xd] + -1;
    }
  }
  return;
}




void FUN_0002f334(undefined4 param_1,int param_2)

{
  ssize_t sVar1;
  int iVar2;
  
  iVar2 = *(int *)(param_2 + 0x3c);
  sVar1 = write(*(int *)(iVar2 + 0x14),&DAT_0007a63c,0x1a);
  if (sVar1 == 0x1a) {
    *(int *)(iVar2 + 0x2f8) = *(int *)(iVar2 + 0x2f8) + 1;
  }
  else {
    FUN_00027040(param_2,3);
  }
  if (0 < *(int *)(param_2 + 0x74)) {
    return;
  }
  *(undefined4 *)(param_2 + 0x74) = 5;
  FUN_0002ddbc(param_2 + 0xc,iVar2 + 0x28);
  return;
}




void FUN_0002f3b8(int param_1)

{
  char *pcVar1;
  size_t sVar2;
  undefined4 uVar3;
  ssize_t sVar4;
  int iVar5;
  undefined4 uVar6;
  char *pcVar7;
  uint uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int *piVar12;
  int iVar13;
  bool bVar14;
  
  iVar11 = *(int *)(param_1 + 8);
  iVar10 = *(int *)(iVar11 + 0x3c);
  piVar12 = *(int **)(iVar10 + 0x1c);
  if (*piVar12 == 0) {
    *piVar12 = 1;
    return;
  }
  if (*(int *)(param_1 + 0x58) < 0x18) {
    FUN_00027040(iVar11,2);
    return;
  }
  pcVar7 = (char *)(param_1 + 0x5c);
  if (*(char *)(param_1 + 0x5c) != '\x10') {
    pcVar1 = (char *)(param_1 + 0x5d);
    do {
      pcVar7 = pcVar1;
      pcVar1 = pcVar7 + 1;
    } while (*pcVar7 != '\x10');
  }
  uVar8 = ((byte)pcVar7[2] & 0xf) + (uint)((byte)pcVar7[2] >> 4) * 10;
  *(uint *)(iVar10 + 0xac) = uVar8;
  if (uVar8 == 0x5e) {
    FUN_00027040(iVar11,2);
    sVar4 = write(*(int *)(iVar10 + 0x14),&DAT_0007a658,0x1a);
    if (sVar4 == 0x1a) {
      return;
    }
    FUN_00027040(iVar11,3);
    return;
  }
  iVar13 = piVar12[2];
  if (uVar8 < 99) {
    uVar8 = uVar8 + 100;
  }
  *(uint *)(iVar10 + 0xac) = uVar8 + 0x76c;
  *(uint *)(iVar10 + 0xb0) = (uint)((byte)pcVar7[4] >> 4) * 10 + ((byte)pcVar7[3] & 0xf) * 100 + ((byte)pcVar7[4] & 0xf)
  ;
  if (iVar13 < 0xb) {
    *(uint *)(iVar10 + 0xb4) = ((byte)pcVar7[5] & 0xf) + (uint)((byte)pcVar7[5] >> 4) * 10;
LAB_0002f4a8:
    iVar5 = ((byte)pcVar7[5] & 0xf) + (uint)((byte)pcVar7[5] >> 4) * 10;
    *(int *)(iVar10 + 0xb4) = iVar5;
    *(uint *)(iVar10 + 0xb8) = ((byte)pcVar7[6] & 0xf) + (uint)((byte)pcVar7[6] >> 4) * 10;
    *(uint *)(iVar10 + 0xbc) = ((byte)pcVar7[7] & 0xf) + (uint)((byte)pcVar7[7] >> 4) * 10;
    iVar9 = (((byte)pcVar7[8] & 0xf) + (uint)((byte)pcVar7[8] >> 4) * 10) * 1000000;
    *(int *)(iVar10 + 0xc0) = iVar9;
    *(uint *)(iVar10 + 0xc0) = (uint)((byte)pcVar7[9] >> 4) * 1000 + iVar9;
    if (iVar5 != 10) goto LAB_0002f530;
  }
  else {
    iVar5 = ((byte)pcVar7[6] & 0xf) + (uint)((byte)pcVar7[6] >> 4) * 10;
    *(int *)(iVar10 + 0xb4) = iVar5;
    if (iVar5 != 10) goto LAB_0002f4a8;
    *(uint *)(iVar10 + 0xb8) = ((byte)pcVar7[7] & 0xf) + (uint)((byte)pcVar7[7] >> 4) * 10;
    *(uint *)(iVar10 + 0xbc) = ((byte)pcVar7[8] & 0xf) + (uint)((byte)pcVar7[8] >> 4) * 10;
    iVar5 = (((byte)pcVar7[9] & 0xf) + (uint)((byte)pcVar7[9] >> 4) * 10) * 1000000;
    *(int *)(iVar10 + 0xc0) = iVar5;
    *(uint *)(iVar10 + 0xc0) = (uint)((byte)pcVar7[10] >> 4) * 1000 + iVar5;
    iVar5 = 10;
  }
  if (*(int *)(iVar10 + 0xb8) == 10) {
    piVar12[2] = iVar13 + 1;
  }
LAB_0002f530:
  sprintf((char *)(iVar10 + 0x28),"%d %d %d %d %d",*(undefined4 *)(iVar10 + 0xac),*(undefined4 *)(iVar10 + 0xb0),iVar5,
          *(undefined4 *)(iVar10 + 0xb8),*(undefined4 *)(iVar10 + 0xbc));
  sVar2 = strlen((char *)(iVar10 + 0x28));
  bVar14 = DAT_0007cf4c != 0;
  *(size_t *)(iVar10 + 0xa8) = sVar2;
  if (bVar14) {
    printf("fg: time is %04d/%03d %02d:%02d:%02d UTC\n",*(undefined4 *)(iVar10 + 0xac),*(undefined4 *)(iVar10 + 0xb0),
           *(undefined4 *)(iVar10 + 0xb4),*(undefined4 *)(iVar10 + 0xb8),*(undefined4 *)(iVar10 + 0xbc));
  }
  uVar3 = *(undefined4 *)(param_1 + 0x4c);
  uVar6 = *(undefined4 *)(param_1 + 0x50);
  *(undefined4 *)(iVar10 + 0xe8) = 0x88e368f1;
  *(undefined4 *)(iVar10 + 0xec) = 0x3ee4f8b5;
  *(undefined4 *)(iVar10 + 0xd8) = uVar3;
  *(undefined4 *)(iVar10 + 0xdc) = uVar6;
  iVar13 = FUN_00027698(iVar10);
  if (iVar13 == 0) {
    FUN_00027040(iVar11,6);
  }
  *(undefined4 *)(iVar10 + 0xd0) = *(undefined4 *)(iVar10 + 0xd8);
  *(undefined4 *)(iVar10 + 0xd4) = *(undefined4 *)(iVar10 + 0xdc);
  FUN_000276a0(iVar11);
  return;
}




undefined4 FUN_0002f6f8(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 *puVar2;
  int iVar3;
  ssize_t sVar4;
  undefined4 uVar5;
  int iVar6;
  char acStack_34 [24];
  
  sprintf(acStack_34,"/dev/fgclock%d",param_1);
  if (DAT_0007cf4c != 0) {
    printf("starting FG with device %s\n",acStack_34);
  }
  iVar1 = FUN_00027d18(acStack_34,0xd,1);
  if (iVar1 == 0) {
    uVar5 = 0;
  }
  else {
    puVar2 = (undefined4 *)FUN_0004f524(0xc);
    if (puVar2 == (undefined4 *)0x0) {
      close(iVar1);
      uVar5 = 0;
    }
    else {
      *(undefined1 *)puVar2 = 0;
      *(undefined1 *)((int)puVar2 + 1) = 0;
      *(undefined1 *)((int)puVar2 + 2) = 0;
      *(undefined1 *)((int)puVar2 + 3) = 0;
      *(undefined1 *)(puVar2 + 1) = 0;
      *(undefined1 *)((int)puVar2 + 5) = 0;
      *(undefined1 *)((int)puVar2 + 6) = 0;
      *(undefined1 *)((int)puVar2 + 7) = 0;
      *(undefined1 *)(puVar2 + 2) = 0;
      *(undefined1 *)((int)puVar2 + 9) = 0;
      *(undefined1 *)((int)puVar2 + 10) = 0;
      *(undefined1 *)((int)puVar2 + 0xb) = 0;
      iVar6 = *(int *)(param_2 + 0x3c);
      *(undefined4 **)(iVar6 + 0x1c) = puVar2;
      *(int *)(iVar6 + 0xc) = param_2;
      *(undefined4 *)(iVar6 + 0x10) = 0;
      *(int *)(iVar6 + 0x14) = iVar1;
      *(code **)(iVar6 + 4) = FUN_0002f3b8;
      iVar3 = FUN_00015fc4(iVar6);
      if (iVar3 == 0) {
        close(iVar1);
        uVar5 = 0;
      }
      else {
        *(undefined1 *)(param_2 + 0x47) = 0xf6;
        *(undefined2 *)(iVar6 + 0x2ec) = 0x5047;
        *(char **)(iVar6 + 0x24) = "Forum Graphic GPS dating station";
        iVar1 = *(int *)(iVar6 + 0x14);
        *(undefined1 *)(iVar6 + 0x2ee) = 0x53;
        *puVar2 = 0;
        sVar4 = write(iVar1,&DAT_0007a658,0x1a);
        if (sVar4 != 0x1a) {
          FUN_00027040(param_2,3);
        }
        uVar5 = 1;
      }
    }
  }
  return uVar5;
}




void FUN_0002f864(undefined4 param_1,int param_2)

{
  int iVar1;
  ssize_t sVar2;
  int iVar3;
  undefined4 local_1c [2];
  
  iVar3 = *(int *)(param_2 + 0x3c);
  local_1c[0] = 4;
  iVar1 = ioctl(*(int *)(iVar3 + 0x14),0x5417,local_1c);
  if (iVar1 < 0) {
    FUN_00027040(param_2,3);
  }
  FUN_0004cba8((undefined4 *)(iVar3 + 0xd8));
  sVar2 = write(*(int *)(iVar3 + 0x14),"T",1);
  if (sVar2 != 1) {
    FUN_00027040(param_2,3);
  }
  ioctl(*(int *)(iVar3 + 0x14),0x5416,local_1c);
  if (*(int *)(param_2 + 0x74) < 1) {
    if (*(int *)(iVar3 + 200) == *(int *)(iVar3 + 0xcc)) {
      FUN_00027040(param_2,1);
    }
    else {
      *(undefined4 *)(iVar3 + 0xd0) = *(undefined4 *)(iVar3 + 0xd8);
      *(undefined4 *)(iVar3 + 0xd4) = *(undefined4 *)(iVar3 + 0xdc);
      FUN_000276a0(param_2);
      FUN_0002ddbc(param_2 + 0xc,iVar3 + 0x28);
      if (DAT_0007cf4c != 0) {
        printf("heath: timecode %d %s\n",*(undefined4 *)(iVar3 + 0xa8),iVar3 + 0x28);
      }
      iVar1 = *(int *)(iVar3 + 0x2f8);
      *(undefined4 *)(param_2 + 0x74) = 0x3c;
      *(int *)(iVar3 + 0x2f8) = iVar1 + 1;
    }
  }
  return;
}




int FUN_0002f998(undefined4 param_1,int param_2)

{
  int __fd;
  int iVar1;
  int iVar2;
  char acStack_2c [20];
  
  snprintf(acStack_2c,0x14,"/dev/heath%d",param_1);
  __fd = FUN_00027d18(acStack_2c,*(undefined4 *)(&DAT_00065e0c + (*(byte *)(param_2 + 0x3b) & 3) * 4),0x80);
  if (__fd != 0) {
    iVar2 = *(int *)(param_2 + 0x3c);
    *(int *)(iVar2 + 0xc) = param_2;
    *(int *)(iVar2 + 0x14) = __fd;
    *(code **)(iVar2 + 4) = FUN_0002fa64;
    *(undefined4 *)(iVar2 + 0x10) = 0;
    iVar1 = FUN_00015fc4(iVar2);
    if (iVar1 == 0) {
      close(__fd);
      *(undefined4 *)(iVar2 + 0x14) = 0xffffffff;
      __fd = 0;
    }
    else {
      *(undefined1 *)(param_2 + 0x47) = 0xfc;
      __fd = 1;
      *(undefined4 *)(param_2 + 0x74) = 5;
      *(undefined4 *)(iVar2 + 0x2ec) = 0x565757;
      *(char **)(iVar2 + 0x24) = "Heath GC-1000 Most Accurate Clock";
    }
  }
  return __fd;
}




void FUN_0002fa64(int param_1)

{
  int iVar1;
  ushort **ppuVar2;
  uint uVar3;
  int *piVar4;
  int iVar5;
  int iVar6;
  byte local_29;
  int local_28;
  int local_24;
  undefined1 auStack_20 [8];
  undefined1 auStack_18 [8];
  
  iVar6 = *(int *)(param_1 + 8);
  iVar5 = *(int *)(iVar6 + 0x3c);
  iVar1 = FUN_00027aac(param_1,(char *)(iVar5 + 0x28),0x80,auStack_18);
  *(int *)(iVar5 + 0xa8) = iVar1;
  if ((iVar1 != 0x17) ||
     (iVar1 = sscanf((char *)(iVar5 + 0x28),"%2d:%2d:%2d.%c%5c%2d/%2d/%2d",iVar5 + 0xb4,iVar5 + 0xb8,iVar5 + 0xbc,
                     &local_29,auStack_20,&local_28,&local_24,iVar5 + 0xac), iVar1 != 8)) {
    FUN_00027040(iVar6,2);
    return;
  }
  uVar3 = local_28 - 1;
  if ((uVar3 < 0xc) && (0 < local_24)) {
    if ((*(uint *)(iVar5 + 0xac) & 3) == 0) {
      if ((int)(&DAT_00065e54)[uVar3] < local_24) goto LAB_0002fba4;
      if (uVar3 != 0) {
        piVar4 = (int *)&DAT_00065e50;
        do {
          piVar4 = piVar4 + 1;
          local_24 = local_24 + *piVar4;
        } while (piVar4 != (int *)(&DAT_00065e4c + local_28 * 4));
      }
    }
    else {
      if ((int)(&DAT_00065e24)[uVar3] < local_24) goto LAB_0002fba4;
      if (uVar3 != 0) {
        piVar4 = (int *)&DAT_00065e20;
        do {
          piVar4 = piVar4 + 1;
          local_24 = local_24 + *piVar4;
        } while (piVar4 != &DAT_00065e1c + local_28);
      }
    }
    *(int *)(iVar5 + 0xb0) = local_24;
    ppuVar2 = __ctype_b_loc();
    if (((*ppuVar2)[local_29] & 0x800) == 0) {
      *(undefined1 *)(iVar5 + 0x20) = 3;
    }
    else {
      *(undefined1 *)(iVar5 + 0x20) = 0;
      *(uint *)(iVar5 + 0xc0) = (local_29 - 0x30) * 100000000;
    }
    iVar1 = FUN_00027698(iVar5);
    if (iVar1 != 0) {
      return;
    }
  }
LAB_0002fba4:
  FUN_00027040(iVar6,6);
  return;
}




undefined4 FUN_0002fc40(undefined4 param_1,int param_2)

{
  int __fd;
  void *__s;
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  char acStack_34 [20];
  
  snprintf(acStack_34,0x14,"/dev/hopfclock%d",param_1);
  __fd = FUN_00027d18(acStack_34,0xd,1);
  if (__fd < 1) {
    printf("hopfSerialClock(%d) start: open %s failed\n",param_1,acStack_34);
    uVar2 = 0;
  }
  else {
    FUN_0004fe78(5,"hopfSerialClock(%d) fd: %d dev: %s",param_1,__fd,acStack_34);
    __s = (void *)FUN_0004f524(0x18);
    memset(__s,0,0x18);
    iVar3 = *(int *)(param_2 + 0x3c);
    *(void **)(iVar3 + 0x1c) = __s;
    *(int *)(iVar3 + 0xc) = param_2;
    *(int *)(iVar3 + 0x14) = __fd;
    *(code **)(iVar3 + 4) = FUN_0002fd80;
    *(undefined4 *)(iVar3 + 0x10) = 0;
    iVar1 = FUN_00015fc4(iVar3);
    if (iVar1 == 0) {
      printf("hopfSerialClock(%d) io_addclock\n",param_1);
      close(__fd);
      *(undefined4 *)(iVar3 + 0x14) = 0xffffffff;
      free(__s);
      *(undefined4 *)(iVar3 + 0x1c) = 0;
      uVar2 = 0;
    }
    else {
      uVar2 = 1;
      *(char **)(iVar3 + 0x24) = "hopf Elektronik serial clock";
      *(undefined1 *)(param_2 + 0x47) = 0xf6;
      *(undefined4 *)(param_2 + 0x74) = 5;
      *(undefined4 *)(iVar3 + 0x2ec) = 0x66706f68;
      *(undefined1 *)((int)__s + 0x10) = 0;
      *(short *)((int)__s + 8) = (short)param_1;
    }
  }
  return uVar2;
}




void FUN_0002fd80(int param_1)

{
  uint uVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  char *__s;
  uint local_28;
  undefined1 auStack_24 [4];
  int local_20;
  int local_1c [2];
  
  iVar5 = *(int *)(param_1 + 8);
  iVar4 = *(int *)(iVar5 + 0x3c);
  if (*(int *)(*(int *)(iVar4 + 0x1c) + 0x14) != 0) {
    __s = (char *)(iVar4 + 0x28);
    *(undefined4 *)(*(int *)(iVar4 + 0x1c) + 0x14) = 0;
    uVar1 = FUN_00027aac(param_1,__s,0x80,(undefined4 *)(iVar4 + 0xd8));
    *(uint *)(iVar4 + 0xa8) = uVar1 & 0xffff;
    if ((uVar1 & 0xffff) != 0) {
      sscanf(__s,"%1x%1x%2d%2d%2d%2d%2d%2d",&local_28,auStack_24,iVar4 + 0xb4,iVar4 + 0xb8,iVar4 + 0xbc,&local_20,
             local_1c,iVar4 + 0xac);
      if (((((((*(uint *)(iVar4 + 0xb4) < 0x18) && (-1 < *(int *)(iVar4 + 0xb8))) && (*(int *)(iVar4 + 0xb8) < 0x3c)) &&
            ((-1 < *(int *)(iVar4 + 0xbc) && (*(int *)(iVar4 + 0xbc) < 0x3d)))) &&
           ((0 < local_20 && ((local_20 < 0x20 && (0 < local_1c[0])))))) && (local_1c[0] < 0xd)) &&
         ((-1 < *(int *)(iVar4 + 0xac) && (*(int *)(iVar4 + 0xac) < 100)))) {
        uVar2 = FUN_000513cc();
        iVar3 = *(int *)(iVar4 + 0xac);
        *(undefined1 *)(iVar4 + 0x20) = 0;
        if (iVar3 < 0x62) {
          iVar3 = iVar3 + 100;
        }
        *(int *)(iVar4 + 0xac) = iVar3 + 0x76c;
        *(undefined4 *)(iVar4 + 0xb0) = uVar2;
        if (((local_28 & 0xc) == 0) || (((local_28 & 0xc) == 4 && ((*(byte *)(iVar4 + 0x2f0) & 1) == 0)))) {
          FUN_00027040(iVar5,6);
          *(undefined1 *)(iVar4 + 0x20) = 3;
        }
        else {
          iVar3 = FUN_00027698(iVar4);
          if (iVar3 == 0) {
            FUN_00027040(iVar5,6);
          }
          else {
            *(undefined4 *)(iVar4 + 0xd0) = *(undefined4 *)(iVar4 + 0xd8);
            *(undefined4 *)(iVar4 + 0xd4) = *(undefined4 *)(iVar4 + 0xdc);
            FUN_000276a0(iVar5);
            FUN_0002ddbc(iVar5 + 0xc,__s);
          }
        }
      }
      else {
        FUN_00027040(iVar5,2);
      }
    }
  }
  return;
}




undefined4 FUN_000300e8(undefined2 param_1,int param_2)

{
  undefined2 *puVar1;
  int iVar2;
  
  puVar1 = (undefined2 *)FUN_0004f524(4);
  *(undefined1 *)puVar1 = 0;
  *(undefined1 *)((int)puVar1 + 1) = 0;
  *(undefined1 *)(puVar1 + 1) = 0;
  *(undefined1 *)((int)puVar1 + 3) = 0;
  DAT_000cb590 = open("/dev/hopf6039",2);
  iVar2 = *(int *)(param_2 + 0x3c);
  *(undefined4 *)(iVar2 + 4) = 0;
  *(undefined4 *)(iVar2 + 0x14) = 0xffffffff;
  *(int *)(iVar2 + 0xc) = param_2;
  *(undefined4 *)(iVar2 + 0x10) = 0;
  *(undefined2 **)(iVar2 + 0x1c) = puVar1;
  FUN_0004cba8(iVar2 + 0xd8);
  *(undefined4 *)(iVar2 + 0x2ec) = 0x66706f68;
  *(undefined1 *)(param_2 + 0x47) = 0xf6;
  *(char **)(iVar2 + 0x24) = "hopf Elektronik PCI radio board";
  *(undefined1 *)(puVar1 + 1) = 0;
  *puVar1 = param_1;
  return 1;
}




void FUN_00030190(undefined4 param_1,int param_2)

{
  ssize_t sVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = *(int *)(param_2 + 0x3c);
  iVar2 = **(int **)(iVar3 + 0x1c);
  if (iVar2 == 0) {
    FUN_00027040(param_2,1);
  }
  else {
    **(int **)(iVar3 + 0x1c) = iVar2 + -1;
  }
  sVar1 = write(*(int *)(iVar3 + 0x14),":PTIME:TCODE?\r",0xe);
  if (sVar1 != 0xe) {
    FUN_00027040(param_2,3);
    return;
  }
  *(int *)(iVar3 + 0x2f8) = *(int *)(iVar3 + 0x2f8) + 1;
  return;
}




undefined4 FUN_00030230(undefined4 param_1,int param_2)

{
  int iVar1;
  undefined4 *__s;
  int iVar2;
  ssize_t sVar3;
  undefined4 uVar4;
  int iVar5;
  char acStack_34 [24];
  
  snprintf(acStack_34,0x14,"/dev/hpgps%d",param_1);
  if (*(char *)(param_2 + 0x3b) == '\x01') {
    iVar1 = FUN_00027d18(acStack_34,0xe,0x101);
  }
  else {
    iVar1 = FUN_00027d18(acStack_34,0xd,1);
  }
  if (iVar1 == 0) {
    uVar4 = 0;
  }
  else {
    __s = (undefined4 *)FUN_0004f524(0x748);
    memset(__s,0,0x748);
    iVar5 = *(int *)(param_2 + 0x3c);
    *(int *)(iVar5 + 0xc) = param_2;
    *(int *)(iVar5 + 0x14) = iVar1;
    *(code **)(iVar5 + 4) = FUN_00030380;
    *(undefined4 *)(iVar5 + 0x10) = 0;
    iVar2 = FUN_00015fc4(iVar5);
    if (iVar2 == 0) {
      close(iVar1);
      *(undefined4 *)(iVar5 + 0x14) = 0xffffffff;
      free(__s);
      uVar4 = 0;
    }
    else {
      *(undefined4 **)(iVar5 + 0x1c) = __s;
      *(undefined1 *)(param_2 + 0x47) = 0xf6;
      *(char **)(iVar5 + 0x24) = "HP 58503A GPS Time and Frequency Reference Receiver";
      *(undefined4 *)(iVar5 + 0x2ec) = 0x535047;
      *(undefined1 *)(__s + 5) = 0;
      __s[1] = 0;
      iVar1 = *(int *)(iVar5 + 0x14);
      __s[2] = 0;
      *__s = 2;
      __s[4] = __s + 5;
      __s[3] = 1;
      sVar3 = write(iVar1,"*IDN?\r:PTIME:TZONE?\r",0x14);
      if (sVar3 == 0x14) {
        uVar4 = 1;
      }
      else {
        FUN_00027040(param_2,3);
        uVar4 = 1;
      }
    }
  }
  return uVar4;
}




void FUN_00030380(int param_1)

{
  int iVar1;
  char *pcVar2;
  char *pcVar3;
  ssize_t sVar4;
  undefined1 *puVar5;
  uint uVar6;
  int extraout_r1;
  int extraout_r1_00;
  int iVar7;
  int extraout_r1_01;
  int extraout_r1_02;
  int iVar8;
  int iVar9;
  uint uVar10;
  byte *__src;
  int iVar11;
  undefined4 *puVar12;
  int iVar13;
  byte *pbVar14;
  bool bVar16;
  byte local_c1;
  byte local_c0;
  undefined1 uStack_bf;
  undefined1 uStack_be;
  char local_bd;
  undefined1 uStack_bc;
  char local_bb;
  short local_ba;
  int local_b8;
  int local_b4;
  undefined4 local_b0;
  undefined4 uStack_ac;
  char acStack_a8 [132];
  byte *pbVar15;
  
  iVar13 = *(int *)(param_1 + 8);
  iVar11 = *(int *)(iVar13 + 0x3c);
  puVar12 = *(undefined4 **)(iVar11 + 0x1c);
  __src = (byte *)(iVar11 + 0x28);
  *__src = 0;
  iVar1 = FUN_00027aac(param_1,__src,0x80,&local_b0);
  bVar16 = DAT_0007cf4c != 0;
  *(int *)(iVar11 + 0xa8) = iVar1;
  if (bVar16) {
    printf("hpgps: lencode: %d timecode:%s\n",iVar1,__src);
    iVar1 = *(int *)(iVar11 + 0xa8);
  }
  if (iVar1 == 0) {
    return;
  }
  iVar8 = puVar12[3];
  iVar9 = iVar8 + -1;
  puVar12[3] = iVar9;
  if (0 < iVar8) {
    puVar5 = (undefined1 *)puVar12[4];
    if (iVar1 <= (int)(puVar12 + 5) + (0x72f - (int)puVar5)) {
      *puVar5 = 10;
      puVar12[4] = puVar5 + 1;
      strcpy(puVar5 + 1,(char *)__src);
      iVar9 = puVar12[3];
      puVar12[4] = puVar12[4] + *(int *)(iVar11 + 0xa8);
    }
    if (iVar9 != 0) {
      return;
    }
    FUN_0002ddbc(iVar13 + 0xc,puVar12 + 5);
    return;
  }
  FUN_0002ddbc(iVar13 + 0xc,__src);
  *(undefined4 *)(iVar11 + 0xd8) = local_b0;
  *(undefined4 *)(iVar11 + 0xdc) = uStack_ac;
  *puVar12 = 2;
  puVar12[4] = puVar12 + 5;
  *(undefined1 *)(puVar12 + 5) = 0;
  strcpy(acStack_a8,(char *)__src);
  pcVar2 = strrchr((char *)__src,0x3e);
  if (pcVar2 == (char *)0x0) {
    iVar1 = 0;
  }
  else {
    iVar1 = (int)(pcVar2 + 1) - (int)__src;
    __src = (byte *)(pcVar2 + 1);
  }
  acStack_a8[iVar1] = '\0';
  if (*__src == 0x20 || *__src == 9) {
    do {
      __src = __src + 1;
    } while (*__src == 0x20 || *__src == 9);
  }
  pcVar2 = strrchr(acStack_a8,0x45);
  pcVar3 = strrchr(acStack_a8,0x73);
  if (pcVar3 < pcVar2) {
    if (DAT_0007cf4c != 0) {
      printf("hpgps: error indicated in prompt: %s\n",acStack_a8);
    }
    sVar4 = write(*(int *)(iVar11 + 0x14),"*CLS\r\r",6);
    if (sVar4 != 6) {
      FUN_00027040(iVar13,3);
    }
  }
  iVar1 = sscanf((char *)__src,"%c%c",&local_c1,&local_c0);
  if (iVar1 != 2) {
    if (DAT_0007cf4c != 0) {
      puts("hpgps: no format indicator");
    }
    goto LAB_00030548;
  }
  uVar6 = (uint)local_c1;
  if (uVar6 != 0x2d) {
    if (uVar6 == 0x54) {
      if (local_c0 == 0x32) {
        iVar8 = sscanf((char *)__src,"%*c%*c%4d%2d%2d%2d%2d%2d%c%c%c%c%c%2hx",iVar11 + 0xac,&local_b8,&local_b4,
                       iVar11 + 0xb4,iVar11 + 0xb8,iVar11 + 0xbc,&uStack_bf,&uStack_be,&local_bd,&uStack_bc,&local_bb,
                       &local_ba);
        iVar1 = local_b4;
        if (iVar8 == 0xc) {
          uVar6 = 0;
          pbVar15 = __src;
          do {
            pbVar14 = pbVar15 + 1;
            uVar10 = *pbVar15 + uVar6;
            uVar6 = uVar10 & 0xffff;
            pbVar15 = pbVar14;
          } while (pbVar14 != __src + 0x15);
          if ((uVar10 & 0xff) == (int)local_ba) {
            uVar6 = local_b8 - 1;
            if ((uVar6 < 0xc) && (0 < local_b4)) {
              uVar10 = *(uint *)(iVar11 + 0xac);
              if (((uVar10 & 3) == 0) &&
                 ((FUN_0005aa04(uVar10,100), extraout_r1 != 0 || (FUN_0005aa04(uVar10,400), extraout_r1_00 == 0)))) {
                if ((int)(&DAT_00066060)[uVar6] < iVar1) goto LAB_00030914;
                for (iVar8 = 0; iVar8 < (int)uVar6; iVar8 = iVar8 + 1) {
                  iVar1 = iVar1 + (&DAT_00066060)[iVar8];
                }
                iVar8 = 0x16e;
                local_b4 = iVar1;
              }
              else {
                if ((int)(&DAT_00066030)[uVar6] < iVar1) goto LAB_00030914;
                for (iVar8 = 0; iVar8 < (int)uVar6; iVar8 = iVar8 + 1) {
                  iVar1 = iVar1 + (&DAT_00066030)[iVar8];
                }
                iVar8 = 0x16d;
                local_b4 = iVar1;
              }
              iVar1 = *(int *)(iVar11 + 0xb8) - puVar12[2];
              iVar7 = puVar12[1];
              bVar16 = iVar1 < 0;
              *(int *)(iVar11 + 0xb8) = iVar1;
              iVar9 = *(int *)(iVar11 + 0xb4) - iVar7;
              if (bVar16) {
                iVar1 = iVar1 + 0x3c;
                iVar7 = iVar9 + -1;
              }
              *(int *)(iVar11 + 0xb4) = iVar9;
              if (bVar16) {
                *(int *)(iVar11 + 0xb8) = iVar1;
                *(int *)(iVar11 + 0xb4) = iVar7;
                iVar9 = iVar7;
              }
              if (0x3b < iVar1) {
                iVar9 = iVar9 + 1;
                *(int *)(iVar11 + 0xb4) = iVar9;
                *(int *)(iVar11 + 0xb8) = iVar1 + -0x3c;
              }
              if (iVar9 < 0) {
                local_b4 = local_b4 + -1;
                iVar9 = iVar9 + 0x18;
                *(int *)(iVar11 + 0xb4) = iVar9;
                if (local_b4 < 1) {
                  uVar10 = uVar10 - 1;
                  *(uint *)(iVar11 + 0xac) = uVar10;
                  if (((uVar10 & 3) == 0) &&
                     ((FUN_0005aa04(uVar10,100), extraout_r1_01 != 0 || (FUN_0005aa04(uVar10,400), extraout_r1_02 == 0))
                     )) {
                    iVar9 = *(int *)(iVar11 + 0xb4);
                    local_b4 = 0x16e;
                  }
                  else {
                    iVar9 = *(int *)(iVar11 + 0xb4);
                    local_b4 = 0x16d;
                  }
                }
              }
              if (0x17 < iVar9) {
                local_b4 = local_b4 + 1;
                *(int *)(iVar11 + 0xb4) = iVar9 + -0x18;
                if (iVar8 < local_b4) {
                  *(uint *)(iVar11 + 0xac) = uVar10 + 1;
                  local_b4 = 1;
                }
              }
              *(int *)(iVar11 + 0xb0) = local_b4;
              if (local_bb == '0') {
                *(undefined1 *)(iVar11 + 0x20) = 0;
                if (local_bd == '-') {
                  if (local_b8 == 6 || local_b8 == 0xc) {
                    *(undefined1 *)(iVar11 + 0x20) = 2;
                  }
                }
                else if (local_bd != '0') {
                  if (local_bd != '+') {
                    if (DAT_0007cf4c != 0) {
                      printf("hpgps: unrecognized leap indicator: %c\n");
                    }
                    goto LAB_00030914;
                  }
                  if (local_b8 == 6 || local_b8 == 0xc) {
                    *(bool *)(iVar11 + 0x20) = local_b8 == 6 || local_b8 == 0xc;
                  }
                }
              }
              else {
                *(undefined1 *)(iVar11 + 0x20) = 3;
              }
              iVar1 = FUN_00027698(iVar11);
              if (iVar1 != 0) {
                *(undefined4 *)(iVar11 + 0xd0) = *(undefined4 *)(iVar11 + 0xd8);
                *(undefined4 *)(iVar11 + 0xd4) = *(undefined4 *)(iVar11 + 0xdc);
                FUN_000276a0(iVar13);
                if ((*(byte *)(iVar11 + 0x2f0) & 8) == 0) {
                  return;
                }
                iVar1 = *(int *)(iVar11 + 0x14);
                puVar12[3] = 0x16;
                sVar4 = write(iVar1,":SYSTEM:PRINT?\r",0xf);
                if (sVar4 == 0xf) {
                  return;
                }
                FUN_00027040(iVar13,3);
                return;
              }
            }
LAB_00030914:
            FUN_00027040(iVar13,6);
            return;
          }
          if (DAT_0007cf4c != 0) {
            printf("hpgps: checksum %2hX doesn\'t match %2hX expected\n");
          }
        }
        else if (DAT_0007cf4c != 0) {
          printf("hpgps: only %d fields recognized in timecode\n",iVar8);
        }
      }
      else if (DAT_0007cf4c != 0) {
        printf("hpgps: unrecognized timecode format %c%c\n");
      }
      goto LAB_00030548;
    }
    if (uVar6 != 0x2b) {
      if (DAT_0007cf4c != 0) {
        printf("hpgps: unrecognized reply format %c%c\n",uVar6,(uint)local_c0);
      }
      goto LAB_00030548;
    }
  }
  iVar1 = sscanf((char *)__src,"%d,%d",puVar12 + 1,puVar12 + 2);
  if (iVar1 == 2) {
    if (((puVar12[1] + 0xc < 0x1a) && (iVar1 = puVar12[2], iVar1 + 0x3b < 0 == SCARRY4(iVar1,0x3b))) && (iVar1 < 0x3c))
    {
      return;
    }
    if (DAT_0007cf4c != 0) {
      printf("hpgps: timezone %d, %d out of range\n",puVar12[1],puVar12[2]);
    }
  }
  else if (DAT_0007cf4c != 0) {
    printf("hpgps: only %d fields recognized in timezone\n",iVar1);
  }
LAB_00030548:
  FUN_00027040(iVar13,2);
  return;
}




void FUN_00030a48(undefined4 param_1,int param_2)

{
  int iVar1;
  
  iVar1 = *(int *)(param_2 + 0x3c);
  if (*(int *)(iVar1 + 200) != *(int *)(iVar1 + 0xcc)) {
    FUN_000276a0();
    if ((*(byte *)(iVar1 + 0x2f0) & 8) == 0) {
      FUN_0002ddbc(param_2 + 0xc,iVar1 + 0x28);
      if (DAT_0007cf4c != 0) {
        printf("irig %s\n",iVar1 + 0x28);
      }
    }
    *(int *)(iVar1 + 0x2f8) = *(int *)(iVar1 + 0x2f8) + 1;
    return;
  }
  FUN_00027040(param_2,1);
  return;
}




undefined4 FUN_00030afc(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int __fd;
  void *__s;
  int iVar1;
  uint uVar2;
  double *pdVar3;
  int iVar4;
  double *pdVar5;
  double dVar6;
  double dVar7;
  
  __fd = FUN_0004d29c("/dev/audio",0x140,param_1,param_4,param_4);
  if (__fd < 0) {
    return 0;
  }
  if (DAT_0007cf4c != 0) {
    FUN_0004dbe8();
  }
  __s = (void *)FUN_0004f524(0xca0);
  memset(__s,0,0xca0);
  iVar4 = *(int *)(param_2 + 0x3c);
  *(void **)(iVar4 + 0x1c) = __s;
  *(int *)(iVar4 + 0xc) = param_2;
  *(int *)(iVar4 + 0x14) = __fd;
  *(undefined1 **)(iVar4 + 4) = &LAB_00031998;
  *(undefined4 *)(iVar4 + 0x10) = 0;
  iVar1 = FUN_00015fc4(iVar4);
  if (iVar1 != 0) {
    *(undefined1 *)(param_2 + 0x47) = 0xef;
    *(char **)(iVar4 + 0x24) = "Generic IRIG Audio Driver";
    *(undefined4 *)(iVar4 + 0x2ec) = 0x47495249;
    *(undefined4 *)((int)__s + 0x708) = 0;
    *(undefined4 *)((int)__s + 0x70c) = 0;
    *(undefined4 *)((int)__s + 0x308) = 0;
    *(undefined4 *)((int)__s + 0x30c) = 0;
    *(undefined4 *)((int)__s + 0x310) = 0;
    *(undefined4 *)((int)__s + 0x314) = 0x3ff00000;
    *(undefined4 *)((int)__s + 0xc6c) = 2;
    *(undefined4 *)((int)__s + 0xc58) = 1;
    *(undefined4 *)((int)__s + 0x710) = 0;
    *(undefined4 *)((int)__s + 0x714) = 0xbff00000;
    *(undefined4 *)((int)__s + 0x318) = 0;
    *(undefined4 *)((int)__s + 0x31c) = 0x40080000;
    *(undefined4 *)((int)__s + 0xb14) = 0x7f;
    *(undefined4 *)((int)__s + 0x718) = 0;
    *(undefined4 *)((int)__s + 0x71c) = 0xc0080000;
    *(undefined4 *)((int)__s + 800) = 0;
    *(undefined4 *)((int)__s + 0x324) = 0x40140000;
    pdVar5 = (double *)((int)__s + 0x328);
    uVar2 = 3;
    dVar7 = 2.0;
    pdVar3 = (double *)((int)__s + 0x728);
    *(undefined4 *)((int)__s + 0x720) = 0;
    *(undefined4 *)((int)__s + 0x724) = 0xc0140000;
    while (uVar2 = uVar2 + 1, uVar2 != 0x80) {
      dVar6 = dVar7 + pdVar5[-1];
      if ((uVar2 & 0xf) == 0) {
        dVar7 = dVar7 + dVar7;
      }
      *pdVar5 = dVar6;
      pdVar5 = pdVar5 + 1;
      *pdVar3 = -dVar6;
      pdVar3 = pdVar3 + 1;
    }
    *(undefined4 *)((int)__s + 0x20) = 0;
    *(undefined **)((int)__s + 0x24) = &DAT_00083126;
    return 1;
  }
  close(__fd);
  *(undefined4 *)(iVar4 + 0x14) = 0xffffffff;
  free(__s);
  *(undefined4 *)(iVar4 + 0x1c) = 0;
  return 0;
}




int FUN_00030cd4(int param_1,int param_2)

{
  char cVar1;
  size_t sVar2;
  int iVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  char *__s;
  int iVar9;
  int iVar10;
  int iVar11;
  char *__s_00;
  int iVar12;
  undefined8 uVar13;
  undefined1 auStack_58 [4];
  int local_54;
  undefined1 auStack_50 [12];
  
  iVar9 = *(int *)(param_1 + 0x3c);
  __s = *(char **)(iVar9 + 0x1c);
  iVar3 = *(int *)(__s + 0xc98);
  *(int *)(__s + 0xc98) = iVar3 >> 1;
  if (param_2 == 1) {
    iVar10 = *(int *)(__s + 0xc90);
    *(uint *)(__s + 0xc98) = iVar3 >> 1 | 0x200;
  }
  else if (param_2 == 2) {
    if (*(int *)(__s + 0xc84) == 2) {
      iVar10 = 1;
      __s[0xc84] = '\x02';
      __s[0xc85] = '\0';
      __s[0xc86] = '\0';
      __s[0xc87] = '\0';
      if (*(int *)(__s + 0xc90) != 1) {
        *(uint *)(__s + 0x300) = *(uint *)(__s + 0x300) | 8;
      }
      *(undefined4 *)(__s + 0x28) = *(undefined4 *)(__s + 0x38);
      *(undefined4 *)(__s + 0x2c) = *(undefined4 *)(__s + 0x3c);
      goto LAB_00030d7c;
    }
    iVar10 = *(int *)(__s + 0xc90);
  }
  else {
    iVar10 = *(int *)(__s + 0xc90);
  }
  *(int *)(__s + 0xc84) = param_2;
  if (iVar10 % 10 == 0) {
    uVar4 = *(uint *)(__s + 0xc98);
    iVar3 = *(int *)(__s + 0xc94);
    if (iVar10 == 10) {
      uVar4 = (int)uVar4 >> 1;
    }
    if (1 < iVar3) {
      *(int *)(__s + 0xc94) = iVar3 + -2;
      cVar1 = "0123456789abcdef"[(uVar4 << 0x17) >> 0x1c];
      __s[iVar3 + -1] = "0123456789abcdef"[uVar4 & 0xf];
      __s[iVar3 + -2] = cVar1;
    }
    if (iVar10 == 0) {
      __s[0xc94] = '\x14';
      __s[0xc95] = '\0';
      __s[0xc96] = '\0';
      __s[0xc97] = '\0';
      iVar10 = iVar9 + 0xbc;
      iVar3 = sscanf(__s,"%6s%2d%1d%2s%3d%2d%2d%2d",auStack_50,iVar9 + 0xac,&local_54,auStack_58,iVar9 + 0xb0,
                     iVar9 + 0xb4,iVar9 + 0xb8,iVar10);
      iVar12 = *(int *)(iVar9 + 0xb0);
      if (iVar3 == 8) {
        *(undefined1 *)(iVar9 + 0x20) = 0;
      }
      else {
        *(undefined1 *)(iVar9 + 0x20) = 3;
      }
      iVar3 = (*(int *)(__s + 0xc88) + *(int *)(__s + 0xc58)) % 0x3c;
      *(int *)(__s + 0xc88) = iVar3;
      if ((iVar12 == 0) || ((*(int *)(iVar9 + 0xac) != 0 && (local_54 == 0)))) {
        uVar4 = *(uint *)(__s + 0x300) | 0x80;
        *(uint *)(__s + 0x300) = uVar4;
      }
      else {
        uVar4 = *(uint *)(__s + 0x300);
      }
      iVar11 = *(int *)(iVar9 + 0xbc);
      if (iVar3 == iVar11) {
        *(int *)(__s + 0xc88) = iVar11;
        if ((uVar4 == 0) && (*(int *)(__s + 0xc6c) == 10)) {
          *(undefined4 *)(iVar9 + 0xd0) = *(undefined4 *)(iVar9 + 0xd8);
          *(undefined4 *)(iVar9 + 0xd4) = *(undefined4 *)(iVar9 + 0xdc);
          uVar5 = *(undefined4 *)(__s + 0x2c);
          *(undefined4 *)(iVar9 + 0xd8) = *(undefined4 *)(__s + 0x28);
          *(undefined4 *)(iVar9 + 0xdc) = uVar5;
          iVar3 = FUN_00027698(iVar9);
          if (iVar3 == 0) {
            FUN_00027040(param_1,6);
          }
          uVar4 = *(uint *)(__s + 0x300);
          iVar12 = *(int *)(iVar9 + 0xb0);
          iVar11 = *(int *)(iVar9 + 0xbc);
        }
      }
      else {
        uVar4 = uVar4 | 0x20;
        *(int *)(__s + 0xc88) = iVar11;
        *(uint *)(__s + 0x300) = uVar4;
      }
      uVar5 = *(undefined4 *)(iVar9 + 0xac);
      uVar13 = *(undefined8 *)(__s + 3000);
      uVar7 = *(undefined4 *)(iVar9 + 0xb4);
      uVar6 = *(undefined4 *)(iVar9 + 0xb8);
      __s_00 = (char *)(iVar9 + 0x28);
      uVar8 = *(undefined4 *)(__s + 0xb14);
      FUN_0004f124(*(undefined4 *)(iVar9 + 0xd8),*(undefined4 *)(iVar9 + 0xdc),0,6,0);
      snprintf(__s_00,0x80,"%02x %02d %03d %02d:%02d:%02d %4.0f %3d %6.3f %2d %6.2f %6.1f %s",uVar4,uVar5,iVar12,uVar7,
               uVar6,iVar11,iVar10,uVar13,uVar8);
      sVar2 = strlen(__s_00);
      *(size_t *)(iVar9 + 0xa8) = sVar2;
      __s[0x300] = '\0';
      __s[0x301] = '\0';
      __s[0x302] = '\0';
      __s[0x303] = '\0';
      if (((*(byte *)(iVar9 + 0x2f0) & 8) != 0) && (FUN_0002ddbc(param_1 + 0xc,__s_00), DAT_0007cf4c != 0)) {
        printf("irig %s\n",__s_00);
      }
      iVar10 = *(int *)(__s + 0xc90);
    }
  }
LAB_00030d7c:
  *(int *)(__s + 0xc90) = (iVar10 + 1) % 100;
  return (iVar10 + 1) * 0x51eb851f;
}




void FUN_00031724(int param_1)

{
  ulonglong uVar1;
  byte bVar2;
  int extraout_r1;
  undefined4 *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  undefined4 unaff_r4;
  int iVar7;
  int iVar8;
  undefined4 unaff_r5;
  uint uVar9;
  undefined4 unaff_r6;
  int iVar10;
  double *pdVar11;
  uint uVar12;
  bool bVar13;
  double in_d0;
  double dVar14;
  undefined8 unaff_d8;
  double dVar15;
  double dVar16;
  double dVar17;
  double dVar18;
  double dVar19;
  double dVar20;
  double dVar21;
  double dVar22;
  double dVar23;
  double dVar24;
  double dVar25;
  double dVar26;
  double dVar27;
  
  iVar7 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
  dVar19 = *(double *)(iVar7 + 0xb58);
  *(double *)(iVar7 + 0xb60) = dVar19;
  dVar21 = *(double *)(iVar7 + 0xb50);
  *(double *)(iVar7 + 0xb58) = dVar21;
  dVar23 = *(double *)(iVar7 + 0xb48);
  *(double *)(iVar7 + 0xb50) = dVar23;
  dVar24 = *(double *)(iVar7 + 0xb40);
  *(double *)(iVar7 + 0xb48) = dVar24;
  dVar25 = *(double *)(iVar7 + 0xb38);
  *(double *)(iVar7 + 0xb40) = dVar25;
  dVar26 = *(double *)(iVar7 + 0xb30);
  *(double *)(iVar7 + 0xb38) = dVar26;
  dVar27 = *(double *)(iVar7 + 0xb28);
  *(double *)(iVar7 + 0xb30) = dVar27;
  dVar15 = *(double *)(iVar7 + 0xb20);
  *(double *)(iVar7 + 0xb28) = dVar15;
  dVar18 = *(double *)(iVar7 + 0xb80);
  *(double *)(iVar7 + 0xb88) = dVar18;
  dVar20 = *(double *)(iVar7 + 0xb78);
  *(double *)(iVar7 + 0xb80) = dVar20;
  dVar22 = *(double *)(iVar7 + 0xb70);
  *(double *)(iVar7 + 0xb78) = dVar22;
  dVar16 = *(double *)(iVar7 + 0xb68);
  *(double *)(iVar7 + 0xb70) = dVar16;
  iVar10 = *(int *)(iVar7 + 0xc58);
  dVar14 = in_d0 - (dVar21 * -3.87518 + dVar19 * 0.6505491 + dVar23 * 11.5118 + dVar24 * -21.41264 + dVar25 * 27.12837 +
                    dVar26 * -23.84486 + dVar27 * 14.27663 + dVar15 * -5.352734);
  *(double *)(iVar7 + 0xb20) = dVar14;
  dVar17 = in_d0 - (dVar20 * -3.589893 + dVar18 * 0.8694604 + dVar22 * 5.570154 + dVar16 * -3.849667);
  *(double *)(iVar7 + 0xb68) = dVar17;
  dVar14 = dVar15 * -0.02055878 + dVar14 * 0.004952157 + dVar27 * 0.04401413 + dVar26 * -0.06558851 +
           dVar25 * 0.07462108 + dVar24 * -0.06558851 + dVar23 * 0.04401413 + dVar21 * -0.02055878 +
           dVar19 * 0.004952157;
  dVar15 = dVar16 * -0.01174951 + dVar17 * 0.003215696 + dVar22 * 0.01712074 + dVar20 * -0.01174951 +
           dVar18 * 0.003215696;
  *(double *)(iVar7 + 0x2f0) = *(double *)(iVar7 + 0x2f0) + dVar14 * dVar14;
  *(double *)(iVar7 + 0x2f8) = *(double *)(iVar7 + 0x2f8) + dVar15 * dVar15;
  FUN_0005aa04(*(int *)(iVar7 + 0xc74) + 1,iVar10);
  *(int *)(iVar7 + 0xc74) = extraout_r1;
  if (extraout_r1 != 0) {
    return;
  }
  if (iVar10 != 1) {
    dVar14 = dVar15;
  }
  iVar6 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
  iVar8 = *(int *)(iVar6 + 0xc6c);
  dVar15 = *(double *)(iVar6 + 0xc48);
  iVar10 = (*(int *)(iVar6 + 0xc5c) + 1) % 0x50;
  *(int *)(iVar6 + 0xc5c) = iVar10;
  pdVar11 = (double *)(iVar6 + (iVar10 + 8) * 8);
  dVar16 = *pdVar11;
  iVar7 = iVar10 % 8;
  *(double *)(iVar6 + (iVar7 + 0x179) * 8) = dVar14;
  dVar16 = dVar16 + (dVar14 - dVar16) / (double)(longlong)(iVar8 * 5);
  *(double *)(iVar6 + (iVar7 + 0x181) * 8) = dVar16;
  *pdVar11 = dVar16;
  if ((0.0 < dVar15) && (dVar16 <= 0.0)) {
    dVar14 = (double)FixedToFP(CONCAT44(iVar7 + -4,iVar7 + -4),0x20,0x40,3,0,0);
    *(double *)(iVar6 + 0x2d0) = *(double *)(iVar6 + 0x2d0) + dVar14;
  }
  *(double *)(iVar6 + 0xc48) = dVar16;
  if (iVar10 == 0) {
    dVar14 = *(double *)(iVar6 + 0xbb0);
    dVar15 = *(double *)(iVar6 + 0xba8);
    *(undefined4 *)(iVar6 + 0xbb0) = 0;
    *(undefined4 *)(iVar6 + 0xbb4) = 0xc12e8480;
    *(undefined4 *)(iVar6 + 0xba8) = 0;
    *(undefined4 *)(iVar6 + 0xbac) = 0x412e8480;
    uVar9 = *(uint *)(iVar6 + 0x300);
    *(double *)(iVar6 + 3000) = dVar14;
    *(double *)(iVar6 + 0xbc0) = dVar15;
    if (dVar14 < 100.0) {
      uVar9 = uVar9 | 1;
      *(uint *)(iVar6 + 0x300) = uVar9;
    }
    if (dVar14 <= 0.0) {
      *(undefined4 *)(iVar6 + 0x2e8) = 0;
      *(undefined4 *)(iVar6 + 0x2ec) = 0;
LAB_00031410:
      uVar9 = uVar9 | 4;
      *(uint *)(iVar6 + 0x300) = uVar9;
    }
    else {
      dVar14 = (dVar14 - dVar15) / dVar14;
      *(double *)(iVar6 + 0x2e8) = dVar14;
      if (dVar14 < 0.5) goto LAB_00031410;
    }
    if ((uVar9 & 0xf) == 0) {
      dVar15 = (double)(longlong)iVar8;
      dVar14 = dVar15 * dVar15 * 4.0;
    }
    else {
      dVar14 = 16.0;
      *(undefined4 *)(iVar6 + 0xc6c) = 2;
      *(undefined4 *)(iVar6 + 0xc70) = 0;
      dVar15 = 2.0;
    }
    dVar16 = *(double *)(iVar6 + 0x2d0);
    *(undefined4 *)(iVar6 + 0x2d0) = 0;
    *(undefined4 *)(iVar6 + 0x2d4) = 0;
    dVar16 = ((double)(longlong)*(int *)(iVar6 + 0xc58) * dVar16) / 80.0;
    *(double *)(iVar6 + 0x2d8) = dVar16;
    dVar14 = dVar16 / dVar14 + *(double *)(iVar6 + 0x2c8);
    *(double *)(iVar6 + 0x2c0) = *(double *)(iVar6 + 0x2c0) + dVar16 / dVar15;
    if (dVar14 <= 2.0) {
      *(double *)(iVar6 + 0x2c8) = dVar14;
      if (dVar14 < -2.0) {
        uVar9 = uVar9 | 2;
      }
      if (dVar14 < -2.0) {
        *(undefined8 *)(iVar6 + 0x2c8) = 0xc000000000000000;
        *(uint *)(iVar6 + 0x300) = uVar9;
      }
    }
    else {
      *(undefined8 *)(iVar6 + 0x2c8) = 0x4000000000000000;
      *(uint *)(iVar6 + 0x300) = uVar9 | 2;
    }
  }
  if (iVar7 != 7) {
    return;
  }
  uVar9 = *(int *)(iVar6 + 0xc7c) << 1;
  *(uint *)(iVar6 + 0xc7c) = uVar9;
  dVar14 = (*(double *)(iVar6 + 0xc18) - *(double *)(iVar6 + 0xc38)) * 0.5;
  if (*(double *)(iVar6 + 0xbb0) < dVar14) {
    *(double *)(iVar6 + 0xbb0) = dVar14;
  }
  if (dVar14 < *(double *)(iVar6 + 0xba8)) {
    *(double *)(iVar6 + 0xba8) = dVar14;
  }
  iVar7 = (*(int *)(iVar6 + 0xc78) + 1) % 10;
  *(int *)(iVar6 + 0xc78) = iVar7;
  bVar13 = (*(double *)(iVar6 + 3000) + *(double *)(iVar6 + 0xbc0)) * 0.5 <= dVar14;
  if (bVar13) {
    uVar9 = uVar9 | 1;
  }
  if (bVar13) {
    *(uint *)(iVar6 + 0xc7c) = uVar9;
  }
  if ((uVar9 & 0x303c0f03) == 0x300c0300) {
    if (iVar7 != 0) {
      *(uint *)(iVar6 + 0x300) = *(uint *)(iVar6 + 0x300) | 8;
    }
    iVar7 = 0;
    *(undefined4 *)(iVar6 + 0xc78) = 0;
  }
  uVar9 = *(int *)(iVar6 + 0xc80) << 1;
  *(uint *)(iVar6 + 0xc80) = uVar9;
  dVar14 = (*(double *)(iVar6 + 0xbd8) - *(double *)(iVar6 + 0xbf8)) * 0.5;
  if (*(double *)(iVar6 + 0xba0) <= dVar14) {
    *(uint *)(iVar6 + 0xc80) = uVar9 | 1;
  }
  switch(iVar7) {
  case 0:
    dVar16 = (double)(longlong)(*(int *)(iVar6 + 0xc68) - iVar10);
    dVar15 = -*(double *)(iVar6 + 0x2d8);
    *(double *)(iVar6 + 0x2e0) = dVar15;
    if (ABS(dVar16) <= 1.0) {
      iVar5 = *(int *)(iVar6 + 0xc6c);
      iVar8 = *(int *)(iVar6 + 0xc70) + 1;
      *(int *)(iVar6 + 0xc70) = iVar8;
      iVar7 = iVar5 * 0x14;
      bVar13 = iVar8 + iVar5 * -0x14 < 0;
      if (iVar8 == iVar7 || bVar13 != SBORROW4(iVar8,iVar7)) {
        dVar15 = dVar15 - dVar16;
      }
      if (iVar8 != iVar7 && bVar13 == SBORROW4(iVar8,iVar7)) {
        iVar5 = iVar5 + 1;
        if (10 < iVar5) {
          iVar5 = 10;
        }
        *(int *)(iVar6 + 0xc6c) = iVar5;
        goto LAB_000314a8;
      }
      *(double *)(iVar6 + 0x2e0) = dVar15;
    }
    else {
LAB_000314a8:
      *(int *)(iVar6 + 0xc68) = iVar10;
      *(undefined4 *)(iVar6 + 0xc70) = 0;
    }
    puVar3 = (undefined4 *)(iVar6 + 0x30);
    *(undefined4 *)(iVar6 + 0x38) = *puVar3;
    *(undefined4 *)(iVar6 + 0x3c) = *(undefined4 *)(iVar6 + 0x34);
    dVar15 = *(double *)(iVar6 + 0xc50) + (double)(longlong)*(int *)(iVar6 + 0xc58) * (dVar15 / 8000.0);
    if (dVar15 < 0.0) {
      uVar1 = (ulonglong)-dVar15;
      uVar9 = (uint)uVar1;
      dVar15 = (-dVar15 - (double)(uVar1 & 0xffffffff)) * 4294967296.0;
      iVar7 = (uint)(0.0 < dVar15) * (int)(longlong)dVar15;
      if (iVar7 != 0) {
        iVar7 = -iVar7;
        uVar9 = ~uVar9;
        goto LAB_0003150c;
      }
      uVar9 = -uVar9;
      *puVar3 = *(undefined4 *)(iVar6 + 0x18);
      *(undefined4 *)(iVar6 + 0x34) = *(undefined4 *)(iVar6 + 0x1c);
LAB_00031664:
      iVar7 = iVar6 + 0x18;
      *(uint *)(iVar6 + 0x30) = *(int *)(iVar6 + 0x30) - uVar9;
    }
    else {
      uVar9 = (uint)(longlong)dVar15;
      dVar15 = (dVar15 - (double)((longlong)dVar15 & 0xffffffff)) * 4294967296.0;
      iVar7 = (uint)(0.0 < dVar15) * (int)(longlong)dVar15;
LAB_0003150c:
      *puVar3 = *(undefined4 *)(iVar6 + 0x18);
      *(undefined4 *)(iVar6 + 0x34) = *(undefined4 *)(iVar6 + 0x1c);
      if (iVar7 == 0) goto LAB_00031664;
      uVar4 = (*(uint *)(iVar6 + 0x34) & 0xffff) + (-iVar7 & 0xffffU);
      uVar12 = (*(uint *)(iVar6 + 0x34) >> 0x10) + ((uint)-iVar7 >> 0x10);
      if ((uVar4 & 0x10000) != 0) {
        uVar12 = uVar12 + 1;
      }
      *(uint *)(iVar6 + 0x34) = uVar4 & 0xffff | uVar12 << 0x10;
      iVar7 = ~uVar9 + *(int *)(iVar6 + 0x30);
      if ((uVar12 & 0x10000) != 0) {
        iVar7 = iVar7 + 1;
      }
      *(int *)(iVar6 + 0x30) = iVar7;
    }
    bVar2 = *(byte *)(iVar6 + 0xc80);
    if (bVar2 == 0xe0) {
LAB_00031700:
      FUN_00030cd4(param_1,1,iVar7,bVar2,unaff_d8,unaff_r4,unaff_r5,unaff_r6);
    }
    else if (bVar2 < 0xe1) {
      if (bVar2 != 0x80) {
        if (bVar2 == 0xc0) goto LAB_00031700;
        if (bVar2 != 0) goto LAB_0003168c;
      }
      FUN_00030cd4(param_1,0,iVar7,bVar2,unaff_d8,unaff_r4,unaff_r5,unaff_r6);
    }
    else if (bVar2 == 0xf8) {
LAB_000316f0:
      FUN_00030cd4(param_1,2,iVar7,bVar2,unaff_d8,unaff_r4,unaff_r5,unaff_r6);
    }
    else {
      if (bVar2 < 0xf9) {
        if (bVar2 == 0xf0) goto LAB_00031700;
      }
      else if ((bVar2 == 0xfc) || (bVar2 == 0xfe)) goto LAB_000316f0;
LAB_0003168c:
      FUN_00030cd4(param_1,0,iVar7,bVar2,unaff_d8,unaff_r4,unaff_r5,unaff_r6);
      *(uint *)(iVar6 + 0x300) = *(uint *)(iVar6 + 0x300) | 0x10;
    }
    dVar15 = *(double *)(iVar6 + 0xb90);
    dVar16 = *(double *)(iVar6 + 0xb98);
    *(undefined4 *)(iVar6 + 0xb98) = 0;
    *(undefined4 *)(iVar6 + 0xb9c) = 0xc12e8480;
    if (dVar14 < dVar15) {
      dVar15 = dVar14;
    }
    *(undefined4 *)(iVar6 + 0xb90) = 0;
    *(undefined4 *)(iVar6 + 0xb94) = 0x412e8480;
    *(double *)(iVar6 + 0xba0) = (dVar15 + dVar16) * 0.5;
    break;
  case 1:
    *(double *)(iVar6 + 0xb98) = dVar14;
    break;
  case 2:
    pdVar11 = (double *)(iVar6 + 0xb98);
    if (dVar14 <= *(double *)(iVar6 + 0xb98)) {
      return;
    }
    goto LAB_00031420;
  case 9:
    pdVar11 = (double *)(iVar6 + 0xb90);
LAB_00031420:
    *pdVar11 = dVar14;
  }
  return;
}




void FUN_00031ff0(undefined4 param_1,int param_2)

{
  char cVar1;
  short sVar2;
  size_t sVar3;
  ssize_t sVar4;
  int iVar5;
  int iVar6;
  char *pcVar7;
  size_t __n;
  int iVar8;
  int iVar9;
  undefined1 local_1c;
  undefined1 local_1b;
  
  iVar8 = *(int *)(param_2 + 0x3c);
  iVar5 = *(int *)(iVar8 + 0x2f8);
  pcVar7 = *(char **)(iVar8 + 0x1c);
  if ((iVar5 != 0) && (*(int *)(pcVar7 + 0xc) == 0)) {
    FUN_00027040(param_2,1);
    iVar5 = *(int *)(iVar8 + 0x2f8);
  }
  if (DAT_0007cf4c != 0) {
    printf("jjy_poll (refclock_jjy.c) : %ld\n");
    iVar5 = *(int *)(iVar8 + 0x2f8);
  }
  *(int *)(iVar8 + 0x2f8) = iVar5 + 1;
  cVar1 = *pcVar7;
  pcVar7[0xc] = '\0';
  pcVar7[0xd] = '\0';
  pcVar7[0xe] = '\0';
  pcVar7[0xf] = '\0';
  pcVar7[8] = '\x01';
  pcVar7[0x10] = '\0';
  pcVar7[0x11] = '\0';
  pcVar7[0x12] = '\0';
  pcVar7[0x13] = '\0';
  pcVar7[0x54] = '\0';
  iVar5 = DAT_0007cf4c;
  pcVar7[0x55] = '\0';
  pcVar7[0x56] = '\0';
  pcVar7[0x57] = '\0';
  if (cVar1 == '\x02') {
    iVar5 = *(int *)(param_2 + 0x3c);
    if (DAT_0007cf4c != 0) {
      puts("jjy_poll_cdex_jst2000 (refclock_jjy.c) : send \'<ENQ>1J<ETX>\'");
    }
    sVar4 = write(*(int *)(iVar5 + 0x14),&DAT_000665c8,4);
    if (sVar4 != 4) {
      FUN_00027040(param_2,3);
    }
  }
  else if (cVar1 == '\x03') {
    iVar5 = *(int *)(param_2 + 0x3c);
    sVar2 = *(short *)(*(int *)(iVar5 + 0x1c) + 2);
    if (sVar2 == 1) {
      local_1c = 0x54;
    }
    else if (sVar2 == 2) {
      local_1c = 0x43;
    }
    local_1b = 0;
    if (DAT_0007cf4c != 0) {
      printf("jjy_poll_echokeisokuki_lt2000 (refclock_jjy.c) : send \'%s\'\n",&local_1c);
    }
    sVar4 = write(*(int *)(iVar5 + 0x14),&local_1c,1);
    if (sVar4 != 1) {
      FUN_00027040(param_2,3);
    }
  }
  else if (cVar1 == '\x01') {
    iVar8 = *(int *)(param_2 + 0x3c);
    iVar9 = *(int *)(iVar8 + 0x1c);
    if ((*(byte *)(iVar8 + 0x2f0) & 1) == 0) {
      iVar6 = 2;
      *(undefined4 *)(iVar9 + 0xc) = 2;
    }
    else {
      iVar6 = *(int *)(iVar9 + 0xc);
    }
    if (iVar5 != 0) {
      printf("%s (refclock_jjy.c) : flag1=%X CLK_FLAG1=%X up->linecount=%d\n","jjy_poll_tristate_jjy01",
             (uint)*(byte *)(iVar8 + 0x2f0),1,iVar6);
      if (DAT_0007cf4c == 0) {
        iVar6 = *(int *)(iVar9 + 0xc);
      }
      else {
        iVar5 = *(int *)(iVar9 + 0xc) * 0x10;
        printf("%s (refclock_jjy.c) : send \'%s\'\n","jjy_poll_tristate_jjy01",*(undefined4 *)(&DAT_0006639c + iVar5),
               &DAT_00066398 + iVar5,iVar6);
        iVar6 = *(int *)(iVar9 + 0xc);
      }
    }
    __n = *(size_t *)(&DAT_000663a4 + iVar6 * 0x10);
    sVar3 = write(*(int *)(iVar8 + 0x14),*(void **)(&DAT_000663a0 + iVar6 * 0x10),__n);
    if (__n != sVar3) {
      FUN_00027040(param_2,3);
    }
  }
  return;
}




void FUN_00032228(int param_1)

{
  undefined1 uVar1;
  short sVar2;
  char *pcVar3;
  int iVar4;
  size_t sVar5;
  char *pcVar6;
  ssize_t sVar7;
  ushort **ppuVar8;
  undefined4 uVar9;
  undefined4 uVar10;
  void *__buf;
  int iVar11;
  byte *pbVar12;
  undefined4 uVar13;
  int iVar14;
  undefined1 *puVar15;
  int iVar16;
  uint uVar17;
  uint uVar18;
  undefined1 *puVar19;
  int iVar20;
  char cVar21;
  char *pcVar22;
  size_t __n;
  int iVar23;
  int unaff_r9;
  int iVar24;
  bool bVar25;
  char *local_124;
  byte local_f9;
  int local_f8;
  undefined4 local_f4;
  undefined4 uStack_f0;
  byte local_ec [63];
  byte local_ad;
  char local_ac [63];
  undefined1 local_6d;
  
  iVar24 = *(int *)(param_1 + 8);
  iVar20 = *(int *)(iVar24 + 0x3c);
  puVar19 = *(undefined1 **)(iVar20 + 0x1c);
  iVar4 = FUN_00027aac(param_1,(char *)(iVar20 + 0x28),0x80,&local_f4);
  sVar2 = *(short *)(puVar19 + 6);
  *(int *)(iVar20 + 0xa8) = iVar4;
  if (sVar2 == 0x20) {
    iVar11 = *(int *)(puVar19 + 0x54);
    if (iVar4 == 0) {
      if (iVar11 == 0) {
        return;
      }
LAB_000323c0:
      if (0 < iVar11) goto LAB_000323c8;
LAB_00032438:
      bVar25 = false;
    }
    else {
      if ((iVar4 < 1) || (0x3d < iVar11)) goto LAB_000323c0;
      puVar15 = (undefined1 *)(iVar20 + 0x27);
      iVar14 = 0;
      iVar4 = iVar11;
      do {
        puVar15 = puVar15 + 1;
        uVar1 = *puVar15;
        iVar14 = iVar14 + 1;
        iVar11 = iVar4 + 1;
        *(int *)(puVar19 + 0x54) = iVar11;
        puVar19[iVar4 + 0x58] = uVar1;
        if (*(int *)(iVar20 + 0xa8) <= iVar14) goto LAB_000323c0;
        iVar4 = iVar11;
      } while (iVar11 < 0x3e);
LAB_000323c8:
      if ((byte)puVar19[0x58] < 0x20) {
        do {
          iVar11 = iVar11 + -1;
          if (iVar11 == 0) {
            *(undefined4 *)(puVar19 + 0x54) = 0;
            goto LAB_00032438;
          }
          iVar4 = 0;
          puVar15 = puVar19 + 0x58;
          do {
            iVar4 = iVar4 + 1;
            *puVar15 = puVar15[1];
            puVar15 = puVar15 + 1;
          } while (iVar4 != iVar11);
          *(int *)(puVar19 + 0x54) = iVar11;
        } while ((byte)puVar19[0x58] < 0x20);
      }
      pbVar12 = puVar19 + 0x58;
      iVar4 = 0;
      do {
        iVar4 = iVar4 + 1;
        if (iVar11 <= iVar4) goto LAB_00032438;
        pbVar12 = pbVar12 + 1;
      } while (0x1f < *pbVar12);
      bVar25 = true;
    }
    iVar4 = *(int *)(puVar19 + 0xc);
    if ((((0 < *(int *)(iVar20 + 0xa8)) && (iVar4 < *(int *)(puVar19 + 0x30))) && (!bVar25)) &&
       (iVar11 < *(int *)(puVar19 + iVar4 * 4 + 0x34))) {
      return;
    }
    puVar19[iVar11 + 0x58] = 0;
  }
  else {
    if (iVar4 == 0) {
      return;
    }
    iVar4 = *(int *)(puVar19 + 0xc);
  }
  iVar11 = *(int *)(puVar19 + 0x10);
  *(undefined4 *)(iVar20 + 0xd8) = local_f4;
  *(undefined4 *)(iVar20 + 0xdc) = uStack_f0;
  *(int *)(puVar19 + 0xc) = iVar4 + 1;
  if (iVar11 != 0) {
    return;
  }
  switch(*puVar19) {
  case 1:
    iVar4 = *(int *)(param_1 + 8);
    pcVar22 = *(char **)(iVar4 + 0x3c);
    iVar11 = *(int *)(pcVar22 + 0x1c);
    bVar25 = *(short *)(iVar11 + 6) == 0x20;
    pcVar6 = pcVar22;
    if (bVar25) {
      pcVar6 = (char *)(iVar11 + 0x58);
      local_124 = pcVar6;
    }
    pcVar3 = pcVar22;
    if (bVar25) {
      unaff_r9 = *(int *)(iVar11 + 0x54);
      pcVar3 = pcVar6;
    }
    if (!bVar25) {
      unaff_r9 = *(int *)(pcVar3 + 0xa8);
      local_124 = pcVar3 + 0x28;
    }
    switch((&DAT_00066398)[(*(int *)(iVar11 + 0xc) + -1) * 0x10]) {
    case 1:
      if (unaff_r9 != 0xe) goto switchD_00032630_default;
      iVar14 = sscanf(local_124,"%4d/%2d/%2d",iVar11 + 0x14,iVar11 + 0x18,iVar11 + 0x1c);
      if (((iVar14 != 3) || (*(int *)(iVar11 + 0x14) < 2000)) ||
         ((*(int *)(iVar11 + 0x18) < 1 ||
          (((0xc < *(int *)(iVar11 + 0x18) || (*(int *)(iVar11 + 0x1c) < 1)) || (0x1f < *(int *)(iVar11 + 0x1c))))))) {
LAB_0003294c:
        *(undefined4 *)(iVar11 + 0x10) = 1;
        bVar25 = false;
        goto LAB_00032908;
      }
      goto LAB_00032900;
    case 2:
    case 3:
      if (unaff_r9 != 8) goto switchD_00032630_default;
      iVar14 = sscanf(local_124,"%2d:%2d:%2d",iVar11 + 0x20,iVar11 + 0x24,iVar11 + 0x28);
      if ((((iVar14 != 3) || (0x17 < *(int *)(iVar11 + 0x20))) || (0x3b < *(int *)(iVar11 + 0x24))) ||
         (0x3c < *(int *)(iVar11 + 0x28))) goto LAB_0003294c;
      *(undefined4 *)(iVar11 + 0x2c) = 0;
      if ((*(int *)(iVar11 + 0x20) != 0) || (*(int *)(iVar11 + 0x24) != 0)) goto LAB_00032900;
      bVar25 = *(int *)(iVar11 + 0x28) < 3;
      goto LAB_00032908;
    case 4:
      if (unaff_r9 == 8) {
        iVar14 = strncmp(local_124,"adjusted\r\n",8);
      }
      else {
        if (unaff_r9 != 10) goto switchD_00032630_default;
        iVar14 = strncmp(local_124,"unadjusted\r\n",10);
      }
      break;
    case 5:
      if (unaff_r9 == 5) {
        iVar14 = strncmp(local_124,"valid\r\n",5);
      }
      else {
        if (unaff_r9 != 7) goto switchD_00032630_default;
        iVar14 = strncmp(local_124,"invalid\r\n",7);
      }
      break;
    default:
      goto switchD_00032630_default;
    }
    if (iVar14 == 0) {
LAB_00032900:
      bVar25 = false;
LAB_00032908:
      memcpy(local_ac,&PTR_s_<NUL>_000663e8,0x84);
LAB_000326a4:
      ppuVar8 = __ctype_b_loc();
      iVar16 = 0;
      iVar14 = 0;
      do {
        uVar18 = (uint)(byte)local_124[iVar16];
        if (((*ppuVar8)[uVar18] & 0x4000) == 0) {
          if (uVar18 < 0x21) {
            pcVar6 = *(char **)(local_ac + uVar18 * 4);
            sVar5 = strlen(pcVar6);
            iVar23 = iVar14 + sVar5;
            if (0x3e < iVar23) {
              if (iVar14 < 0x40) {
                pbVar12 = local_ec + iVar14;
              }
              else {
                pbVar12 = &local_ad;
              }
              goto LAB_00032b14;
            }
            strncpy((char *)(local_ec + iVar14),pcVar6,0x40 - iVar14);
          }
          else {
            if (0x39 < iVar14) {
              if (iVar14 < 0x40) {
                pbVar12 = local_ec + iVar14;
              }
              else {
                pbVar12 = &local_ad;
              }
              goto LAB_00032b14;
            }
            snprintf((char *)(local_ec + iVar14),0x40 - iVar14,"<x%X>",uVar18);
            iVar23 = iVar14 + 5;
          }
        }
        else {
          iVar23 = iVar14 + 1;
          if (iVar14 == 0x3f) {
            pbVar12 = &local_ad;
            goto LAB_00032b14;
          }
          local_ec[iVar14] = local_124[iVar16];
        }
        iVar16 = iVar16 + 1;
        iVar14 = iVar23;
      } while (iVar16 < unaff_r9 && iVar23 < 0x40);
      if (iVar23 < 0x40) {
        pbVar12 = local_ec + iVar23;
      }
      else {
        pbVar12 = &local_ad;
      }
LAB_00032b14:
      *pbVar12 = 0;
      iVar14 = *(int *)(iVar11 + 0xc);
      uVar9 = *(undefined4 *)("%02x %02d %03d %02d:%02d:%02d %4.0f %3d %6.3f %2d %6.2f %6.1f %s" + iVar14 * 0x10 + 0x38)
      ;
      if (*(int *)(iVar11 + 0x10) == 0) {
        if (bVar25) {
          snprintf(local_ac,0x40,"%d: %s -> %c: %s",iVar14,uVar9,0x53,local_ec);
          FUN_0002ddbc(iVar4 + 0xc,local_ac);
          cVar21 = '\0';
          break;
        }
LAB_00032b48:
        uVar10 = 0x4f;
        goto LAB_00032b60;
      }
      snprintf(local_ac,0x40,"%d: %s -> %c: %s",iVar14,uVar9,0x58,local_ec);
      FUN_0002ddbc(iVar4 + 0xc,local_ac);
      if ((*(int *)(iVar11 + 0x10) != 0) || (bVar25)) goto switchD_000322ac_default;
    }
    else {
switchD_00032630_default:
      *(undefined4 *)(iVar11 + 0x10) = 1;
      memcpy(local_ac,&PTR_s_<NUL>_000663e8,0x84);
      if (0 < unaff_r9) {
        bVar25 = false;
        goto LAB_000326a4;
      }
      iVar14 = *(int *)(iVar11 + 0xc);
      local_ec[0] = 0;
      uVar9 = *(undefined4 *)("%02x %02d %03d %02d:%02d:%02d %4.0f %3d %6.3f %2d %6.2f %6.1f %s" + iVar14 * 0x10 + 0x38)
      ;
      if (*(int *)(iVar11 + 0x10) == 0) goto LAB_00032b48;
      uVar10 = 0x58;
LAB_00032b60:
      snprintf(local_ac,0x40,"%d: %s -> %c: %s",iVar14,uVar9,uVar10,local_ec);
      FUN_0002ddbc(iVar4 + 0xc,local_ac);
      if (*(int *)(iVar11 + 0x10) != 0) goto switchD_000322ac_default;
    }
    iVar14 = *(int *)(iVar11 + 0xc) * 0x10;
    __buf = *(void **)(&DAT_000663a0 + iVar14);
    if (__buf != (void *)0x0) {
      if (DAT_0007cf4c != 0) {
        printf("%s (refclock_jjy.c) : send \'%s\'\n","jjy_receive_tristate_jjy01",
               *(undefined4 *)(&DAT_0006639c + iVar14));
        iVar14 = *(int *)(iVar11 + 0xc) * 0x10;
        __buf = *(void **)(&DAT_000663a0 + iVar14);
      }
      __n = *(size_t *)(&DAT_000663a4 + iVar14);
      sVar5 = write(*(int *)(pcVar22 + 0x14),__buf,__n);
      if (__n != sVar5) {
        FUN_00027040(iVar4,3);
        cVar21 = '\0';
        break;
      }
      goto switchD_000322ac_default;
    }
LAB_00032e04:
    cVar21 = '\x01';
    break;
  case 2:
    iVar4 = *(int *)(*(int *)(param_1 + 8) + 0x3c);
    iVar11 = *(int *)(iVar4 + 0x1c);
    bVar25 = *(short *)(iVar11 + 6) != 0x20;
    if (bVar25) {
      pcVar6 = (char *)(iVar4 + 0x28);
      iVar4 = *(int *)(iVar4 + 0xa8);
    }
    else {
      pcVar6 = (char *)(iVar11 + 0x58);
      iVar4 = 0x20;
    }
    if (!bVar25) {
      iVar4 = *(int *)(iVar11 + 0x54);
    }
    if (*(int *)(iVar11 + 0xc) == 1) {
      if (iVar4 == 0xf) {
        iVar4 = sscanf(pcVar6,"J%2d%2d%2d%*1d%2d%2d%2d%1d",iVar11 + 0x14,iVar11 + 0x18,iVar11 + 0x1c,iVar11 + 0x20,
                       iVar11 + 0x24,iVar11 + 0x28,iVar11 + 0x2c);
        if ((((iVar4 == 7) && (0 < *(int *)(iVar11 + 0x18))) && (*(int *)(iVar11 + 0x18) < 0xd)) &&
           (((0 < *(int *)(iVar11 + 0x1c) && (*(int *)(iVar11 + 0x1c) < 0x20)) &&
            ((*(int *)(iVar11 + 0x20) < 0x18 && ((*(int *)(iVar11 + 0x24) < 0x3c && (*(int *)(iVar11 + 0x28) < 0x3d)))))
            ))) {
          cVar21 = '\x01';
          *(int *)(iVar11 + 0x14) = *(int *)(iVar11 + 0x14) + 2000;
          *(int *)(iVar11 + 0x2c) = *(int *)(iVar11 + 0x2c) * 100;
          break;
        }
        if (1 < DAT_0007cf4c) {
          printf("%s (refclock_jjy.c) : Time error (rc=%d) [ %02d %02d %02d * %02d %02d %02d.%1d ]\n",
                 "jjy_receive_cdex_jst2000",iVar4,*(undefined4 *)(iVar11 + 0x14),*(undefined4 *)(iVar11 + 0x18),
                 *(undefined4 *)(iVar11 + 0x1c),*(undefined4 *)(iVar11 + 0x20),*(undefined4 *)(iVar11 + 0x24),
                 *(undefined4 *)(iVar11 + 0x28),*(undefined4 *)(iVar11 + 0x2c));
        }
      }
      else if (1 < DAT_0007cf4c) {
        printf("%s (refclock_jjy.c) : Reply length error ( iLen=%d )\n","jjy_receive_cdex_jst2000");
      }
    }
    goto LAB_000325d0;
  case 3:
    iVar14 = *(int *)(param_1 + 8);
    iVar11 = *(int *)(iVar14 + 0x3c);
    iVar4 = *(int *)(iVar11 + 0x1c);
    if (*(short *)(iVar4 + 6) == 0x20) {
      pcVar6 = (char *)(iVar4 + 0x58);
      iVar16 = *(int *)(iVar4 + 0x54);
    }
    else {
      pcVar6 = (char *)(iVar11 + 0x28);
      iVar16 = *(int *)(iVar11 + 0xa8);
    }
    if (*(int *)(iVar4 + 0xc) == 1) {
      if (*(short *)(iVar4 + 2) == 1) {
        if (iVar16 != 0xf) goto LAB_000329ec;
        uVar17 = 0;
        uVar18 = uVar17;
        do {
          pbVar12 = (byte *)(pcVar6 + uVar17);
          uVar17 = uVar17 + 1;
          uVar18 = uVar18 ^ *pbVar12;
        } while (uVar17 != 0xd);
        uVar17 = (int)uVar18 >> 4 | 0x30;
        uVar18 = uVar18 & 0xf | 0x30;
        if ((uVar17 == (byte)pcVar6[0xd]) && (uVar18 == (byte)pcVar6[0xe])) goto LAB_00032a6c;
        if (1 < DAT_0007cf4c) {
          printf("%s (refclock_jjy.c) : BCC error ( Recv=%02X,%02X / Calc=%02X,%02X)\n",
                 "jjy_receive_echokeisokuki_lt2000",(uint)(byte)pcVar6[0xd],(uint)(byte)pcVar6[0xe],uVar17,uVar18);
        }
        goto LAB_00032590;
      }
      if ((*(short *)(iVar4 + 2) == 2) && (iVar16 != 0x11)) {
LAB_000329ec:
        if (1 < DAT_0007cf4c) {
          printf("%s (refclock_jjy.c) : Reply length error ( iLen=%d )\n","jjy_receive_echokeisokuki_lt2000");
        }
        if (*(short *)(iVar4 + 2) == 1) goto joined_r0x00032a1c;
        goto LAB_00032590;
      }
LAB_00032a6c:
      iVar16 = sscanf(pcVar6,"%2d%2d%2d%*1d%2d%2d%2d",iVar4 + 0x14,iVar4 + 0x18,iVar4 + 0x1c,iVar4 + 0x20,iVar4 + 0x24,
                      iVar4 + 0x28);
      if ((((iVar16 != 6) || (*(int *)(iVar4 + 0x18) < 1)) || (0xc < *(int *)(iVar4 + 0x18))) ||
         (((*(int *)(iVar4 + 0x1c) < 1 || (0x1f < *(int *)(iVar4 + 0x1c))) ||
          ((0x17 < *(int *)(iVar4 + 0x20) || ((0x3b < *(int *)(iVar4 + 0x24) || (0x3c < *(int *)(iVar4 + 0x28))))))))) {
        if (1 < DAT_0007cf4c) {
          printf("%s (refclock_jjy.c) : Time error (rc=%d) [ %02d %02d %02d * %02d %02d %02d ]\n",
                 "jjy_receive_echokeisokuki_lt2000",iVar16,*(undefined4 *)(iVar4 + 0x14),*(undefined4 *)(iVar4 + 0x18),
                 *(undefined4 *)(iVar4 + 0x1c),*(undefined4 *)(iVar4 + 0x20),*(undefined4 *)(iVar4 + 0x24),
                 *(undefined4 *)(iVar4 + 0x28));
        }
        goto LAB_00032590;
      }
      *(int *)(iVar4 + 0x14) = *(int *)(iVar4 + 0x14) + 2000;
      if (*(short *)(iVar4 + 2) == 2) {
        iVar16 = *(int *)(iVar11 + 0xbc);
        *(undefined4 *)(iVar4 + 0x2c) = 500;
        iVar16 = iVar16 + -1;
        *(int *)(iVar11 + 0xbc) = iVar16;
        if (iVar16 < 0) {
          *(undefined4 *)(iVar11 + 0xbc) = 0x3b;
          iVar4 = *(int *)(iVar11 + 0xb8) + -1;
          *(int *)(iVar11 + 0xb8) = iVar4;
          if (iVar4 < 0) {
            *(undefined4 *)(iVar11 + 0xb8) = 0x3b;
            iVar4 = *(int *)(iVar11 + 0xb4) + -1;
            *(int *)(iVar11 + 0xb4) = iVar4;
            if (iVar4 < 0) {
              *(undefined4 *)(iVar11 + 0xb4) = 0x17;
              iVar4 = *(int *)(iVar11 + 0xb0) + -1;
              *(int *)(iVar11 + 0xb0) = iVar4;
              if (iVar4 < 1) {
                iVar4 = *(int *)(iVar11 + 0xac) + -1;
                *(int *)(iVar11 + 0xac) = iVar4;
                uVar9 = FUN_000513cc(iVar4,0xc,0x1f);
                *(undefined4 *)(iVar11 + 0xb0) = uVar9;
              }
            }
          }
        }
        if (DAT_0007cf4c != 0) {
          printf("%s (refclock_jjy.c) : send \'#\'\n","jjy_receive_echokeisokuki_lt2000");
        }
        sVar7 = write(*(int *)(iVar11 + 0x14),&DAT_00066794,1);
        if (sVar7 != 1) {
          FUN_00027040(iVar14,3);
        }
      }
      goto LAB_00032e04;
    }
joined_r0x00032a1c:
    if (DAT_0007cf4c != 0) {
      printf("%s (refclock_jjy.c) : send \'#\'\n","jjy_receive_echokeisokuki_lt2000");
    }
    sVar7 = write(*(int *)(iVar11 + 0x14),&DAT_00066794,1);
    if (sVar7 != 1) {
      FUN_00027040(iVar14,3);
    }
LAB_00032590:
    cVar21 = '\x01';
    *(undefined4 *)(iVar4 + 0x10) = 1;
    break;
  case 4:
    iVar4 = *(int *)(*(int *)(param_1 + 8) + 0x3c);
    iVar11 = *(int *)(iVar4 + 0x1c);
    cVar21 = *(char *)(iVar11 + 8);
    if (*(short *)(iVar11 + 6) == 0x20) {
      pcVar6 = (char *)(iVar11 + 0x58);
      iVar4 = *(int *)(iVar11 + 0x54);
    }
    else {
      pcVar6 = (char *)(iVar4 + 0x28);
      iVar4 = *(int *)(iVar4 + 0xa8);
    }
    if (cVar21 == '\0') break;
    if (*(int *)(iVar11 + 0xc) == 1) {
      if (iVar4 == 0x17) {
        iVar4 = sscanf(pcVar6,"%c%2s %2d/%2d/%2d %1d %2d:%2d:%2d",&local_f9,local_ac,iVar11 + 0x14,iVar11 + 0x18,
                       iVar11 + 0x1c,&local_f8,iVar11 + 0x20,iVar11 + 0x24,iVar11 + 0x28);
        local_ac[2] = 0;
        if (((((iVar4 == 9) && (local_f9 == 0x27)) &&
             ((local_ac[0] == 'O' && ((local_ac[1] == 'K' && (0 < *(int *)(iVar11 + 0x18))))))) &&
            (*(int *)(iVar11 + 0x18) < 0xd)) &&
           (((((0 < *(int *)(iVar11 + 0x1c) && (*(int *)(iVar11 + 0x1c) < 0x20)) && (local_f8 < 7)) &&
             ((*(int *)(iVar11 + 0x20) < 0x18 && (*(int *)(iVar11 + 0x24) < 0x3c)))) && (*(int *)(iVar11 + 0x28) < 0x3d)
            ))) {
          cVar21 = '\x01';
          *(undefined4 *)(iVar11 + 0x2c) = 0;
          *(int *)(iVar11 + 0x14) = *(int *)(iVar11 + 0x14) + 2000;
          break;
        }
        if (1 < DAT_0007cf4c) {
          printf("%s (refclock_jjy.c) : Time error (rc=%d) [ %c %2s %02d %02d %02d %d %02d %02d %02d ]\n",
                 "jjy_receive_citizentic_jjy200",iVar4,(uint)local_f9,local_ac,*(undefined4 *)(iVar11 + 0x14),
                 *(undefined4 *)(iVar11 + 0x18),*(undefined4 *)(iVar11 + 0x1c),local_f8,*(undefined4 *)(iVar11 + 0x20),
                 *(undefined4 *)(iVar11 + 0x24),*(undefined4 *)(iVar11 + 0x28));
        }
      }
      else if (1 < DAT_0007cf4c) {
        printf("%s (refclock_jjy.c) : Reply length error ( iLen=%d )\n","jjy_receive_citizentic_jjy200");
      }
    }
LAB_000325d0:
    cVar21 = '\x01';
    *(undefined4 *)(iVar11 + 0x10) = 1;
    break;
  default:
switchD_000322ac_default:
    cVar21 = '\0';
  }
  if (*(short *)(puVar19 + 6) == 0x20) {
    if (*(int *)(puVar19 + 0xc) <= *(int *)(puVar19 + 0x30)) {
      iVar4 = *(int *)(puVar19 + *(int *)(puVar19 + 0xc) * 4 + 0x30);
      if (iVar4 < *(int *)(puVar19 + 0x54)) {
        iVar11 = *(int *)(puVar19 + 0x54) - iVar4;
        if (0 < iVar11) {
          puVar15 = puVar19;
          do {
            puVar15[0x58] = puVar15[iVar4 + 0x58];
            puVar15 = puVar15 + 1;
          } while (puVar15 != puVar19 + iVar11);
        }
        *(int *)(puVar19 + 0x54) = iVar11;
        goto LAB_00032320;
      }
    }
    *(undefined4 *)(puVar19 + 0x54) = 0;
  }
LAB_00032320:
  if (cVar21 != '\0') {
    puVar19[8] = 0;
    if (*(int *)(puVar19 + 0x10) == 0) {
      uVar9 = *(undefined4 *)(puVar19 + 0x14);
      uVar10 = *(undefined4 *)(puVar19 + 0x18);
      uVar13 = *(undefined4 *)(puVar19 + 0x1c);
      *(undefined4 *)(iVar20 + 0xac) = uVar9;
      iVar4 = FUN_000513cc(uVar9,uVar10,uVar13);
      iVar11 = *(int *)(puVar19 + 0x2c);
      iVar14 = *(int *)(puVar19 + 0x20);
      uVar10 = *(undefined4 *)(puVar19 + 0x24);
      uVar9 = *(undefined4 *)(puVar19 + 0x28);
      iVar16 = iVar14 + -9;
      *(int *)(iVar20 + 0xb4) = iVar16;
      *(undefined4 *)(iVar20 + 0xb8) = uVar10;
      *(undefined4 *)(iVar20 + 0xbc) = uVar9;
      *(int *)(iVar20 + 0xc0) = iVar11 * 1000000;
      *(int *)(iVar20 + 0xb0) = iVar4;
      if (iVar16 < 0) {
        *(int *)(iVar20 + 0xb0) = iVar4 + -1;
        *(int *)(iVar20 + 0xb4) = iVar14 + 0xf;
        if (iVar4 + -1 < 1) {
          iVar4 = *(int *)(iVar20 + 0xac) + -1;
          *(int *)(iVar20 + 0xac) = iVar4;
          uVar9 = FUN_000513cc(iVar4,0xc,0x1f);
          *(undefined4 *)(iVar20 + 0xb0) = uVar9;
        }
      }
      if (DAT_0007cf4c != 0) {
        printf("jjy_receive (refclock_jjy.c) : %04d/%02d/%02d %02d:%02d:%02d.%1d JST   ",*(undefined4 *)(puVar19 + 0x14)
               ,*(undefined4 *)(puVar19 + 0x18),*(undefined4 *)(puVar19 + 0x1c),*(undefined4 *)(puVar19 + 0x20),
               *(undefined4 *)(puVar19 + 0x24),*(undefined4 *)(puVar19 + 0x28),*(int *)(puVar19 + 0x2c) / 100);
        printf("( %04d/%03d %02d:%02d:%02d.%1d UTC )\n",*(undefined4 *)(iVar20 + 0xac),*(undefined4 *)(iVar20 + 0xb0),
               *(undefined4 *)(iVar20 + 0xb4),*(undefined4 *)(iVar20 + 0xb8),*(undefined4 *)(iVar20 + 0xbc),
               *(int *)(iVar20 + 0xc0) / 100000000);
      }
      snprintf(local_ac,0x40,"%04d/%02d/%02d %02d:%02d:%02d.%1d JST",*(undefined4 *)(puVar19 + 0x14),
               *(undefined4 *)(puVar19 + 0x18),*(undefined4 *)(puVar19 + 0x1c),*(undefined4 *)(puVar19 + 0x20),
               *(undefined4 *)(puVar19 + 0x24),*(undefined4 *)(puVar19 + 0x28),*(int *)(puVar19 + 0x2c) / 100);
      FUN_0002ddbc(iVar24 + 0xc,local_ac);
      iVar4 = FUN_00027698(iVar20);
      if (iVar4 == 0) {
        FUN_00027040(iVar24,6);
      }
      else {
        *(undefined4 *)(iVar20 + 0xd0) = *(undefined4 *)(iVar20 + 0xd8);
        *(undefined4 *)(iVar20 + 0xd4) = *(undefined4 *)(iVar20 + 0xdc);
        FUN_000276a0(iVar24);
      }
    }
    else {
      FUN_00027040(iVar24,2);
      strncpy(local_ac,"BAD REPLY [",0x40);
      if (*(short *)(puVar19 + 6) == 0x20) {
        sVar5 = strlen(local_ac);
        strncat(local_ac,puVar19 + 0x58,0x3f - sVar5);
      }
      else {
        sVar5 = strlen(local_ac);
        strncat(local_ac,(char *)(iVar20 + 0x28),0x3f - sVar5);
      }
      local_6d = 0;
      sVar5 = strlen(local_ac);
      if (sVar5 < 0x3e) {
        strncat(local_ac,"]",0x3f - sVar5);
      }
      FUN_0002ddbc(iVar24 + 0xc,local_ac);
    }
  }
  return;
}




void FUN_00033308(void)

{
  memset(&DAT_000800bc,0,0x68);
  DAT_00080124 = 0;
  DAT_00080128 = 0x4d4f5441;
  return;
}




bool FUN_00033340(int param_1,int param_2)

{
  byte bVar1;
  short sVar2;
  short sVar3;
  short sVar4;
  
  if (((((((*(byte *)(param_1 + 0x5c) - 0x30 < 10) && (bVar1 = *(byte *)(param_1 + 0x5d), 0x2f < bVar1)) &&
         (bVar1 < 0x3a)) && ((0x2f < *(byte *)(param_1 + 0x5e) && (*(byte *)(param_1 + 0x5e) < 0x3a)))) &&
       ((0x2f < *(byte *)(param_1 + 0x5f) && ((*(byte *)(param_1 + 0x5f) < 0x3a && (0x2f < *(byte *)(param_1 + 0x60)))))
       )) && (*(byte *)(param_1 + 0x60) < 0x3a)) &&
     ((0x2f < *(byte *)(param_1 + 0x61) && (*(byte *)(param_1 + 0x61) < 0x3a)))) {
    sVar2 = (bVar1 - 0x210) + (ushort)*(byte *)(param_1 + 0x5c) * 10;
    *(short *)(param_2 + 0x2a) = sVar2;
    sVar4 = (*(byte *)(param_1 + 0x5f) - 0x210) + (ushort)*(byte *)(param_1 + 0x5e) * 10;
    *(short *)(param_2 + 0x2e) = sVar4;
    sVar3 = (*(byte *)(param_1 + 0x61) - 0x210) + (ushort)*(byte *)(param_1 + 0x60) * 10;
    *(short *)(param_2 + 0x2c) = sVar3;
    if ((sVar2 < 0x18) && (sVar4 < 0x3d)) {
      return sVar3 < 0x3d;
    }
  }
  return false;
}




void FUN_00033434(int param_1)

{
  short sVar1;
  int iVar2;
  ssize_t sVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int extraout_r1;
  int extraout_r1_00;
  uint uVar6;
  short sVar7;
  int iVar8;
  undefined4 *puVar9;
  
  puVar9 = *(undefined4 **)(param_1 + 8);
  if (DAT_0007cf4c != 0) {
    fprintf(stderr,"leitch_recieve(%*.*s)\n",*(undefined4 *)(param_1 + 0x58),*(undefined4 *)(param_1 + 0x58),
            param_1 + 0x5c);
  }
  if (*(int *)(param_1 + 0x58) != 7) {
    return;
  }
  switch((int)*(short *)(puVar9 + 0xc)) {
  case 0:
    goto switchD_00033470_caseD_0;
  case 1:
    if ((((((*(byte *)(param_1 + 0x5c) - 0x30 < 10) && (uVar6 = (uint)*(byte *)(param_1 + 0x5d), 0x2f < uVar6)) &&
          (uVar6 < 0x3a)) && ((0x2f < *(byte *)(param_1 + 0x5e) && (*(byte *)(param_1 + 0x5e) < 0x3a)))) &&
        ((0x2f < *(byte *)(param_1 + 0x5f) && ((*(byte *)(param_1 + 0x5f) < 0x3a && (0x2f < *(byte *)(param_1 + 0x60))))
         ))) && ((*(byte *)(param_1 + 0x60) < 0x3a &&
                 ((0x2f < *(byte *)(param_1 + 0x61) && (*(byte *)(param_1 + 0x61) < 0x3a)))))) {
      uVar6 = (uint)*(byte *)(param_1 + 0x5c) * 10 + (uVar6 - 0x210);
      sVar1 = (short)uVar6;
      *(short *)((int)puVar9 + 0x22) = sVar1;
      sVar7 = (ushort)*(byte *)(param_1 + 0x5e) * 10 + (*(byte *)(param_1 + 0x5f) - 0x210);
      *(short *)((int)puVar9 + 0x26) = sVar7;
      iVar2 = (int)sVar7;
      sVar7 = (ushort)*(byte *)(param_1 + 0x60) * 10 + (*(byte *)(param_1 + 0x61) - 0x210);
      *(short *)(puVar9 + 10) = sVar7;
      if ((iVar2 < 0xd) && (sVar7 <= (short)(ushort)(byte)(&DAT_00066abf)[iVar2])) {
        *(short *)(puVar9 + 9) = sVar7;
        for (iVar8 = 0; iVar8 < iVar2 + -1; iVar8 = iVar8 + 1) {
          *(ushort *)(puVar9 + 9) = (ushort)(byte)(&DAT_00066ac0)[iVar8] + *(short *)(puVar9 + 9);
        }
        if (sVar1 < 0x5b) {
          iVar8 = 2000;
        }
        else {
          iVar8 = 0x76c;
        }
        uVar6 = (uVar6 & 0xffff) + iVar8;
        if ((((uVar6 & 3) != 0) ||
            ((FUN_0005aa04(uVar6,100), extraout_r1 == 0 && (FUN_0005aa04(uVar6,400), extraout_r1_00 != 0)))) &&
           (2 < iVar2)) {
          *(short *)(puVar9 + 9) = *(short *)(puVar9 + 9) + -1;
        }
        if (DAT_0007cf4c != 0) {
          fprintf(stderr,"write leitch %s\n",&DAT_00066b00);
        }
        sVar3 = write(puVar9[6],&DAT_00066b00,3);
        if (sVar3 < 0) {
          if (DAT_0007cf4c == 0) {
            FUN_0004fe78(3,"leitch_send: unit %d send failed %m",*(undefined1 *)(puVar9 + 8));
          }
          else {
            fprintf(stderr,"leitch_send: unit %d send failed\n",(uint)*(byte *)(puVar9 + 8));
          }
        }
        if (DAT_0007cf4c != 0) {
          fprintf(stderr,"%u\n",(int)*(short *)(puVar9 + 9));
        }
        *(undefined2 *)(puVar9 + 0xc) = 2;
        return;
      }
    }
    *(undefined2 *)(puVar9 + 0xc) = 0;
    return;
  case 2:
    FUN_00033340(param_1,puVar9);
    iVar2 = FUN_0004efc8((int)*(short *)(puVar9 + 9),(int)*(short *)((int)puVar9 + 0x2a),
                         (int)*(short *)((int)puVar9 + 0x2e),(int)*(short *)(puVar9 + 0xb),1,
                         *(undefined4 *)(param_1 + 0x4c),puVar9 + 0x19,puVar9 + 0xd);
    iVar8 = DAT_0007cf4c;
    if (iVar2 != 0) {
      puVar9[0xe] = 0;
      if (iVar8 != 0) {
        fprintf(stderr,"%lu\n",puVar9[0xd]);
      }
      puVar9[0xe] = *(int *)(&DAT_0007bd68 + (((uint)*(ushort *)((int)puVar9 + 0x32) << 0x16) >> 0x1b) * 4) +
                    *(int *)(&DAT_0007bde8 + (*(ushort *)((int)puVar9 + 0x32) & 0x1f) * 4);
      uVar4 = *(undefined4 *)(param_1 + 0x4c);
      uVar5 = *(undefined4 *)(param_1 + 0x50);
      *(undefined2 *)(puVar9 + 0xc) = 3;
      puVar9[0x13] = uVar4;
      puVar9[0x14] = uVar5;
      return;
    }
    break;
  case 3:
    FUN_00033340(param_1,puVar9);
    iVar2 = FUN_0004efc8((int)*(short *)(puVar9 + 9),(int)*(short *)((int)puVar9 + 0x2a),
                         (int)*(short *)((int)puVar9 + 0x2e),(int)*(short *)(puVar9 + 0xb),1,
                         *(undefined4 *)(param_1 + 0x4c),puVar9 + 0x19,puVar9 + 0xf);
    if (iVar2 != 0) {
      if (DAT_0007cf4c != 0) {
        fprintf(stderr,"%lu\n",puVar9[0xf]);
      }
      puVar9[0x10] = *(int *)(&DAT_0007bd68 + (((uint)*(ushort *)((int)puVar9 + 0x32) << 0x16) >> 0x1b) * 4) +
                     *(int *)(&DAT_0007bde8 + (*(ushort *)((int)puVar9 + 0x32) & 0x1f) * 4);
      uVar4 = *(undefined4 *)(param_1 + 0x4c);
      uVar5 = *(undefined4 *)(param_1 + 0x50);
      *(undefined2 *)(puVar9 + 0xc) = 4;
      puVar9[0x15] = uVar4;
      puVar9[0x16] = uVar5;
      return;
    }
    break;
  case 4:
    FUN_00033340(param_1,puVar9);
    iVar2 = FUN_0004efc8((int)*(short *)(puVar9 + 9),(int)*(short *)((int)puVar9 + 0x2a),
                         (int)*(short *)((int)puVar9 + 0x2e),(int)*(short *)(puVar9 + 0xb),0,
                         *(undefined4 *)(param_1 + 0x4c),puVar9 + 0x19,puVar9 + 0x11);
    if (iVar2 != 0) {
      if (DAT_0007cf4c != 0) {
        fprintf(stderr,"%lu\n",puVar9[0x11]);
      }
      puVar9[0x12] = *(int *)(&DAT_0007bd68 + (((uint)*(ushort *)((int)puVar9 + 0x32) << 0x16) >> 0x1b) * 4) +
                     *(int *)(&DAT_0007bde8 + (*(ushort *)((int)puVar9 + 0x32) & 0x1f) * 4);
      uVar4 = *(undefined4 *)(param_1 + 0x50);
      puVar9[0x17] = *(undefined4 *)(param_1 + 0x4c);
      puVar9[0x18] = uVar4;
      FUN_000276a0(*puVar9);
      *(undefined2 *)(puVar9 + 0xc) = 0;
      return;
    }
    break;
  default:
    FUN_0004fe78(3,"leitech_receive: invalid state %d unit %d",(int)*(short *)(puVar9 + 0xc),*(undefined1 *)(puVar9 + 8)
                );
    return;
  }
  *(short *)(puVar9 + 0xc) = (short)iVar2;
switchD_00033470_caseD_0:
  return;
}




void FUN_00033900(int param_1,int param_2,undefined1 *param_3,undefined4 param_4)

{
  byte bVar1;
  undefined4 uVar2;
  int iVar3;
  
  if (0 < param_1) {
    FUN_0004fe78(3,"leitch_control: unit %d invalid",param_1,param_4);
    return;
  }
  if (param_2 != 0) {
    bVar1 = *(byte *)(param_2 + 2);
    if ((bVar1 & 4) != 0) {
      (&DAT_0008012c)[param_1] = (char)*(undefined4 *)(param_2 + 0x38);
    }
    if ((bVar1 & 8) != 0) {
      (&DAT_00080128)[param_1] = *(undefined4 *)(param_2 + 0x3c);
    }
    if ((&DAT_00080124)[param_1] != '\0') {
      iVar3 = *(int *)(&DAT_000800bc + param_1 * 0x68);
      *(undefined *)(iVar3 + 0x45) = (&DAT_0008012c)[param_1];
      *(undefined4 *)(iVar3 + 0x58) = (&DAT_00080128)[param_1];
    }
  }
  if (param_3 == (undefined1 *)0x0) {
    return;
  }
  memset(param_3,0,0x48);
  param_3[2] = 0xc;
  *param_3 = 0xd;
  uVar2 = (&DAT_00080128)[param_1];
  *(uint *)(param_3 + 0x38) = (uint)(byte)(&DAT_0008012c)[param_1];
  *(undefined **)(param_3 + 8) = &DAT_000665cc;
  *(undefined4 *)(param_3 + 0x3c) = uVar2;
  *(char **)(param_3 + 0x20) = "Leitch: CSD 5300 Master Clock System Driver";
  return;
}




void FUN_000339f0(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  ssize_t sVar1;
  
  if (DAT_0007cf4c == 0) {
    if (0 < param_1) {
      return;
    }
  }
  else {
    fwrite("leitch_poll()\n",1,0xe,stderr);
    if (0 < param_1) {
      return;
    }
  }
  param_1 = param_1 * 0x68;
  if (*(short *)(&DAT_000800ec + param_1) != 0) {
    *(undefined2 *)(&DAT_000800ec + param_1) = 0;
    return;
  }
  if (DAT_0007cf4c != 0) {
    fprintf(stderr,"write leitch %s\n",&DAT_00066bd4,&stderr,param_4);
  }
  sVar1 = write(*(int *)(&DAT_000800d4 + param_1),&DAT_00066bd4,3);
  if (sVar1 < 0) {
    if (DAT_0007cf4c == 0) {
      FUN_0004fe78(3,"leitch_send: unit %d send failed %m",(&DAT_000800dc)[param_1]);
    }
    else {
      fprintf(stderr,"leitch_send: unit %d send failed\n",(uint)(byte)(&DAT_000800dc)[param_1],&stderr,param_4);
    }
  }
  *(undefined2 *)(&DAT_000800ec + param_1) = 1;
  return;
}




undefined4 FUN_00033b5c(int param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  int __fd;
  int iVar3;
  int *__s;
  char acStack_78 [20];
  termios local_64;
  
  if (param_1 < 1) {
    bVar1 = (&DAT_00080124)[param_1];
    if (bVar1 == 0) {
      snprintf(acStack_78,0x14,"/dev/leitch%d",param_1);
      __fd = open(acStack_78,2,0x1ff);
      if (__fd == -1) {
        FUN_0004fe78(3,"leitch_start: open of %s: %m",acStack_78);
      }
      else {
        iVar2 = param_1 * 0x68;
        __s = (int *)(&DAT_000800bc + iVar2);
        memset(__s,0,0x68);
        iVar3 = tcgetattr(__fd,&local_64);
        if (iVar3 < 0) {
          FUN_0004fe78(3,"leitch_start: tcgetattr(%s): %m",acStack_78);
        }
        else {
          local_64.c_iflag = 0x105;
          local_64.c_cflag = 0x8b7;
          local_64.c_lflag = 2;
          local_64.c_oflag = (uint)bVar1;
          local_64.c_cc[2] = bVar1;
          local_64.c_cc[3] = bVar1;
          iVar3 = tcsetattr(__fd,0,&local_64);
          if (iVar3 < 0) {
            FUN_0004fe78(3,"leitch_start: tcsetattr(%s): %m",acStack_78);
          }
          else {
            iVar3 = tcflush(__fd,2);
            if (iVar3 < 0) {
              FUN_0004fe78(3,"leitch_start: tcflush(%s): %m",acStack_78);
            }
            else {
              *(undefined2 *)(&DAT_000800ee + iVar2) = 0xf;
              *__s = param_2;
              (&DAT_000800dc)[iVar2] = (char)param_1;
              *(ushort *)(&DAT_000800ec + iVar2) = (ushort)bVar1;
              *(int **)(&DAT_000800cc + iVar2) = __s;
              *(undefined4 *)(&DAT_000800d0 + iVar2) = 0;
              *(int *)(&DAT_000800d4 + iVar2) = __fd;
              *(code **)(&DAT_000800c4 + iVar2) = FUN_00033434;
              iVar3 = FUN_00015fc4(iVar2 + 0x800c0);
              if (iVar3 != 0) {
                *(undefined1 *)(param_2 + 0x47) = 0xec;
                *(undefined *)(param_2 + 0x45) = (&DAT_0008012c)[param_1];
                *(undefined4 *)(param_2 + 0x58) = (&DAT_00080128)[param_1];
                (&DAT_00080124)[param_1] = 1;
                return 1;
              }
              *(undefined4 *)(&DAT_000800d4 + iVar2) = 0xffffffff;
            }
          }
        }
        close(__fd);
      }
    }
    else {
      FUN_0004fe78(3,"leitch_start: unit %d in use",param_1);
    }
  }
  else {
    FUN_0004fe78(3,"leitch_start: unit %d invalid",param_1);
  }
  return 0;
}




int FUN_00034434(int param_1,int *param_2)

{
  byte *pbVar1;
  ushort **ppuVar2;
  int iVar3;
  int iVar4;
  bool bVar5;
  
  ppuVar2 = __ctype_b_loc();
  iVar3 = 0;
  iVar4 = 0;
  while ((pbVar1 = (byte *)(param_1 + iVar4), ((*ppuVar2)[*pbVar1] & 0x800) != 0 &&
         (bVar5 = iVar4 != 2, iVar4 = iVar4 + 1, bVar5))) {
    iVar3 = (*pbVar1 - 0x30) + iVar3 * 10;
  }
  *param_2 = iVar3;
  return iVar3;
}




int FUN_0003448c(int param_1,int *param_2)

{
  byte bVar1;
  ushort **ppuVar2;
  __int32_t **pp_Var3;
  int iVar4;
  int iVar5;
  int iVar6;
  ushort *puVar7;
  
  ppuVar2 = __ctype_b_loc();
  iVar6 = 0;
  iVar5 = 0;
  puVar7 = *ppuVar2;
  while( true ) {
    bVar1 = *(byte *)(param_1 + iVar5);
    if (((puVar7[bVar1] & 0x1000) == 0) || (iVar5 == 2)) break;
    if ((puVar7[bVar1] & 0x800) == 0) {
      pp_Var3 = __ctype_toupper_loc();
      iVar4 = (*pp_Var3)[bVar1] + -0x37;
    }
    else {
      pp_Var3 = __ctype_toupper_loc();
      iVar4 = (*pp_Var3)[bVar1] + -0x30;
    }
    iVar6 = iVar4 + iVar6 * 0x10;
    iVar5 = iVar5 + 1;
  }
  *param_2 = iVar6;
  return iVar6;
}




void FUN_00034508(int param_1)

{
  char cVar1;
  byte bVar2;
  undefined1 uVar3;
  undefined2 uVar4;
  short sVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  undefined4 uVar10;
  byte *pbVar11;
  undefined4 extraout_r1;
  undefined4 extraout_r1_00;
  undefined4 extraout_r1_01;
  uint uVar12;
  int iVar13;
  undefined4 uVar14;
  undefined4 uVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  int iVar19;
  undefined4 uVar20;
  int iVar21;
  int iVar22;
  bool bVar23;
  int local_38;
  int local_34;
  int local_30;
  uint local_2c [2];
  
  iVar18 = *(int *)(param_1 + 8);
  iVar16 = *(int *)(iVar18 + 0x3c);
  iVar17 = *(int *)(iVar16 + 0x1c);
  if (*(int *)(iVar17 + 0x14) != 0) {
    iVar19 = iVar16 + 0x28;
    *(undefined4 *)(iVar17 + 0x14) = 0;
    iVar6 = FUN_00027aac(param_1,iVar19,0x80,iVar16 + 0xd8);
    *(undefined1 *)(iVar16 + 0x20) = 0;
    *(int *)(iVar16 + 0xa8) = iVar6;
    if (iVar6 == 0x25) {
      FUN_0003448c(iVar16 + 0x4b,local_2c);
      pbVar11 = (byte *)(iVar16 + 0x27);
      uVar12 = 0;
      iVar6 = 0;
      do {
        pbVar11 = pbVar11 + 1;
        iVar6 = iVar6 + 1;
        uVar12 = uVar12 + *pbVar11 & 0xff;
      } while (iVar6 != 0x23);
      if (uVar12 == local_2c[0]) {
        cVar1 = *(char *)(iVar16 + 0x46);
        *(char *)(iVar17 + 0x76) = cVar1;
        if ((*(byte *)(iVar16 + 0x2f0) & 2) == 0) {
          if (cVar1 != 'I') {
            if ((DAT_0007be6c & 0x200) != 0) {
              FUN_0004fe78(5,"NeoClock4X(%d): quartz clock is not initialized: %s",(int)*(short *)(iVar17 + 8),iVar19);
            }
            *(undefined1 *)(iVar16 + 0x20) = 3;
            FUN_00027040(iVar18,5);
            return;
          }
        }
        else if ((cVar1 != 'I') && ((DAT_0007be6c & 0x200) != 0)) {
          FUN_0004fe78(5,"NeoClock4X(%d): using uninitialized quartz clock for time synchronization: %s",
                       (int)*(short *)(iVar17 + 8),iVar19);
        }
        cVar1 = *(char *)(iVar16 + 0x44);
        *(char *)(iVar17 + 0x74) = cVar1;
        bVar2 = *(byte *)(iVar16 + 0x2f0);
        if ((((bVar2 & 2) == 0) && (cVar1 != 'A')) && ((bVar2 & 1) == 0)) {
          FUN_00027040(iVar18,6);
          *(undefined1 *)(iVar16 + 0x20) = 3;
          return;
        }
        if ((bVar2 & 8) != 0) {
          FUN_0004fe78(7,"NeoClock4X(%d): received data: %s",(int)*(short *)(iVar17 + 8),iVar19);
        }
        FUN_00034434(iVar16 + 0x38,iVar16 + 0xac);
        FUN_00034434(iVar16 + 0x36,&local_34);
        FUN_00034434(iVar16 + 0x34,&local_38);
        FUN_00034434(iVar16 + 0x3a,iVar16 + 0xb4);
        FUN_00034434(iVar16 + 0x3c,iVar16 + 0xb8);
        FUN_00034434(iVar16 + 0x3e,iVar16 + 0xbc);
        FUN_00034434(iVar16 + 0x40,&local_30);
        uVar3 = *(undefined1 *)(iVar16 + 0x33);
        *(int *)(iVar16 + 0xc0) = local_30 * 10000000;
        *(undefined2 *)(iVar17 + 0x70) = *(undefined2 *)(iVar16 + 0x31);
        *(undefined1 *)(iVar17 + 0x73) = 0;
        *(undefined1 *)(iVar17 + 0x72) = uVar3;
        *(undefined4 *)(iVar17 + 0x69) = *(undefined4 *)(iVar16 + 0x2b);
        uVar4 = *(undefined2 *)(iVar16 + 0x2f);
        *(undefined1 *)(iVar17 + 0x6f) = 0;
        *(undefined2 *)(iVar17 + 0x6d) = uVar4;
        *(undefined1 *)(iVar17 + 0x75) = *(undefined1 *)(iVar16 + 0x45);
        FUN_0003448c(iVar16 + 0x47,iVar17 + 0x78);
        FUN_0003448c(iVar16 + 0x49,iVar17 + 0x7c);
        uVar12 = *(uint *)(iVar16 + 0xb4);
        if (((((0x17 < uVar12) || (iVar6 = *(int *)(iVar16 + 0xb8), iVar6 < 0)) ||
             ((0x3b < iVar6 || ((iVar22 = *(int *)(iVar16 + 0xbc), iVar22 < 0 || (0x3c < iVar22)))))) || (local_38 < 1))
           || ((((0x1f < local_38 || (local_34 < 1)) || (0xc < local_34)) ||
               ((iVar7 = *(int *)(iVar16 + 0xac), iVar7 < 0 || (99 < iVar7)))))) {
          if ((DAT_0007be6c & 0x200) != 0) {
            FUN_0004fe78(4,"NeoClock4X(%d): date/time out of range: %s",(int)*(short *)(iVar17 + 8),iVar19);
          }
          FUN_00027040(iVar18,5);
          return;
        }
        iVar13 = local_34 + -2;
        iVar21 = iVar7 + 2000;
        *(int *)(iVar16 + 0xac) = iVar21;
        if (iVar13 < 1) {
          iVar13 = local_34 + 10;
          iVar21 = iVar7 + 1999;
        }
        iVar8 = FUN_0005a928(iVar21,0xffffff9c);
        iVar9 = FUN_0005a928(iVar21,400);
        iVar13 = FUN_0005a928(iVar13 * 0x16f,0xc);
        bVar23 = *(char *)(iVar17 + 0x75) == 'S';
        iVar7 = -0xe10;
        if (bVar23) {
          iVar7 = -0x1c00;
        }
        iVar7 = (((iVar21 * 0x16d + local_38 + (iVar21 >> 2) + iVar8 + iVar9 + iVar13) * 0x18 + uVar12) * 0x3c + iVar6)
                * 0x3c + iVar22 + -0x794e4080 + iVar7;
        if (bVar23) {
          iVar7 = iVar7 + -0x20;
        }
        FUN_0005a908(iVar7,0x3c);
        *(undefined4 *)(iVar16 + 0xbc) = extraout_r1;
        uVar10 = FUN_0005a860(iVar7,0x3c);
        FUN_0005a908(uVar10,0x3c);
        *(undefined4 *)(iVar16 + 0xb8) = extraout_r1_00;
        uVar10 = FUN_0005a860(uVar10,0x3c);
        FUN_0005a908(uVar10,0x18);
        *(undefined4 *)(iVar16 + 0xb4) = extraout_r1_01;
        iVar6 = FUN_0005a860(uVar10,0x18);
        iVar22 = FUN_0005a860((iVar6 + 0x264965) * 4,0x23ab1);
        iVar7 = (iVar6 + 0x264965) - (iVar22 * 0x23ab1 + 3U >> 2);
        iVar6 = FUN_0005a860((iVar7 + 1) * 4000,0x164b09);
        iVar21 = (iVar7 + 0x1f) - ((uint)(iVar6 * 0x5b5) >> 2);
        iVar7 = FUN_0005a860(iVar21 * 0x50,0x98f);
        iVar13 = FUN_0005a860(iVar7,0xb);
        iVar8 = iVar7 + 2 + iVar13 * -0xc;
        iVar13 = iVar22 * 100 + iVar6 + -0x1324 + iVar13;
        *(int *)(iVar16 + 0xac) = iVar13;
        local_34 = iVar8;
        local_38 = FUN_0005a860(iVar7 * 0x98f,0x50);
        local_38 = iVar21 - local_38;
        uVar10 = FUN_000513cc(iVar13,iVar8);
        *(undefined1 *)(iVar16 + 0x20) = 0;
        *(undefined4 *)(iVar16 + 0xb0) = uVar10;
        if ((*(byte *)(iVar16 + 0x2f0) & 8) != 0) {
          sVar5 = *(short *)(iVar17 + 8);
          FUN_0005a928(*(undefined4 *)(iVar16 + 0xc0),1000000,local_34,*(undefined4 *)(iVar16 + 0xbc),local_34,local_38,
                       *(undefined4 *)(iVar16 + 0xb4),*(undefined4 *)(iVar16 + 0xb8),*(undefined4 *)(iVar16 + 0xbc));
          FUN_0004fe78(7,"NeoClock4X(%d): calculated UTC date/time: %04d-%02d-%02d %02d:%02d:%02d.%03ld",(int)sVar5,
                       *(undefined4 *)(iVar16 + 0xac));
        }
        uVar20 = *(undefined4 *)(iVar16 + 0xac);
        uVar10 = *(undefined4 *)(iVar16 + 0xb4);
        uVar14 = *(undefined4 *)(iVar16 + 0xb8);
        uVar15 = *(undefined4 *)(iVar16 + 0xbc);
        *(int *)(iVar17 + 0x84) = local_34;
        *(undefined4 *)(iVar17 + 0x80) = uVar20;
        *(int *)(iVar17 + 0x88) = local_38;
        *(undefined4 *)(iVar17 + 0x8c) = uVar10;
        *(undefined4 *)(iVar17 + 0x90) = uVar14;
        uVar10 = *(undefined4 *)(iVar16 + 0xc0);
        *(undefined4 *)(iVar17 + 0x94) = uVar15;
        uVar10 = FUN_0005a928(uVar10,1000000);
        *(undefined4 *)(iVar17 + 0x98) = uVar10;
        iVar16 = FUN_00027698(iVar16);
        if (iVar16 == 0) {
          if ((DAT_0007be6c & 0x200) != 0) {
            FUN_0004fe78(4,"NeoClock4X(%d): refclock_process failed!",(int)*(short *)(iVar17 + 8));
          }
          FUN_00027040(iVar18,3);
          return;
        }
        FUN_000276a0(iVar18);
        FUN_00027040(iVar18,0);
        FUN_0002ddbc(iVar18 + 0xc,iVar19);
        return;
      }
      if ((DAT_0007be6c & 0x200) != 0) {
        FUN_0004fe78(4,"NeoClock4X(%d): received data has invalid chksum: %s",(int)*(short *)(iVar17 + 8),iVar19);
      }
    }
    else if ((DAT_0007be6c & 0x200) != 0) {
      FUN_0004fe78(4,"NeoClock4X(%d): received data has invalid length, expected %d bytes, received %d bytes: %s",
                   (int)*(short *)(iVar17 + 8),0x25,iVar6,iVar19);
    }
    FUN_00027040(iVar18,2);
  }
  return;
}




undefined4 FUN_00034b58(undefined4 param_1,int param_2)

{
  short sVar1;
  bool bVar2;
  bool bVar3;
  int __fd;
  int iVar4;
  void *__s;
  ssize_t sVar5;
  char *pcVar6;
  size_t sVar7;
  size_t sVar8;
  int *piVar9;
  char cVar10;
  int iVar11;
  uint uVar12;
  uint uVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  char *__dest;
  uint local_1a4;
  int local_19c;
  uint local_18c;
  char local_17d;
  uint local_17c;
  char acStack_178 [20];
  termios local_164;
  char local_128 [12];
  undefined2 local_11c;
  undefined2 uStack_11a;
  char local_118 [4];
  undefined3 uStack_114;
  char cStack_111;
  char acStack_110 [4];
  undefined1 local_10c;
  
  snprintf(acStack_178,0x13,"/dev/neoclock4x-%d",param_1);
  __fd = FUN_00027d18(acStack_178,0xb,0);
  if (__fd < 1) {
    return 0;
  }
  iVar4 = tcgetattr(__fd,&local_164);
  if (iVar4 < 0) {
    FUN_0004fe78(2,"NeoClock4X(%d): (tcgetattr) can\'t query serial port settings: %m",param_1);
    close(__fd);
    return 0;
  }
  local_164.c_oflag = 0;
  local_164.c_iflag = 0x105;
  local_164.c_cflag = 0x8f0;
  cfsetispeed(&local_164,0xb);
  cfsetospeed(&local_164,0xb);
  iVar4 = tcsetattr(__fd,0,&local_164);
  if (iVar4 < 0) {
    FUN_0004fe78(2,"NeoClock4X(%d): (tcsetattr) can\'t set serial port 2400 8N2: %m",param_1);
    close(__fd);
    return 0;
  }
  iVar4 = ioctl(__fd,0x5415,&local_17c);
  if (iVar4 == -1) {
    FUN_0004fe78(2,"NeoClock4X(%d): can\'t query RTS/DTR state: %m",param_1);
    close(__fd);
    return 0;
  }
  local_17c = local_17c | 6;
  iVar4 = ioctl(__fd,0x5418,&local_17c);
  if (iVar4 == -1) {
    FUN_0004fe78(2,"NeoClock4X(%d): can\'t set RTS/DTR to power neoclock4x: %m",param_1);
    close(__fd);
    return 0;
  }
  __s = (void *)FUN_0004f524(0x9c);
  if (__s == (void *)0x0) {
    FUN_0004fe78(3,"NeoClock4X(%d): can\'t allocate memory for: %m",param_1);
    close(__fd);
    return 0;
  }
  memset(__s,0,0x9c);
  iVar4 = *(int *)(param_2 + 0x3c);
  __dest = (char *)((int)__s + 0x18);
  *(undefined4 *)(iVar4 + 0x2d8) = 0x1b4e81b5;
  *(undefined4 *)(iVar4 + 0x2dc) = 0x3fc5b4e8;
  *(void **)(iVar4 + 0x1c) = __s;
  *(int *)(iVar4 + 0xc) = param_2;
  *(int *)(iVar4 + 0x14) = __fd;
  *(undefined4 *)(iVar4 + 0x10) = 0;
  *(char **)(iVar4 + 0x24) = "NeoClock4X";
  *(code **)(iVar4 + 4) = FUN_00034508;
  *(undefined1 *)(param_2 + 0x47) = 0xf6;
  *(undefined4 *)(param_2 + 0x74) = 5;
  *(undefined4 *)(iVar4 + 0x2ec) = 0x6c6f656e;
  local_19c = 0;
  *(undefined1 *)((int)__s + 0x10) = 0;
  *(short *)((int)__s + 8) = (short)param_1;
  *(undefined4 *)((int)__s + 0x80) = 0;
  *(undefined4 *)((int)__s + 0x84) = 0;
  *(undefined4 *)((int)__s + 0x88) = 0;
  *(undefined4 *)((int)__s + 0x8c) = 0;
  *(undefined4 *)((int)__s + 0x90) = 0;
  *(undefined4 *)((int)__s + 0x94) = 0;
  *(undefined4 *)((int)__s + 0x98) = 0;
  *(undefined2 *)((int)__s + 0x18) = 0x3f;
  *(undefined2 *)((int)__s + 0x69) = 0x3f;
  *(undefined2 *)((int)__s + 0x70) = 0x3f;
  *(undefined1 *)((int)__s + 0x68) = 0x3f;
  *(undefined1 *)((int)__s + 0x74) = 0x3f;
  *(undefined1 *)((int)__s + 0x75) = 0x3f;
  *(undefined1 *)((int)__s + 0x76) = 0x3f;
  *(undefined4 *)((int)__s + 0x78) = 0xffffffff;
  *(undefined4 *)((int)__s + 0x7c) = 0xffffffff;
  do {
    if ((DAT_0007be6c & 0x100) != 0) {
      FUN_0004fe78(6,"NeoClock4X(%d): checking NeoClock4X firmware version (%d/5)",param_1,local_19c);
    }
    sleep(3);
    iVar15 = *(int *)(iVar4 + 0x14);
    iVar16 = (int)*(short *)((int)__s + 8);
    sleep(1);
    sVar5 = write(iVar15,&DAT_00067334,1);
    if (sVar5 == -1) {
      FUN_0004fe78(3,"NeoClock4X(%d): can\'t query firmware version",iVar16);
      builtin_strncpy(local_128,"unknown erro",0xc);
      local_11c = 0x72;
    }
    else {
      uVar12 = 0;
      sleep(1);
      memset(local_128,0,0x100);
      bVar2 = false;
      local_18c = 0;
      iVar11 = 0;
      local_1a4 = 0;
      iVar14 = 0;
      bVar3 = true;
      do {
        sVar5 = read(iVar15,&local_17d,1);
        if (sVar5 == -1) {
          piVar9 = __errno_location();
          if (*piVar9 == 0xb) {
            sleep(1);
          }
          else {
            pcVar6 = strerror(*piVar9);
            iVar14 = iVar14 + 1;
            FUN_0004fe78(7,"NeoClock4x(%d): read: %s",iVar16,pcVar6);
          }
        }
        else {
          iVar11 = iVar11 + 1;
          if (bVar3) {
            if (local_17d == -0x57) {
              local_128[0] = '(';
              local_128[1] = 'c';
              local_128[2] = ')';
              local_128[3] = '\0';
              bVar3 = false;
              uVar12 = 3;
            }
          }
          else {
            uVar13 = uVar12;
            if (local_17d == '\n' || local_17d == '\r') {
              if (bVar2) {
                pcVar6 = strstr(local_128 + local_1a4,"S/N");
                if (pcVar6 != (char *)0x0) {
                  local_128[local_18c] = bVar3;
                  strncpy(__dest,local_128,0x50);
                  *(bool *)((int)__s + 0x68) = bVar3;
                  if ((DAT_0007be6c & 0x100) != 0) {
                    FUN_0004fe78(6,"NeoClock4X(%d): firmware version: %s",iVar16,__dest);
                  }
                  pcVar6 = strstr(__dest,"/R2");
                  if (pcVar6 != (char *)0x0) {
                    FUN_0004fe78(6,
                                 "NeoClock4X(%d): Your NeoClock4X uses the new R2 firmware release. Please note the changed LED behaviour."
                                 ,iVar16);
                  }
                  goto LAB_00034e94;
                }
                local_1a4 = uVar12 + 3;
                local_128[uVar12] = ' ';
                local_128[uVar12 + 2] = ' ';
                local_128[uVar12 + 1] = '/';
                uVar13 = local_1a4;
                bVar2 = true;
                local_18c = uVar12;
              }
              else {
                bVar2 = true;
              }
            }
            else {
              bVar2 = bVar3;
              if (local_17d != '\0') {
                local_128[uVar12] = local_17d;
                uVar13 = uVar12 + 1;
              }
            }
            local_128[uVar13] = '\0';
            uVar12 = uVar13;
            if (0xfb < uVar13) goto LAB_00034e60;
          }
        }
        if (5 < iVar14) {
          FUN_0004fe78(3,"NeoClock4X(%d): can\'t read firmware version (timeout)",iVar16);
          local_128[0] = 'u';
          local_128[1] = 'n';
          local_128[2] = 'k';
          local_128[3] = 'n';
          local_128[4] = 'o';
          local_128[5] = 'w';
          local_128[6] = 'n';
          local_128[7] = ' ';
          local_128[8] = 'd';
          local_128[9] = 'u';
          local_128[10] = 'e';
          local_128[0xb] = ' ';
          local_11c._0_1_ = 't';
          local_11c._1_1_ = 'o';
          register0x0000002e = ' ';
          register0x0000002f = 't';
          local_118[0] = 'i';
          local_118[1] = 'm';
          local_118[2] = 'e';
          local_118[3] = 'o';
          uStack_114 = 0x7475;
          goto LAB_00034e60;
        }
      } while (iVar11 < 0x1f5);
      FUN_0004fe78(3,"NeoClock4X(%d): can\'t read firmware version (garbage)",iVar16);
      local_128[0] = 'u';
      local_128[1] = 'n';
      local_128[2] = 'k';
      local_128[3] = 'n';
      local_128[4] = 'o';
      local_128[5] = 'w';
      local_128[6] = 'n';
      local_128[7] = ' ';
      local_128[8] = 'd';
      local_128[9] = 'u';
      local_128[10] = 'e';
      local_128[0xb] = ' ';
      local_11c._0_1_ = 't';
      local_11c._1_1_ = 'o';
      register0x0000002e = ' ';
      register0x0000002f = 'g';
      local_118[0] = 'a';
      local_118[1] = 'r';
      local_118[2] = 'b';
      local_118[3] = 'a';
      uStack_114._0_1_ = 'g';
      uStack_114._1_1_ = 'e';
      uStack_114._2_1_ = ' ';
      cStack_111 = 'i';
      acStack_110[0] = 'n';
      acStack_110[1] = 'p';
      acStack_110[2] = 'u';
      acStack_110[3] = 't';
      local_10c = 0;
    }
LAB_00034e60:
    local_19c = local_19c + 1;
    strncpy(__dest,local_128,0x50);
    *(undefined1 *)((int)__s + 0x68) = 0;
  } while (local_19c != 5);
LAB_00034e94:
  *(undefined1 *)((int)__s + 0x68) = 0x3f;
  pcVar6 = strstr(__dest,"NDF:");
  sVar1 = *(short *)((int)__s + 8);
  if (pcVar6 != (char *)0x0) {
    sVar7 = strlen(__dest);
    sVar8 = strlen(pcVar6);
    if (((6 < sVar7 - sVar8) && (pcVar6[5] == ':')) && (pcVar6[6] == '*')) {
      cVar10 = pcVar6[4];
      *(char *)((int)__s + 0x68) = cVar10;
      if (cVar10 == 'A') {
        iVar15 = FUN_00015fc4(iVar4);
        if (iVar15 == 0) {
          FUN_0004fe78(3,"NeoClock4X(%d): error add peer to ntpd: %m",param_1);
          close(__fd);
          *(undefined4 *)(iVar4 + 0x14) = 0xffffffff;
          free(*(void **)(iVar4 + 0x1c));
          *(undefined4 *)(iVar4 + 0x1c) = 0;
          return 0;
        }
        if ((DAT_0007be6c & 0x100) != 0) {
          FUN_0004fe78(6,"NeoClock4X(%d): receiver setup successful done",param_1);
          return 1;
        }
        return 1;
      }
      goto LAB_00034ee4;
    }
  }
  cVar10 = '?';
LAB_00034ee4:
  FUN_0004fe78(2,"NeoClock4X(%d): firmware version \"%c\" not supported with this driver version!",(int)sVar1,cVar10);
  close(__fd);
  *(undefined4 *)(iVar4 + 0x14) = 0xffffffff;
  free(*(void **)(iVar4 + 0x1c));
  *(undefined4 *)(iVar4 + 0x1c) = 0;
  return 0;
}




void FUN_00035270(undefined4 param_1,int param_2)

{
  int iVar1;
  
  iVar1 = *(int *)(param_2 + 0x3c);
  if (*(void **)(iVar1 + 0x1c) != (void *)0x0) {
    free(*(void **)(iVar1 + 0x1c));
  }
  if (*(int *)(iVar1 + 0x14) == -1) {
    return;
  }
  FUN_00015ff4(iVar1);
  return;
}




void FUN_000352a0(int param_1)

{
  ulonglong uVar1;
  byte bVar2;
  char cVar3;
  uint uVar4;
  int iVar5;
  ushort **ppuVar6;
  time_t tVar7;
  tm *ptVar8;
  undefined4 uVar9;
  byte bVar10;
  byte bVar11;
  int extraout_r1;
  int extraout_r1_00;
  int iVar12;
  byte *pbVar13;
  byte *pbVar14;
  int extraout_r1_01;
  int extraout_r1_02;
  char *pcVar15;
  uint uVar16;
  ushort *puVar17;
  byte *pbVar18;
  byte *pbVar19;
  int iVar20;
  char *pcVar21;
  int iVar22;
  int iVar23;
  undefined4 *puVar24;
  uint uVar25;
  char *pcVar26;
  bool bVar27;
  undefined8 uVar28;
  double dVar29;
  uint local_d0;
  undefined4 local_cc;
  undefined4 local_c8;
  int local_c4;
  int local_c0;
  undefined4 local_bc;
  undefined4 local_b8;
  undefined2 local_b4;
  byte local_b0 [132];
  
  iVar22 = *(int *)(param_1 + 8);
  iVar23 = *(int *)(iVar22 + 0x3c);
  puVar24 = *(undefined4 **)(iVar23 + 0x1c);
  uVar4 = FUN_00027aac(param_1,local_b0,0x80,&local_cc);
  if (uVar4 == 0) {
    return;
  }
  if ((int)uVar4 < 8) {
LAB_00035314:
    FUN_00027040(iVar22,2);
    return;
  }
  if (0 < DAT_0007cf4c) {
    printf("nmea: gpsread %d %s\n",uVar4,local_b0);
  }
  if (local_b0[0] != 0x24) {
    return;
  }
  iVar5 = strncmp((char *)(local_b0 + 3),"RMC",3);
  if (iVar5 == 0) {
    iVar5 = 0;
  }
  else {
    iVar5 = strncmp((char *)(local_b0 + 3),"GGA",3);
    if (iVar5 == 0) {
      iVar5 = 1;
    }
    else {
      iVar5 = strncmp((char *)(local_b0 + 3),"GLL",3);
      if (iVar5 == 0) {
        iVar5 = 2;
      }
      else {
        iVar5 = strncmp((char *)(local_b0 + 3),"ZDG",3);
        if (iVar5 == 0) {
          iVar5 = 4;
        }
        else {
          iVar5 = strncmp((char *)(local_b0 + 3),"ZDA",3);
          if (iVar5 != 0) {
            return;
          }
          iVar5 = 3;
        }
      }
    }
  }
  if (((*(byte *)(iVar22 + 0x3b) & 0xf) != 0) && ((*(byte *)(iVar22 + 0x3b) & (&DAT_0007a78c)[iVar5]) == 0)) {
    return;
  }
  if ((puVar24[2] != 0) && (iVar5 != 4)) {
    return;
  }
  uVar16 = (uint)local_b0[1];
  if (uVar16 == 0 || uVar16 == 0x2a) {
    uVar25 = 0;
    pbVar18 = local_b0 + 1;
  }
  else {
    uVar25 = 0;
    pbVar19 = local_b0 + 2;
    do {
      pbVar18 = pbVar19;
      uVar25 = uVar16 ^ uVar25;
      uVar16 = (uint)*pbVar18;
      pbVar19 = pbVar18 + 1;
    } while (uVar16 != 0x2a && uVar16 != 0);
  }
  if ((((uVar16 == 0x2a) && (pbVar18[1] != 0)) && (pbVar18[2] != 0)) &&
     (((pbVar18[3] == 0 && (iVar12 = FUN_0004f53c(pbVar18 + 1,&local_d0), iVar12 != 0)) && (uVar25 == local_d0)))) {
    *(undefined1 *)((int)puVar24 + iVar5 + 0x16) = 1;
  }
  else if ((iVar5 == 0) || (*(char *)((int)puVar24 + iVar5 + 0x16) != '\0')) goto LAB_00035314;
  local_bc = 0;
  local_b8 = 0;
  local_b4 = 0;
  switch(iVar5) {
  case 1:
    pbVar18 = local_b0;
    iVar12 = 6;
    do {
      pbVar18 = pbVar18 + 1;
      if (pbVar18[-1] == 0) goto LAB_00035994;
      if (pbVar18[-1] == 0x2c) {
        iVar12 = iVar12 + -1;
      }
    } while (iVar12 != 0);
    if (*pbVar18 == 0x30) {
      *(undefined1 *)(iVar23 + 0x20) = 3;
    }
    else {
LAB_00035994:
      *(undefined1 *)(iVar23 + 0x20) = 0;
    }
    pbVar18 = local_b0;
    do {
      pbVar19 = pbVar18;
      pbVar18 = pbVar19 + 1;
      uVar16 = (uint)*pbVar19;
      if (uVar16 == 0) goto LAB_000354d0;
    } while (uVar16 != 0x2c);
    break;
  case 2:
    pbVar18 = local_b0;
    iVar12 = 6;
    do {
      pbVar18 = pbVar18 + 1;
      if (pbVar18[-1] == 0) goto LAB_000359a0;
      if (pbVar18[-1] == 0x2c) {
        iVar12 = iVar12 + -1;
      }
    } while (iVar12 != 0);
    if (*pbVar18 == 0x41) {
      *(undefined1 *)(iVar23 + 0x20) = 0;
    }
    else {
LAB_000359a0:
      *(undefined1 *)(iVar23 + 0x20) = 3;
    }
    iVar12 = 5;
    pbVar18 = local_b0;
    do {
      pbVar19 = pbVar18;
      pbVar18 = pbVar19 + 1;
      uVar16 = (uint)*pbVar19;
      if (uVar16 == 0) goto LAB_000354d0;
      if (uVar16 == 0x2c) {
        iVar12 = iVar12 + -1;
      }
    } while (iVar12 != 0);
    break;
  case 3:
switchD_00035440_caseD_3:
    *(undefined1 *)(iVar23 + 0x20) = 0;
    goto LAB_000354a8;
  case 4:
    pbVar18 = local_b0;
    iVar12 = 6;
    do {
      pbVar18 = pbVar18 + 1;
      if (pbVar18[-1] == 0) goto switchD_00035440_caseD_3;
      if (pbVar18[-1] == 0x2c) {
        iVar12 = iVar12 + -1;
      }
    } while (iVar12 != 0);
    if (*pbVar18 != 0x30) goto switchD_00035440_caseD_3;
    *(undefined1 *)(iVar23 + 0x20) = 3;
LAB_000354a8:
    pbVar18 = local_b0;
    do {
      pbVar19 = pbVar18;
      if (*pbVar19 == 0) {
        uVar16 = 0;
        goto LAB_000354d0;
      }
      pbVar18 = pbVar19 + 1;
    } while (*pbVar19 != 0x2c);
    uVar16 = (uint)pbVar19[1];
    pbVar19 = pbVar19 + 1;
    goto LAB_000354d0;
  default:
    pbVar18 = local_b0;
    iVar12 = 2;
    do {
      pbVar18 = pbVar18 + 1;
      if (pbVar18[-1] == 0) goto LAB_000359ac;
      if (pbVar18[-1] == 0x2c) {
        iVar12 = iVar12 + -1;
      }
    } while (iVar12 != 0);
    if (*pbVar18 == 0x41) {
      *(undefined1 *)(iVar23 + 0x20) = 0;
    }
    else {
LAB_000359ac:
      *(undefined1 *)(iVar23 + 0x20) = 3;
    }
    pbVar18 = local_b0;
    do {
      pbVar19 = pbVar18;
      pbVar18 = pbVar19 + 1;
      uVar16 = (uint)*pbVar19;
      if (uVar16 == 0) goto LAB_000354d0;
    } while (uVar16 != 0x2c);
  }
  uVar16 = (uint)pbVar19[1];
  pbVar19 = pbVar18;
LAB_000354d0:
  ppuVar6 = __ctype_b_loc();
  puVar17 = *ppuVar6;
  if ((((((puVar17[uVar16] & 0x800) == 0) || ((puVar17[pbVar19[1]] & 0x800) == 0)) ||
       ((puVar17[pbVar19[2]] & 0x800) == 0)) ||
      (((puVar17[pbVar19[3]] & 0x800) == 0 || ((puVar17[pbVar19[4]] & 0x800) == 0)))) ||
     ((puVar17[pbVar19[5]] & 0x800) == 0)) {
    if (0 < DAT_0007cf4c) {
      printf("NMEA time code %c%c%c%c%c%c non-numeric",uVar16,(uint)pbVar19[1],(uint)pbVar19[2],(uint)pbVar19[3],
             (uint)pbVar19[4],(uint)pbVar19[5]);
    }
  }
  else {
    uVar16 = (uVar16 * 10 + (uint)pbVar19[1]) - 0x10;
    bVar10 = pbVar19[2] * '\n' + (pbVar19[3] - 0x10);
    local_b8 = CONCAT13(bVar10,CONCAT12((char)uVar16,(undefined2)local_b8));
    bVar11 = pbVar19[5];
    bVar2 = pbVar19[4];
    *(undefined4 *)(iVar23 + 0xc0) = 0;
    bVar11 = bVar2 * '\n' + (bVar11 - 0x10);
    local_b4 = CONCAT11(local_b4._1_1_,bVar11);
    if ((pbVar19[6] == 0x2e) && ((puVar17[pbVar19[7]] & 0x800) != 0)) {
      iVar12 = (pbVar19[7] - 0x30) * 100000000;
      *(int *)(iVar23 + 0xc0) = iVar12;
      if ((puVar17[pbVar19[8]] & 0x800) != 0) {
        iVar12 = (uint)pbVar19[8] * 10000000 + iVar12 + -480000000;
        *(int *)(iVar23 + 0xc0) = iVar12;
        if ((puVar17[pbVar19[9]] & 0x800) != 0) {
          *(uint *)(iVar23 + 0xc0) = iVar12 + (uint)pbVar19[9] * 1000000 + -48000000;
        }
      }
    }
    if (((((uVar16 & 0xff) < 0x18) && (bVar10 < 0x3c)) && (bVar11 < 0x3c)) && (*(int *)(iVar23 + 0xc0) < 0x3b9aca01)) {
      if ((local_b8._2_2_ == *(short *)((int)puVar24 + 0x12)) && (*(byte *)(puVar24 + 5) == bVar11)) {
        return;
      }
      pcVar26 = (char *)(iVar23 + 0x28);
      *(uint *)(iVar23 + 0xa8) = uVar4 & 0xffff;
      memcpy(pcVar26,local_b0,(uVar4 & 0xffff) + 1);
      iVar12 = DAT_0007cf4c;
      *puVar24 = local_cc;
      puVar24[1] = local_c8;
      *(undefined4 *)(iVar23 + 0xd8) = local_cc;
      *(undefined4 *)(iVar23 + 0xdc) = local_c8;
      if (0 < iVar12) {
        printf("nmea: timecode %d %s\n",*(undefined4 *)(iVar23 + 0xa8),pcVar26);
      }
      if (iVar5 == 0) {
        pbVar18 = local_b0;
        iVar12 = 9;
        do {
          pbVar18 = pbVar18 + 1;
          pbVar19 = pbVar18 + -1;
          if (pbVar18[-1] == 0) break;
          if (pbVar18[-1] == 0x2c) {
            iVar12 = iVar12 + -1;
          }
          pbVar19 = pbVar18;
        } while (iVar12 != 0);
        local_b8 = CONCAT31(CONCAT21(local_b8._2_2_,*pbVar19 * '\n' + (pbVar19[1] - 0x10)),
                            pbVar19[2] * '\n' + (pbVar19[3] - 0x10));
        local_bc = CONCAT22(local_bc._2_2_,(ushort)pbVar19[4] * 10 + (pbVar19[5] - 0x210));
        local_d0 = time((time_t *)0x0);
        ptVar8 = gmtime((time_t *)&local_d0);
        uVar4 = local_bc & 0xffff;
        iVar20 = ptVar8->tm_year + 0x758;
        FUN_0005aa04(iVar20,100);
        FUN_0005aa04(uVar4 - extraout_r1_01,100);
        iVar12 = extraout_r1_02;
        if ((extraout_r1_02 != 0) && (extraout_r1_02 < 0)) {
          iVar12 = extraout_r1_02 + 100;
        }
        local_bc = CONCAT22(local_bc._2_2_,(short)iVar20 + (short)iVar12);
      }
      else if ((iVar5 - 3U & 0xff) < 2) {
        pbVar19 = local_b0 + 1;
        iVar12 = 2;
        pbVar18 = pbVar19;
        do {
          pbVar13 = pbVar18 + -1;
          if (pbVar18[-1] == 0) break;
          if (pbVar18[-1] == 0x2c) {
            iVar12 = iVar12 + -1;
          }
          pbVar13 = pbVar18;
          pbVar18 = pbVar18 + 1;
        } while (iVar12 != 0);
        iVar12 = 3;
        pbVar18 = pbVar19;
        do {
          pbVar14 = pbVar18 + -1;
          if (pbVar18[-1] == 0) break;
          if (pbVar18[-1] == 0x2c) {
            iVar12 = iVar12 + -1;
          }
          pbVar14 = pbVar18;
          pbVar18 = pbVar18 + 1;
        } while (iVar12 != 0);
        iVar12 = 4;
        local_b8 = CONCAT31(CONCAT21(local_b8._2_2_,*pbVar13 * '\n' + (pbVar13[1] - 0x10)),
                            *pbVar14 * '\n' + (pbVar14[1] - 0x10));
        do {
          pbVar18 = pbVar19 + -1;
          if (pbVar19[-1] == 0) break;
          if (pbVar19[-1] == 0x2c) {
            iVar12 = iVar12 + -1;
          }
          pbVar18 = pbVar19;
          pbVar19 = pbVar19 + 1;
        } while (iVar12 != 0);
        local_bc = CONCAT22(local_bc._2_2_,
                            (ushort)pbVar18[2] * 10 +
                            (ushort)pbVar18[1] * 100 + (ushort)*pbVar18 * 1000 + pbVar18[3] + 0x2fb0);
      }
      else {
        local_d0 = ((local_b8 >> 0x10 & 0xff) * 0x3c + (local_b8 >> 0x18)) * 0x3c + (uint)(byte)local_b4;
        tVar7 = time((time_t *)0x0);
        FUN_0005aa04(tVar7 + -0xa8c0,0x15180);
        FUN_0005aa04(local_d0 - extraout_r1,0x15180);
        iVar12 = extraout_r1_00;
        if ((extraout_r1_00 != 0) && (extraout_r1_00 < 0)) {
          iVar12 = extraout_r1_00 + 0x15180;
        }
        local_d0 = tVar7 + -0xa8c0 + iVar12;
        ptVar8 = gmtime((time_t *)&local_d0);
        if (ptVar8 == (tm *)0x0) {
          local_bc = 0;
          local_b8 = local_b8 & 0xffff0000;
        }
        else {
          local_b8 = CONCAT13((char)ptVar8->tm_min,
                              (int3)CONCAT31(CONCAT21((short)ptVar8->tm_hour,(char)ptVar8->tm_mday),
                                             (char)ptVar8->tm_mon + '\x01'));
          local_bc = CONCAT22((short)ptVar8->tm_yday + 1,(short)ptVar8->tm_year + 0x76c);
          local_b4 = CONCAT11(local_b4._1_1_,(char)ptVar8->tm_sec);
        }
      }
      if (((0xb < (local_b8 & 0xff) - 1) || (local_b8._1_1_ == 0)) || (0x1f < local_b8._1_1_)) {
        FUN_00027040(iVar22,5);
        return;
      }
      *(byte *)(puVar24 + 5) = (byte)local_b4;
      *(undefined1 *)((int)puVar24 + 0x12) = local_b8._2_1_;
      *(undefined1 *)((int)puVar24 + 0x13) = local_b8._3_1_;
      if ((*(byte *)(iVar23 + 0x2f0) & 8) != 0) {
        if (iVar5 == 1) {
          iVar12 = 2;
          do {
            pcVar21 = pcVar26;
            if (*pcVar26 == '\0') break;
            if (*pcVar26 == ',') {
              iVar12 = iVar12 + -1;
            }
            pcVar21 = pcVar26 + 1;
            pcVar26 = pcVar26 + 1;
          } while (iVar12 != 0);
          iVar12 = 2;
          pcVar26 = pcVar21;
          do {
            pcVar15 = pcVar26 + 1;
            if (*pcVar26 == '\0') break;
            if (*pcVar26 == ',') {
              iVar12 = iVar12 + -1;
            }
            pcVar26 = pcVar15;
          } while (iVar12 != 0);
        }
        else if (iVar5 == 0) {
          iVar12 = 3;
          do {
            pcVar21 = pcVar26;
            if (*pcVar26 == '\0') break;
            if (*pcVar26 == ',') {
              iVar12 = iVar12 + -1;
            }
            pcVar21 = pcVar26 + 1;
            pcVar26 = pcVar26 + 1;
          } while (iVar12 != 0);
          iVar12 = 2;
          pcVar26 = pcVar21;
          do {
            pcVar15 = pcVar26 + 1;
            if (*pcVar26 == '\0') break;
            if (*pcVar26 == ',') {
              iVar12 = iVar12 + -1;
            }
            pcVar26 = pcVar15;
          } while (iVar12 != 0);
        }
        else if (iVar5 == 2) {
          do {
            cVar3 = *pcVar26;
            pcVar21 = pcVar26;
            if (cVar3 == '\0') break;
            pcVar21 = pcVar26 + 1;
            pcVar26 = pcVar26 + 1;
          } while (cVar3 != ',');
          iVar12 = 2;
          pcVar26 = pcVar21;
          do {
            pcVar15 = pcVar26 + 1;
            if (*pcVar26 == '\0') break;
            if (*pcVar26 == ',') {
              iVar12 = iVar12 + -1;
            }
            pcVar26 = pcVar15;
          } while (iVar12 != 0);
        }
        else {
          pcVar21 = (char *)0x0;
          pcVar26 = (char *)0x0;
        }
        do {
          if (pcVar21 == (char *)0x0) break;
          while( true ) {
            pcVar15 = pcVar21;
            if (*pcVar15 == ',') break;
            pcVar21 = pcVar15 + 1;
            if (*pcVar15 != '.') {
              *pcVar15 = '_';
            }
          }
          pcVar21 = pcVar26;
        } while (pcVar15 < pcVar26);
        if (pcVar26 != (char *)0x0) {
          iVar20 = *(int *)(iVar23 + 0xa8) + -2;
          iVar12 = iVar23 + *(int *)(iVar23 + 0xa8) + 0x26;
          uVar4 = (uint)*(byte *)(iVar12 + 2);
          bVar27 = uVar4 == 0;
          if (bVar27) {
            uVar4 = iVar23 + iVar20;
            iVar20 = 0x5f;
          }
          if (bVar27) {
            *(char *)(iVar12 + 1) = (char)iVar20;
            *(char *)(uVar4 + 0x28) = (char)iVar20;
          }
        }
      }
      uVar28 = *(undefined8 *)(iVar23 + 0x2e0);
      local_bc = local_bc & 0xffff;
      dVar29 = (double)(longlong)*(int *)(iVar23 + 0xc0) * 1e-09;
      if (dVar29 < 0.0) {
        uVar1 = (ulonglong)-dVar29;
        uVar4 = (uint)uVar1;
        dVar29 = (-dVar29 - (double)(uVar1 & 0xffffffff)) * 4294967296.0;
        iVar12 = (uint)(0.0 < dVar29) * (int)(longlong)dVar29;
        if (iVar12 == 0) {
          uVar4 = -uVar4;
          iVar12 = 0;
        }
        else {
          iVar12 = -iVar12;
          uVar4 = ~uVar4;
        }
      }
      else {
        uVar4 = (uint)(longlong)dVar29;
        dVar29 = (dVar29 - (double)((longlong)dVar29 & 0xffffffff)) * 4294967296.0;
        iVar12 = (uint)(0.0 < dVar29) * (int)(longlong)dVar29;
      }
      local_c4 = FUN_0004ecd0(&local_bc);
      local_c4 = uVar4 + local_c4;
      if (iVar5 == 4) {
        if ((puVar24[2] == 0) && (puVar24[2] = 1, (DAT_0007be6c & 0x100) != 0)) {
          uVar9 = FUN_00050bec(iVar22 + 0xc);
          FUN_0004fe78(6,"%s using only $GPZDG",uVar9);
        }
        local_c4 = local_c4 + -1;
      }
      local_c0 = iVar12;
      FUN_00027430((int)uVar28,iVar23,local_c4,iVar12,local_cc,local_c8);
      return;
    }
    if (0 < DAT_0007cf4c) {
      printf("NMEA hour/min/sec/nsec range %02d:%02d:%02d.%09ld\n",*(undefined4 *)(iVar23 + 0xb4),
             *(undefined4 *)(iVar23 + 0xb8),*(undefined4 *)(iVar23 + 0xbc),*(undefined4 *)(iVar23 + 0xc0));
    }
  }
  FUN_00027040(iVar22,6);
  return;
}




void FUN_00035f24(int param_1,undefined4 param_2)

{
  ssize_t sVar1;
  
  sVar1 = write(param_1,"$PMOTG,RMC,0000*1D\r\n",0x14);
  if (sVar1 != -1) {
    return;
  }
  FUN_00027040(param_2,3);
  return;
}




undefined4 FUN_00035f54(undefined4 param_1,int param_2)

{
  int __fd;
  void *__s;
  int iVar1;
  ssize_t sVar2;
  char *__name;
  char *__nptr;
  long lVar3;
  hostent *phVar4;
  protoent *ppVar5;
  undefined4 uVar6;
  uint uVar7;
  int iVar8;
  undefined *puVar9;
  sockaddr local_94;
  char acStack_84 [20];
  char acStack_70 [84];
  
  iVar8 = *(int *)(param_2 + 0x3c);
  snprintf(acStack_84,0x14,"/dev/gps%d",param_1);
  uVar7 = (((uint)*(byte *)(param_2 + 0x3b) << 0x19) >> 0x1d) - 1;
  if (uVar7 < 5) {
    puVar9 = (&PTR_DAT_0006758c)[uVar7];
    uVar6 = *(undefined4 *)(&DAT_000675a0 + uVar7 * 4);
  }
  else {
    uVar6 = 0xc;
    puVar9 = &UNK_0006768c;
  }
  __fd = FUN_00027d18(acStack_84,uVar6,1);
  if (__fd < 1) {
    sVar2 = readlink(acStack_84,acStack_70,0x50);
    if (sVar2 != -1) {
      acStack_70[sVar2] = '\0';
      __name = strtok(acStack_70,":");
      if ((__name != (char *)0x0) && (__nptr = strtok((char *)0x0,":"), __nptr != (char *)0x0)) {
        lVar3 = strtol(__nptr,(char **)0x0,10);
        phVar4 = gethostbyname(__name);
        if ((phVar4 != (hostent *)0x0) && (ppVar5 = getprotobyname("tcp"), ppVar5 != (protoent *)0x0)) {
          local_94.sa_data[6] = '\0';
          local_94.sa_data[7] = '\0';
          local_94.sa_data[8] = '\0';
          local_94.sa_data[9] = '\0';
          local_94.sa_data[10] = '\0';
          local_94.sa_data[0xb] = '\0';
          local_94.sa_data[0xc] = '\0';
          local_94.sa_data[0xd] = '\0';
          local_94.sa_family = 2;
          local_94.sa_data._0_2_ = (ushort)(byte)((uint)lVar3 >> 8) | (ushort)(lVar3 << 8);
          local_94.sa_data._2_4_ = *(undefined4 *)*phVar4->h_addr_list;
          __fd = socket(2,1,ppVar5->p_proto);
          if (__fd != -1) {
            iVar1 = connect(__fd,&local_94,0x10);
            if (iVar1 != -1) goto LAB_00035fb4;
            close(__fd);
          }
        }
      }
    }
    uVar6 = 0;
  }
  else {
LAB_00035fb4:
    uVar6 = FUN_00050bec(param_2 + 0xc);
    FUN_0004fe78(5,"%s serial %s open at %s bps",uVar6,acStack_84,puVar9);
    __s = (void *)FUN_0004f524(0x1c);
    memset(__s,0,0x1c);
    *(int *)(iVar8 + 0xc) = param_2;
    *(int *)(iVar8 + 0x14) = __fd;
    *(code **)(iVar8 + 4) = FUN_000352a0;
    *(undefined4 *)(iVar8 + 0x10) = 0;
    iVar1 = FUN_00015fc4(iVar8);
    if (iVar1 == 0) {
      *(undefined4 *)(iVar8 + 0x14) = 0xffffffff;
      close(__fd);
      free(__s);
      uVar6 = 0;
    }
    else {
      *(void **)(iVar8 + 0x1c) = __s;
      *(undefined1 *)(param_2 + 0x47) = 0xf7;
      *(char **)(iVar8 + 0x24) = "NMEA GPS Clock";
      *(undefined4 *)(iVar8 + 0x2ec) = 0x535047;
      FUN_00035f24(__fd,param_2);
      uVar6 = 1;
    }
  }
  return uVar6;
}




void FUN_00036180(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  
  iVar1 = *(int *)(param_2 + 0x3c);
  if (*(int *)(iVar1 + 200) != *(int *)(iVar1 + 0xcc)) {
    *(int *)(iVar1 + 0x2f8) = *(int *)(iVar1 + 0x2f8) + 1;
    *(undefined4 *)(iVar1 + 0xd0) = *(undefined4 *)(iVar1 + 0xd8);
    *(undefined4 *)(iVar1 + 0xd4) = *(undefined4 *)(iVar1 + 0xdc);
    FUN_000276a0(param_2);
    FUN_0002ddbc(param_2 + 0xc,iVar1 + 0x28);
    FUN_00035f24(*(undefined4 *)(iVar1 + 0x14),param_2);
    return;
  }
  FUN_00027040(param_2,1,*(int *)(iVar1 + 200),param_4);
  return;
}




void FUN_000361f0(short *param_1,int param_2)

{
  short sVar1;
  
  sVar1 = *param_1;
  *(undefined1 *)(*(int *)(param_1 + 2) + (int)sVar1) = 0x10;
  *(undefined1 *)(*(int *)(param_1 + 2) + (int)(short)(sVar1 + 1)) = 3;
  *param_1 = sVar1 + 2;
  write(param_2,*(void **)(param_1 + 2),(int)(short)(sVar1 + 2));
  return;
}




void FUN_00036270(undefined4 param_1,int param_2)

{
  int __fd;
  int iVar1;
  undefined2 *__s;
  uint uVar2;
  int iVar3;
  char *pcVar4;
  undefined2 local_80 [2];
  undefined1 *local_7c;
  char acStack_78 [20];
  termios local_64;
  
  snprintf(acStack_78,0x14,"/dev/palisade%d",param_1);
  __fd = FUN_00027d18(acStack_78,0xd,0x20);
  if (__fd < 1) {
    printf("Palisade(%d) start: open %s failed\n",param_1,acStack_78);
  }
  else {
    pcVar4 = acStack_78;
    FUN_0004fe78(5,"Palisade(%d) fd: %d dev: %s",param_1,__fd,pcVar4);
    iVar1 = tcgetattr(__fd,&local_64);
    if (iVar1 < 0) {
      FUN_0004fe78(3,"Palisade(%d) tcgetattr(fd, &tio): %m",param_1);
      printf("Palisade(%d) tcgetattr(fd, &tio)\n",param_1);
      close(__fd);
    }
    else {
      local_64.c_cflag = local_64.c_cflag | 0x300;
      local_64.c_iflag = local_64.c_iflag & 0xfffffeff;
      __s = (undefined2 *)FUN_0004f524(0x90);
      memset(__s,0,0x90);
      uVar2 = *(byte *)(param_2 + 0x3b) & 0x7f;
      *(uint *)(__s + 0x46) = uVar2;
      switch(uVar2) {
      case 0:
        break;
      case 1:
        FUN_0004fe78(5,"Palisade(%d) Praecis mode enabled\n",param_1,uVar2,pcVar4);
        break;
      case 2:
        FUN_0004fe78(5,"Palisade(%d) Thunderbolt mode enabled\n",param_1,uVar2,pcVar4);
        local_64.c_cflag = 0x8b0;
        break;
      case 3:
        FUN_0004fe78(5,"Palisade(%d) Acutime Gold mode enabled\n",param_1,uVar2,pcVar4);
        break;
      default:
        FUN_0004fe78(5,"Palisade(%d) mode unknown\n",param_1,uVar2,pcVar4);
      }
      iVar1 = tcsetattr(__fd,0,&local_64);
      if (iVar1 == -1) {
        FUN_0004fe78(3,"Palisade(%d) tcsetattr(fd, &tio): %m",param_1);
        printf("Palisade(%d) tcsetattr(fd, &tio)\n",param_1);
        close(__fd);
        free(__s);
      }
      else {
        iVar3 = *(int *)(param_2 + 0x3c);
        *(int *)(iVar3 + 0xc) = param_2;
        *(int *)(iVar3 + 0x14) = __fd;
        *(code **)(iVar3 + 4) = FUN_00037794;
        *(undefined4 *)(iVar3 + 0x10) = 0;
        iVar1 = FUN_00015fc4(iVar3);
        if (iVar1 == 0) {
          printf("Palisade(%d) io_addclock\n",param_1);
          close(__fd);
          *(undefined4 *)(iVar3 + 0x14) = 0xffffffff;
          free(__s);
        }
        else {
          *(undefined2 **)(iVar3 + 0x1c) = __s;
          *(char **)(iVar3 + 0x24) = "Trimble Palisade GPS";
          *(undefined1 *)(param_2 + 0x47) = 0xec;
          *(undefined1 *)(param_2 + 0x42) = 4;
          *(undefined1 *)(param_2 + 0x31) = 4;
          *(undefined1 *)(param_2 + 0x32) = 5;
          *(undefined4 *)(iVar3 + 0x2ec) = 0x535047;
          iVar1 = *(int *)(__s + 0x46);
          *(undefined1 *)(__s + 4) = 0;
          *__s = (short)param_1;
          *(undefined1 *)((int)__s + 9) = 0;
          __s[5] = 0;
          if (iVar1 == 2) {
            local_7c = (undefined1 *)malloc(100);
            local_80[0] = 4;
            local_7c[1] = 0x8e;
            local_7c[2] = 0xa2;
            local_7c[3] = 3;
            *local_7c = 0x10;
            FUN_000361f0(local_80,__fd);
            *local_7c = 0x10;
            local_7c[1] = 0x8f;
            local_7c[2] = 0xa5;
            local_7c[3] = 0;
            local_7c[4] = 5;
            local_80[0] = 5;
            FUN_000361f0(local_80,__fd);
            free(local_7c);
            iVar1 = *(int *)(__s + 0x46);
          }
          if (iVar1 == 3) {
            local_7c = (undefined1 *)malloc(100);
            local_7c[1] = 0x8e;
            local_80[0] = 7;
            local_7c[3] = 2;
            *local_7c = 0x10;
            local_7c[2] = 0xa5;
            local_7c[4] = 0;
            local_7c[5] = 0;
            local_7c[6] = 0;
            FUN_000361f0(local_80,__fd);
            free(local_7c);
          }
        }
      }
    }
  }
  return;
}




int FUN_00036608(byte *param_1)

{
  int iVar1;
  ushort uVar2;
  uint uVar3;
  
  uVar3 = param_1[1] - 1;
  if (uVar3 < 0xc) {
    uVar2 = (ushort)param_1[3] + (ushort)param_1[2] * 0x100;
    iVar1 = (uint)*param_1 + *(int *)(&DAT_00067704 + uVar3 * 4);
    if ((uVar2 & 3) == 0) {
      if ((((int)(short)uVar2 % 100 != 0) || ((int)(short)uVar2 % 400 == 0)) && (2 < param_1[1])) {
        iVar1 = iVar1 + 1;
      }
    }
  }
  else {
    iVar1 = -1;
  }
  return iVar1;
}




byte FUN_000366a0(int param_1)

{
  byte bVar1;
  byte bVar2;
  byte bVar3;
  int iVar4;
  int iVar5;
  char *pcVar6;
  int iVar7;
  byte bVar8;
  int iVar9;
  char cVar10;
  undefined1 uVar11;
  uint uVar12;
  short *psVar13;
  int iVar14;
  uint uVar15;
  short *psVar16;
  int iVar17;
  int iVar18;
  bool bVar19;
  undefined4 uVar20;
  double dVar21;
  
  iVar14 = *(int *)(param_1 + 0x3c);
  psVar13 = *(short **)(iVar14 + 0x1c);
  iVar9 = *(int *)(psVar13 + 0x46);
  cVar10 = (char)psVar13[6];
  if ((1 < iVar9 - 2U) &&
     ((((cVar10 == 'A' || cVar10 == 'F' || (cVar10 == 'T')) || (cVar10 == 'K')) || (cVar10 == 'm')))) {
    puts("Palisade Port B packets detected. Connect to Port A");
    return 0;
  }
  if (cVar10 != -0x71) {
    if (cVar10 == 'B') {
      puts("0x42");
      return 0;
    }
    if (cVar10 == 'C') {
      puts("0x43");
      return 0;
    }
    if (iVar9 == 2 && cVar10 == 'A') {
      puts("Undocumented 0x41 packet on Thunderbolt");
      return 0;
    }
    if (cVar10 == 'A' && iVar9 == 3) {
      printf("GPS TOW: %ld\n",
             (uint)*(byte *)(psVar13 + 7) << 0x10 | (uint)*(byte *)((int)psVar13 + 0xd) << 0x18 |
             (uint)*(byte *)(psVar13 + 8) | (uint)*(byte *)((int)psVar13 + 0xf) << 8);
      printf("GPS WN: %d\n",
             (int)(short)((ushort)*(byte *)(psVar13 + 9) + (ushort)*(byte *)((int)psVar13 + 0x11) * 0x100));
      printf("GPS UTC-GPS Offser: %ld\n",
             (uint)*(byte *)(psVar13 + 10) << 0x10 | (uint)*(byte *)((int)psVar13 + 0x13) << 0x18 |
             (uint)*(byte *)(psVar13 + 0xb) | (uint)*(byte *)((int)psVar13 + 0x15) << 8);
      return 0;
    }
    if (cVar10 == 'F' && iVar9 == 3) {
      if (1 < DAT_0007cf4c) {
        switch(*(undefined1 *)((int)psVar13 + 0xd)) {
        case 0:
          puts("Doing Position Fixes");
          break;
        case 1:
          puts("Do no have GPS time yet");
          break;
        case 3:
          puts("PDOP is too high");
          break;
        case 8:
          puts("No usable satellites");
          break;
        case 9:
          puts("Only 1 usable satellite");
          break;
        case 10:
          puts("Only 2 usable satellites");
          break;
        case 0xb:
          puts("Only 3 usable satellites");
          break;
        case 0xc:
          puts("The Chosen satellite is unusable");
        }
      }
      if ((char)psVar13[7] != '\0') {
        FUN_00027040(param_1,6);
        iVar9 = DAT_0007cf4c;
        psVar13[2] = -1;
        psVar13[3] = -1;
        if (iVar9 < 2) {
          return 0;
        }
        if ((char)psVar13[7] == '\0') {
          return 0;
        }
        puts("Signal Processor Error, reset unit.");
        if ((char)psVar13[7] == '\0') {
          return 0;
        }
        puts("Alignment error, channel or chip 1, reset unit.");
        if ((char)psVar13[7] == '\0') {
          return 0;
        }
        puts("Alignment error, channel or chip 2, reset unit.");
        if ((char)psVar13[7] == '\0') {
          return 0;
        }
        puts("Antenna feed line fault (open or short)");
        if ((char)psVar13[7] == '\0') {
          return 0;
        }
        puts(
            "Excessive reference frequency error, refer to packet 0x2D and packet 0x4D documentation for further information"
            );
        return 0;
      }
    }
    else {
      if (cVar10 == 'T') {
        return 0;
      }
      if (cVar10 == 'm') {
        bVar8 = *(byte *)((int)psVar13 + 0xd);
        if ((bVar8 & 3) == 3) {
          puts("2d Fix Dimension");
          bVar8 = *(byte *)((int)psVar13 + 0xd);
        }
        if ((bVar8 & 4) != 0) {
          puts("3d Fix Dimension");
          bVar8 = *(byte *)((int)psVar13 + 0xd);
        }
        if ((bVar8 & 8) == 0) {
          pcVar6 = "Fix Mode is AUTO";
        }
        else {
          pcVar6 = "Fix Mode is MANUAL";
        }
        puts(pcVar6);
        printf("Tracking %d Satellites\n",(uint)(*(byte *)((int)psVar13 + 0xd) >> 4));
        return 0;
      }
    }
    uVar15 = 0;
    goto LAB_00036764;
  }
  uVar15 = (uint)*(byte *)((int)psVar13 + 0xf) + (uint)*(byte *)(psVar13 + 7) * 0x100 & 0xffff;
  if (((*(byte *)(iVar14 + 0x2f0) & 2) == 0) && (uVar15 == 0)) {
    return 0;
  }
  bVar8 = *(byte *)((int)psVar13 + 0xd);
  if (bVar8 == 0xab) {
    if (psVar13[5] != 0x11) goto LAB_00036764;
    if (*(int *)(psVar13 + 2) < 1) {
      return 0;
    }
    if ((ushort)((ushort)*(byte *)((int)psVar13 + 0x15) + (ushort)*(byte *)(psVar13 + 10) * 0x100) != 0) {
      bVar8 = *(byte *)(psVar13 + 0xb);
      if ((bVar8 & 0x1d) == 0) {
        *(undefined1 *)(iVar14 + 0x20) = 3;
        FUN_00027040(param_1,6);
        psVar13[2] = -1;
        psVar13[3] = -1;
        return bVar8 & 0x1d;
      }
      *(undefined4 *)(iVar14 + 0xc0) = 0;
      puts("\nTiming Flags are:");
      printf("Timing flag value is: 0x%X\n",(uint)*(byte *)(psVar13 + 0xb));
      if ((*(byte *)(psVar13 + 0xb) & 1) == 0) {
        pcVar6 = "\tGetting GPS time";
      }
      else {
        pcVar6 = "\tGetting UTC time";
      }
      puts(pcVar6);
      if ((*(byte *)(psVar13 + 0xb) & 2) == 0) {
        pcVar6 = "\tPPS is from GPS";
      }
      else {
        pcVar6 = "\tPPS is from UTC";
      }
      puts(pcVar6);
      if ((*(byte *)(psVar13 + 0xb) & 4) == 0) {
        pcVar6 = "\tTime is Set";
      }
      else {
        pcVar6 = "\tTime is not Set";
      }
      puts(pcVar6);
      if ((*(byte *)(psVar13 + 0xb) & 8) == 0) {
        pcVar6 = "\tI have UTC info";
      }
      else {
        pcVar6 = "\tI dont have UTC info";
      }
      puts(pcVar6);
      if ((*(byte *)(psVar13 + 0xb) & 0x10) == 0) {
        pcVar6 = "\tTime is from GPS\n";
      }
      else {
        pcVar6 = "\tTime is from USER\n";
      }
      puts(pcVar6);
      iVar9 = FUN_00036608(psVar13 + 0xd);
      *(int *)(iVar14 + 0xb0) = iVar9;
      if (-1 < iVar9) {
        bVar8 = *(byte *)(psVar13 + 7);
        bVar2 = *(byte *)((int)psVar13 + 0xf);
        bVar3 = *(byte *)(psVar13 + 8);
        bVar1 = *(byte *)((int)psVar13 + 0x11);
        if (1 < DAT_0007cf4c) {
          printf("pp->day: %d\n",iVar9);
          printf("TOW: %ld\n",(uint)bVar2 << 0x10 | (uint)bVar8 << 0x18 | (uint)bVar1 | (uint)bVar3 << 8);
          printf("DAY: %d\n",(uint)*(byte *)(psVar13 + 0xd));
        }
        iVar9 = DAT_0007cf4c;
        iVar18 = (int)(short)((ushort)*(byte *)((int)psVar13 + 0x1d) + (ushort)*(byte *)(psVar13 + 0xe) * 0x100);
        *(int *)(iVar14 + 0xac) = iVar18;
        bVar8 = *(byte *)((int)psVar13 + 0x19);
        *(uint *)(iVar14 + 0xb4) = (uint)bVar8;
        bVar2 = *(byte *)(psVar13 + 0xc);
        *(uint *)(iVar14 + 0xb8) = (uint)bVar2;
        bVar3 = *(byte *)((int)psVar13 + 0x17);
        *(uint *)(iVar14 + 0xbc) = (uint)bVar3;
        if (iVar9 < 2) {
          return 1;
        }
        printf("TSIP_decode: unit %d: %02X #%d %02d:%02d:%02d.%06ld %02d/%02d/%04d ",(int)*psVar13,
               (uint)*(byte *)((int)psVar13 + 0xd),uVar15,(uint)bVar8,(uint)bVar2,(uint)bVar3,
               *(undefined4 *)(iVar14 + 0xc0),(uint)*(byte *)((int)psVar13 + 0x1b),(uint)*(byte *)(psVar13 + 0xd),iVar18
              );
        return 1;
      }
      goto LAB_00036764;
    }
  }
  else {
    if (0xab < bVar8) {
      if (bVar8 == 0xac) {
        if (0 < *(int *)(psVar13 + 2)) {
          if (psVar13[5] != 0x44) goto LAB_00036764;
          if (1 < DAT_0007cf4c) {
            dVar21 = (double)CONCAT17(*(undefined1 *)((int)psVar13 + 0x31),
                                      CONCAT16((char)psVar13[0x19],
                                               CONCAT15(*(undefined1 *)((int)psVar13 + 0x33),
                                                        CONCAT14((char)psVar13[0x1a],
                                                                 CONCAT13(*(undefined1 *)((int)psVar13 + 0x35),
                                                                          CONCAT12((char)psVar13[0x1b],
                                                                                   CONCAT11(*(undefined1 *)
                                                                                             ((int)psVar13 + 0x37),
                                                                                            (char)psVar13[0x1c]))))))) *
                     57.295779513082195;
            printf("TSIP_decode: unit %d: Latitude: %03.4f Longitude: %03.4f Alt: %05.2f m\n",(int)*psVar13,
                   SUB84(dVar21,0),(int)((ulonglong)dVar21 >> 0x20),
                   (double)CONCAT17(*(undefined1 *)((int)psVar13 + 0x39),
                                    CONCAT16((char)psVar13[0x1d],
                                             CONCAT15(*(undefined1 *)((int)psVar13 + 0x3b),
                                                      CONCAT14((char)psVar13[0x1e],
                                                               CONCAT13(*(undefined1 *)((int)psVar13 + 0x3d),
                                                                        CONCAT12((char)psVar13[0x1f],
                                                                                 CONCAT11(*(undefined1 *)
                                                                                           ((int)psVar13 + 0x3f),
                                                                                          (char)psVar13[0x20]))))))) *
                   57.295779513082195,
                   CONCAT13(*(undefined1 *)((int)psVar13 + 0x45),
                            CONCAT12((char)psVar13[0x23],
                                     CONCAT11(*(undefined1 *)((int)psVar13 + 0x47),(char)psVar13[0x24]))),
                   CONCAT13(*(undefined1 *)((int)psVar13 + 0x41),
                            CONCAT12((char)psVar13[0x21],
                                     CONCAT11(*(undefined1 *)((int)psVar13 + 0x43),(char)psVar13[0x22]))));
            printf("TSIP_decode: unit %d\n",(int)*psVar13);
          }
          iVar9 = DAT_0007cf4c;
          bVar8 = *(byte *)(psVar13 + 0xc) & 0x80;
          if ((*(byte *)(psVar13 + 0xc) & 0x80) != 0) {
            bVar8 = 1;
          }
          *(byte *)(iVar14 + 0x20) = bVar8;
          if ((1 < iVar9) &&
             (printf("TSIP_decode: unit %d: 0x%02x leap %d\n",(int)*psVar13,(uint)*(byte *)((int)psVar13 + 0xd),
                     (uint)*(byte *)(iVar14 + 0x20)), 1 < DAT_0007cf4c)) {
            printf("Receiver MODE: 0x%02X\n",(uint)*(byte *)(psVar13 + 7));
            cVar10 = (char)psVar13[7];
            if (cVar10 == '\0') {
              puts("                AUTOMATIC");
              cVar10 = (char)psVar13[7];
            }
            if (cVar10 == '\x01') {
              puts("                SINGLE SATELLITE");
              cVar10 = (char)psVar13[7];
            }
            if (cVar10 == '\x03') {
              puts("                HORIZONTAL(2D)");
              cVar10 = (char)psVar13[7];
            }
            if (cVar10 == '\x04') {
              puts("                FULL POSITION(3D)");
              cVar10 = (char)psVar13[7];
            }
            if (cVar10 == '\x05') {
              puts("                DGPR REFERENCE");
              cVar10 = (char)psVar13[7];
            }
            if (cVar10 == '\x06') {
              puts("                CLOCK HOLD(2D)");
              cVar10 = (char)psVar13[7];
            }
            if (cVar10 == '\a') {
              puts("                OVERDETERMINED CLOCK");
            }
            printf("\n** Disciplining MODE 0x%02X:\n",(uint)*(byte *)((int)psVar13 + 0xf));
            cVar10 = *(char *)((int)psVar13 + 0xf);
            if (cVar10 == '\0') {
              puts("                NORMAL");
              cVar10 = *(char *)((int)psVar13 + 0xf);
            }
            if (cVar10 == '\x01') {
              puts("                POWER-UP");
              cVar10 = *(char *)((int)psVar13 + 0xf);
            }
            if (cVar10 == '\x02') {
              puts("                AUTO HOLDOVER");
              cVar10 = *(char *)((int)psVar13 + 0xf);
            }
            if (cVar10 == '\x03') {
              puts("                MANUAL HOLDOVER");
              cVar10 = *(char *)((int)psVar13 + 0xf);
            }
            if (cVar10 == '\x04') {
              puts("                RECOVERY");
              cVar10 = *(char *)((int)psVar13 + 0xf);
            }
            if (cVar10 == '\x06') {
              puts("                DISCIPLINING DISABLED");
              return 0;
            }
          }
        }
      }
      else if (bVar8 == 0xad) {
        if (psVar13[5] == 0x16) {
          bVar8 = *(byte *)(psVar13 + 0x10);
          *(byte *)(psVar13 + 4) = bVar8;
          if (*(int *)(psVar13 + 2) < 1) {
            return 0;
          }
          uVar12 = (uint)*(byte *)((int)psVar13 + 0x1f);
          if (uVar12 < 0xf) {
            bVar19 = 10 < uVar12;
            if (uVar12 != 0xb) {
              bVar19 = 4 < uVar12 - 2;
            }
            if ((!bVar19 || (uVar12 == 0xb || uVar12 - 2 == 5)) || (uVar12 == 0xc)) {
              printf("TSIP_decode: Not Tracking Sats : %s\n",*(undefined4 *)(&DAT_0007a7b0 + uVar12 * 0x3c));
              FUN_00027040(param_1,6);
              psVar13[2] = -1;
              psVar13[3] = -1;
              return 0;
            }
          }
          else {
            uVar12 = 0xe;
          }
          if ((bVar8 & 2) == 0) {
            if (bVar8 == 0) {
              *(undefined1 *)(iVar14 + 0x20) = 3;
              printf("TSIP_decode: UTC Almanac unavailable: %d\n",(uint)*(byte *)(psVar13 + 0x10));
              FUN_00027040(param_1,6);
              psVar13[2] = -1;
              psVar13[3] = -1;
              return 0;
            }
            *(byte *)(iVar14 + 0x20) = bVar8 & 2;
          }
          else {
            if ((bVar8 & 1) == 0) {
              uVar11 = 2;
            }
            else {
              uVar11 = 1;
            }
            *(undefined1 *)(iVar14 + 0x20) = uVar11;
          }
          uVar20 = (undefined4)
                   (longlong)
                   ((double)CONCAT17((char)psVar13[8],
                                     CONCAT16(*(undefined1 *)((int)psVar13 + 0x11),
                                              CONCAT15((char)psVar13[9],
                                                       CONCAT14(*(undefined1 *)((int)psVar13 + 0x13),
                                                                CONCAT13((char)psVar13[10],
                                                                         CONCAT12(*(undefined1 *)((int)psVar13 + 0x15),
                                                                                  CONCAT11((char)psVar13[0xb],
                                                                                           *(undefined1 *)
                                                                                            ((int)psVar13 + 0x17))))))))
                   * 1000000000.0);
          *(undefined4 *)(iVar14 + 0xc0) = uVar20;
          iVar9 = FUN_00036608((int)psVar13 + 0x1b);
          *(int *)(iVar14 + 0xb0) = iVar9;
          if (-1 < iVar9) {
            iVar18 = (int)(short)((ushort)*(byte *)(psVar13 + 0xf) + (ushort)*(byte *)((int)psVar13 + 0x1d) * 0x100);
            *(int *)(iVar14 + 0xac) = iVar18;
            iVar9 = DAT_0007cf4c;
            bVar8 = *(byte *)(psVar13 + 0xc);
            *(uint *)(iVar14 + 0xb4) = (uint)bVar8;
            bVar2 = *(byte *)((int)psVar13 + 0x19);
            *(uint *)(iVar14 + 0xb8) = (uint)bVar2;
            bVar3 = *(byte *)(psVar13 + 0xd);
            *(uint *)(iVar14 + 0xbc) = (uint)bVar3;
            if (iVar9 < 2) {
              return 1;
            }
            printf("TSIP_decode: unit %d: %02X #%d %02d:%02d:%02d.%06ld %02d/%02d/%04d UTC %02x %s\n",(int)*psVar13,
                   (uint)*(byte *)((int)psVar13 + 0xd),uVar15,(uint)bVar8,(uint)bVar2,(uint)bVar3,uVar20,
                   (uint)*(byte *)(psVar13 + 0xe),(uint)*(byte *)((int)psVar13 + 0x1b),iVar18,
                   (uint)*(byte *)(psVar13 + 0x10),*(undefined4 *)(&DAT_0007a7b0 + uVar12 * 0x3c));
            return 1;
          }
        }
        goto LAB_00036764;
      }
      return 0;
    }
    if (bVar8 != 0xb) {
      return 0;
    }
    if (*(int *)(psVar13 + 2) < 1) {
      return 0;
    }
    if (psVar13[5] != 0x4a) goto LAB_00036764;
    if (1 < DAT_0007cf4c) {
      iVar9 = 0x42;
      dVar21 = (double)CONCAT17(*(undefined1 *)((int)psVar13 + 0x37),
                                CONCAT16((char)psVar13[0x1c],
                                         CONCAT15(*(undefined1 *)((int)psVar13 + 0x39),
                                                  CONCAT14((char)psVar13[0x1d],
                                                           CONCAT13(*(undefined1 *)((int)psVar13 + 0x3b),
                                                                    CONCAT12((char)psVar13[0x1e],
                                                                             CONCAT11(*(undefined1 *)
                                                                                       ((int)psVar13 + 0x3d),
                                                                                      (char)psVar13[0x1f]))))))) *
               57.295779513082195;
      printf("TSIP_decode: unit %d: Latitude: %03.4f Longitude: %03.4f Alt: %05.2f m\n",(int)*psVar13,SUB84(dVar21,0),
             (int)((ulonglong)dVar21 >> 0x20),
             (double)CONCAT17(*(undefined1 *)((int)psVar13 + 0x3f),
                              CONCAT16((char)psVar13[0x20],
                                       CONCAT15(*(undefined1 *)((int)psVar13 + 0x41),
                                                CONCAT14((char)psVar13[0x21],
                                                         CONCAT13(*(undefined1 *)((int)psVar13 + 0x43),
                                                                  CONCAT12((char)psVar13[0x22],
                                                                           CONCAT11(*(undefined1 *)((int)psVar13 + 0x45)
                                                                                    ,(char)psVar13[0x23]))))))) *
             57.295779513082195,
             CONCAT17(*(undefined1 *)((int)psVar13 + 0x47),
                      CONCAT16((char)psVar13[0x24],
                               CONCAT15(*(undefined1 *)((int)psVar13 + 0x49),
                                        CONCAT14((char)psVar13[0x25],
                                                 CONCAT13(*(undefined1 *)((int)psVar13 + 0x4b),
                                                          CONCAT12((char)psVar13[0x26],
                                                                   CONCAT11(*(undefined1 *)((int)psVar13 + 0x4d),
                                                                            (char)psVar13[0x27]))))))));
      printf("TSIP_decode: unit %d: Sats:",(int)*psVar13);
      iVar18 = 0;
      psVar16 = psVar13;
      do {
        pcVar6 = (char *)((int)psVar16 + 0x4f);
        iVar9 = iVar9 + 1;
        psVar16 = (short *)((int)psVar16 + 1);
        if (*pcVar6 != '\0') {
          iVar18 = iVar18 + 1;
          printf(" %02d");
        }
      } while (iVar9 != 0x4a);
      printf(" : Tracking %d\n",iVar18);
    }
    iVar9 = (int)(short)((ushort)*(byte *)(psVar13 + 0xf) + (ushort)*(byte *)((int)psVar13 + 0x1d) * 0x100);
    if (iVar9 != 0) {
      dVar21 = (double)CONCAT17((char)psVar13[8],
                                CONCAT16(*(undefined1 *)((int)psVar13 + 0x11),
                                         CONCAT15((char)psVar13[9],
                                                  CONCAT14(*(undefined1 *)((int)psVar13 + 0x13),
                                                           CONCAT13((char)psVar13[10],
                                                                    CONCAT12(*(undefined1 *)((int)psVar13 + 0x15),
                                                                             CONCAT11((char)psVar13[0xb],
                                                                                      *(undefined1 *)
                                                                                       ((int)psVar13 + 0x17))))))));
      iVar18 = (int)(longlong)dVar21;
      iVar7 = iVar18 % 0x15180;
      uVar20 = (undefined4)(longlong)((dVar21 - (double)(longlong)iVar18) * 1000000000.0);
      iVar18 = iVar7 / 0xe10;
      *(int *)(iVar14 + 0xb4) = iVar18;
      iVar7 = iVar7 % 0xe10;
      *(undefined4 *)(iVar14 + 0xc0) = uVar20;
      iVar4 = iVar7 / 0x3c;
      *(int *)(iVar14 + 0xb8) = iVar4;
      iVar17 = (iVar7 % 0x3c) % 0x3c;
      *(int *)(iVar14 + 0xbc) = iVar17;
      iVar5 = FUN_00036608(psVar13 + 0xc);
      *(int *)(iVar14 + 0xb0) = iVar5;
      iVar7 = DAT_0007cf4c;
      if (-1 < iVar5) {
        iVar5 = (int)(short)((ushort)*(byte *)((int)psVar13 + 0x1b) + (ushort)*(byte *)(psVar13 + 0xd) * 0x100);
        *(int *)(iVar14 + 0xac) = iVar5;
        if (1 < iVar7) {
          printf("TSIP_decode: unit %d: %02X #%d %02d:%02d:%02d.%06ld %02d/%02d/%04d UTC %02d\n",(int)*psVar13,
                 (uint)*(byte *)((int)psVar13 + 0xd),uVar15,iVar18,iVar4,iVar17,uVar20,
                 (uint)*(byte *)((int)psVar13 + 0x19),(uint)*(byte *)(psVar13 + 0xc),iVar5,iVar9);
        }
        if ((char)psVar13[4] != '\0') {
          *(undefined1 *)(psVar13 + 4) = 0;
          return 0;
        }
        return 2;
      }
      goto LAB_00036764;
    }
  }
  puts("TSIP_decode: UTC Offset Unknown");
LAB_00036764:
  FUN_00027040(param_1,2);
  psVar13[2] = -1;
  psVar13[3] = -1;
  printf("TSIP_decode: unit %d: bad packet %02x-%02x event %d len %d\n",(int)*psVar13,(uint)*(byte *)(psVar13 + 6),
         (uint)*(byte *)((int)psVar13 + 0xd),uVar15,(int)psVar13[5]);
  return 0;
}




undefined4 FUN_0003751c(int param_1)

{
  short sVar1;
  int iVar2;
  undefined4 uVar3;
  int *piVar4;
  char *pcVar5;
  short *psVar6;
  uint local_14 [2];
  
  psVar6 = *(short **)(param_1 + 0x1c);
  iVar2 = ioctl(*(int *)(param_1 + 0x14),0x5415,local_14);
  if (iVar2 < 0) {
    if (DAT_0007cf4c != 0) {
      piVar4 = __errno_location();
      sVar1 = *psVar6;
      pcVar5 = strerror(*piVar4);
      printf("Palisade HW_poll: unit %d: GET %s\n",(int)sVar1,pcVar5);
    }
    FUN_0004fe78(3,"Palisade(%d) HW_poll: ioctl(fd,GET): %m",(int)*psVar6);
    uVar3 = 0xffffffff;
  }
  else {
    local_14[0] = local_14[0] | 4;
    if (*(int *)(psVar6 + 0x46) == 3) {
      write(*(int *)(param_1 + 0x14),&DAT_000665cc,1);
    }
    iVar2 = ioctl(*(int *)(param_1 + 0x14),0x5418,local_14);
    if (iVar2 < 0) {
      if (DAT_0007cf4c != 0) {
        printf("Palisade HW_poll: unit %d: SET \n",(int)*psVar6);
      }
      FUN_0004fe78(3,"Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m",(int)*psVar6);
      uVar3 = 0xffffffff;
    }
    else {
      local_14[0] = local_14[0] & 0xfffffffb;
      FUN_0004cba8(param_1 + 0xd8);
      iVar2 = ioctl(*(int *)(param_1 + 0x14),0x5418,local_14);
      if (iVar2 == -1) {
        if (DAT_0007cf4c != 0) {
          printf("Palisade HW_poll: unit %d: UNSET \n",(int)*psVar6);
        }
        FUN_0004fe78(3,"Palisade(%d) HW_poll: ioctl(fd, UNSET, RTS_off): %m",(int)*psVar6);
        uVar3 = 0xffffffff;
      }
      else {
        uVar3 = 0;
      }
    }
  }
  return uVar3;
}




void FUN_00037694(undefined4 param_1,int param_2)

{
  ssize_t sVar1;
  char *pcVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar4 = *(int *)(param_2 + 0x3c);
  iVar5 = *(int *)(iVar4 + 0x1c);
  iVar3 = *(int *)(iVar5 + 4);
  *(int *)(iVar4 + 0x2f8) = *(int *)(iVar4 + 0x2f8) + 1;
  if (0 < iVar3) {
    FUN_00027040(param_2,1);
  }
  *(undefined4 *)(iVar5 + 4) = 2;
  if (DAT_0007cf4c != 0) {
    pcVar2 = "event";
    if ((*(byte *)(iVar4 + 0x2f0) & 2) != 0) {
      pcVar2 = "synchronous packet";
    }
    printf("palisade_poll: unit %d: polling %s\n",param_1,pcVar2);
  }
  if ((*(byte *)(iVar4 + 0x2f0) & 2) != 0) {
    return;
  }
  if (*(int *)(iVar5 + 0x8c) == 1) {
    sVar1 = write(*(int *)(*(int *)(param_2 + 0x3c) + 0x14),"SPSTAT\r\n",8);
    if (-1 < sVar1) {
      DAT_000cb594 = 1;
      return;
    }
    FUN_0004fe78(3,"Palisade(%d) write: %m:",param_1);
  }
  iVar3 = FUN_0003751c(iVar4);
  if (-1 < iVar3) {
    return;
  }
  FUN_00027040(param_2,3);
  return;
}




void FUN_00037794(int param_1)

{
  char cVar1;
  undefined1 uVar2;
  short sVar3;
  int iVar4;
  undefined4 uVar5;
  short *psVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  bool bVar13;
  
  iVar9 = DAT_00080134;
  iVar10 = *(int *)(param_1 + 8);
  iVar12 = *(int *)(iVar10 + 0x3c);
  iVar8 = *(int *)(iVar12 + 0x1c);
  if ((*(int *)(iVar8 + 0x8c) == 1) && (DAT_000cb594 != 0)) {
    memcpy(&DAT_00080138 + DAT_00080134,(void *)(param_1 + 0x5c),*(size_t *)(param_1 + 0x58));
    DAT_00080134 = iVar9 + *(int *)(param_1 + 0x58);
    if ((*(char *)((int)&DAT_00080134 + DAT_00080134 + 2) == '\r') &&
       (*(char *)((int)&DAT_00080134 + DAT_00080134 + 3) == '\n')) {
      *(undefined1 *)((int)&DAT_00080134 + DAT_00080134 + 2) = 0;
      FUN_0002ddbc(iVar10 + 0xc,&DAT_00080138);
      DAT_00080134 = 0;
      DAT_000cb594 = 0;
      iVar9 = FUN_0003751c(iVar12);
      if (iVar9 < 0) {
        FUN_00027040(iVar10,3);
        return;
      }
    }
  }
  else {
    iVar9 = param_1 + 0x5c + *(int *)(param_1 + 0x58);
    if (param_1 + 0x5c != iVar9) {
      iVar7 = param_1 + 0x5d;
      do {
        while (cVar1 = *(char *)(iVar8 + 9), cVar1 != '\x03') {
          if (cVar1 == '\x04') {
            if (*(char *)(iVar7 + -1) == '\x10') {
              sVar3 = *(short *)(iVar8 + 10);
              *(undefined1 *)(iVar8 + 9) = 3;
              uVar2 = *(undefined1 *)(iVar7 + -1);
              *(short *)(iVar8 + 10) = sVar3 + 1;
              *(undefined1 *)(iVar8 + sVar3 + 0xd) = uVar2;
            }
            else {
              if (*(char *)(iVar7 + -1) != '\x03') {
                *(undefined1 *)(iVar8 + 9) = 2;
                *(undefined1 *)(iVar8 + 0xc) = *(undefined1 *)(iVar7 + -1);
                goto LAB_000379c0;
              }
              *(undefined1 *)(iVar8 + 9) = 1;
            }
            goto LAB_00037844;
          }
          if (cVar1 == '\x02') {
            if ((*(byte *)(iVar7 + -1) < 0x11) && ((1 << (uint)*(byte *)(iVar7 + -1) & 0x10009U) != 0))
            goto LAB_000377f8;
            *(undefined1 *)(iVar8 + 9) = 3;
            *(undefined1 *)(iVar8 + 0xc) = *(undefined1 *)(iVar7 + -1);
            goto LAB_00037844;
          }
          if (*(byte *)(iVar7 + -1) == 0x10) {
            *(undefined1 *)(iVar8 + 9) = 2;
LAB_000379c0:
            *(undefined2 *)(iVar8 + 10) = 0;
            if ((*(byte *)(iVar12 + 0x2f0) & 2) == 0) goto LAB_00037858;
            FUN_0004cba8(iVar12 + 0xd8);
            cVar1 = *(char *)(iVar8 + 9);
            goto LAB_0003785c;
          }
LAB_000377f8:
          *(undefined1 *)(iVar8 + 9) = 0;
          *(undefined2 *)(iVar8 + 10) = 0;
LAB_00037804:
          bVar13 = iVar9 == iVar7;
          iVar7 = iVar7 + 1;
          if (bVar13) {
            return;
          }
        }
        cVar1 = *(char *)(iVar7 + -1);
        if (cVar1 == '\x10') {
          *(undefined1 *)(iVar8 + 9) = 4;
        }
        else {
          sVar3 = *(short *)(iVar8 + 10);
          *(short *)(iVar8 + 10) = sVar3 + 1;
          *(char *)(iVar8 + sVar3 + 0xd) = cVar1;
        }
LAB_00037844:
        if (0x80 < *(short *)(iVar8 + 10)) {
          *(undefined1 *)(iVar8 + 9) = 0;
          goto LAB_00037804;
        }
LAB_00037858:
        cVar1 = *(char *)(iVar8 + 9);
LAB_0003785c:
        if (cVar1 != '\x01') goto LAB_00037804;
        iVar11 = *(int *)(iVar10 + 0x3c);
        psVar6 = *(short **)(iVar11 + 0x1c);
        iVar4 = FUN_000366a0(iVar10);
        if ((iVar4 == 0) || (*(int *)(psVar6 + 2) < 1)) goto LAB_00037804;
        bVar13 = DAT_0007cf4c != 0;
        psVar6[2] = 0;
        psVar6[3] = 0;
        *(undefined4 *)(iVar11 + 0xa8) = 0;
        if (bVar13) {
          printf("palisade_receive: unit %d: %4d %03d %02d:%02d:%02d.%06ld\n",(int)*psVar6,
                 *(undefined4 *)(iVar11 + 0xac),*(undefined4 *)(iVar11 + 0xb0),*(undefined4 *)(iVar11 + 0xb4),
                 *(undefined4 *)(iVar11 + 0xb8),*(undefined4 *)(iVar11 + 0xbc),*(undefined4 *)(iVar11 + 0xc0));
        }
        snprintf((char *)(iVar11 + 0x28),0x80,"%4d %03d %02d:%02d:%02d.%06ld",*(undefined4 *)(iVar11 + 0xac),
                 *(undefined4 *)(iVar11 + 0xb0),*(undefined4 *)(iVar11 + 0xb4),*(undefined4 *)(iVar11 + 0xb8),
                 *(undefined4 *)(iVar11 + 0xbc),*(undefined4 *)(iVar11 + 0xc0));
        *(undefined4 *)(iVar11 + 0xa8) = 0x18;
        iVar4 = FUN_00027698(iVar11);
        if (iVar4 == 0) {
          FUN_00027040(iVar10,6);
          printf("palisade_receive: unit %d: refclock_process failed!\n",(int)*psVar6);
          goto LAB_00037804;
        }
        FUN_0002ddbc(iVar10 + 0xc,(char *)(iVar11 + 0x28));
        if (DAT_0007cf4c != 0) {
          sVar3 = *psVar6;
          uVar5 = FUN_000503e0((undefined4 *)(iVar11 + 0xd8));
          printf("palisade_receive: unit %d: %s\n",(int)sVar3,uVar5);
        }
        *(undefined4 *)(iVar11 + 0xd0) = *(undefined4 *)(iVar11 + 0xd8);
        *(undefined4 *)(iVar11 + 0xd4) = *(undefined4 *)(iVar11 + 0xdc);
        FUN_000276a0(iVar10);
        bVar13 = iVar9 == iVar7;
        iVar7 = iVar7 + 1;
        if (bVar13) {
          return;
        }
      } while( true );
    }
  }
  return;
}




bool FUN_00037eb8(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  char acStack_98 [128];
  
  snprintf(acStack_98,0x80,"/dev/pcfclocks/%d",param_1);
  iVar1 = open(acStack_98,0);
  if (iVar1 == -1) {
    snprintf(acStack_98,0x80,"/dev/pcfclock%d",param_1);
    iVar1 = open(acStack_98,0);
  }
  if (DAT_0007cf4c != 0) {
    printf("starting PCF with device %s\n",acStack_98);
  }
  if (iVar1 != -1) {
    iVar2 = *(int *)(param_2 + 0x3c);
    *(int *)(iVar2 + 0xc) = param_2;
    *(int *)(iVar2 + 0x14) = iVar1;
    *(undefined4 *)(iVar2 + 4) = 0;
    *(undefined4 *)(iVar2 + 0x10) = 0;
    *(undefined1 *)(param_2 + 0x47) = 0xff;
    *(undefined4 *)(iVar2 + 0x2d8) = 0xe147ae14;
    *(undefined4 *)(iVar2 + 0x2dc) = 0x3fc6147a;
    *(char **)(iVar2 + 0x24) = "Conrad parallel port radio clock";
    *(undefined4 *)(iVar2 + 0x2ec) = 0x464350;
  }
  return iVar1 != -1;
}




void FUN_00037fc0(undefined4 param_1,int param_2)

{
  int iVar1;
  ssize_t sVar2;
  undefined4 *puVar3;
  int iVar4;
  int iVar5;
  
  iVar4 = *(int *)(param_2 + 0x3c);
  iVar5 = iVar4 + 0x28;
  puVar3 = *(undefined4 **)(iVar4 + 0x1c);
  iVar1 = *(int *)(iVar4 + 0x14);
  *puVar3 = 0;
  puVar3[1] = iVar5;
  sVar2 = write(iVar1,"QTQDQMT",6);
  if (sVar2 != 6) {
    FUN_00027040(param_2,3);
  }
  if (0 < *(int *)(param_2 + 0x74)) {
    return;
  }
  if (*(int *)(iVar4 + 200) != *(int *)(iVar4 + 0xcc)) {
    FUN_000276a0();
    FUN_0002ddbc(param_2 + 0xc,iVar5);
    if (DAT_0007cf4c != 0) {
      printf("pst: timecode %d %s\n",*(undefined4 *)(iVar4 + 0xa8),iVar5);
    }
    iVar1 = *(int *)(iVar4 + 0x2f8);
    *(undefined4 *)(param_2 + 0x74) = 0x3c;
    *(int *)(iVar4 + 0x2f8) = iVar1 + 1;
    return;
  }
  FUN_00027040(param_2,1);
  return;
}




int FUN_000380b8(undefined4 param_1,int param_2)

{
  int __fd;
  undefined1 *__ptr;
  int iVar1;
  int iVar2;
  char acStack_2c [20];
  
  snprintf(acStack_2c,0x14,"/dev/wwv%d",param_1);
  __fd = FUN_00027d18(acStack_2c,0xd,1);
  if (__fd != 0) {
    __ptr = (undefined1 *)FUN_0004f524(8);
    *__ptr = 0;
    __ptr[1] = 0;
    __ptr[2] = 0;
    __ptr[3] = 0;
    __ptr[4] = 0;
    __ptr[5] = 0;
    __ptr[6] = 0;
    __ptr[7] = 0;
    iVar2 = *(int *)(param_2 + 0x3c);
    *(undefined4 *)(iVar2 + 0x10) = 0;
    *(int *)(iVar2 + 0xc) = param_2;
    *(int *)(iVar2 + 0x14) = __fd;
    *(code **)(iVar2 + 4) = FUN_000381bc;
    iVar1 = FUN_00015fc4(iVar2);
    if (iVar1 == 0) {
      close(__fd);
      *(undefined4 *)(iVar2 + 0x14) = 0xffffffff;
      free(__ptr);
      __fd = 0;
    }
    else {
      *(undefined1 **)(iVar2 + 0x1c) = __ptr;
      __fd = 1;
      *(undefined1 *)(param_2 + 0x47) = 0xf6;
      *(char **)(iVar2 + 0x24) = "PSTI/Traconex WWV/WWVH Receiver";
      *(undefined4 *)(iVar2 + 0x2ec) = 0x565757;
      *(undefined4 *)(param_2 + 0x74) = 0x3c;
    }
  }
  return __fd;
}




void FUN_000381bc(int param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  int iVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  undefined1 uStack_42;
  undefined1 uStack_41;
  uint local_40;
  undefined4 local_3c;
  undefined4 uStack_38;
  undefined1 auStack_34 [12];
  undefined1 auStack_28 [9];
  byte local_1f;
  char local_1c;
  
  iVar9 = *(int *)(param_1 + 8);
  iVar6 = *(int *)(iVar9 + 0x3c);
  piVar7 = *(int **)(iVar6 + 0x1c);
  iVar8 = piVar7[1];
  iVar1 = FUN_00027aac(param_1,iVar8,(iVar6 + 0xa6) - iVar8,&local_3c);
  *(undefined1 *)(iVar8 + iVar1) = 0x20;
  piVar7[1] = iVar8 + iVar1 + 1;
  *(undefined1 *)(iVar8 + iVar1 + 1) = 0;
  if (*piVar7 == 0) {
    iVar1 = piVar7[1];
    *(undefined4 *)(iVar6 + 0xd8) = local_3c;
    *(undefined4 *)(iVar6 + 0xdc) = uStack_38;
    *piVar7 = 1;
    *(int *)(iVar6 + 0xa8) = iVar1 - (iVar6 + 0x28);
  }
  else {
    iVar1 = *piVar7 + 1;
    *piVar7 = iVar1;
    iVar8 = piVar7[1] - (iVar6 + 0x28);
    *(int *)(iVar6 + 0xa8) = iVar8;
    if (2 < iVar1) {
      if ((iVar8 < 0x2e) ||
         (iVar1 = sscanf((char *)(iVar6 + 0x28),"%c%2d:%2d:%2d.%3ld%c %9s%3d%13s%4ld",&uStack_42,iVar6 + 0xb4,
                         iVar6 + 0xb8,iVar6 + 0xbc,iVar6 + 0xc0,&uStack_41,auStack_34,iVar6 + 0xb0,auStack_28,&local_40)
         , iVar1 != 10)) {
        FUN_00027040(iVar9,2);
      }
      else {
        puVar2 = *(undefined4 **)(iVar6 + 0xc0);
        puVar4 = (undefined4 *)(uint)local_1f;
        *(int *)(iVar6 + 0xc0) = (int)puVar2 * 1000000;
        if (puVar4 != (undefined4 *)0x38) {
          *(undefined1 *)(iVar6 + 0x20) = 3;
        }
        if (local_1c == 'H') {
          puVar5 = &DAT_00068544;
        }
        else {
          puVar5 = &DAT_000684cc;
        }
        *(undefined4 *)(iVar6 + 0x2ec) = *puVar5;
        if (*(byte *)(iVar9 + 0x45) < 2) {
          *(undefined4 *)(iVar9 + 0x58) = *(undefined4 *)(iVar6 + 0x2ec);
        }
        if (local_40 == 0) {
          puVar2 = (undefined4 *)(iVar6 + 0xd8);
          puVar4 = (undefined4 *)(iVar6 + 0xd0);
        }
        if (local_40 == 0) {
          uVar3 = puVar2[1];
          *puVar4 = *puVar2;
          puVar4[1] = uVar3;
        }
        *(double *)(iVar6 + 0xe8) = (double)local_40 * 1e-05 * 60.0;
        iVar1 = FUN_00027698(iVar6);
        if (iVar1 == 0) {
          FUN_00027040(iVar9,6);
        }
        else if (1.5 < *(double *)(iVar9 + 0x1b0)) {
          FUN_000276a0(iVar9);
        }
      }
    }
  }
  return;
}




void * FUN_000383d8(int param_1)

{
  void *pvVar1;
  int *piVar2;
  char *pcVar3;
  int iVar4;
  
  iVar4 = 0x3b6;
  if (param_1 < 2) {
    iVar4 = 0x380;
  }
  iVar4 = shmget(param_1 + 0x4e545030,0x50,iVar4);
  if (iVar4 != -1) {
    pvVar1 = shmat(iVar4,(void *)0x0,0);
    if (pvVar1 != (void *)0xffffffff) {
      return pvVar1;
    }
    piVar2 = __errno_location();
    pcVar3 = strerror(*piVar2);
    FUN_0004fe78(3,"SHM shmat (unit %d): %s",param_1,pcVar3);
    return (void *)0x0;
  }
  piVar2 = __errno_location();
  pcVar3 = strerror(*piVar2);
  FUN_0004fe78(3,"SHM shmget (unit %d): %s",param_1,pcVar3);
  return (void *)0x0;
}




undefined4 FUN_00038474(undefined4 param_1,int param_2)

{
  int *__s;
  int iVar1;
  int iVar2;
  
  iVar2 = *(int *)(param_2 + 0x3c);
  *(int *)(iVar2 + 0xc) = param_2;
  *(undefined4 *)(iVar2 + 4) = 0;
  *(undefined4 *)(iVar2 + 0x10) = 0;
  *(undefined4 *)(iVar2 + 0x14) = 0xffffffff;
  __s = (int *)FUN_0004f524(0x18);
  memset(__s,0,0x18);
  *(int **)(iVar2 + 0x1c) = __s;
  iVar1 = FUN_000383d8(param_1);
  *__s = iVar1;
  *(undefined4 *)(iVar2 + 0x2ec) = 0x4d4853;
  if (*__s == 0) {
    return 0;
  }
  *(undefined4 *)(*__s + 0x1c) = 0xffffffff;
  *(undefined1 *)(param_2 + 0x47) = 0xff;
  iVar1 = *__s;
  *(undefined4 *)(iVar1 + 0x24) = 0;
  *(undefined4 *)(iVar1 + 0x20) = 3;
  *(char **)(iVar2 + 0x24) = "SHM/Shared memory interface";
  return 1;
}




undefined4 FUN_0003850c(undefined4 param_1,int param_2)

{
  tm *ptVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  int *piVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  uint uVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int local_34;
  int local_2c [2];
  
  iVar4 = *(int *)(param_2 + 0x3c);
  piVar6 = *(int **)(iVar4 + 0x1c);
  piVar5 = (int *)*piVar6;
  piVar6[1] = piVar6[1] + 1;
  if (piVar5 == (int *)0x0) {
    piVar5 = (int *)FUN_000383d8();
    *piVar6 = (int)piVar5;
    if (piVar5 == (int *)0x0) {
      FUN_00027040(param_2,3);
      return 0;
    }
  }
  if (piVar5[9] == 0) {
    FUN_00027040(param_2,1);
    piVar6[3] = piVar6[3] + 1;
    uVar2 = 0;
  }
  else {
    if ((*piVar5 == 0) || (*piVar5 == 1)) {
      uVar10 = piVar5[5];
      uVar7 = piVar5[3] * 1000;
      local_34 = piVar5[2];
      iVar3 = piVar5[4] + -0x7c558180;
      uVar8 = uVar10 & 0xff;
      uVar11 = (uVar10 << 0xc) >> 0x1c;
      uVar10 = (uVar10 << 0x10) >> 0x18;
    }
    else {
      uVar7 = 0;
      FUN_0004fe78(3,"SHM: bad mode found in shared memory: %d");
      iVar3 = -0x7c558180;
      local_34 = 0;
      uVar8 = uVar7;
      uVar11 = uVar7;
      uVar10 = uVar7;
    }
    iVar9 = (&DAT_0007c59c)[uVar8];
    iVar12 = (&DAT_0007c15c)[uVar11];
    iVar14 = (&DAT_0007c19c)[uVar10];
    iVar13 = *(int *)(iVar4 + 0x2f8);
    piVar5[9] = 0;
    *(int *)(iVar4 + 0xd8) = iVar3;
    *(int *)(iVar4 + 0x2f8) = iVar13 + 1;
    *(int *)(iVar4 + 0xdc) = iVar14 + iVar9 + iVar12;
    local_2c[0] = local_34;
    ptVar1 = gmtime(local_2c);
    iVar9 = piVar5[7];
    iVar3 = ptVar1->tm_sec;
    iVar13 = ptVar1->tm_min;
    iVar12 = ptVar1->tm_yday;
    *(int *)(iVar4 + 0xb4) = ptVar1->tm_hour;
    *(int *)(iVar4 + 0xb8) = iVar13;
    *(int *)(iVar4 + 0xb0) = iVar12 + 1;
    *(int *)(iVar4 + 0xbc) = iVar3;
    *(uint *)(iVar4 + 0xc0) = uVar7;
    *(char *)(param_2 + 0x47) = (char)iVar9;
    *(char *)(iVar4 + 0x20) = (char)piVar5[6];
    iVar4 = FUN_00027698(iVar4);
    if (iVar4 == 0) {
      FUN_00027040(param_2,6);
      piVar6[4] = piVar6[4] + 1;
      uVar2 = 0;
    }
    else {
      uVar2 = 1;
      piVar6[2] = piVar6[2] + 1;
    }
  }
  return uVar2;
}




undefined4 FUN_00038764(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  char acStack_110 [256];
  undefined4 local_10;
  
  iVar1 = *(int *)(param_2 + 0x3c);
  local_10 = param_4;
  if (*(int *)(iVar1 + 200) == *(int *)(iVar1 + 0xcc)) {
    FUN_00027040(param_2,1);
  }
  else {
    *(undefined4 *)(iVar1 + 0xd0) = *(undefined4 *)(iVar1 + 0xd8);
    *(undefined4 *)(iVar1 + 0xd4) = *(undefined4 *)(iVar1 + 0xdc);
    FUN_000276a0(param_2);
  }
  iVar1 = *(int *)(*(int *)(param_2 + 0x3c) + 0x1c);
  if ((*(byte *)(*(int *)(param_2 + 0x3c) + 0x2f0) & 8) != 0) {
    snprintf(acStack_110,0x100,"%3d %3d %3d %3d %3d",*(undefined4 *)(iVar1 + 4),*(undefined4 *)(iVar1 + 8),
             *(undefined4 *)(iVar1 + 0xc),*(undefined4 *)(iVar1 + 0x10),*(undefined4 *)(iVar1 + 0x14));
    param_1 = FUN_0002ddbc(param_2 + 0xc,acStack_110);
    *(undefined4 *)(iVar1 + 0x14) = 0;
    *(undefined4 *)(iVar1 + 0x10) = 0;
    *(undefined4 *)(iVar1 + 0xc) = 0;
    *(undefined4 *)(iVar1 + 8) = 0;
    *(undefined4 *)(iVar1 + 4) = 0;
  }
  return param_1;
}




void FUN_000387c8(int param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  FILE *__stream;
  int __fd;
  FILE *pFVar1;
  int iVar2;
  FILE *pFVar3;
  char acStack_40 [40];
  undefined4 uStack_8;
  undefined4 uStack_4;
  
  iVar2 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
  __stream = *(FILE **)(iVar2 + 0x18);
  pFVar3 = (FILE *)-((int)((uint)*(byte *)(*(int *)(param_1 + 0x3c) + 0x2f0) << 0x1e) >> 0x1f);
  pFVar1 = __stream;
  if (__stream != (FILE *)0x0) {
    pFVar1 = (FILE *)0x1;
  }
  uStack_8 = param_3;
  uStack_4 = param_4;
  if (pFVar3 != pFVar1) {
    if (pFVar3 == (FILE *)0x0) {
      fclose(__stream);
      *(undefined4 *)(iVar2 + 0x18) = 0;
      return;
    }
    snprintf(acStack_40,0x28,"/tmp/true%d.debug",*(undefined4 *)(iVar2 + 0x14));
    __fd = open(acStack_40,0xc1,0x180);
    if (-1 < __fd) {
      pFVar1 = fdopen(__fd,"r+");
      *(FILE **)(iVar2 + 0x18) = pFVar1;
      if (pFVar1 != (FILE *)0x0) {
        setvbuf(pFVar1,&DAT_0008019c,1,0x2000);
      }
    }
    __stream = *(FILE **)(iVar2 + 0x18);
  }
  if (__stream != (FILE *)0x0) {
    fprintf(__stream,"true%d: ",*(undefined4 *)(iVar2 + 0x14));
    vfprintf(*(FILE **)(iVar2 + 0x18),param_2,&uStack_8);
  }
  return;
}




void FUN_000388ac(int param_1,char *param_2)

{
  size_t __n;
  size_t sVar1;
  int iVar2;
  
  iVar2 = *(int *)(param_1 + 0x3c);
  if ((*(byte *)(iVar2 + 0x2f0) & 1) != 0) {
    return;
  }
  __n = strlen(param_2);
  FUN_000387c8(param_1,"Send \'%s\'\n",param_2);
  sVar1 = write(*(int *)(iVar2 + 0x14),param_2,__n);
  if (sVar1 == __n) {
    *(int *)(iVar2 + 0x2f8) = *(int *)(iVar2 + 0x2f8) + 1;
    return;
  }
  FUN_00027040(param_1,3);
  return;
}




void FUN_00038920(int param_1,uint param_2)

{
  undefined2 *puVar1;
  int iVar2;
  int iVar3;
  
LAB_00038938:
  iVar3 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
  if ((param_2 != 8) && ((DAT_0007be6c & 0x400) != 0)) {
    FUN_0004fe78(6,"TRUE: clock %s, state %s, event %s");
  }
  FUN_000387c8(param_1,"clock %s, state %s, event %s\n");
  switch(*(undefined4 *)(iVar3 + 0x10)) {
  case 0:
    break;
  case 1:
    if (param_2 != 5) {
      if (param_2 == 6) {
        FUN_000388ac(param_1,"P");
        return;
      }
      if (param_2 != 0) goto switchD_000389e4_caseD_4;
    }
    FUN_000388ac(param_1,"C");
    *(undefined4 *)(iVar3 + 0xc) = 8;
  case 4:
switchD_000389e4_caseD_4:
    if (param_2 == 0) {
      FUN_000388ac(param_1,"C");
      *(undefined4 *)(iVar3 + 0xc) = 8;
      return;
    }
LAB_00038a54:
    if (param_2 != 8) {
      return;
    }
switchD_00038af8_caseD_8:
    if (*(int *)(iVar3 + 0xc) - 8U < 2) {
      *(undefined4 *)(iVar3 + 0xc) = 9;
      return;
    }
    FUN_000388ac(param_1,&DAT_00068650);
    return;
  case 2:
    switch(param_2) {
    case 0:
      FUN_000388ac(param_1,&DAT_00068654);
      *(undefined4 *)(iVar3 + 0xc) = 5;
      return;
    default:
      return;
    case 2:
      FUN_000388ac(param_1,&DAT_0006865c);
      *(undefined4 *)(iVar3 + 0xc) = 6;
      return;
    case 3:
      FUN_000388ac(param_1,&DAT_00068664);
      *(undefined4 *)(iVar3 + 0xc) = 7;
      return;
    case 4:
      FUN_000388ac(param_1,&DAT_0006866c);
      *(undefined4 *)(iVar3 + 0xc) = 8;
      return;
    case 8:
      goto switchD_00038af8_caseD_8;
    }
  case 3:
    if (param_2 == 0) {
      FUN_000388ac(param_1,&DAT_00068674);
      FUN_000388ac(param_1,&DAT_0006867c);
      FUN_000388ac(param_1,&DAT_00068684);
      *(undefined4 *)(iVar3 + 0xc) = 8;
      return;
    }
    goto LAB_00038a54;
  default:
    goto switchD_000389e4_default;
  }
  iVar2 = *(int *)(iVar3 + 0xc);
  switch(iVar2) {
  case 0:
    if (param_2 == 0) {
      FUN_000388ac(param_1,&DAT_00068688);
      *(undefined4 *)(iVar3 + 0xc) = 4;
      return;
    }
    goto switchD_000389e4_default;
  case 1:
    if (param_2 < 2) {
      FUN_000388ac(param_1,&DAT_00068690);
      *(undefined4 *)(iVar3 + 0xc) = 2;
      return;
    }
    if (param_2 == 2) {
      *(undefined4 *)(iVar3 + 0x10) = 2;
      break;
    }
    goto switchD_000389e4_default;
  case 2:
    if (param_2 < 2) {
      *(undefined4 *)(iVar3 + 0xc) = 0;
      sleep(1);
      return;
    }
    if (param_2 != 7) goto switchD_000389e4_default;
    *(undefined4 *)(iVar3 + 0x10) = 3;
    break;
  case 3:
    if (param_2 < 2) {
      *(undefined4 *)(iVar3 + 0xc) = 1;
      FUN_000388ac(param_1,&DAT_00068654);
      return;
    }
    if (param_2 == 8) {
      *(undefined4 *)(iVar3 + 0x10) = 4;
      *(undefined4 *)(iVar3 + 0xc) = 9;
      return;
    }
switchD_000389e4_default:
                    /* WARNING: Subroutine does not return */
    abort();
  case 4:
    switch(param_2) {
    case 0:
    case 1:
    case 8:
      *(undefined4 *)(iVar3 + 0xc) = 3;
      FUN_000388ac(param_1,&DAT_0006868c);
      return;
    default:
      goto switchD_000389e4_default;
    case 5:
      *(undefined4 *)(iVar3 + 0x10) = 1;
    }
    break;
  case 5:
  case 6:
  case 7:
  case 8:
  case 9:
  case 10:
    if (iVar2 == 10) {
      puVar1 = &DAT_000672f4;
    }
    else {
      puVar1 = (undefined2 *)(&PTR_DAT_0007abb8)[iVar2];
    }
    FUN_0004fe78(6,"TRUE: state %s is unexpected!",puVar1);
    return;
  default:
    return;
  }
  param_2 = 0;
  goto LAB_00038938;
}




void FUN_00038d38(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  
  iVar2 = *(int *)(param_2 + 0x3c);
  piVar3 = *(int **)(iVar2 + 0x1c);
  if (*piVar3 == 0) {
    FUN_00038920(param_2);
    FUN_00027040(param_2,1);
  }
  else {
    *piVar3 = *piVar3 + -1;
  }
  iVar1 = *(int *)(iVar2 + 0x2f8);
  piVar3[2] = 1;
  *(int *)(iVar2 + 0x2f8) = iVar1 + 1;
  return;
}




undefined4 FUN_00038da4(undefined4 param_1,int param_2)

{
  int __fd;
  undefined4 *__s;
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  char acStack_48 [44];
  
  snprintf(acStack_48,0x28,"/dev/true%d",param_1);
  __fd = FUN_00027d18(acStack_48,0xd,1);
  if (__fd == 0) {
    uVar2 = 0;
  }
  else {
    __s = (undefined4 *)FUN_0004f524(0x1c);
    if (__s == (undefined4 *)0x0) {
      close(__fd);
      uVar2 = 0;
    }
    else {
      memset(__s,0,0x1c);
      iVar3 = *(int *)(param_2 + 0x3c);
      *(int *)(iVar3 + 0xc) = param_2;
      *(int *)(iVar3 + 0x14) = __fd;
      *(code **)(iVar3 + 4) = FUN_00038ebc;
      *(undefined4 *)(iVar3 + 0x10) = 0;
      iVar1 = FUN_00015fc4(iVar3);
      if (iVar1 == 0) {
        close(__fd);
        free(__s);
        uVar2 = 0;
      }
      else {
        *(undefined4 **)(iVar3 + 0x1c) = __s;
        *(undefined1 *)(param_2 + 0x47) = 0xf6;
        *(char **)(iVar3 + 0x24) = "Kinemetrics/TrueTime Receiver";
        *(undefined4 *)(iVar3 + 0x2ec) = 0x45555254;
        *__s = 2;
        __s[4] = 0;
        __s[3] = 0;
        FUN_000388ac(param_2,&DAT_00068650);
        FUN_00038920(param_2,0);
        uVar2 = 1;
      }
    }
  }
  return uVar2;
}




void FUN_00038ebc(int param_1)

{
  uint uVar1;
  int iVar2;
  char *pcVar3;
  undefined4 uVar4;
  undefined4 uVar5;
  int iVar6;
  undefined4 *puVar7;
  int iVar8;
  char local_b9;
  int local_b8;
  undefined1 auStack_b4 [4];
  int local_b0;
  undefined1 auStack_ac [4];
  undefined4 local_a8;
  undefined4 uStack_a4;
  char acStack_a0 [128];
  
  iVar8 = *(int *)(param_1 + 8);
  iVar6 = *(int *)(iVar8 + 0x3c);
  puVar7 = *(undefined4 **)(iVar6 + 0x1c);
  uVar1 = FUN_00027aac(param_1,acStack_a0,0x80,&local_a8);
  uVar1 = uVar1 & 0xffff;
  acStack_a0[uVar1] = '\0';
  if (uVar1 != 0) {
    pcVar3 = (char *)(iVar6 + 0x28);
    *(uint *)(iVar6 + 0xa8) = uVar1;
    strcpy(pcVar3,acStack_a0);
    *(undefined4 *)(iVar6 + 0xd8) = local_a8;
    *(undefined4 *)(iVar6 + 0xdc) = uStack_a4;
    FUN_000387c8(iVar8,"receive(%s) [%d]\n",pcVar3,*(undefined4 *)(iVar6 + 0xa8));
    *puVar7 = 2;
    FUN_0002ddbc(iVar8 + 0xc,pcVar3);
    if ((*(char *)(iVar6 + 0x28) == '?') || (iVar2 = strcmp(pcVar3,"ERROR 05 NO SUCH FUNCTION"), iVar2 == 0)) {
      FUN_00038920(iVar8,1);
    }
    else if (((*(char *)(iVar6 + 0x2d) == '+' || *(char *)(iVar6 + 0x2d) == '-') &&
             (*(char *)(iVar6 + 0x31) == '+' || *(char *)(iVar6 + 0x31) == '-')) &&
            (iVar2 = sscanf(pcVar3,"%5d%*c%3d%*c%3d",&local_b0,auStack_b4,auStack_ac), iVar2 == 3)) {
      if (local_b0 - 0x1b59U < 6999) {
        pcVar3 = "WEST";
        if (local_b0 < 10000) {
          pcVar3 = "EAST";
        }
        uVar1 = (uint)(local_b0 < 10000);
        if (puVar7[1] != uVar1) {
          uVar4 = *(undefined4 *)(iVar6 + 0x2e0);
          uVar5 = *(undefined4 *)(iVar6 + 0x2e4);
          *(undefined4 *)(iVar6 + 0x2e0) = *(undefined4 *)(iVar6 + 0x2d8);
          *(undefined4 *)(iVar6 + 0x2e4) = *(undefined4 *)(iVar6 + 0x2dc);
          *(undefined4 *)(iVar6 + 0x2d8) = uVar4;
          *(undefined4 *)(iVar6 + 0x2dc) = uVar5;
          puVar7[1] = uVar1;
        }
      }
      else {
        pcVar3 = "UNKNOWN";
      }
      FUN_000387c8(iVar8,"GOES: station %s\n",pcVar3);
      FUN_00038920(iVar8,5);
    }
    else {
      iVar2 = sscanf(pcVar3,"F%2d",&local_b8);
      if (((iVar2 == 1) && (0 < local_b8)) && (local_b8 < 0x50)) {
        if (local_b8 == 0x32) {
          FUN_00038920(iVar8,3);
        }
        else if (local_b8 == 0x33) {
          FUN_00038920(iVar8,4);
        }
        else {
          FUN_000387c8(iVar8,"got F%02d - ignoring\n");
        }
      }
      else {
        iVar2 = strcmp(pcVar3," TRUETIME Mk III");
        if ((iVar2 == 0) || (iVar2 = strncmp(pcVar3," TRUETIME XL",0xc), iVar2 == 0)) {
          FUN_00038920(iVar8,2);
          if ((DAT_0007be6c & 0x400) != 0) {
            FUN_0004fe78(6,"TM/TMD/XL: %s",pcVar3);
          }
        }
        else if (((*(char *)(iVar6 + 0x28) == 'N' || *(char *)(iVar6 + 0x28) == 'S') &&
                 (*(char *)(iVar6 + 0x31) == 'W' || *(char *)(iVar6 + 0x31) == 'E')) && (*(char *)(iVar6 + 0x3a) == '+')
                ) {
          FUN_00038920(iVar8,7);
          if ((DAT_0007be6c & 0x400) != 0) {
            FUN_0004fe78(6,"TCU-800: %s",pcVar3);
          }
        }
        else if (((*(char *)(iVar6 + 0x2b) == ':') && (*(char *)(iVar6 + 0x2e) == ':')) &&
                ((*(char *)(iVar6 + 0x31) == ':' &&
                 (iVar2 = sscanf(pcVar3,"%3d:%2d:%2d:%2d%c",iVar6 + 0xb0,iVar6 + 0xb4,iVar6 + 0xb8,iVar6 + 0xbc,
                                 &local_b9), iVar2 == 5)))) {
          if (((local_b9 == '>' || local_b9 == '#') || (local_b9 == '?')) || (local_b9 == 'X')) {
            *(undefined1 *)(iVar6 + 0x20) = 3;
          }
          else {
            *(undefined1 *)(iVar6 + 0x20) = 0;
          }
          FUN_00038920(iVar8,8);
          if (puVar7[2] != 0) {
            FUN_00038920(iVar8,6);
            iVar2 = FUN_00027698(iVar6);
            if (iVar2 == 0) {
              FUN_00027040(iVar8,6);
            }
            else {
              *(undefined4 *)(iVar6 + 0xd0) = *(undefined4 *)(iVar6 + 0xd8);
              *(undefined4 *)(iVar6 + 0xd4) = *(undefined4 *)(iVar6 + 0xdc);
              FUN_000276a0(iVar8);
              FUN_00027040(iVar8,0);
              puVar7[2] = 0;
            }
          }
        }
        else {
          FUN_00027040(iVar8,2);
        }
      }
    }
  }
  return;
}




void FUN_000392b8(undefined4 param_1,int param_2)

{
  ssize_t sVar1;
  int iVar2;
  int iVar3;
  undefined1 local_11 [5];
  
  iVar3 = *(int *)(param_2 + 0x3c);
  local_11[0] = 0x54;
  if (((*(byte *)(iVar3 + 0x2f0) & 1) == 0) || (sVar1 = write(*(int *)(iVar3 + 0x14),local_11,1), sVar1 == 1)) {
    *(int *)(iVar3 + 0x2f8) = *(int *)(iVar3 + 0x2f8) + 1;
    iVar2 = *(int *)(param_2 + 0x74);
  }
  else {
    FUN_00027040(param_2,3);
    iVar2 = *(int *)(param_2 + 0x74);
  }
  if (iVar2 < 1) {
    if (*(int *)(iVar3 + 200) == *(int *)(iVar3 + 0xcc)) {
      FUN_00027040(param_2,1);
    }
    else {
      *(undefined4 *)(iVar3 + 0xd0) = *(undefined4 *)(iVar3 + 0xd8);
      *(undefined4 *)(iVar3 + 0xd4) = *(undefined4 *)(iVar3 + 0xdc);
      FUN_000276a0(param_2);
      FUN_0002ddbc(param_2 + 0xc,iVar3 + 0x28);
      *(undefined4 *)(param_2 + 0x74) = 5;
    }
  }
  return;
}




int FUN_00039398(undefined4 param_1,int param_2)

{
  int __fd;
  undefined1 *__ptr;
  int iVar1;
  int iVar2;
  char acStack_2c [20];
  
  sprintf(acStack_2c,"/dev/wwvb%d",param_1);
  __fd = FUN_00027d18(acStack_2c,0xd,1);
  if (__fd != 0) {
    __ptr = (undefined1 *)FUN_0004f524(0xc);
    if (__ptr == (undefined1 *)0x0) {
      close(__fd);
      __fd = 0;
    }
    else {
      *__ptr = 0;
      __ptr[1] = 0;
      __ptr[2] = 0;
      __ptr[3] = 0;
      __ptr[4] = 0;
      __ptr[5] = 0;
      __ptr[6] = 0;
      __ptr[7] = 0;
      __ptr[8] = 0;
      __ptr[9] = 0;
      __ptr[10] = 0;
      __ptr[0xb] = 0;
      iVar2 = *(int *)(param_2 + 0x3c);
      *(undefined4 *)(iVar2 + 0x10) = 0;
      *(undefined1 **)(iVar2 + 0x1c) = __ptr;
      *(int *)(iVar2 + 0xc) = param_2;
      *(int *)(iVar2 + 0x14) = __fd;
      *(code **)(iVar2 + 4) = FUN_000394b4;
      iVar1 = FUN_00015fc4(iVar2);
      if (iVar1 == 0) {
        close(__fd);
        free(__ptr);
        __fd = 0;
      }
      else {
        *(undefined1 *)(param_2 + 0x47) = 0xf6;
        __fd = 1;
        *(undefined4 *)(param_2 + 0x74) = 5;
        *(char **)(iVar2 + 0x24) = "Ultralink WWVB Receiver";
        *(undefined4 *)(iVar2 + 0x2ec) = 0x42565757;
      }
    }
  }
  return __fd;
}




void FUN_000394b4(int param_1)

{
  char cVar1;
  int iVar2;
  undefined4 uVar3;
  undefined1 uVar4;
  int iVar5;
  int iVar6;
  char *pcVar7;
  char *__s;
  char local_2c;
  char local_2b [4];
  byte local_27;
  uint local_24;
  undefined4 local_20;
  undefined4 uStack_1c;
  
  iVar6 = *(int *)(param_1 + 8);
  iVar5 = *(int *)(iVar6 + 0x3c);
  __s = (char *)(iVar5 + 0x28);
  pcVar7 = *(char **)(iVar5 + 0x1c);
  iVar2 = FUN_00027aac(param_1,__s,0x80,&local_20);
  if (iVar2 == 0) {
    if (*pcVar7 == '\0') {
      *pcVar7 = '\x01';
      *(undefined4 *)(pcVar7 + 4) = local_20;
      *(undefined4 *)(pcVar7 + 8) = uStack_1c;
      return;
    }
    *pcVar7 = '\0';
    return;
  }
  *(int *)(iVar5 + 0xa8) = iVar2;
  uVar3 = *(undefined4 *)(pcVar7 + 8);
  *(undefined4 *)(iVar5 + 0xd8) = *(undefined4 *)(pcVar7 + 4);
  *(undefined4 *)(iVar5 + 0xdc) = uVar3;
  *pcVar7 = '\x01';
  iVar2 = DAT_0007cf4c;
  *(undefined4 *)(pcVar7 + 4) = local_20;
  *(undefined4 *)(pcVar7 + 8) = uStack_1c;
  if (iVar2 != 0) {
    printf("ulink: timecode %d %s\n",*(undefined4 *)(iVar5 + 0xa8),__s);
  }
  local_2b[2] = ' ';
  local_2b[1] = 0x20;
  local_2b[0] = ' ';
  local_2c = ' ';
  if (*(int *)(iVar5 + 0xa8) == 0x18) {
LAB_00039590:
    iVar2 = sscanf(__s,"%c%1d%c%4d%3d%*c%2d:%2d:%2d.%2ld%c",&local_2c,&local_24,local_2b + 1,iVar5 + 0xac,iVar5 + 0xb0,
                   iVar5 + 0xb4,iVar5 + 0xb8,iVar5 + 0xbc,iVar5 + 0xc0,local_2b);
    if (iVar2 != 10) {
LAB_00039568:
      FUN_00027040(iVar6,2);
      return;
    }
    iVar2 = *(int *)(iVar5 + 0xc0) * 10000000;
    *(int *)(iVar5 + 0xc0) = iVar2;
    if (local_2b[0] == 'I') {
      iVar2 = 0x2b;
    }
    cVar1 = (char)iVar2;
    if ((local_2b[0] != 'I') && (cVar1 = local_2b[0], local_2b[0] == 'D')) {
      local_2b[0] = '-';
      cVar1 = local_2b[0];
    }
    local_2b[0] = cVar1;
    if (local_2c != '?') {
      local_2c = ':';
    }
  }
  else {
    if (*(int *)(iVar5 + 0xa8) != 0x20) goto LAB_00039568;
    iVar2 = sscanf(__s,"%c%*31c",local_2b + 2);
    if (iVar2 != 1) goto LAB_00039590;
    if ((local_2b[2] == 'R') &&
       (iVar2 = sscanf(__s,"%*2c %*2c%2c%*c%4d%*c%3d%*4c %2d%c%2d:%2d%c%*2c",local_2b + 3,iVar5 + 0xac,iVar5 + 0xb0,
                       iVar5 + 0xb4,&local_2c,iVar5 + 0xb8,iVar5 + 0xbc,local_2b), iVar2 == 8)) {
      if (local_2b[3] == '0') {
        local_24 = 0;
      }
      else {
        local_24 = 99;
      }
      if (local_2b[0] == 'I') {
        local_2b[0] = '+';
      }
      else if (local_2b[0] == 'D') {
        local_2b[0] = '-';
      }
    }
    if ((local_2b[2] == 'S') &&
       (iVar2 = sscanf(__s,"%*4c %2c %4d%*c%3d%*4c %2d%c%2d:%2d%c%*2c",local_2b + 3,iVar5 + 0xac,iVar5 + 0xb0,
                       iVar5 + 0xb4,&local_2c,iVar5 + 0xb8,iVar5 + 0xbc,local_2b), iVar2 == 8)) {
      if (local_2b[3] == 'L') {
        local_24 = 0;
      }
      else if (local_2b[3] == '0') {
        local_24 = local_27 & 0xf;
      }
      else {
        local_24 = 99;
      }
    }
  }
  if (*(int *)(iVar5 + 0xa8) != 0x20) {
    switch(local_24) {
    case 1:
      *(undefined4 *)(iVar5 + 0xe8) = 0x47ae147b;
      *(undefined4 *)(iVar5 + 0xec) = 0x3fc47ae1;
      break;
    case 2:
switchD_00039644_caseD_2:
      *(undefined4 *)(iVar5 + 0xe8) = 0x47ae147b;
      *(undefined4 *)(iVar5 + 0xec) = 0x3fb47ae1;
      break;
    case 3:
switchD_00039644_caseD_3:
      *(undefined4 *)(iVar5 + 0xe8) = 0x47ae147b;
      *(undefined4 *)(iVar5 + 0xec) = 0x3fa47ae1;
      break;
    case 4:
switchD_00039644_caseD_4:
      *(undefined4 *)(iVar5 + 0xe8) = 0x47ae147b;
      *(undefined4 *)(iVar5 + 0xec) = 0x3f947ae1;
      break;
    case 5:
switchD_00039644_caseD_5:
      *(undefined4 *)(iVar5 + 0xe8) = 0xd2f1a9fc;
      *(undefined4 *)(iVar5 + 0xec) = 0x3f60624d;
      break;
    default:
switchD_00039644_default:
      *(undefined4 *)(iVar5 + 0xe8) = 0;
      *(undefined4 *)(iVar5 + 0xec) = 0x40300000;
    }
    if (local_2c == ':') {
      if (local_2b[0] == '+') {
        *(undefined1 *)(iVar5 + 0x20) = 1;
      }
      else {
        if (local_2b[0] == '-') {
          uVar4 = 2;
        }
        else {
          uVar4 = 0;
        }
        *(undefined1 *)(iVar5 + 0x20) = uVar4;
      }
    }
    else {
      *(undefined1 *)(iVar5 + 0x20) = 3;
    }
    iVar2 = FUN_00027698(iVar5);
    if (iVar2 != 0) {
      return;
    }
    FUN_00027040(iVar6,6);
    return;
  }
  switch(local_24) {
  case 0:
    goto switchD_00039644_caseD_5;
  case 1:
    goto switchD_00039644_caseD_4;
  case 2:
    goto switchD_00039644_caseD_3;
  case 3:
    goto switchD_00039644_caseD_2;
  default:
    goto switchD_00039644_default;
  }
}




void FUN_000398b8(int *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int *piVar4;
  double dVar5;
  
  iVar1 = param_1[1];
  iVar3 = *param_1;
  param_1[1] = iVar1 + 1;
  iVar2 = iVar3 + -1;
  dVar5 = *(double *)(param_1 + iVar3 * 2 + 6);
  if (iVar1 + 1 == iVar3) {
    param_1[1] = 0;
  }
  if (0 < iVar2) {
    piVar4 = param_1 + (iVar3 + 4) * 2;
    do {
      iVar2 = iVar2 + -1;
      piVar4[-2] = piVar4[-4];
      piVar4[-1] = piVar4[-3];
      piVar4 = piVar4 + -2;
    } while (iVar2 != 0);
  }
  *(double *)(param_1 + 8) = (double)(longlong)(int)(longlong)dVar5;
  return;
}




void FUN_0003991c(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar2 = *(int *)(param_2 + 0x3c);
  iVar3 = *(int *)(iVar2 + 0x1c);
  iVar1 = *(int *)(iVar3 + 0x34);
  if (iVar1 != 0) {
    FUN_00027040(param_2,iVar1,param_3,iVar1,param_4);
  }
  iVar1 = *(int *)(iVar2 + 0x2f8);
  *(undefined4 *)(iVar3 + 0x34) = 0;
  *(int *)(iVar2 + 0x2f8) = iVar1 + 1;
  return;
}




undefined4 FUN_0003998c(int param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  int iVar4;
  undefined8 uVar5;
  
  iVar4 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
  iVar1 = *(int *)(iVar4 + 0x30);
  if (0 < iVar1) {
    uVar5 = (&DAT_00068928)[param_2];
    *(undefined4 *)(*(int *)(iVar4 + 0xcdc) * 0xd8 + iVar4 + 0x898) = *(undefined4 *)(iVar4 + 0x844);
    uVar2 = FUN_0004f5e8((int)uVar5,iVar1,*(byte *)(param_1 + 0x3b) & 0x7f);
    uVar3 = *(undefined4 *)(param_2 * 0xd8 + iVar4 + 0x898);
    *(int *)(iVar4 + 0xcdc) = param_2;
    *(undefined4 *)(iVar4 + 0x844) = uVar3;
    return uVar2;
  }
  return 0;
}




int FUN_000399f8(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  bool bVar12;
  double dVar13;
  double dVar14;
  
  dVar13 = 0.0;
  iVar11 = 0;
  iVar10 = *(int *)(param_1 + 0x3c);
  iVar5 = 0;
  iVar2 = 0;
  iVar9 = *(int *)(iVar10 + 0x1c);
  do {
    iVar3 = iVar5 * 0xd8 + iVar9;
    dVar14 = *(double *)(iVar3 + 0x950);
    iVar1 = iVar2;
    if (dVar13 <= dVar14) {
      iVar11 = iVar5;
      dVar13 = dVar14;
      iVar1 = iVar3 + 0x908;
    }
    iVar2 = iVar5 * 0xd8 + iVar9;
    dVar14 = *(double *)(iVar2 + 0x8e8);
    if (dVar14 > dVar13 || dVar13 == dVar14) {
      iVar11 = iVar5;
    }
    iVar5 = iVar5 + 1;
    iVar2 = iVar2 + 0x8a0;
    if (dVar14 <= dVar13 && dVar13 != dVar14) {
      iVar2 = iVar1;
      dVar14 = dVar13;
    }
    dVar13 = dVar14;
  } while (iVar5 != 5);
  iVar5 = 0x10e8;
  uVar6 = *(uint *)(iVar9 + 0x10e8);
  *(uint *)(iVar9 + 0x10e8) = uVar6 & 0xfffffcff;
  if (13.0 <= dVar13) {
    *(int *)(iVar9 + 0xcd0) = iVar2;
    *(int *)(iVar9 + 0xcd4) = iVar11;
    uVar7 = *(undefined4 *)(iVar2 + 0x5c);
    *(undefined4 *)(iVar10 + 0x2ec) = uVar7;
    uVar6 = *(uint *)(iVar2 + 0x58);
    uVar4 = *(uint *)(iVar9 + 0x10e8);
    *(undefined4 *)(param_1 + 0x58) = uVar7;
    *(uint *)(iVar9 + 0x10e8) = uVar4 | 0x80;
    if ((uVar6 & 0x100) == 0) {
      if ((uVar6 & 0x200) == 0) {
        *(undefined4 *)(iVar9 + 0x28) = 0;
        *(undefined4 *)(iVar9 + 0x2c) = 0;
      }
      else {
        uVar7 = *(undefined4 *)(iVar10 + 0x2e0);
        uVar8 = *(undefined4 *)(iVar10 + 0x2e4);
        *(uint *)(iVar9 + 0x10e8) = uVar4 | 0x280;
        *(undefined4 *)(iVar9 + 0x28) = uVar7;
        *(undefined4 *)(iVar9 + 0x2c) = uVar8;
      }
      iVar5 = 1;
    }
    else {
      uVar7 = *(undefined4 *)(iVar10 + 0x2d8);
      uVar8 = *(undefined4 *)(iVar10 + 0x2dc);
      *(uint *)(iVar9 + 0x10e8) = uVar4 | 0x180;
      iVar5 = 1;
      *(undefined4 *)(iVar9 + 0x28) = uVar7;
      *(undefined4 *)(iVar9 + 0x2c) = uVar8;
    }
  }
  else {
    bVar12 = (uVar6 & 0x80) != 0;
    if (!bVar12) {
      iVar5 = 0;
    }
    iVar2 = (*(int *)(iVar9 + 0xcd4) + 1) % 5;
    *(int *)(iVar9 + 0xcd4) = iVar2;
    if (bVar12) {
      *(uint *)(iVar9 + iVar5) = uVar6 & 0xfffffc7f;
      FUN_00027040(param_1,4,iVar2,uVar6 & 0xfffffc7f,param_4);
      iVar5 = 0;
    }
  }
  if (0 < *(int *)(iVar9 + 0x30)) {
    FUN_0003998c(param_1,*(undefined4 *)(iVar9 + 0xcd4));
  }
  return iVar5;
}




void FUN_00039b80(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  double *pdVar6;
  double dVar7;
  
  iVar3 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
  iVar5 = 0;
  pdVar6 = (double *)&DAT_00068928;
  if (*(int *)(iVar3 + 0x10e8) != 0) {
    *(undefined4 *)(iVar3 + 0x34) = 1;
  }
  *(undefined1 *)(param_1 + 0x43) = 3;
  *(undefined4 *)(iVar3 + 0x10ec) = 0;
  *(undefined4 *)(iVar3 + 0x38) = 0;
  *(undefined4 *)(iVar3 + 0x18) = 0;
  *(undefined4 *)(iVar3 + 0x1c) = 0;
  *(undefined4 *)(iVar3 + 0x10e8) = 0;
  *(undefined4 *)(iVar3 + 0x850) = 8;
  *(undefined4 *)(iVar3 + 0x844) = 0x7f;
  memset((void *)(iVar3 + 0x898),0,0x438);
  do {
    iVar1 = iVar5 * 0xd8;
    dVar7 = *pdVar6;
    pdVar6 = pdVar6 + 1;
    iVar5 = iVar5 + 1;
    iVar1 = iVar1 + 0x898;
    iVar4 = iVar3 + iVar1;
    *(undefined4 *)(iVar3 + iVar1) = *(undefined4 *)(iVar3 + 0x844);
    *(undefined4 *)(iVar4 + 0x60) = 0x100;
    dVar7 = floor(dVar7);
    uVar2 = (undefined4)((ulonglong)dVar7 >> 0x20);
    sprintf((char *)(iVar4 + 100),"WV%.0f",SUB84(dVar7,0),uVar2);
    *(undefined4 *)(iVar4 + 200) = 0x200;
    sprintf((char *)(iVar4 + 0xcc),"WH%.0f",SUB84(dVar7,0),uVar2);
  } while (iVar5 != 5);
  *(undefined4 *)(iVar3 + 0xcd4) = 2;
  FUN_000399f8(param_1);
  *(undefined4 *)(iVar3 + 0xcd8) = *(undefined4 *)(iVar3 + 0xcd4);
  return;
}




undefined4 FUN_00039c98(undefined4 param_1,int param_2)

{
  int iVar1;
  void *__s;
  int iVar2;
  double *pdVar3;
  uint uVar4;
  undefined4 uVar6;
  undefined *puVar7;
  int iVar8;
  double *pdVar9;
  double dVar10;
  double dVar11;
  uint uVar5;
  
  iVar1 = FUN_0004d29c("/dev/audio",0x140,param_1);
  if (iVar1 < 0) {
    return 0;
  }
  if (DAT_0007cf4c != 0) {
    FUN_0004dbe8();
  }
  __s = (void *)FUN_0004f524(0x10f8);
  if (__s == (void *)0x0) {
    close(iVar1);
    return 0;
  }
  memset(__s,0,0x10f8);
  iVar8 = *(int *)(param_2 + 0x3c);
  *(void **)(iVar8 + 0x1c) = __s;
  *(int *)(iVar8 + 0xc) = param_2;
  *(int *)(iVar8 + 0x14) = iVar1;
  *(undefined1 **)(iVar8 + 4) = &LAB_0003c440;
  *(undefined4 *)(iVar8 + 0x10) = 0;
  iVar2 = FUN_00015fc4(iVar8);
  if (iVar2 == 0) {
    close(iVar1);
    free(__s);
    return 0;
  }
  *(undefined1 *)(param_2 + 0x47) = 0xf6;
  *(char **)(iVar8 + 0x24) = "WWV/H Audio Demodulator/Decoder";
  *(undefined4 *)((int)__s + 0x440) = 0;
  *(undefined4 *)((int)__s + 0x444) = 0;
  pdVar3 = (double *)((int)__s + 0x60);
  *(undefined4 *)((int)__s + 0x40) = 0;
  *(undefined4 *)((int)__s + 0x44) = 0;
  pdVar9 = (double *)((int)__s + 0x460);
  *(undefined4 *)((int)__s + 0x48) = 0;
  *(undefined4 *)((int)__s + 0x4c) = 0x3ff00000;
  *(undefined4 *)((int)__s + 0x448) = 0;
  *(undefined4 *)((int)__s + 0x44c) = 0xbff00000;
  *(undefined4 *)((int)__s + 0x50) = 0;
  *(undefined4 *)((int)__s + 0x54) = 0x40080000;
  *(undefined4 *)((int)__s + 0x450) = 0;
  *(undefined4 *)((int)__s + 0x454) = 0xc0080000;
  *(undefined4 *)((int)__s + 0x58) = 0;
  *(undefined4 *)((int)__s + 0x5c) = 0x40140000;
  dVar11 = 2.0;
  *(undefined4 *)((int)__s + 0x458) = 0;
  *(undefined4 *)((int)__s + 0x45c) = 0xc0140000;
  uVar5 = 3;
  while (iVar1 = DAT_0007cf4c, uVar4 = uVar5 + 1, uVar4 != 0x80) {
    dVar10 = dVar11 + pdVar3[-1];
    if ((uVar4 & 0xf) == 0) {
      dVar11 = dVar11 + dVar11;
    }
    *pdVar3 = dVar10;
    pdVar3 = pdVar3 + 1;
    *pdVar9 = -dVar10;
    pdVar9 = pdVar9 + 1;
    uVar5 = uVar4;
  }
  *(undefined4 *)((int)__s + uVar5 + 0xfe1) = 10;
  *(undefined4 *)((int)__s + 0xce0) = 10;
  puVar7 = &DAT_00083126;
  *(undefined **)((int)__s + 0xc) = &DAT_00083126;
  *(undefined4 *)((int)__s + 0xdc0) = 10;
  *(undefined4 *)((int)__s + 0xea0) = 10;
  if (1 < iVar1) {
    puVar7 = (undefined *)0x2;
  }
  *(undefined4 *)((int)__s + 0xf10) = 10;
  if (iVar1 < 2) {
    puVar7 = (undefined *)0x0;
  }
  *(undefined4 *)((int)__s + 0xff0) = 10;
  *(undefined4 *)((int)__s + 8) = 0;
  *(undefined4 *)((int)__s + 0xd50) = 6;
  *(undefined4 *)((int)__s + 0xe30) = 3;
  *(undefined4 *)((int)__s + 0xf80) = 4;
  if (*(byte *)(param_2 + 0x3b) == 0) {
    iVar1 = *(int *)((int)__s + 0x30);
  }
  else {
    if ((*(byte *)(param_2 + 0x3b) & 0x80) == 0) {
      uVar6 = 0xd;
    }
    else {
      uVar6 = 9;
    }
    iVar1 = FUN_0004f708("/dev/icom",uVar6,puVar7);
    *(int *)((int)__s + 0x30) = iVar1;
  }
  if (0 < iVar1) {
    iVar1 = FUN_0003998c(param_2,3);
    if (iVar1 == 0) {
      FUN_0004fe78(5,"icom: autotune enabled");
    }
    else {
      FUN_0004fe78(5,"icom: radio not found");
      close(*(int *)((int)__s + 0x30));
      *(undefined4 *)((int)__s + 0x30) = 0;
    }
  }
  FUN_00039b80(param_2);
  return 1;
}




void FUN_00039f10(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  bool bVar4;
  bool bVar5;
  
  iVar3 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
  iVar1 = *(int *)(iVar3 + 0x844);
  if (*(int *)(iVar3 + 0x84c) == 0) {
    iVar2 = iVar1 + 4;
    bVar5 = SBORROW4(iVar2,0xff);
    bVar4 = iVar2 != 0xff;
    if (0xff < iVar2) {
      iVar2 = 0xff;
    }
    if (bVar4 && iVar1 + -0xfb < 0 == bVar5) {
      *(int *)(iVar3 + 0x844) = iVar2;
      iVar1 = iVar2;
      goto LAB_00039f40;
    }
  }
  else {
    if (*(int *)(iVar3 + 0x84c) < 0x65) goto LAB_00039f40;
    iVar2 = iVar1 + -4;
    if (iVar2 < 0) {
      iVar2 = 0;
    }
  }
  *(int *)(iVar3 + 0x844) = iVar2;
  iVar1 = iVar2;
LAB_00039f40:
  FUN_0004d950(iVar1,*(undefined4 *)(iVar3 + 0x848),*(undefined4 *)(iVar3 + 0x840));
  *(undefined4 *)(iVar3 + 0x84c) = 0;
  if (1 < DAT_0007cf4c) {
    FUN_0004dbe8();
    return;
  }
  return;
}




undefined4 FUN_00039f88(void)

{
  double in_d0;
  double dVar1;
  double dVar2;
  double in_d1;
  
  if (in_d0 <= 0.0) {
    return 0;
  }
  if (0.0 < in_d1) {
    dVar1 = log10(in_d0 / in_d1);
    dVar2 = dVar1 * 20.0;
    if (40.0 < dVar1 * 20.0) {
      dVar2 = 0.0;
    }
    return SUB84(dVar2,0);
  }
  return 0;
}




/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x0003a05c */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_00039fe8(int param_1,int param_2,int param_3)

{
  uint uVar1;
  byte bVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  double dVar8;
  double dVar9;
  double dVar10;
  char acStack_a0 [128];
  
  dVar8 = *(double *)(param_2 + 0x28);
  dVar10 = *(double *)(param_2 + 8);
  iVar6 = *(int *)(param_1 + 0x3c);
  iVar7 = *(int *)(iVar6 + 0x1c);
  iVar5 = *(int *)(iVar7 + 0x894);
  param_3 = iVar5 - param_3;
  iVar4 = param_3 + -0x1900;
  if (iVar4 < 0) {
    iVar4 = param_3 + 0x73a00;
  }
  if (dVar10 < dVar8) {
    *(double *)(param_2 + 8) = dVar8;
  }
  dVar9 = dVar8 + *(double *)(param_2 + 0x10);
  if (dVar10 < dVar8) {
    *(int *)(param_2 + 0x18) = iVar4;
  }
  *(double *)(param_2 + 0x10) = dVar9;
  if (iVar5 == 0) {
    dVar8 = *(double *)(param_2 + 8);
    *(double *)(param_2 + 0x38) = dVar8;
    iVar4 = FUN_00039f88(SUB84(dVar8,0),(int)((ulonglong)dVar8 >> 0x20),SUB84((dVar9 - dVar8) / 480000.0,0));
    iVar3 = *(int *)(param_2 + 0x54);
    iVar5 = *(int *)(param_2 + 0x18);
    if (iVar3 == 0) {
      *(int *)(param_2 + 0x1c) = iVar5;
      iVar4 = 0;
    }
    *(double *)(param_2 + 0x40) = dVar8;
    if (iVar3 != 0) {
      iVar4 = (iVar5 - *(int *)(param_2 + 0x1c)) % 480000;
    }
    dVar10 = *(double *)(param_2 + 0x38);
    uVar1 = *(int *)(param_2 + 0x50) << 1;
    *(uint *)(param_2 + 0x50) = uVar1;
    if ((uVar1 & 0x40) != 0) {
      *(int *)(param_2 + 0x54) = iVar3 + -1;
    }
    if ((2500.0 < dVar10) && (20.0 < dVar8)) {
      if (iVar4 + 0x9fU < 0x13f) {
        *(int *)(param_2 + 0x1c) = iVar5;
        *(uint *)(param_2 + 0x50) = uVar1 | 1;
        *(int *)(param_2 + 0x20) = iVar5;
        *(int *)(param_2 + 0x54) = *(int *)(param_2 + 0x54) + 1;
      }
      else if (*(int *)(param_2 + 0x54) == 1) {
        *(int *)(param_2 + 0x1c) = iVar5;
      }
    }
    if (*(int *)(iVar7 + 0x38) < 7) {
      dVar8 = (double)(longlong)*(int *)(param_2 + 0x54) * 6000.0;
      if (6000.0 <= dVar10) {
        dVar10 = dVar8 + 5999.0;
      }
      else {
        dVar10 = dVar10 + dVar8;
      }
      *(double *)(param_2 + 0x48) = (dVar10 / 42000.0) * 100.0;
      bVar2 = *(byte *)(iVar6 + 0x2f0);
    }
    else {
      *(undefined4 *)(param_2 + 0x48) = 0;
      *(undefined4 *)(param_2 + 0x4c) = 0;
      bVar2 = *(byte *)(iVar6 + 0x2f0);
    }
    if ((bVar2 & 8) != 0) {
      sprintf(acStack_a0,"wwv8 %04x %3d %s %04x %.0f %.0f/%.1f %ld %ld",*(undefined4 *)(iVar7 + 0x10e8),
              *(undefined4 *)(iVar7 + 0x844));
      FUN_0002ddbc(param_1 + 0xc,acStack_a0);
      if (DAT_0007cf4c != 0) {
        puts(acStack_a0);
      }
    }
    *(undefined4 *)(param_2 + 0x10) = 0;
    *(undefined4 *)(param_2 + 0x14) = 0;
    *(undefined4 *)(param_2 + 8) = 0;
    *(undefined4 *)(param_2 + 0xc) = 0;
  }
  return;
}




void FUN_0003a258(int param_1,undefined4 *param_2,double *param_3)

{
  double *pdVar1;
  double *pdVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  double *pdVar8;
  undefined4 uVar9;
  double dVar10;
  undefined4 extraout_s1;
  double dVar11;
  double dVar12;
  double dVar13;
  double dVar14;
  char acStack_a0 [128];
  
  dVar13 = *param_3;
  iVar6 = *(int *)(param_1 + 0x3c);
  iVar5 = *(int *)(iVar6 + 0x1c);
  if (dVar13 == 0.0) {
    dVar12 = -6000.0;
    iVar7 = 0;
  }
  else {
    pdVar1 = (double *)(param_2 + 8);
    iVar4 = 0;
    iVar3 = 0;
    pdVar8 = param_3 + 4;
    dVar10 = -6000.0;
    dVar11 = -6000.0;
    do {
      pdVar2 = (double *)&DAT_000821a0;
      dVar12 = 0.0;
      while( true ) {
        dVar14 = *pdVar2;
        pdVar2 = pdVar2 + 1;
        param_3 = param_3 + 1;
        dVar12 = dVar12 + dVar14 * dVar13;
        if (pdVar2 == (double *)&DAT_000821c0) break;
        dVar13 = *param_3;
      }
      dVar13 = *pdVar1 + (dVar12 - *pdVar1) * 0.0625;
      *pdVar1 = dVar13;
      pdVar1 = pdVar1 + 1;
      iVar7 = iVar4;
      dVar12 = dVar13;
      dVar14 = dVar10;
      if ((dVar13 <= dVar10) && (iVar7 = iVar3, dVar12 = dVar10, dVar14 = dVar11, dVar11 < dVar13)) {
        dVar14 = dVar13;
      }
      dVar13 = *pdVar8;
      iVar4 = iVar4 + 1;
      param_3 = pdVar8;
      iVar3 = iVar7;
      pdVar8 = pdVar8 + 4;
      dVar10 = dVar12;
      dVar11 = dVar14;
    } while (dVar13 != 0.0);
  }
  *(double *)(param_2 + 4) = dVar12;
  uVar9 = FUN_00039f88();
  dVar13 = *(double *)(param_2 + 4);
  *(ulonglong *)(param_2 + 6) = CONCAT44(extraout_s1,uVar9);
  if ((dVar13 < 1000.0) || ((double)CONCAT44(extraout_s1,uVar9) < 3.0)) {
    *(uint *)(iVar5 + 0x10e8) = *(uint *)(iVar5 + 0x10e8) | 0x40;
  }
  else {
    iVar3 = param_2[2];
    if (param_2[1] == iVar7) {
      if (iVar3 < 3) {
        iVar3 = iVar3 + 1;
        param_2[2] = iVar3;
      }
      if (iVar3 == 3) {
        *(uint *)(iVar5 + 0x10e8) = *(uint *)(iVar5 + 0x10e8) | 4;
        *(int *)(iVar5 + 0x10d4) = *(int *)(iVar5 + 0x10d4) + 1;
      }
    }
    else {
      iVar4 = iVar3;
      if (0 < iVar3) {
        iVar4 = iVar3 + -1;
      }
      *(uint *)(iVar5 + 0x10ec) = *(uint *)(iVar5 + 0x10ec) | 1;
      if (0 < iVar3) {
        param_2[2] = iVar4;
      }
      if (iVar4 == 0) {
        param_2[1] = iVar7;
      }
    }
  }
  if (((*(byte *)(iVar6 + 0x2f0) & 8) != 0) && ((*(uint *)(iVar5 + 0x10e8) & 8) == 0)) {
    sprintf(acStack_a0,"wwv4 %2d %04x %3d %4d %5.0f %2d %d %d %d %5.0f %5.1f",*(int *)(iVar5 + 0x10d0) + -1,
            *(uint *)(iVar5 + 0x10e8),*(undefined4 *)(iVar5 + 0x844),*(undefined4 *)(iVar5 + 0x854),
            *(undefined4 *)(iVar5 + 0x860),*(undefined4 *)(iVar5 + 0x864),*param_2,param_2[1],iVar7,param_2[2],dVar13,
            param_2[6],param_2[7]);
    FUN_0002ddbc(param_1 + 0xc,acStack_a0);
    if (DAT_0007cf4c != 0) {
      puts(acStack_a0);
    }
  }
  return;
}




/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x0003ab00 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_0003a4b0(int param_1)

{
  int iVar1;
  size_t sVar2;
  char *pcVar3;
  uint uVar4;
  undefined4 uVar5;
  undefined1 uVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  undefined4 *puVar11;
  double *pdVar12;
  uint uVar13;
  char *__s;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  int iVar19;
  double in_d0;
  double dVar20;
  double dVar21;
  char acStack_b0 [132];
  
  iVar9 = *(int *)(param_1 + 0x3c);
  iVar8 = *(int *)(iVar9 + 0x1c);
  if (DAT_000821c0 == 0) {
    DAT_000821c0 = 1;
    memset(&DAT_000821c8,0,0x1e8);
  }
  iVar10 = *(int *)(iVar8 + 0x10d0);
  *(int *)(iVar8 + 0x10d0) = iVar10 + 1;
  iVar7 = iVar10 * 8;
  uVar13 = *(uint *)(&DAT_0007ac44 + iVar7);
  dVar20 = *(double *)(&DAT_000821c8 + iVar7) + (in_d0 - *(double *)(&DAT_000821c8 + iVar7)) * 0.0625;
  *(double *)(&DAT_000821c8 + iVar7) = dVar20;
  switch(*(undefined4 *)(&DAT_0007ac40 + iVar10 * 8)) {
  case 1:
    pdVar12 = (double *)(&DAT_000821a0 + uVar13);
    if ((*(uint *)(iVar8 + 0x10e8) & 4) != 0) {
      *pdVar12 = in_d0;
      break;
    }
    goto LAB_0003aa9c;
  case 2:
    (&DAT_000821a0)[uVar13] = in_d0;
    break;
  case 3:
    pdVar12 = (double *)(&DAT_000821a0 + uVar13);
LAB_0003aa9c:
    *(undefined4 *)pdVar12 = 0;
    *(undefined4 *)((int)pdVar12 + 4) = 0;
    break;
  case 4:
    FUN_0003a258(param_1,iVar8 + uVar13 * 0x70 + 0xce0,&DAT_0007b048);
    break;
  case 5:
    FUN_0003a258(param_1,iVar8 + uVar13 * 0x70 + 0xce0,&DAT_0007af48);
    break;
  case 6:
    FUN_0003a258(param_1,iVar8 + uVar13 * 0x70 + 0xce0,&DAT_0007aea8);
    break;
  case 7:
    FUN_0003a258(param_1,iVar8 + uVar13 * 0x70 + 0xce0,&DAT_0007ae28);
    break;
  case 8:
    goto switchD_0003a520_caseD_8;
  case 9:
    FUN_0003a258(param_1,iVar8 + 0x1060,&DAT_0007b048);
    dVar20 = *(double *)(&DAT_000821c8 + iVar7);
    goto switchD_0003a520_caseD_8;
  case 10:
    if (1000.0 < dVar20) {
      if ((*(uint *)(iVar8 + 0x10f0) & uVar13) == 0) {
        *(uint *)(iVar8 + 0x10ec) = *(uint *)(iVar8 + 0x10ec) | 1;
      }
      *(uint *)(iVar8 + 0x10f0) = *(uint *)(iVar8 + 0x10f0) | uVar13;
      uVar4 = *(uint *)(iVar8 + 0x10e8);
    }
    else if (-1000.0 <= dVar20) {
      uVar4 = *(uint *)(iVar8 + 0x10e8) | 0x40;
    }
    else {
      if ((*(uint *)(iVar8 + 0x10f0) & uVar13) != 0) {
        *(uint *)(iVar8 + 0x10ec) = *(uint *)(iVar8 + 0x10ec) | 1;
      }
      uVar4 = *(uint *)(iVar8 + 0x10e8);
      *(uint *)(iVar8 + 0x10f0) = *(uint *)(iVar8 + 0x10f0) & ~uVar13;
    }
    *(uint *)(iVar8 + 0x10e8) = uVar4 & 0xfffffcff;
    if (*(int *)(iVar8 + 0x30) < 1) {
      *(undefined4 *)(*(int *)(iVar8 + 0xcdc) * 0xd8 + iVar8 + 0x898) = *(undefined4 *)(iVar8 + 0x844);
    }
    else {
      *(int *)(iVar8 + 0xcd8) = (*(int *)(iVar8 + 0xcd8) + 1) % 5;
      FUN_0003998c(param_1);
    }
    break;
  case 0xb:
    if ((*(uint *)(iVar8 + 0x10e8) & 0x1000) != 0) break;
  case 0xc:
    iVar14 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
    *(uint *)(iVar8 + 0x10e8) = *(uint *)(iVar8 + 0x10e8) & 0xffffefff;
    iVar7 = FUN_000398b8(iVar14 + 0xce0);
    if ((*(uint *)(iVar14 + 0x10e8) & 4) != 0) {
      if (((iVar7 == 0) && (iVar7 = FUN_000398b8(iVar14 + 0xd50), iVar7 == 0)) &&
         (iVar7 = FUN_000398b8(iVar14 + 0xdc0), iVar7 == 0)) {
        FUN_000398b8(iVar14 + 0xe30);
      }
      uVar13 = *(uint *)(iVar14 + 0xff4) & 3;
      iVar15 = *(int *)(iVar14 + 0xf84) * 100 + *(int *)(iVar14 + 0xea4) + *(int *)(iVar14 + 0xf14) * 10;
      iVar7 = *(int *)(iVar14 + 0xe34) * 600 +
              *(int *)(iVar14 + 0xce4) + *(int *)(iVar14 + 0xd54) * 10 + *(int *)(iVar14 + 0xdc4) * 0x3c;
      if (((*(uint *)(iVar14 + 0x10f0) & 0x40) != 0) && ((*(uint *)(iVar14 + 0x10e8) & 8) != 0)) {
        if (uVar13 == 0) {
          if (iVar15 != 0xb7) {
            iVar1 = 0x16e;
            goto LAB_0003a828;
          }
        }
        else if (iVar15 != 0xb6) {
          iVar1 = 0x16d;
LAB_0003a828:
          if (iVar15 != iVar1) goto LAB_0003a84c;
        }
        if (iVar7 == 0x59f) {
          *(uint *)(iVar14 + 0x10e8) = *(uint *)(iVar14 + 0x10e8) | 0x1000;
          goto LAB_0003a854;
        }
      }
LAB_0003a84c:
      if (iVar7 == 0x5a0) {
        do {
          iVar7 = FUN_000398b8(iVar14 + 0xdc0);
        } while (iVar7 != 0);
        do {
          iVar7 = FUN_000398b8(iVar14 + 0xe30);
        } while (iVar7 != 0);
        iVar7 = FUN_000398b8(iVar14 + 0xea0);
        if ((iVar7 == 0) && (iVar7 = FUN_000398b8(iVar14 + 0xf10), iVar7 == 0)) {
          FUN_000398b8(iVar14 + 0xf80);
        }
        if (uVar13 == 0) {
          iVar7 = 0x16e;
        }
        else {
          iVar7 = 0x16d;
        }
        if (iVar15 + 1 == iVar7) {
          do {
            iVar7 = FUN_000398b8(iVar14 + 0xea0);
          } while (iVar7 != 1);
          do {
            iVar7 = FUN_000398b8(iVar14 + 0xf10);
          } while (iVar7 != 0);
          do {
            iVar7 = FUN_000398b8(iVar14 + 0xf80);
          } while (iVar7 != 0);
          iVar7 = FUN_000398b8(iVar14 + 0xff0);
          if (iVar7 == 0) {
            FUN_000398b8(iVar14 + 0x1060);
          }
        }
      }
    }
LAB_0003a854:
    iVar7 = *(int *)(param_1 + 0x3c);
    *(undefined4 *)(iVar8 + 0x10d0) = 0;
    puVar11 = *(undefined4 **)(iVar7 + 0x1c);
    if ((puVar11[0x43a] & 2) == 0) {
      uVar13 = puVar11[0x43b] | 8;
      puVar11[0x43b] = uVar13;
    }
    else {
      uVar13 = puVar11[0x43b];
    }
    if ((int)puVar11[0x435] < 9) {
      uVar13 = uVar13 | 4;
      puVar11[0x43b] = uVar13;
    }
    else if (uVar13 == 0) {
      puVar11[0x43a] = puVar11[0x43a] | 8;
    }
    if ((puVar11[0x43a] & 10) == 10) {
      uVar6 = (undefined1)(puVar11[0x43c] & 0x40);
      if ((puVar11[0x43c] & 0x40) != 0) {
        uVar6 = 1;
      }
      *(undefined1 *)(iVar7 + 0x20) = uVar6;
      iVar1 = puVar11[0x3c5];
      iVar14 = puVar11[0x3a9];
      iVar18 = puVar11[0x3e1];
      iVar17 = puVar11[0x355];
      iVar15 = puVar11[0x38d];
      uVar5 = puVar11[0x434];
      iVar19 = puVar11[0x339];
      *(int *)(iVar7 + 0xac) = puVar11[0x3fd] + puVar11[0x419] * 10 + 2000;
      iVar16 = puVar11[0x371];
      *(undefined4 *)(iVar7 + 0xbc) = uVar5;
      *(int *)(iVar7 + 0xb8) = iVar19 + iVar17 * 10;
      *(int *)(iVar7 + 0xb0) = iVar18 * 100 + iVar14 + iVar1 * 10;
      *(int *)(iVar7 + 0xb4) = iVar16 + iVar15 * 10;
      iVar14 = FUN_0004efc8();
      if (iVar14 == 0) {
        uVar13 = puVar11[0x43b];
        puVar11[0xd] = 6;
      }
      else {
        uVar5 = puVar11[1];
        puVar11[0xe] = 0;
        dVar20 = *(double *)(puVar11 + 10);
        *(undefined4 *)(iVar7 + 0xd0) = *puVar11;
        *(undefined4 *)(iVar7 + 0xd4) = uVar5;
        *(undefined4 *)(iVar7 + 0xe8) = 0;
        *(undefined4 *)(iVar7 + 0xec) = 0;
        FUN_00027430(SUB84(dVar20 + 0.0051600000000000005,0),iVar7,0,0,*puVar11);
        FUN_000276a0(param_1);
        uVar13 = puVar11[0x43b];
      }
    }
    iVar14 = puVar11[0x3c5];
    iVar15 = puVar11[0x419];
    if ((puVar11[0x43a] & 8) == 0) {
      uVar5 = 0x3f;
    }
    else {
      uVar5 = 0x20;
    }
    iVar17 = puVar11[0x3a9];
    iVar18 = puVar11[0x3e1];
    __s = (char *)(iVar7 + 0x28);
    iVar1 = puVar11[0x3fd];
    sprintf(__s,"%c%1X",uVar5,uVar13);
    sprintf(acStack_b0," %4d %03d %02d:%02d:%02d %c%c %+d",iVar1 + iVar15 * 10 + 2000,
            iVar18 * 100 + iVar17 + iVar14 * 10);
    strcat(__s,acStack_b0);
    sprintf(acStack_b0," %d %d %s %.0f %d %.1f %d",puVar11[0xe],puVar11[puVar11[0x335] * 0x36 + 0x226]);
    sVar2 = strlen(__s);
    pcVar3 = stpcpy((char *)(iVar7 + sVar2 + 0x28),acStack_b0);
    *(int *)(iVar7 + 0xa8) = (int)pcVar3 - (int)__s;
    FUN_0002ddbc(param_1 + 0xc,__s);
    if (DAT_0007cf4c != 0) {
      printf("wwv: timecode %d %s\n",*(undefined4 *)(iVar7 + 0xa8),__s);
    }
    break;
  case 0xd:
    iVar7 = *(int *)(iVar8 + 0xcdc) * 0xd8 + iVar8;
    *(undefined4 *)(iVar7 + 0x8d8) = *(undefined4 *)(iVar7 + 0x8d0);
    *(undefined4 *)(iVar7 + 0x8dc) = *(undefined4 *)(iVar7 + 0x8d4);
    *(undefined4 *)(iVar7 + 0x940) = *(undefined4 *)(iVar7 + 0x938);
    *(undefined4 *)(iVar7 + 0x944) = *(undefined4 *)(iVar7 + 0x93c);
    break;
  case 0xe:
    iVar14 = *(int *)(iVar8 + 0xcdc) * 0xd8 + iVar8;
    dVar20 = *(double *)(iVar14 + 0x8d8);
    FUN_00039f88(SUB84(dVar20,0),(int)((ulonglong)dVar20 >> 0x20),(int)*(undefined8 *)(iVar14 + 0x8c8));
    dVar21 = *(double *)(iVar14 + 0x8d8);
    iVar7 = *(int *)(iVar14 + 0x8f4);
    uVar13 = *(int *)(iVar14 + 0x8f0) << 1;
    *(uint *)(iVar14 + 0x8f0) = uVar13;
    if ((uVar13 & 0x40) != 0) {
      iVar7 = iVar7 + -1;
      *(int *)(iVar14 + 0x8f4) = iVar7;
    }
    *(double *)(iVar14 + 0x8e0) = dVar20;
    if (((2500.0 <= dVar21) && (20.0 <= dVar20)) && ((*(uint *)(iVar8 + 0x10e8) & 0x60) == 0)) {
      iVar7 = iVar7 + 1;
      *(uint *)(iVar14 + 0x8f0) = uVar13 | 1;
      *(int *)(iVar14 + 0x8f4) = iVar7;
    }
    dVar20 = *(double *)(iVar14 + 0x940);
    if (6000.0 <= dVar21) {
      dVar21 = 5999.0;
    }
    *(double *)(iVar14 + 0x8e8) = (((double)(longlong)iVar7 * 6000.0 + dVar21) / 42000.0) * 100.0;
    FUN_00039f88(SUB84(dVar20,0),(int)((ulonglong)dVar20 >> 0x20),(int)*(undefined8 *)(iVar14 + 0x930));
    dVar21 = *(double *)(iVar14 + 0x940);
    iVar7 = *(int *)(iVar14 + 0x95c);
    uVar13 = *(int *)(iVar14 + 0x958) << 1;
    *(uint *)(iVar14 + 0x958) = uVar13;
    if ((uVar13 & 0x40) != 0) {
      iVar7 = iVar7 + -1;
      *(int *)(iVar14 + 0x95c) = iVar7;
    }
    *(double *)(iVar14 + 0x948) = dVar20;
    if (((2500.0 <= dVar21) && (20.0 <= dVar20)) && ((*(uint *)(iVar8 + 0x10e8) & 0x60) == 0)) {
      iVar7 = iVar7 + 1;
      *(uint *)(iVar14 + 0x958) = uVar13 | 1;
      *(int *)(iVar14 + 0x95c) = iVar7;
    }
    if (6000.0 <= dVar21) {
      dVar21 = (double)(longlong)iVar7 * 6000.0 + 5999.0;
    }
    else {
      dVar21 = dVar21 + (double)(longlong)iVar7 * 6000.0;
    }
    *(double *)(iVar14 + 0x950) = (dVar21 / 42000.0) * 100.0;
    if ((*(byte *)(iVar9 + 0x2f0) & 8) != 0) {
      sprintf(acStack_b0,"wwv5 %04x %3d %4d %.0f/%.1f %.0f/%.1f %s %04x %.0f %.0f/%.1f %s %04x %.0f %.0f/%.1f",
              *(undefined4 *)(iVar8 + 0x10e8),*(undefined4 *)(iVar8 + 0x844));
      FUN_0002ddbc(param_1 + 0xc,acStack_b0);
      if (DAT_0007cf4c != 0) {
        puts(acStack_b0);
      }
    }
    *(undefined4 *)(iVar8 + 0x10ec) = 0;
    *(undefined4 *)(iVar8 + 0x10d4) = 0;
    *(undefined4 *)(iVar8 + 0x10f4) = 0;
    iVar7 = *(int *)(iVar8 + 0x38);
    if ((*(uint *)(iVar8 + 0x10e8) & 8) == 0) {
      if ((*(uint *)(iVar8 + 0x10e8) & 4) == 0) {
        if (0xf < iVar7) goto LAB_0003ad64;
      }
      else if (0x28 < iVar7) {
LAB_0003ad64:
        FUN_00039b80(param_1);
        return;
      }
    }
    else if (0xb40 < iVar7) goto LAB_0003ad64;
    FUN_000399f8(param_1);
  }
switchD_0003a520_default:
  if (((*(byte *)(iVar9 + 0x2f0) & 8) != 0) && ((*(uint *)(iVar8 + 0x10e8) & 4) == 0)) {
    sprintf(acStack_b0,"wwv3 %2d %04x %3d %4d %5.0f %5.1f %5.0f %5.1f %5.0f",iVar10);
    FUN_0002ddbc(param_1 + 0xc,acStack_b0);
    if (DAT_0007cf4c != 0) {
      puts(acStack_b0);
    }
  }
  *(double *)(iVar9 + 0xe8) = *(double *)(iVar9 + 0xe8) + 5e-06;
  return;
switchD_0003a520_caseD_8:
  if (dVar20 <= 1000.0) {
    if (-1000.0 <= dVar20) {
      *(uint *)(iVar8 + 0x10e8) = *(uint *)(iVar8 + 0x10e8) | 0x40;
    }
    else {
      if ((*(uint *)(iVar8 + 0x10f0) & uVar13) != 0) {
        *(uint *)(iVar8 + 0x10ec) = *(uint *)(iVar8 + 0x10ec) | 1;
      }
      *(uint *)(iVar8 + 0x10f0) = *(uint *)(iVar8 + 0x10f0) & ~uVar13;
    }
  }
  else {
    if ((*(uint *)(iVar8 + 0x10f0) & uVar13) == 0) {
      *(uint *)(iVar8 + 0x10ec) = *(uint *)(iVar8 + 0x10ec) | 1;
    }
    *(uint *)(iVar8 + 0x10f0) = *(uint *)(iVar8 + 0x10f0) | uVar13;
  }
  goto switchD_0003a520_default;
}




/* WARNING: Removing unreachable block (ram,0x0003c3f8) */
/* WARNING: Removing unreachable block (ram,0x0003c3c0) */
/* WARNING: Removing unreachable block (ram,0x0003c3a4) */
/* WARNING: Removing unreachable block (ram,0x0003c3e8) */
/* WARNING: Removing unreachable block (ram,0x0003c3dc) */
/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x0003c094 */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_0003b148(int param_1)

{
  double *pdVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  bool bVar10;
  undefined4 uVar11;
  double in_d0;
  undefined4 uVar12;
  double dVar13;
  int iVar14;
  double dVar15;
  double dVar16;
  undefined4 uVar17;
  double dVar18;
  double dVar19;
  double dVar20;
  double dVar21;
  double dVar22;
  double dVar23;
  double dVar24;
  double dVar25;
  double dVar26;
  double dVar27;
  double dVar28;
  double dVar29;
  uint local_f8;
  char acStack_e8 [132];
  
  iVar3 = *(int *)(param_1 + 0x3c);
  iVar8 = *(int *)(iVar3 + 0x1c);
  dVar16 = DAT_00082418;
  dVar20 = DAT_00082410;
  dVar22 = DAT_00082408;
  dVar25 = DAT_00082400;
  dVar26 = DAT_000823f8;
  dVar19 = DAT_000823d0;
  dVar27 = DAT_000823f0;
  dVar21 = DAT_000823c8;
  dVar28 = DAT_000823e8;
  dVar29 = DAT_000823c0;
  if (DAT_000823b0 == 0) {
    DAT_000823b0 = 1;
    memset(&DAT_000823e0,0,0x48);
    dVar16 = 0.0;
    memset(&DAT_00082428,0,0x148);
    memset(&DAT_00082570,0,0x2a80);
    memset(&DAT_00084ff0,0,0x2a80);
    memset(&DAT_00087a70,0,0xc800);
    memset(&DAT_00094270,0,0xc800);
    memset(&DAT_000a0a70,0,0x140);
    memset(&DAT_000a0bb0,0,0x140);
    memset(&DAT_000a0cf0,0,0xc800);
    memset(&DAT_000ad4f0,0,0xc800);
    memset(&DAT_000b9cf0,0,0x140);
    memset(&DAT_000b9e30,0,0x140);
    memset(&DAT_000b9f70,0,64000);
    DAT_000823e0 = dVar16;
    DAT_000823b8 = dVar16;
    dVar20 = dVar16;
    dVar22 = dVar16;
    dVar25 = dVar16;
    dVar26 = dVar16;
    dVar19 = dVar16;
    dVar27 = dVar16;
    dVar21 = dVar16;
    dVar28 = dVar16;
    dVar29 = dVar16;
  }
  iVar4 = *(int *)(iVar8 + 0x880);
  dVar23 = *(double *)(&DAT_0007b1b0 + iVar4 * 8);
  iVar7 = DAT_000c9970 * 8;
  pdVar1 = (double *)(iVar8 + 0x870);
  dVar13 = *(double *)(&DAT_0007b1b0 + ((iVar4 + 0x14) % 0x50) * 8);
  DAT_000823c0 = DAT_000823b8;
  DAT_000823c8 = dVar29;
  DAT_000823d0 = dVar21;
  DAT_000823d8 = dVar19;
  DAT_000823e8 = DAT_000823e0;
  DAT_000823f0 = dVar28;
  DAT_000823f8 = dVar27;
  DAT_00082400 = dVar26;
  DAT_00082408 = dVar25;
  DAT_00082410 = dVar22;
  DAT_00082418 = dVar20;
  DAT_00082420 = dVar16;
  *(int *)(iVar8 + 0x880) = (iVar4 + 1) % 0x50;
  dVar24 = in_d0 * 5.0 - (dVar21 * -3.48174 + dVar19 * 0.8360961 + dVar29 * 5.452988 + DAT_000823b8 * -3.807229);
  dVar18 = in_d0 - (dVar20 * -2.765914 + dVar16 * 0.4897278 + dVar22 * 8.110921 + dVar25 * -15.17732 + dVar26 * 19.75197
                    + dVar27 * -18.14365 + dVar28 * 11.59783 + DAT_000823e0 * -4.73504);
  dVar15 = DAT_000823e0 * -0.02375732;
  iVar5 = (*(int *)(iVar8 + 0x894) + 1) % 480000;
  DAT_000c9970 = (DAT_000c9970 + 1) % 0x550;
  dVar21 = DAT_000823b8 * -0.01149947 + dVar24 * 0.003281435 + dVar29 * 0.01654858 + dVar21 * -0.01149947 +
           dVar19 * 0.003281435;
  dVar19 = (dVar21 * dVar23) / 680.0;
  dVar21 = (dVar21 * dVar13) / 680.0;
  DAT_000823b8 = dVar24;
  DAT_000823e0 = dVar18;
  *pdVar1 = *pdVar1 - *(double *)(&DAT_00082570 + iVar7);
  *(double *)(&DAT_00082570 + iVar7) = dVar19;
  *pdVar1 = *pdVar1 + dVar19;
  *(double *)(iVar8 + 0x878) = *(double *)(iVar8 + 0x878) - *(double *)(&DAT_00084ff0 + iVar7);
  *(double *)(&DAT_00084ff0 + iVar7) = dVar21;
  dVar16 = dVar15 + dVar18 * 0.008203628 + dVar28 * 0.03353214 + dVar27 * -0.04080258 + dVar26 * 0.04605479 +
           dVar25 * -0.04080258 + dVar22 * 0.03353214 + dVar20 * -0.02375732 + dVar16 * 0.008203628;
  *(double *)(iVar8 + 0x878) = *(double *)(iVar8 + 0x878) + dVar21;
  iVar7 = DAT_000c9978;
  iVar4 = DAT_000c9974 + 0x14;
  dVar22 = *(double *)(&DAT_0007b1b0 + DAT_000c9974 * 8);
  local_f8 = DAT_000c9978;
  *(int *)(iVar8 + 0x894) = iVar5;
  iVar14 = DAT_000c9988;
  DAT_000c9974 = (DAT_000c9974 + 10) % 0x50;
  iVar7 = iVar7 * 8;
  dVar26 = *(double *)(&DAT_00094270 + iVar7);
  dVar25 = *(double *)(&DAT_00087a70 + iVar7);
  iVar5 = iVar5 % 8000;
  dVar20 = dVar16 * *(double *)(&DAT_0007b1b0 + (iVar4 % 0x50) * 8) * 0.25;
  *(double *)(&DAT_00094270 + iVar7) = dVar20;
  iVar4 = iVar14 * 8;
  dVar22 = dVar16 * dVar22 * 0.25;
  DAT_000c9998 = dVar20 + (DAT_000c9998 - dVar26);
  *(double *)(&DAT_00087a70 + iVar7) = dVar22;
  dVar19 = *(double *)(&DAT_000a0a70 + iVar4);
  dVar26 = *(double *)(&DAT_000a0bb0 + iVar4);
  *(double *)(&DAT_000a0a70 + iVar4) = dVar22;
  *(double *)(&DAT_000a0bb0 + iVar4) = dVar20;
  iVar2 = *(int *)(iVar8 + 0xcdc) * 0xd8 + iVar8;
  DAT_000c9980 = dVar22 + (DAT_000c9980 - dVar25);
  DAT_000c9990 = dVar22 + (DAT_000c9990 - dVar19);
  DAT_000c99a0 = dVar20 + (DAT_000c99a0 - dVar26);
  uVar6 = *(uint *)(iVar8 + 0x10e8);
  *(double *)(iVar2 + 0x8c8) = SQRT(DAT_000c9998 * DAT_000c9998 + DAT_000c9980 * DAT_000c9980) / 800.0;
  if ((uVar6 & 1) == 0) {
    FUN_00039fe8(param_1,iVar2 + 0x8a0,(int)(longlong)(*(double *)(iVar3 + 0x2d8) * 8000.0));
    local_f8 = DAT_000c9978;
    iVar7 = DAT_000c9978 << 3;
    iVar4 = DAT_000c9988 << 3;
    iVar14 = DAT_000c9988;
  }
  iVar2 = DAT_000c99a8 + 0x14;
  dVar25 = *(double *)(&DAT_0007b1b0 + DAT_000c99a8 * 8);
  dVar20 = *(double *)(&DAT_000ad4f0 + iVar7);
  dVar26 = *(double *)(&DAT_000a0cf0 + iVar7);
  DAT_000c99a8 = (DAT_000c99a8 + 0xc) % 0x50;
  dVar19 = *(double *)(&DAT_000b9e30 + iVar4);
  dVar27 = *(double *)(&DAT_000b9cf0 + iVar4);
  dVar22 = dVar16 * *(double *)(&DAT_0007b1b0 + (iVar2 % 0x50) * 8) * 0.25;
  *(double *)(&DAT_000ad4f0 + iVar7) = dVar22;
  *(double *)(&DAT_000b9e30 + iVar4) = dVar22;
  iVar2 = *(int *)(iVar8 + 0xcdc) * 0xd8 + iVar8;
  dVar25 = dVar16 * dVar25 * 0.25;
  DAT_000c99c0 = dVar22 + (DAT_000c99c0 - dVar20);
  *(double *)(&DAT_000a0cf0 + iVar7) = dVar25;
  *(double *)(&DAT_000b9cf0 + iVar4) = dVar25;
  DAT_000c99b0 = dVar25 + (DAT_000c99b0 - dVar26);
  dVar16 = DAT_000c99c0 * DAT_000c99c0 + DAT_000c99b0 * DAT_000c99b0;
  DAT_000c99c8 = dVar22 + (DAT_000c99c8 - dVar19);
  DAT_000c99b8 = dVar25 + (DAT_000c99b8 - dVar27);
  uVar9 = 0x10e8;
  uVar6 = *(uint *)(iVar8 + 0x10e8);
  bVar10 = (uVar6 & 1) == 0;
  if (!bVar10) {
    uVar9 = 1;
  }
  *(double *)(iVar2 + 0x930) = SQRT(dVar16) / 800.0;
  if (bVar10) {
    FUN_00039fe8(param_1,iVar2 + 0x908,(int)(longlong)(*(double *)(iVar3 + 0x2e0) * 8000.0));
    local_f8 = DAT_000c9978;
    uVar6 = *(uint *)(iVar8 + uVar9);
    uVar9 = uVar6 & 1;
    iVar14 = DAT_000c9988;
  }
  DAT_000c9978 = (int)(local_f8 + 1) % 0x1900;
  DAT_000c9988 = (iVar14 + 1) % 0x28;
  if (*(int *)(iVar8 + 0x894) == 0) {
    *(int *)(iVar8 + 0x38) = *(int *)(iVar8 + 0x38) + 1;
    if (uVar9 == 0) {
      iVar3 = FUN_000399f8(param_1);
      uVar6 = *(uint *)(iVar8 + 0x10e8);
      if (iVar3 == 0) {
        *(undefined4 *)(iVar8 + 0x38) = 0;
      }
      uVar9 = uVar6 & 1;
      goto LAB_0003b968;
    }
    if ((uVar6 & 0x1000) != 0) {
      *(undefined4 *)(iVar8 + 0x894) = 0x733c0;
    }
LAB_0003b810:
    iVar4 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
    iVar7 = *(int *)(iVar4 + 0xcdc) * 0xd8 + iVar4;
    iVar3 = *(int *)(iVar4 + 0x890);
    if (*(double *)(iVar7 + 0x8d0) < *(double *)(iVar7 + 0x8c8)) {
      *(double *)(iVar7 + 0x8d0) = *(double *)(iVar7 + 0x8c8);
    }
    if (*(double *)(iVar7 + 0x938) < *(double *)(iVar7 + 0x930)) {
      *(double *)(iVar7 + 0x938) = *(double *)(iVar7 + 0x930);
    }
    if (iVar3 == 0x1900) {
      *(undefined4 *)(iVar4 + 0x858) = *(undefined4 *)(iVar4 + 0x854);
    }
    else if (iVar3 == 0x78) {
      pdVar1 = (double *)(iVar4 + 0x870);
      DAT_000c99e0._0_4_ = *(undefined4 *)pdVar1;
      DAT_000c99e0._4_4_ = *(undefined4 *)(iVar4 + 0x874);
      DAT_000c99d8 = *pdVar1;
      _DAT_000c99d0 = *pdVar1;
    }
    else if (iVar3 == 0x640) {
      dVar16 = *(double *)(iVar4 + 0x878);
      DAT_000c99d8 = *(double *)(iVar4 + 0x870);
      dVar16 = dVar16 * dVar16 + DAT_000c99d8 * DAT_000c99d8;
      DAT_000c99e8 = SQRT(dVar16);
      iVar7 = *(int *)(iVar4 + 0x880);
      dVar20 = *(double *)(iVar4 + 0x878) / (double)(longlong)*(int *)(iVar4 + 0x850);
      *(double *)(iVar4 + 0x888) = dVar20;
      if (dVar20 < 0.0) {
        *(int *)(iVar4 + 0x880) = iVar7 + -1;
        if (iVar7 + -1 < 0) {
          *(int *)(iVar4 + 0x880) = iVar7 + 0x4f;
        }
      }
      else {
        iVar2 = iVar7 + 1;
        *(int *)(iVar4 + 0x880) = iVar2;
        iVar14 = iVar7 + -0x4e;
        if (0x4f < iVar2) {
          iVar7 = iVar7 + -0x4f;
        }
        if (iVar2 != 0x4f && iVar14 < 0 == SBORROW4(iVar2,0x4f)) {
          *(int *)(iVar4 + 0x880) = iVar7;
        }
      }
    }
    else if (iVar3 == 4000) {
      _DAT_000c99d0 = *(double *)(iVar4 + 0x870);
    }
    *(int *)(iVar4 + 0x890) = iVar3 + 1;
    if (*(int *)(iVar4 + 0x894) % 8000 == *(int *)(iVar4 + 0x858)) {
      *(uint *)(iVar4 + 0x10e8) = *(uint *)(iVar4 + 0x10e8) & 0xffffff9f;
      dVar20 = DAT_000c99e8;
      dVar16 = *(double *)(iVar4 + 0x878) * *(double *)(iVar4 + 0x878) +
               *(double *)(iVar4 + 0x870) * *(double *)(iVar4 + 0x870);
      dVar22 = SQRT(dVar16);
      DAT_000c99f4 = (undefined4)((ulonglong)dVar22 >> 0x20);
      uVar17 = SUB84(dVar22,0);
      DAT_000c99f0 = uVar17;
      *(double *)(iVar4 + 0x10d8) = DAT_000c99e8;
      uVar12 = (undefined4)((ulonglong)dVar16 >> 0x20);
      uVar11 = SUB84(dVar20,0);
      FUN_00039f88(uVar11,uVar12,uVar17);
      dVar16 = (double)CONCAT44(uVar12,uVar11);
      *(double *)(iVar4 + 0x10e0) = dVar16;
      if ((dVar20 < 1000.0) || (dVar16 < 10.0)) {
        *(uint *)(iVar4 + 0x10e8) = *(uint *)(iVar4 + 0x10e8) | 0x20;
        FUN_0003a4b0(0,param_1);
      }
      else {
        dVar20 = _DAT_000c99d0 - (double)CONCAT44(DAT_000c99e0._4_4_,(undefined4)DAT_000c99e0);
        DAT_000c99d8 = DAT_000c99d8 - _DAT_000c99d0;
        dVar16 = dVar20 - DAT_000c99d8;
        _DAT_000c99d0 = dVar20;
        FUN_0003a4b0(SUB84(dVar16,0),param_1);
      }
      if ((*(uint *)(iVar4 + 0x10e8) & 0x60) == 0) {
        iVar3 = *(int *)(iVar4 + 0x10f4);
      }
      else {
        iVar3 = *(int *)(iVar4 + 0x10f4) + 1;
        *(int *)(iVar4 + 0x10f4) = iVar3;
      }
      if (0x28 < iVar3) {
        *(uint *)(iVar4 + 0x10ec) = *(uint *)(iVar4 + 0x10ec) | 2;
      }
      FUN_00039f10(param_1);
      uVar6 = *(uint *)(iVar8 + 0x10e8);
      iVar3 = *(int *)(iVar4 + 0xcdc) * 0xd8 + iVar4;
      *(undefined8 *)(iVar3 + 0x8d0) = 0;
      *(undefined8 *)(iVar3 + 0x938) = 0;
      *(undefined4 *)(iVar4 + 0x890) = 0;
    }
    else {
      uVar6 = *(uint *)(iVar8 + 0x10e8);
    }
  }
  else {
LAB_0003b968:
    if (uVar9 != 0) goto LAB_0003b810;
    iVar3 = *(int *)(iVar8 + 0xcd0);
    if ((iVar3 != 0) && (50.0 <= *(double *)(iVar3 + 0x48))) {
      iVar4 = *(int *)(iVar3 + 0x20);
      iVar3 = iVar4 >> 0x1f;
      iVar7 = iVar4 / 8000 + iVar3;
      if (iVar4 + (iVar7 - iVar3) * -8000 == iVar5) {
        iVar3 = (iVar3 - iVar7) + 0x3c;
        bVar10 = (uVar6 & 2) == 0;
        *(undefined4 *)(iVar8 + 0x890) = 0;
        *(undefined4 *)(iVar8 + 0x38) = 0;
        uVar6 = uVar6 | 1;
        if (bVar10) {
          *(int *)(iVar8 + 0x854) = iVar5;
        }
        *(uint *)(iVar8 + 0x10e8) = uVar6;
        if (bVar10) {
          *(int *)(iVar8 + 0x858) = iVar5;
        }
        iVar7 = (iVar3 / 0x3c) * 0xf;
        if (!bVar10) {
          iVar7 = *(int *)(iVar8 + 0x854);
        }
        *(int *)(iVar8 + 0x10d0) = iVar3 % 0x3c;
        if (!bVar10) {
          *(int *)(iVar8 + 0x858) = iVar7;
        }
      }
    }
  }
  dVar20 = DAT_000c99f8;
  if ((uVar6 & 0x100) == 0) {
    if ((uVar6 & 0x200) != 0) {
      dVar16 = DAT_000c99c8 * DAT_000c99c8;
      dVar22 = DAT_000c99b8;
      goto LAB_0003bccc;
    }
    dVar22 = 0.0;
  }
  else {
    dVar16 = DAT_000c99a0 * DAT_000c99a0;
    dVar22 = DAT_000c9990;
LAB_0003bccc:
    dVar16 = dVar16 + dVar22 * dVar22;
    dVar22 = SQRT(dVar16) / 5.0;
  }
  dVar22 = *(double *)(&DAT_000b9f70 + iVar5 * 8) +
           (dVar22 - *(double *)(&DAT_000b9f70 + iVar5 * 8)) / (double)(longlong)*(int *)(iVar8 + 0x850);
  *(double *)(&DAT_000b9f70 + iVar5 * 8) = dVar22;
  if (dVar20 < dVar22) {
    iVar3 = iVar5 + -0x30;
    if (iVar3 < 0) {
      iVar3 = iVar5 + 0x1f10;
    }
    DAT_000c9a08 = ABS(*(double *)(&DAT_000b9f70 + iVar3 * 8));
    DAT_000c99f8 = dVar22;
  }
  dVar20 = DAT_000c99f8;
  if (iVar5 != 0) {
    return;
  }
  *(double *)(iVar8 + 0x860) = DAT_000c99f8;
  uVar11 = (undefined4)((ulonglong)dVar16 >> 0x20);
  FUN_00039f88(SUB84(dVar20,0),uVar11,SUB84(DAT_000c9a08,0));
  iVar7 = *(int *)(param_1 + 0x3c);
  iVar3 = DAT_000c9a00 + -0x28;
  if (iVar3 < 0) {
    iVar3 = DAT_000c9a00 + 0x1f18;
  }
  iVar4 = *(int *)(iVar7 + 0x1c);
  dVar16 = *(double *)(iVar4 + 0x860);
  DAT_000c9a00 = iVar3;
  *(ulonglong *)(iVar8 + 0x868) = CONCAT44(uVar11,SUB84(dVar20,0));
  if (DAT_000c9a10 == 0) {
    DAT_000c9a14 = 0;
    DAT_000c9a18 = 0;
    DAT_000c9a10 = 1;
    DAT_000c9a1c = 0;
  }
  DAT_000c9a20 = DAT_000c9a20 + 1;
  if ((dVar16 < 2500.0) || (*(double *)(iVar4 + 0x868) < 15.0)) {
    DAT_000c9a24 = 0;
    DAT_000c9a28 = 0;
    *(uint *)(iVar4 + 0x10e8) = *(uint *)(iVar4 + 0x10e8) & 0xffffffed;
    DAT_000c9a2c = 0;
    iVar14 = DAT_000c9a34;
    goto LAB_0003bac8;
  }
  uVar6 = *(uint *)(iVar4 + 0x10e8);
  iVar14 = DAT_000c9a34;
  if ((uVar6 & 0x300) == 0) goto LAB_0003bac8;
  DAT_000c9a30 = DAT_000c9a14;
  if (DAT_000c9a14 < iVar3) {
    if ((DAT_000c9a14 <= DAT_000c9a18) && (DAT_000c9a30 = DAT_000c9a18, iVar3 < DAT_000c9a18)) {
LAB_0003bda8:
      DAT_000c9a30 = iVar3;
    }
  }
  else if ((DAT_000c9a18 <= DAT_000c9a14) && (DAT_000c9a30 = DAT_000c9a18, DAT_000c9a18 < iVar3)) goto LAB_0003bda8;
  iVar14 = DAT_000c9a30;
  iVar2 = DAT_000c9a28;
  DAT_000c9a1c = DAT_000c9a18;
  if ((DAT_000c9a30 - DAT_000c9a34) % 8000 == 0) {
    DAT_000c9a28 = DAT_000c9a28 + 1;
    iVar5 = DAT_000c9a14;
    if (((10 < DAT_000c9a28) && (iVar5 = DAT_000c9a14, (uVar6 & 1) != 0)) &&
       (((uVar6 & 0x10) != 0 || (iVar5 = DAT_000c9a14, DAT_000c9a20 - DAT_000c9a38 <= *(int *)(iVar4 + 0x850))))) {
      iVar2 = DAT_000c9a14;
      *(int *)(iVar4 + 0x854) = DAT_000c9a30;
      DAT_000c9a18 = iVar2;
      DAT_000c9a14 = iVar3;
      *(uint *)(iVar4 + 0x10e8) = uVar6 | 2;
      iVar3 = DAT_000c9a14;
      iVar5 = DAT_000c9a18;
    }
  }
  else {
    iVar5 = DAT_000c9a14;
    if (DAT_000c9a24 <= DAT_000c9a28) {
      DAT_000c9a28 = 0;
      iVar5 = DAT_000c9a14;
      DAT_000c9a24 = iVar2;
      DAT_000c9a3c = DAT_000c9a20;
      DAT_000c9a40 = DAT_000c9a34;
    }
  }
  DAT_000c9a18 = iVar5;
  DAT_000c9a14 = iVar3;
  if (((*(byte *)(iVar7 + 0x2f0) & 8) != 0) && ((*(uint *)(iVar4 + 0x10e8) & 1) == 0)) {
    sprintf(acStack_e8,"wwv1 %04x %3d %4d %5.0f %5.1f %5d %4d %4d %4d",*(uint *)(iVar4 + 0x10e8),
            *(undefined4 *)(iVar4 + 0x844));
    FUN_0002ddbc(param_1 + 0xc,acStack_e8);
    iVar14 = DAT_000c9a30;
    if (DAT_0007cf4c != 0) {
      puts(acStack_e8);
      iVar14 = DAT_000c9a30;
    }
  }
  iVar3 = *(int *)(iVar4 + 0x850);
  DAT_000c9a2c = DAT_000c9a2c + 1;
  if (iVar3 <= DAT_000c9a2c) {
    if (DAT_000c9a24 <= DAT_000c9a28) {
      DAT_000c9a24 = DAT_000c9a28;
      DAT_000c9a3c = DAT_000c9a20;
      DAT_000c9a40 = DAT_000c9a34;
    }
    if (DAT_000c9a24 == 0) {
      DAT_000c9a3c = DAT_000c9a20;
      DAT_000c9a40 = iVar14;
    }
    iVar2 = DAT_000c9a40;
    local_f8 = *(uint *)(iVar4 + 0x10e8);
    dVar16 = (double)(longlong)((DAT_000c9a40 - DAT_000c9a44) % 8000);
    DAT_000c9a34 = iVar14;
    if ((local_f8 & 0x10) != 0) {
      iVar14 = (int)(longlong)dVar16;
      if (iVar14 < 0) {
        iVar14 = -iVar14;
      }
      if (12.0 <= (double)(longlong)iVar14) {
        if (DAT_000c9a48 + 2 < 0 == SCARRY4(DAT_000c9a48,2)) {
          DAT_000c9a48 = DAT_000c9a48 + -1;
        }
        else if (8 < iVar3) {
          *(int *)(iVar4 + 0x850) = iVar3 >> 1;
          DAT_000c9a48 = 0;
        }
      }
      else {
        dVar16 = (dVar16 * 0.5) / (double)(longlong)((DAT_000c9a3c - DAT_000c9a38) * 3) + *(double *)(iVar4 + 0x18);
        if (1.5 < dVar16) {
          *(undefined8 *)(iVar4 + 0x18) = 0x3ff8000000000000;
        }
        else {
          if (dVar16 < -1.5) {
            dVar16 = -1.5;
          }
          *(double *)(iVar4 + 0x18) = dVar16;
        }
        if ((double)(longlong)iVar14 < 6.0) {
          if (DAT_000c9a48 < 3) {
            DAT_000c9a48 = DAT_000c9a48 + 1;
          }
          else if (iVar3 < 0x400) {
            *(int *)(iVar4 + 0x850) = iVar3 << 1;
            DAT_000c9a48 = 0;
          }
        }
      }
    }
    if ((*(byte *)(iVar7 + 0x2f0) & 8) != 0) {
      sprintf(acStack_e8,"wwv2 %04x %5.0f %5.1f %5d %4d %4d %4d %4.0f %7.2f",local_f8);
      FUN_0002ddbc(param_1 + 0xc,acStack_e8);
      if (DAT_0007cf4c != 0) {
        puts(acStack_e8);
      }
      local_f8 = *(uint *)(iVar4 + 0x10e8);
      iVar2 = DAT_000c9a40;
    }
    DAT_000c9a38 = DAT_000c9a3c;
    DAT_000c9a44 = iVar2;
    *(uint *)(iVar4 + 0x10e8) = local_f8 | 0x10;
    DAT_000c9a24 = 0;
    DAT_000c9a28 = 0;
    DAT_000c9a2c = 0;
    iVar14 = DAT_000c9a34;
  }
LAB_0003bac8:
  DAT_000c9a34 = iVar14;
  if ((*(uint *)(iVar8 + 0x10e8) & 2) == 0) {
    *(uint *)(iVar8 + 0x10ec) = *(uint *)(iVar8 + 0x10ec) | 8;
  }
  DAT_000c99f8 = 0.0;
  if ((*(uint *)(iVar8 + 0x10e8) & 1) == 0) {
    FUN_00039f10(param_1);
  }
  return;
}




void FUN_0003c778(undefined4 param_1,int param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = *(int *)(param_2 + 0x3c);
  iVar2 = *(int *)(iVar3 + 0x1c);
  *(int *)(iVar3 + 0x2f8) = *(int *)(iVar3 + 0x2f8) + 1;
  iVar1 = *(int *)(iVar3 + 0xb4);
  if (((*(byte *)(iVar3 + 0x2f0) & 8) != 0) && (iVar1 < (int)(uint)*(byte *)(iVar2 + 0xc))) {
    *(undefined1 *)(iVar2 + 0xd) = 0xf;
    iVar1 = *(int *)(iVar3 + 0xb4);
  }
  *(char *)(iVar2 + 0xc) = (char)iVar1;
  if (*(int *)(iVar3 + 200) == *(int *)(iVar3 + 0xcc)) {
    FUN_00027040(param_2,1);
    return;
  }
  FUN_000276a0(param_2);
  FUN_0002ddbc(param_2 + 0xc,iVar3 + 0x28);
  if (DAT_0007cf4c != 0) {
    printf("wwvb: timecode %d %s\n",*(undefined4 *)(iVar3 + 0xa8),iVar3 + 0x28);
    return;
  }
  return;
}




undefined4 FUN_0003c850(undefined4 param_1,int param_2)

{
  int __fd;
  void *__ptr;
  int iVar1;
  undefined4 uVar2;
  int iVar3;
  char acStack_2c [20];
  
  snprintf(acStack_2c,0x14,"/dev/wwvb%d",param_1);
  __fd = FUN_00027d18(acStack_2c,0xd,1);
  if (__fd < 1) {
    uVar2 = 0;
  }
  else {
    __ptr = (void *)FUN_0004f478(0,0x10,0,1);
    iVar3 = *(int *)(param_2 + 0x3c);
    *(int *)(iVar3 + 0xc) = param_2;
    *(int *)(iVar3 + 0x14) = __fd;
    *(code **)(iVar3 + 4) = FUN_0003c930;
    *(undefined4 *)(iVar3 + 0x10) = 0;
    iVar1 = FUN_00015fc4(iVar3);
    if (iVar1 == 0) {
      close(__fd);
      *(undefined4 *)(iVar3 + 0x14) = 0xffffffff;
      free(__ptr);
      uVar2 = 0;
    }
    else {
      uVar2 = 1;
      *(void **)(iVar3 + 0x1c) = __ptr;
      *(undefined1 *)(param_2 + 0x47) = 0xf3;
      *(char **)(iVar3 + 0x24) = "Spectracom WWVB/GPS Receiver";
      *(undefined4 *)(iVar3 + 0x2ec) = 0x42565757;
    }
  }
  return uVar2;
}




void FUN_0003c930(int param_1)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined4 *puVar8;
  char *__s;
  undefined4 *puVar9;
  char local_39;
  undefined1 local_38;
  char local_37 [3];
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  undefined4 local_28;
  undefined4 uStack_24;
  
  iVar7 = *(int *)(param_1 + 8);
  iVar6 = *(int *)(iVar7 + 0x3c);
  __s = (char *)(iVar6 + 0x28);
  puVar8 = *(undefined4 **)(iVar6 + 0x1c);
  iVar1 = FUN_00027aac(param_1,__s,0x80,&local_28);
  iVar5 = DAT_0007cf4c;
  if (iVar1 == 0) {
    uVar4 = puVar8[2];
    if (uVar4 == 0) {
      *puVar8 = local_28;
      puVar8[1] = uStack_24;
      if (1 < iVar5) {
        uVar2 = FUN_000503e0(&local_28);
        printf("wwvb: <CR> @ %s\n",uVar2);
        iVar5 = 1 - puVar8[2];
        if (1 < (uint)puVar8[2]) {
          iVar5 = 0;
        }
        puVar8[2] = iVar5;
        return;
      }
    }
    else if (1 < DAT_0007cf4c) {
      uVar2 = FUN_000503e0(&local_28);
      printf("wwvb: <LF> @ %s\n",uVar2);
      uVar4 = puVar8[2];
    }
    iVar5 = 1 - uVar4;
    if (1 < uVar4) {
      iVar5 = 0;
    }
    puVar8[2] = iVar5;
    return;
  }
  puVar9 = (undefined4 *)(iVar6 + 0xd8);
  uVar2 = *puVar8;
  uVar3 = puVar8[1];
  *(int *)(iVar6 + 0xa8) = iVar1;
  iVar5 = DAT_0007cf4c;
  *puVar9 = uVar2;
  *(undefined4 *)(iVar6 + 0xdc) = uVar3;
  puVar8[2] = 1;
  *puVar8 = local_28;
  puVar8[1] = uStack_24;
  if (1 < iVar5) {
    uVar2 = FUN_000503e0(&local_28);
    uVar3 = FUN_000503e0(puVar9);
    printf("wwvb: code @ %s\n       using %s minus one char\n",uVar2,uVar3);
  }
  if ((*(int *)(iVar6 + 0xd8) == 0) && (*(int *)(iVar6 + 0xdc) == 0)) {
    return;
  }
  iVar5 = *(int *)(iVar6 + 0xa8);
  local_37[1] = 0x20;
  local_37[0] = ' ';
  local_38 = 0x20;
  local_39 = ' ';
  local_34 = 0;
  if (iVar5 == 0x18) {
    iVar5 = sscanf(__s,"%c%c %2d %3d %2d:%2d:%2d.%3ld %c",&local_39,&local_38,iVar6 + 0xac,iVar6 + 0xb0,iVar6 + 0xb4,
                   iVar6 + 0xb8,iVar6 + 0xbc,iVar6 + 0xc0,local_37);
    if (iVar5 == 9) {
      *(int *)(iVar6 + 0xc0) = *(int *)(iVar6 + 0xc0) * 1000000;
      goto LAB_0003cb20;
    }
  }
  else if (iVar5 == 0x1d) {
    iVar5 = sscanf(__s,"0003%c %4d%2d%2d %2d%2d%2d+0000%c%c",&local_39,iVar6 + 0xac,&local_2c,&local_30,iVar6 + 0xb4,
                   iVar6 + 0xb8,iVar6 + 0xbc,local_37 + 1,local_37);
    if (iVar5 == 8) {
      uVar2 = FUN_000513cc(*(undefined4 *)(iVar6 + 0xac),local_2c,local_30);
      *(undefined4 *)(iVar6 + 0xc0) = 0;
      *(undefined4 *)(iVar6 + 0xb0) = uVar2;
      goto LAB_0003cb20;
    }
  }
  else if ((iVar5 == 0x16) &&
          (iVar5 = sscanf(__s,"%c %3d %2d:%2d:%2d%c%cTZ=%2d",&local_39,iVar6 + 0xb0,iVar6 + 0xb4,iVar6 + 0xb8,
                          iVar6 + 0xbc,local_37 + 2,local_37 + 1,&local_34), iVar5 == 8)) {
    *(undefined4 *)(iVar6 + 0xc0) = 0;
LAB_0003cb20:
    switch(local_38) {
    case 0x20:
      *(undefined4 *)(iVar6 + 0xd0) = *puVar9;
      *(undefined4 *)(iVar6 + 0xd4) = *(undefined4 *)(iVar6 + 0xdc);
      *(undefined4 *)(iVar6 + 0xe8) = 0xd2f1a9fc;
      *(undefined4 *)(iVar6 + 0xec) = 0x3f50624d;
      break;
    default:
      *(undefined4 *)(iVar6 + 0xe8) = 0;
      *(undefined4 *)(iVar6 + 0xec) = 0x40300000;
      FUN_00027040(iVar7,2);
      break;
    case 0x41:
      *(undefined4 *)(iVar6 + 0xe8) = 0x47ae147b;
      *(undefined4 *)(iVar6 + 0xec) = 0x3f847ae1;
      break;
    case 0x42:
      *(undefined4 *)(iVar6 + 0xe8) = 0x9999999a;
      *(undefined4 *)(iVar6 + 0xec) = 0x3fb99999;
      break;
    case 0x43:
      *(undefined4 *)(iVar6 + 0xe8) = 0;
      *(undefined4 *)(iVar6 + 0xec) = 0x3fe00000;
      break;
    case 0x44:
      *(undefined4 *)(iVar6 + 0xe8) = 0;
      *(undefined4 *)(iVar6 + 0xec) = 0x40300000;
    }
    if (local_39 == ' ') {
      *(bool *)(iVar6 + 0x20) = local_37[0] == 'L';
    }
    else {
      *(undefined1 *)(iVar6 + 0x20) = 3;
    }
    iVar5 = FUN_00027578((int)*(undefined8 *)(iVar6 + 0x2e0),iVar6);
    if (iVar5 != 0) {
      return;
    }
    FUN_00027040(iVar7,6);
    return;
  }
  if (*(char *)((int)puVar8 + 0xd) == '\0') {
    FUN_00027040(iVar7,2);
  }
  else {
    *(char *)((int)puVar8 + 0xd) = *(char *)((int)puVar8 + 0xd) + -1;
    FUN_0002ddbc(iVar7 + 0xc,__s);
  }
  return;
}




void FUN_0003cd9c(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  
  iVar1 = *(int *)(param_2 + 0x3c);
  iVar2 = *(int *)(iVar1 + 0x1c);
  if (*(int *)(iVar2 + 0x20) == 0) {
    FUN_00027040(param_2,1,param_3,0,param_4);
  }
  else {
    *(int *)(iVar2 + 0x20) = *(int *)(iVar2 + 0x20) + -1;
  }
  *(int *)(iVar1 + 0x2f8) = *(int *)(iVar1 + 0x2f8) + 1;
  *(undefined1 *)(iVar2 + 0x1e) = 1;
  return;
}




int FUN_0003ce00(undefined4 param_1,int param_2)

{
  int __fd;
  void *__s;
  int iVar1;
  int iVar2;
  char acStack_34 [24];
  
  sprintf(acStack_34,"/dev/zyfer%d",param_1);
  __fd = FUN_00027d18(acStack_34,0xd,0x20);
  if (__fd != 0) {
    FUN_0004fe78(5,"zyfer(%d) fd: %d dev <%s>",param_1,__fd,acStack_34);
    __s = (void *)FUN_0004f524(0x30);
    if (__s == (void *)0x0) {
      close(__fd);
      __fd = 0;
    }
    else {
      memset(__s,0,0x30);
      iVar2 = *(int *)(param_2 + 0x3c);
      *(int *)(iVar2 + 0xc) = param_2;
      *(int *)(iVar2 + 0x14) = __fd;
      *(code **)(iVar2 + 4) = FUN_0003cf18;
      *(undefined4 *)(iVar2 + 0x10) = 0;
      iVar1 = FUN_00015fc4(iVar2);
      if (iVar1 == 0) {
        close(__fd);
        free(__s);
        __fd = 0;
      }
      else {
        *(void **)(iVar2 + 0x1c) = __s;
        __fd = 1;
        *(undefined1 *)(param_2 + 0x47) = 0xec;
        *(char **)(iVar2 + 0x24) = "Zyfer GPStarplus";
        *(undefined4 *)(iVar2 + 0x2ec) = 0x535047;
        *(undefined1 *)((int)__s + 0x1e) = 0;
        *(undefined4 *)((int)__s + 0x20) = 2;
      }
    }
  }
  return __fd;
}




void FUN_0003cf18(int param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int local_24;
  undefined1 auStack_20 [4];
  int local_1c [2];
  
  iVar3 = *(int *)(param_1 + 8);
  iVar2 = *(int *)(iVar3 + 0x3c);
  iVar1 = *(int *)(iVar2 + 0xa8);
  iVar4 = *(int *)(iVar2 + 0x1c);
  if (iVar1 < 0x1d) {
    if (iVar1 != 0) {
      memcpy((void *)(iVar2 + iVar1 + 0x28),(void *)(param_1 + 0x5c),*(size_t *)(param_1 + 0x58));
      iVar1 = *(int *)(iVar2 + 0xa8) + *(int *)(param_1 + 0x58);
      *(int *)(iVar2 + 0xa8) = iVar1;
      *(undefined1 *)(iVar2 + iVar1 + 0x28) = 0;
      goto LAB_0003cf7c;
    }
  }
  else {
    *(undefined4 *)(iVar2 + 0xa8) = 0;
  }
  if (*(char *)(param_1 + 0x5c) != '!') {
    return;
  }
  iVar1 = FUN_00027aac(param_1,iVar2 + 0x28,0x80,iVar2 + 0xd8);
  *(int *)(iVar2 + 0xa8) = iVar1;
LAB_0003cf7c:
  if (iVar1 < 0x1d) {
    return;
  }
  FUN_0002ddbc(iVar3 + 0xc,(char *)(iVar2 + 0x28));
  if (*(int *)(iVar2 + 0xa8) == 0x1d) {
    iVar1 = sscanf((char *)(iVar2 + 0x28),"!TIME,%4d,%3d,%2d,%2d,%2d,%d,%d,%d",iVar2 + 0xac,iVar2 + 0xb0,iVar2 + 0xb4,
                   iVar2 + 0xb8,iVar2 + 0xbc,&local_24,auStack_20,local_1c);
    if (iVar1 != 8) {
      FUN_00027040(iVar3,2);
      return;
    }
    if (local_24 == 2) {
      if (local_1c[0] != 1) {
        *(undefined1 *)(iVar2 + 0x20) = 3;
        return;
      }
      iVar1 = FUN_00027698(iVar2);
      if (iVar1 != 0) {
        *(undefined4 *)(iVar4 + 0x20) = 2;
        if (*(char *)(iVar4 + 0x1e) == '\0') {
          return;
        }
        *(undefined1 *)(iVar4 + 0x1e) = 0;
        FUN_000276a0(iVar3);
        return;
      }
    }
  }
  FUN_00027040(iVar3,6);
  return;
}




void FUN_0003d0d8(int param_1)

{
  int iVar1;
  int iVar2;
  undefined4 local_14 [2];
  
  iVar2 = *(int *)(param_1 + 0x3c);
  local_14[0] = 2;
  iVar1 = *(int *)(iVar2 + 0x1c);
  if (0 < *(int *)(iVar1 + 0x10)) {
    FUN_000276a0();
  }
  if ((*(byte *)(iVar2 + 0x2f0) & 4) == 0) {
    ioctl(*(int *)(iVar2 + 0x14),0x5417,local_14);
    write(*(int *)(iVar2 + 0x14),&DAT_00068cec,4);
  }
  *(undefined4 *)(iVar1 + 4) = 6;
  *(undefined4 *)(iVar1 + 8) = 3;
  return;
}




void FUN_0003d144(int param_1)

{
  byte bVar1;
  ssize_t sVar2;
  size_t sVar3;
  __pid_t _Var4;
  int iVar5;
  int iVar6;
  int iVar7;
  undefined4 *puVar8;
  char *__s;
  char acStack_134 [8];
  char acStack_12c [20];
  char acStack_118 [260];
  
  iVar7 = *(int *)(param_1 + 0x3c);
  puVar8 = *(undefined4 **)(iVar7 + 0x1c);
  bVar1 = *(byte *)(iVar7 + 0x2f0);
  *(byte *)(iVar7 + 0x2f0) = bVar1 & 0xfe;
  if (((&DAT_0007ce04)[puVar8[3]] == 0) && ((bVar1 & 4) == 0)) {
    FUN_0004fe78(3,"acts: no phones");
    return;
  }
  switch(puVar8[1]) {
  case 0:
    if ((bVar1 & 2) != 0) {
      snprintf(acStack_118,0x80,"/var/spool/locks/LCK..cua%d",*puVar8);
      iVar6 = open(acStack_118,0xc1,0x1a4);
      if (iVar6 < 0) {
        FUN_0004fe78(3,"acts: port busy");
        return;
      }
      _Var4 = getpid();
      snprintf(acStack_134,8,"%d\n",_Var4);
      sVar3 = strlen(acStack_134);
      write(iVar6,acStack_134,sVar3);
      close(iVar6);
    }
    if (*(int *)(iVar7 + 0x14) == 0) {
      snprintf(acStack_12c,0x14,"/dev/acts%d",*puVar8);
      iVar6 = FUN_00027d18(acStack_12c,0xd,0xa4);
      if (iVar6 == 0) {
        FUN_0004fe78(3,"acts: open fails");
        return;
      }
      *(int *)(iVar7 + 0x14) = iVar6;
      iVar5 = FUN_00015fc4(iVar7);
      if (iVar5 == 0) {
        FUN_0004fe78(3,"acts: addclock fails");
        close(iVar6);
        *(undefined4 *)(iVar7 + 0x14) = 0;
        return;
      }
    }
    if ((*(byte *)(iVar7 + 0x2f0) & 4) == 0) {
      if (DAT_0007cf4c != 0) {
        printf("acts: setup %s\n",&DAT_00068d88);
      }
      sVar2 = write(*(int *)(iVar7 + 0x14),&DAT_00068d88,0x15);
      if (-1 < sVar2) {
        puVar8[1] = 1;
        puVar8[2] = 3;
        return;
      }
    }
    else {
      sVar2 = write(*(int *)(iVar7 + 0x14),"T",1);
      if (-1 < sVar2) {
        puVar8[1] = 4;
        puVar8[2] = 0x14;
        return;
      }
    }
    FUN_0004fe78(3,"acts: write %m");
    return;
  case 1:
    FUN_0004fe78(3,"acts: no modem");
    break;
  case 2:
    snprintf(acStack_118,0x100,"DIAL #%d %s",puVar8[3],(&DAT_0007ce04)[puVar8[3]]);
    FUN_0001d3d8(0x8b,param_1,acStack_118);
    if (DAT_0007cf4c != 0) {
      puts(acStack_118);
    }
    __s = (char *)(&DAT_0007ce04)[puVar8[3]];
    sVar3 = strlen(__s);
    write(*(int *)(iVar7 + 0x14),__s,sVar3);
    write(*(int *)(iVar7 + 0x14),&DAT_00068d9c,1);
    puVar8[1] = 3;
    puVar8[2] = 0x3c;
    return;
  case 3:
    FUN_0004fe78(3,"acts: no answer");
    break;
  case 4:
    FUN_0004fe78(3,"acts: no messages");
    break;
  case 6:
    if (*(int *)(iVar7 + 0x14) != 0) {
      FUN_00015ff4(iVar7);
      close(*(int *)(iVar7 + 0x14));
      if ((*(byte *)(iVar7 + 0x2f0) & 2) != 0) {
        snprintf(acStack_118,0x80,"/var/spool/locks/LCK..cua%d",*puVar8);
        unlink(acStack_118);
      }
      *(undefined4 *)(iVar7 + 0x14) = 0;
    }
    iVar6 = 0;
    puVar8[2] = 0;
    puVar8[7] = iVar7 + 0x28;
    puVar8[1] = 0;
    if (puVar8[4] == 0) {
      iVar7 = puVar8[3];
      puVar8[3] = iVar7 + 1;
      iVar6 = (&DAT_0007ce04)[iVar7 + 1];
      if (iVar6 != 0) {
        puVar8[2] = 3;
        goto LAB_0003d20c;
      }
    }
    puVar8[3] = iVar6;
LAB_0003d20c:
    puVar8[4] = 0;
    return;
  }
  FUN_0003d0d8(param_1);
  return;
}




undefined4 FUN_0003d53c(undefined4 param_1,int param_2)

{
  undefined4 *__s;
  int iVar1;
  
  __s = (undefined4 *)FUN_0004f524(0x20);
  memset(__s,0,0x20);
  iVar1 = *(int *)(param_2 + 0x3c);
  *__s = param_1;
  *(code **)(iVar1 + 4) = FUN_0003d5c0;
  *(undefined4 **)(iVar1 + 0x1c) = __s;
  *(undefined4 *)(iVar1 + 0x10) = 0;
  *(int *)(iVar1 + 0xc) = param_2;
  *(undefined1 *)(param_2 + 0x47) = 0xf6;
  *(undefined4 *)(iVar1 + 0x2ec) = 0x454e4f4e;
  *(char **)(iVar1 + 0x24) = "Automated Computer Time Service";
  *(undefined1 *)(param_2 + 0x42) = 9;
  __s[7] = iVar1 + 0x28;
  return 1;
}




void FUN_0003d5c0(int param_1)

{
  undefined4 uVar1;
  ushort **ppuVar2;
  size_t sVar3;
  undefined4 uVar4;
  undefined4 *puVar5;
  char cVar6;
  undefined1 *puVar7;
  undefined4 *puVar8;
  byte *__buf;
  int iVar9;
  uint uVar10;
  char *__s;
  int iVar11;
  undefined1 *puVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  char local_1f2;
  char local_1f1;
  undefined1 uStack_1f0;
  char local_1ef;
  undefined1 uStack_1ee;
  char local_1ed;
  undefined4 local_1ec;
  undefined4 local_1e8;
  undefined4 local_1e4;
  int local_1e0;
  undefined1 auStack_1dc [4];
  undefined1 auStack_1d8 [4];
  int local_1d4;
  undefined1 auStack_1d0 [4];
  int local_1cc;
  undefined1 auStack_1c8 [8];
  undefined1 auStack_1c0 [12];
  undefined1 auStack_1b4 [12];
  byte local_1a8 [128];
  char local_128;
  char local_127;
  char local_126;
  
  iVar15 = *(int *)(param_1 + 8);
  iVar14 = *(int *)(iVar15 + 0x3c);
  puVar5 = (undefined4 *)(iVar14 + 0xd8);
  iVar9 = *(int *)(iVar14 + 0x1c);
  puVar12 = (undefined1 *)(iVar14 + 0x28);
  uVar1 = FUN_00027824(param_1,local_1a8,puVar12 + (0x80 - *(int *)(iVar9 + 0x1c)),puVar5);
  uVar10 = (uint)local_1a8[0];
  *(undefined4 *)(iVar14 + 0xa8) = uVar1;
  if (uVar10 != 0) {
    __buf = local_1a8;
    do {
      while (uVar10 == 10) {
        if (puVar12 == *(undefined1 **)(iVar9 + 0x1c)) {
          uVar1 = *(undefined4 *)(iVar14 + 0xdc);
          *(undefined4 *)(iVar9 + 0x14) = *puVar5;
          *(undefined4 *)(iVar9 + 0x18) = uVar1;
          goto LAB_0003d644;
        }
        **(undefined1 **)(iVar9 + 0x1c) = 0;
        iVar11 = *(int *)(iVar15 + 0x3c);
        __s = (char *)(iVar11 + 0x28);
        local_1ec = 2;
        iVar13 = *(int *)(iVar11 + 0x1c);
        ioctl(*(int *)(iVar11 + 0x14),0x5415,&local_1e8);
        sVar3 = strlen(__s);
        snprintf(&local_128,0x100,"acts: %04x (%d %d) %lu %s",local_1e8,*(undefined4 *)(iVar13 + 4),
                 *(undefined4 *)(iVar13 + 8),sVar3,__s);
        if (DAT_0007cf4c != 0) {
          puts(&local_128);
        }
        strncpy(&local_128,__s,0x100);
        strtok(&local_128," ");
        if (((local_128 == 'N') && (local_127 == 'O')) && (local_126 == '\0')) {
          FUN_0001d3d8(0x8b,iVar15,__s);
          goto switchD_0003d74c_caseD_2;
        }
        switch(*(undefined4 *)(iVar13 + 4)) {
        case 1:
          if (((local_128 == 'O') && (local_127 == 'K')) && (local_126 == '\0')) {
            ioctl(*(int *)(iVar11 + 0x14),0x5416,&local_1ec);
            *(undefined1 **)(iVar9 + 0x1c) = puVar12;
            *(undefined4 *)(iVar13 + 4) = 2;
            *(undefined4 *)(iVar13 + 8) = 1;
          }
          else {
            FUN_0004fe78(3,"acts: setup error %s",__s);
            FUN_0003d0d8(iVar15);
            *(undefined1 **)(iVar9 + 0x1c) = puVar12;
          }
          break;
        case 3:
          FUN_0001d3d8(0x8b,iVar15,__s);
          iVar11 = strcmp(&local_128,"CONNECT");
          if (iVar11 == 0) {
            *(undefined1 **)(iVar9 + 0x1c) = puVar12;
            *(undefined4 *)(iVar13 + 4) = 4;
            *(undefined4 *)(iVar13 + 8) = 0x14;
          }
          else {
            FUN_0003d0d8(iVar15);
            *(undefined1 **)(iVar9 + 0x1c) = puVar12;
          }
          break;
        case 4:
        case 5:
          iVar13 = *(int *)(iVar15 + 0x3c);
          *(undefined4 *)(iVar13 + 0xc0) = 0;
          sVar3 = strlen(__s);
          iVar16 = *(int *)(iVar13 + 0x1c);
          if (sVar3 == 0x16) {
            iVar11 = sscanf(__s,"%c %3d %2d:%2d:%2d %cTZ=%2d",&local_1f1,iVar13 + 0xb0,iVar13 + 0xb4,iVar13 + 0xb8,
                            iVar13 + 0xbc,&uStack_1ee,auStack_1d0);
            if (iVar11 != 7) goto LAB_0003d850;
            *(undefined1 *)(iVar13 + 0x20) = 0;
            cVar6 = local_1f1;
            if (local_1f1 != ' ') {
              cVar6 = '\x03';
            }
            *(undefined4 *)(iVar13 + 0x2ec) = 0x42565757;
            if (local_1f1 != ' ') {
              *(char *)(iVar13 + 0x20) = cVar6;
            }
            iVar11 = *(int *)(iVar16 + 0x10);
joined_r0x0003da24:
            if (iVar11 == 0) {
              FUN_0002ddbc(iVar15 + 0xc,__s);
              iVar11 = *(int *)(iVar16 + 0x10);
            }
LAB_0003dbe0:
            *(int *)(iVar16 + 0x10) = iVar11 + 1;
LAB_0003dbe8:
            uVar1 = *(undefined4 *)(iVar16 + 0x14);
            uVar4 = *(undefined4 *)(iVar16 + 0x18);
            *(undefined4 *)(iVar15 + 0x58) = *(undefined4 *)(iVar13 + 0x2ec);
            *(undefined4 *)(iVar13 + 0xd8) = uVar1;
            *(undefined4 *)(iVar13 + 0xdc) = uVar4;
            iVar11 = FUN_00027698(iVar13);
            if (iVar11 == 0) {
              FUN_00027040(iVar15,6);
            }
            else {
              iVar11 = *(int *)(iVar16 + 4);
              *(undefined4 *)(iVar13 + 0xd0) = *(undefined4 *)(iVar13 + 0xd8);
              *(undefined4 *)(iVar13 + 0xd4) = *(undefined4 *)(iVar13 + 0xdc);
              if (iVar11 != 5) {
                *(undefined4 *)(iVar16 + 4) = 5;
                *(undefined4 *)(iVar16 + 8) = 0x1e;
              }
            }
          }
          else {
            if (0x16 < sVar3) {
              if (sVar3 == 0x32) {
                iVar11 = sscanf(__s,"%5ld %2d-%2d-%2d %2d:%2d:%2d %2d %1d %3lf %5lf %9s %c",auStack_1dc,iVar13 + 0xac,
                                &local_1e0,&local_1e4,iVar13 + 0xb4,iVar13 + 0xb8,iVar13 + 0xbc,auStack_1d8,&local_1d4,
                                auStack_1c8,auStack_1c0,auStack_1b4,&local_1f2);
                if (iVar11 == 0xd) {
                  if (local_1f2 == '#') {
                    uVar1 = FUN_000513cc(*(undefined4 *)(iVar13 + 0xac),local_1e0,local_1e4);
                    *(undefined1 *)(iVar13 + 0x20) = 0;
                    if (local_1d4 == 1) {
                      *(undefined1 *)(iVar13 + 0x20) = 1;
                    }
                    puVar8 = &DAT_00068e7c;
                    *(undefined4 *)(iVar13 + 0xb0) = uVar1;
LAB_0003dbcc:
                    *(undefined4 *)(iVar13 + 0x2ec) = *puVar8;
                    iVar11 = *(int *)(iVar16 + 0x10);
                    goto joined_r0x0003da24;
                  }
                  goto switchD_0003d74c_caseD_2;
                }
              }
              else if (sVar3 == 0x4e) {
                iVar11 = sscanf(__s,"%*4d-%*2d-%*2d %*2d:%*2d:%2d %*5c%*12c%4d%2d%2d%2d%2d%5ld%2lf%c%2d%3lf%*15c%c",
                                iVar13 + 0xbc,iVar13 + 0xac,&local_1e0,&local_1e4,iVar13 + 0xb4,iVar13 + 0xb8,
                                auStack_1dc,auStack_1c8,&local_1ed,&local_1cc,auStack_1c0,&local_1f2);
                if (iVar11 == 0xc) {
                  *(undefined1 *)(iVar13 + 0x20) = 0;
                  if (local_1e0 == local_1cc) {
                    if (local_1ed == '+') {
                      *(undefined1 *)(iVar13 + 0x20) = 1;
                    }
                    else if (local_1ed == '-') {
                      *(undefined1 *)(iVar13 + 0x20) = 2;
                    }
                  }
                  uVar1 = FUN_000513cc(*(undefined4 *)(iVar13 + 0xac),local_1e0,local_1e4);
                  *(undefined4 *)(iVar13 + 0xb0) = uVar1;
                  *(undefined4 *)(iVar13 + 0x2ec) = 0x425450;
                  iVar11 = *(int *)(iVar16 + 0x10);
                  if (iVar11 == 0) {
                    FUN_0002ddbc(iVar15 + 0xc,__s);
                    iVar11 = *(int *)(iVar16 + 0x10);
                  }
                  goto LAB_0003dbe0;
                }
              }
              else {
                if (sVar3 != 0x18) goto switchD_0003d74c_caseD_2;
                iVar11 = sscanf(__s,"%c%c%2d %3d %2d:%2d:%2d.%3ld%c%c%c",&local_1f1,&uStack_1f0,iVar13 + 0xac,
                                iVar13 + 0xb0,iVar13 + 0xb4,iVar13 + 0xb8,iVar13 + 0xbc,iVar13 + 0xc0,&uStack_1ee,
                                &local_1ef,&uStack_1ee);
                if (iVar11 == 0xb) {
                  *(undefined1 *)(iVar13 + 0x20) = 0;
                  *(int *)(iVar13 + 0xc0) = *(int *)(iVar13 + 0xc0) * 1000000;
                  if (local_1f1 == ' ') {
                    if (local_1ef == 'L') {
                      *(undefined1 *)(iVar13 + 0x20) = 1;
                    }
                  }
                  else {
                    *(undefined1 *)(iVar13 + 0x20) = 3;
                  }
                  puVar8 = &DAT_0006887c;
                  goto LAB_0003dbcc;
                }
              }
LAB_0003d850:
              FUN_00027040(iVar15,2);
              *(undefined1 **)(iVar9 + 0x1c) = puVar12;
              break;
            }
            if (sVar3 == 1) {
              if ((*(char *)(iVar11 + 0x28) == '*') && (0 < *(int *)(iVar16 + 0x10))) goto LAB_0003dbe8;
            }
            else if (sVar3 == 0x14) {
              iVar11 = sscanf(__s,"%5ld %3d %2d%2d%2d %3s",auStack_1dc,iVar13 + 0xb0,iVar13 + 0xb4,iVar13 + 0xb8,
                              iVar13 + 0xbc,auStack_1b4);
              if (iVar11 != 6) goto LAB_0003d850;
              *(undefined1 *)(iVar13 + 0x20) = 0;
              *(undefined4 *)(iVar13 + 0x2ec) = 0x4f4e5355;
              iVar11 = *(int *)(iVar16 + 0x10);
              if (iVar11 == 0) {
                FUN_0002ddbc(iVar15 + 0xc,__s);
                iVar11 = *(int *)(iVar16 + 0x10);
              }
              *(int *)(iVar16 + 0x10) = iVar11 + 1;
            }
          }
        default:
switchD_0003d74c_caseD_2:
          *(undefined1 **)(iVar9 + 0x1c) = puVar12;
        }
        __buf = __buf + 1;
        uVar10 = (uint)*__buf;
        if (uVar10 == 0) {
          return;
        }
      }
      ppuVar2 = __ctype_b_loc();
      if (((*ppuVar2)[uVar10] & 2) == 0) {
        puVar7 = *(undefined1 **)(iVar9 + 0x1c);
        *puVar7 = (char)uVar10;
        *(undefined1 **)(iVar9 + 0x1c) = puVar7 + 1;
        if (*__buf == 0x2a || *__buf == 0x23) {
          uVar1 = *(undefined4 *)(iVar14 + 0xdc);
          *(undefined4 *)(iVar9 + 0x14) = *puVar5;
          *(undefined4 *)(iVar9 + 0x18) = uVar1;
          write(*(int *)(iVar14 + 0x14),__buf,1);
        }
      }
LAB_0003d644:
      __buf = __buf + 1;
      uVar10 = (uint)*__buf;
    } while (uVar10 != 0);
  }
  return;
}




void FUN_0003dd0c(undefined4 param_1,int param_2)

{
  int __fd;
  ssize_t sVar1;
  int iVar2;
  
  iVar2 = *(int *)(param_2 + 0x3c);
  __fd = *(int *)(iVar2 + 0x14);
  *(int *)(iVar2 + 0x2f8) = *(int *)(iVar2 + 0x2f8) + 1;
  *(undefined4 *)(*(int *)(iVar2 + 0x1c) + 8) = 0;
  sVar1 = write(__fd,&DAT_00068f34,2);
  if (sVar1 != 2) {
    FUN_00027040(param_2,3);
  }
  if (*(int *)(iVar2 + 200) != *(int *)(iVar2 + 0xcc)) {
    FUN_000276a0(param_2);
    FUN_0002ddbc(param_2 + 0xc,iVar2 + 0x28);
    if (DAT_0007cf4c == 0) {
      return;
    }
    printf("arbiter: timecode %d %s\n",*(undefined4 *)(iVar2 + 0xa8),iVar2 + 0x28);
    return;
  }
  FUN_00027040(param_2,1);
  return;
}




undefined4 FUN_0003ddec(undefined4 param_1,int param_2)

{
  int __fd;
  void *__s;
  int iVar1;
  undefined *__buf;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  char acStack_34 [24];
  
  snprintf(acStack_34,0x14,"/dev/gps%d",param_1);
  __fd = FUN_00027d18(acStack_34,0xd,1);
  if (__fd == 0) {
    uVar4 = 0;
  }
  else {
    uVar4 = 0;
    __s = (void *)FUN_0004f524(0x88);
    memset(__s,0,0x88);
    iVar3 = *(int *)(param_2 + 0x3c);
    *(int *)(iVar3 + 0xc) = param_2;
    *(int *)(iVar3 + 0x14) = __fd;
    *(code **)(iVar3 + 4) = FUN_0003df58;
    *(undefined4 *)(iVar3 + 0x10) = 0;
    iVar1 = FUN_00015fc4(iVar3);
    if (iVar1 == 0) {
      close(__fd);
      *(undefined4 *)(iVar3 + 0x14) = 0xffffffff;
      free(__s);
      uVar4 = 0;
    }
    else {
      *(void **)(iVar3 + 0x1c) = __s;
      *(undefined1 *)(param_2 + 0x47) = 0xec;
      *(char **)(iVar3 + 0x24) = "Arbiter 1088A/B GPS Receiver";
      *(undefined4 *)(iVar3 + 0x2ec) = 0x20535047;
      uVar2 = (uint)*(byte *)(param_2 + 0x3b);
      if (uVar2 < 2) {
        if (DAT_0007cf4c != 0) {
          printf("arbiter: mode = %d.\n",uVar2);
          uVar2 = (uint)*(byte *)(param_2 + 0x3b);
        }
        __buf = &DAT_00068f58;
        if ((uVar2 & 1) != 0) {
          __buf = &DAT_00068f54;
        }
        write(*(int *)(iVar3 + 0x14),__buf,2);
        uVar4 = 1;
      }
      else {
        FUN_0004fe78(5,"ARBITER: Invalid mode %d");
        close(__fd);
        *(undefined4 *)(iVar3 + 0x14) = 0xffffffff;
        free(__s);
      }
    }
  }
  return uVar4;
}




void FUN_0003df58(int param_1)

{
  byte bVar1;
  int iVar2;
  size_t sVar3;
  undefined4 uVar4;
  undefined *puVar5;
  undefined1 uVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  undefined4 *puVar10;
  char *pcVar11;
  char *__dest;
  char local_b1;
  undefined4 local_b0;
  undefined4 uStack_ac;
  char acStack_a8 [2];
  char local_a6 [130];
  
  iVar9 = *(int *)(param_1 + 8);
  iVar8 = *(int *)(iVar9 + 0x3c);
  puVar10 = *(undefined4 **)(iVar8 + 0x1c);
  iVar2 = FUN_00027aac(param_1,acStack_a8,0x80,&local_b0);
  if (iVar2 == 0) {
    return;
  }
  uVar4 = puVar10[1];
  *(undefined4 *)(iVar8 + 0xd8) = *puVar10;
  *(undefined4 *)(iVar8 + 0xdc) = uVar4;
  *puVar10 = local_b0;
  puVar10[1] = uStack_ac;
  if (iVar2 < 3) {
    return;
  }
  iVar7 = puVar10[2];
  if (iVar7 == 0) {
    iVar7 = strncmp(acStack_a8,"TQ",2);
    if (iVar7 == 0) {
      *(char *)(puVar10 + 3) = local_a6[0];
      write(*(int *)(iVar8 + 0x14),&DAT_00068fc0,2);
      return;
    }
    iVar7 = strncmp(acStack_a8,"SR",2);
    if (iVar7 == 0) {
      strcpy((char *)((int)puVar10 + 0xd),local_a6);
      if ((*(byte *)(iVar8 + 0x2f0) & 8) == 0) {
        puVar5 = &DAT_00068fbc;
        if ((*(byte *)(iVar9 + 0x3b) & 1) != 0) {
          puVar5 = &DAT_00068fb8;
        }
        write(*(int *)(iVar8 + 0x14),puVar5,2);
        return;
      }
      write(*(int *)(iVar8 + 0x14),&DAT_00068fc4,2);
      return;
    }
    iVar7 = strncmp(acStack_a8,"LA",2);
    if (iVar7 == 0) {
      strcpy((char *)((int)puVar10 + 0x35),local_a6);
      write(*(int *)(iVar8 + 0x14),&DAT_00068fc8,2);
      return;
    }
    iVar7 = strncmp(acStack_a8,"LO",2);
    if (iVar7 == 0) {
      sVar3 = strlen((char *)((int)puVar10 + 0x35));
      *(undefined2 *)((int)puVar10 + sVar3 + 0x35) = 0x20;
      strcat((char *)((int)puVar10 + 0x35),local_a6);
      write(*(int *)(iVar8 + 0x14),&DAT_00068fcc,2);
      return;
    }
    iVar7 = strncmp(acStack_a8,"LH",2);
    if (iVar7 == 0) {
      sVar3 = strlen((char *)((int)puVar10 + 0x35));
      *(undefined2 *)((int)puVar10 + sVar3 + 0x35) = 0x20;
      strcat((char *)((int)puVar10 + 0x35),local_a6);
      write(*(int *)(iVar8 + 0x14),&DAT_00068fd0,2);
      return;
    }
    iVar7 = strncmp(acStack_a8,"DB",2);
    if (iVar7 != 0) {
      puVar10[2] = 1;
      return;
    }
    pcVar11 = (char *)((int)puVar10 + 0x35);
    sVar3 = strlen(pcVar11);
    *(undefined2 *)((int)puVar10 + sVar3 + 0x35) = 0x20;
    strcat(pcVar11,local_a6);
    FUN_0002ddbc(iVar9 + 0xc,pcVar11);
    if (DAT_0007cf4c != 0) {
      printf("arbiter: %s\n",pcVar11);
    }
    puVar5 = &DAT_00068fbc;
    if ((*(byte *)(iVar9 + 0x3b) & 1) != 0) {
      puVar5 = &DAT_00068fb8;
    }
    write(*(int *)(iVar8 + 0x14),puVar5,2);
    iVar7 = puVar10[2];
  }
  puVar10[2] = iVar7 + 1;
  if (iVar7 + 1 < 2) {
    return;
  }
  if (iVar2 < 0x18) {
    return;
  }
  __dest = (char *)(iVar8 + 0x28);
  strncpy(__dest,acStack_a8,0x80);
  *(undefined1 *)(iVar8 + 0x3e) = *(undefined1 *)(puVar10 + 3);
  sVar3 = strlen(__dest);
  pcVar11 = stpcpy((char *)(iVar8 + sVar3 + 0x28),(char *)((int)puVar10 + 0xd));
  local_b1 = ' ';
  *(int *)(iVar8 + 0xa8) = (int)pcVar11 - (int)__dest;
  iVar2 = sscanf(__dest,"%c%2d %3d %2d:%2d:%2d",&local_b1,iVar8 + 0xac,iVar8 + 0xb0,iVar8 + 0xb4,iVar8 + 0xb8,
                 iVar8 + 0xbc);
  if (iVar2 != 6) {
    FUN_00027040(iVar9,2);
    bVar1 = *(byte *)(iVar9 + 0x3b);
    goto LAB_0003e164;
  }
  switch(*(undefined1 *)(puVar10 + 3)) {
  case 0x30:
    *(undefined4 *)(iVar8 + 0xd0) = *(undefined4 *)(iVar8 + 0xd8);
    *(undefined4 *)(iVar8 + 0xd4) = *(undefined4 *)(iVar8 + 0xdc);
    *(undefined4 *)(iVar8 + 0xe8) = 0x9abcaf48;
    *(undefined4 *)(iVar8 + 0xec) = 0x3e7ad7f2;
    break;
  default:
    uVar4 = 2;
    goto LAB_0003e278;
  case 0x34:
    *(undefined4 *)(iVar8 + 0xe8) = 0xa0b5ed8d;
    *(undefined4 *)(iVar8 + 0xec) = 0x3eb0c6f7;
    break;
  case 0x35:
    *(undefined4 *)(iVar8 + 0xe8) = 0x88e368f1;
    *(undefined4 *)(iVar8 + 0xec) = 0x3ee4f8b5;
    break;
  case 0x36:
    *(undefined4 *)(iVar8 + 0xe8) = 0xeb1c432d;
    *(undefined4 *)(iVar8 + 0xec) = 0x3f1a36e2;
    break;
  case 0x37:
    *(undefined4 *)(iVar8 + 0xe8) = 0xd2f1a9fc;
    *(undefined4 *)(iVar8 + 0xec) = 0x3f50624d;
    break;
  case 0x38:
    *(undefined4 *)(iVar8 + 0xe8) = 0x47ae147b;
    *(undefined4 *)(iVar8 + 0xec) = 0x3f847ae1;
    break;
  case 0x39:
    *(undefined4 *)(iVar8 + 0xe8) = 0x9999999a;
    *(undefined4 *)(iVar8 + 0xec) = 0x3fb99999;
    break;
  case 0x41:
    *(undefined4 *)(iVar8 + 0xe8) = 0;
    *(undefined4 *)(iVar8 + 0xec) = 0x3ff00000;
    break;
  case 0x42:
    *(undefined4 *)(iVar8 + 0xe8) = 0;
    *(undefined4 *)(iVar8 + 0xec) = 0x40240000;
    break;
  case 0x46:
    uVar4 = 3;
LAB_0003e278:
    *(undefined4 *)(iVar8 + 0xe8) = 0;
    *(undefined4 *)(iVar8 + 0xec) = 0x40300000;
    FUN_00027040(iVar9,uVar4);
    bVar1 = *(byte *)(iVar9 + 0x3b);
    goto LAB_0003e164;
  }
  if (local_b1 == ' ') {
    uVar6 = 0;
  }
  else {
    uVar6 = 3;
  }
  *(undefined1 *)(iVar8 + 0x20) = uVar6;
  iVar2 = FUN_00027698(iVar8);
  if (iVar2 == 0) {
    FUN_00027040(iVar9,6);
  }
  else if (1.5 < *(double *)(iVar9 + 0x1b0)) {
    FUN_000276a0(iVar9);
  }
  bVar1 = *(byte *)(iVar9 + 0x3b);
LAB_0003e164:
  puVar5 = &DAT_00068f58;
  if ((bVar1 & 1) != 0) {
    puVar5 = &DAT_00068f54;
  }
  write(*(int *)(iVar8 + 0x14),puVar5,2);
  return;
}




undefined4 FUN_0003e514(int param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  int __fd;
  void *__ptr;
  byte bVar3;
  int iVar4;
  char acStack_78 [20];
  termios local_64;
  
  FUN_0004fe78(5,"MSF_ARCRON %s: opening unit %d","V1.3 2003/02/21",param_1);
  if (0 < DAT_0007cf4c) {
    printf("arc: %s: attempt to open unit %d.\n","V1.3 2003/02/21",param_1);
  }
  snprintf(acStack_78,0x14,"/dev/arc%d",param_1);
  iVar1 = FUN_00027d18(acStack_78,7,1);
  if (iVar1 < 1) {
    uVar2 = 0;
  }
  else {
    if (0 < DAT_0007cf4c) {
      printf("arc: unit %d using tty_open().\n",param_1);
    }
    __fd = open(acStack_78,0x102,0x1ff);
    if (__fd < 0) {
      FUN_0004fe78(3,"MSF_ARCRON(%d): failed second open(%s, 0777): %m.\n",param_1,acStack_78);
      close(iVar1);
      uVar2 = 0;
    }
    else {
      close(iVar1);
      fcntl(__fd,4,0);
      if (0 < DAT_0007cf4c) {
        printf("arc: opened RS232 port with file descriptor %d.\n",__fd);
      }
      iVar1 = tcgetattr(__fd,&local_64);
      if (iVar1 < 0) {
        FUN_0004fe78(3,"MSF_ARCRON(%d): tcgetattr(%s): %m.\n",param_1,acStack_78);
        close(__fd);
        uVar2 = 0;
      }
      else {
        uVar2 = 0;
        local_64.c_oflag = 0;
        local_64.c_lflag = 0;
        local_64.c_cc[5] = '\0';
        local_64.c_iflag = 0x21;
        local_64.c_cflag = 0x8f7;
        local_64.c_cc[6] = '\x01';
        iVar1 = tcsetattr(__fd,0,&local_64);
        if (iVar1 < 0) {
          FUN_0004fe78(3,"MSF_ARCRON(%d): tcsetattr(%s): %m.\n",param_1,acStack_78);
          close(__fd);
          uVar2 = 0;
        }
        else {
          __ptr = (void *)FUN_0004f478(0,0x28,0,1);
          iVar4 = *(int *)(param_2 + 0x3c);
          *(int *)(iVar4 + 0xc) = param_2;
          *(undefined4 *)(iVar4 + 0x10) = 0;
          *(int *)(iVar4 + 0x14) = __fd;
          *(code **)(iVar4 + 4) = FUN_0003ec20;
          iVar1 = FUN_00015fc4(iVar4);
          if (iVar1 == 0) {
            close(__fd);
            *(undefined4 *)(iVar4 + 0x14) = 0xffffffff;
            free(__ptr);
            uVar2 = 0;
          }
          else {
            *(void **)(iVar4 + 0x1c) = __ptr;
            *(undefined1 *)(param_2 + 0x47) = 0xfc;
            *(undefined1 *)(param_2 + 0x45) = 2;
            *(char **)(iVar4 + 0x24) = "ARCRON MSF/DCF/WWVB Receiver";
            bVar3 = *(byte *)(param_2 + 0x3b);
            if (bVar3 < 4) {
              if (DAT_0007cf4c != 0) {
                printf("arc: mode = %d.\n");
                bVar3 = *(byte *)(param_2 + 0x3b);
              }
              if (bVar3 == 2) {
                *(undefined4 *)(iVar4 + 0x2ec) = 0x464344;
              }
              else if (bVar3 == 3) {
                *(undefined4 *)(iVar4 + 0x2ec) = 0x42565757;
              }
              else if (bVar3 == 1) {
                *(undefined4 *)(iVar4 + 0x2ec) = 0x46534d;
              }
              else {
                *(undefined4 *)(iVar4 + 0x2ec) = 0x6146534d;
              }
              iVar1 = DAT_000cb548;
              uVar2 = 1;
              *(undefined4 *)((int)__ptr + 0xc) = 0xffffffff;
              *(int *)((int)__ptr + 0x14) = iVar1 + 500 + (param_1 * 0x43) % 0x3f1;
              *(int *)(param_2 + 0x20c) = iVar1 + 2;
              *(code **)(param_2 + 0x210) = FUN_0003e86c;
            }
            else {
              FUN_0004fe78(5,"ARCRON: Invalid mode %d",bVar3);
            }
          }
        }
      }
    }
  }
  return uVar2;
}




void FUN_0003e86c(int param_1)

{
  ssize_t sVar1;
  int iVar2;
  int iVar3;
  byte local_19 [5];
  
  iVar3 = *(int *)(param_1 + 0x3c);
  iVar2 = *(int *)(iVar3 + 0x1c);
  if (2 < DAT_0007cf4c) {
    puts("arc: arc_event_handler() called.");
  }
  local_19[0] = *(byte *)(iVar2 + 0x1c);
  *(undefined1 *)(iVar2 + 0x1c) = *(undefined1 *)(iVar2 + 0x1d);
  *(undefined1 *)(iVar2 + 0x1d) = *(undefined1 *)(iVar2 + 0x1e);
  *(undefined1 *)(iVar2 + 0x1e) = *(undefined1 *)(iVar2 + 0x1f);
  *(undefined1 *)(iVar2 + 0x1f) = *(undefined1 *)(iVar2 + 0x20);
  if (local_19[0] != 0) {
    sVar1 = write(*(int *)(iVar3 + 0x14),local_19,1);
    if (sVar1 == 1) {
      if (DAT_0007cf4c != 0) {
        printf("arc: sent `%2.2x\', fd %d.\n",(uint)local_19[0],*(undefined4 *)(iVar3 + 0x14));
      }
    }
    else {
      FUN_0004fe78(5,"ARCRON: write to fd %d failed",*(undefined4 *)(iVar3 + 0x14));
    }
  }
  *(int *)(param_1 + 0x20c) = DAT_000cb548 + 2;
  return;
}




ushort FUN_0003e944(byte *param_1,int *param_2)

{
  ushort uVar1;
  ushort **ppuVar2;
  
  ppuVar2 = __ctype_b_loc();
  uVar1 = (*ppuVar2)[*param_1];
  if ((uVar1 & 0x800) == 0) {
    return uVar1 & 0x800;
  }
  uVar1 = (*ppuVar2)[param_1[1]];
  if ((uVar1 & 0x800) == 0) {
    return uVar1 & 0x800;
  }
  *param_2 = (uint)param_1[1] + (uint)*param_1 * 10 + -0x210;
  return 1;
}




undefined4 FUN_0003e9a8(int param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  size_t sVar1;
  char cVar2;
  char *pcVar3;
  int iVar4;
  char *pcVar5;
  
  sVar1 = strlen(param_2);
  if (*(char *)(param_1 + 0x1f) == '\0') {
    if (*(char *)(param_1 + 0x1e) == '\0') {
      if (*(char *)(param_1 + 0x1d) == '\0') {
        if (*(char *)(param_1 + 0x1c) == '\0') {
          iVar4 = 4;
        }
        else {
          iVar4 = 3;
        }
      }
      else {
        iVar4 = 2;
      }
    }
    else {
      iVar4 = 1;
    }
  }
  else {
    iVar4 = 0;
  }
  if (1 < DAT_0007cf4c) {
    printf("arc: spaceleft = %d.\n",iVar4);
  }
  if ((int)sVar1 <= iVar4) {
    cVar2 = *param_2;
    if ((cVar2 != '\0') && (iVar4 != 0)) {
      pcVar5 = (char *)((param_1 - iVar4) + 0x1f);
      pcVar3 = param_2 + iVar4;
      do {
        pcVar5 = pcVar5 + 1;
        *pcVar5 = cVar2;
        param_2 = param_2 + 1;
        cVar2 = *param_2;
        if (cVar2 == '\0') {
          return 1;
        }
      } while (param_2 != pcVar3);
    }
    return 1;
  }
  FUN_0004fe78(5,"ARCRON: send-buffer overrun (%d/%d)",sVar1,iVar4,param_4);
  return 0;
}




void FUN_0003eaa0(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int extraout_r2;
  int iVar2;
  int iVar3;
  undefined4 uVar4;
  
  iVar3 = *(int *)(param_2 + 0x3c);
  iVar2 = *(int *)(iVar3 + 0x1c);
  if (((*(byte *)(iVar3 + 0x2f0) & 2) == 0) && (*(uint *)(iVar2 + 0x14) <= DAT_000cb548)) {
    *(undefined4 *)(iVar2 + 0x18) = 1;
    iVar1 = DAT_0007cf4c;
    *(undefined4 *)(iVar2 + 0xc) = 0xffffffff;
    if (iVar1 != 0) {
      puts("arc: sending resync command (h\\r).");
    }
    FUN_0004fe78(5,"ARCRON: unit %d: sending resync command",param_1);
    FUN_0003e9a8(iVar2,&DAT_00069308);
    *(uint *)(iVar2 + 0x14) = DAT_000cb548 + 0xd5c;
  }
  if (*(int *)(iVar2 + 0xc) == -1 || 2 < *(int *)(iVar2 + 0xc)) {
    iVar2 = *(int *)(param_2 + 0x3c);
    uVar4 = *(undefined4 *)(iVar2 + 0x1c);
    if (DAT_0007cf4c != 0) {
      printf("arc: unit %d: requesting time.\n",param_1);
    }
    iVar3 = FUN_0003e9a8(uVar4,&DAT_00069350);
    if (iVar3 != 0) {
      *(int *)(iVar2 + 0x2f8) = *(int *)(iVar2 + 0x2f8) + 1;
      return;
    }
    if (DAT_0007cf4c != 0) {
      printf("arc: unit %d: problem sending",param_1);
    }
    *(undefined4 *)(iVar2 + 0xa8) = 0;
    FUN_00027040(param_2,3);
    return;
  }
  iVar2 = DAT_0007cf4c;
  if (DAT_0007cf4c != 0) {
    printf("arc: clock quality %d too poor.\n");
    iVar2 = extraout_r2;
  }
  *(undefined4 *)(iVar3 + 0xa8) = 0;
  FUN_00027040(param_2,3,iVar2,param_4);
  return;
}




/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_0003ec20(int param_1)

{
  byte bVar1;
  byte bVar2;
  ushort **ppuVar3;
  tm *ptVar4;
  undefined4 uVar5;
  undefined1 uVar6;
  int extraout_r1;
  int extraout_r1_00;
  int iVar7;
  uint uVar8;
  char *pcVar9;
  int iVar10;
  int iVar11;
  char *pcVar12;
  char cVar13;
  uint uVar14;
  uint uVar15;
  char *pcVar16;
  undefined *puVar17;
  uint uVar18;
  char *pcVar19;
  uint *puVar20;
  int iVar21;
  int iVar22;
  bool bVar23;
  int local_80;
  time_t local_7c;
  uint local_78;
  uint local_74;
  int local_70;
  uint local_6c;
  undefined4 local_68 [2];
  undefined1 auStack_60 [8];
  byte local_58;
  tm local_54;
  
  iVar21 = *(int *)(param_1 + 8);
  iVar10 = *(int *)(iVar21 + 0x3c);
  puVar20 = *(uint **)(iVar10 + 0x1c);
  if ((((puVar20[6] != 0) && (*(char *)((int)puVar20 + 0x1f) == '\0')) && (*(char *)((int)puVar20 + 0x1e) == '\0')) &&
     ((*(char *)((int)puVar20 + 0x1d) == '\0' && ((char)puVar20[7] == '\0')))) {
    if (1 < DAT_0007cf4c) {
      puts("arc: inserting signal-quality poll.");
    }
    FUN_0003e9a8(puVar20,&DAT_000693f4);
  }
  iVar22 = *(int *)(iVar10 + 0xa8);
  iVar11 = *(int *)(param_1 + 0x58);
  uVar15 = (uint)*(byte *)(param_1 + 0x5c);
  if (*(char *)(iVar10 + 0x28) == 'o') {
    if ((iVar22 != 1) || (uVar15 != 0xd)) {
      iVar7 = iVar22 + iVar11 + -1;
      if (0 < iVar7) {
        local_78 = *(uint *)(param_1 + 0x4c);
        local_74 = *(uint *)(param_1 + 0x50);
        if (DAT_0007cf4c == 0) {
          iVar11 = 0;
          if (0x10 < iVar7) goto LAB_0003edec;
        }
        else {
          if (uVar15 == 0xd) {
            uVar15 = 0x52;
          }
          else {
            ppuVar3 = __ctype_b_loc();
            if (-1 < (short)(*ppuVar3)[uVar15]) {
              uVar15 = 0x3f;
            }
          }
          printf("arc: stamp -->%c<-- (%d chars rcvd)\n",uVar15,iVar11);
          iVar11 = DAT_0007cf4c;
          if (0x10 < iVar7) {
            if (DAT_0007cf4c != 0) {
              printf("arc: input code too long (%d cf %d); rejected.\n",iVar7,0x10);
            }
            goto LAB_0003edec;
          }
        }
        uVar15 = local_78;
        if (*(int *)(&DAT_0006900c + iVar7 * 4) != 0) {
          uVar15 = -*(int *)(&DAT_0006900c + iVar7 * 4);
          uVar18 = (local_74 & 0xffff) + (uVar15 & 0xffff);
          uVar8 = (local_74 >> 0x10) + (uVar15 >> 0x10);
          if ((uVar18 & 0x10000) != 0) {
            uVar8 = uVar8 + 1;
          }
          local_74 = uVar18 & 0xffff | uVar8 << 0x10;
          uVar15 = local_78 - 1;
          if ((uVar8 & 0x10000) != 0) {
            uVar15 = local_78;
          }
        }
        local_78 = uVar15;
        if (1 < iVar11) {
          iVar11 = *(int *)(param_1 + 0x58);
          puVar17 = &DAT_000665cc;
          if (1 < iVar11) {
            puVar17 = &DAT_00069374;
          }
          uVar5 = FUN_0004fad4(0);
          printf("arc: %s%d char(s) rcvd, the last for lastcode[%d]; -%sms offset applied.\n",puVar17,iVar11,iVar7,uVar5
                );
        }
        uVar15 = *puVar20;
        if ((((uVar15 == 0) && (puVar20[1] == 0)) || ((int)local_78 < (int)uVar15)) ||
           ((local_78 == uVar15 && (local_74 <= puVar20[1])))) {
          if ((1 < DAT_0007cf4c) && ((puts("arc: system timestamp captured."), *puVar20 != 0 || (puVar20[1] != 0)))) {
            local_6c = puVar20[1];
            if (local_74 == 0) {
              local_70 = *puVar20 - local_78;
            }
            else {
              uVar15 = (local_6c & 0xffff) + (-local_74 & 0xffff);
              uVar18 = (local_6c >> 0x10) + (-local_74 >> 0x10);
              if ((uVar15 & 0x10000) != 0) {
                uVar18 = uVar18 + 1;
              }
              local_6c = uVar15 & 0xffff | uVar18 << 0x10;
              local_70 = ~local_78 + *puVar20;
              if ((uVar18 & 0x10000) != 0) {
                local_70 = local_70 + 1;
              }
            }
            uVar5 = FUN_0004fad4(local_70,local_6c,3);
            printf("arc: adjusted timestamp by -%sms.\n",uVar5);
          }
          *puVar20 = local_78;
          puVar20[1] = local_74;
        }
        iVar22 = *(int *)(iVar10 + 0xa8);
      }
      goto LAB_0003ecb0;
    }
  }
  else {
LAB_0003ecb0:
    if (0xf < iVar22) {
      if ((DAT_0007cf4c != 0) && (*(char *)(param_1 + 0x5c) != '\r')) {
        puts("arc: rubbish in pp->a_lastcode[].");
      }
      goto LAB_0003ecdc;
    }
    iVar11 = *(int *)(param_1 + 0x58);
  }
  if (iVar11 < 1) {
LAB_0003ed84:
    if (iVar22 == 0) {
      return;
    }
  }
  else {
    iVar11 = 0;
    pcVar16 = (char *)(param_1 + 0x5b);
    do {
      pcVar16 = pcVar16 + 1;
      cVar13 = *pcVar16;
      iVar7 = iVar10 + iVar22;
      iVar22 = iVar22 + 1;
      if (cVar13 == 'h' || cVar13 == '\r') {
        iVar22 = *(int *)(iVar10 + 0xa8);
      }
      else {
        *(int *)(iVar10 + 0xa8) = iVar22;
        *(char *)(iVar7 + 0x28) = cVar13;
      }
      if ((cVar13 == 'o') && (iVar22 == 1)) {
        *puVar20 = 0;
        iVar22 = DAT_0007cf4c;
        puVar20[1] = 0;
        if (1 < iVar22) {
          puts("arc: clearing timestamp.");
        }
        iVar22 = *(int *)(iVar10 + 0xa8);
        if (*(int *)(param_1 + 0x58) <= iVar11 + 1) goto LAB_0003ed84;
      }
      else if (*(int *)(param_1 + 0x58) <= iVar11 + 1) goto LAB_0003ed84;
      iVar11 = iVar11 + 1;
    } while (iVar22 < 0x10);
  }
  uVar15 = DAT_000c9a58;
  if (*(char *)(iVar10 + 0x28) == 'g') {
    if (iVar22 < 3) {
      return;
    }
    uVar8 = (uint)*(byte *)(iVar10 + 0x2a);
    uVar18 = *(byte *)(iVar10 + 0x29) & 0x7f;
    if ((((uVar8 & 0x70) != 0x30) || (uVar14 = uVar8 & 0xf, 5 < uVar14)) || ((*(byte *)(iVar10 + 0x29) & 0x70) != 0x30))
    {
      if (DAT_0007cf4c == 0) {
        return;
      }
      printf("arc: bad `g\' response %2x %2x.\n",uVar18,uVar8 & 0x7f);
      return;
    }
    if (uVar18 == 0x33) {
      if (puVar20[4] < DAT_000cb548) {
        FUN_0004cba8(local_68);
        FUN_0004e8ec(local_68[0],auStack_60);
        DAT_000c9a50 = 0;
        DAT_000c9a54 = 0;
        puVar20[4] = (DAT_000cb548 + 0x41) - (uint)local_58;
      }
      DAT_000c9a54 = DAT_000c9a54 + 1;
      DAT_000c9a50 = uVar14 + DAT_000c9a50;
      DAT_000c9a58 = FUN_0005a928();
      if (DAT_0007cf4c != 0) {
        printf("arc: signal quality %d (%d).\n",DAT_000c9a58,uVar14);
      }
    }
    else if (puVar20[6] != 0) {
      bVar23 = DAT_0007cf4c != 0;
      puVar20[3] = DAT_000c9a58;
      if (bVar23) {
        if (uVar15 == 0xffffffff) {
          pcVar16 = "UNKNOWN, will use clock anyway";
        }
        else {
          pcVar16 = "OK, will use clock";
          if ((int)uVar15 < 3) {
            pcVar16 = "TOO POOR, will not use clock";
          }
        }
        printf("arc: sync finished, signal quality %d: %s\n",uVar15,pcVar16);
        uVar15 = puVar20[3];
      }
      if (uVar15 == 0xffffffff) {
        pcVar16 = "UNKNOWN, will use clock anyway";
      }
      else {
        pcVar16 = "TOO POOR, will not use clock";
        if (2 < (int)uVar15) {
          pcVar16 = "OK, will use clock";
        }
      }
      FUN_0004fe78(5,"ARCRON: sync finished, signal quality %d: %s",uVar15,pcVar16);
      puVar20[6] = 0;
      DAT_000c9a58 = 0;
      DAT_000c9a50 = 0;
      DAT_000c9a54 = 0;
      if ((int)puVar20[3] < 3) {
        puVar20[5] = DAT_000cb548 + 0x654;
      }
    }
LAB_0003ecdc:
    *(undefined4 *)(iVar10 + 0xa8) = 0;
    return;
  }
  if (*(char *)(iVar10 + 0x28) != 'o') goto LAB_0003edec;
  if (iVar22 < 0x10) {
    return;
  }
  if (1 < DAT_0007cf4c) {
    puts("arc: NOW HAVE TIMESTAMP...");
  }
  if ((*puVar20 == 0) && (puVar20[1] == 0)) {
    if (DAT_0007cf4c != 0) {
      puts("arc: FAILED TO GET SYSTEM TIMESTAMP");
    }
    goto LAB_0003edec;
  }
  uVar15 = puVar20[3];
  bVar23 = uVar15 != 0xffffffff;
  if (bVar23) {
    uVar15 = uVar15 + 0x30;
  }
  iVar11 = iVar10 + *(int *)(iVar10 + 0xa8);
  if (bVar23) {
    uVar6 = (undefined1)uVar15;
  }
  else {
    uVar6 = 0x36;
  }
  *(undefined1 *)(iVar11 + 0x28) = uVar6;
  *(undefined1 *)(iVar11 + 0x29) = 0;
  *(undefined4 *)(iVar10 + 0xc0) = 0;
  if ((((*(char *)(iVar10 + 0x28) == 'o') && (iVar11 = FUN_0003e944(iVar10 + 0x29,iVar10 + 0xb4), iVar11 != 0)) &&
      (iVar11 = FUN_0003e944(iVar10 + 0x2b,iVar10 + 0xb8), iVar11 != 0)) &&
     (iVar11 = FUN_0003e944(iVar10 + 0x2d,iVar10 + 0xbc), iVar11 != 0)) {
    ppuVar3 = __ctype_b_loc();
    bVar1 = *(byte *)(iVar10 + 0x2f);
    if (((*ppuVar3)[bVar1] & 0x800) != 0) {
      iVar11 = FUN_0003e944(iVar10 + 0x30,iVar10 + 0xb0);
      iVar22 = bVar1 - 0x30;
      if (((iVar11 != 0) && (iVar11 = FUN_0003e944(iVar10 + 0x32,&local_80), iVar11 != 0)) &&
         (iVar11 = FUN_0003e944(iVar10 + 0x34,iVar10 + 0xac), iVar11 != 0)) {
        bVar1 = *(byte *)(iVar10 + 0x36);
        uVar15 = (uint)bVar1;
        bVar2 = *(byte *)(iVar10 + 0x37);
        uVar18 = (uint)bVar2;
        if (DAT_0007cf4c != 0) {
          printf("arc: status 0x%.2x flags 0x%.2x\n",uVar15,uVar18);
        }
        if ((((0x17 < *(uint *)(iVar10 + 0xb4)) || (*(int *)(iVar10 + 0xb8) < 0)) ||
            ((((0x3b < *(int *)(iVar10 + 0xb8) ||
               (((*(int *)(iVar10 + 0xbc) < 0 || (0x3c < *(int *)(iVar10 + 0xbc))) || (iVar22 < 1)))) ||
              ((7 < iVar22 || (*(int *)(iVar10 + 0xb0) < 1)))) || (0x1f < *(int *)(iVar10 + 0xb0))))) ||
           (((local_80 < 1 || (0xc < local_80)) || ((iVar11 = *(int *)(iVar10 + 0xac), iVar11 < 0 || (99 < iVar11))))))
        goto LAB_0003edec;
        if ((*(char *)(iVar21 + 0x3b) == '\0') && (((uVar15 ^ 4) << 0x1d) >> 0x1f != (uVar15 << 0x1e) >> 0x1f)) {
          *(undefined4 *)(iVar10 + 0xa8) = 0;
          FUN_00027040(iVar21,2);
          return;
        }
        if ((bVar2 & 8) != 0) {
          FUN_0004fe78(5,"ARCRON: battery low");
          iVar11 = *(int *)(iVar10 + 0xac);
        }
        if (iVar11 < 0x62) {
          iVar11 = iVar11 + 100;
          *(int *)(iVar10 + 0xac) = iVar11;
        }
        *(int *)(iVar10 + 0xac) = iVar11 + 0x76c;
        if (0x82f < iVar11 + 0x76c) {
          FUN_0004fe78(5,"ARCRON: fix me!  EITHER YOUR DATE IS BADLY WRONG or else I will break soon!");
        }
        if (DAT_0007cf4c != 0) {
          printf("arc: n=%d %02d:%02d:%02d %02d/%02d/%04d %1d %1d\n",9,*(undefined4 *)(iVar10 + 0xb4),
                 *(undefined4 *)(iVar10 + 0xb8),*(undefined4 *)(iVar10 + 0xbc),*(undefined4 *)(iVar10 + 0xb0),local_80,
                 *(undefined4 *)(iVar10 + 0xac),uVar15,uVar18);
        }
        uVar18 = uVar18 & 7;
        *(undefined1 *)(iVar10 + 0x20) = 0;
        if (uVar18 == 3) {
          if (puVar20[2] != 3) {
            FUN_0004fe78(5,"ARCRON: signal acquired");
          }
        }
        else if (puVar20[2] != uVar18) {
          FUN_0004fe78(5,"ARCRON: signal lost");
          *(undefined1 *)(iVar10 + 0x20) = 3;
          puVar20[2] = uVar18;
          *(undefined4 *)(iVar10 + 0xa8) = 0;
          FUN_00027040(iVar21);
          return;
        }
        iVar11 = local_80;
        puVar20[2] = uVar18;
        cVar13 = *(char *)(iVar21 + 0x3b);
        if (cVar13 == '\0') {
          uVar8 = *(uint *)(iVar10 + 0xac);
          iVar22 = *(int *)(iVar10 + 0xb0) + *(int *)(&DAT_0006904c + local_80 * 4);
          *(int *)(iVar10 + 0xb0) = iVar22;
          if (((uVar8 & 3) == 0) &&
             (((FUN_0005aa04(uVar8,100), extraout_r1 != 0 || (FUN_0005aa04(uVar8,400), extraout_r1_00 == 0)) &&
              (2 < iVar11)))) {
            *(int *)(iVar10 + 0xb0) = iVar22 + 1;
          }
          if (((bVar1 & 2) != 0) &&
             (iVar11 = *(int *)(iVar10 + 0xb4) + -1, *(int *)(iVar10 + 0xb4) = iVar11, iVar11 < 0)) {
            *(undefined4 *)(iVar10 + 0xb4) = 0x17;
            iVar11 = *(int *)(iVar10 + 0xb0) + -1;
            *(int *)(iVar10 + 0xb0) = iVar11;
            if (iVar11 < 0) {
              *(undefined4 *)(iVar10 + 0xa8) = 0;
              FUN_00027040(iVar21,6);
              return;
            }
          }
          cVar13 = *(char *)(iVar21 + 0x3b);
          if (cVar13 != '\0') goto LAB_0003f540;
LAB_0003f6c4:
          if (puVar20[3] == 0xffffffff) {
            *(undefined1 *)(iVar21 + 0x47) = 0xfc;
            goto LAB_0003f6ec;
          }
          bVar1 = *(byte *)(iVar10 + 0x2f0);
        }
        else {
LAB_0003f540:
          if ((*(byte *)(iVar10 + 0x2f0) & 1) == 0) {
            uVar5 = FUN_000513cc(*(undefined4 *)(iVar10 + 0xac),local_80,*(undefined4 *)(iVar10 + 0xb0));
            *(undefined4 *)(iVar10 + 0xb0) = uVar5;
          }
          else {
            memset(&local_54,0,0x2c);
            local_54.tm_mday = *(int *)(iVar10 + 0xb0);
            local_54.tm_hour = *(int *)(iVar10 + 0xb4);
            local_54.tm_min = *(int *)(iVar10 + 0xb8);
            local_54.tm_year = *(int *)(iVar10 + 0xac) + -0x76c;
            local_54.tm_sec = *(int *)(iVar10 + 0xbc);
            local_54.tm_mon = local_80 + -1;
            if (cVar13 == '\x02') {
LAB_0003f824:
              local_54.tm_isdst = uVar15 & 2;
            }
            else {
              if (cVar13 != '\x03') {
                if (cVar13 != '\x01') {
                  FUN_0004fe78(5,"ARCRON: Invalid mode %d",cVar13);
                  return;
                }
                goto LAB_0003f824;
              }
              uVar15 = uVar15 & 3;
              if (uVar15 == 2) {
                local_54.tm_isdst = 0xffffffff;
                if (DAT_0007cf4c != 0) {
                  puts("arc: DST = 10 (2)");
                }
              }
              else if (uVar15 == 3) {
                local_54.tm_isdst = 1;
                if (DAT_0007cf4c != 0) {
                  puts("arc: DST = 11 (3)");
                }
              }
              else if (uVar15 == 1) {
                local_54.tm_isdst = 0xffffffff;
                if (DAT_0007cf4c != 0) {
                  puts("arc: DST = 01 (1)");
                }
              }
              else if (DAT_0007cf4c != 0) {
                puts("arc: DST = 00 (0)");
              }
            }
            local_7c = mktime(&local_54);
            ptVar4 = gmtime(&local_7c);
            if (ptVar4 == (tm *)0x0) {
              *(undefined4 *)(iVar10 + 0xa8) = 0;
              FUN_00027040(iVar21,3);
              return;
            }
            local_80 = ptVar4->tm_mon + 1;
            iVar22 = ptVar4->tm_mday;
            iVar11 = ptVar4->tm_year + 0x76c;
            *(int *)(iVar10 + 0xac) = iVar11;
            uVar5 = FUN_000513cc(iVar11,local_80,iVar22);
            iVar11 = ptVar4->tm_hour;
            iVar22 = ptVar4->tm_min;
            bVar23 = DAT_0007cf4c != 0;
            iVar7 = ptVar4->tm_sec;
            *(int *)(iVar10 + 0xb4) = iVar11;
            *(int *)(iVar10 + 0xb8) = iVar22;
            *(int *)(iVar10 + 0xbc) = iVar7;
            *(undefined4 *)(iVar10 + 0xb0) = uVar5;
            if (bVar23) {
              printf("arc: time is %04d/%02d/%02d %02d:%02d:%02d UTC\n",*(undefined4 *)(iVar10 + 0xac),local_80,
                     ptVar4->tm_mday,iVar11,iVar22,iVar7);
            }
          }
          if (((*(char *)(iVar21 + 0x3b) == '\0') || (uVar18 != 3)) ||
             (bVar1 = *(byte *)(iVar10 + 0x2f0), (bVar1 & 2) == 0)) goto LAB_0003f6c4;
        }
        if ((bVar1 & 4) == 0) {
          uVar6 = 0xfc;
        }
        else {
          uVar6 = 0xfb;
        }
        *(undefined1 *)(iVar21 + 0x47) = uVar6;
LAB_0003f6ec:
        bVar1 = *(byte *)(iVar10 + 0x2f0);
        if (puVar20[9] != (uint)bVar1) {
          pcVar12 = ".";
          pcVar16 = "1";
          if ((bVar1 & 1) == 0) {
            pcVar16 = pcVar12;
          }
          pcVar9 = "2";
          if ((bVar1 & 2) == 0) {
            pcVar9 = pcVar12;
          }
          pcVar19 = "3";
          if ((bVar1 & 4) == 0) {
            pcVar19 = pcVar12;
          }
          if ((bVar1 & 8) != 0) {
            pcVar12 = "4";
          }
          FUN_0004fe78(5,"ARCRON: flags enabled: %s%s%s%s",pcVar16,pcVar9,pcVar19,pcVar12);
          if (DAT_0007cf4c != 0) {
            printf("arc: PRECISION = %d.\n",(int)*(char *)(iVar21 + 0x47));
          }
          puVar20[9] = (uint)*(byte *)(iVar10 + 0x2f0);
        }
        uVar15 = puVar20[1];
        *(uint *)(iVar10 + 0xd8) = *puVar20;
        *(uint *)(iVar10 + 0xdc) = uVar15;
        iVar11 = FUN_00027698(iVar10);
        if (iVar11 == 0) {
          *(undefined4 *)(iVar10 + 0xa8) = 0;
          FUN_00027040(iVar21,6);
          return;
        }
        FUN_0002ddbc(iVar21 + 0xc,iVar10 + 0x28);
        FUN_000276a0(iVar21);
        return;
      }
    }
  }
  if (DAT_0007cf4c != 0) {
    puts("arc: badly formatted data.");
  }
LAB_0003edec:
  *(undefined4 *)(iVar10 + 0xa8) = 0;
  FUN_00027040(iVar21,2);
  return;
}




void FUN_0003f8f8(undefined4 param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  ssize_t sVar1;
  int iVar2;
  
  iVar2 = *(int *)(param_2 + 0x3c);
  sVar1 = write(*(int *)(iVar2 + 0x14),"\r*toc\r",6);
  if (sVar1 == 6) {
    *(int *)(iVar2 + 0x2f8) = *(int *)(iVar2 + 0x2f8) + 1;
    if ((*(byte *)(iVar2 + 0x2f0) & 2) == 0) {
      FUN_0004cba8(iVar2 + 0xd8);
    }
  }
  else {
    FUN_00027040(param_2,3);
  }
  if (0 < *(int *)(param_2 + 0x74)) {
    return;
  }
  if (*(int *)(iVar2 + 200) != *(int *)(iVar2 + 0xcc)) {
    FUN_000276a0();
    *(undefined4 *)(param_2 + 0x74) = 5;
    return;
  }
  FUN_00027040(param_2,1,*(int *)(iVar2 + 200),param_4);
  return;
}




int FUN_0003f9bc(undefined4 param_1,int param_2)

{
  int __fd;
  int *__s;
  int iVar1;
  int iVar2;
  char acStack_34 [24];
  
  snprintf(acStack_34,0x14,"/dev/gps%d",param_1);
  __fd = FUN_00027d18(acStack_34,0xd,1);
  if (__fd != 0) {
    __s = (int *)FUN_0004f524(0xd4);
    memset(__s,0,0xd4);
    iVar2 = *(int *)(param_2 + 0x3c);
    *(int *)(iVar2 + 0xc) = param_2;
    *(int *)(iVar2 + 0x14) = __fd;
    *(code **)(iVar2 + 4) = FUN_0003fab0;
    *(undefined4 *)(iVar2 + 0x10) = 0;
    iVar1 = FUN_00015fc4(iVar2);
    if (iVar1 == 0) {
      close(__fd);
      *(undefined4 *)(iVar2 + 0x14) = 0xffffffff;
      free(__s);
      __fd = 0;
    }
    else {
      *(int **)(iVar2 + 0x1c) = __s;
      __fd = 1;
      *(undefined1 *)(param_2 + 0x47) = 0xec;
      *(undefined4 *)(param_2 + 0x74) = 5;
      *(undefined4 *)(iVar2 + 0x2ec) = 0x535047;
      *(char **)(iVar2 + 0x24) = "Austron 2201A GPS Receiver";
      __s[0x34] = 0;
      *__s = (int)(__s + 1);
    }
  }
  return __fd;
}




void FUN_0003fab0(int param_1)

{
  int iVar1;
  undefined1 *puVar2;
  long lVar3;
  size_t sVar4;
  int iVar5;
  int iVar6;
  int *piVar7;
  int *piVar8;
  char *pcVar9;
  int iVar10;
  bool bVar11;
  undefined4 local_28;
  undefined4 uStack_24;
  
  iVar10 = *(int *)(param_1 + 8);
  iVar6 = *(int *)(iVar10 + 0x3c);
  pcVar9 = (char *)(iVar6 + 0x28);
  piVar7 = *(int **)(iVar6 + 0x1c);
  iVar1 = FUN_00027aac(param_1,pcVar9,0x80,&local_28);
  bVar11 = DAT_0007cf4c != 0;
  *(int *)(iVar6 + 0xa8) = iVar1;
  if (bVar11) {
    printf("gps: timecode %d %d %s\n",piVar7[0x33],iVar1,pcVar9);
    iVar1 = *(int *)(iVar6 + 0xa8);
  }
  if (iVar1 != 0) {
    if ((*(byte *)(iVar6 + 0x2f0) & 2) != 0) {
      *(undefined4 *)(iVar6 + 0xd8) = local_28;
      *(undefined4 *)(iVar6 + 0xdc) = uStack_24;
    }
    if (piVar7[0x33] < 1) {
      if (iVar1 == 1) {
        lVar3 = strtol(pcVar9,(char **)0x0,10);
        piVar7[0x33] = lVar3;
      }
      else {
        piVar8 = piVar7 + 1;
        FUN_0002ddbc(iVar10 + 0xc,piVar8);
        if (DAT_0007cf4c != 0) {
          printf("gps: stat %s\n",piVar8);
        }
        *(undefined1 *)(piVar7 + 1) = 0;
        iVar1 = *(int *)(iVar6 + 0xa8);
        *piVar7 = (int)piVar8;
        if ((iVar1 < 0x13) ||
           (iVar1 = sscanf(pcVar9,"%2d:%3d:%2d:%2d:%2d.%3ld",iVar6 + 0xac,iVar6 + 0xb0,iVar6 + 0xb4,iVar6 + 0xb8,
                           iVar6 + 0xbc,iVar6 + 0xc0), iVar1 != 6)) {
          FUN_00027040(iVar10,2);
        }
        else {
          bVar11 = *(char *)(iVar6 + 0x2a) == ':';
          if (bVar11) {
            *(undefined1 *)(iVar6 + 0x20) = 0;
          }
          *(int *)(iVar6 + 0xc0) = *(int *)(iVar6 + 0xc0) * 1000000;
          if (!bVar11) {
            *(undefined1 *)(iVar6 + 0x20) = 3;
          }
          iVar1 = FUN_00027698(iVar6);
          if (iVar1 == 0) {
            FUN_00027040(iVar10,6);
          }
          else {
            strcpy((char *)*piVar7,pcVar9);
            iVar1 = *piVar7;
            iVar10 = *(int *)(iVar6 + 0xa8);
            iVar5 = iVar1 + iVar10;
            *piVar7 = iVar5;
            if ((*(byte *)(iVar6 + 0x2f0) & 8) != 0) {
              *(undefined1 *)(iVar1 + iVar10) = 0x20;
              pcVar9 = (char *)(iVar5 + 1);
              *piVar7 = (int)pcVar9;
              strcpy(pcVar9,&DAT_0007b4e4 + piVar7[0x34] * 0x1e);
              sVar4 = strlen(&DAT_0007b4e4 + piVar7[0x34] * 0x1e);
              iVar1 = *piVar7;
              *piVar7 = iVar1 + sVar4 + -1;
              *(undefined1 *)(iVar1 + sVar4 + -1) = 0;
              iVar1 = piVar7[0x34];
              sVar4 = strlen(&DAT_0007b4e4 + iVar1 * 0x1e);
              write(*(int *)(iVar6 + 0x14),&DAT_0007b4e4 + iVar1 * 0x1e,sVar4);
              iVar1 = piVar7[0x34];
              piVar7[0x34] = iVar1 + 1;
              if ((&DAT_0007b4e4)[(iVar1 + 1) * 0x1e] == '\0') {
                piVar7[0x34] = 0;
              }
            }
          }
        }
      }
    }
    else {
      puVar2 = (undefined1 *)*piVar7;
      piVar7[0x33] = piVar7[0x33] + -1;
      if ((int)(puVar2 + (iVar1 - (int)(piVar7 + 1))) < 199) {
        *puVar2 = 0x20;
        *piVar7 = (int)(puVar2 + 1);
        strcpy(puVar2 + 1,pcVar9);
        *piVar7 = *piVar7 + *(int *)(iVar6 + 0xa8);
      }
    }
  }
  return;
}




int FUN_0003fd7c(undefined4 param_1,int param_2)

{
  int __fd;
  void *__s;
  int iVar1;
  int iVar2;
  char acStack_2c [20];
  
  snprintf(acStack_2c,0x14,"/dev/chronolog%d",param_1);
  if (DAT_0007cf4c != 0) {
    printf("starting Chronolog with device %s\n",acStack_2c);
  }
  __fd = FUN_00027d18(acStack_2c,0xb,0);
  if (__fd != 0) {
    __s = (void *)FUN_0004f524(0x1c);
    memset(__s,0,0x1c);
    iVar2 = *(int *)(param_2 + 0x3c);
    *(void **)(iVar2 + 0x1c) = __s;
    *(int *)(iVar2 + 0xc) = param_2;
    *(int *)(iVar2 + 0x14) = __fd;
    *(code **)(iVar2 + 4) = FUN_0003fe88;
    *(undefined4 *)(iVar2 + 0x10) = 0;
    iVar1 = FUN_00015fc4(iVar2);
    if (iVar1 == 0) {
      close(__fd);
      *(undefined4 *)(iVar2 + 0x14) = 0xffffffff;
      free(__s);
      *(undefined4 *)(iVar2 + 0x1c) = 0;
      __fd = 0;
    }
    else {
      __fd = 1;
      *(undefined1 *)(param_2 + 0x47) = 0xf3;
      *(char **)(iVar2 + 0x24) = "Chrono-log K";
      builtin_strncpy((char *)(iVar2 + 0x2ec),"chro",4);
    }
  }
  return __fd;
}




void FUN_0003fe88(int param_1)

{
  int iVar1;
  tm *ptVar2;
  undefined4 uVar3;
  int iVar4;
  char *pcVar5;
  int iVar6;
  char *__s;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  bool bVar11;
  int local_6c;
  int local_68;
  int local_64;
  time_t local_60;
  undefined4 local_5c;
  undefined4 uStack_58;
  tm local_54;
  
  iVar7 = *(int *)(param_1 + 8);
  iVar6 = *(int *)(iVar7 + 0x3c);
  __s = (char *)(iVar6 + 0x28);
  pcVar5 = *(char **)(iVar6 + 0x1c);
  iVar1 = FUN_00027aac(param_1,__s,0x80,&local_5c);
  if (iVar1 == 0) {
    if (*pcVar5 == '\0') {
      *pcVar5 = '\x01';
      *(undefined4 *)(pcVar5 + 4) = local_5c;
      *(undefined4 *)(pcVar5 + 8) = uStack_58;
    }
    else {
      *pcVar5 = '\0';
    }
  }
  else {
    *(int *)(iVar6 + 0xa8) = iVar1;
    uVar3 = *(undefined4 *)(pcVar5 + 8);
    *(undefined4 *)(iVar6 + 0xd8) = *(undefined4 *)(pcVar5 + 4);
    *(undefined4 *)(iVar6 + 0xdc) = uVar3;
    *pcVar5 = '\x01';
    iVar1 = DAT_0007cf4c;
    *(undefined4 *)(pcVar5 + 4) = local_5c;
    *(undefined4 *)(pcVar5 + 8) = uStack_58;
    if (iVar1 != 0) {
      printf("chronolog: timecode %d %s\n",*(undefined4 *)(iVar6 + 0xa8),__s);
    }
    local_54.tm_wday = sscanf(__s,"Y %d/%d/%d",pcVar5 + 0x10,pcVar5 + 0x18,pcVar5 + 0x14);
    if ((char *)local_54.tm_wday == (char *)0x0) {
      iVar1 = sscanf(__s,"Z %02d:%02d:%02d",&local_6c,&local_68,&local_64);
      if (iVar1 == 3) {
        local_54.tm_year = *(int *)(pcVar5 + 0x10);
        local_54.tm_mday = *(int *)(pcVar5 + 0x14);
        local_54.tm_min = local_68;
        local_54.tm_mon = *(int *)(pcVar5 + 0x18) + -1;
        local_54.tm_hour = local_6c;
        local_54.tm_sec = local_64;
        local_54.tm_isdst = -1;
        local_54.tm_yday = local_54.tm_wday;
        local_54.tm_gmtoff = local_54.tm_wday;
        local_54.tm_zone = (char *)local_54.tm_wday;
        local_60 = mktime(&local_54);
        ptVar2 = gmtime(&local_60);
        if (ptVar2 == (tm *)0x0) {
          FUN_00027040(iVar7,3);
        }
        else {
          iVar4 = ptVar2->tm_mon + 1;
          iVar8 = ptVar2->tm_year + 0x76c;
          uVar3 = FUN_000513cc(iVar8,iVar4,ptVar2->tm_mday);
          iVar1 = ptVar2->tm_hour;
          iVar10 = ptVar2->tm_min;
          bVar11 = DAT_0007cf4c != 0;
          iVar9 = ptVar2->tm_sec;
          *(int *)(iVar6 + 0xb4) = iVar1;
          *(int *)(iVar6 + 0xb8) = iVar10;
          *(int *)(iVar6 + 0xbc) = iVar9;
          *(undefined4 *)(iVar6 + 0xb0) = uVar3;
          if (bVar11) {
            printf("time is %04d/%02d/%02d %02d:%02d:%02d UTC\n",iVar8,iVar4,ptVar2->tm_mday,iVar1,iVar10,iVar9);
          }
          iVar1 = FUN_00027698(iVar6);
          if (iVar1 == 0) {
            FUN_00027040(iVar7,6);
          }
          else {
            *(undefined4 *)(iVar6 + 0xd0) = *(undefined4 *)(iVar6 + 0xd8);
            *(undefined4 *)(iVar6 + 0xd4) = *(undefined4 *)(iVar6 + 0xdc);
            FUN_000276a0(iVar7);
            FUN_0002ddbc(iVar7 + 0xc,__s);
            pcVar5[0xc] = (char)*(undefined4 *)(iVar6 + 0xb4);
          }
        }
      }
    }
    else {
      iVar1 = *(int *)(pcVar5 + 0x10);
      if (iVar1 < 0x45) {
        iVar1 = iVar1 + 100;
      }
      *(int *)(pcVar5 + 0x10) = iVar1;
    }
  }
  return;
}




void FUN_0004010c(int param_1)

{
  uint *puVar1;
  undefined4 *puVar2;
  uint *puVar3;
  char cVar4;
  int iVar5;
  size_t sVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  int iVar10;
  uint uVar11;
  int iVar12;
  uint uVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int *piVar18;
  char *pcVar19;
  int iVar20;
  undefined8 uVar21;
  int local_9c;
  uint local_94;
  uint local_8c;
  uint local_88;
  char local_84 [12];
  char acStack_78 [84];
  
  iVar7 = *(int *)(param_1 + 0x3c);
  iVar15 = *(int *)(iVar7 + 0x1c);
  iVar17 = *(int *)(iVar15 + 0x458);
  if (iVar17 < 9) {
    *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 1;
  }
  else {
    iVar20 = 0;
    iVar10 = 0;
    *(undefined4 *)(iVar15 + 0x460) = 0;
    iVar16 = iVar15;
    do {
      iVar8 = 8;
      iVar5 = 0;
      uVar11 = *(uint *)(iVar16 + 0x43c) ^ *(uint *)(iVar16 + 0x428);
      do {
        uVar13 = uVar11 & 1;
        uVar11 = (int)uVar11 >> 1;
        if (uVar13 == 0) {
          iVar5 = iVar5 + 1;
        }
        else {
          iVar5 = iVar5 + -1;
        }
        iVar8 = iVar8 + -1;
      } while (iVar8 != 0);
      iVar20 = iVar20 + 1;
      iVar10 = iVar10 + iVar5;
      *(int *)(iVar15 + 0x460) = iVar10;
      iVar16 = iVar16 + 4;
    } while ((iVar20 != 5) && (iVar20 != iVar17 + -5));
    if (iVar10 < 0x1c) {
      if (iVar10 + 0x1b < 0 == SCARRY4(iVar10,0x1b)) {
        *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 2;
        return;
      }
      iVar10 = -iVar10;
      uVar21 = *(undefined8 *)(iVar15 + 0x470);
      iVar5 = 0;
      iVar20 = iVar17;
      snprintf(acStack_78,0x50,"chuB %04x %4.0f %2d %2d ",*(uint *)(iVar15 + 0x398),uVar21,iVar17,iVar10);
      uVar11 = 0x50;
      iVar16 = iVar15;
      pcVar19 = acStack_78;
      do {
        sVar6 = strlen(pcVar19);
        if (uVar11 < sVar6 + 1) {
          FUN_0004fe78(3,"chu_b() fatal out buffer");
                    /* WARNING: Subroutine does not return */
          exit(1);
        }
        uVar11 = uVar11 - sVar6;
        pcVar19 = pcVar19 + sVar6;
        puVar2 = (undefined4 *)(iVar16 + 0x428);
        iVar5 = iVar5 + 1;
        iVar16 = iVar16 + 4;
        snprintf(pcVar19,uVar11,"%02x",*puVar2,uVar21,iVar20,iVar10);
      } while (iVar5 != iVar17);
      if ((*(byte *)(iVar7 + 0x2f0) & 8) != 0) {
        FUN_0002ddbc(param_1 + 0xc,acStack_78);
      }
      if (DAT_0007cf4c != 0) {
        puts(acStack_78);
      }
      if (*(int *)(iVar15 + 0x460) + 0x27 < 0 == SCARRY4(*(int *)(iVar15 + 0x460),0x27)) {
        *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 4;
      }
      else {
        pcVar19 = local_84;
        iVar17 = iVar15;
        do {
          puVar3 = (uint *)(iVar17 + 0x428);
          iVar17 = iVar17 + 4;
          cVar4 = "0123456789abcdef_*="[(*puVar3 << 0x18) >> 0x1c];
          *pcVar19 = "0123456789abcdef_*="[*puVar3 & 0xf];
          pcVar19[1] = cVar4;
          pcVar19 = pcVar19 + 2;
        } while (pcVar19 != local_84 + 10);
        iVar7 = sscanf(local_84,"%1x%1d%4d%2d%2x",iVar15 + 0x47c,iVar15 + 0x480,iVar7 + 0xac,iVar15 + 0x484,
                       iVar15 + 0x488);
        if (iVar7 == 5) {
          *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 0x200;
          if ((*(uint *)(iVar15 + 0x47c) & 8) != 0) {
            *(int *)(iVar15 + 0x480) = -*(int *)(iVar15 + 0x480);
          }
        }
        else {
          *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 8;
        }
      }
    }
    else {
      iVar20 = 0;
      uVar11 = *(uint *)(iVar15 + 0x434) & 0xf;
      iVar5 = -1;
      *(undefined4 *)(iVar15 + 0x464) = 0;
      local_9c = 0;
      iVar16 = iVar15;
      while( true ) {
        uVar11 = uVar11 ^ 99;
        iVar12 = 8;
        iVar8 = 0;
        do {
          uVar13 = uVar11 & 1;
          uVar11 = (int)uVar11 >> 1;
          if (uVar13 == 0) {
            iVar8 = iVar8 + 1;
          }
          else {
            iVar8 = iVar8 + -1;
          }
          iVar12 = iVar12 + -1;
        } while (iVar12 != 0);
        uVar13 = iVar5 + 9;
        iVar12 = 0;
        uVar11 = uVar13;
        if ((int)uVar13 < iVar17) {
          uVar11 = *(uint *)(iVar16 + 0x448) & 0xf;
        }
        uVar9 = (*(uint *)(iVar16 + 0x438) & 0xf) << 4;
        if ((int)uVar13 < iVar17) {
          uVar9 = uVar9 | uVar11;
        }
        iVar14 = 8;
        uVar9 = uVar9 ^ 99;
        do {
          uVar11 = uVar9 & 1;
          uVar9 = (int)uVar9 >> 1;
          if (uVar11 == 0) {
            iVar12 = iVar12 + 1;
          }
          else {
            iVar12 = iVar12 + -1;
          }
          iVar14 = iVar14 + -1;
        } while (iVar14 != 0);
        iVar8 = iVar8 + iVar12;
        if (iVar20 < iVar8) {
          local_9c = iVar5;
        }
        iVar5 = iVar5 + 1;
        if (iVar20 < iVar8) {
          *(int *)(iVar15 + 0x464) = iVar8;
          iVar20 = iVar8;
        }
        if (iVar5 == 2) break;
        puVar3 = (uint *)(iVar16 + 0x428);
        puVar1 = (uint *)(iVar16 + 0x438);
        iVar16 = iVar16 + 4;
        uVar11 = (*puVar3 & 0xf) << 4 | *puVar1 & 0xf;
      }
      uVar11 = (uint)(*(int *)(iVar15 + (local_9c + 0x10e) * 4) << 0x18) >> 0x1c;
      if (uVar11 - 2 < 8) {
        if (local_9c + 9 < iVar17) {
          local_94 = (uint)(*(int *)(iVar15 + (local_9c + 0x113) * 4) << 0x18) >> 0x1c;
          if (uVar11 != local_94) {
            local_94 = 0;
          }
        }
        else {
          local_94 = 0;
        }
      }
      else {
        local_94 = 0;
      }
      uVar21 = *(undefined8 *)(iVar15 + 0x470);
      iVar12 = 0;
      uVar13 = 0x50;
      iVar5 = iVar17;
      iVar8 = local_9c;
      uVar11 = local_94;
      snprintf(acStack_78,0x50,"chuA %04x %4.0f %2d %2d %2d %2d %1d ",*(undefined4 *)(iVar15 + 0x398),uVar21,iVar17,
               iVar10,local_9c,iVar20,local_94);
      pcVar19 = acStack_78;
      iVar16 = iVar15;
      do {
        sVar6 = strlen(pcVar19);
        if (uVar13 < sVar6 + 1) {
          FUN_0004fe78(3,"chu_a() fatal out buffer");
                    /* WARNING: Subroutine does not return */
          exit(1);
        }
        uVar13 = uVar13 - sVar6;
        pcVar19 = pcVar19 + sVar6;
        puVar2 = (undefined4 *)(iVar16 + 0x428);
        iVar12 = iVar12 + 1;
        iVar16 = iVar16 + 4;
        snprintf(pcVar19,uVar13,"%02x",*puVar2,uVar21,iVar5,iVar10,iVar8,iVar20,uVar11);
      } while (iVar12 != iVar17);
      if ((*(byte *)(iVar7 + 0x2f0) & 8) != 0) {
        FUN_0002ddbc(param_1 + 0xc,acStack_78);
      }
      if (DAT_0007cf4c != 0) {
        puts(acStack_78);
      }
      if (*(int *)(iVar15 + 0x464) < 8) {
        *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 0x10;
      }
      else {
        if (local_94 == 0) {
          *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 0x20;
        }
        else {
          iVar10 = 0;
          *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 0x100;
          local_88 = 0;
          local_8c = local_94 + 0x1e;
          *(uint *)(iVar7 + 0xbc) = local_8c;
          *(uint *)(iVar15 + 0x390) = local_8c;
          if (local_9c == -1) {
            local_8c = *(uint *)(iVar15 + 0x388);
            local_88 = *(uint *)(iVar15 + 0x38c);
          }
          else {
            iVar10 = local_9c;
            if (local_9c != 0) {
              iVar10 = 1;
            }
          }
          iVar7 = iVar10 * 8;
          iVar16 = 0;
          do {
            iVar12 = *(int *)(iVar15 + 0x454);
            iVar5 = iVar15 + iVar7 + iVar16;
            iVar8 = iVar12 + 0x33;
            iVar20 = *(int *)(iVar5 + 0x140);
            iVar5 = *(int *)(iVar5 + 0x144);
            piVar18 = (int *)(iVar15 + iVar8 * 8);
            *piVar18 = iVar20;
            piVar18[1] = iVar5;
            if (local_88 == 0) {
              *(uint *)(iVar15 + iVar8 * 8) = iVar20 - local_8c;
            }
            else {
              uVar13 = (piVar18[1] & 0xffffU) + (-local_88 & 0xffff);
              uVar11 = ((uint)piVar18[1] >> 0x10) + (-local_88 >> 0x10);
              if ((uVar13 & 0x10000) != 0) {
                uVar11 = uVar11 + 1;
              }
              iVar20 = *(int *)(iVar15 + iVar8 * 8);
              *(uint *)(iVar15 + iVar8 * 8 + 4) = uVar13 & 0xffff | uVar11 << 0x10;
              iVar20 = ~local_8c + iVar20;
              if ((uVar11 & 0x10000) != 0) {
                iVar20 = iVar20 + 1;
              }
              *(int *)(iVar15 + iVar8 * 8) = iVar20;
            }
            iVar10 = iVar10 + 1;
            iVar16 = iVar16 + 8;
            uVar11 = (local_88 & 0xffff) + (*(uint *)(iVar15 + 0x38c) & 0xffff);
            uVar13 = (local_88 >> 0x10) + (*(uint *)(iVar15 + 0x38c) >> 0x10);
            local_8c = *(int *)(iVar15 + 0x388) + local_8c;
            if ((uVar11 & 0x10000) != 0) {
              uVar13 = uVar13 + 1;
            }
            if ((uVar13 & 0x10000) != 0) {
              local_8c = local_8c + 1;
            }
            if (iVar12 < 0x3b) {
              *(int *)(iVar15 + 0x454) = iVar12 + 1;
            }
            local_88 = uVar11 & 0xffff | uVar13 << 0x10;
          } while ((iVar10 < iVar17) && (iVar10 <= local_9c + 9));
          uVar11 = *(uint *)(iVar15 + 0x45c);
          if ((int)uVar11 < (int)local_94) {
            iVar7 = 0;
            do {
              iVar16 = 0xf;
              iVar10 = iVar15;
              do {
                iVar16 = iVar16 + -1;
                *(undefined1 *)(iVar10 + 0x9f) = *(undefined1 *)(iVar10 + 0x9e);
                *(undefined1 *)(iVar10 + 0x13f) = *(undefined1 *)(iVar10 + 0x13e);
                iVar10 = iVar10 + -1;
              } while (iVar16 != 0);
              iVar7 = iVar7 + 1;
              *(undefined1 *)(iVar15 + 0x130) = 0;
              *(undefined1 *)(iVar15 + 0x90) = 0;
            } while (iVar7 != local_94 - uVar11);
            *(uint *)(iVar15 + 0x45c) = uVar11 + 1 + ~uVar11 + local_94;
          }
        }
        uVar11 = local_9c * -2;
        uVar13 = uVar11 + iVar17 * 2;
        iVar7 = iVar15;
        do {
          if (uVar11 < 0x13) {
            iVar17 = (*(uint *)(iVar7 + 0x428) & 0xf) + uVar11 * 0x10;
            iVar10 = ((*(uint *)(iVar7 + 0x428) << 0x18) >> 0x1c) + (uVar11 + 1) * 0x10;
            *(char *)(iVar15 + iVar17) = *(char *)(iVar15 + iVar17) + '\x01';
            *(char *)(iVar15 + iVar10) = *(char *)(iVar15 + iVar10) + '\x01';
          }
          uVar11 = uVar11 + 2;
          iVar7 = iVar7 + 4;
        } while (uVar11 != uVar13);
        *(int *)(iVar15 + 0x468) = *(int *)(iVar15 + 0x468) + 1;
      }
    }
    if (*(int *)(param_1 + 0x204) != DAT_000cb548) {
      *(int *)(param_1 + 0x208) = DAT_000cb548 + 10;
    }
  }
  return;
}




void FUN_00040818(int param_1,uint param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  undefined4 *puVar5;
  uint *puVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  double dVar10;
  
  iVar7 = *(int *)(*(int *)(param_1 + 0x3c) + 0x1c);
  puVar6 = (uint *)(iVar7 + 0x378);
  uVar8 = *(uint *)(iVar7 + 0x380);
  uVar2 = *(uint *)(iVar7 + 0x37c);
  if (uVar8 == 0) {
    iVar4 = *(int *)(iVar7 + 900);
    if (iVar4 == 0) {
      uVar8 = *puVar6;
      *(uint *)(iVar7 + 0x380) = uVar8;
      *(undefined4 *)(iVar7 + 900) = *(undefined4 *)(iVar7 + 0x37c);
      goto LAB_00040930;
    }
LAB_00040868:
    uVar1 = (uVar2 & 0xffff) + (-iVar4 & 0xffffU);
    uVar3 = (uVar2 >> 0x10) + ((uint)-iVar4 >> 0x10);
    if ((uVar1 & 0x10000) != 0) {
      uVar3 = uVar3 + 1;
    }
    uVar8 = ~uVar8 + *puVar6;
    uVar2 = uVar1 & 0xffff | uVar3 << 0x10;
    if ((uVar3 & 0x10000) != 0) {
      uVar8 = uVar8 + 1;
    }
    *(uint *)(iVar7 + 0x380) = *puVar6;
    *(undefined4 *)(iVar7 + 900) = *(undefined4 *)(iVar7 + 0x37c);
    if ((int)uVar8 < 0) goto LAB_00040958;
LAB_000408b4:
    dVar10 = (double)(longlong)(int)uVar8 + (double)uVar2 * 2.3283064365386963e-10;
    if (dVar10 <= 0.4033333333333333) goto LAB_000408dc;
LAB_00040994:
    FUN_0004010c(param_1);
  }
  else {
LAB_00040930:
    iVar4 = *(int *)(iVar7 + 900);
    if (iVar4 != 0) goto LAB_00040868;
    uVar8 = *puVar6 - uVar8;
    *(uint *)(iVar7 + 0x380) = *puVar6;
    *(undefined4 *)(iVar7 + 900) = *(undefined4 *)(iVar7 + 0x37c);
    if (-1 < (int)uVar8) goto LAB_000408b4;
LAB_00040958:
    if (uVar2 == 0) {
      uVar8 = -uVar8;
      uVar2 = 0;
    }
    else {
      uVar2 = -uVar2;
      uVar8 = ~uVar8;
    }
    dVar10 = -((double)(longlong)(int)uVar8 + (double)uVar2 * 2.3283064365386963e-10);
    if (0.4033333333333333 < dVar10) goto LAB_00040994;
LAB_000408dc:
    if (dVar10 <= 0.09166666666666667) {
      iVar4 = *(int *)(iVar7 + 0x458);
      if (10 < iVar4) {
        return;
      }
      iVar9 = iVar4 + 1;
      goto LAB_000408f4;
    }
  }
  iVar9 = 1;
  iVar4 = 0;
LAB_000408f4:
  puVar5 = (undefined4 *)(iVar7 + (iVar4 + 0x28) * 8);
  *(int *)(iVar7 + 0x458) = iVar9;
  *(uint *)(iVar7 + (iVar4 + 0x10a) * 4) = param_2 & 0xff;
  *puVar5 = param_3;
  puVar5[1] = param_4;
  return;
}




undefined4 FUN_000409d0(int param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  double *pdVar8;
  undefined4 uVar9;
  double in_d0;
  double dVar10;
  double dVar11;
  double dVar12;
  
  iVar6 = *(int *)(param_1 + 0x3c);
  iVar5 = *(int *)(iVar6 + 0x1c);
  iVar1 = *(int *)(iVar5 + 0x3a4);
  if (iVar1 < 1) {
    uVar9 = 0;
  }
  else {
    iVar4 = 0;
    dVar10 = 0.0;
    iVar2 = iVar5 + *(int *)(iVar5 + 0x3a8) * 0x28;
    iVar7 = *(int *)(iVar2 + 0x3d0);
    *(undefined4 *)(iVar2 + 0x3d4) = 0;
    dVar11 = *(double *)(iVar2 + 0x3c8);
    pdVar8 = (double *)(iVar2 + 0x3b0 + iVar7 * 8);
    dVar12 = *pdVar8;
    *pdVar8 = in_d0;
    *(int *)(iVar2 + 0x3d0) = (iVar7 + 1) % 3;
    *(double *)(iVar2 + 0x3c8) = (dVar11 - dVar12) + in_d0;
    iVar2 = iVar5;
    do {
      dVar11 = *(double *)(iVar2 + 0x3c8);
      uVar3 = *(int *)(iVar2 + 0x3d4) + 1;
      *(uint *)(iVar2 + 0x3d4) = uVar3;
      if (dVar10 < dVar11) {
        uVar3 = *(uint *)(iVar5 + 0x398);
        *(int *)(iVar5 + 0x3a8) = iVar4;
      }
      iVar4 = iVar4 + 1;
      if (dVar10 < dVar11) {
        *(uint *)(iVar5 + 0x398) = uVar3 | 0x800;
        dVar10 = dVar11;
      }
      iVar2 = iVar2 + 0x28;
    } while (iVar4 != 3);
    iVar2 = (*(int *)(iVar5 + 0x3ac) + 1) % 5;
    *(int *)(iVar5 + 0x3ac) = iVar2;
    if ((iVar2 == 0) || (dVar10 == 0.0)) {
      iVar2 = *(int *)(iVar5 + 0x3d4);
      if (0 < iVar2) {
        *(undefined4 *)(iVar5 + 0x3a8) = 0;
      }
      if (iVar2 < 1) {
        iVar2 = 0;
      }
      if (iVar2 < *(int *)(iVar5 + 0x3fc)) {
        *(undefined4 *)(iVar5 + 0x3a8) = 1;
        iVar2 = *(int *)(iVar5 + 0x3fc);
      }
      if (iVar2 < *(int *)(iVar5 + 0x424)) {
        *(undefined4 *)(iVar5 + 0x3a8) = 2;
      }
    }
    uVar9 = FUN_0004f5e8(SUB84(*(double *)(&DAT_000698d0 + *(int *)(iVar5 + 0x3a8) * 8) + 0.001,0),iVar1,
                         *(byte *)(param_1 + 0x3b) & 0x7f);
    snprintf((char *)(iVar5 + 0x39c),5,"CHU%d",*(undefined4 *)(iVar5 + 0x3a8));
    *(undefined4 *)(iVar6 + 0x2ec) = *(undefined4 *)(iVar5 + 0x39c);
    *(undefined4 *)(param_1 + 0x58) = *(undefined4 *)(iVar5 + 0x39c);
    if ((dVar10 == 0.0) && ((*(uint *)(iVar5 + 0x398) & 0x800) != 0)) {
      *(uint *)(iVar5 + 0x398) = *(uint *)(iVar5 + 0x398) & 0xfffff7ff;
      FUN_00027040(param_1,4);
    }
  }
  return uVar9;
}




void FUN_00040bb0(undefined4 param_1,int param_2)

{
  size_t sVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  undefined1 *puVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  undefined4 uVar10;
  undefined1 *puVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  char *pcVar17;
  uint uVar18;
  undefined4 uVar19;
  double dVar20;
  undefined1 auStack_48 [3];
  char cStack_45;
  undefined4 local_44;
  undefined4 local_40;
  char acStack_3c [8];
  
  iVar13 = *(int *)(param_2 + 0x3c);
  iVar12 = *(int *)(iVar13 + 0x1c);
  iVar6 = *(int *)(iVar12 + 0x390) + 1;
  iVar15 = iVar6 % 0x3c;
  *(int *)(iVar12 + 0x390) = iVar15;
  if (iVar15 == 0) {
    pcVar17 = &cStack_45;
    FUN_0004010c(param_2,iVar6 * -0x77777777);
    iVar7 = *(int *)(param_2 + 0x1f8);
    iVar2 = *(int *)(param_2 + 0x3c);
    iVar3 = DAT_000cb548 + 0x1e;
    iVar16 = *(int *)(iVar2 + 0x1c);
    iVar8 = *(int *)(iVar16 + 0x468);
    iVar6 = 0;
    iVar15 = iVar16;
    do {
      iVar14 = 0;
      uVar18 = 0;
      iVar9 = 0;
      do {
        uVar4 = (uint)*(byte *)(iVar15 + iVar9) + (uint)*(byte *)(iVar15 + 0xa0 + iVar9);
        if (uVar18 < uVar4) {
          iVar14 = iVar9;
        }
        iVar9 = iVar9 + 1;
        if (uVar18 < uVar4) {
          uVar18 = uVar4;
        }
      } while (iVar9 != 0x10);
      iVar6 = iVar6 + uVar18;
      uVar4 = 0x10;
      if ((int)uVar18 <= iVar8) {
        uVar4 = *(uint *)(iVar16 + 0x398);
      }
      iVar15 = iVar15 + 0x10;
      if ((int)uVar18 <= iVar8) {
        *(uint *)(iVar16 + 0x398) = uVar4 | 0x40;
      }
      pcVar17 = pcVar17 + 1;
      *pcVar17 = "0123456789abcdef_*="[iVar14];
    } while (pcVar17 != acStack_3c);
    iVar15 = sscanf((char *)&local_44,"%1x%3d%2d%2d",auStack_48,iVar2 + 0xb0,iVar2 + 0xb4,iVar2 + 0xb8);
    dVar20 = (double)(longlong)iVar6;
    if (iVar15 != 4) {
      *(uint *)(iVar16 + 0x398) = *(uint *)(iVar16 + 0x398) | 0x40;
    }
    if (*(int *)(iVar16 + 0x454) < 0x14) {
      *(uint *)(iVar16 + 0x398) = *(uint *)(iVar16 + 0x398) | 0x80;
    }
    uVar4 = *(uint *)(iVar12 + 0x398);
    uVar18 = (uint)((uVar4 & 0x14) != 0);
    if ((uVar4 & 0x28) != 0) {
      uVar18 = uVar18 | 2;
    }
    if ((uVar4 & 0x40) != 0) {
      uVar18 = uVar18 | 4;
    }
    if ((uVar4 & 0x80) != 0) {
      uVar18 = uVar18 | 8;
    }
    if (((uVar4 & 0x200) != 0) && (50.0 <= dVar20)) {
      uVar4 = uVar4 | 0x400;
      *(uint *)(iVar12 + 0x398) = uVar4;
    }
    if ((uVar4 & 0x400) == 0) {
      uVar19 = 0x20;
      *(undefined1 *)(iVar13 + 0x20) = 3;
      uVar10 = 0x3f;
    }
    else if ((*(uint *)(iVar12 + 0x47c) & 2) == 0) {
      if ((*(uint *)(iVar12 + 0x47c) & 4) == 0) {
        *(undefined1 *)(iVar13 + 0x20) = 0;
        uVar19 = 0x20;
      }
      else {
        uVar19 = 0x6c;
        *(undefined1 *)(iVar13 + 0x20) = 2;
      }
      uVar10 = 0x20;
    }
    else {
      uVar19 = 0x4c;
      *(undefined1 *)(iVar13 + 0x20) = 1;
      uVar10 = 0x20;
    }
    pcVar17 = (char *)(iVar13 + 0x28);
    snprintf(pcVar17,0x80,"%c%1X %04d %03d %02d:%02d:%02d %c%x %+d %d %d %s %.0f %d",uVar10,uVar18,
             *(undefined4 *)(iVar13 + 0xac),*(undefined4 *)(iVar13 + 0xb0),*(undefined4 *)(iVar13 + 0xb4),
             *(undefined4 *)(iVar13 + 0xb8),*(undefined4 *)(iVar13 + 0xbc),uVar19,*(undefined4 *)(iVar12 + 0x488),
             *(undefined4 *)(iVar12 + 0x480),(uint)(iVar3 - iVar7) / 0x3c,*(undefined4 *)(iVar12 + 0x478),iVar12 + 0x39c
             ,dVar20,*(undefined4 *)(iVar12 + 0x454));
    sVar1 = strlen(pcVar17);
    *(size_t *)(iVar13 + 0xa8) = sVar1;
    if (((*(uint *)(iVar12 + 0x398) & 0x4c0) == 0x400) && (50.0 < dVar20)) {
      iVar15 = 0;
      iVar6 = FUN_0004efc8(*(undefined4 *)(iVar13 + 0xb0),*(undefined4 *)(iVar13 + 0xb4),*(undefined4 *)(iVar13 + 0xb8),
                           0,0,*(undefined4 *)(iVar12 + 0x198),iVar13 + 0xc4,&local_44);
      if (iVar6 == 0) {
        *(undefined4 *)(iVar12 + 0x394) = 6;
      }
      else {
        local_40 = 0;
        if (0 < *(int *)(iVar12 + 0x454)) {
          do {
            iVar6 = iVar15 + 0x33;
            iVar15 = iVar15 + 1;
            FUN_00027430(SUB84(*(double *)(iVar13 + 0x2d8) + 0.1768,0),iVar13,local_44,local_40,
                         *(undefined4 *)(iVar12 + iVar6 * 8),*(undefined4 *)(iVar12 + iVar6 * 8 + 4));
          } while (iVar15 < *(int *)(iVar12 + 0x454));
        }
        uVar19 = *(undefined4 *)(iVar12 + 0x37c);
        *(undefined4 *)(iVar13 + 0xd0) = *(undefined4 *)(iVar12 + 0x378);
        *(undefined4 *)(iVar13 + 0xd4) = uVar19;
        FUN_000276a0(param_2);
      }
    }
    if (0.0 < dVar20) {
      FUN_0002ddbc(param_2 + 0xc,pcVar17);
    }
    if (DAT_0007cf4c != 0) {
      printf("chu: timecode %d %s\n",*(undefined4 *)(iVar13 + 0xa8),pcVar17);
    }
    FUN_000409d0(SUB84(dVar20,0),param_2);
    iVar6 = 0;
    iVar13 = *(int *)(*(int *)(param_2 + 0x3c) + 0x1c);
    puVar5 = (undefined1 *)(iVar13 + 0xf);
    *(undefined4 *)(iVar13 + 0x45c) = 0;
    *(undefined4 *)(iVar13 + 0x458) = 0;
    *(uint *)(iVar13 + 0x398) = *(uint *)(iVar13 + 0x398) & 0xc00;
    *(undefined4 *)(iVar13 + 0x454) = 0;
    *(undefined4 *)(iVar13 + 0x468) = 0;
    do {
      puVar11 = (undefined1 *)(iVar13 + iVar6 * 0x10 + -1);
      do {
        puVar11 = puVar11 + 1;
        *puVar11 = 0;
      } while (puVar5 != puVar11);
      iVar6 = iVar6 + 1;
      puVar5 = puVar5 + 0x10;
    } while (iVar6 != 0x14);
    if (*(int *)(iVar12 + 0x394) != 0) {
      FUN_00027040(param_2);
    }
    *(undefined4 *)(iVar12 + 0x394) = 0;
  }
  return;
}




undefined4 FUN_00041020(undefined4 param_1,int param_2)

{
  int iVar1;
  void *__s;
  int iVar2;
  int __fd;
  undefined4 uVar3;
  undefined4 uVar4;
  int iVar5;
  double *pdVar6;
  double *pdVar7;
  uint uVar8;
  double dVar9;
  double dVar10;
  char acStack_3c [24];
  
  iVar1 = FUN_0004d29c("/dev/audio",0xf0,param_1);
  if (iVar1 < 1) {
    snprintf(acStack_3c,0x14,"/dev/chu%d",param_1);
    __fd = FUN_00027d18(acStack_3c,7,0x20);
    if (__fd < 1) {
      return 0;
    }
  }
  else {
    __fd = iVar1;
    if (DAT_0007cf4c != 0) {
      FUN_0004dbe8();
    }
  }
  __s = (void *)FUN_0004f524(0x1240);
  memset(__s,0,0x1240);
  iVar5 = *(int *)(param_2 + 0x3c);
  *(void **)(iVar5 + 0x1c) = __s;
  *(int *)(iVar5 + 0xc) = param_2;
  *(int *)(iVar5 + 0x14) = __fd;
  *(code **)(iVar5 + 4) = FUN_000412c4;
  *(undefined4 *)(iVar5 + 0x10) = 0;
  iVar2 = FUN_00015fc4(iVar5);
  if (iVar2 == 0) {
    close(__fd);
    *(undefined4 *)(iVar5 + 0x14) = 0xffffffff;
    free(__s);
    *(undefined4 *)(iVar5 + 0x1c) = 0;
    uVar4 = 0;
  }
  else {
    *(undefined1 *)(param_2 + 0x47) = 0xf6;
    *(char **)(iVar5 + 0x24) = "CHU Audio/Modem Receiver";
    *(undefined4 *)((int)__s + 0x39c) = 0x554843;
    *(undefined4 *)(iVar5 + 0x2ec) = *(undefined4 *)((int)__s + 0x39c);
    *(undefined8 *)((int)__s + 0x890) = 0;
    *(undefined8 *)((int)__s + 0x490) = 0;
    *(undefined4 *)((int)__s + 0x388) = 0;
    *(int *)((int)__s + 0x48c) = iVar1;
    *(undefined4 *)((int)__s + 0x38c) = 0x962fc96;
    *(undefined8 *)((int)__s + 0x498) = 0x3ff0000000000000;
    pdVar6 = (double *)((int)__s + 0x4b0);
    *(undefined4 *)((int)__s + 0x478) = 0x7f;
    pdVar7 = (double *)((int)__s + 0x8b0);
    uVar8 = 3;
    *(undefined8 *)((int)__s + 0x898) = 0xbff0000000000000;
    *(undefined8 *)((int)__s + 0x4a0) = 0x4008000000000000;
    dVar10 = 2.0;
    *(undefined4 *)((int)__s + 0x8a0) = 0;
    *(undefined4 *)((int)__s + 0x8a4) = 0xc0080000;
    *(undefined4 *)((int)__s + 0x4a8) = 0;
    *(undefined4 *)((int)__s + 0x4ac) = 0x40140000;
    *(undefined4 *)((int)__s + 0x8a8) = 0;
    *(undefined4 *)((int)__s + 0x8ac) = 0xc0140000;
    while (uVar8 = uVar8 + 1, uVar8 != 0x80) {
      dVar9 = dVar10 + pdVar6[-1];
      if ((uVar8 & 0xf) == 0) {
        dVar10 = dVar10 + dVar10;
      }
      *pdVar6 = dVar9;
      pdVar6 = pdVar6 + 1;
      *pdVar7 = -dVar9;
      pdVar7 = pdVar7 + 1;
    }
    *(undefined4 *)((int)__s + 0xca0) = 0;
    *(undefined **)((int)__s + 0xca4) = &DAT_00083126;
    if (DAT_0007cf4c < 2) {
      uVar4 = 0;
    }
    else {
      uVar4 = 2;
    }
    if (*(byte *)(param_2 + 0x3b) == 0) {
      iVar1 = *(int *)((int)__s + 0x3a4);
    }
    else {
      if ((*(byte *)(param_2 + 0x3b) & 0x80) == 0) {
        uVar3 = 0xd;
      }
      else {
        uVar3 = 9;
      }
      iVar1 = FUN_0004f708("/dev/icom",uVar3,uVar4);
      *(int *)((int)__s + 0x3a4) = iVar1;
    }
    if (iVar1 < 1) {
      uVar4 = 1;
    }
    else {
      iVar1 = FUN_000409d0(0,param_2);
      if (iVar1 == 0) {
        FUN_0004fe78(5,"icom: autotune enabled");
        uVar4 = 1;
      }
      else {
        FUN_0004fe78(5,"icom: radio not found");
        close(*(int *)((int)__s + 0x3a4));
        uVar4 = 1;
        *(undefined4 *)((int)__s + 0x3a4) = 0;
      }
    }
  }
  return uVar4;
}




/* WARNING: Removing unreachable block (ram,0x00041cc0) */
/* WARNING: Removing unreachable block (ram,0x00041cb4) */

void FUN_000412c4(int param_1)

{
  ulonglong uVar1;
  uint uVar2;
  undefined4 uVar3;
  double *pdVar4;
  undefined4 uVar5;
  uint uVar6;
  uint uVar7;
  uint *puVar8;
  int iVar9;
  int iVar10;
  int iVar11;
  int iVar12;
  int iVar13;
  undefined4 uVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  double dVar18;
  double dVar19;
  double dVar20;
  double dVar21;
  double dVar22;
  double dVar23;
  double dVar24;
  double dVar25;
  double dVar26;
  double dVar27;
  double dVar28;
  double dVar29;
  double dVar30;
  double dVar31;
  double dVar32;
  double dVar33;
  double dVar34;
  double dVar35;
  double dVar36;
  double dVar37;
  double dVar38;
  double dVar39;
  double dVar40;
  double dVar41;
  double dVar42;
  double dVar43;
  double dVar44;
  double dVar45;
  double dVar46;
  double dVar47;
  
  iVar15 = *(int *)(param_1 + 8);
  iVar11 = *(int *)(iVar15 + 0x3c);
  iVar13 = *(int *)(iVar11 + 0x1c);
  if (*(int *)(iVar13 + 0x48c) < 1) {
    FUN_00040818(iVar15,*(undefined1 *)(param_1 + 0x5c),*(undefined4 *)(param_1 + 0x4c),*(undefined4 *)(param_1 + 0x50))
    ;
    return;
  }
  iVar9 = *(int *)(param_1 + 0x58);
  dVar21 = (double)(longlong)iVar9 / 8000.0;
  if (dVar21 < 0.0) {
    uVar1 = (ulonglong)-dVar21;
    dVar21 = (-dVar21 - (double)(uVar1 & 0xffffffff)) * 4294967296.0;
    iVar17 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
    uVar7 = (uint)uVar1;
    if (iVar17 != 0) {
      iVar17 = -iVar17;
      uVar7 = ~uVar7;
      goto LAB_0004132c;
    }
    uVar7 = -uVar7;
  }
  else {
    uVar7 = (uint)(longlong)dVar21;
    dVar21 = (dVar21 - (double)((longlong)dVar21 & 0xffffffff)) * 4294967296.0;
    iVar17 = (uint)(0.0 < dVar21) * (int)(longlong)dVar21;
LAB_0004132c:
    if (iVar17 != 0) {
      uVar2 = (*(uint *)(param_1 + 0x50) & 0xffff) + (-iVar17 & 0xffffU);
      uVar6 = (*(uint *)(param_1 + 0x50) >> 0x10) + ((uint)-iVar17 >> 0x10);
      if ((uVar2 & 0x10000) != 0) {
        uVar6 = uVar6 + 1;
      }
      *(uint *)(param_1 + 0x50) = uVar2 & 0xffff | uVar6 << 0x10;
      iVar17 = ~uVar7 + *(int *)(param_1 + 0x4c);
      if ((uVar6 & 0x10000) != 0) {
        iVar17 = iVar17 + 1;
      }
      *(int *)(param_1 + 0x4c) = iVar17;
      goto LAB_0004137c;
    }
  }
  *(uint *)(param_1 + 0x4c) = *(int *)(param_1 + 0x4c) - uVar7;
LAB_0004137c:
  uVar3 = *(undefined4 *)(param_1 + 0x50);
  *(undefined4 *)(iVar13 + 0x378) = *(undefined4 *)(param_1 + 0x4c);
  *(undefined4 *)(iVar13 + 0x37c) = uVar3;
  if (0 < iVar9) {
    iVar9 = 0;
LAB_000417cc:
    do {
      dVar21 = *(double *)(iVar13 + ((~(uint)*(byte *)(param_1 + 0x5c + iVar9) & 0xff) + 0x92) * 8);
      if (6000.0 < dVar21) {
        *(int *)(iVar13 + 0xc98) = *(int *)(iVar13 + 0xc98) + 1;
        dVar21 = 6000.0;
      }
      else if (dVar21 < -6000.0) {
        *(int *)(iVar13 + 0xc98) = *(int *)(iVar13 + 0xc98) + 1;
        dVar21 = -6000.0;
      }
      iVar17 = *(int *)(*(int *)(iVar15 + 0x3c) + 0x1c);
      dVar26 = *(double *)(iVar17 + 0xce0);
      *(double *)(iVar17 + 0xce8) = dVar26;
      dVar28 = *(double *)(iVar17 + 0xcd8);
      *(double *)(iVar17 + 0xce0) = dVar28;
      dVar30 = *(double *)(iVar17 + 0xcd0);
      *(double *)(iVar17 + 0xcd8) = dVar30;
      dVar32 = *(double *)(iVar17 + 0xcc8);
      *(double *)(iVar17 + 0xcd0) = dVar32;
      dVar35 = *(double *)(iVar17 + 0xcc0);
      *(double *)(iVar17 + 0xcc8) = dVar35;
      dVar37 = *(double *)(iVar17 + 0xcb8);
      *(double *)(iVar17 + 0xcc0) = dVar37;
      dVar39 = *(double *)(iVar17 + 0xcb0);
      *(double *)(iVar17 + 0xcb8) = dVar39;
      dVar22 = *(double *)(iVar17 + 0xca8);
      *(double *)(iVar17 + 0xcb0) = dVar22;
      dVar45 = 1000.0;
      dVar21 = dVar21 - (dVar28 * 0.488486 + dVar26 * 0.5844676 + dVar30 * 2.704384 + dVar32 * 1.645032 +
                         dVar35 * 4.644557 + dVar37 * 1.879165 + dVar39 * 3.522634 + dVar22 * 0.7315738);
      *(double *)(iVar17 + 0xca8) = dVar21;
      dVar21 = dVar22 * 0.003156599 + dVar21 * 0.006176213 + dVar39 * 0.007567487 + dVar37 * 0.00434458 +
               dVar35 * 0.01190128 + dVar32 * 0.00434458 + dVar30 * 0.007567487 + dVar28 * 0.003156599 +
               dVar26 * 0.006176213;
      *(double *)(iVar17 + 0xe18) = dVar21 * 0.25;
      if (1000.0 < dVar21) {
        dVar22 = dVar45;
        dVar45 = -1000.0;
      }
      else {
        dVar22 = -1000.0;
        if (-1000.0 <= dVar21) {
          dVar22 = dVar21;
          dVar45 = -dVar21;
        }
      }
      iVar10 = *(int *)(iVar17 + 0xe20);
      pdVar4 = (double *)(iVar17 + (iVar10 + 0x19e) * 8);
      dVar45 = dVar45 * *pdVar4;
      *pdVar4 = dVar22;
      *(int *)(iVar17 + 0xe20) = (iVar10 + 1) % 10;
      if (dVar45 < 0.0) {
        dVar45 = -SQRT(-dVar45);
      }
      else {
        dVar45 = SQRT(dVar45);
      }
      dVar32 = *(double *)(iVar17 + 0xe08);
      *(double *)(iVar17 + 0xe10) = dVar32;
      dVar30 = *(double *)(iVar17 + 0xe00);
      *(double *)(iVar17 + 0xe08) = dVar30;
      dVar35 = *(double *)(iVar17 + 0xdf8);
      *(double *)(iVar17 + 0xe00) = dVar35;
      dVar47 = *(double *)(iVar17 + 0xdf0);
      *(double *)(iVar17 + 0xdf8) = dVar47;
      dVar46 = *(double *)(iVar17 + 0xde8);
      *(double *)(iVar17 + 0xdf0) = dVar46;
      dVar44 = *(double *)(iVar17 + 0xde0);
      *(double *)(iVar17 + 0xde8) = dVar44;
      dVar43 = *(double *)(iVar17 + 0xdd8);
      *(double *)(iVar17 + 0xde0) = dVar43;
      dVar42 = *(double *)(iVar17 + 0xdd0);
      *(double *)(iVar17 + 0xdd8) = dVar42;
      dVar41 = *(double *)(iVar17 + 0xdc8);
      *(double *)(iVar17 + 0xdd0) = dVar41;
      dVar40 = *(double *)(iVar17 + 0xdc0);
      *(double *)(iVar17 + 0xdc8) = dVar40;
      dVar38 = *(double *)(iVar17 + 0xdb8);
      *(double *)(iVar17 + 0xdc0) = dVar38;
      dVar36 = *(double *)(iVar17 + 0xdb0);
      *(double *)(iVar17 + 0xdb8) = dVar36;
      dVar33 = *(double *)(iVar17 + 0xda8);
      *(double *)(iVar17 + 0xdb0) = dVar33;
      dVar31 = *(double *)(iVar17 + 0xda0);
      *(double *)(iVar17 + 0xda8) = dVar31;
      dVar29 = *(double *)(iVar17 + 0xd98);
      *(double *)(iVar17 + 0xda0) = dVar29;
      dVar27 = *(double *)(iVar17 + 0xd90);
      *(double *)(iVar17 + 0xd98) = dVar27;
      dVar26 = *(double *)(iVar17 + 0xd88);
      *(double *)(iVar17 + 0xd90) = dVar26;
      dVar23 = *(double *)(iVar17 + 0xe28) + 0.000125;
      dVar22 = *(double *)(iVar17 + 0xd80);
      *(double *)(iVar17 + 0xd88) = dVar22;
      dVar21 = *(double *)(iVar17 + 0xd78);
      *(double *)(iVar17 + 0xd80) = dVar21;
      dVar37 = *(double *)(iVar17 + 0xd70);
      *(double *)(iVar17 + 0xd78) = dVar37;
      dVar39 = *(double *)(iVar17 + 0xd68);
      *(double *)(iVar17 + 0xd70) = dVar39;
      dVar19 = *(double *)(iVar17 + 0xd60);
      *(double *)(iVar17 + 0xd68) = dVar19;
      dVar20 = *(double *)(iVar17 + 0xd58);
      *(double *)(iVar17 + 0xd60) = dVar20;
      dVar28 = *(double *)(iVar17 + 0xd50);
      *(double *)(iVar17 + 0xd58) = dVar28;
      *(double *)(iVar17 + 0xe28) = dVar23;
      dVar25 = *(double *)(iVar17 + 0xd48);
      *(double *)(iVar17 + 0xd50) = dVar25;
      dVar24 = *(double *)(iVar17 + 0xd40);
      *(double *)(iVar17 + 0xd40) = dVar45 * 0.02538771;
      *(double *)(iVar17 + 0xd48) = dVar24;
      if (0.0004166666666666667 < dVar23) {
        iVar10 = 0xb;
        uVar3 = *(undefined4 *)(iVar17 + 0x378);
        uVar5 = *(undefined4 *)(iVar17 + 0x37c);
        iVar12 = (*(int *)(iVar17 + 0x1230) + 1) % 8;
        *(int *)(iVar17 + 0x1230) = iVar12;
        iVar16 = iVar17 + iVar12 * 0x80;
        pdVar4 = (double *)(iVar16 + 0xe98);
        dVar18 = -1000000.0;
        dVar34 = 1000000.0;
        *(double *)(iVar17 + 0xe28) = dVar23 - 0.0004166666666666667;
        *(double *)(iVar16 + 0xe38) =
             -((dVar30 * 0.1084671 + dVar32 * 0.02538771 + dVar35 * 0.2003159 + dVar47 * 0.2985303 + dVar46 * 0.4003697
                + dVar44 * 0.5028552 + dVar43 * 0.6028795 + dVar42 * 0.6973249 + dVar41 * 0.7831828 + dVar40 * 0.8576717
                + dVar38 * 0.9183463 + dVar36 * 0.9631951 + dVar33 * 0.9907208 + dVar31 + dVar29 * 0.9907208 +
                dVar27 * 0.9631951 + dVar26 * 0.9183463 + dVar22 * 0.8576717 + dVar21 * 0.7831828 + dVar37 * 0.6973249 +
                dVar39 * 0.6028795 + dVar19 * 0.5028552 + dVar20 * 0.4003697 + dVar28 * 0.2985303 + dVar25 * 0.2003159 +
                dVar24 * 0.1084671 + dVar45 * 0.02538771) * 6.0);
        *(undefined4 *)(iVar16 + 0xe30) = uVar3;
        *(undefined4 *)(iVar16 + 0xe34) = uVar5;
        do {
          dVar21 = pdVar4[-2];
          pdVar4 = pdVar4 + -1;
          *pdVar4 = dVar21;
          if (dVar18 < dVar21) {
            dVar18 = dVar21;
          }
          if (dVar21 < dVar34) {
            dVar34 = dVar21;
          }
          iVar10 = iVar10 + -1;
        } while (iVar10 != 0);
        dVar22 = dVar18 - dVar34;
        pdVar4 = (double *)(iVar16 + 0xe40);
        *(undefined4 *)(iVar16 + 0xea8) = 0;
        iVar10 = 1;
        dVar21 = 0.0;
        *(double *)(iVar16 + 0xe98) = dVar22;
        dVar45 = dVar34 + dVar22 * 0.45;
        uVar7 = 0;
        do {
          dVar26 = *pdVar4;
          pdVar4 = pdVar4 + 1;
          uVar7 = uVar7 << 1;
          if (dVar45 < dVar26) {
            uVar7 = uVar7 | 1;
          }
          if (iVar10 - 1U < 2) {
LAB_000419ac:
            dVar26 = dVar26 - dVar34;
          }
          else {
            if (iVar10 == 0xb) {
              *(uint *)(iVar16 + 0xea8) = uVar7;
              dVar21 = dVar21 + (dVar18 - dVar26);
              goto LAB_000419d4;
            }
            if (dVar45 < dVar26) goto LAB_000419ac;
            dVar26 = dVar18 - dVar26;
          }
          dVar21 = dVar21 + dVar26;
          iVar10 = iVar10 + 1;
        } while (iVar10 != 0xc);
        *(uint *)(iVar16 + 0xea8) = uVar7;
LAB_000419d4:
        iVar10 = *(int *)(iVar17 + 0x1238);
        *(double *)(iVar16 + 0xea0) = dVar21 / (dVar22 * 11.0);
        if (iVar10 < 1) {
          if (iVar12 == *(int *)(iVar17 + 0x1234)) goto LAB_00041a0c;
        }
        else {
          iVar10 = iVar10 + -1;
          *(int *)(iVar17 + 0x1238) = iVar10;
          if (iVar10 == 0) {
            *(int *)(iVar17 + 0x1234) = iVar12;
LAB_00041a0c:
            iVar10 = -1;
            puVar8 = (uint *)(iVar17 + 0xea8);
            iVar12 = 0;
            dVar21 = 0.0;
            do {
              while (((*puVar8 & 0x601) == 0x600 && (800.0 <= *(double *)(puVar8 + -4)))) {
                dVar45 = *(double *)(puVar8 + -2);
                puVar8 = puVar8 + 0x20;
                if (dVar21 < dVar45) {
                  iVar10 = iVar12;
                }
                iVar12 = iVar12 + 1;
                if (dVar21 < dVar45) {
                  dVar21 = dVar45;
                }
                if (iVar12 == 8) goto LAB_00041a80;
              }
              iVar12 = iVar12 + 1;
              puVar8 = puVar8 + 0x20;
            } while (iVar12 != 8);
LAB_00041a80:
            if (iVar10 != -1) {
              iVar12 = iVar17 + iVar10 * 0x80;
              iVar10 = *(int *)(iVar12 + 0xea8);
              uVar14 = *(undefined4 *)(iVar12 + 0xe9c);
              uVar3 = *(undefined4 *)(iVar12 + 0xe30);
              uVar5 = *(undefined4 *)(iVar12 + 0xe34);
              *(undefined4 *)(iVar17 + 0x470) = *(undefined4 *)(iVar12 + 0xe98);
              *(undefined4 *)(iVar17 + 0x474) = uVar14;
              FUN_00040818(iVar15,(uint)(iVar10 << 0x17) >> 0x18,uVar3,uVar5);
              *(undefined4 *)(iVar17 + 0x1238) = 0x58;
            }
          }
        }
      }
      uVar7 = (*(uint *)(iVar13 + 0x37c) & 0xffff) + (*(uint *)(iVar13 + 0xca4) & 0xffff);
      uVar2 = (*(uint *)(iVar13 + 0x37c) >> 0x10) + (*(uint *)(iVar13 + 0xca4) >> 0x10);
      if ((uVar7 & 0x10000) != 0) {
        uVar2 = uVar2 + 1;
      }
      iVar17 = *(int *)(iVar13 + 0xca0) + *(int *)(iVar13 + 0x378);
      *(uint *)(iVar13 + 0x37c) = uVar7 & 0xffff | uVar2 << 0x10;
      if ((uVar2 & 0x10000) != 0) {
        iVar17 = iVar17 + 1;
      }
      *(int *)(iVar13 + 0x378) = iVar17;
      iVar17 = (*(int *)(iVar13 + 0xc9c) + 1) % 8000;
      *(int *)(iVar13 + 0xc9c) = iVar17;
      if (iVar17 != 0) {
        iVar9 = iVar9 + 1;
        if (*(int *)(param_1 + 0x58) <= iVar9) break;
        goto LAB_000417cc;
      }
      iVar10 = *(int *)(*(int *)(iVar15 + 0x3c) + 0x1c);
      iVar17 = *(int *)(iVar10 + 0x478);
      if (*(int *)(iVar10 + 0xc98) == 0) {
        iVar17 = iVar17 + 4;
        if (0xff < iVar17) {
          iVar17 = 0xff;
        }
LAB_00041ae8:
        *(int *)(iVar10 + 0x478) = iVar17;
      }
      else if (100 < *(int *)(iVar10 + 0xc98)) {
        iVar17 = iVar17 + -4;
        if (-1 < iVar17) goto LAB_00041ae8;
        *(undefined4 *)(iVar10 + 0x478) = 0;
        iVar17 = 0;
      }
      iVar9 = iVar9 + 1;
      FUN_0004d950(iVar17,*(undefined4 *)(iVar10 + 0xc94),*(undefined4 *)(iVar10 + 0xc90));
      *(undefined4 *)(iVar10 + 0xc98) = 0;
    } while (iVar9 < *(int *)(param_1 + 0x58));
  }
  if ((*(byte *)(iVar11 + 0x2f0) & 2) == 0) {
    *(undefined4 *)(iVar13 + 0xc90) = 1;
  }
  else {
    *(undefined4 *)(iVar13 + 0xc90) = 2;
  }
  uVar7 = *(byte *)(iVar11 + 0x2f0) & 4;
  if ((*(byte *)(iVar11 + 0x2f0) & 4) != 0) {
    uVar7 = 0x7f;
  }
  *(uint *)(iVar13 + 0xc94) = uVar7;
  return;
}




void FUN_00041cec(int param_1,ushort *param_2)

{
  undefined4 uVar1;
  uint uVar2;
  
  uVar2 = *(uint *)(param_2 + 8) & 0xffffff80 | 8;
  *(uint *)(param_2 + 8) = uVar2;
  if (*(code **)(param_2 + 0x14) != (code *)0x0) {
    (**(code **)(param_2 + 0x14))();
    uVar2 = *(uint *)(param_2 + 8);
  }
  *(undefined4 *)(param_2 + 0xc) = *(undefined4 *)(*(int *)(param_1 + 0x74) + (uint)*param_2 * 4);
  uVar1 = *(undefined4 *)(*(int *)(param_1 + 0x78) + (uint)*param_2 * 4);
  *(uint *)(param_2 + 8) = uVar2 & 0xffffff80;
  *(undefined4 *)(param_2 + 0xe) = uVar1;
  return;
}




undefined4 FUN_00041d44(int param_1,undefined4 *param_2)

{
  undefined1 *puVar1;
  undefined1 *puVar2;
  undefined1 *puVar3;
  uint uVar4;
  undefined4 uVar5;
  
  uVar4 = *(uint *)(param_1 + 0xc);
  *param_2 = DAT_0007b978;
  puVar3 = DAT_0007b850;
  puVar2 = DAT_0007b84c;
  puVar1 = DAT_0007b83c;
  uVar4 = uVar4 & 3;
  DAT_000c9a70 = DAT_0007b844;
  DAT_000c9a94 = DAT_0007b848;
  DAT_000c9a88 = DAT_0007ba20;
  DAT_000c9a5c = DAT_0007b850;
  DAT_000c9a68 = DAT_0007b840;
  DAT_000c9a78 = DAT_0007b918;
  DAT_000c9a7c = DAT_0007b91c;
  DAT_000c9a84 = DAT_0007b914;
  DAT_000c9a8c = DAT_0007ba60;
  DAT_000c9a60 = DAT_0007b9ac;
  DAT_000c9a80 = DAT_0007b9ac;
  DAT_000c9a64 = DAT_0007b84c;
  DAT_000c9a6c = DAT_0007b83c;
  DAT_000c9a74 = DAT_0007b838;
  if (uVar4 == 2) {
    uVar5 = 8;
    DAT_000c9a90 = DAT_0007ba1c;
    *DAT_0007b838 = 0x20;
    *puVar1 = 0x20;
    *puVar2 = 0x20;
    *puVar3 = 0x20;
    DAT_000c9a7c = " [arg]";
  }
  else if ((uVar4 == 3) || (uVar4 == 1)) {
    uVar5 = 0x16;
    DAT_000c9a90 = DAT_0007b920;
  }
  else {
    DAT_000c9a90 = DAT_0007b920 + 2;
    uVar5 = 0x16;
  }
  return uVar5;
}




undefined4 FUN_00041e3c(int param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  
  DAT_000c9a5c = DAT_0007ba50;
  DAT_000c9a60 = DAT_0007ba4c;
  DAT_000c9a64 = DAT_0007ba44;
  DAT_000c9a6c = DAT_0007ba30;
  DAT_000c9a78 = DAT_0007ba3c;
  DAT_000c9a70 = DAT_0007ba34;
  DAT_000c9a94 = DAT_0007ba38;
  DAT_000c9a68 = DAT_0007ba2c;
  DAT_000c9a74 = DAT_0007ba24;
  DAT_000c9a7c = DAT_0007ba48;
  DAT_000c9a80 = DAT_0007ba40;
  DAT_000c9a84 = DAT_0007ba28;
  DAT_000c9a88 = DAT_0007b8d4;
  DAT_000c9a8c = DAT_0007ba64;
  switch(*(uint *)(param_1 + 0xc) & 0x12) {
  case 0:
    uVar1 = 0x18;
    *param_2 = DAT_0007ba0c;
    DAT_000c9a90 = DAT_0007ba04;
    break;
  case 2:
    uVar1 = 0x18;
    *param_2 = DAT_0007ba10;
    DAT_000c9a90 = DAT_0007ba04;
    break;
  default:
    uVar1 = 0;
    break;
  case 0x10:
    uVar1 = 0x13;
    *param_2 = DAT_0007b974;
    DAT_000c9a90 = DAT_0007b9a4;
    break;
  case 0x12:
    uVar1 = 0x13;
    *param_2 = DAT_0007b978;
    DAT_000c9a90 = DAT_0007b9a4;
  }
  return uVar1;
}




undefined4 FUN_00041f8c(int param_1,uint param_2,int *param_3,undefined4 param_4)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = *(int *)(param_1 + 100);
  iVar2 = *(int *)(param_1 + 0x44);
  do {
    iVar3 = iVar3 + -1;
    if (*(ushort *)(iVar2 + 2) == param_2) {
      if (((uint)*(undefined **)(iVar2 + 0x10) & 0x280000) == 0) {
        *param_3 = iVar2;
        param_3[3] = 1;
        return 0;
      }
      if ((*(undefined **)(iVar2 + 0x10) != &DAT_00080100) || (*(int *)(iVar2 + 0x34) == 0)) goto LAB_00042028;
      fprintf(stderr,DAT_0007b8b8,*(undefined4 *)(param_1 + 0x18),*(int *)(iVar2 + 0x34),param_4);
      if (*(int *)(iVar2 + 0x2c) != 0) {
        fprintf(stderr," -- %s");
      }
      fputc(10,stderr);
      (**(code **)(param_1 + 0x54))(param_1,1);
      uVar1 = *(uint *)(param_1 + 0xc);
      goto joined_r0x000420e0;
    }
    iVar2 = iVar2 + 0x40;
  } while (0 < iVar3);
  if ((((param_2 & 0xff) < 0x80) && ((*(uint *)(&DAT_00069a0c + (param_2 & 0xff) * 4) & 0xc) != 0)) &&
     (*(ushort *)(param_1 + 0x60) != 0x8000)) {
    iVar2 = *(int *)(param_1 + 0x14);
    *param_3 = *(int *)(param_1 + 0x44) + (uint)*(ushort *)(param_1 + 0x60) * 0x40;
    *(int *)(param_1 + 0x14) = iVar2 + -1;
    param_3[3] = 1;
    return 0;
  }
LAB_00042028:
  uVar1 = *(uint *)(param_1 + 0xc);
joined_r0x000420e0:
  if ((uVar1 & 4) == 0) {
    return 0xffffffff;
  }
  fprintf(stderr,DAT_0007b924,*(undefined4 *)(param_1 + 0x18),param_2,param_4);
  (**(code **)(param_1 + 0x54))(param_1,1);
  return 0xffffffff;
}




void FUN_000420f8(int *param_1,int param_2,FILE *param_3)

{
  byte bVar1;
  int iVar2;
  char *pcVar3;
  size_t sVar4;
  char *pcVar5;
  
  if ((((*(uint *)(param_2 + 0x10) & 0x10000) != 0) && (*(byte **)(param_2 + 0x18) != (byte *)0x0)) &&
     (bVar1 = **(byte **)(param_2 + 0x18), bVar1 != 0x56)) {
    if (bVar1 < 0x57) {
      if (bVar1 == 0x43) {
LAB_00042284:
        pcVar5 = (char *)param_1[10];
        if ((pcVar5 == (char *)0x0) && (pcVar5 = (char *)param_1[0xc], pcVar5 == (char *)0x0)) {
          pcVar3 = (char *)param_1[0xe];
          pcVar5 = strchr(pcVar3,10);
          if (pcVar5 == (char *)0x0) {
            sVar4 = strlen(pcVar3);
            pcVar5 = pcVar3 + sVar4;
          }
          fwrite(pcVar3,1,(size_t)pcVar5,param_3);
        }
        else {
          fputs(pcVar5,param_3);
        }
        fputc(10,param_3);
        if ((*param_1 < 0x22000) || (pcVar5 = (char *)param_1[0x20], pcVar5 == (char *)0x0)) {
          if (param_1[0x12] != 0) {
            fprintf(param_3,DAT_0007b9c0);
          }
          goto LAB_00042130;
        }
        goto LAB_00042278;
      }
      if (bVar1 == 0x4e) goto LAB_0004220c;
      if (bVar1 != 0) goto LAB_00042198;
    }
    else {
      if (bVar1 == 0x6e) {
LAB_0004220c:
        if ((char *)param_1[10] != (char *)0x0) {
          fputs((char *)param_1[10],param_3);
          fputc(10,param_3);
        }
        if ((char *)param_1[0xb] != (char *)0x0) {
          fputs((char *)param_1[0xb],param_3);
          fputc(10,param_3);
        }
        fprintf(param_3,DAT_0007b870,"AO_CURRENT.AO_REVISION");
        if ((*param_1 < 0x22000) || (pcVar5 = (char *)param_1[0x20], pcVar5 == (char *)0x0)) {
          if (param_1[0x12] != 0) {
            fprintf(param_3,DAT_0007b9c0);
          }
          goto LAB_00042130;
        }
LAB_00042278:
        fputs(pcVar5,param_3);
        goto LAB_00042130;
      }
      if (bVar1 != 0x76) {
        if (bVar1 != 99) {
LAB_00042198:
          fprintf(stderr,DAT_0007b89c);
                    /* WARNING: Subroutine does not return */
          exit(1);
        }
        goto LAB_00042284;
      }
    }
  }
  if ((char *)param_1[0xc] == (char *)0x0) {
    pcVar5 = (char *)param_1[10];
    if (pcVar5 == (char *)0x0) {
      pcVar3 = (char *)param_1[0xe];
      pcVar5 = strchr(pcVar3,10);
      if (pcVar5 == (char *)0x0) {
        sVar4 = strlen(pcVar3);
        pcVar5 = pcVar3 + sVar4;
      }
      fwrite(pcVar3,1,(size_t)pcVar5,param_3);
    }
    else {
      pcVar3 = strchr(pcVar5,10);
      if (pcVar3 == (char *)0x0) {
        sVar4 = strlen(pcVar5);
        pcVar3 = pcVar5 + sVar4;
      }
      fwrite(pcVar5,1,(int)pcVar3 - (int)pcVar5,param_3);
    }
  }
  else {
    fputs((char *)param_1[0xc],param_3);
  }
  fputc(10,param_3);
LAB_00042130:
  fflush(param_3);
  iVar2 = ferror(param_3);
  if (iVar2 == 0) {
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  fputs(DAT_0007b9b8,stderr);
                    /* WARNING: Subroutine does not return */
  exit(1);
}




void FUN_00042398(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
                    /* WARNING: Subroutine does not return */
  FUN_000420f8(param_1,param_2,stdout,&stdout,param_4);
}




void FUN_000423ac(int param_1,byte *param_2)

{
  byte *pbVar1;
  uint uVar2;
  uint uVar3;
  undefined4 *puVar4;
  uint uVar5;
  byte *pbVar6;
  int iVar7;
  uint local_2c;
  
  if ((param_2 != (byte *)0x0) || (param_2 = (byte *)getenv("AUTOOPTS_USAGE"), param_2 != (byte *)0x0)) {
    uVar5 = (uint)*param_2;
    if (uVar5 < 0x80) {
      uVar3 = *(uint *)(&DAT_00069a0c + uVar5 * 4);
      while ((uVar3 & 0x500) != 0) {
        param_2 = param_2 + 1;
        uVar5 = (uint)*param_2;
        if (0x7f < uVar5) break;
        uVar3 = *(uint *)(&DAT_00069a0c + uVar5 * 4);
      }
    }
    if (uVar5 != 0) {
      local_2c = 0;
      do {
        do {
          puVar4 = &DAT_00069c30;
          uVar5 = 0;
          while( true ) {
            iVar7 = puVar4[-3];
            pbVar1 = (byte *)puVar4[-1];
            if (iVar7 < 1) break;
            if ((&DAT_0007ba70)[*pbVar1] == (&DAT_0007ba70)[*param_2]) {
              if (*param_2 == 0) break;
              pbVar6 = param_2;
              while( true ) {
                if (pbVar6 == param_2 + iVar7 + -1) goto LAB_0004247c;
                pbVar6 = pbVar6 + 1;
                pbVar1 = pbVar1 + 1;
                if ((&DAT_0007ba70)[*pbVar6] != (&DAT_0007ba70)[*pbVar1]) break;
                if (*pbVar6 == 0) goto LAB_0004247c;
              }
            }
            uVar5 = uVar5 + 1;
            puVar4 = puVar4 + 3;
            if (uVar5 == 4) {
              return;
            }
          }
LAB_0004247c:
          param_2 = param_2 + iVar7;
          uVar3 = (uint)*param_2;
          if (0x7f < uVar3) {
            return;
          }
          uVar2 = *(uint *)(&DAT_00069a0c + uVar3 * 4);
          if ((uVar2 & 0x300500) == 0) {
            return;
          }
          local_2c = local_2c | 1 << (uVar5 & 0xff);
          while ((uVar2 & 0x500) != 0) {
            param_2 = param_2 + 1;
            uVar3 = (uint)*param_2;
            if (0x7f < uVar3) break;
            uVar2 = *(uint *)(&DAT_00069a0c + uVar3 * 4);
          }
          if (uVar3 == 0) goto LAB_00042504;
        } while (uVar3 != 0x2c);
        do {
          param_2 = param_2 + 1;
          uVar5 = (uint)*param_2;
          if (0x7f < uVar5) break;
        } while ((*(uint *)(&DAT_00069a0c + uVar5 * 4) & 0x500) != 0);
      } while (uVar5 != 0);
LAB_00042504:
      if (local_2c != 0) {
        puVar4 = &DAT_00069c30;
        do {
          if ((local_2c & 1) != 0) {
            uVar5 = puVar4[-2];
            if ((uVar5 & 1) == 0) {
              uVar5 = *(uint *)(param_1 + 0xc) | uVar5;
            }
            else {
              uVar5 = *(uint *)(param_1 + 0xc) & uVar5;
            }
            *(uint *)(param_1 + 0xc) = uVar5;
          }
          local_2c = local_2c >> 1;
          puVar4 = puVar4 + 3;
        } while (local_2c != 0);
      }
    }
  }
  return;
}




void FUN_000425b4(FILE *param_1,int param_2,char *param_3)

{
  char *pcVar1;
  undefined4 uVar2;
  
  if (((*(uint *)(param_2 + 0x10) & 0x20) == 0) || (*(short *)(param_2 + 8) != -0x8000)) {
    uVar2 = *(undefined4 *)(param_2 + 0x34);
  }
  else {
    uVar2 = *(undefined4 *)(param_2 + 0x38);
  }
  fprintf(param_1,"%-18s",uVar2);
  if ((uint)(*(int *)(param_2 + 0x10) << 0x10) >> 0x1c != 5) {
    if (param_3 != (char *)0x0) {
      fputc(0x20,param_1);
      fputc(0x20,param_1);
      while( true ) {
        pcVar1 = strchr(param_3,10);
        if (pcVar1 == (char *)0x0) break;
        fwrite(param_3,(int)pcVar1 - (int)param_3,1,param_1);
        param_3 = pcVar1 + 1;
        fwrite(&DAT_0006cfe8,1,2,param_1);
      }
      fputs(param_3,param_1);
    }
    fputc(10,param_1);
    return;
  }
  fprintf(param_1,"  %d\n",param_3);
  return;
}




void FUN_000426a4(uint param_1,int param_2,undefined4 *param_3,int param_4)

{
  char cVar1;
  char *__s;
  size_t sVar2;
  uint uVar3;
  int iVar4;
  undefined4 *puVar5;
  char *pcVar6;
  int iVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  uint local_3c;
  char acStack_38 [20];
  
  if (0xf < param_1) {
    fprintf(DAT_000c9a98,DAT_000c9a9c,*(undefined4 *)(param_1 + 0x1c),*(undefined4 *)(param_2 + 0x18),
            *(undefined4 *)(param_2 + 0x34));
  }
  uVar10 = 0;
  uVar8 = 0;
  fprintf(DAT_000c9a98,DAT_0007ba6c,*(undefined4 *)(param_2 + 0x34));
  pcVar6 = (char *)*param_3;
  cVar1 = *pcVar6;
  if (cVar1 == '\x7f') {
    pcVar6 = (char *)param_3[1];
    param_3 = param_3 + 1;
    param_4 = param_4 + -1;
  }
  local_3c = (uint)(cVar1 == '\x7f');
  __s = pcVar6;
  puVar5 = param_3;
  iVar9 = param_4;
  while( true ) {
    sVar2 = strlen(__s);
    iVar9 = iVar9 + -1;
    uVar3 = sVar2 + 1;
    if (uVar8 < uVar3) {
      uVar8 = uVar3;
    }
    uVar10 = uVar10 + uVar3;
    if (iVar9 < 1) break;
    puVar5 = puVar5 + 1;
    __s = (char *)*puVar5;
  }
  iVar9 = param_4;
  if (uVar8 < 0x24) {
    if (uVar10 < 0x4c) {
      fputc(0x20,DAT_000c9a98);
      do {
        fputc(0x20,DAT_000c9a98);
        iVar9 = iVar9 + -1;
        fputs((char *)*param_3,DAT_000c9a98);
        param_3 = param_3 + 1;
      } while (0 < iVar9);
      fputc(10,DAT_000c9a98);
    }
    else {
      sprintf(acStack_38,"%%-%ds",uVar8);
      iVar4 = FUN_0005a860(0x4e,uVar8);
      iVar7 = 0;
      fwrite("  ",1,2,DAT_000c9a98);
      while( true ) {
        iVar9 = iVar9 + -1;
        pcVar6 = acStack_38;
        iVar7 = iVar7 + 1;
        if (iVar9 < 1) break;
        if (iVar7 == iVar4) {
          pcVar6 = "%s\n  ";
          iVar7 = 0;
        }
        fprintf(DAT_000c9a98,pcVar6,*param_3);
        param_3 = param_3 + 1;
      }
      fprintf(DAT_000c9a98,"%s\n",*param_3);
    }
  }
  else {
    while( true ) {
      fprintf(DAT_000c9a98,"  %s\n",pcVar6);
      if (iVar9 + -1 < 1) break;
      param_3 = param_3 + 1;
      pcVar6 = (char *)*param_3;
      iVar9 = iVar9 + -1;
    }
  }
  if (0xf < param_1) {
    fprintf(DAT_000c9a98,DAT_0007b930,local_3c,param_4 + -1 + local_3c);
    (**(code **)(param_1 + 0x54))(param_1,1);
  }
  if ((uint)(*(int *)(param_2 + 0x10) << 0x10) >> 0x1c == 4) {
    fprintf(DAT_000c9a98,DAT_0007b938,param_4);
    fputs(DAT_0007ba18,DAT_000c9a98);
  }
  else {
    fprintf(DAT_000c9a98,DAT_0007b930,local_3c,param_4 + -1 + local_3c);
  }
  return;
}




void FUN_00042960(int *param_1)

{
  int *__ptr;
  int iVar1;
  int *piVar2;
  
  iVar1 = *param_1 + -1;
  piVar2 = param_1 + 2;
  if (0 < *param_1) {
    do {
      while( true ) {
        __ptr = (int *)*piVar2;
        iVar1 = iVar1 + -1;
        if (*__ptr != 6) break;
        FUN_00042960(__ptr[2]);
        free(__ptr);
        piVar2 = piVar2 + 1;
        if (iVar1 == -1) goto LAB_000429bc;
      }
      free(__ptr);
      piVar2 = piVar2 + 1;
    } while (iVar1 != -1);
  }
LAB_000429bc:
  free(param_1);
  return;
}




void FUN_000429c8(int param_1,undefined4 *param_2)

{
  ushort uVar1;
  ushort uVar2;
  uint uVar3;
  undefined4 uVar4;
  uint uVar5;
  ushort *puVar6;
  ushort *puVar7;
  undefined *puVar8;
  code *pcVar9;
  
  puVar6 = (ushort *)*param_2;
  uVar5 = *(uint *)(puVar6 + 8);
  pcVar9 = *(code **)(puVar6 + 0x14);
  if ((uVar5 & 0x40) != 0) {
    free(*(void **)(puVar6 + 0xc));
    uVar5 = *(uint *)(puVar6 + 8);
  }
  uVar4 = param_2[1];
  *(undefined4 *)(puVar6 + 0xc) = uVar4;
  if (((*(uint *)(param_1 + 0xc) & 0x80000) != 0) && ((uVar5 & 0x100) != 0)) {
    return;
  }
  if (puVar6[4] == 0x8000) {
    uVar3 = param_2[2];
    puVar6[3] = puVar6[1];
    puVar6[2] = *puVar6;
    goto LAB_00042a5c;
  }
  puVar7 = (ushort *)(*(int *)(param_1 + 0x44) + (uint)puVar6[4] * 0x40);
  if ((uVar5 & 4) == 0) {
    uVar1 = *puVar6;
    puVar7[2] = 0x8000;
    if (uVar1 == 0x8000) goto LAB_00042b04;
    uVar2 = puVar6[1];
    uVar3 = param_2[2];
    puVar7[2] = uVar1;
    puVar7[3] = uVar2;
    uVar3 = uVar3 | 0x10;
    param_2[2] = uVar3;
  }
  else {
    if ((uint)*puVar6 != (uint)puVar7[2]) {
      fprintf(stderr,DAT_0007b944,*(undefined4 *)(puVar7 + 0x1a),*(undefined4 *)(puVar6 + 0x1a),
              *(undefined4 *)(*(int *)(param_1 + 0x44) + (uint)puVar7[2] * 0x40 + 0x34));
      return;
    }
LAB_00042b04:
    uVar3 = param_2[2];
  }
  uVar5 = *(uint *)(puVar7 + 8);
  *(undefined4 *)(puVar7 + 0xc) = uVar4;
  puVar6 = puVar7;
LAB_00042a5c:
  *(uint *)(puVar6 + 8) = uVar3 & 0x7f | uVar5 & 0xffffff80;
  if (((uVar3 & 4) == 0) || (uVar1 = puVar6[7], puVar6[7] = uVar1 + 1, (ushort)(uVar1 + 1) <= puVar6[6])) {
    if (pcVar9 != (code *)0x0) {
      (*pcVar9)(param_1,puVar6);
    }
  }
  else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
    puVar8 = DAT_0007b8c8;
    if (puVar6[4] == 0x8000) {
      puVar8 = &DAT_00069c54;
    }
    fputs(DAT_0007b8cc,stderr);
    if (puVar6[6] < 2) {
      fprintf(stderr,DAT_0007b9b0,*(undefined4 *)(puVar6 + 0x1a),puVar8);
    }
    else {
      fprintf(stderr,DAT_0007b890,(uint)puVar6[6],*(undefined4 *)(puVar6 + 0x1a),puVar8);
    }
  }
  return;
}




undefined4 FUN_00042bb4(int param_1,byte *param_2,int *param_3)

{
  bool bVar1;
  byte *pbVar2;
  char *__format;
  uint uVar3;
  int iVar4;
  byte *pbVar5;
  byte *pbVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  size_t local_d0;
  int local_cc;
  int local_c4;
  char *local_b8;
  byte local_a8 [132];
  
  local_b8 = strchr((char *)param_2,0x3d);
  iVar4 = *(int *)(param_1 + 0x44);
  iVar10 = *(int *)(param_1 + 100);
  if (local_b8 == (char *)0x0) {
    local_d0 = strlen((char *)param_2);
    local_b8 = (char *)0x0;
  }
  else {
    local_d0 = (int)local_b8 - (int)param_2;
    if (0x7f < local_d0) {
      return 0xffffffff;
    }
    local_b8 = local_b8 + 1;
    memcpy(local_a8,param_2,local_d0);
    local_a8[local_d0] = 0;
    param_2 = local_a8;
  }
  local_c4 = 0;
  iVar8 = 0;
  local_cc = 0;
  bVar1 = false;
  iVar9 = iVar4;
  do {
    pbVar6 = *(byte **)(iVar9 + 0x34);
    if ((pbVar6 != (byte *)0x0) &&
       ((((uint)*(undefined **)(iVar9 + 0x10) & 0x280000) == 0 || (*(undefined **)(iVar9 + 0x10) == &DAT_00080100)))) {
      if ((int)local_d0 < 1) {
LAB_00042d1c:
        local_c4 = iVar8;
        if (pbVar6[local_d0] == 0) goto LAB_00042e4c;
LAB_00042d2c:
        local_cc = local_cc + 1;
        local_c4 = iVar8;
        if (local_cc != 1) goto LAB_00042dd4;
      }
      else {
        uVar7 = (uint)*param_2;
        pbVar2 = pbVar6;
        pbVar5 = param_2;
        uVar3 = uVar7;
        if ((&DAT_0007ba70)[uVar7] == (&DAT_0007ba70)[*pbVar6]) {
          do {
            if ((uVar3 == 0) || (pbVar5 == param_2 + (local_d0 - 1))) goto LAB_00042d1c;
            pbVar5 = pbVar5 + 1;
            uVar3 = (uint)*pbVar5;
            pbVar2 = pbVar2 + 1;
          } while ((&DAT_0007ba70)[uVar3] == (&DAT_0007ba70)[*pbVar2]);
        }
        pbVar6 = *(byte **)(iVar9 + 0x38);
        if ((pbVar6 != (byte *)0x0) &&
           (pbVar2 = pbVar6, pbVar5 = param_2, (&DAT_0007ba70)[uVar7] == (&DAT_0007ba70)[*pbVar6])) {
          do {
            if ((uVar7 == 0) || (pbVar5 == param_2 + (local_d0 - 1))) {
              if (pbVar6[local_d0] != 0) {
                bVar1 = true;
                goto LAB_00042d2c;
              }
              bVar1 = true;
              local_c4 = iVar8;
              goto LAB_00042e4c;
            }
            pbVar5 = pbVar5 + 1;
            uVar7 = (uint)*pbVar5;
            pbVar2 = pbVar2 + 1;
          } while ((&DAT_0007ba70)[uVar7] == (&DAT_0007ba70)[*pbVar2]);
        }
      }
    }
    iVar8 = iVar8 + 1;
    iVar9 = iVar9 + 0x40;
  } while (iVar8 < iVar10);
  if (local_cc != 1) {
LAB_00042dd4:
    if (((local_b8 == (char *)0x0) && ((*(uint *)(param_1 + 0xc) & 3) == 0)) && (*(ushort *)(param_1 + 0x62) != 0x8000))
    {
      *param_3 = iVar4 + (uint)*(ushort *)(param_1 + 0x62) * 0x40;
      param_3[1] = (int)param_2;
      param_3[3] = 3;
      return 0;
    }
    if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
      __format = DAT_0007b928;
      if (local_cc != 0) {
        __format = DAT_0007b888;
      }
      fprintf(stderr,__format,*(undefined4 *)(param_1 + 0x18),param_2);
      (**(code **)(param_1 + 0x54))(param_1,1);
    }
    return 0xffffffff;
  }
LAB_00042e4c:
  iVar4 = iVar4 + local_c4 * 0x40;
  if ((*(uint *)(iVar4 + 0x10) & 0x280000) != 0) {
    fprintf(stderr,DAT_0007b8b8,*(undefined4 *)(param_1 + 0x1c),*(undefined4 *)(iVar4 + 0x34));
    if (*(int *)(iVar4 + 0x2c) != 0) {
      fprintf(stderr," -- %s");
    }
    fputc(10,stderr);
    (**(code **)(param_1 + 0x54))(param_1,1);
  }
  if (bVar1) {
    param_3[2] = param_3[2] | 0x20;
  }
  *param_3 = iVar4;
  param_3[1] = (int)local_b8;
  param_3[3] = 2;
  return 0;
}




int FUN_00042f48(int param_1,int *param_2)

{
  undefined2 uVar1;
  int iVar2;
  char *pcVar3;
  char cVar4;
  char *pcVar5;
  uint uVar6;
  uint uVar7;
  int iVar8;
  int iVar9;
  
  if ((*(char **)(param_1 + 0x14) == (char *)0x0) || (cVar4 = **(char **)(param_1 + 0x14), cVar4 == '\0')) {
    uVar6 = *(uint *)(param_1 + 0x10);
    if (*(uint *)(param_1 + 4) <= uVar6) {
      return 1;
    }
    uVar7 = *(uint *)(param_1 + 0xc);
    pcVar5 = *(char **)(*(int *)(param_1 + 8) + uVar6 * 4);
    *(char **)(param_1 + 0x14) = pcVar5;
    if ((uVar7 & 3) == 0) {
      *(uint *)(param_1 + 0x10) = uVar6 + 1;
      pcVar3 = pcVar5;
      if (*pcVar5 == '-') {
        do {
          pcVar5 = pcVar5 + 1;
        } while (*pcVar5 == '-');
        uVar1 = *(undefined2 *)(param_1 + 0x62);
        *(undefined2 *)(param_1 + 0x62) = 0x8000;
        iVar2 = FUN_00042bb4(param_1,pcVar5,param_2);
        *(undefined2 *)(param_1 + 0x62) = uVar1;
      }
      else {
LAB_00043078:
        iVar2 = FUN_00042bb4(param_1,pcVar3,param_2);
      }
    }
    else {
      pcVar3 = pcVar5 + 1;
      cVar4 = *pcVar5;
      *(char **)(param_1 + 0x14) = pcVar3;
      if (cVar4 != '-') {
        return 1;
      }
      if (pcVar5[1] == '\0') {
        return 1;
      }
      *(uint *)(param_1 + 0x10) = uVar6 + 1;
      cVar4 = pcVar5[1];
      if (cVar4 != '-') {
        if ((uVar7 & 2) == 0) goto LAB_00043078;
        goto LAB_000430bc;
      }
      *(char **)(param_1 + 0x14) = pcVar5 + 2;
      if (pcVar5[2] == '\0') {
        return 1;
      }
      if ((uVar7 & 1) == 0) {
        fprintf(stderr,DAT_0007b928,*(undefined4 *)(param_1 + 0x18),DAT_0007b92c,pcVar5);
        return -1;
      }
      iVar2 = FUN_00042bb4(param_1,pcVar5 + 2,param_2);
    }
  }
  else {
LAB_000430bc:
    iVar2 = FUN_00041f8c(param_1,cVar4,param_2);
  }
  if (iVar2 != 0) {
    return iVar2;
  }
  uVar6 = param_2[2];
  iVar2 = *param_2;
  if (((uVar6 & 4) != 0) && ((*(uint *)(iVar2 + 0x10) & 0x2000000) != 0)) {
    fprintf(stderr,DAT_0007b98c,*(undefined4 *)(iVar2 + 0x34));
    return -1;
  }
  uVar7 = *(uint *)(iVar2 + 0x10) & 0xffffff80 | uVar6;
  param_2[2] = uVar7;
  if (((uVar6 & 0x20) != 0) || ((uVar7 & 0xf000) == 0)) {
    if (param_2[3] == 1) {
      *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
      return 0;
    }
    if (param_2[1] == 0) {
      *(undefined4 *)(param_1 + 0x14) = 0;
      return 0;
    }
    fprintf(stderr,DAT_0007b950,*(undefined4 *)(param_1 + 0x18),*(undefined4 *)(iVar2 + 0x34));
    return -1;
  }
  if ((uVar7 & 0x10000) == 0) {
    if (param_2[3] == 1) {
      iVar8 = *(int *)(param_1 + 0x14);
      iVar9 = iVar8 + 1;
      *(int *)(param_1 + 0x14) = iVar9;
      if (*(char *)(iVar8 + 1) == '\0') {
        uVar6 = *(int *)(param_1 + 0x10) + 1;
        iVar9 = *(int *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x10) * 4);
        *(uint *)(param_1 + 0x10) = uVar6;
        *(int *)(param_1 + 0x14) = iVar9;
      }
      else {
        uVar6 = *(uint *)(param_1 + 0x10);
      }
      param_2[1] = iVar9;
    }
    else if ((param_2[3] == 2) && (param_2[1] == 0)) {
      uVar6 = *(int *)(param_1 + 0x10) + 1;
      param_2[1] = *(int *)(*(int *)(param_1 + 8) + *(int *)(param_1 + 0x10) * 4);
      *(uint *)(param_1 + 0x10) = uVar6;
    }
    else {
      uVar6 = *(uint *)(param_1 + 0x10);
    }
    if (*(uint *)(param_1 + 4) < uVar6) {
      fprintf(stderr,DAT_0007b940,*(undefined4 *)(param_1 + 0x18),*(undefined4 *)(iVar2 + 0x34));
      return -1;
    }
    goto LAB_000430d4;
  }
  if (param_2[3] == 1) {
    iVar9 = *(int *)(param_1 + 0x14);
    iVar2 = iVar9 + 1;
    *(int *)(param_1 + 0x14) = iVar2;
    if (*(char *)(iVar9 + 1) != '\0') {
      param_2[1] = iVar2;
      goto LAB_000430d4;
    }
    iVar2 = *(int *)(param_1 + 0x10);
    pcVar5 = *(char **)(*(int *)(param_1 + 8) + iVar2 * 4);
    if ((pcVar5 == (char *)0x0) || (*pcVar5 == '-')) {
      param_2[1] = 0;
      goto LAB_000430d4;
    }
  }
  else {
    if (param_2[3] != 2) {
      fputs(DAT_0007b874,stderr);
                    /* WARNING: Subroutine does not return */
      exit(0x46);
    }
    if ((param_2[1] != 0) || ((*(uint *)(param_1 + 0xc) & 3) == 0)) goto LAB_000430d4;
    iVar2 = *(int *)(param_1 + 0x10);
    pcVar5 = *(char **)(*(int *)(param_1 + 8) + iVar2 * 4);
    if ((pcVar5 == (char *)0x0) || (*pcVar5 == '-')) goto LAB_000430d4;
  }
  *(int *)(param_1 + 0x10) = iVar2 + 1;
  param_2[1] = (int)pcVar5;
LAB_000430d4:
  *(undefined4 *)(param_1 + 0x14) = 0;
  return 0;
}




undefined4 FUN_000432e0(int param_1)

{
  int iVar1;
  int local_28 [5];
  
LAB_000432fc:
  do {
    local_28[0] = 0;
    local_28[1] = 0;
    local_28[2] = 4;
    local_28[3] = 0;
    iVar1 = FUN_00042f48(param_1,local_28);
    if (iVar1 == -1) goto LAB_000433a0;
    if (iVar1 == 1) {
      return 0;
    }
    if (((local_28[2] & 0x20020U) != 0) && ((local_28[2] & 0x40020U) != 0x20)) {
      if (((local_28[2] & 0x400020U) != 0x400000) && ((local_28[2] & 0x800020U) != 0x800020)) goto LAB_000432fc;
      *(short *)(local_28[0] + 0xe) = *(short *)(local_28[0] + 0xe) + -1;
    }
    iVar1 = FUN_000429c8(param_1,local_28);
    if (iVar1 != 0) {
LAB_000433a0:
      if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
        (**(code **)(param_1 + 0x54))(param_1,1);
      }
      return 0xffffffff;
    }
  } while( true );
}




undefined4 FUN_000433d8(uint *param_1,char *param_2)

{
  byte bVar1;
  byte bVar2;
  undefined4 uVar3;
  char *pcVar4;
  byte *pbVar5;
  uint uVar6;
  
  if (param_1 == (uint *)0x0) {
    fputs(DAT_0007b858,stderr);
                    /* WARNING: Subroutine does not return */
    exit(0x4e);
  }
  uVar6 = param_1[3];
  if (((uVar6 & 0x2000) != 0) && ((code *)param_1[0x16] != (code *)0x0)) {
    if ((uVar6 & 0x30000) == 0x20000) {
      param_1[3] = uVar6 | 0x10000;
    }
    (*(code *)param_1[0x16])();
    param_1[3] = param_1[3] & 0xffffdfff;
  }
  uVar6 = *param_1;
  if ("ysconf" < (char *)(uVar6 - 0x19000)) {
    fprintf(stderr,DAT_0007b860,param_2,(int)uVar6 >> 0xc,(uVar6 << 0x14) >> 0x1b,uVar6 & 0x7f);
    pcVar4 = DAT_0007b85c;
    if ((int)*param_1 < 0x23001) {
      pcVar4 = DAT_0007b868;
    }
    fputs(pcVar4,stderr);
    fwrite("AO_CURRENT:AO_REVISION:AO_AGE\n",0x1e,1,stderr);
    uVar3 = 0xffffffff;
  }
  else {
    if (param_1[7] == 0) {
      pcVar4 = strrchr(param_2,0x2f);
      param_1[6] = (uint)param_2;
      if (pcVar4 == (char *)0x0) {
        param_1[7] = (uint)param_2;
      }
      else {
        param_1[7] = (uint)(pcVar4 + 1);
      }
      if (DAT_0007ba14 != (byte *)0x0) {
        bVar1 = *DAT_0007ba14;
        pbVar5 = DAT_0007ba14;
        bVar2 = bVar1;
        while (uVar6 = (uint)bVar2, uVar6 != 0) {
          pbVar5 = pbVar5 + 1;
          bVar2 = *pbVar5;
          (&DAT_0007ba70)[uVar6] = bVar1;
        }
      }
    }
    uVar3 = 0;
  }
  return uVar3;
}




void FUN_00043530(FILE *param_1,int param_2,int param_3,int *param_4)

{
  uint *puVar1;
  int *piVar2;
  char *pcVar3;
  uint *puVar4;
  int iVar5;
  undefined4 uVar6;
  uint __c;
  byte *pbVar7;
  int iVar9;
  undefined4 uVar10;
  byte *pbVar8;
  
  param_2 = param_2 + -1;
  if (-1 < param_2) {
    do {
      _IO_putc(0x20,param_1);
      param_2 = param_2 + -1;
      _IO_putc(0x20,param_1);
    } while (param_2 != -1);
  }
  switch(*param_4) {
  case 1:
    iVar9 = param_4[1];
    fprintf(param_1,"<%s>",iVar9);
    pbVar8 = (byte *)(param_4 + 2);
    break;
  case 2:
  case 4:
    if (param_3 != 0) {
      pcVar3 = "keyword";
      if (*param_4 != 2) {
        pcVar3 = "set-membership";
      }
      uVar6 = *(undefined4 *)(param_3 + 0x10);
      uVar10 = *(undefined4 *)(param_3 + 0x18);
      fprintf(param_1,"<%s type=%s>",param_4[1],pcVar3);
      (**(code **)(param_3 + 0x28))(3,param_3);
      if ((*(char **)(param_3 + 0x18) != (char *)0x0) && (fputs(*(char **)(param_3 + 0x18),param_1), *param_4 != 2)) {
        free(*(void **)(param_3 + 0x18));
      }
      *(undefined4 *)(param_3 + 0x18) = uVar10;
      iVar9 = param_4[1];
      *(undefined4 *)(param_3 + 0x10) = uVar6;
      fprintf(param_1,"</%s>\n",iVar9);
      return;
    }
  case 5:
    fprintf(param_1,"<%1$s type=integer>0x%2$lX</%1$s>\n",param_4[1],param_4[2]);
    return;
  case 3:
    pcVar3 = "false";
    if (param_4[2] != 0) {
      pcVar3 = "true";
    }
    fprintf(param_1,"<%1$s type=boolean>%2$s</%1$s>\n",param_4[1],pcVar3);
    return;
  case 6:
    piVar2 = (int *)param_4[2];
    iVar9 = param_4[1];
    if (piVar2 == (int *)0x0) {
      return;
    }
    iVar5 = *piVar2;
    if (iVar5 < 1) {
      fprintf(param_1,"<%s/>\n",iVar9);
      return;
    }
    fprintf(param_1,"<%s type=nested>\n",iVar9);
    iVar5 = iVar5 + -1;
    DAT_0007bb70 = DAT_0007bb70 + 1;
    piVar2 = piVar2 + 2;
    do {
      iVar5 = iVar5 + -1;
      FUN_00043530(param_1,DAT_0007bb70,0,*piVar2);
      piVar2 = piVar2 + 1;
    } while (iVar5 != -1);
    iVar5 = DAT_0007bb70 + -2;
    DAT_0007bb70 = DAT_0007bb70 + -1;
    if (-1 < iVar5) {
      do {
        _IO_putc(0x20,param_1);
        iVar5 = iVar5 + -1;
        _IO_putc(0x20,param_1);
      } while (iVar5 != -1);
    }
    fprintf(param_1,"</%s>\n",iVar9);
    return;
  default:
    fprintf(param_1,"<%s/>\n",param_4[1]);
    return;
  }
  do {
    while( true ) {
      pbVar7 = pbVar8 + 1;
      __c = (uint)*pbVar8;
      pbVar8 = pbVar7;
      if (__c != 0x26) break;
LAB_0004375c:
      _IO_putc(0x26,param_1);
      if (__c == 0x26) {
        puVar1 = (uint *)&DAT_00069c78;
LAB_000437ec:
        fputs((char *)(puVar1 + 2),param_1);
      }
      else {
        puVar1 = &DAT_00069c88;
        do {
          puVar4 = puVar1 + 4;
          if (__c == *puVar1) goto LAB_000437ec;
          puVar1 = puVar4;
        } while (puVar4 != (uint *)"<%s/>\n");
        fprintf(param_1,"#x%02X;",__c);
      }
    }
    if (__c < 0x27) {
      if (__c == 0) {
        fprintf(param_1,"</%s>\n",iVar9);
        return;
      }
      if (0x1f < __c) goto LAB_000437b8;
      goto LAB_0004375c;
    }
    if (__c == 0x3e) goto LAB_0004375c;
    if (0x3e < __c) {
      if (__c < 0x7f) goto LAB_000437b8;
      goto LAB_0004375c;
    }
    if (__c == 0x3c) goto LAB_0004375c;
LAB_000437b8:
    _IO_putc(__c,param_1);
  } while( true );
}




void FUN_00043854(int param_1,int param_2)

{
  int iVar1;
  code *pcVar2;
  
  pcVar2 = *(code **)(param_2 + 0x28);
  if (pcVar2 == FUN_00042398) {
    printf("            echo \"$%s_%s_TEXT\"\n            exit 0\n",*(undefined4 *)(param_1 + 0x20),"VERSION");
  }
  else if (pcVar2 == FUN_0004520c) {
    printf("            echo \"$%s_LONGUSAGE_TEXT\" | ${PAGER-more}\n            exit 0\n",
           *(undefined4 *)(param_1 + 0x20));
  }
  else if (pcVar2 == FUN_0004b584) {
    printf("            %s\n","echo \'Warning:  Cannot load options files\' >&2");
    printf("            %s\n","OPT_ARG_NEEDED=YES");
  }
  else {
    iVar1 = *(int *)(param_2 + 0x30);
    if (iVar1 == 0) {
      if (pcVar2 == (code *)0x0) {
        printf("            %s\n","echo \'Warning:  Cannot save options files\' >&2");
        printf("            %s\n","OPT_ARG_NEEDED=OK");
      }
      else {
        printf("            echo \"$%s_%s_TEXT\"\n            exit 0\n",*(undefined4 *)(param_1 + 0x20),"LONGUSAGE");
      }
    }
    else {
      if (*(short *)(param_2 + 0xc) == 1) {
        printf("            if [ -n \"${%1$s_%2$s}\" ] && ${%1$s_%2$s_set} ; then\n                echo Error:  duplicate %2$s option >&2\n                echo \"$%1$s_USAGE_TEXT\"\n                exit 1 ; fi\n            %1$s_%2$s_set=true\n            OPT_NAME=\'%2$s\'\n"
               ,*(undefined4 *)(param_1 + 0x20));
      }
      else {
        if (*(short *)(param_2 + 0xc) != -1) {
          printf("            if [ $%1$s_%2$s_CT -ge %3$d ] ; then\n                echo Error:  more than %3$d %2$s options >&2\n                echo \"$%1$s_USAGE_TEXT\"\n                exit 1 ; fi\n"
                 ,*(undefined4 *)(param_1 + 0x20));
          iVar1 = *(int *)(param_2 + 0x30);
        }
        printf("            %1$s_%2$s_CT=`expr ${%1$s_%2$s_CT} + 1`\n            OPT_ELEMENT=\"_${%1$s_%2$s_CT}\"\n            OPT_NAME=\'%2$s\'\n"
               ,*(undefined4 *)(param_1 + 0x20),iVar1);
      }
      if ((*(uint *)(param_2 + 0x10) & 0xf000) == 0) {
        printf("            eval %1$s_%2$s${OPT_ELEMENT}=true\n            export %1$s_%2$s${OPT_ELEMENT}\n            OPT_ARG_NEEDED=NO\n"
               ,*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(param_2 + 0x30));
      }
      else if ((*(uint *)(param_2 + 0x10) & 0x10000) == 0) {
        fwrite("            OPT_ARG_NEEDED=YES\n",1,0x1f,stdout);
      }
      else {
        printf("            eval %1$s_%2$s${OPT_ELEMENT}=true\n            export %1$s_%2$s${OPT_ELEMENT}\n            OPT_ARG_NEEDED=OK\n"
               ,*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(param_2 + 0x30));
      }
    }
  }
  fwrite("            ;;\n\n",1,0x10,stdout);
  return;
}




void FUN_00043a28(int param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  
  iVar3 = *(int *)(param_1 + 100);
  iVar2 = *(int *)(param_1 + 0x44);
  fwrite("        case \"${OPT_CODE}\" in\n",1,0x1e,stdout);
  if (0 < iVar3) {
    do {
      if ((((*(uint *)(iVar2 + 0x10) & 0x280000) == 0) && (uVar1 = *(ushort *)(iVar2 + 2) & 0xff, uVar1 < 0x80)) &&
         ((*(uint *)(&DAT_00069a0c + uVar1 * 4) & 0x2000) != 0)) {
        printf("        \'%c\' )\n");
        FUN_00043854(param_1,iVar2);
      }
      iVar3 = iVar3 + -1;
      iVar2 = iVar2 + 0x40;
    } while (iVar3 != 0);
  }
  printf("        * )\n            echo Unknown %s: \"${OPT_CODE}\" >&2\n            echo \"$%s_USAGE_TEXT\"\n            exit 1\n            ;;\n        esac\n\n"
         ,&DAT_0006d0e4,*(undefined4 *)(param_1 + 0x20),param_4);
  return;
}




void FUN_00043ad0(byte *param_1,int param_2,int param_3)

{
  byte bVar1;
  __int32_t **pp_Var2;
  byte *pbVar3;
  byte *pbVar4;
  __int32_t *p_Var5;
  uint uVar6;
  int iVar7;
  byte *pbVar8;
  uint uVar9;
  int iVar10;
  byte local_120 [260];
  
  iVar10 = *(int *)(param_3 + 100);
  uVar9 = 1;
  iVar7 = *(int *)(param_3 + 0x44);
  do {
    iVar10 = iVar10 + -1;
    if ((param_2 != iVar7) && ((*(uint *)(iVar7 + 0x10) & 0x280000) == 0)) {
      pp_Var2 = __ctype_toupper_loc();
      p_Var5 = *pp_Var2;
      uVar6 = 0;
      while (p_Var5[*(byte *)(*(int *)(iVar7 + 0x34) + uVar6)] == p_Var5[param_1[uVar6]]) {
        uVar6 = uVar6 + 1;
      }
      pbVar3 = *(byte **)(iVar7 + 0x38);
      if ((int)uVar9 < (int)uVar6) {
        uVar9 = uVar6;
      }
      if (pbVar3 != (byte *)0x0) {
        if (p_Var5[*pbVar3] == p_Var5[*param_1]) {
          uVar6 = 0;
          pbVar4 = param_1;
          do {
            pbVar3 = pbVar3 + 1;
            uVar6 = uVar6 + 1;
            pbVar4 = pbVar4 + 1;
          } while (p_Var5[*pbVar3] == p_Var5[*pbVar4]);
        }
        else {
          uVar6 = 0;
        }
        if ((int)uVar9 < (int)uVar6) {
          uVar9 = uVar6;
        }
      }
    }
    iVar7 = iVar7 + 0x40;
  } while (0 < iVar10);
  if ((param_1[uVar9] == 0) || (param_1[uVar9 + 1] == 0)) {
    printf("        \'%s\' )\n",param_1);
  }
  else {
    iVar7 = 0;
    do {
      local_120[iVar7] = param_1[iVar7];
      iVar7 = iVar7 + 1;
    } while (iVar7 <= (int)uVar9);
    uVar9 = uVar9 & ~((int)uVar9 >> 0x1f);
    pbVar3 = param_1 + uVar9;
    pbVar4 = local_120 + uVar9 + 1;
    do {
      *pbVar4 = 0;
      printf("        \'%s\' | \\\n",local_120);
      bVar1 = pbVar3[2];
      pbVar8 = pbVar4 + 1;
      *pbVar4 = pbVar3[1];
      pbVar3 = pbVar3 + 1;
      pbVar4 = pbVar8;
    } while (bVar1 != 0);
    *pbVar8 = 0;
    printf("        \'%s\' )\n",local_120);
  }
  return;
}




void FUN_00043c4c(int param_1)

{
  char *__format;
  int iVar1;
  int iVar2;
  
  iVar1 = *(int *)(param_1 + 0x44);
  iVar2 = *(int *)(param_1 + 100);
  fwrite("        case \"${OPT_CODE}\" in\n",1,0x1e,stdout);
  do {
    if ((*(uint *)(iVar1 + 0x10) & 0x280000) == 0) {
      FUN_00043ad0(*(undefined4 *)(iVar1 + 0x34),iVar1,param_1);
      FUN_00043854(param_1,iVar1);
      if (*(int *)(iVar1 + 0x38) != 0) {
        FUN_00043ad0(*(int *)(iVar1 + 0x38),iVar1,param_1);
        __format = 
        "            %1$s_%2$s_CT=0\n            OPT_ELEMENT=\'\'\n            %1$s_%2$s=\'%3$s\'\n            export %1$s_%2$s\n            OPT_NAME=\'%2$s\'\n"
        ;
        if (*(code **)(iVar1 + 0x28) == FUN_0004b584) {
          printf("            %s\n","echo \'Warning:  Cannot suppress the loading of options files\' >&2");
        }
        else {
          if (*(short *)(iVar1 + 0xc) == 1) {
            __format = 
            "            if [ -n \"${%1$s_%2$s}\" ] && ${%1$s_%2$s_set} ; then\n                echo Error:  duplicate %2$s option >&2\n                echo \"$%1$s_USAGE_TEXT\"\n                exit 1 ; fi\n            %1$s_%2$s_set=true\n            %1$s_%2$s=\'%3$s\'\n            export %1$s_%2$s\n            OPT_NAME=\'%2$s\'\n"
            ;
          }
          printf(__format,*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(iVar1 + 0x30),*(undefined4 *)(iVar1 + 0x3c));
        }
        printf("            %s\n","OPT_ARG_NEEDED=NO");
        fwrite("            ;;\n\n",1,0x10,stdout);
      }
    }
    iVar1 = iVar1 + 0x40;
    iVar2 = iVar2 + -1;
  } while (0 < iVar2);
  printf("        * )\n            echo Unknown %s: \"${OPT_CODE}\" >&2\n            echo \"$%s_USAGE_TEXT\"\n            exit 1\n            ;;\n        esac\n\n"
         ,"option",*(undefined4 *)(param_1 + 0x20));
  return;
}




void FUN_00043d78(int param_1,int param_2)

{
  byte bVar1;
  int *piVar2;
  int iVar3;
  byte *pbVar4;
  byte *local_1c [2];
  
  if (param_2 == 0) {
    return;
  }
  if (*(int *)(param_2 + 0x18) == 0) {
    return;
  }
  if ((*(uint *)(param_2 + 0x10) & 8) != 0) {
    return;
  }
  piVar2 = __errno_location();
  *piVar2 = 0;
  iVar3 = strtol(*(char **)(param_2 + 0x18),(char **)local_1c,0);
  if ((*(byte **)(param_2 + 0x18) == local_1c[0]) || (*piVar2 != 0)) goto LAB_00043e44;
  if ((*(uint *)(param_2 + 0x10) & 0x1000000) != 0) {
    pbVar4 = local_1c[0] + 1;
    bVar1 = *local_1c[0];
    if (bVar1 == 0x54) {
      iVar3 = 0;
LAB_00043e28:
      iVar3 = iVar3 << 10;
LAB_00043e2c:
      iVar3 = iVar3 << 10;
    }
    else {
      if (0x54 < bVar1) {
        if (bVar1 != 0x6b) {
          if (bVar1 < 0x6c) {
            local_1c[0] = pbVar4;
            if (bVar1 != 0x67) goto LAB_00043e44;
LAB_00043eb0:
            iVar3 = iVar3 * 1000;
          }
          else if (bVar1 != 0x6d) {
            local_1c[0] = pbVar4;
            if (bVar1 != 0x74) goto LAB_00043e44;
            iVar3 = iVar3 * 1000;
            goto LAB_00043eb0;
          }
          iVar3 = iVar3 * 1000;
        }
        iVar3 = iVar3 * 1000;
        local_1c[0] = pbVar4;
        goto LAB_00043e38;
      }
      if (bVar1 != 0x4b) {
        if (bVar1 < 0x4c) {
          if (bVar1 == 0) goto LAB_00043e38;
          local_1c[0] = pbVar4;
          if (bVar1 != 0x47) goto LAB_00043e44;
          goto LAB_00043e28;
        }
        local_1c[0] = pbVar4;
        if (bVar1 != 0x4d) goto LAB_00043e44;
        goto LAB_00043e2c;
      }
    }
    iVar3 = iVar3 << 10;
    local_1c[0] = pbVar4;
  }
LAB_00043e38:
  if (*local_1c[0] == 0) {
    if ((*(uint *)(param_2 + 0x10) & 0x40) != 0) {
      free(*(byte **)(param_2 + 0x18));
      *(uint *)(param_2 + 0x10) = *(uint *)(param_2 + 0x10) & 0xffffffbf;
    }
    *(int *)(param_2 + 0x18) = iVar3;
    return;
  }
LAB_00043e44:
  fprintf(stderr,PTR_s__s_error____s__is_not_a_recogniz_0007b998,*(undefined4 *)(param_1 + 0x1c));
  if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
    (**(code **)(param_1 + 0x54))(param_1,1);
  }
  *piVar2 = 0x16;
  *(undefined4 *)(param_2 + 0x18) = 0xffffffff;
  return;
}




uint FUN_00043f28(byte *param_1,undefined4 param_2,undefined4 param_3,int param_4,uint param_5)

{
  size_t __n;
  int iVar1;
  ulong uVar2;
  uint uVar3;
  uint uVar4;
  undefined4 *puVar5;
  char *__s1;
  bool bVar6;
  byte *local_2c [2];
  
  __n = strlen((char *)param_1);
  if ((*param_1 < 0x80) && ((*(uint *)(&DAT_00069a0c + (uint)*param_1 * 4) & 0xc) != 0)) {
    local_2c[0] = param_1;
    uVar2 = strtoul((char *)param_1,(char **)local_2c,0);
    if ((*local_2c[0] == 0) && (uVar2 < param_5)) {
      return uVar2;
    }
    FUN_000426a4(param_2,param_3,param_4,param_5);
    return param_5;
  }
  if (param_5 != 0) {
    puVar5 = (undefined4 *)(param_4 + -4);
    uVar3 = 0;
    uVar4 = param_5;
    do {
      puVar5 = puVar5 + 1;
      __s1 = (char *)*puVar5;
      iVar1 = strncmp(__s1,(char *)param_1,__n);
      if (iVar1 == 0) {
        if (__s1[__n] == '\0') {
          return uVar3;
        }
        bVar6 = uVar4 != param_5;
        uVar4 = uVar3;
        if (bVar6) {
          uVar4 = 0xffffffff;
        }
      }
      uVar3 = uVar3 + 1;
    } while (uVar3 != param_5);
    if (uVar4 < param_5) {
      return uVar4;
    }
    DAT_000c9a9c = DAT_0007b884;
    if (uVar4 != param_5) goto LAB_00043fd4;
  }
  DAT_000c9a9c = DAT_0007b964;
LAB_00043fd4:
  DAT_000c9a98 = stderr;
  FUN_000426a4(param_2,param_3,param_4,param_5);
  return param_5;
}




void FUN_00044070(FILE *param_1,int param_2,int param_3)

{
  FILE *pFVar1;
  int iVar2;
  __pid_t _Var3;
  int iVar4;
  int *piVar5;
  char *pcVar6;
  undefined *puVar7;
  int __c;
  char *pcVar8;
  int local_28;
  int local_24;
  
  fflush(stdout);
  fflush(stderr);
  iVar2 = pipe(&local_28);
  pFVar1 = stderr;
  pcVar8 = DAT_0007b898;
  if (iVar2 != 0) {
    piVar5 = __errno_location();
    iVar2 = *piVar5;
    pcVar6 = strerror(iVar2);
    fprintf(pFVar1,pcVar8,iVar2,pcVar6);
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  _Var3 = fork();
  pFVar1 = stderr;
  pcVar8 = DAT_0007b8e0;
  if (_Var3 == -1) {
    piVar5 = __errno_location();
    iVar2 = *piVar5;
    pcVar6 = strerror(iVar2);
    fprintf(pFVar1,pcVar8,iVar2,pcVar6,param_1->_IO_buf_base);
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  iVar2 = 0;
  if (_Var3 != 0) {
    close(local_24);
    pcVar8 = param_1->_IO_buf_end;
    puVar7 = (&PTR_s_LONGUSAGE_0006a3b8)[param_2];
    param_1 = fdopen(local_28,"r");
    printf("%s_%s_TEXT=\'",pcVar8,puVar7);
    if (param_1 != (FILE *)0x0) goto LAB_00044104;
    goto LAB_000441d8;
  }
  dup2(local_24,2);
  dup2(local_24,1);
  close(local_28);
  if (param_2 == 1) {
LAB_00044188:
    (**(code **)((int)&param_1->_offset + 4))(param_1,1);
  }
  else {
    if (param_2 == 0) {
      (**(code **)((int)&param_1->_offset + 4))(param_1,0);
      goto LAB_00044188;
    }
    if (param_2 != 2) {
                    /* WARNING: Subroutine does not return */
      exit(1);
    }
  }
  if ((*(uint *)(param_3 + 0x10) & 0x40) != 0) {
    free(*(void **)(param_3 + 0x18));
    *(uint *)(param_3 + 0x10) = *(uint *)(param_3 + 0x10) & 0xffffffbf;
  }
  *(char **)(param_3 + 0x18) = "c";
  iVar4 = FUN_00042398(param_1,param_3);
  __c = 0;
  while (iVar4 != -1) {
    if (iVar4 != 10) goto joined_r0x00044120;
    iVar2 = iVar2 + 1;
LAB_00044104:
    while( true ) {
      while (iVar4 = fgetc(param_1), iVar4 == 0x27) {
        for (; iVar2 != 0; iVar2 = iVar2 + -1) {
          fputc(10,stdout);
        }
        fwrite(&DAT_0006d154,1,4,stdout);
        iVar2 = 0;
      }
      __c = iVar4;
      if (iVar4 < 0x28) break;
joined_r0x00044120:
      for (; iVar2 != 0; iVar2 = iVar2 + -1) {
        fputc(10,stdout);
      }
      fputc(__c,stdout);
      iVar2 = 0;
    }
  }
  fclose(param_1);
LAB_000441d8:
  fwrite(&DAT_0006d15c,1,3,stdout);
  return;
}




byte * FUN_000442f0(byte *param_1)

{
  ushort **ppuVar1;
  size_t sVar2;
  byte *__s;
  byte *pbVar3;
  ushort *puVar4;
  
  ppuVar1 = __ctype_b_loc();
  puVar4 = *ppuVar1;
  do {
    __s = param_1;
    param_1 = __s + 1;
  } while ((puVar4[*__s] & 0x2000) != 0);
  sVar2 = strlen((char *)__s);
  pbVar3 = __s + sVar2;
  if (__s < pbVar3) {
    do {
      if ((puVar4[pbVar3[-1]] & 0x2000) == 0) break;
      pbVar3 = pbVar3 + -1;
    } while (pbVar3 != __s);
  }
  *pbVar3 = 0;
  return __s;
}




void FUN_00044368(char *param_1)

{
  char *pcVar1;
  char cVar2;
  char *pcVar3;
  
  if ((param_1 == (char *)0x0) || (*param_1 == '\0')) {
    fwrite(&DAT_0006d164,1,2,stdout);
    return;
  }
  if (*param_1 == '\'') {
    pcVar1 = param_1 + 1;
    do {
      param_1 = pcVar1;
      fwrite(&DAT_0006d160,1,2,stdout);
      pcVar1 = param_1 + 1;
    } while (*param_1 == '\'');
    if (*param_1 == '\0') {
      return;
    }
  }
  do {
    fputc(0x27,stdout);
    pcVar1 = strchr(param_1,0x27);
    if (pcVar1 == (char *)0x0) {
      fputs(param_1,stdout);
      fputc(0x27,stdout);
      return;
    }
    pcVar3 = pcVar1 + 1;
    fwrite(param_1,(int)pcVar1 - (int)param_1,1,stdout);
    fputc(0x27,stdout);
    cVar2 = pcVar1[1];
    if (cVar2 == '\'') {
      pcVar1 = pcVar1 + 2;
      do {
        pcVar3 = pcVar1;
        fwrite(&DAT_0006d160,1,2,stdout);
        cVar2 = *pcVar3;
        pcVar1 = pcVar3 + 1;
      } while (cVar2 == '\'');
    }
    param_1 = pcVar3;
  } while (cVar2 != '\0');
  return;
}




void FUN_00044484(size_t param_1)

{
  void *pvVar1;
  
  pvVar1 = malloc(param_1);
  if (pvVar1 != (void *)0x0) {
    return;
  }
  fprintf(stderr,DAT_0007b854,param_1);
                    /* WARNING: Subroutine does not return */
  exit(1);
}




void FUN_000444c0(undefined4 *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int *__ptr;
  size_t __size;
  
  __ptr = (int *)*param_1;
  if (__ptr == (int *)0x0) {
    piVar1 = (int *)FUN_00044484(0x20);
    if (piVar1 == (int *)0x0) {
      return;
    }
    iVar3 = 0;
    piVar1[1] = 6;
    iVar2 = 1;
    *piVar1 = 0;
    *param_1 = piVar1;
  }
  else {
    iVar3 = *__ptr;
    iVar2 = __ptr[1];
    piVar1 = __ptr;
    if (iVar2 <= iVar3) {
      __size = iVar2 * 4 + 0x28;
      __ptr[1] = iVar2 + 8;
      piVar1 = (int *)realloc(__ptr,__size);
      if (piVar1 == (int *)0x0) {
        fprintf(stderr,DAT_0007b864,__size,__ptr,param_4);
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      iVar3 = *piVar1;
      *param_1 = piVar1;
    }
    iVar2 = iVar3 + 1;
  }
  *piVar1 = iVar2;
  piVar1[iVar3 + 2] = param_2;
  return;
}




char * FUN_00044588(int param_1,int *param_2)

{
  FILE *pFVar1;
  int iVar2;
  int *piVar3;
  char *pcVar4;
  char *__s;
  size_t sVar5;
  size_t sVar6;
  char *pcVar7;
  undefined4 *puVar8;
  char *pcVar9;
  int iVar10;
  uint uVar11;
  stat sStack_1078;
  char acStack_1020 [4096];
  
  if ((*(ushort *)(param_1 + 0x5e) & 0x7fff) == 0) {
    return (char *)0x0;
  }
  pcVar9 = *(char **)(*(int *)(param_1 + 0x44) + (uint)*(ushort *)(param_1 + 0x5e) * 0x40 + 0x18);
  if ((pcVar9 == (char *)0x0) || (*pcVar9 == '\0')) {
    puVar8 = *(undefined4 **)(param_1 + 0x34);
    if (puVar8 == (undefined4 *)0x0) {
      return (char *)0x0;
    }
    for (; puVar8[1] != 0; puVar8 = puVar8 + 1) {
    }
    pcVar9 = (char *)*puVar8;
    if (*pcVar9 != '$') goto LAB_000445fc;
    pcVar4 = pcVar9 + 1;
    pcVar7 = strchr(pcVar4,0x2f);
    if (pcVar7 == (char *)0x0) {
      pcVar9 = getenv(pcVar4);
      iVar10 = 0;
      if (pcVar9 == (char *)0x0) goto LAB_000447ac;
    }
    else {
      sVar5 = (int)pcVar7 - (int)pcVar4;
      if (0x7f < (int)sVar5) {
        return (char *)0x0;
      }
      memcpy(acStack_1020,pcVar4,sVar5);
      acStack_1020[sVar5] = '\0';
      __s = getenv(acStack_1020);
      if (__s == (char *)0x0) {
LAB_000447ac:
        fprintf(stderr,"%s WARNING:  cannot save options - ",*(undefined4 *)(param_1 + 0x1c));
        fprintf(stderr,DAT_0007b988,pcVar4);
        return (char *)0x0;
      }
      sVar5 = strlen(__s);
      sVar6 = strlen(pcVar7);
      pcVar9 = (char *)FUN_00044484(sVar5 + sVar6 + 2);
      if (pcVar9 == (char *)0x0) {
        return (char *)0x0;
      }
      iVar10 = 1;
      sprintf(pcVar9,"%s/%s",__s,pcVar7);
    }
  }
  else {
LAB_000445fc:
    iVar10 = 0;
  }
  iVar2 = __xstat(3,pcVar9,&sStack_1078);
  pcVar7 = pcVar9;
  if (iVar2 == 0) {
    uVar11 = sStack_1078.st_mode & 0xf000;
    if (uVar11 == 0x4000) {
      sVar5 = strlen(pcVar9);
      sVar6 = strlen(*(char **)(param_1 + 0x24));
      sVar5 = sVar5 + sVar6 + 2;
      pcVar7 = (char *)FUN_00044484(sVar5);
      snprintf(pcVar7,sVar5,"%s/%s",pcVar9,*(undefined4 *)(param_1 + 0x24));
      if (iVar10 != 0) {
        free(pcVar9);
      }
      iVar10 = __xstat(3,pcVar7,&sStack_1078);
      if (iVar10 != 0) {
        piVar3 = __errno_location();
        if (*piVar3 != 2) {
          fprintf(stderr,"%s WARNING:  cannot save options - ",*(undefined4 *)(param_1 + 0x1c));
          pFVar1 = stderr;
          pcVar9 = DAT_0007b97c;
          iVar10 = *piVar3;
          pcVar4 = strerror(iVar10);
          fprintf(pFVar1,pcVar9,iVar10,pcVar4,pcVar7);
          free(pcVar7);
          return (char *)0x0;
        }
        sStack_1078.st_mode = 0x8000;
        iVar10 = 1;
        goto LAB_00044698;
      }
      iVar10 = 1;
      uVar11 = sStack_1078.st_mode & 0xf000;
    }
    if (uVar11 != 0x8000) {
      fprintf(stderr,"%s WARNING:  cannot save options - ",*(undefined4 *)(param_1 + 0x1c));
      fprintf(stderr,DAT_0007b994,pcVar7);
      if (iVar10 == 0) {
        return (char *)0x0;
      }
      free(pcVar7);
      return (char *)0x0;
    }
  }
  else {
    piVar3 = __errno_location();
    if (*piVar3 != 2) goto LAB_000447dc;
    pcVar4 = strrchr(pcVar9,0x2f);
    if (pcVar4 != (char *)0x0) {
      uVar11 = (int)pcVar4 - (int)pcVar9;
      if (0xfff < uVar11) {
LAB_000447dc:
        fprintf(stderr,"%s WARNING:  cannot save options - ",*(undefined4 *)(param_1 + 0x1c));
        pFVar1 = stderr;
        pcVar7 = DAT_0007b97c;
        iVar2 = *piVar3;
        pcVar4 = strerror(iVar2);
        fprintf(pFVar1,pcVar7,iVar2,pcVar4,pcVar9);
        if (iVar10 != 0) {
          free(pcVar9);
        }
        return (char *)0x0;
      }
      memcpy(acStack_1020,pcVar9,uVar11);
      acStack_1020[uVar11] = '\0';
      iVar2 = __xstat(3,acStack_1020,&sStack_1078);
      if ((iVar2 != 0) || ((sStack_1078.st_mode & 0xf000) != 0x4000)) goto LAB_000447dc;
    }
    sStack_1078.st_mode = 0x8000;
  }
LAB_00044698:
  unlink(pcVar7);
  *param_2 = iVar10;
  return pcVar7;
}




undefined4 * FUN_0004493c(undefined4 param_1,void *param_2,size_t param_3,char *param_4,int param_5)

{
  undefined4 *puVar1;
  undefined4 *__dest;
  int iVar2;
  ulong uVar3;
  char *__s2;
  char *pcVar4;
  char cVar5;
  char *__s1;
  char *pcVar6;
  int iVar7;
  char *pcVar8;
  char *pcVar9;
  size_t __n;
  char *local_2c [2];
  
  puVar1 = (undefined4 *)FUN_00044484(param_3 + 0xc + param_5);
  if (puVar1 != (undefined4 *)0x0) {
    if (param_4 == (char *)0x0) {
      __dest = puVar1 + 2;
      *puVar1 = 0;
      puVar1[1] = __dest;
    }
    else {
      if (param_5 == 0) {
        *(undefined1 *)(puVar1 + 2) = 0;
      }
      *puVar1 = 1;
      if (param_5 != 0) {
        iVar7 = param_5;
        pcVar8 = (char *)(puVar1 + 2);
        do {
          __s1 = param_4 + 1;
          cVar5 = *param_4;
          pcVar9 = pcVar8;
          if (cVar5 == '\0') break;
          pcVar4 = __s1;
          if ((cVar5 == '&') && (local_2c[0] = __s1, 2 < iVar7)) {
            if (param_4[1] == '#') {
              local_2c[0] = param_4 + 2;
              if (param_4[2] == 'x') {
                local_2c[0] = param_4 + 3;
                iVar2 = 0x10;
              }
              else {
                iVar2 = 10;
              }
              uVar3 = strtoul(local_2c[0],local_2c,iVar2);
              if (*local_2c[0] == ';') {
                pcVar4 = local_2c[0] + 1;
                if ((int)pcVar4 - (int)__s1 <= iVar7) {
                  iVar7 = iVar7 - ((int)pcVar4 - (int)__s1);
                  cVar5 = (char)uVar3;
                  goto LAB_000449c0;
                }
              }
              cVar5 = '&';
              pcVar4 = __s1;
            }
            else {
              pcVar9 = "<";
              do {
                __n = *(size_t *)(pcVar9 + -0xc);
                __s2 = pcVar9 + -8;
                pcVar6 = pcVar9 + -0x10;
                pcVar9 = pcVar9 + 0x10;
                if (((int)__n <= iVar7) && (iVar2 = strncmp(__s1,__s2,__n), iVar2 == 0)) {
                  iVar7 = iVar7 - __n;
                  cVar5 = *pcVar6;
                  pcVar4 = __s1 + __n;
                  goto LAB_000449c0;
                }
              } while (pcVar9 != "</%s>\n");
              cVar5 = '&';
            }
          }
LAB_000449c0:
          iVar7 = iVar7 + -1;
          pcVar9 = pcVar8 + 1;
          *pcVar8 = cVar5;
          pcVar8 = pcVar9;
          param_4 = pcVar4;
        } while (0 < iVar7);
        *pcVar9 = '\0';
      }
      __dest = (undefined4 *)((int)puVar1 + param_5 + 9);
      puVar1[1] = __dest;
    }
    memcpy(__dest,param_2,param_3);
    *(undefined1 *)(puVar1[1] + param_3) = 0;
    FUN_000444c0(param_1,puVar1);
  }
  return puVar1;
}




byte * FUN_00044bbc(int param_1,byte *param_2)

{
  byte bVar1;
  size_t sVar2;
  char *__needle;
  size_t sVar3;
  uint uVar4;
  byte *pbVar5;
  byte *pbVar6;
  byte *pbVar7;
  
  sVar2 = strlen(DAT_0007b8ac);
  __needle = (char *)FUN_00044484(sVar2 + 3);
  sVar3 = strlen(*(char **)(param_1 + 0x1c));
  __needle[0] = '<';
  __needle[1] = '?';
  memcpy(__needle + 2,DAT_0007b8ac,sVar2 + 1);
  pbVar6 = *(byte **)(param_1 + 0x1c);
LAB_00044c20:
  do {
    param_2 = param_2 + 1;
    uVar4 = (uint)*param_2;
    if (uVar4 < 0x80) {
      if ((*(uint *)(&DAT_00069a0c + uVar4 * 4) & 0x500) != 0) goto LAB_00044c20;
    }
    if ((int)sVar3 < 1) {
LAB_00044c9c:
      if ((param_2[sVar3] < 0x80) && ((*(uint *)(&DAT_00069a0c + (uint)param_2[sVar3] * 4) & 0x1500) != 0)) {
        free(__needle);
        pbVar6 = param_2 + sVar3;
        do {
          pbVar5 = pbVar6 + 1;
          bVar1 = *pbVar6;
          if (bVar1 == 0) {
            return (byte *)0x0;
          }
          pbVar6 = pbVar5;
        } while (bVar1 != 0x3e);
        return pbVar5;
      }
    }
    else if ((&DAT_0007ba70)[uVar4] == (&DAT_0007ba70)[*pbVar6]) {
      if (uVar4 != 0) {
        pbVar5 = param_2;
        pbVar7 = pbVar6;
        do {
          if (pbVar5 == param_2 + (sVar3 - 1)) break;
          pbVar5 = pbVar5 + 1;
          pbVar7 = pbVar7 + 1;
          if ((&DAT_0007ba70)[*pbVar5] != (&DAT_0007ba70)[*pbVar7]) goto LAB_00044cf4;
        } while (*pbVar5 != 0);
      }
      goto LAB_00044c9c;
    }
LAB_00044cf4:
    param_2 = (byte *)strstr((char *)param_2,__needle);
    if (param_2 == (byte *)0x0) {
      free(__needle);
      return (byte *)0x0;
    }
  } while( true );
}




void FUN_00044d28(char *param_1)

{
  int iVar1;
  size_t sVar2;
  
  iVar1 = __strdup();
  if (iVar1 != 0) {
    return;
  }
  sVar2 = strlen(param_1);
  fprintf(stderr,DAT_0007b86c,sVar2);
                    /* WARNING: Subroutine does not return */
  exit(1);
}




void FUN_00044e30(undefined4 param_1,int *param_2,byte *param_3,int param_4,int param_5)

{
  bool bVar1;
  undefined4 uVar2;
  byte *pbVar3;
  int iVar4;
  size_t sVar5;
  uint uVar6;
  undefined *puVar7;
  byte *pbVar8;
  uint uVar9;
  
  if ((*param_3 < 0x80) && ((*(uint *)(&DAT_00069a0c + (uint)*param_3 * 4) & 0x500) != 0)) {
    pbVar3 = param_3 + 1;
    do {
      param_3 = pbVar3;
      if (0x7f < *param_3) break;
      pbVar3 = param_3 + 1;
    } while ((*(uint *)(&DAT_00069a0c + (uint)*param_3 * 4) & 0x500) != 0);
  }
  pbVar3 = (byte *)strpbrk((char *)param_3," \t\n:=");
  if (pbVar3 == (byte *)0x0) {
    sVar5 = strlen((char *)param_3);
    pbVar8 = param_3 + sVar5;
  }
  else if (param_5 == 2) {
    pbVar8 = pbVar3 + 1;
    *pbVar3 = 0;
  }
  else {
    if (*pbVar3 < 0x80) {
      if ((*(uint *)(&DAT_00069a0c + (uint)*pbVar3 * 4) & 0x500) == 0) {
        bVar1 = false;
      }
      else {
        bVar1 = true;
      }
    }
    else {
      bVar1 = false;
    }
    pbVar8 = pbVar3 + 1;
    *pbVar3 = 0;
    uVar9 = (uint)pbVar3[1];
    if ((uVar9 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar9 * 4) & 0x500) != 0)) {
      pbVar3 = pbVar3 + 2;
      do {
        pbVar8 = pbVar3;
        uVar9 = (uint)*pbVar8;
        if (0x7f < uVar9) break;
        pbVar3 = pbVar8 + 1;
      } while ((*(uint *)(&DAT_00069a0c + uVar9 * 4) & 0x500) != 0);
    }
    if ((bVar1) && (uVar9 == 0x3a || uVar9 == 0x3d)) {
      do {
        pbVar8 = pbVar8 + 1;
        if (0x7f < *pbVar8) break;
      } while ((*(uint *)(&DAT_00069a0c + (uint)*pbVar8 * 4) & 0x500) != 0);
    }
  }
  iVar4 = FUN_00042bb4(param_1,param_3,param_2);
  if (iVar4 != 0) {
    return;
  }
  uVar9 = param_2[2];
  if ((uVar9 & 0x100) != 0) {
    return;
  }
  uVar6 = uVar9 & 0x60000;
  param_2[1] = (int)pbVar8;
  if (uVar6 == 0x20000) {
    if (param_4 < 0) {
      if ((uVar9 & 0x20) == 0) {
        return;
      }
    }
    else if ((uVar9 & 0x20) != 0) {
      return;
    }
  }
  else if (uVar6 < 0x20001) {
    if ((uVar6 == 0) && (param_4 < 0)) {
      return;
    }
  }
  else if (uVar6 == 0x40000) {
    if (param_4 < 0) {
      if ((uVar9 & 0x20) != 0) {
        return;
      }
    }
    else if ((uVar9 & 0x20) == 0) {
      return;
    }
  }
  else if ((uVar6 == 0x60000) && (0 < param_4)) {
    return;
  }
  if ((*(uint *)(*param_2 + 0x10) & 0xf000) == 0) {
    puVar7 = (undefined *)(uint)*pbVar8;
    if (puVar7 != (undefined *)0x0) {
      return;
    }
  }
  else {
    puVar7 = (undefined *)(uint)*pbVar8;
    if ((*(uint *)(*param_2 + 0x10) & 0x10000) == 0) {
      if (puVar7 != (undefined *)0x0) goto LAB_0004500c;
      puVar7 = &DAT_00069c54;
    }
    else if (puVar7 != (undefined *)0x0) {
LAB_0004500c:
      iVar4 = FUN_00044d28(pbVar8);
      param_2[1] = iVar4;
      param_2[2] = param_2[2] | 0x40;
      goto LAB_00044f88;
    }
  }
  param_2[1] = (int)puVar7;
LAB_00044f88:
  uVar2 = DAT_0007bb74;
  DAT_0007bb74 = param_5;
  FUN_000429c8(param_1,param_2);
  DAT_0007bb74 = uVar2;
  return;
}




void FUN_00045090(int *param_1,char *param_2,undefined4 param_3,int param_4)

{
  byte bVar1;
  byte *pbVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  byte *pbVar6;
  
  pbVar2 = (byte *)getenv(param_2);
  param_1[1] = (int)pbVar2;
  if (pbVar2 == (byte *)0x0) {
    return;
  }
  pbVar6 = *(byte **)(*param_1 + 0x3c);
  uVar5 = *(uint *)(*param_1 + 0x10);
  param_1[3] = 0;
  param_1[2] = uVar5 | 0x42;
  if (pbVar6 != (byte *)0x0) {
    do {
      bVar1 = *pbVar2;
      if ((&DAT_0007ba70)[bVar1] != (&DAT_0007ba70)[*pbVar6]) goto LAB_00045110;
      pbVar2 = pbVar2 + 1;
      pbVar6 = pbVar6 + 1;
    } while (bVar1 != 0);
    param_1[1] = 0;
    param_1[2] = uVar5 | 0x62;
  }
LAB_00045110:
  if (param_4 == 1) {
    if (((param_1[2] & 0x20020U) != 0x20000) && ((param_1[2] & 0x40020U) != 0x40020)) {
      return;
    }
  }
  else if ((((param_4 == 2) && (uVar4 = param_1[2], (uVar4 & 0x20020) != 0)) && ((uVar4 & 0x40020) != 0x20)) &&
          (((uVar4 & 0x400020) != 0x400000 && ((uVar4 & 0x800020) != 0x800020)))) {
    return;
  }
  uVar4 = (uVar5 << 0x10) >> 0x1c;
  if (uVar4 != 0) {
    if (*(char *)param_1[1] != '\0') {
      iVar3 = FUN_00044d28();
      param_1[1] = iVar3;
      param_1[2] = param_1[2] | 0x40;
      goto LAB_00045130;
    }
    uVar4 = 0;
    if ((uVar5 & 0x10000) == 0) {
      return;
    }
  }
  param_1[1] = uVar4;
LAB_00045130:
  FUN_000429c8(param_3,param_1);
  return;
}




void FUN_0004520c(int param_1,int param_2)

{
  char *pcVar1;
  char *pcVar2;
  char acStack_418 [1028];
  
  if (DAT_000c9aa0 == 0) {
    if ((*(uint *)(param_2 + 0x10) & 8) == 0) {
      DAT_000c9aa4 = getpid();
      snprintf(acStack_418,0x400,"/tmp/use.%lu",DAT_000c9aa4);
      unlink(acStack_418);
      DAT_000c9a98 = fopen(acStack_418,"w");
      if (DAT_000c9a98 != (FILE *)0x0) {
        DAT_000c9aa0 = 1;
        FUN_0005b388(FUN_0004520c);
        (**(code **)(param_1 + 0x54))(param_1,0);
                    /* WARNING: Subroutine does not return */
        _exit(1);
      }
                    /* WARNING: Subroutine does not return */
      _exit(1);
    }
  }
  else if (DAT_000c9aa0 == 1) {
    pcVar1 = getenv("PAGER");
    pcVar2 = "more";
    if (pcVar1 != (char *)0x0) {
      pcVar2 = pcVar1;
    }
    snprintf(acStack_418,0x400,"%1$s /tmp/use.%2$lu ; rm -f /tmp/use.%2$lu",pcVar2,DAT_000c9aa4);
    fclose(stderr);
    dup2(1,2);
    system(acStack_418);
  }
  return;
}




undefined4 FUN_00045328(int param_1)

{
  int iVar1;
  undefined4 local_28;
  undefined4 uStack_24;
  uint local_20;
  undefined4 local_1c;
  
  *(undefined4 *)(param_1 + 0x14) = 0;
  *(undefined4 *)(param_1 + 0x10) = 1;
  do {
    local_28 = 0;
    uStack_24 = 0;
    local_20 = 2;
    local_1c = 0;
    iVar1 = FUN_00042f48(param_1,&local_28);
    if (iVar1 == -1) break;
    if (iVar1 == 1) {
      return 0;
    }
  } while ((((local_20 & 0x20020) != 0x20000) && ((local_20 & 0x40020) != 0x40020)) ||
          (iVar1 = FUN_000429c8(param_1,&local_28), iVar1 == 0));
  if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
    (**(code **)(param_1 + 0x54))(param_1,1);
  }
  return 0xffffffff;
}




void FUN_000453f4(int param_1,int param_2)

{
  uint uVar1;
  
  if ((*(uint *)(param_1 + 0xc) & 2) == 0) {
    fputs(DAT_000c9a8c,DAT_000c9a98);
    return;
  }
  uVar1 = *(ushort *)(param_2 + 2) & 0xff;
  if ((uVar1 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar1 * 4) & 0x2000) != 0)) {
    fprintf(DAT_000c9a98,"   -%c");
    if ((*(uint *)(param_1 + 0xc) & 0x1001) != 0x1001) {
      return;
    }
    fwrite(&DAT_0006d188,1,2,DAT_000c9a98);
    return;
  }
  if ((*(uint *)(param_1 + 0xc) & 0x1001) == 0x1001) {
    fputc(0x20,DAT_000c9a98);
  }
  fputs(DAT_000c9a88,DAT_000c9a98);
  return;
}




/* WARNING: Restarted to delay deadcode elimination for space: ram */

void FUN_000454c8(int param_1,int param_2,undefined4 param_3)

{
  ushort uVar1;
  ushort *puVar2;
  undefined4 uVar3;
  undefined *puVar4;
  int *piVar5;
  code *pcVar6;
  undefined4 uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  uint *puVar13;
  int local_80;
  char acStack_78 [84];
  
  local_80 = 0;
  iVar11 = *(int *)(param_1 + 100);
  puVar13 = (uint *)(*(ushort **)(param_1 + 0x44) + -0x18);
  iVar12 = 0;
  puVar2 = *(ushort **)(param_1 + 0x44);
  do {
    puVar4 = *(undefined **)(puVar2 + 8);
    if (((uint)puVar4 & 0x6080000) == 0) {
      if (((uint)puVar4 & 0x200000) == 0) {
        if (((*(int *)(param_1 + 0x68) == iVar12) && (param_2 == 0 && 0 < local_80)) && ((*puVar13 & 0x200000) == 0)) {
          fprintf(DAT_000c9a98,DAT_000c9a84,DAT_0007b894,param_3);
        }
        FUN_000453f4(param_1,puVar2);
        uVar7 = DAT_000c9a7c;
        if ((*(uint *)(puVar2 + 8) & 0x10000) == 0) {
          switch((*(uint *)(puVar2 + 8) << 0x10) >> 0x1c) {
          case 0:
            uVar7 = DAT_000c9a80;
            break;
          case 1:
            uVar7 = DAT_000c9a5c;
            break;
          case 2:
            uVar7 = DAT_000c9a6c;
            break;
          case 3:
            uVar7 = DAT_000c9a74;
            break;
          case 4:
            uVar7 = DAT_000c9a70;
            break;
          case 5:
            uVar7 = DAT_000c9a64;
            break;
          case 6:
            uVar7 = DAT_000c9a78;
            break;
          case 7:
            uVar7 = DAT_000c9a68;
            break;
          case 8:
            uVar7 = DAT_000c9a94;
            break;
          default:
            fprintf(stderr,DAT_0007b934,*(undefined4 *)(puVar2 + 0x1a));
                    /* WARNING: Subroutine does not return */
            exit(0x46);
          }
        }
        uVar3 = DAT_000c9a60;
        if (puVar2[5] == 0) {
          uVar3 = DAT_000c9a7c;
        }
        snprintf(acStack_78,0x50,DAT_000c9a90,uVar7,*(undefined4 *)(puVar2 + 0x1a),uVar3);
        fprintf(DAT_000c9a98,&DAT_000c9aa8,acStack_78,*(undefined4 *)(puVar2 + 0x16));
        uVar8 = (uint)(*(int *)(puVar2 + 8) << 0x10) >> 0x1c;
        if (((uVar8 == 2) || (uVar8 == 4)) && (*(int *)(puVar2 + 0x14) != 0)) {
          DAT_000c9ab8 = 1;
        }
        if (param_2 == 0) {
          if ((*(int *)(puVar2 + 0x10) != 0) || (*(int *)(puVar2 + 0x12) != 0)) {
            fputs(DAT_0007ba54,DAT_000c9a98);
            piVar5 = *(int **)(puVar2 + 0x10);
            if (piVar5 != (int *)0x0) {
              fputs(DAT_0007ba08,DAT_000c9a98);
              iVar9 = *piVar5;
              do {
                fprintf(DAT_000c9a98,DAT_0007ba5c,*(undefined4 *)(*(int *)(param_1 + 0x44) + iVar9 * 0x40 + 0x34));
                piVar5 = piVar5 + 1;
                iVar9 = *piVar5;
              } while (iVar9 != 0x8000);
              if (*(int *)(puVar2 + 0x12) == 0) goto LAB_00045724;
              fputs(DAT_0007ba58,DAT_000c9a98);
            }
            piVar5 = *(int **)(puVar2 + 0x12);
            if (piVar5 != (int *)0x0) {
              fputs(DAT_0007b9d0,DAT_000c9a98);
              iVar9 = *piVar5;
              do {
                fprintf(DAT_000c9a98,DAT_0007ba5c,*(undefined4 *)(*(int *)(param_1 + 0x44) + iVar9 * 0x40 + 0x34));
                piVar5 = piVar5 + 1;
                iVar9 = *piVar5;
              } while (iVar9 != 0x8000);
            }
          }
LAB_00045724:
          if (*(int *)(puVar2 + 0x1c) != 0) {
            fprintf(DAT_000c9a98,DAT_0007b8b4);
          }
          uVar10 = *(uint *)(puVar2 + 8);
          uVar8 = (uVar10 << 0x10) >> 0x1c;
          if (uVar8 == 5) {
            pcVar6 = *(code **)(puVar2 + 0x14);
            if ((pcVar6 != (code *)0x0) && (pcVar6 != FUN_00043d78)) {
              (*pcVar6)(1,puVar2);
              uVar10 = *(uint *)(puVar2 + 8);
            }
          }
          else if (uVar8 == 7) {
            (**(code **)(puVar2 + 0x14))(1,puVar2);
            uVar10 = *(uint *)(puVar2 + 8);
          }
          if ((uVar10 & 0x800) != 0) {
            fputs(DAT_0007b8c4,DAT_000c9a98);
          }
          uVar8 = (uint)puVar2[4];
          if ((uVar8 == 0x8000) || (puVar2[2] == uVar8)) {
            uVar8 = *(uint *)(puVar2 + 8);
            if (((uVar8 & 0x100) != 0) &&
               (((*(int *)(param_1 + 0x34) != 0 || (*(int *)(param_1 + 0x20) != 0)) &&
                ((int)(uint)*puVar2 < *(int *)(param_1 + 0x68))))) {
              fputs(DAT_0007b96c,DAT_000c9a98);
              uVar8 = *(uint *)(puVar2 + 8);
            }
            if ((uVar8 << 0x10) >> 0x1c == 4) {
              fputs(DAT_0007b93c,DAT_000c9a98);
            }
            else if (puVar2[5] < 2) {
              uVar1 = puVar2[6];
              if (uVar1 != 1) {
                if (uVar1 == 0) {
                  fputs(DAT_0007b9c4,DAT_000c9a98);
                }
                else if (uVar1 == 0xffff) {
                  fputs(DAT_0007b968,DAT_000c9a98);
                }
                else {
                  fprintf(DAT_000c9a98,DAT_0007ba68);
                }
              }
            }
            else {
              fprintf(DAT_000c9a98,DAT_0007b948,(uint)puVar2[5],(uint)puVar2[6]);
            }
            if (((*(uint *)(param_1 + 0xc) & 3) == 0) && (*(ushort *)(param_1 + 0x62) == *puVar2)) {
              fputs(DAT_0007b8b0,DAT_000c9a98);
            }
          }
          else {
            fprintf(DAT_000c9a98,DAT_0007b880,*(undefined4 *)(*(int *)(param_1 + 0x44) + uVar8 * 0x40 + 0x34));
          }
        }
      }
      else if (param_2 == 0) {
        local_80 = local_80 + 1;
        fprintf(DAT_000c9a98,DAT_000c9a84,*(undefined4 *)(puVar2 + 0x16),param_3);
      }
    }
    else if (((puVar4 == &DAT_00080100) && (*(int *)(puVar2 + 0x1a) != 0)) && (param_2 == 0)) {
      iVar9 = *(int *)(puVar2 + 0x16);
      if (*(int *)(puVar2 + 0x16) == 0) {
        iVar9 = DAT_0007b8c0;
      }
      FUN_000453f4(param_1,puVar2);
      fprintf(DAT_000c9a98,DAT_0007b8bc,*(undefined4 *)(puVar2 + 0x1a),iVar9);
    }
    iVar11 = iVar11 + -1;
    iVar12 = iVar12 + 1;
    puVar13 = puVar13 + 0x10;
    puVar2 = puVar2 + 0x20;
    if (iVar11 < 1) {
      fputc(10,DAT_000c9a98);
      return;
    }
  } while( true );
}




int FUN_00045b18(int param_1,undefined4 *param_2,byte *param_3,int param_4)

{
  int *piVar1;
  ulong uVar2;
  ushort **ppuVar3;
  int iVar4;
  byte *pbVar5;
  byte *local_24;
  
  pbVar5 = (byte *)*param_2;
  if (param_1 != -1) {
    local_24 = pbVar5;
    piVar1 = __errno_location();
    *piVar1 = 0;
    uVar2 = strtoul((char *)pbVar5,(char **)&local_24,10);
    if (*piVar1 == 0) {
      ppuVar3 = __ctype_b_loc();
      pbVar5 = local_24;
      do {
        local_24 = pbVar5;
        pbVar5 = local_24 + 1;
      } while (((*ppuVar3)[*local_24] & 0x2000) != 0);
      if (local_24 == param_3) {
        *param_2 = param_3;
        iVar4 = FUN_0005a928(0x7fffffff,param_4);
        if (((int)uVar2 <= iVar4) && (param_1 <= (int)(0x7fffffff - param_4 * uVar2))) {
          return param_1 + param_4 * uVar2;
        }
        *piVar1 = 0x22;
        return -1;
      }
      *piVar1 = 0x16;
      return -1;
    }
  }
  return -1;
}




undefined4 FUN_00045c04(byte *param_1)

{
  byte bVar1;
  char *pcVar2;
  undefined4 uVar3;
  size_t sVar4;
  ushort **ppuVar5;
  int *piVar6;
  byte *pbVar7;
  undefined2 local_24;
  undefined1 local_22 [2];
  byte *local_20;
  byte *local_1c;
  
  pcVar2 = strchr((char *)param_1,0x3a);
  if (pcVar2 == (char *)0x0) {
    bVar1 = *param_1;
    if (bVar1 == 0) {
LAB_00045cf4:
      sVar4 = strlen((char *)param_1);
      if (sVar4 == 6) {
        local_24 = *(undefined2 *)param_1;
        local_22[0] = 0;
        local_1c = (byte *)&local_24;
        uVar3 = FUN_00045b18(0,&local_1c,local_22,0xe10);
        local_24 = *(undefined2 *)(param_1 + 2);
        local_22[0] = 0;
        local_1c = (byte *)&local_24;
        uVar3 = FUN_00045b18(uVar3,&local_1c,local_22,0x3c);
        local_24 = *(undefined2 *)(param_1 + 4);
        local_22[0] = 0;
        local_1c = (byte *)&local_24;
        uVar3 = FUN_00045b18(uVar3,&local_1c,local_22,1);
        return uVar3;
      }
    }
    else {
      if ((bVar1 != 0x48) && (pbVar7 = param_1, bVar1 != 0x4d)) {
        while (bVar1 != 0x53) {
          pbVar7 = pbVar7 + 1;
          bVar1 = *pbVar7;
          if (bVar1 == 0) goto LAB_00045cf4;
          if ((bVar1 == 0x48) || (bVar1 == 0x4d)) break;
        }
      }
      local_20 = param_1;
      pcVar2 = strchr((char *)param_1,0x48);
      if (pcVar2 == (char *)0x0) {
        uVar3 = 0;
      }
      else {
        uVar3 = FUN_00045b18(0,&local_20,pcVar2,0xe10);
        param_1 = local_20 + 1;
        local_20 = param_1;
      }
      pcVar2 = strchr((char *)param_1,0x4d);
      if (pcVar2 != (char *)0x0) {
        uVar3 = FUN_00045b18(uVar3,&local_20,pcVar2,0x3c);
        param_1 = local_20 + 1;
        local_20 = param_1;
      }
      pcVar2 = strchr((char *)param_1,0x53);
      if (pcVar2 != (char *)0x0) {
        uVar3 = FUN_00045b18(uVar3,&local_20,pcVar2,1);
        param_1 = local_20 + 1;
        local_20 = param_1;
      }
      ppuVar5 = __ctype_b_loc();
      pbVar7 = local_20;
      do {
        local_20 = pbVar7;
        pbVar7 = param_1 + 1;
        bVar1 = *param_1;
        param_1 = pbVar7;
      } while (((*ppuVar5)[bVar1] & 0x2000) != 0);
      if (bVar1 == 0) {
        return uVar3;
      }
    }
  }
  else {
    local_1c = param_1;
    uVar3 = FUN_00045b18(0,&local_1c,pcVar2,0xe10);
    local_1c = local_1c + 1;
    pcVar2 = strchr((char *)local_1c,0x3a);
    if (pcVar2 != (char *)0x0) {
      uVar3 = FUN_00045b18(uVar3,&local_1c,pcVar2,0x3c);
      pbVar7 = local_1c + 1;
      local_1c = pbVar7;
      sVar4 = strlen((char *)pbVar7);
      uVar3 = FUN_00045b18(uVar3,&local_1c,pbVar7 + sVar4,1);
      return uVar3;
    }
  }
  piVar6 = __errno_location();
  *piVar6 = 0x16;
  return 0xffffffff;
}




uint FUN_00045e68(byte *param_1)

{
  ushort uVar1;
  int iVar2;
  ushort **ppuVar3;
  uint *puVar4;
  long lVar5;
  char *pcVar6;
  byte *__s;
  undefined4 uVar7;
  size_t sVar8;
  int iVar9;
  int *piVar10;
  ulong uVar11;
  byte **ppbVar12;
  uint uVar13;
  uint uVar14;
  byte *pbVar15;
  undefined *puVar16;
  uint uVar17;
  byte *pbVar18;
  uint uVar19;
  ushort *puVar20;
  bool bVar21;
  byte *local_40;
  byte *local_3c;
  byte *local_38;
  byte *local_34;
  undefined1 local_30 [4];
  undefined1 local_2c [8];
  
  ppuVar3 = __ctype_b_loc();
  do {
    local_38 = param_1;
    uVar13 = (uint)*local_38;
    uVar1 = (*ppuVar3)[uVar13];
    uVar17 = uVar1 & 0x2000;
    param_1 = local_38 + 1;
  } while ((uVar1 & 0x2000) != 0);
  if (uVar13 != 0x50) {
    if (uVar13 == 0x54) {
      uVar13 = FUN_00045c04(local_38 + 1);
      return uVar13;
    }
    if ((uVar1 & 0x800) == 0) {
      piVar10 = __errno_location();
      *piVar10 = 0x16;
      return 0xffffffff;
    }
    puVar4 = (uint *)__errno_location();
    uVar13 = uVar17;
    uVar19 = uVar17;
    while( true ) {
      *puVar4 = uVar17;
      lVar5 = strtol((char *)local_38,(char **)&local_38,10);
      if (*puVar4 != 0) break;
      uVar14 = (uint)*local_38;
      if (uVar14 == 0x3a) {
        if (uVar19 < 6) {
          iVar9 = 3;
          *puVar4 = 0;
          local_34 = local_38;
          goto LAB_00046460;
        }
        break;
      }
      puVar20 = *ppuVar3;
      uVar1 = puVar20[uVar14];
      pbVar15 = local_38;
      while ((uVar1 & 0x2000) != 0) {
        pbVar15 = pbVar15 + 1;
        uVar14 = (uint)*pbVar15;
        uVar1 = puVar20[uVar14];
      }
      if (uVar14 == 100) {
LAB_0004638c:
        if (3 < uVar19) break;
        uVar19 = 4;
        puVar16 = (undefined *)0x15180;
      }
      else if (uVar14 < 0x65) {
        if (uVar14 == 0x4d) {
          if (1 < uVar19) break;
          puVar16 = (undefined *)0x278d00;
          uVar19 = 2;
        }
        else {
          if (uVar14 < 0x4e) {
            if (uVar14 == 0) {
              if (uVar13 != 0xffffffff) goto LAB_00045f64;
              goto LAB_00046434;
            }
            if (uVar14 == 0x44) goto LAB_0004638c;
            break;
          }
          if (uVar14 == 0x57) {
            if (2 < uVar19) break;
            uVar19 = 3;
            puVar16 = &DAT_00093a80;
          }
          else {
            if (uVar14 != 0x59) break;
LAB_00046320:
            if (uVar19 != 0) break;
            uVar19 = 1;
            puVar16 = (undefined *)0x1e13380;
          }
        }
      }
      else if (uVar14 == 0x6d) {
        if (5 < uVar19) break;
        puVar16 = (undefined *)0x3c;
        uVar19 = 6;
      }
      else if (uVar14 < 0x6e) {
        if ((uVar14 != 0x68) || (4 < uVar19)) break;
        puVar16 = (undefined *)0xe10;
        uVar19 = 5;
      }
      else {
        if (uVar14 != 0x73) {
          if (uVar14 == 0x79) goto LAB_00046320;
          break;
        }
        puVar16 = (undefined *)0x1;
        uVar19 = 7;
      }
      if (uVar13 == 0xffffffff) {
        *puVar4 = 0x16;
      }
      else {
        local_38 = pbVar15;
        iVar9 = FUN_0005a928(0x7fffffff,puVar16);
        if ((iVar9 < lVar5) || (0x7fffffff - lVar5 * (int)puVar16 < (int)uVar13)) {
          uVar13 = 0xffffffff;
          *puVar4 = 0x22;
        }
        else {
          uVar13 = uVar13 + lVar5 * (int)puVar16;
        }
      }
      local_38 = pbVar15 + 1;
      uVar14 = (uint)pbVar15[1];
      uVar1 = puVar20[uVar14];
      if ((uVar1 & 0x2000) != 0) {
        pbVar15 = pbVar15 + 2;
        do {
          local_38 = pbVar15;
          uVar14 = (uint)*local_38;
          uVar1 = puVar20[uVar14];
          pbVar15 = local_38 + 1;
        } while ((uVar1 & 0x2000) != 0);
      }
      if (uVar14 == 0) {
        return uVar13;
      }
      if (((uVar1 & 0x800) == 0) || (uVar19 == 7)) break;
    }
LAB_000460e8:
    *puVar4 = 0x16;
    return 0xffffffff;
  }
  pbVar15 = (byte *)__strdup(local_38 + 1);
  if (pbVar15 == (byte *)0x0) {
    piVar10 = __errno_location();
    *piVar10 = 0xc;
    return 0xffffffff;
  }
  pcVar6 = strchr((char *)pbVar15,0x54);
  if (pcVar6 == (char *)0x0) {
    iVar9 = 0;
    __s = pbVar15;
  }
  else {
    *pcVar6 = '\0';
    __s = (byte *)FUN_000442f0(pbVar15);
    iVar9 = FUN_000442f0(pcVar6 + 1);
  }
  pcVar6 = strchr((char *)__s,0x2d);
  if (pcVar6 == (char *)0x0) {
    pcVar6 = strpbrk((char *)__s,"YMWD");
    if (pcVar6 == (char *)0x0) {
      sVar8 = strlen((char *)__s);
      if (sVar8 == 8) {
        local_30 = *(undefined1 (*) [4])__s;
        ppbVar12 = &local_34;
        local_2c[0] = 0;
        local_34 = local_30;
        uVar7 = FUN_00045b18(0,ppbVar12,local_2c,0x1e13380);
        local_30[2] = 0;
        local_30._0_2_ = *(ushort *)(__s + 4);
        local_34 = local_30;
        uVar7 = FUN_00045b18(uVar7,ppbVar12,local_30 + 2,0x278d00);
        pbVar18 = local_30 + 2;
        local_30[2] = 0;
        local_30._0_2_ = *(ushort *)(__s + 6);
        local_34 = local_30;
        goto LAB_00046074;
      }
    }
    else {
      local_3c = __s;
      pcVar6 = strchr((char *)__s,0x59);
      if (pcVar6 == (char *)0x0) {
        uVar13 = 0;
      }
      else {
        uVar13 = FUN_00045b18(0,&local_3c,pcVar6,0x1e13380);
        __s = local_3c + 1;
        local_3c = __s;
      }
      pcVar6 = strchr((char *)__s,0x4d);
      if (pcVar6 != (char *)0x0) {
        uVar13 = FUN_00045b18(uVar13,&local_3c,pcVar6,0x278d00);
        __s = local_3c + 1;
        local_3c = __s;
      }
      pcVar6 = strchr((char *)__s,0x57);
      if (pcVar6 != (char *)0x0) {
        uVar13 = FUN_00045b18(uVar13,&local_3c,pcVar6,&DAT_00093a80);
        __s = local_3c + 1;
        local_3c = __s;
      }
      pcVar6 = strchr((char *)__s,0x44);
      if (pcVar6 != (char *)0x0) {
        uVar13 = FUN_00045b18(uVar13,&local_3c,pcVar6,0x15180);
        __s = local_3c + 1;
        local_3c = __s;
      }
      uVar17 = (uint)*__s;
      uVar1 = (*ppuVar3)[uVar17];
      while ((uVar1 & 0x2000) != 0) {
        __s = __s + 1;
        uVar17 = (uint)*__s;
        local_3c = __s;
        uVar1 = (*ppuVar3)[uVar17];
      }
      if (uVar17 == 0) goto LAB_0004607c;
    }
  }
  else {
    ppbVar12 = &local_40;
    local_40 = __s;
    uVar7 = FUN_00045b18(0,ppbVar12,pcVar6,0x1e13380);
    local_40 = local_40 + 1;
    pcVar6 = strchr((char *)local_40,0x2d);
    if (pcVar6 != (char *)0x0) {
      uVar7 = FUN_00045b18(uVar7,ppbVar12,pcVar6,0x278d00);
      pbVar18 = local_40 + 1;
      local_40 = pbVar18;
      sVar8 = strlen((char *)pbVar18);
      pbVar18 = pbVar18 + sVar8;
LAB_00046074:
      uVar13 = FUN_00045b18(uVar7,ppbVar12,pbVar18,0x15180);
LAB_0004607c:
      piVar10 = __errno_location();
      if ((*piVar10 == 0) && (iVar9 != 0)) {
        iVar9 = FUN_00045c04(iVar9);
        if (uVar13 == 0xffffffff) {
          if (*piVar10 == 0) {
            *piVar10 = 0x16;
          }
        }
        else if (0x7fffffff - iVar9 < (int)uVar13) {
          uVar13 = 0xffffffff;
          *piVar10 = 0x22;
        }
        else {
          uVar13 = uVar13 + iVar9;
        }
      }
      goto LAB_000460c8;
    }
  }
  piVar10 = __errno_location();
  uVar13 = 0xffffffff;
  *piVar10 = 0x16;
LAB_000460c8:
  free(pbVar15);
  return uVar13;
LAB_00046460:
  uVar17 = (uint)*local_34;
  if ((uVar17 != 0x3a) || (iVar9 = iVar9 + -1, iVar9 == 0)) {
    uVar1 = (*ppuVar3)[uVar17];
    while ((uVar1 & 0x2000) != 0) {
      local_34 = local_34 + 1;
      uVar17 = (uint)*local_34;
      uVar1 = (*ppuVar3)[uVar17];
    }
    if (uVar17 == 0) {
      bVar21 = lVar5 == 0xe10;
      if (0xe0f < lVar5) {
        bVar21 = uVar19 == 5;
      }
      if (!bVar21) goto LAB_00046420;
      goto LAB_000460e8;
    }
LAB_00046558:
    *puVar4 = 0x16;
    goto LAB_00046560;
  }
  uVar11 = strtoul((char *)(local_34 + 1),(char **)&local_34,10);
  iVar2 = lVar5 * -0x3c;
  if (*puVar4 == 0) {
    if (uVar11 != 0xffffffff) goto code_r0x000464b4;
    goto LAB_00046558;
  }
  goto LAB_00046560;
code_r0x000464b4:
  if ((0x2222222 < lVar5) || (lVar5 = uVar11 + lVar5 * 0x3c, iVar2 + 0x7fffffff < (int)uVar11)) {
    *puVar4 = 0x22;
LAB_00046560:
    lVar5 = -1;
LAB_00046420:
    if (uVar13 != 0xffffffff) {
LAB_00045f64:
      if (0x7fffffff - lVar5 < (int)uVar13) {
        *puVar4 = 0x22;
        return 0xffffffff;
      }
      return uVar13 + lVar5;
    }
    if (*puVar4 != 0) {
      return 0xffffffff;
    }
LAB_00046434:
    *puVar4 = 0x16;
    return uVar13;
  }
  goto LAB_00046460;
}




undefined4 FUN_0004658c(char *param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  char *pcVar4;
  
  if ((param_2 - 3U < 0xc) && (uVar3 = (uint)(byte)(&DAT_0006a420)[(byte)param_1[2]] + param_2, uVar3 < 0x17)) {
    pcVar4 = *(char **)(&DAT_0006a520 + uVar3 * 8);
    if ((*param_1 == *pcVar4) && (iVar1 = strncmp(param_1 + 1,pcVar4 + 1,param_2 - 1), iVar1 == 0)) {
      uVar2 = 0;
      if (pcVar4[param_2] == '\0') {
        uVar2 = (&DAT_0006a524)[uVar3 * 2];
      }
      return uVar2;
    }
  }
  return 0;
}




undefined4 FUN_00046610(byte *param_1,int param_2)

{
  int iVar1;
  undefined4 uVar2;
  uint uVar3;
  byte *pbVar4;
  
  if (param_2 - 4U < 5) {
    uVar3 = (uint)(byte)"\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r\r"
                        [*param_1] + param_2;
    if (uVar3 < 0xd) {
      pbVar4 = *(byte **)(&DAT_0006a6d8 + uVar3 * 8);
      if (((uint)*pbVar4 == (uint)*param_1) &&
         (iVar1 = strncmp((char *)(param_1 + 1),(char *)(pbVar4 + 1),param_2 - 1), iVar1 == 0)) {
        uVar2 = 0;
        if (pbVar4[param_2] == 0) {
          uVar2 = (&DAT_0006a6dc)[uVar3 * 2];
        }
        return uVar2;
      }
    }
  }
  return 0;
}




byte * FUN_00046690(byte *param_1,undefined4 *param_2,undefined4 *param_3)

{
  byte *pbVar1;
  undefined4 uVar2;
  uint uVar3;
  int iVar4;
  byte *pbVar5;
  byte *pbVar6;
  
  uVar3 = (uint)*param_1;
LAB_000466ac:
  if ((0x7f < uVar3) || ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x500) == 0)) {
    if (uVar3 == 0x2f) {
      *param_3 = 0;
      return param_1;
    }
    if (uVar3 == 0x3e) {
      return param_1;
    }
    return (byte *)0x0;
  }
  pbVar1 = param_1 + 1;
  do {
    pbVar5 = pbVar1;
    uVar3 = (uint)*pbVar5;
    pbVar6 = pbVar5;
    if (0x7f < uVar3) {
      iVar4 = 0;
      goto LAB_000466f8;
    }
    pbVar1 = pbVar5 + 1;
  } while ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x500) != 0);
  iVar4 = 0;
  if ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 1) == 0) {
    iVar4 = 0;
  }
  else {
    do {
      pbVar6 = pbVar1;
      uVar3 = (uint)*pbVar6;
      iVar4 = iVar4 + 1;
      if (0x7f < uVar3) break;
      pbVar1 = pbVar6 + 1;
    } while ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 1) != 0);
  }
LAB_000466f8:
  uVar2 = FUN_00046610(pbVar5,iVar4);
  param_1 = pbVar6;
  switch(uVar2) {
  case 1:
    param_1 = pbVar6 + 1;
    if (((uVar3 == 0x3d) && (pbVar6[1] < 0x80)) && ((*(uint *)(&DAT_00069a0c + (uint)pbVar6[1] * 4) & 0x6f) != 0)) {
      iVar4 = 0;
      pbVar1 = pbVar6 + 2;
      do {
        param_1 = pbVar1;
        iVar4 = iVar4 + 1;
        if (0x7f < *param_1) goto switchD_0004692c_default;
        pbVar1 = param_1 + 1;
      } while ((*(uint *)(&DAT_00069a0c + (uint)*param_1 * 4) & 0x6f) != 0);
      if ((iVar4 == 0) || ((*(uint *)(&DAT_00069a0c + (uint)*param_1 * 4) & 0x1500) == 0))
      goto switchD_0004692c_default;
      uVar2 = FUN_0004658c((int)param_1 - iVar4);
      switch(uVar2) {
      case 1:
        *param_3 = 1;
        break;
      case 2:
        *param_3 = 5;
        break;
      case 3:
      case 4:
        *param_3 = 3;
        break;
      case 5:
        *param_3 = 2;
        break;
      case 6:
      case 7:
        *param_3 = 4;
        break;
      case 8:
      case 9:
        *param_3 = 6;
        break;
      default:
        goto switchD_0004692c_default;
      }
    }
    else {
switchD_0004692c_default:
      *param_3 = 0;
      while( true ) {
        uVar3 = (uint)*param_1;
        if ((uVar3 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x1500) != 0)) break;
        param_1 = param_1 + 1;
        if (uVar3 == 0) {
          return (byte *)0x0;
        }
      }
    }
    if (param_1 == (byte *)0x0) {
      return (byte *)0x0;
    }
    uVar3 = (uint)*param_1;
    goto LAB_000466ac;
  case 2:
    while( true ) {
      uVar3 = (uint)*param_1;
      if ((uVar3 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x1500) != 0)) break;
      param_1 = param_1 + 1;
      if (uVar3 == 0) {
        return (byte *)0x0;
      }
    }
    goto LAB_000466ac;
  case 3:
    while( true ) {
      uVar3 = (uint)*param_1;
      if ((uVar3 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x1500) != 0)) break;
      param_1 = param_1 + 1;
      if (uVar3 == 0) {
        return (byte *)0x0;
      }
    }
    goto LAB_000466ac;
  case 4:
    pbVar5 = pbVar6;
    if ((uVar3 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x1500) != 0)) {
      *param_2 = 0;
      uVar3 = (uint)*pbVar6;
      goto LAB_000466ac;
    }
    break;
  case 5:
    pbVar5 = pbVar6;
    if ((uVar3 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x1500) != 0)) {
      *param_2 = 1;
      uVar3 = (uint)*pbVar6;
      goto LAB_000466ac;
    }
    break;
  case 6:
    pbVar5 = pbVar6;
    if ((0x7f < uVar3) || ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x1500) == 0)) break;
    *param_2 = 2;
    uVar3 = (uint)*pbVar6;
    goto LAB_000466ac;
  }
  *param_3 = 0;
  while( true ) {
    uVar3 = (uint)*pbVar5;
    if ((uVar3 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x1500) != 0)) break;
    pbVar5 = pbVar5 + 1;
    if (uVar3 == 0) {
      return (byte *)0x0;
    }
  }
  return pbVar5;
}




/* WARNING: Type propagation algorithm not settling */

char * FUN_000469c8(char *param_1,char *param_2,char *param_3)

{
  char cVar1;
  char *pcVar2;
  char *pcVar3;
  size_t sVar4;
  DIR *__dirp;
  dirent *pdVar5;
  int iVar6;
  char *pcVar7;
  size_t sVar8;
  char *__src;
  char cVar9;
  char *pcVar10;
  char cVar11;
  uint uVar12;
  uint uVar13;
  uint uVar14;
  char local_102c [4104];
  
  pcVar3 = strchr(param_3,0x72);
  if (pcVar3 == (char *)0x0) {
    uVar14 = 0;
  }
  else {
    uVar14 = 4;
  }
  pcVar3 = strchr(param_3,0x77);
  if (pcVar3 != (char *)0x0) {
    uVar14 = uVar14 | 2;
  }
  pcVar3 = strchr(param_3,0x78);
  if (pcVar3 != (char *)0x0) {
    uVar14 = uVar14 | 1;
  }
  if (param_1 != (char *)0x0) {
    uVar12 = 0;
LAB_00046a3c:
    sVar4 = strlen(param_1);
    if (uVar12 < sVar4) {
      do {
        pcVar3 = param_1 + uVar12;
        local_102c[0] = param_1[uVar12];
        while (local_102c[0] == ':') {
          pcVar3 = pcVar3 + 1;
          local_102c[0] = *pcVar3;
        }
        pcVar7 = local_102c;
        cVar11 = local_102c[0];
        while( true ) {
          pcVar7 = pcVar7 + 1;
          if (cVar11 == '\0') break;
          if (cVar11 == ':') {
            pcVar7[-1] = '\0';
            break;
          }
          if (0xfff < (uint)((int)pcVar7 - (int)local_102c)) break;
          cVar11 = pcVar3[1];
          *pcVar7 = cVar11;
          pcVar3 = pcVar3 + 1;
        }
        uVar12 = (int)(pcVar3 + 1) - (int)param_1;
        if (local_102c[0] == '\0') {
          return (char *)0x0;
        }
        __dirp = opendir(local_102c);
        if (__dirp == (DIR *)0x0) goto LAB_00046a3c;
        do {
          pdVar5 = readdir(__dirp);
          if (pdVar5 == (dirent *)0x0) goto LAB_00046d14;
          iVar6 = strcmp(pdVar5->d_name,param_2);
        } while (iVar6 != 0);
        if (*param_2 == '/') {
          pcVar3 = (char *)FUN_00044d28(param_2);
        }
        else {
          if (local_102c[0] == '\0') {
            sVar4 = strlen(param_2);
            pcVar3 = (char *)FUN_00044484(sVar4 + 3);
            *pcVar3 = '.';
            pcVar3[1] = '/';
            pcVar7 = pcVar3 + 2;
            *pcVar7 = '\0';
          }
          else {
            sVar4 = strlen(local_102c);
            sVar8 = strlen(param_2);
            pcVar3 = (char *)FUN_00044484(sVar4 + sVar8 + 2);
            pcVar10 = stpcpy(pcVar3,local_102c);
            pcVar7 = pcVar3 + ((int)pcVar10 - (int)pcVar3);
            if (pcVar7[-1] != '/') {
              iVar6 = ((int)pcVar10 - (int)pcVar3) + 1;
              *pcVar10 = '/';
              pcVar7 = pcVar3 + iVar6;
              pcVar3[iVar6] = '\0';
            }
          }
          strcpy(pcVar7,param_2);
        }
        iVar6 = access(pcVar3,uVar14);
        if (-1 < iVar6) {
          pcVar7 = (char *)FUN_00044d28(pcVar3);
          if (*pcVar3 == '/') {
            cVar11 = '/';
          }
          else {
            cVar11 = '.';
          }
          cVar9 = *pcVar7;
          uVar14 = 0;
          goto joined_r0x00046ba4;
        }
        free(pcVar3);
LAB_00046d14:
        closedir(__dirp);
        sVar4 = strlen(param_1);
        if (sVar4 <= uVar12) {
          return (char *)0x0;
        }
      } while( true );
    }
  }
  return (char *)0x0;
code_r0x00046c40:
  if (pcVar7[uVar12 - 1] != '\\') {
LAB_00046c50:
    if (cVar9 != '\0') {
LAB_00046c58:
      if (cVar9 != '.') goto joined_r0x00046ba4;
      cVar1 = pcVar7[uVar14 + 1];
      if (cVar1 != '\0') {
        if (cVar1 == '/') {
          strcpy(__src,pcVar7 + uVar14 + 1);
          uVar14 = uVar12 & ~((int)uVar12 >> 0x1f);
          cVar9 = pcVar7[uVar14];
        }
        else if ((cVar1 == '.') && (pcVar7[uVar14 + 2] == '/' || pcVar7[uVar14 + 2] == '\0')) {
          pcVar10 = pcVar7 + uVar12;
          do {
            uVar13 = uVar12;
            uVar12 = uVar13 - 1;
            if ((int)uVar12 < 0) break;
            pcVar10 = pcVar10 + -1;
          } while (*pcVar10 != '/');
          strcpy(pcVar7 + uVar13,pcVar7 + uVar14 + 2);
          uVar14 = uVar12 & ~((int)uVar12 >> 0x1f);
          cVar9 = pcVar7[uVar14];
        }
        goto joined_r0x00046ba4;
      }
    }
    pcVar7[uVar14 - 1] = '\0';
    goto LAB_00046cd4;
  }
joined_r0x00046ba4:
  uVar12 = uVar14;
  if (cVar9 != '\0') {
    if (cVar9 == '/') {
      uVar13 = uVar12 + 1;
      cVar9 = pcVar7[uVar13];
    }
    else {
      pcVar10 = pcVar7 + uVar12;
      do {
        uVar13 = uVar12;
        pcVar10 = pcVar10 + 1;
        cVar9 = *pcVar10;
        uVar12 = uVar13 + 1;
      } while (cVar9 != '/' && cVar9 != '\0');
      uVar13 = uVar13 + 2;
      if (cVar9 == '\0') goto LAB_00046cd4;
      cVar9 = pcVar7[uVar13];
    }
    pcVar10 = pcVar7 + uVar13;
    __src = pcVar10;
    uVar14 = uVar13;
    if (cVar9 == '/') {
      pcVar2 = pcVar7 + uVar13 + 1;
      do {
        __src = pcVar2;
        cVar9 = *__src;
        uVar14 = uVar14 + 1;
        pcVar2 = __src + 1;
      } while (cVar9 == '/');
      if (uVar14 != uVar13) {
        strcpy(pcVar7 + uVar12 + 1,__src);
        cVar9 = *pcVar10;
        __src = pcVar10;
        uVar14 = uVar13;
      }
    }
    if (0 < (int)uVar12) goto code_r0x00046c40;
    if (uVar12 != 0) goto LAB_00046c50;
    goto LAB_00046c58;
  }
LAB_00046cd4:
  if (*pcVar7 == '\0') {
    *pcVar7 = cVar11;
    pcVar7[1] = '\0';
  }
  free(pcVar3);
  closedir(__dirp);
  return pcVar7;
}




int FUN_00046f84(int *param_1,char *param_2)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  int iVar4;
  int *piVar5;
  
  if ((param_1 != (int *)0x0) && (*param_1 == 6)) {
    piVar2 = (int *)param_1[2];
    iVar3 = *piVar2;
    if (0 < iVar3) {
      piVar5 = piVar2 + 2;
      if (param_2 == (char *)0x0) {
        if (piVar2[2] != 0) {
          return piVar2[2];
        }
      }
      else {
        do {
          iVar4 = *piVar5;
          iVar1 = strcmp(*(char **)(iVar4 + 4),param_2);
          if (iVar1 == 0) {
            return iVar4;
          }
          iVar3 = iVar3 + -1;
          piVar5 = piVar5 + 1;
        } while (iVar3 != 0);
      }
    }
    piVar2 = __errno_location();
    *piVar2 = 2;
    return 0;
  }
  piVar2 = __errno_location();
  *piVar2 = 0x16;
  return 0;
}




int FUN_000470f4(int *param_1,int param_2)

{
  int iVar1;
  int *piVar2;
  int *piVar3;
  int iVar4;
  int iVar5;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 6)) {
    piVar2 = __errno_location();
    *piVar2 = 0x16;
    return 0;
  }
  piVar2 = (int *)param_1[2] + 2;
  iVar5 = *(int *)param_1[2];
  do {
    iVar4 = iVar5 + -1;
    if (iVar5 < 1) {
      iVar5 = 0x16;
      goto LAB_0004713c;
    }
    piVar3 = piVar2 + 1;
    iVar1 = *piVar2;
    piVar2 = piVar3;
    iVar5 = iVar4;
  } while (iVar1 != param_2);
  if (iVar4 != 0) {
    return *piVar3;
  }
  iVar5 = 2;
LAB_0004713c:
  piVar2 = __errno_location();
  *piVar2 = iVar5;
  return 0;
}




undefined1 * FUN_0004717c(char *param_1,char *param_2,char param_3)

{
  ulong uVar1;
  undefined1 *puVar2;
  uint uVar3;
  undefined1 *puVar4;
  byte *pbVar5;
  char local_14;
  undefined1 local_13 [3];
  
  pbVar5 = (byte *)(param_1 + 1);
  local_14 = *param_1;
  *param_2 = local_14;
  switch(local_14) {
  case '\0':
    puVar4 = (undefined1 *)0x0;
    break;
  default:
    goto switchD_00047198_caseD_1;
  case '\n':
    puVar4 = (undefined1 *)0x1;
LAB_000473b0:
    *param_2 = param_3;
    break;
  case '\r':
    if (param_1[1] == '\n') {
      puVar4 = (undefined1 *)0x2;
      goto LAB_000473b0;
    }
    goto switchD_00047198_caseD_1;
  case '0':
  case '1':
  case '2':
  case '3':
  case '4':
  case '5':
  case '6':
  case '7':
    uVar3 = (uint)(byte)param_1[1];
    if ((uVar3 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 4) != 0)) {
      puVar2 = local_13;
      do {
        puVar4 = puVar2 + 1;
        *puVar2 = (char)uVar3;
        pbVar5 = pbVar5 + 1;
        uVar3 = (uint)*pbVar5;
        if ((0x7f < uVar3) || ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 4) == 0)) break;
        puVar2 = puVar4;
      } while (puVar4 < local_13 + 2);
    }
    else {
      puVar4 = local_13;
    }
    *puVar4 = 0;
    uVar1 = strtoul(&local_14,(char **)0x0,8);
    puVar4 = puVar4 + -(int)&local_14;
    if (0xfe < uVar1) {
      uVar1 = 0xff;
    }
    *param_2 = (char)uVar1;
    break;
  case 'X':
  case 'x':
    uVar3 = (uint)(byte)param_1[1];
    if ((uVar3 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x1c) != 0)) {
      puVar4 = local_13;
      do {
        puVar2 = puVar4;
        puVar2[-1] = (char)uVar3;
        pbVar5 = pbVar5 + 1;
        uVar3 = (uint)*pbVar5;
        if ((0x7f < uVar3) || ((*(uint *)(&DAT_00069a0c + uVar3 * 4) & 0x1c) == 0)) break;
        puVar4 = puVar2 + 1;
      } while (puVar2 + 1 != local_13 + 2);
      *puVar2 = 0;
      uVar1 = strtoul(&local_14,(char **)0x0,0x10);
      *param_2 = (char)uVar1;
      return puVar2 + (1 - (int)&local_14);
    }
switchD_00047198_caseD_1:
    puVar4 = (undefined1 *)0x1;
    break;
  case 'a':
    puVar4 = (undefined1 *)0x1;
    *param_2 = '\a';
    break;
  case 'b':
    puVar4 = (undefined1 *)0x1;
    *param_2 = '\b';
    break;
  case 'f':
    puVar4 = (undefined1 *)0x1;
    *param_2 = '\f';
    break;
  case 'n':
    puVar4 = (undefined1 *)0x1;
    *param_2 = '\n';
    break;
  case 'r':
    puVar4 = (undefined1 *)0x1;
    *param_2 = '\r';
    break;
  case 't':
    puVar4 = (undefined1 *)0x1;
    *param_2 = '\t';
    break;
  case 'v':
    puVar4 = (undefined1 *)0x1;
    *param_2 = '\v';
  }
  return puVar4;
}




byte * FUN_00047530(byte *param_1,int *param_2)

{
  byte *pbVar1;
  int iVar2;
  uint uVar3;
  byte *pbVar4;
  uint uVar5;
  byte *pbVar6;
  int local_24;
  
  local_24 = 0;
  uVar5 = (uint)*param_1;
  if (param_2 == (int *)0x0) {
    param_2 = &local_24;
  }
  uVar3 = (uint)param_1[1];
  pbVar6 = param_1 + 1;
joined_r0x00047564:
  do {
    while (pbVar1 = param_1, pbVar4 = pbVar6, uVar5 == uVar3) {
      pbVar4 = pbVar4 + 1;
      *pbVar1 = 0;
      while( true ) {
        while ((uVar5 = (uint)*pbVar4, uVar5 < 0x80 && ((*(uint *)(&DAT_00069a0c + uVar5 * 4) & 0x500) != 0))) {
          pbVar4 = pbVar4 + 1;
          if (uVar5 == 10) {
            *param_2 = *param_2 + 1;
          }
        }
        if (uVar5 == 0x27) goto LAB_00047694;
        if (uVar5 != 0x2f) break;
        if (pbVar4[1] == 0x2a) {
          pbVar6 = (byte *)strstr((char *)(pbVar4 + 2),"*/");
          if (pbVar6 == (byte *)0x0) {
            return (byte *)0x0;
          }
          if (pbVar4 < pbVar6) {
            while (pbVar4 != pbVar6 + -1) {
              pbVar4 = pbVar4 + 1;
              if (*pbVar4 == 10) {
                *param_2 = *param_2 + 1;
              }
            }
          }
          pbVar4 = pbVar6 + 2;
        }
        else {
          if (pbVar4[1] != 0x2f) {
            return (byte *)0x0;
          }
          pbVar4 = (byte *)strchr((char *)pbVar4,10);
          if (pbVar4 == (byte *)0x0) {
            return (byte *)0x0;
          }
        }
      }
      if (uVar5 != 0x22) {
        return pbVar4;
      }
LAB_00047694:
      pbVar6 = pbVar4 + 1;
      param_1 = pbVar1;
      uVar3 = (uint)pbVar4[1];
    }
    param_1 = pbVar1 + 1;
    *pbVar1 = (byte)uVar3;
    pbVar6 = pbVar4 + 1;
    if (uVar3 == 0x5c) {
      uVar3 = (uint)pbVar4[1];
      if (uVar3 == 10) {
        *param_2 = *param_2 + 1;
        uVar3 = (uint)pbVar4[2];
        pbVar6 = pbVar4 + 2;
        param_1 = pbVar1;
      }
      else if (uVar5 == 0x27) {
        if (((uVar3 == 0x27) || (uVar3 == 0x5c)) || (uVar3 == 0x23)) {
          *pbVar1 = pbVar4[1];
          uVar3 = (uint)pbVar4[2];
          pbVar6 = pbVar4 + 2;
        }
      }
      else {
        iVar2 = FUN_0004717c(pbVar6,pbVar1,10);
        if (iVar2 == 0) {
          return (byte *)0x0;
        }
        uVar3 = (uint)pbVar6[iVar2];
        pbVar6 = pbVar6 + iVar2;
      }
      goto joined_r0x00047564;
    }
    if (uVar3 < 0x5d) {
      if (uVar3 == 0) {
        return (byte *)0x0;
      }
      if (uVar3 != 10) goto LAB_00047580;
      *param_2 = *param_2 + 1;
      uVar3 = (uint)pbVar4[1];
    }
    else {
LAB_00047580:
      uVar3 = (uint)pbVar4[1];
    }
  } while( true );
}




undefined4 * FUN_00047748(byte *param_1,void *param_2,size_t param_3)

{
  char cVar1;
  char *pcVar2;
  undefined4 *__ptr;
  undefined4 *puVar3;
  char *pcVar4;
  int iVar5;
  int iVar6;
  void *__dest;
  long lVar7;
  undefined4 uVar8;
  byte *pbVar9;
  int iVar10;
  char *pcVar11;
  size_t sVar12;
  int iVar13;
  char *pcVar14;
  uint uVar15;
  int *piVar16;
  undefined4 *puVar17;
  int *piVar18;
  uint uVar19;
  int *piVar20;
  byte *pbVar21;
  int iVar22;
  int iVar23;
  byte *pbVar24;
  byte *pbVar25;
  undefined4 *local_7c;
  undefined4 local_78 [3];
  char local_6c [72];
  
  if (param_1 == (byte *)0x0) {
    piVar18 = __errno_location();
    *piVar18 = 0x16;
  }
  else {
    uVar15 = (uint)*param_1;
    if ((uVar15 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x500) != 0)) {
      pbVar24 = param_1 + 1;
      do {
        param_1 = pbVar24;
        uVar15 = (uint)*param_1;
        if (0x7f < uVar15) break;
        pbVar24 = param_1 + 1;
      } while ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x500) != 0);
    }
    if (uVar15 == 0) {
      piVar18 = __errno_location();
      *piVar18 = 2;
    }
    else {
      __ptr = (undefined4 *)FUN_00044484(param_3 + 0xd);
      if (__ptr == (undefined4 *)0x0) {
        piVar18 = __errno_location();
        *piVar18 = 0xc;
      }
      else {
        *__ptr = 6;
        __ptr[1] = __ptr + 3;
        memcpy(__ptr + 3,param_2,param_3);
        *(undefined1 *)(__ptr[1] + param_3) = 0;
        puVar3 = (undefined4 *)FUN_00044484(0x20);
        if (puVar3 != (undefined4 *)0x0) {
          puVar17 = __ptr + 2;
          *puVar17 = puVar3;
          *puVar3 = 0;
          puVar3[1] = 6;
LAB_000477d8:
          uVar15 = (uint)*param_1;
LAB_000477dc:
          do {
            iVar10 = DAT_0007bb74;
            if (uVar15 < 0x80) {
              if ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x500) != 0) {
                uVar15 = (uint)param_1[1];
                param_1 = param_1 + 1;
                goto LAB_000477dc;
              }
              if ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x23) != 0) {
                pbVar24 = param_1 + 1;
                if ((0x7f < param_1[1]) || ((*(uint *)(&DAT_00069a0c + (uint)param_1[1] * 4) & 0xef) == 0)) {
                  iVar10 = 1;
                  goto LAB_0004789c;
                }
                iVar10 = 1;
                goto LAB_00047c60;
              }
            }
            if (uVar15 == 0x23) {
              pbVar25 = (byte *)strchr((char *)param_1,10);
              goto LAB_00047b14;
            }
            if (uVar15 != 0x3c) {
              if (uVar15 != 0) goto LAB_00047a68;
              goto LAB_000477fc;
            }
            uVar15 = (uint)param_1[1];
            pbVar24 = param_1 + 1;
            if ((uVar15 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x23) != 0)) {
              uVar15 = (uint)param_1[2];
              pbVar25 = param_1 + 2;
              if ((uVar15 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0xef) != 0)) {
                uVar19 = 1;
                pbVar21 = param_1 + 3;
                do {
                  pbVar25 = pbVar21;
                  uVar15 = (uint)*pbVar25;
                  uVar19 = uVar19 + 1;
                  if (0x7f < uVar15) break;
                  pbVar21 = pbVar25 + 1;
                } while ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0xef) != 0);
                if (0x40 < uVar19) goto LAB_00047a68;
              }
              else {
                uVar19 = 1;
              }
              local_78[0] = 1;
              if (uVar15 == 0x2f) {
LAB_00047dcc:
                if (pbVar25[1] != 0x3e) {
LAB_00047a68:
                  DAT_0007bb74 = iVar10;
                  free((void *)__ptr[2]);
                  free(__ptr);
                  return (undefined4 *)0x0;
                }
                param_1 = pbVar25 + 2;
                FUN_0004493c(puVar17,pbVar24,uVar19,0,0);
                DAT_0007bb74 = iVar10;
              }
              else {
                if (uVar15 < 0x30) {
                  if ((uVar15 != 9) && (uVar15 != 0x20)) goto LAB_00047a68;
                  pbVar25 = (byte *)FUN_00046690(pbVar25,&DAT_0007bb74,local_78);
                  if (*pbVar25 != 0x3e) {
                    if (*pbVar25 != 0x2f) goto LAB_00047a68;
                    goto LAB_00047dcc;
                  }
                }
                else if (uVar15 != 0x3e) goto LAB_00047a68;
                pbVar21 = pbVar25 + 1;
                pbVar9 = (byte *)(local_6c + 1);
                local_6c[1] = 0x2f;
                local_6c[0] = '<';
                sVar12 = uVar19;
                do {
                  sVar12 = sVar12 - 1;
                  param_1 = param_1 + 1;
                  pbVar9 = pbVar9 + 1;
                  *pbVar9 = *param_1;
                } while (0 < (int)sVar12);
                sVar12 = uVar19;
                if ((int)uVar19 < 1) {
                  sVar12 = 1;
                }
                local_6c[sVar12 + 2] = '>';
                local_6c[sVar12 + 3] = '\0';
                pcVar14 = strstr((char *)pbVar21,local_6c);
                if (pcVar14 == (char *)0x0) goto LAB_00047a68;
                sVar12 = (int)pcVar14 - (int)pbVar21;
                param_1 = (byte *)(pcVar14 + uVar19 + 3);
                if ((byte)pcVar14[uVar19 + 3] < 0x80) {
                  uVar15 = *(uint *)(&DAT_00069a0c + (uint)(byte)pcVar14[uVar19 + 3] * 4);
                  while ((uVar15 & 0x500) != 0) {
                    param_1 = param_1 + 1;
                    if (0x7f < *param_1) break;
                    uVar15 = *(uint *)(&DAT_00069a0c + (uint)*param_1 * 4);
                  }
                }
                switch(local_78[0]) {
                case 0:
                  FUN_0004493c(puVar17,pbVar24,uVar19,0,0);
                  break;
                case 1:
                  iVar6 = FUN_0004493c(puVar17,pbVar24,uVar19,pbVar21,sVar12);
                  iVar13 = DAT_0007bb74;
                  if (DAT_0007bb74 != 2) {
                    pcVar14 = (char *)(iVar6 + 8);
                    if ((*(byte *)(iVar6 + 8) < 0x80) &&
                       ((*(uint *)(&DAT_00069a0c + (uint)*(byte *)(iVar6 + 8) * 4) & 0x500) != 0)) {
                      pbVar24 = (byte *)(iVar6 + 9);
                      do {
                        pbVar25 = pbVar24;
                        uVar15 = (uint)*pbVar25;
                        pcVar4 = pcVar14;
                        if (0x7f < uVar15) break;
                        pbVar24 = pbVar25 + 1;
                      } while ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x500) != 0);
                      while( true ) {
                        *pcVar4 = (char)uVar15;
                        if (uVar15 == 0) break;
                        pbVar25 = pbVar25 + 1;
                        uVar15 = (uint)*pbVar25;
                        pcVar4 = pcVar4 + 1;
                      }
                    }
                    else {
                      sVar12 = strlen(pcVar14);
                      pcVar4 = (char *)(iVar6 + sVar12 + 8);
                    }
                    if (pcVar14 < pcVar4) {
                      do {
                        if ((0x7f < (byte)pcVar4[-1]) ||
                           ((*(uint *)(&DAT_00069a0c + (uint)(byte)pcVar4[-1] * 4) & 0x500) == 0)) break;
                        pcVar4 = pcVar4 + -1;
                      } while (pcVar4 != pcVar14);
                    }
                    *pcVar4 = '\0';
                    if (((iVar13 != 1) && ((*(char *)(iVar6 + 8) == '\"' || (*(char *)(iVar6 + 8) == '\'')))) &&
                       ((pcVar4[-1] == '\"' || (pcVar4[-1] == '\'')))) {
                      FUN_00047530(pcVar14,0);
                    }
                  }
                  break;
                case 3:
                  local_7c = (undefined4 *)FUN_00044484(uVar19 + 0xd);
                  if (local_7c != (undefined4 *)0x0) {
                    uVar15 = (uint)*pbVar21;
                    if (uVar15 < 0x80) {
                      if ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x500) == 0) {
LAB_0004830c:
                        if (sVar12 != 0) {
                          if ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0xc) == 0) {
                            if ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x40000) == 0) goto LAB_000481a0;
                            uVar8 = 0;
                            goto LAB_000481a4;
                          }
                          lVar7 = strtol((char *)pbVar21,(char **)0x0,10);
                          local_7c[2] = lVar7;
                          goto LAB_000481ac;
                        }
                      }
                      else if (sVar12 != 0) {
                        pbVar21 = pbVar25 + 2;
                        do {
                          uVar15 = (uint)*pbVar21;
                          sVar12 = sVar12 - 1;
                          if (0x7f < uVar15) goto LAB_00048198;
                          if ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x500) == 0) goto LAB_0004830c;
                          pbVar21 = pbVar21 + 1;
                        } while (sVar12 != 0);
                      }
LAB_000482f0:
                      local_7c[2] = 0;
                    }
                    else {
LAB_00048198:
                      if (sVar12 == 0) goto LAB_000482f0;
LAB_000481a0:
                      uVar8 = 1;
LAB_000481a4:
                      local_7c[2] = uVar8;
                    }
LAB_000481ac:
                    uVar8 = 3;
LAB_00048130:
                    *local_7c = uVar8;
                    local_7c[1] = local_7c + 3;
                    memcpy(local_7c + 3,pbVar24,uVar19);
                    *(undefined1 *)(local_7c[1] + uVar19) = 0;
                    FUN_000444c0(puVar17,local_7c);
                  }
                  break;
                case 5:
                  local_7c = (undefined4 *)FUN_00044484(uVar19 + 0xd);
                  if (local_7c != (undefined4 *)0x0) {
                    if ((*pbVar21 < 0x80) && ((*(uint *)(&DAT_00069a0c + (uint)*pbVar21 * 4) & 0x500) != 0)) {
                      if (sVar12 != 0) {
                        pbVar21 = pbVar25 + 2;
                        do {
                          sVar12 = sVar12 - 1;
                          if ((0x7f < *pbVar21) || ((*(uint *)(&DAT_00069a0c + (uint)*pbVar21 * 4) & 0x500) == 0))
                          goto LAB_000480fc;
                          pbVar21 = pbVar21 + 1;
                        } while (sVar12 != 0);
                      }
LAB_000482a8:
                      local_7c[2] = 0;
                    }
                    else {
LAB_000480fc:
                      if (sVar12 == 0) goto LAB_000482a8;
                      lVar7 = strtol((char *)pbVar21,(char **)0x0,0);
                      local_7c[2] = lVar7;
                    }
                    uVar8 = 5;
                    goto LAB_00048130;
                  }
                  break;
                case 6:
                  __dest = (void *)FUN_00044484(sVar12 + 1);
                  if (__dest != (void *)0x0) {
                    memcpy(__dest,pbVar21,sVar12);
                    *(undefined1 *)((int)__dest + sVar12) = 0;
                    if (sVar12 == 0) {
                      puVar3 = (undefined4 *)FUN_00044484(uVar19 + 0xd);
                      if (puVar3 != (undefined4 *)0x0) {
                        puVar3[2] = 0;
                        *puVar3 = 6;
                        puVar3[1] = puVar3 + 3;
                        memcpy(puVar3 + 3,pbVar24,uVar19);
                        *(undefined1 *)(puVar3[1] + uVar19) = 0;
LAB_000480b4:
                        FUN_000444c0(puVar17,puVar3);
                      }
                    }
                    else {
                      puVar3 = (undefined4 *)FUN_00047748(__dest,pbVar24,uVar19);
                      if (puVar3 != (undefined4 *)0x0) goto LAB_000480b4;
                    }
                    free(__dest);
                  }
                }
                DAT_0007bb74 = iVar10;
              }
            }
            else {
              if (uVar15 == 0x21) {
                pcVar14 = strstr((char *)pbVar24,"-->");
                iVar10 = DAT_0007bb74;
                if (pcVar14 == (char *)0x0) goto LAB_00047a68;
                param_1 = (byte *)(pcVar14 + 3);
              }
              else {
                if ((uVar15 != 0x3f) ||
                   (pcVar14 = strchr((char *)pbVar24,0x3e), iVar10 = DAT_0007bb74, pcVar14 == (char *)0x0))
                goto LAB_00047a68;
                param_1 = (byte *)(pcVar14 + 1);
              }
              iVar10 = DAT_0007bb74;
              if (param_1 == (byte *)0x0) goto LAB_00047a68;
            }
            uVar15 = (uint)*param_1;
          } while (uVar15 != 0x2c);
          pbVar25 = param_1 + 1;
          goto LAB_00047b14;
        }
        free(__ptr);
      }
    }
  }
  return (undefined4 *)0x0;
  while ((*(uint *)(&DAT_00069a0c + (uint)param_1[iVar10] * 4) & 0xef) != 0) {
LAB_00047c60:
    pbVar25 = pbVar24;
    iVar10 = iVar10 + 1;
    pbVar24 = pbVar25 + 1;
    if (0x7f < param_1[iVar10]) break;
  }
  uVar15 = (uint)*pbVar25;
LAB_0004789c:
  if (uVar15 == 0x3a) {
    pbVar24 = pbVar24 + -1;
    iVar10 = iVar10 + -1;
    uVar15 = 0x3a;
  }
  else {
    uVar15 = (uint)*pbVar24;
    if (0x7f < uVar15) goto LAB_000478b4;
  }
  uVar19 = *(uint *)(&DAT_00069a0c + uVar15 * 4);
  while ((uVar19 & 0x100) != 0) {
    pbVar24 = pbVar24 + 1;
    uVar15 = (uint)*pbVar24;
    if (0x7f < uVar15) break;
    uVar19 = *(uint *)(&DAT_00069a0c + uVar15 * 4);
  }
LAB_000478b4:
  pbVar25 = pbVar24;
  switch(uVar15) {
  default:
    goto switchD_000478b8_caseD_1;
  case 10:
  case 0x2c:
    pbVar25 = pbVar24 + 1;
  case 0:
    FUN_0004493c(puVar17,param_1,iVar10,0,0);
    goto LAB_00047b14;
  case 0x22:
  case 0x27:
    pbVar21 = pbVar24 + 1;
    goto LAB_00047bcc;
  case 0x3a:
  case 0x3d:
    break;
  }
  do {
    pbVar24 = pbVar24 + 1;
    uVar15 = (uint)*pbVar24;
    if (0x7f < uVar15) break;
  } while ((*(uint *)(&DAT_00069a0c + uVar15 * 4) & 0x100) != 0);
  if (uVar15 == 0x3d || uVar15 == 0x3a) goto switchD_000478b8_caseD_1;
  goto LAB_000478b4;
  while( true ) {
    uVar19 = (uint)*pbVar21;
    pbVar25 = pbVar9;
    if ((uVar19 == 0) ||
       ((pbVar21 = pbVar9 + 2, uVar15 == uVar19 || uVar19 == 0x5c &&
        (pbVar21 = pbVar9 + 3, pbVar25 = pbVar9 + 2, pbVar9[2] == 0)))) break;
LAB_00047bcc:
    do {
      pbVar9 = pbVar21;
      pbVar21 = pbVar9 + 1;
      uVar19 = (uint)*pbVar9;
      pbVar25 = pbVar9;
      if ((uVar19 == 0) || (pbVar25 = pbVar21, uVar15 == uVar19)) goto LAB_00047c24;
    } while (uVar19 != 0x5c);
  }
LAB_00047c24:
  iVar10 = FUN_0004493c(puVar17,param_1,iVar10,pbVar24,(int)pbVar25 - (int)pbVar24);
  if ((iVar10 != 0) && (DAT_0007bb74 == 0)) {
    FUN_00047530(iVar10 + 8);
  }
  goto LAB_00047b14;
switchD_000478b8_caseD_1:
  pbVar21 = pbVar24;
  pbVar25 = pbVar24;
  while (pbVar9 = pbVar25 + 1, uVar15 != 0x2c) {
    if (uVar15 < 0x2d) {
      if (uVar15 == 0) {
        pbVar21 = pbVar25 + -(int)pbVar24;
        goto LAB_00047ca0;
      }
      if ((uVar15 == 10) && (((pbVar9 <= pbVar24 + 2 || (pbVar21[-1] != 0x5c)) || (pbVar21[1] == 0)))) break;
    }
    pbVar21 = pbVar21 + 1;
    pbVar25 = pbVar9;
    uVar15 = (uint)*pbVar21;
  }
  pbVar21 = pbVar9 + (-1 - (int)pbVar24);
  pbVar25 = pbVar9;
LAB_00047ca0:
  iVar10 = FUN_0004493c(puVar17,param_1,iVar10,pbVar24,pbVar21);
  if (iVar10 != 0) {
    pcVar14 = (char *)(iVar10 + 8);
    do {
      for (; *pcVar14 == '\n'; pcVar14 = pcVar14 + 1) {
      }
      pcVar14 = strchr(pcVar14,10);
      if (pcVar14 == (char *)0x0) goto LAB_00047b14;
      pcVar4 = pcVar14 + -1;
      pcVar2 = pcVar14 + -1;
    } while (pcVar14[-1] != '\\');
    while( true ) {
      pcVar11 = pcVar2;
      pcVar14 = pcVar4;
      pcVar4 = pcVar14 + 1;
      cVar1 = *pcVar4;
      *pcVar11 = cVar1;
      if (cVar1 == '\0') break;
      pcVar2 = pcVar11 + 1;
      if ((cVar1 == '\\') && (pcVar14[2] == '\n')) {
        pcVar2 = pcVar11;
      }
    }
  }
LAB_00047b14:
  param_1 = pbVar25;
  if (pbVar25 == (byte *)0x0) {
LAB_000477fc:
    piVar18 = (int *)__ptr[2];
    iVar10 = *piVar18;
    if (iVar10 == 0) {
      return __ptr;
    }
    if (iVar10 < 2) {
      return __ptr;
    }
    iVar13 = 0;
    piVar20 = piVar18;
    iVar6 = 1;
    do {
      iVar22 = piVar20[3];
      iVar23 = piVar18[iVar13 + 2];
      pcVar14 = *(char **)(iVar22 + 4);
      piVar16 = piVar18 + iVar13 + 3;
      do {
        iVar5 = strcmp(*(char **)(iVar23 + 4),pcVar14);
        if (iVar5 < 1) break;
        iVar13 = iVar13 + -1;
        *piVar16 = iVar23;
        iVar23 = piVar16[-2];
        piVar16 = piVar16 + -1;
      } while (-1 < iVar13);
      iVar23 = iVar6 + 1;
      piVar20 = piVar20 + 1;
      piVar18[iVar13 + 3] = iVar22;
      iVar13 = iVar6;
      iVar6 = iVar23;
      if (iVar23 == iVar10) {
        return __ptr;
      }
    } while( true );
  }
  goto LAB_000477d8;
}




undefined4 FUN_0004837c(int param_1,undefined4 param_2)

{
  undefined1 auStack_48 [24];
  undefined4 local_30;
  
  local_30 = param_2;
  (**(code **)(param_1 + 0x28))(3,auStack_48);
  return local_30;
}




undefined4 FUN_00048b94(char *param_1,char *param_2,char *param_3,char *param_4)

{
  byte *pbVar1;
  char *pcVar2;
  size_t sVar3;
  size_t sVar4;
  char *pcVar5;
  int iVar6;
  byte *__s;
  char cVar7;
  uint uVar8;
  
  pcVar2 = (char *)strlen(param_3);
  if (pcVar2 == (char *)0x0 || param_2 <= pcVar2) {
    return 0;
  }
  cVar7 = *param_3;
  pcVar2 = param_1;
  pcVar5 = param_2;
  if (cVar7 == '$') {
    uVar8 = (uint)(byte)param_3[1];
    if (uVar8 == 0x24) {
      if (param_3[2] == '\0') {
        iVar6 = 2;
      }
      else {
        if (param_3[2] != '/') {
          return 0;
        }
        iVar6 = 3;
      }
      pcVar5 = strchr(param_4,0x2f);
      pcVar2 = param_4;
      if (pcVar5 == (char *)0x0) {
        pcVar2 = getenv("PATH");
        pcVar2 = (char *)FUN_000469c8(pcVar2,param_4,&DAT_0006d1bc);
        if (pcVar2 == (char *)0x0) {
          return 0;
        }
      }
      pcVar5 = strrchr(pcVar2,0x2f);
      if (pcVar5 == (char *)0x0) {
        return 0;
      }
      pcVar5 = pcVar5 + (1 - (int)pcVar2);
      sVar3 = strlen(param_3 + iVar6);
      if (param_2 <= pcVar5 + sVar3) {
        return 0;
      }
      memcpy(param_1,pcVar2,(size_t)pcVar5);
      strcpy(param_1 + (int)pcVar5,param_3 + iVar6);
      if (param_4 != pcVar2) {
        free(pcVar2);
      }
    }
    else if (uVar8 == 0x40) {
      if (*DAT_0007bb78 == '\0') {
        return 0;
      }
      iVar6 = snprintf(param_1,(size_t)param_2,"%s%s",DAT_0007bb78,param_3 + 2);
      if ((int)param_2 <= iVar6) {
        return 0;
      }
    }
    else {
      if (uVar8 == 0) {
        return 0;
      }
      if (0x7f < uVar8) {
        return 0;
      }
      if ((*(uint *)(&DAT_00069a0c + uVar8 * 4) & 0xef) == 0) {
        return 0;
      }
      pbVar1 = (byte *)(param_3 + 2);
      do {
        __s = pbVar1;
        pcVar5 = pcVar2 + 1;
        *pcVar2 = (char)uVar8;
        uVar8 = (uint)*__s;
        if (0x7f < uVar8) break;
        pcVar2 = pcVar5;
        pbVar1 = __s + 1;
      } while ((*(uint *)(&DAT_00069a0c + uVar8 * 4) & 0xef) != 0);
      if (param_1 == pcVar5) {
        return 0;
      }
      *pcVar5 = '\0';
      pcVar2 = getenv(param_1);
      if (pcVar2 == (char *)0x0) {
        return 0;
      }
      sVar3 = strlen(pcVar2);
      sVar4 = strlen((char *)__s);
      if (param_2 <= (char *)(sVar3 + sVar4 + 1)) {
        return 0;
      }
      sprintf(param_1,"%s%s",pcVar2,__s);
    }
  }
  else {
    while( true ) {
      *pcVar2 = cVar7;
      if (cVar7 == '\0') break;
      if ((int)(pcVar5 + -1) < 1) {
        return 0;
      }
      param_3 = param_3 + 1;
      cVar7 = *param_3;
      pcVar2 = pcVar2 + 1;
      pcVar5 = pcVar5 + -1;
    }
  }
  pcVar2 = canonicalize_file_name(param_1);
  if (pcVar2 == (char *)0x0) {
    return 0;
  }
  pcVar5 = (char *)strlen(pcVar2);
  if (param_2 <= pcVar5) {
    free(pcVar2);
    return 0;
  }
  memcpy(param_1,pcVar2,(size_t)(pcVar5 + 1));
  free(pcVar2);
  return 1;
}




void FUN_00048e0c(undefined4 *param_1,undefined4 *param_2,char *param_3,undefined4 param_4)

{
  int iVar1;
  char *__filename;
  char *pcVar2;
  stat sStack_1088;
  char acStack_102c [4104];
  
  if (param_1 != (undefined4 *)0x0) {
    fputs(DAT_0007b9cc,DAT_000c9a98);
    pcVar2 = (char *)*param_1;
    *param_2 = 0;
    if (pcVar2 != (char *)0x0) {
      do {
        iVar1 = FUN_00048b94(acStack_102c,0x1001,pcVar2,param_4);
        __filename = pcVar2;
        if (((iVar1 != 0) && (__filename = acStack_102c, *pcVar2 == '$')) && (pcVar2[1] == '$' || pcVar2[1] == '@')) {
          pcVar2 = acStack_102c;
        }
        fprintf(DAT_000c9a98,DAT_0007b9bc,pcVar2);
        if (((*param_3 != '\0') && (iVar1 = __xstat(3,__filename,&sStack_1088), iVar1 == 0)) &&
           ((sStack_1088.st_mode & 0xf000) == 0x4000)) {
          fputc(0x2f,DAT_000c9a98);
          fputs(param_3,DAT_000c9a98);
        }
        fputc(10,DAT_000c9a98);
        param_1 = param_1 + 1;
        pcVar2 = (char *)*param_1;
      } while (pcVar2 != (char *)0x0);
    }
  }
  return;
}




void FUN_00048f3c(undefined4 param_1,undefined4 param_2)

{
  void *__ptr;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  
  local_28 = 0;
  local_24 = 0;
  local_1c = 0;
  local_20 = 1;
  __ptr = (void *)FUN_00044d28(param_2);
  FUN_00044e30(param_1,&local_28,__ptr,1,0);
  free(__ptr);
  return;
}




void FUN_00048f94(int param_1)

{
  __int32_t _Var1;
  tm *__tp;
  __int32_t **pp_Var2;
  char *__haystack;
  FILE *pFVar3;
  char *pcVar4;
  FILE *pFVar5;
  int *piVar6;
  uint uVar7;
  char *pcVar8;
  int iVar9;
  size_t sVar10;
  char *pcVar11;
  int iVar12;
  stat *psVar13;
  int iVar14;
  byte *pbVar15;
  int iVar16;
  undefined4 local_ac;
  stat local_a8;
  
  if ((*(uint *)(DAT_0007b7f4 + 0x50) & 0xf) == 0) {
    if ((*(uint *)(DAT_0007b7f4 + 0x50) & 0x20) == 0) {
      DAT_000c9abc = getenv("SHELL");
      if (DAT_000c9abc == (char *)0x0) {
        DAT_000c9abc = "/bin/bash";
      }
      goto LAB_00048fc8;
    }
    DAT_000c9abc = (char *)0x0;
    uVar7 = *(uint *)(DAT_0007b7f4 + 0x10);
  }
  else {
    DAT_000c9abc = *(char **)(DAT_0007b7f4 + 0x58);
LAB_00048fc8:
    uVar7 = *(uint *)(DAT_0007b7f4 + 0x10);
  }
  if ((uVar7 & 0xf) != 0) {
    pcVar8 = *(char **)(DAT_0007b7f4 + 0x18);
    iVar16 = __xstat(3,pcVar8,&local_a8);
    pcVar11 = DAT_000c9ac0;
    if (iVar16 == 0) {
      if ((local_a8.st_mode & 0xf000) != 0x8000) {
        fprintf(stderr,DAT_0007b994,pcVar8);
                    /* WARNING: Subroutine does not return */
        exit(1);
      }
      __haystack = (char *)FUN_00044484(local_a8.st_size + 1);
      pFVar3 = fopen(pcVar8,"r");
      pcVar11 = __haystack;
      do {
        sVar10 = fread(pcVar11,1,local_a8.st_size,pFVar3);
        if (sVar10 == 0) break;
        local_a8.st_size = local_a8.st_size - sVar10;
        pcVar11 = pcVar11 + sVar10;
      } while (local_a8.st_size != 0);
      *pcVar11 = '\0';
      fclose(pFVar3);
      pcVar4 = strstr(__haystack,"# # # # # # # # # # -- do not modify this marker --\n#\n#  DO NOT EDIT THIS SECTION");
      pcVar11 = __haystack;
      if (pcVar4 != (char *)0x0) {
        *pcVar4 = '\0';
        pcVar4 = strstr(pcVar4 + 1,
                        "\n# # # # # # # # # #\n#\n#  END OF AUTOMATED OPTION PROCESSING\n#\n# # # # # # # # # # -- do not modify this marker --\n"
                       );
        if (pcVar4 != (char *)0x0) {
          pcVar11 = pcVar4 + 0x73;
          DAT_000c9ac4 = __haystack;
        }
      }
    }
    DAT_000c9ac0 = pcVar11;
    pFVar5 = freopen(pcVar8,"w",stdout);
    pFVar3 = stderr;
    pcVar11 = DAT_0007b8e4;
    if (stdout != pFVar5) {
      piVar6 = __errno_location();
      iVar16 = *piVar6;
      pcVar8 = strerror(iVar16);
      fprintf(pFVar3,pcVar11,iVar16,pcVar8);
                    /* WARNING: Subroutine does not return */
      exit(1);
    }
  }
  if (DAT_000c9ac4 == (char *)0x0) {
    pcVar11 = (char *)0x0;
  }
  else {
    fputs(DAT_000c9ac4,stdout);
    pcVar11 = DAT_000c9ac4;
  }
  local_ac = time((time_t *)0x0);
  __tp = localtime(&local_ac);
  strftime((char *)&local_a8,0x80,"%A %B %e, %Y at %r %Z",__tp);
  if ((*(uint *)(DAT_0007b7f4 + 0x10) & 0xf) == 0) {
    pcVar8 = "stdout";
  }
  else {
    pcVar8 = *(char **)(DAT_0007b7f4 + 0x18);
  }
  if ((pcVar11 == (char *)0x0) && (DAT_000c9abc != (char *)0x0)) {
    printf("#! %s\n");
  }
  printf("%s OF %s\n#\n#  From here to the next `-- do not modify this marker --\',\n#  the text has been generated %s\n"
         ,"# # # # # # # # # # -- do not modify this marker --\n#\n#  DO NOT EDIT THIS SECTION",pcVar8,&local_a8);
  printf("#  From the %s option definitions\n#\n",*(undefined4 *)(param_1 + 0x20));
  pbVar15 = *(byte **)(param_1 + 0x20);
  pp_Var2 = __ctype_tolower_loc();
  pcVar11 = (char *)((int)&local_ac + 3);
  do {
    _Var1 = (*pp_Var2)[*pbVar15];
    pcVar11 = pcVar11 + 1;
    *pcVar11 = (char)_Var1;
    pbVar15 = pbVar15 + 1;
  } while ((char)_Var1 != '\0');
  *(stat **)(param_1 + 0x18) = &local_a8;
  *(stat **)(param_1 + 0x1c) = &local_a8;
  FUN_00044070(param_1,0,0);
  FUN_00044070(param_1,1,0);
  iVar14 = *(int *)(param_1 + 0x44);
  iVar16 = iVar14;
  if (*(code **)(iVar14 + 0x28) == FUN_00042398) {
LAB_000490fc:
    FUN_00044070(param_1,2,iVar16);
    iVar14 = *(int *)(param_1 + 0x44);
  }
  else {
    iVar12 = *(int *)(param_1 + 100) + -1;
    iVar9 = iVar14;
    if (0 < iVar12) {
      do {
        iVar16 = iVar9 + 0x40;
        if (*(code **)(iVar9 + 0x68) == FUN_00042398) goto LAB_000490fc;
        iVar12 = iVar12 + -1;
        iVar9 = iVar9 + 0x40;
      } while (iVar12 != 0);
    }
  }
  iVar16 = *(int *)(param_1 + 0x68);
  if (0 < iVar16) {
    do {
      if (((*(uint *)(iVar14 + 0x10) & 0x280000) == 0) && (iVar9 = *(int *)(iVar14 + 0x30), iVar9 != 0)) {
        pcVar11 = "\n%1$s_%2$s=\"${%1$s_%2$s-\'%3$s\'}\"\n%1$s_%2$s_set=false\nexport %1$s_%2$s\n";
        if (1 < *(ushort *)(iVar14 + 0xc)) {
          pcVar11 = 
          "\nif test -z \"${%1$s_%2$s}\"\nthen\n  %1$s_%2$s_CT=0\nelse\n  %1$s_%2$s_CT=1\n  %1$s_%2$s_1=\"${%1$s_%2$s}\"\nfi\nexport %1$s_%2$s_CT"
          ;
        }
        psVar13 = &local_a8;
        switch((*(uint *)(iVar14 + 0x10) << 0x10) >> 0x1c) {
        case 2:
          (**(code **)(iVar14 + 0x28))(2,iVar14);
          iVar9 = *(int *)(iVar14 + 0x30);
          psVar13 = *(stat **)(iVar14 + 0x18);
          break;
        case 3:
          psVar13 = (stat *)"false";
          if (*(int *)(iVar14 + 0x18) != 0) {
            psVar13 = (stat *)&DAT_00062908;
          }
          break;
        case 4:
          snprintf((char *)&local_a8,0x10,"%lu",*(undefined4 *)(iVar14 + 0x18));
          iVar9 = *(int *)(iVar14 + 0x30);
          break;
        case 5:
          snprintf((char *)&local_a8,0x10,"%d",*(undefined4 *)(iVar14 + 0x18));
          iVar9 = *(int *)(iVar14 + 0x30);
          break;
        default:
          psVar13 = *(stat **)(iVar14 + 0x18);
          if ((psVar13 == (stat *)0x0) &&
             (pcVar11 == "\n%1$s_%2$s=\"${%1$s_%2$s-\'%3$s\'}\"\n%1$s_%2$s_set=false\nexport %1$s_%2$s\n")) {
            pcVar11 = "\n%1$s_%2$s=\"${%1$s_%2$s}\"\n%1$s_%2$s_set=false\nexport %1$s_%2$s\n";
          }
        }
        printf(pcVar11,*(undefined4 *)(param_1 + 0x20),iVar9,psVar13);
      }
      iVar16 = iVar16 + -1;
      iVar14 = iVar14 + 0x40;
    } while (iVar16 != 0);
  }
  uVar7 = *(uint *)(param_1 + 0xc) & 3;
  if (uVar7 == 2) {
    pcVar11 = 
    "\nOPT_PROCESS=true\nOPT_ARG=\"$1\"\n\nwhile ${OPT_PROCESS} && [ $# -gt 0 ]\ndo\n    OPT_ELEMENT=\'\'\n    OPT_ARG_VAL=\'\'\n\n    case \"${OPT_ARG}\" in\n    -- )\n        OPT_PROCESS=false\n        shift\n        ;;\n\n"
    ;
    sVar10 = 0xc5;
  }
  else {
    if (uVar7 != 3) {
      if (uVar7 == 1) {
        fwrite("\nOPT_PROCESS=true\nOPT_ARG=\"$1\"\n\nwhile ${OPT_PROCESS} && [ $# -gt 0 ]\ndo\n    OPT_ELEMENT=\'\'\n    OPT_ARG_VAL=\'\'\n\n    case \"${OPT_ARG}\" in\n    -- )\n        OPT_PROCESS=false\n        shift\n        ;;\n\n"
               ,1,0xc5,stdout);
        fwrite("    --* )\n",1,10,stdout);
        fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\"|sed \'s/^X-*//\'`\n        shift\n        OPT_ARG=\"$1\"\n\n        case \"${OPT_CODE}\" in *=* )\n            OPT_ARG_VAL=`echo \"${OPT_CODE}\"|sed \'s/^[^=]*=//\'`\n            OPT_CODE=`echo \"${OPT_CODE}\"|sed \'s/=.*$//\'` ;; esac\n\n"
               ,1,0xfe,stdout);
        FUN_00043c4c(param_1);
        printf("        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n            OPT_ARG_VAL=\'\'\n            ;;\n\n        YES )\n            if [ -z \"${OPT_ARG_VAL}\" ]\n            then\n                if [ $# -eq 0 ]\n                then\n                    echo No argument provided for ${OPT_NAME} option >&2\n                    echo \"$%s_USAGE_TEXT\"\n                    exit 1\n                fi\n\n                OPT_ARG_VAL=\"${OPT_ARG}\"\n                shift\n                OPT_ARG=\"$1\"\n            fi\n            ;;\n\n        OK )\n            if [ -z \"${OPT_ARG_VAL}\" ] && [ $# -gt 0 ]\n            then\n                case \"${OPT_ARG}\" in -* ) ;; * )\n                    OPT_ARG_VAL=\"${OPT_ARG}\"\n                    shift\n                    OPT_ARG=\"$1\" ;; esac\n            fi\n            ;;\n        esac\n"
               ,*(undefined4 *)(param_1 + 0x20));
        fwrite("        ;;\n\n",1,0xc,stdout);
        fwrite("    * )\n         OPT_PROCESS=false\n         ;;\n    esac\n\n",1,0x39,stdout);
      }
      else {
        fwrite("\nOPT_ARG=\"$1\"\n\nwhile [ $# -gt 0 ]\ndo\n    OPT_ELEMENT=\'\'\n    OPT_ARG_VAL=\'\'\n\n    OPT_ARG=\"${1}\"\n"
               ,1,0x5f,stdout);
        fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\"|sed \'s/^X-*//\'`\n        shift\n        OPT_ARG=\"$1\"\n\n        case \"${OPT_CODE}\" in *=* )\n            OPT_ARG_VAL=`echo \"${OPT_CODE}\"|sed \'s/^[^=]*=//\'`\n            OPT_CODE=`echo \"${OPT_CODE}\"|sed \'s/=.*$//\'` ;; esac\n\n"
               ,1,0xfe,stdout);
        FUN_00043c4c(param_1);
        printf("        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n            OPT_ARG_VAL=\'\'\n            ;;\n\n        YES )\n            if [ -z \"${OPT_ARG_VAL}\" ]\n            then\n                if [ $# -eq 0 ]\n                then\n                    echo No argument provided for ${OPT_NAME} option >&2\n                    echo \"$%s_USAGE_TEXT\"\n                    exit 1\n                fi\n\n                OPT_ARG_VAL=\"${OPT_ARG}\"\n                shift\n                OPT_ARG=\"$1\"\n            fi\n            ;;\n\n        OK )\n            if [ -z \"${OPT_ARG_VAL}\" ] && [ $# -gt 0 ]\n            then\n                case \"${OPT_ARG}\" in -* ) ;; * )\n                    OPT_ARG_VAL=\"${OPT_ARG}\"\n                    shift\n                    OPT_ARG=\"$1\" ;; esac\n            fi\n            ;;\n        esac\n"
               ,*(undefined4 *)(param_1 + 0x20));
      }
      goto LAB_000491fc;
    }
    fwrite("\nOPT_PROCESS=true\nOPT_ARG=\"$1\"\n\nwhile ${OPT_PROCESS} && [ $# -gt 0 ]\ndo\n    OPT_ELEMENT=\'\'\n    OPT_ARG_VAL=\'\'\n\n    case \"${OPT_ARG}\" in\n    -- )\n        OPT_PROCESS=false\n        shift\n        ;;\n\n"
           ,1,0xc5,stdout);
    fwrite("    --* )\n",1,10,stdout);
    fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\"|sed \'s/^X-*//\'`\n        shift\n        OPT_ARG=\"$1\"\n\n        case \"${OPT_CODE}\" in *=* )\n            OPT_ARG_VAL=`echo \"${OPT_CODE}\"|sed \'s/^[^=]*=//\'`\n            OPT_CODE=`echo \"${OPT_CODE}\"|sed \'s/=.*$//\'` ;; esac\n\n"
           ,1,0xfe,stdout);
    FUN_00043c4c(param_1);
    printf("        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n            OPT_ARG_VAL=\'\'\n            ;;\n\n        YES )\n            if [ -z \"${OPT_ARG_VAL}\" ]\n            then\n                if [ $# -eq 0 ]\n                then\n                    echo No argument provided for ${OPT_NAME} option >&2\n                    echo \"$%s_USAGE_TEXT\"\n                    exit 1\n                fi\n\n                OPT_ARG_VAL=\"${OPT_ARG}\"\n                shift\n                OPT_ARG=\"$1\"\n            fi\n            ;;\n\n        OK )\n            if [ -z \"${OPT_ARG_VAL}\" ] && [ $# -gt 0 ]\n            then\n                case \"${OPT_ARG}\" in -* ) ;; * )\n                    OPT_ARG_VAL=\"${OPT_ARG}\"\n                    shift\n                    OPT_ARG=\"$1\" ;; esac\n            fi\n            ;;\n        esac\n"
           ,*(undefined4 *)(param_1 + 0x20));
    pcVar11 = "        ;;\n\n";
    sVar10 = 0xc;
  }
  fwrite(pcVar11,1,sVar10,stdout);
  fwrite("    -* )\n",1,9,stdout);
  fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\" | sed \'s/X-\\(.\\).*/\\1/\'`\n        OPT_ARG=` echo \"X${OPT_ARG}\" | sed \'s/X-.//\'`\n\n"
         ,1,0x75,stdout);
  FUN_00043a28(param_1);
  printf("        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n            if [ -n \"${OPT_ARG}\" ]\n            then\n                OPT_ARG=-\"${OPT_ARG}\"\n            else\n                shift\n                OPT_ARG=\"$1\"\n            fi\n            ;;\n\n        YES )\n            if [ -n \"${OPT_ARG}\" ]\n            then\n                OPT_ARG_VAL=\"${OPT_ARG}\"\n\n            else\n                if [ $# -eq 0 ]\n                then\n                    echo No argument provided for ${OPT_NAME} option >&2\n                    echo \"$%s_USAGE_TEXT\"\n                    exit 1\n                fi\n                shift\n                OPT_ARG_VAL=\"$1\"\n            fi\n\n            shift\n            OPT_ARG=\"$1\"\n            ;;\n\n        OK )\n            if [ -n \"${OPT_ARG}\" ]\n            then\n                OPT_ARG_VAL=\"${OPT_ARG}\"\n                shift\n                OPT_ARG=\"$1\"\n\n            else\n                shift\n                if [ $# -gt 0 ]\n                then\n                    case \"$1\" in -* ) ;; * )\n                        OPT_ARG_VAL=\"$1\"\n                        shift ;; esac\n                    OPT_ARG=\"$1\"\n                fi\n            fi\n            ;;\n        esac\n"
         ,*(undefined4 *)(param_1 + 0x20));
  fwrite("        ;;\n\n",1,0xc,stdout);
  fwrite("    * )\n         OPT_PROCESS=false\n         ;;\n    esac\n\n",1,0x39,stdout);
LAB_000491fc:
  printf("    if [ -n \"${OPT_ARG_VAL}\" ]\n    then\n        eval %1$s_${OPT_NAME}${OPT_ELEMENT}=\"\'${OPT_ARG_VAL}\'\"\n        export %1$s_${OPT_NAME}${OPT_ELEMENT}\n    fi\ndone\n\nunset OPT_PROCESS || :\nunset OPT_ELEMENT || :\nunset OPT_ARG || :\nunset OPT_ARG_NEEDED || :\nunset OPT_NAME || :\nunset OPT_CODE || :\nunset OPT_ARG_VAL || :\n%2$s"
         ,*(undefined4 *)(param_1 + 0x20),
         "\n# # # # # # # # # #\n#\n#  END OF AUTOMATED OPTION PROCESSING\n#\n# # # # # # # # # # -- do not modify this marker --\n"
        );
  if ((DAT_000c9ac0 == (char *)0x0) || (*DAT_000c9ac0 == '\0')) {
    if ((*(uint *)(DAT_0007b7f4 + 0x50) & 0x20) == 0) {
      printf("\nenv | grep \'^%s_\'\n",*(undefined4 *)(param_1 + 0x20));
    }
  }
  else {
    fputs(DAT_000c9ac0,stdout);
  }
  fflush(stdout);
  fchmod(1,0x1ed);
  fclose(stdout);
  iVar16 = ferror(stdout);
  if (iVar16 != 0) {
    fputs(DAT_0007b9b8,stderr);
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  return;
}




void FUN_000496e8(int *param_1)

{
  int *piVar1;
  
  if (param_1 == (int *)0x0) {
    return;
  }
  if (*param_1 != 6) {
    piVar1 = __errno_location();
    *piVar1 = 0x16;
    return;
  }
  FUN_00042960(param_1[2]);
  free(param_1);
  return;
}




void FUN_0004994c(int param_1)

{
  char *pcVar1;
  void *__ptr;
  __int32_t **pp_Var2;
  undefined4 uVar3;
  undefined4 uVar4;
  uint uVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  byte *pbVar9;
  int *piVar10;
  int iVar11;
  int *piVar12;
  byte *pbVar13;
  bool bVar14;
  uint local_30;
  int local_2c;
  
  local_30 = 0;
  printf("OPTION_CT=%d\nexport OPTION_CT\n",*(int *)(param_1 + 0x10) + -1);
  do {
    iVar11 = *(int *)(param_1 + 0x44) + local_30 * 0x40;
    uVar6 = *(uint *)(iVar11 + 0x10);
    if (((uVar6 & 0x280000) == 0) && (*(short *)(iVar11 + 8) == -0x8000)) {
      iVar8 = iVar11;
      if (*(ushort *)(iVar11 + 4) != local_30) {
        iVar8 = *(int *)(param_1 + 0x44) + (uint)*(ushort *)(iVar11 + 4) * 0x40;
        uVar4 = *(undefined4 *)(iVar11 + 0x30);
        *(undefined4 *)(iVar8 + 0x18) = *(undefined4 *)(iVar11 + 0x18);
        uVar6 = *(uint *)(iVar8 + 0x10) & 0xffffff80;
        *(uint *)(iVar8 + 0x10) = uVar6;
        uVar3 = *(undefined4 *)(param_1 + 0x20);
        *(uint *)(iVar8 + 0x10) = *(uint *)(iVar11 + 0x10) & 0x7f | uVar6;
        printf("%1$s_%2$s_MODE=\'%3$s\'\nexport %1$s_%2$s_MODE\n",uVar3,uVar4,*(undefined4 *)(iVar8 + 0x30));
        uVar6 = *(uint *)(iVar8 + 0x10);
      }
      uVar5 = (uVar6 << 0x10) >> 0x1c;
      if (uVar5 == 4) {
        printf("%1$s_%2$s=%3$d # 0x%3$X\nexport %1$s_%2$s\n",*(undefined4 *)(param_1 + 0x20),
               *(undefined4 *)(iVar8 + 0x30),*(undefined4 *)(iVar8 + 0x1c));
        *(undefined4 *)(iVar8 + 0x1c) = 0xffffffff;
        (**(code **)(iVar8 + 0x28))(3,iVar8);
        __ptr = *(void **)(iVar8 + 0x18);
        if (*(char *)((int)__ptr + 7) != '\0') {
          local_2c = 1;
          pbVar9 = (byte *)((int)__ptr + 7);
          do {
            printf("typeset -x -i %s_",*(undefined4 *)(iVar8 + 0x30));
            uVar6 = (uint)*pbVar9;
            if (uVar6 < 0x80) {
              uVar5 = *(uint *)(&DAT_00069a0c + uVar6 * 4);
              while ((uVar5 & 0x4500) != 0) {
                pbVar9 = pbVar9 + 1;
                uVar6 = (uint)*pbVar9;
                if (0x7f < uVar6) break;
                uVar5 = *(uint *)(&DAT_00069a0c + uVar6 * 4);
              }
            }
LAB_00049cc8:
            if (0x7f < uVar6) {
LAB_00049cb0:
              bVar14 = uVar6 == 0;
              uVar6 = 0x5f;
              pbVar13 = pbVar9;
              if (bVar14) goto LAB_00049cfc;
LAB_00049cbc:
              fputc(uVar6,stdout);
LAB_00049cc4:
              uVar6 = (uint)pbVar9[1];
              pbVar9 = pbVar9 + 1;
              goto LAB_00049cc8;
            }
            uVar5 = *(uint *)(&DAT_00069a0c + uVar6 * 4);
            if ((uVar5 & 1) != 0) {
              pp_Var2 = __ctype_toupper_loc();
              fputc((*pp_Var2)[uVar6],stdout);
              goto LAB_00049cc4;
            }
            if ((uVar5 & 2) != 0) goto LAB_00049cbc;
            pbVar13 = pbVar9 + 1;
            if ((uVar5 & 0x4500) == 0) goto LAB_00049cb0;
LAB_00049cfc:
            printf("=%1$lu # 0x%1$lX\n",local_2c);
            local_2c = local_2c << 1;
            pbVar9 = pbVar13;
          } while (*pbVar13 != 0);
          __ptr = *(void **)(iVar8 + 0x18);
        }
        free(__ptr);
        *(undefined4 *)(iVar8 + 0x18) = 0;
        *(uint *)(iVar8 + 0x10) = *(uint *)(iVar8 + 0x10) & 0xffffffbf;
      }
      else if ((*(uint *)(iVar8 + 0x10) & 0x2f) != 0x20) {
        if (((uVar6 & 0x400) == 0) || (piVar10 = *(int **)(iVar8 + 0x1c), piVar10 == (int *)0x0)) {
          if ((uVar6 & 0x20) == 0) {
            if (uVar5 == 5) {
              printf("%1$s_%2$s=%3$d # 0x%3$X\nexport %1$s_%2$s\n",*(undefined4 *)(param_1 + 0x20),
                     *(undefined4 *)(iVar8 + 0x30),*(undefined4 *)(iVar8 + 0x18));
            }
            else if (uVar5 == 2) {
              uVar3 = *(undefined4 *)(iVar8 + 0x18);
              printf("%s_%s=",*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(iVar8 + 0x30));
              (**(code **)(iVar8 + 0x28))(3,iVar8);
              printf("\'%s\'",*(undefined4 *)(iVar8 + 0x18));
              if ((*(uint *)(iVar8 + 0x10) & 0x40) != 0) {
                free(*(void **)(iVar8 + 0x18));
              }
              *(undefined4 *)(iVar8 + 0x18) = uVar3;
              printf("\nexport %s_%s\n",*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(iVar8 + 0x30));
            }
            else if (uVar5 == 3) {
              pcVar1 = "true";
              if (*(int *)(iVar8 + 0x18) == 0) {
                pcVar1 = "false";
              }
              printf("%1$s_%2$s=\'%3$s\'\nexport %1$s_%2$s\n",*(undefined4 *)(param_1 + 0x20),
                     *(undefined4 *)(iVar8 + 0x30),pcVar1);
            }
            else if ((*(char **)(iVar8 + 0x18) == (char *)0x0) || (**(char **)(iVar8 + 0x18) == '\0')) {
              printf("%1$s_%2$s=%3$d # 0x%3$X\nexport %1$s_%2$s\n",*(undefined4 *)(param_1 + 0x20),
                     *(undefined4 *)(iVar8 + 0x30),(uint)*(ushort *)(iVar8 + 0xe));
            }
            else {
              printf("%s_%s=",*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(iVar8 + 0x30));
              FUN_00044368(*(undefined4 *)(iVar8 + 0x18));
              printf("\nexport %s_%s\n",*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(iVar8 + 0x30));
            }
          }
          else {
            pcVar1 = *(char **)(iVar8 + 0x3c);
            if (*(char **)(iVar8 + 0x3c) == (char *)0x0) {
              pcVar1 = "false";
            }
            printf("%1$s_%2$s=%3$s\nexport %1$s_%2$s\n",*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(iVar8 + 0x30),
                   pcVar1);
          }
        }
        else {
          iVar11 = *piVar10;
          printf("%1$s_%2$s_CT=%3$d\nexport %1$s_%2$s_CT\n",*(undefined4 *)(param_1 + 0x20),
                 *(undefined4 *)(iVar8 + 0x30),iVar11);
          iVar11 = iVar11 + -1;
          piVar12 = piVar10 + 2;
          if (-1 < iVar11) {
            do {
              printf("%s_%s_%d=",*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(iVar8 + 0x30),*piVar10 - iVar11);
              FUN_00044368(*piVar12);
              iVar7 = *piVar10 - iVar11;
              iVar11 = iVar11 + -1;
              printf("\nexport %s_%s_%d\n",*(undefined4 *)(param_1 + 0x20),*(undefined4 *)(iVar8 + 0x30),iVar7);
              piVar12 = piVar12 + 1;
            } while (iVar11 != -1);
          }
        }
      }
    }
    local_30 = local_30 + 1;
    if (*(int *)(param_1 + 0x68) <= (int)local_30) {
      if (((*(uint *)(param_1 + 0xc) & 0x800) != 0) && (*(uint *)(param_1 + 0x10) < *(uint *)(param_1 + 4))) {
        fwrite("set --",1,6,stdout);
        iVar11 = *(int *)(param_1 + 0x10);
        if (iVar11 < *(int *)(param_1 + 4)) {
          iVar8 = iVar11 << 2;
          do {
            pbVar9 = *(byte **)(*(int *)(param_1 + 8) + iVar8);
            pcVar1 = strchr((char *)pbVar9,0x27);
            if (pcVar1 == (char *)0x0) {
              printf(" \'%s\'",pbVar9);
            }
            else {
              fwrite(&DAT_0006d258,1,2,stdout);
              while( true ) {
                uVar6 = (uint)*pbVar9;
                if (uVar6 == 0) break;
                if (uVar6 == 0x27) {
                  fwrite(&DAT_0006d154,1,4,stdout);
                  pbVar9 = pbVar9 + 1;
                }
                else {
                  fputc(uVar6,stdout);
                  pbVar9 = pbVar9 + 1;
                }
              }
              fputc(0x27,stdout);
            }
            iVar11 = iVar11 + 1;
            iVar8 = iVar8 + 4;
          } while (iVar11 < *(int *)(param_1 + 4));
        }
        fwrite("\nOPTION_CT=0\n",1,0xd,stdout);
      }
      fflush(stdout);
      return;
    }
  } while( true );
}




void FUN_00049e90(int *param_1,int param_2)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  int iVar4;
  undefined4 local_28;
  undefined4 local_24;
  undefined4 local_20;
  undefined4 local_1c;
  
  pbVar3 = *(byte **)(param_2 + 0x18);
  local_28 = 0;
  local_24 = 0;
  local_1c = 0;
  local_20 = 4;
  if (DAT_000c9ac8 != 0) {
    return;
  }
  if ((*param_1 < 0x20000) || (param_1[0x1e] == 0)) {
    fputs(DAT_0007b9fc,stderr);
                    /* WARNING: Subroutine does not return */
    _exit(0x46);
  }
  if ((pbVar3 == (byte *)0x0) || (bVar1 = *pbVar3, bVar1 == 0)) {
    fputs(DAT_0007b970,stderr);
    (*(code *)param_1[0x15])(param_1,1);
                    /* WARNING: Subroutine does not return */
    __assert_fail("0 == 1","reset.c",0x5b,"optionResetOpt");
  }
  DAT_000c9ac8 = 1;
  if (pbVar3[1] == 0) {
    if (bVar1 == 0x2a) {
      iVar4 = param_1[0x11];
      iVar2 = param_1[0x1a];
      while( true ) {
        iVar2 = iVar2 + -1;
        FUN_00041cec(param_1,iVar4);
        if (iVar2 < 1) break;
        iVar4 = iVar4 + 0x40;
      }
      DAT_000c9ac8 = 0;
      return;
    }
    iVar2 = FUN_00041f8c(param_1,bVar1,&local_28);
    if (iVar2 != 0) {
      fprintf(stderr,DAT_0007b924,param_1[6],(uint)*pbVar3);
      (*(code *)param_1[0x15])(param_1,1);
                    /* WARNING: Subroutine does not return */
      __assert_fail("0 == 1","reset.c",0x6c,"optionResetOpt");
    }
  }
  else {
    iVar2 = FUN_00042bb4(param_1,pbVar3,&local_28);
    if (iVar2 != 0) {
      fprintf(stderr,DAT_0007b928,param_1[6],pbVar3);
      (*(code *)param_1[0x15])(param_1,1);
                    /* WARNING: Subroutine does not return */
      __assert_fail("0 == 1","reset.c",0x74,"optionResetOpt");
    }
  }
  FUN_00041cec(param_1,local_28);
  DAT_000c9ac8 = 0;
  return;
}




void FUN_0004a068(void *param_1)

{
  undefined4 *puVar1;
  undefined4 uVar2;
  uint uVar3;
  undefined *puVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  void *__dest;
  int iVar9;
  
  __dest = *(void **)((int)param_1 + 0x50);
  if (__dest == (void *)0x0) {
    iVar7 = *(int *)((int)param_1 + 100) * 0x40 + 0x84;
    __dest = (void *)FUN_00044484(iVar7);
    if (__dest == (void *)0x0) {
      puVar4 = *(undefined **)((int)param_1 + 0x1c);
      if (*(undefined **)((int)param_1 + 0x1c) == (undefined *)0x0) {
        puVar4 = *(undefined **)((int)param_1 + 0x20);
        if (*(undefined **)((int)param_1 + 0x20) == (undefined *)0x0) {
          puVar4 = &DAT_00069c54;
        }
      }
      fprintf(stderr,DAT_0007b8a4,puVar4,iVar7);
                    /* WARNING: Subroutine does not return */
      exit(1);
    }
    *(void **)((int)param_1 + 0x50) = __dest;
  }
  memcpy(__dest,param_1,0x84);
  memcpy((void *)((int)__dest + 0x84),*(void **)((int)param_1 + 0x44),*(int *)((int)__dest + 100) << 6);
  iVar9 = *(int *)((int)param_1 + 0x50);
  iVar7 = *(int *)((int)param_1 + 0x44);
  iVar8 = *(int *)((int)param_1 + 100) + -1;
  if (*(int *)((int)param_1 + 100) < 1) {
    return;
  }
  do {
    while( true ) {
      uVar3 = *(uint *)(iVar7 + 0x10);
      uVar5 = (uVar3 << 0x10) >> 0x1c;
      if (uVar5 == 1) break;
      if (uVar5 == 6) {
        *(undefined4 *)(*(int *)(iVar9 + 0x44) + (iVar7 - *(int *)((int)param_1 + 0x44) & 0xffffffc0U) + 0x1c) = 0;
      }
LAB_00044db4:
      iVar8 = iVar8 + -1;
      iVar7 = iVar7 + 0x40;
      if (iVar8 == -1) {
        return;
      }
    }
    if ((uVar3 & 0x400) != 0) {
      *(undefined4 *)(*(int *)(iVar9 + 0x44) + (iVar7 - *(int *)((int)param_1 + 0x44) & 0xffffffc0U) + 0x1c) = 0;
    }
    if ((uVar3 & 0x40) == 0) goto LAB_00044db4;
    iVar8 = iVar8 + -1;
    iVar6 = *(int *)(iVar9 + 0x44);
    uVar3 = iVar7 - *(int *)((int)param_1 + 0x44);
    puVar1 = (undefined4 *)(iVar7 + 0x18);
    iVar7 = iVar7 + 0x40;
    uVar2 = FUN_00044d28(*puVar1);
    *(undefined4 *)(iVar6 + (uVar3 & 0xffffffc0) + 0x18) = uVar2;
    if (iVar8 == -1) {
      return;
    }
  } while( true );
}




void FUN_0004a118(void *param_1)

{
  uint uVar1;
  int iVar2;
  void *__src;
  int iVar3;
  
  do {
    iVar2 = *(int *)((int)param_1 + 0x44);
    iVar3 = *(int *)((int)param_1 + 100);
    do {
      while( true ) {
        uVar1 = *(uint *)(iVar2 + 0x10);
        iVar3 = iVar3 + -1;
        if ((uVar1 & 0x40) != 0) {
          free(*(void **)(iVar2 + 0x18));
          *(undefined4 *)(iVar2 + 0x18) = 0;
          uVar1 = *(uint *)(iVar2 + 0x10) & 0xffffffbf;
          *(uint *)(iVar2 + 0x10) = uVar1;
        }
        if (((uVar1 << 0x10) >> 0x1c == 6) && (*(int *)(iVar2 + 0x1c) != 0)) break;
        *(undefined4 *)(iVar2 + 0x1c) = 0;
        iVar2 = iVar2 + 0x40;
        if (iVar3 < 1) goto LAB_0004a1a4;
      }
      FUN_00042960();
      *(undefined4 *)(iVar2 + 0x1c) = 0;
      iVar2 = iVar2 + 0x40;
    } while (0 < iVar3);
LAB_0004a1a4:
    __src = *(void **)((int)param_1 + 0x50);
    if (__src == (void *)0x0) {
      return;
    }
    memcpy(param_1,__src,0x84);
    memcpy(*(void **)((int)param_1 + 0x44),(void *)((int)__src + 0x84),*(int *)((int)__src + 100) << 6);
    free(*(void **)((int)param_1 + 0x50));
    *(undefined4 *)((int)param_1 + 0x50) = 0;
  } while( true );
}




void FUN_0004a1e4(void *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uVar1;
  uint uVar2;
  undefined *puVar3;
  uint uVar4;
  int iVar5;
  int iVar6;
  int iVar7;
  void *__src;
  int iVar8;
  int iVar9;
  
  __src = *(void **)((int)param_1 + 0x50);
  if (__src == (void *)0x0) {
    puVar3 = *(undefined **)((int)param_1 + 0x1c);
    if (*(undefined **)((int)param_1 + 0x1c) == (undefined *)0x0) {
      puVar3 = *(undefined **)((int)param_1 + 0x20);
      if (*(undefined **)((int)param_1 + 0x20) == (undefined *)0x0) {
        puVar3 = &DAT_00069c54;
      }
    }
    fprintf(stderr,DAT_0007b980,puVar3,&DAT_0007b7b0,param_4);
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  *(undefined4 *)((int)param_1 + 0x50) = 0;
  FUN_0004a118();
  memcpy(param_1,__src,0x84);
  memcpy(*(void **)((int)param_1 + 0x44),(void *)((int)__src + 0x84),*(int *)((int)__src + 100) << 6);
  *(void **)((int)param_1 + 0x50) = __src;
  iVar8 = *(int *)((int)param_1 + 0x50);
  iVar6 = *(int *)((int)param_1 + 0x44);
  iVar7 = *(int *)((int)param_1 + 100) + -1;
  if (0 < *(int *)((int)param_1 + 100)) {
    do {
      uVar2 = *(uint *)(iVar6 + 0x10);
      uVar4 = (uVar2 << 0x10) >> 0x1c;
      if (uVar4 == 1) {
        if ((uVar2 & 0x400) != 0) {
          *(undefined4 *)(*(int *)(iVar8 + 0x44) + (iVar6 - *(int *)((int)param_1 + 0x44) & 0xffffffc0U) + 0x1c) = 0;
        }
        if ((uVar2 & 0x40) != 0) {
          iVar9 = *(int *)((int)param_1 + 0x44);
          iVar5 = *(int *)(iVar8 + 0x44);
          uVar1 = FUN_00044d28(*(undefined4 *)(iVar6 + 0x18));
          *(undefined4 *)(iVar5 + (iVar6 - iVar9 & 0xffffffc0U) + 0x18) = uVar1;
        }
      }
      else if (uVar4 == 6) {
        *(undefined4 *)(*(int *)(iVar8 + 0x44) + (iVar6 - *(int *)((int)param_1 + 0x44) & 0xffffffc0U) + 0x1c) = 0;
      }
      iVar6 = iVar6 + 0x40;
      iVar7 = iVar7 + -1;
    } while (iVar7 != -1);
    return;
  }
  return;
}




/* WARNING: Removing unreachable block (ram,0x0004a3d0) */
/* WARNING: Removing unreachable block (ram,0x0004a600) */

void FUN_0004a280(int *param_1)

{
  byte bVar1;
  char *__format;
  char *pcVar2;
  FILE *pFVar3;
  int iVar4;
  int *piVar5;
  char *pcVar6;
  uint uVar7;
  int iVar8;
  byte *pbVar9;
  ushort *puVar10;
  int iVar11;
  ushort *puVar12;
  int *piVar13;
  int iVar14;
  undefined4 uVar15;
  time_t local_2c [2];
  
  pcVar2 = (char *)FUN_00044588();
  if (pcVar2 != (char *)0x0) {
    pFVar3 = fopen(pcVar2,"w");
    if (pFVar3 == (FILE *)0x0) {
      fprintf(stderr,"%s WARNING:  cannot save options - ",param_1[7]);
      pFVar3 = stderr;
      __format = DAT_0007b95c;
      piVar5 = __errno_location();
      iVar11 = *piVar5;
      pcVar6 = strerror(iVar11);
      fprintf(pFVar3,__format,iVar11,pcVar6,pcVar2);
    }
    else {
      pbVar9 = (byte *)param_1[0xe];
      fwrite(&DAT_0006d26c,1,3,pFVar3);
      do {
        fputc((uint)*pbVar9,pFVar3);
        bVar1 = *pbVar9;
        pbVar9 = pbVar9 + 1;
      } while (bVar1 != 10);
      local_2c[0] = time((time_t *)0x0);
      pcVar2 = ctime(local_2c);
      fprintf(pFVar3,DAT_0007b9c8,pcVar2);
      iVar11 = param_1[0x1a];
      puVar10 = (ushort *)param_1[0x11];
      do {
        uVar7 = *(uint *)(puVar10 + 8);
        if ((((uVar7 & 0xf) != 0) && ((uVar7 & 0x280100) == 0)) && ((puVar10[4] == 0x8000 || (*puVar10 == puVar10[4]))))
        {
          puVar12 = puVar10;
          if ((uVar7 & 0x10) != 0) {
            puVar12 = (ushort *)(param_1[0x11] + (uint)puVar10[2] * 0x40);
          }
          switch((uVar7 << 0x10) >> 0x1c) {
          case 0:
            if ((*(uint *)(puVar12 + 8) & 0x20) == 0) {
              iVar8 = *(int *)(puVar10 + 0x1a);
            }
            else {
              iVar8 = *(int *)(puVar10 + 0x1c);
            }
            if (iVar8 == 0) {
              iVar8 = *(int *)(puVar10 + 0x1a);
            }
            fprintf(pFVar3,"%s\n",iVar8);
            break;
          case 1:
            if ((*(uint *)(puVar12 + 8) & 0x400) == 0) goto switchD_0004a3a8_caseD_5;
            piVar5 = *(int **)(puVar12 + 0xe) + 2;
            iVar8 = **(int **)(puVar12 + 0xe);
            if (iVar8 < 2) {
              iVar4 = iVar8 + -1;
              if (iVar8 < 1) break;
            }
            else {
              iVar4 = iVar8 + -1;
              *(uint *)(puVar12 + 8) = *(uint *)(puVar12 + 8) & 0xffffffdf;
            }
            do {
              iVar4 = iVar4 + -1;
              FUN_000425b4(pFVar3,puVar12,*piVar5);
              piVar5 = piVar5 + 1;
            } while (iVar4 != -1);
            break;
          case 2:
            uVar15 = *(undefined4 *)(puVar12 + 0xc);
            (**(code **)(puVar12 + 0x14))(3,puVar12);
            FUN_000425b4(pFVar3,puVar12,*(undefined4 *)(puVar12 + 0xc));
            *(undefined4 *)(puVar12 + 0xc) = uVar15;
            break;
          case 3:
            pcVar2 = "false";
            if (*(int *)(puVar12 + 0xc) != 0) {
              pcVar2 = "true";
            }
            FUN_000425b4(pFVar3,puVar12,pcVar2);
            break;
          case 4:
            uVar15 = *(undefined4 *)(puVar12 + 0xc);
            (**(code **)(puVar12 + 0x14))(3,puVar12);
            FUN_000425b4(pFVar3,puVar12,*(undefined4 *)(puVar12 + 0xc));
            if (*(void **)(puVar12 + 0xc) != (void *)0x0) {
              free(*(void **)(puVar12 + 0xc));
              *(uint *)(puVar12 + 8) = *(uint *)(puVar12 + 8) & 0xffffffbf;
            }
            *(undefined4 *)(puVar12 + 0xc) = uVar15;
            break;
          case 5:
switchD_0004a3a8_caseD_5:
            FUN_000425b4(pFVar3,puVar12,*(undefined4 *)(puVar12 + 0xc));
            break;
          case 6:
            piVar5 = *(int **)(puVar12 + 0xe);
            if (piVar5 != (int *)0x0) {
              piVar13 = piVar5 + 2;
              iVar8 = *piVar5;
              if (0 < iVar8) {
                do {
                  iVar14 = *piVar13;
                  iVar4 = FUN_00046f84(iVar14,0);
                  if (iVar4 != 0) {
                    fprintf(pFVar3,"<%s type=nested>\n",*(undefined4 *)(puVar12 + 0x1a));
                    do {
                      FUN_00043530(pFVar3,1,puVar12,iVar4);
                      iVar4 = FUN_000470f4(iVar14,iVar4);
                    } while (iVar4 != 0);
                    fprintf(pFVar3,"</%s>\n",*(undefined4 *)(puVar12 + 0x1a));
                  }
                  iVar8 = iVar8 + -1;
                  piVar13 = piVar13 + 1;
                } while (iVar8 != 0);
              }
            }
            break;
          case 7:
            if ((*(int *)(puVar12 + 0xe) != 0) ||
               ((0x1ffff < *param_1 && (*(int *)(param_1[0x1d] + (uint)*puVar12 * 4) != *(int *)(puVar12 + 0xc))))) {
              FUN_000425b4(pFVar3,puVar12);
            }
          }
        }
        iVar11 = iVar11 + -1;
        puVar10 = puVar10 + 0x20;
      } while (0 < iVar11);
      fclose(pFVar3);
    }
  }
  return;
}




void FUN_0004a66c(undefined4 param_1,int param_2)

{
  char *pcVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int iVar5;
  int *piVar6;
  int *__ptr;
  int iVar7;
  char *__s;
  bool bVar8;
  
  uVar3 = *(uint *)(param_2 + 0x10);
  if ((uVar3 & 8) != 0) {
    return;
  }
  __ptr = *(int **)(param_2 + 0x1c);
  if (__ptr == (int *)0x0) {
    *(uint *)(param_2 + 0x10) = uVar3 & 0xffffff80;
    if ((uVar3 & 0x800) == 0) {
      *(uint *)(param_2 + 0x10) = uVar3 & 0xffffff80 | 0x20;
    }
    return;
  }
  iVar7 = *__ptr;
  if (0 < iVar7) {
    iVar4 = 0;
    iVar5 = 0;
    piVar6 = __ptr;
    do {
      while( true ) {
        __s = (char *)piVar6[2];
        pcVar1 = strchr(__s,0x3d);
        if (pcVar1 != (char *)0x0) break;
        iVar2 = strcmp(__s,*(char **)(param_2 + 0x18));
        if (iVar2 != 0) goto LAB_0004a6a4;
LAB_0004a700:
        iVar4 = iVar4 + 1;
        free(__s);
        piVar6 = piVar6 + 1;
        *__ptr = *__ptr + -1;
        if (iVar4 == iVar7) goto LAB_0004a724;
      }
      *pcVar1 = '\0';
      iVar2 = strcmp(__s,*(char **)(param_2 + 0x18));
      if (iVar2 == 0) goto LAB_0004a700;
      *pcVar1 = '=';
LAB_0004a6a4:
      iVar2 = iVar5 + 2;
      bVar8 = iVar5 != iVar4;
      iVar4 = iVar4 + 1;
      iVar5 = iVar5 + 1;
      if (bVar8) {
        __ptr[iVar2] = (int)__s;
      }
      piVar6 = piVar6 + 1;
    } while (iVar4 != iVar7);
LAB_0004a724:
    iVar7 = *__ptr;
  }
  if (iVar7 != 0) {
    return;
  }
  uVar3 = *(uint *)(param_2 + 0x10) & 0xffffff80;
  if ((*(uint *)(param_2 + 0x10) & 0x800) == 0) {
    uVar3 = uVar3 | 0x20;
  }
  *(uint *)(param_2 + 0x10) = uVar3;
  free(__ptr);
  *(undefined4 *)(param_2 + 0x1c) = 0;
  return;
}




void * FUN_0004a988(char *param_1,uint param_2,uint param_3,int *param_4)

{
  int iVar1;
  int *piVar2;
  void *pvVar3;
  size_t __len;
  uint uVar4;
  uint uVar5;
  stat sStack_70;
  
  memset(param_4,0,0x24);
  param_4[4] = -1;
  param_4[3] = -1;
  iVar1 = __xstat(3,param_1,&sStack_70);
  if (iVar1 == 0) {
    if ((sStack_70.st_mode & 0xf000) == 0x8000) {
      uVar4 = param_2 & 2;
      param_4[1] = sStack_70.st_size;
      if (uVar4 != 0) {
        if ((param_3 & 3) == 1) {
          uVar4 = 2;
        }
        else {
          uVar4 = 0;
        }
        if ((param_3 & 1) == 0) {
          uVar4 = uVar4 | 0x80;
        }
      }
      iVar1 = open(param_1,uVar4);
      param_4[3] = iVar1;
      if (iVar1 != -1) {
        pvVar3 = mmap((void *)0x0,param_4[1] + 1,param_2,param_3,iVar1,0);
        *param_4 = (int)pvVar3;
        if (pvVar3 == (void *)0xffffffff) {
          piVar2 = __errno_location();
          iVar1 = *piVar2;
          param_4[5] = iVar1;
          if (-1 < param_4[3]) {
            close(param_4[3]);
            iVar1 = param_4[5];
            param_4[3] = -1;
          }
          *piVar2 = iVar1;
          *param_4 = -1;
          return (void *)0xffffffff;
        }
        param_4[5] = 0;
        param_4[4] = -1;
        __len = sysconf(0x1e);
        uVar5 = param_4[1];
        uVar4 = (__len + uVar5) - 1 & -__len;
        param_4[2] = uVar4;
        if (uVar5 == uVar4) {
          param_4[2] = __len + uVar5;
          pvVar3 = mmap((void *)(*param_4 + uVar5),__len,3,0x32,-1,0);
          if (pvVar3 == (void *)0xffffffff) {
            piVar2 = __errno_location();
            iVar1 = *piVar2;
            param_4[2] = param_4[1];
            param_4[5] = iVar1;
            pvVar3 = (void *)FUN_00044484(param_4[1] + 1);
            memcpy(pvVar3,(void *)*param_4,param_4[1]);
            *(undefined1 *)((int)pvVar3 + param_4[1]) = 0;
            munmap((void *)*param_4,param_4[1]);
            *param_4 = (int)pvVar3;
            param_4[8] = 1;
            return pvVar3;
          }
        }
        return (void *)*param_4;
      }
      piVar2 = __errno_location();
      param_4[5] = *piVar2;
      return (void *)0xffffffff;
    }
    piVar2 = __errno_location();
    *piVar2 = 0x16;
    param_4[5] = 0x16;
  }
  else {
    piVar2 = __errno_location();
    param_4[5] = *piVar2;
  }
  return (void *)0xffffffff;
}




uint FUN_0004ab84(undefined4 *param_1)

{
  uint *puVar1;
  __off_t _Var2;
  ssize_t sVar3;
  uint uVar4;
  uint uVar5;
  
  if (param_1[8] == 0) {
    uVar5 = munmap((void *)*param_1,param_1[2]);
    puVar1 = (uint *)__errno_location();
LAB_0004abc8:
    if ((uVar5 == 0) && (uVar5 = close(param_1[3]), uVar5 == 0)) {
      param_1[3] = 0xffffffff;
      *puVar1 = 0;
      if (param_1[4] == -1) {
        uVar4 = 0;
      }
      else {
        uVar5 = close(param_1[4]);
        param_1[4] = 0xffffffff;
        uVar4 = *puVar1;
      }
      goto LAB_0004abd8;
    }
  }
  else {
    uVar5 = param_1[6] & 2;
    if (uVar5 == 0) {
LAB_0004ac70:
      puVar1 = (uint *)__errno_location();
LAB_0004abbc:
      free((void *)*param_1);
      *puVar1 = uVar5;
      goto LAB_0004abc8;
    }
    if ((param_1[7] & 2) != 0) {
      puVar1 = (uint *)__errno_location();
      uVar5 = 0;
      goto LAB_0004abbc;
    }
    _Var2 = lseek(param_1[3],0,0);
    uVar5 = 0;
    if (_Var2 == 0) {
      sVar3 = write(param_1[3],(void *)*param_1,param_1[1]);
      if (-1 < sVar3) {
        uVar5 = 0;
        goto LAB_0004ac70;
      }
      puVar1 = (uint *)__errno_location();
      uVar5 = *puVar1;
      goto LAB_0004abbc;
    }
  }
  puVar1 = (uint *)__errno_location();
  uVar4 = *puVar1;
LAB_0004abd8:
  param_1[5] = uVar4;
  return uVar5;
}




void FUN_0004ac8c(int param_1,undefined4 param_2,int param_3)

{
  undefined4 *puVar1;
  ushort uVar2;
  byte *pbVar3;
  byte *pbVar4;
  size_t sVar5;
  int iVar6;
  byte *pbVar7;
  int iVar8;
  uint uVar9;
  byte bVar10;
  uint uVar11;
  ulong uVar12;
  byte *pbVar13;
  char *pcVar14;
  int iVar15;
  undefined4 uVar16;
  bool bVar17;
  byte *local_c4;
  byte *local_bc;
  int local_b0;
  byte *local_ac;
  int local_a8 [3];
  undefined4 local_9c;
  undefined4 local_98;
  undefined4 local_94;
  undefined4 local_90;
  undefined1 auStack_8c [36];
  byte local_68;
  byte local_67;
  undefined1 local_66;
  
  local_94 = 2;
  local_9c = 0;
  local_98 = 0;
  local_90 = 0;
  pbVar3 = (byte *)FUN_0004a988(param_2,3,2,auStack_8c);
  if (pbVar3 != (byte *)0xffffffff) {
    if (param_3 == 0) {
      uVar16 = 4;
      param_3 = 1;
    }
    else {
      uVar16 = 2;
    }
    if ((*(uint *)(param_1 + 0xc) & 0x80000) == 0) {
      uVar16 = 1;
    }
    do {
      uVar11 = (uint)*pbVar3;
      local_94 = uVar16;
      if (uVar11 < 0x80) {
        uVar9 = *(uint *)(&DAT_00069a0c + uVar11 * 4);
        while ((uVar9 & 0x500) != 0) {
          pbVar3 = pbVar3 + 1;
          uVar11 = (uint)*pbVar3;
          if (0x7f < uVar11) goto LAB_0004ad28;
          uVar9 = *(uint *)(&DAT_00069a0c + uVar11 * 4);
        }
        if ((uVar9 & 0x23) == 0) goto LAB_0004ad28;
        pbVar4 = pbVar3 + 1;
        pbVar13 = (byte *)strchr((char *)pbVar4,10);
        if (pbVar13 == (byte *)0x0) {
          sVar5 = strlen((char *)pbVar4);
          pbVar4 = pbVar4 + sVar5;
        }
        else {
          uVar11 = (uint)pbVar3[1];
          if (uVar11 < 0x80) {
            uVar9 = *(uint *)(&DAT_00069a0c + uVar11 * 4);
            if ((uVar9 & 0xef) != 0) {
              pbVar7 = pbVar3 + 2;
              do {
                pbVar4 = pbVar7;
                uVar11 = (uint)*pbVar4;
                if (0x7f < uVar11) goto joined_r0x0004ae64;
                uVar9 = *(uint *)(&DAT_00069a0c + uVar11 * 4);
                pbVar7 = pbVar4 + 1;
              } while ((uVar9 & 0xef) != 0);
            }
            while ((uVar9 & 0x500) != 0) {
              pbVar4 = pbVar4 + 1;
              uVar11 = (uint)*pbVar4;
              if (0x7f < uVar11) break;
              uVar9 = *(uint *)(&DAT_00069a0c + uVar11 * 4);
            }
          }
joined_r0x0004ae64:
          if (pbVar13 < pbVar4) {
LAB_0004ae68:
            *pbVar13 = 0;
            pbVar4 = pbVar13 + 1;
            FUN_00044e30(param_1,&local_9c,pbVar3,param_3,1);
          }
          else {
            if (uVar11 == 0x3d || uVar11 == 0x3a) {
              do {
                pbVar4 = pbVar4 + 1;
                if (0x7f < *pbVar4) break;
              } while ((*(uint *)(&DAT_00069a0c + (uint)*pbVar4 * 4) & 0x500) != 0);
              if (pbVar13 < pbVar4) goto LAB_0004ae68;
            }
            else if ((0x7f < pbVar4[-1]) || ((*(uint *)(&DAT_00069a0c + (uint)pbVar4[-1] * 4) & 0x500) == 0)) break;
            if (pbVar13[-1] == 0x5c) {
              pbVar7 = pbVar13 + -1;
LAB_0004b0d8:
              pbVar4 = pbVar13 + 1;
              bVar10 = *pbVar13;
              if (bVar10 == 0x5c) {
                if (pbVar13[1] == 10) {
                  bVar10 = 10;
                  pbVar4 = pbVar13 + 2;
                }
LAB_0004b114:
                pbVar13 = pbVar4;
                *pbVar7 = bVar10;
                pbVar7 = pbVar7 + 1;
                goto LAB_0004b0d8;
              }
              if (0x5c < bVar10) goto LAB_0004b114;
              if (bVar10 != 0) {
                if (bVar10 == 10) goto LAB_0004b0f8;
                goto LAB_0004b114;
              }
              pbVar4 = (byte *)0x0;
LAB_0004b0f8:
              *pbVar7 = 0;
            }
            else {
              pbVar4 = pbVar13 + 1;
              *pbVar13 = 0;
            }
            FUN_00044e30(param_1,&local_9c,pbVar3,param_3,1);
          }
        }
      }
      else {
LAB_0004ad28:
        if (uVar11 == 0x3c) {
          uVar11 = (uint)pbVar3[1];
          if ((uVar11 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar11 * 4) & 0x23) != 0)) {
            pbVar7 = pbVar3 + 1;
            local_b0 = DAT_0007bb74;
            pbVar13 = pbVar7;
            if ((pbVar3[1] < 0x80) && ((*(uint *)(&DAT_00069a0c + (uint)pbVar3[1] * 4) & 0xef) != 0)) {
              pbVar3 = pbVar3 + 2;
              do {
                pbVar13 = pbVar3;
                if (0x7f < *pbVar13) break;
                pbVar3 = pbVar13 + 1;
              } while ((*(uint *)(&DAT_00069a0c + (uint)*pbVar13 * 4) & 0xef) != 0);
            }
            local_a8[0] = 1;
            bVar10 = *pbVar13;
            local_c4 = pbVar13;
            if (bVar10 == 0x2f) {
LAB_0004b194:
              if (local_c4[1] != 0x3e) break;
              pbVar4 = local_c4 + 2;
              *local_c4 = 0;
              FUN_00044e30(param_1,&local_9c,pbVar7,param_3,local_b0);
            }
            else {
              if (bVar10 < 0x30) {
                if ((bVar10 == 9) || (bVar10 == 0x20)) {
                  local_c4 = (byte *)FUN_00046690(pbVar13,&local_b0,local_a8);
                  if (*local_c4 == 0x3e) goto LAB_0004b1d8;
                  if (*local_c4 == 0x2f) goto LAB_0004b194;
                  break;
                }
              }
              else if (bVar10 == 0x3e) {
LAB_0004b1d8:
                *pbVar13 = 0;
                pbVar3 = local_c4 + 1;
                sVar5 = strlen((char *)pbVar7);
                iVar6 = local_b0;
                uVar11 = sVar5 + 4;
                if (uVar11 < 0x41) {
                  sprintf((char *)&local_68,"</%s>",pbVar7);
                  local_c4[1] = 0x20;
                  pcVar14 = strstr((char *)pbVar3,(char *)&local_68);
                }
                else {
                  pbVar4 = (byte *)FUN_00044484(uVar11);
                  sprintf((char *)pbVar4,"</%s>",pbVar7);
                  local_c4[1] = 0x20;
                  pcVar14 = strstr((char *)pbVar3,(char *)pbVar4);
                  if (pbVar4 != &local_68) {
                    free(pbVar4);
                  }
                }
                local_bc = &local_68;
                if (pcVar14 != (char *)0x0) {
                  if (iVar6 != 1) {
                    bVar10 = pcVar14[-1];
                    while ((bVar10 < 0x80 && ((*(uint *)(&DAT_00069a0c + (uint)bVar10 * 4) & 0x500) != 0))) {
                      uVar11 = uVar11 + 1;
                      bVar10 = pcVar14[-2];
                      pcVar14 = pcVar14 + -1;
                    }
                  }
                  *pcVar14 = '\0';
                  pbVar4 = (byte *)(pcVar14 + (uVar11 - 1));
                  if (pbVar4 != (byte *)0x0) {
                    memset(pbVar13,0x20,(int)pbVar3 - (int)pbVar13);
                    if ((local_a8[0] == 1) && (local_b0 == 0)) {
                      local_66 = 0;
                      local_c4 = local_c4 + 2;
                      do {
                        pbVar13 = pbVar3 + 1;
                        bVar10 = *pbVar3;
                        if (bVar10 == 0x25) {
                          local_68 = pbVar3[1];
                          local_67 = pbVar3[2];
                          pbVar13 = pbVar3 + 3;
                          if ((local_68 == 0) || (local_67 == 0)) {
LAB_0004b490:
                            local_c4[-1] = 0;
                            break;
                          }
                          uVar12 = strtoul((char *)local_bc,(char **)0x0,0x10);
                          bVar10 = (byte)uVar12;
LAB_0004b3a8:
                          local_c4[-1] = bVar10;
                        }
                        else {
                          if (bVar10 != 0x26) {
                            if (bVar10 != 0) goto LAB_0004b3a8;
                            local_c4[-1] = 0;
                            break;
                          }
                          uVar11 = (uint)pbVar3[1];
                          if (uVar11 == 0x23) {
                            pbVar13 = pbVar3 + 2;
                            uVar11 = (uint)pbVar3[2];
LAB_0004b4ac:
                            if ((uVar11 == 0x58) || (uVar11 == 0x78)) {
                              iVar6 = 0x10;
                              local_ac = pbVar13 + 1;
                            }
                            else {
                              local_ac = pbVar13;
                              if (uVar11 == 0x30) {
                                if (pbVar13[1] == 0x30) {
                                  iVar6 = 0x10;
                                }
                                else {
                                  iVar6 = 10;
                                }
                              }
                              else {
                                iVar6 = 10;
                              }
                            }
                            uVar12 = strtoul((char *)local_ac,(char **)&local_ac,iVar6);
                            if ((*local_ac != 0x3b) || (0x7f < uVar12)) goto LAB_0004b490;
                            pbVar13 = local_ac + 1;
                          }
                          else {
                            local_ac = pbVar13;
                            if (uVar11 < 0x80) {
                              if ((*(uint *)(&DAT_00069a0c + uVar11 * 4) & 0xc) != 0) goto LAB_0004b4ac;
                              iVar6 = 0;
                              iVar15 = 0;
                            }
                            else {
                              iVar6 = 0;
                              iVar15 = 0;
                            }
                            while( true ) {
                              puVar1 = (undefined4 *)((int)&DAT_0006b718 + iVar6);
                              uVar2 = *(ushort *)((int)&DAT_0006b71c + iVar6);
                              iVar6 = iVar6 + 8;
                              iVar8 = strncmp((char *)pbVar13,(char *)*puVar1,(uint)uVar2);
                              if (iVar8 == 0) break;
                              iVar15 = iVar15 + 1;
                              if (iVar15 == 0xc) goto LAB_0004b490;
                            }
                            pbVar13 = pbVar13 + uVar2;
                            uVar12 = (ulong)*(short *)(&DAT_0006b71e + iVar15 * 8);
                          }
                          local_c4[-1] = (byte)uVar12;
                          if (uVar12 == 0) break;
                        }
                        local_c4 = local_c4 + 1;
                        pbVar3 = pbVar13;
                      } while( true );
                    }
                    FUN_00044e30(param_1,&local_9c,pbVar7,param_3,local_b0);
                    goto LAB_0004ae00;
                  }
                }
                break;
              }
              pcVar14 = strchr((char *)pbVar13,0x3e);
              if (pcVar14 == (char *)0x0) break;
              pbVar4 = (byte *)(pcVar14 + 1);
            }
          }
          else if (uVar11 == 0x2f) {
            pcVar14 = strchr((char *)(pbVar3 + 2),0x3e);
            pbVar4 = (byte *)(pcVar14 + 1);
            if (pcVar14 == (char *)0x0) break;
          }
          else if (uVar11 == 0x3f) {
            if (DAT_000c9acc == (char *)0x0) {
              DAT_000c9acc = DAT_0007b8ac;
              DAT_000c9ad0 = DAT_0007b8a8;
            }
            iVar6 = 0;
            pcVar14 = DAT_000c9acc;
            do {
              sVar5 = strlen(pcVar14);
              iVar15 = strncmp((char *)(pbVar3 + 2),pcVar14,sVar5);
              if ((iVar15 == 0) &&
                 ((0x7f < pbVar3[sVar5 + 2] || ((*(uint *)(&DAT_00069a0c + (uint)pbVar3[sVar5 + 2] * 4) & 0xef) == 0))))
              {
                pbVar4 = (byte *)(*(code *)(&DAT_0006b778)[iVar6])(param_1,pbVar3 + sVar5 + 2);
                goto LAB_0004ae00;
              }
              bVar17 = iVar6 != 1;
              iVar6 = 1;
              pcVar14 = DAT_000c9ad0;
            } while (bVar17);
            pcVar14 = strchr((char *)(pbVar3 + 2),0x3e);
            if (pcVar14 == (char *)0x0) break;
            pbVar4 = (byte *)(pcVar14 + 1);
          }
          else {
            if ((uVar11 != 0x21) || (pcVar14 = strstr((char *)pbVar3,"-->"), pcVar14 == (char *)0x0)) break;
            pbVar4 = (byte *)(pcVar14 + 3);
          }
        }
        else {
          if (uVar11 == 0x5b) {
            pcVar14 = *(char **)(param_1 + 0x20);
            sVar5 = strlen(pcVar14);
            iVar6 = strncmp((char *)(pbVar3 + 1),pcVar14,sVar5);
            if ((iVar6 == 0) && (pbVar3[sVar5 + 1] == 0x5d)) {
              pbVar4 = (byte *)strchr((char *)(pbVar3 + sVar5 + 2),10);
              goto LAB_0004ae00;
            }
            if (0x10 < sVar5) break;
            sprintf((char *)&local_68,"[%s]",pcVar14);
            pbVar3 = (byte *)strstr((char *)pbVar3,(char *)&local_68);
            if (pbVar3 == (byte *)0x0) break;
          }
          else {
            if (uVar11 != 0x23) break;
            pbVar3 = pbVar3 + 1;
          }
          pbVar4 = (byte *)strchr((char *)pbVar3,10);
        }
      }
LAB_0004ae00:
      pbVar3 = pbVar4;
    } while (pbVar4 != (byte *)0x0);
    FUN_0004ab84(auStack_8c);
  }
  return;
}




void FUN_0004b584(int param_1,int param_2)

{
  char *__format;
  FILE *__stream;
  int iVar1;
  int *piVar2;
  char *pcVar3;
  stat sStack_70;
  
  if ((*(uint *)(param_2 + 0x10) & 0x28) == 0) {
    iVar1 = __xstat(3,*(char **)(param_2 + 0x18),&sStack_70);
    __stream = stderr;
    __format = DAT_0007b8e8;
    if (iVar1 == 0) {
      if ((sStack_70.st_mode & 0xf000) == 0x8000) {
        FUN_0004ac8c(param_1,*(undefined4 *)(param_2 + 0x18));
      }
      else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
        fprintf(stderr,DAT_0007b994,*(undefined4 *)(param_2 + 0x18));
                    /* WARNING: Subroutine does not return */
        exit(0x42);
      }
    }
    else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
      piVar2 = __errno_location();
      iVar1 = *piVar2;
      pcVar3 = strerror(iVar1);
      fprintf(__stream,__format,iVar1,pcVar3,*(undefined4 *)(param_2 + 0x18));
                    /* WARNING: Subroutine does not return */
      exit(0x42);
    }
  }
  return;
}




void FUN_0004b664(int param_1)

{
  char *pcVar1;
  int iVar2;
  size_t sVar3;
  size_t sVar4;
  char *__s;
  int *piVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  char *__filename;
  int iVar9;
  uint uVar10;
  stat sStack_1088;
  char acStack_102d [4105];
  
  iVar7 = *(int *)(param_1 + 0x34);
  if (iVar7 != 0) {
    iVar8 = *(int *)(iVar7 + 4);
    uVar10 = *(uint *)(param_1 + 0xc);
    *(uint *)(param_1 + 0xc) = uVar10 & 0xfffffffb;
    if (iVar8 != 0) {
      piVar5 = (int *)(iVar7 + 4);
      iVar8 = 0;
      do {
        piVar5 = piVar5 + 1;
        iVar8 = iVar8 + 1;
      } while (*piVar5 != 0);
    }
    __filename = acStack_102d + 1;
    iVar9 = -1;
    while( true ) {
      if (iVar8 != -1) {
        iVar6 = iVar8;
        iVar2 = iVar8 << 2;
      }
      else {
        iVar6 = 0;
        iVar2 = iVar6;
      }
      if (iVar8 == -1) {
        iVar9 = 1;
      }
      if (*(int *)(iVar7 + iVar2) == 0) break;
      iVar8 = iVar6 + iVar9;
      iVar7 = FUN_00048b94(__filename,0x1001,*(int *)(iVar7 + iVar2),*(undefined4 *)(param_1 + 0x18));
      if ((iVar7 != 0) && (iVar7 = __xstat(3,__filename,&sStack_1088), iVar7 == 0)) {
        if ((sStack_1088.st_mode & 0xf000) == 0x4000) {
          sVar3 = strlen(__filename);
          __s = *(char **)(param_1 + 0x24);
          sVar4 = strlen(__s);
          if (0x1000 < sVar3 + 1 + sVar4 + 1) goto LAB_0004b6c4;
          pcVar1 = __filename;
          if (acStack_102d[sVar3] != '/') {
            pcVar1 = acStack_102d + 2;
          }
          if (acStack_102d[sVar3] != '/') {
            __filename[sVar3] = '/';
          }
          memcpy(pcVar1 + sVar3,__s,sVar4 + 1);
        }
        FUN_0004ac8c(param_1,__filename,iVar9);
        if (((*(uint *)(*(int *)(param_1 + 0x44) + (uint)*(ushort *)(param_1 + 0x5e) * 0x40 + 0x50) & 0x20) != 0) &&
           (iVar9 == -1)) {
          iVar9 = 1;
          iVar8 = iVar6;
        }
      }
LAB_0004b6c4:
      iVar7 = *(int *)(param_1 + 0x34);
    }
    *(uint *)(param_1 + 0xc) = uVar10;
  }
  return;
}




undefined4 FUN_0004b7c8(int param_1,undefined4 param_2)

{
  int iVar1;
  
  iVar1 = FUN_000433d8();
  if (iVar1 == 0) {
    *(undefined4 *)(param_1 + 0x1c) = param_2;
    FUN_0004b664(param_1);
    return 0;
  }
  return 0xffffffff;
}




int FUN_0004b7fc(char *param_1)

{
  undefined4 uVar1;
  int iVar2;
  size_t sVar3;
  int *piVar4;
  int iVar5;
  undefined1 auStack_3c [36];
  
  uVar1 = DAT_0007bb74;
  iVar2 = FUN_0004a988(param_1,1,2,auStack_3c);
  if (iVar2 == -1) {
    iVar2 = 0;
  }
  else {
    DAT_0007bb74 = 0;
    sVar3 = strlen(param_1);
    iVar2 = FUN_00047748(iVar2,param_1,sVar3);
    if (iVar2 == 0) {
      piVar4 = __errno_location();
      iVar5 = *piVar4;
      FUN_0004ab84(auStack_3c);
      *piVar4 = iVar5;
      DAT_0007bb74 = uVar1;
    }
    else {
      FUN_0004ab84(auStack_3c);
      DAT_0007bb74 = uVar1;
    }
  }
  return iVar2;
}




int * FUN_0004b894(byte *param_1)

{
  byte bVar1;
  int *piVar2;
  uint uVar3;
  byte *pbVar4;
  byte bVar5;
  uint uVar6;
  int iVar7;
  int iVar8;
  byte *pbVar9;
  byte *pbVar10;
  byte local_19;
  
  if (param_1 != (byte *)0x0) {
    uVar6 = (uint)*param_1;
    pbVar4 = param_1;
    if (uVar6 < 0x80) {
      uVar3 = *(uint *)(&DAT_00069a0c + uVar6 * 4);
      while ((uVar3 & 0x500) != 0) {
        pbVar4 = pbVar4 + 1;
        uVar6 = (uint)*pbVar4;
        if (0x7f < uVar6) break;
        uVar3 = *(uint *)(&DAT_00069a0c + uVar6 * 4);
      }
    }
    if (uVar6 != 0) {
      iVar8 = 2;
      pbVar10 = pbVar4;
      do {
        iVar8 = iVar8 + 1;
        pbVar9 = pbVar10 + 1;
        while( true ) {
          pbVar10 = pbVar9;
          uVar6 = (uint)*pbVar10;
          if ((uVar6 < 0x80) && (pbVar9 = pbVar10 + 1, (*(uint *)(&DAT_00069a0c + uVar6 * 4) & 0x500) != 0)) break;
          pbVar9 = pbVar10 + 1;
          if (uVar6 == 0) goto LAB_0004b938;
        }
        do {
          pbVar10 = pbVar9;
          uVar6 = (uint)*pbVar10;
          if (0x7f < uVar6) break;
          pbVar9 = pbVar10 + 1;
        } while ((*(uint *)(&DAT_00069a0c + uVar6 * 4) & 0x500) != 0);
      } while (uVar6 != 0);
LAB_0004b938:
      piVar2 = (int *)FUN_00044484(pbVar10 + ((iVar8 * 4 + 8) - (int)pbVar4));
      if (piVar2 == (int *)0x0) {
        piVar2 = __errno_location();
        *piVar2 = 0xc;
        return (int *)0x0;
      }
      iVar7 = 0;
      pbVar4 = (byte *)(piVar2 + iVar8);
      piVar2[1] = (int)pbVar4;
      do {
        *piVar2 = iVar7 + 1;
        piVar2[iVar7 + 1] = (int)pbVar4;
        uVar6 = (uint)*param_1;
        pbVar10 = pbVar4;
LAB_0004b97c:
        do {
          if ((uVar6 < 0x80) && ((*(uint *)(&DAT_00069a0c + uVar6 * 4) & 0x500) != 0)) break;
          if (uVar6 == 0x22) {
            pbVar4 = param_1 + 1;
LAB_0004ba70:
            param_1 = pbVar4 + 1;
            local_19 = *pbVar4;
            pbVar4 = param_1;
            pbVar9 = pbVar10;
            if (local_19 != 0x22) {
              do {
                if (local_19 == 0x5c) {
                  iVar8 = FUN_0004717c(pbVar4,&local_19,0x7f);
                  pbVar4 = pbVar4 + iVar8;
                  pbVar10 = pbVar9;
                  if (local_19 == 0x7f) goto LAB_0004ba70;
                }
                else if (local_19 == 0) goto LAB_0004ba50;
                pbVar10 = pbVar9 + 1;
                *pbVar9 = local_19;
                param_1 = pbVar4 + 1;
                local_19 = *pbVar4;
                pbVar4 = param_1;
                pbVar9 = pbVar10;
                if (local_19 == 0x22) break;
              } while( true );
            }
          }
          else {
            if (uVar6 != 0x27) {
              if (uVar6 == 0) goto LAB_0004b9b8;
              *pbVar10 = (byte)uVar6;
              uVar6 = (uint)param_1[1];
              param_1 = param_1 + 1;
              pbVar10 = pbVar10 + 1;
              goto LAB_0004b97c;
            }
            bVar5 = param_1[1];
            pbVar4 = param_1 + 1;
LAB_0004ba34:
            param_1 = pbVar4 + 1;
            if (bVar5 != 0x27) {
              if (bVar5 == 0x5c) {
                bVar1 = pbVar4[1];
                if (bVar1 == 0xd) {
                  bVar5 = pbVar4[2];
                  if (bVar5 == 10) {
                    bVar5 = pbVar4[3];
                    pbVar4 = pbVar4 + 3;
                  }
                  else {
                    pbVar4 = pbVar4 + 2;
                  }
                  goto LAB_0004ba34;
                }
                if (0xd < bVar1) {
                  if (bVar1 == 0x27) {
                    bVar5 = 0x27;
                  }
                  else if (bVar1 != 0x5c) {
                    *pbVar10 = 0x5c;
                    bVar5 = *param_1;
                    pbVar4 = param_1;
                    pbVar10 = pbVar10 + 1;
                    goto LAB_0004ba34;
                  }
                  param_1 = pbVar4 + 2;
                  goto LAB_0004bad4;
                }
                if (bVar1 == 0) goto LAB_0004ba50;
                if (bVar1 == 10) {
                  bVar5 = pbVar4[2];
                  pbVar4 = pbVar4 + 2;
                  goto LAB_0004ba34;
                }
              }
              else if (bVar5 == 0) goto LAB_0004ba50;
LAB_0004bad4:
              *pbVar10 = bVar5;
              bVar5 = *param_1;
              pbVar4 = param_1;
              pbVar10 = pbVar10 + 1;
              goto LAB_0004ba34;
            }
          }
          if (param_1 == (byte *)0x0) {
LAB_0004ba50:
            free(piVar2);
            piVar2 = __errno_location();
            *piVar2 = 0x16;
            return (int *)0x0;
          }
          uVar6 = (uint)*param_1;
        } while ((0x7f < uVar6) || ((*(uint *)(&DAT_00069a0c + uVar6 * 4) & 0x500) == 0));
        do {
          pbVar4 = param_1 + 1;
          param_1 = param_1 + 1;
          if (0x7f < *pbVar4) break;
        } while ((*(uint *)(&DAT_00069a0c + (uint)*pbVar4 * 4) & 0x500) != 0);
LAB_0004b9b8:
        pbVar4 = pbVar10 + 1;
        *pbVar10 = 0;
        if (*param_1 == 0) {
          piVar2[*piVar2 + 1] = 0;
          return piVar2;
        }
        iVar7 = *piVar2;
      } while( true );
    }
  }
  piVar2 = __errno_location();
  *piVar2 = 2;
  return (int *)0x0;
}




void FUN_0004bba4(int param_1,int param_2)

{
  char *pcVar1;
  size_t sVar2;
  int iVar3;
  int *unaff_r4;
  uint uVar4;
  int iVar5;
  int iVar6;
  undefined1 *unaff_r8;
  undefined4 uVar7;
  undefined4 uVar8;
  int *local_b8 [4];
  char acStack_a8 [128];
  undefined1 auStack_28 [4];
  
  if ((*(uint *)(param_1 + 0xc) & 0x100) == 0) {
    return;
  }
  pcVar1 = getenv(*(char **)(param_1 + 0x20));
  if ((pcVar1 == (char *)0x0) || (unaff_r4 = (int *)FUN_0004b894(), unaff_r4 == (int *)0x0)) goto LAB_0004bc48;
  iVar3 = *unaff_r4;
  uVar4 = *(uint *)(param_1 + 0xc);
  uVar7 = *(undefined4 *)(param_1 + 4);
  uVar8 = *(undefined4 *)(param_1 + 8);
  unaff_r8 = (undefined1 *)0x0;
  *(uint *)(param_1 + 0xc) = uVar4 & 0xfffffffb;
  *(int *)(param_1 + 4) = iVar3 + 1;
  *(int **)(param_1 + 8) = unaff_r4;
  *(undefined4 *)(param_1 + 0x10) = 1;
  *(undefined4 *)(param_1 + 0x14) = 0;
  if (param_2 == 1) {
    FUN_00045328(param_1);
  }
  else {
    if (param_2 == 0) {
      FUN_00045328(param_1);
      *(undefined4 *)(param_1 + 0x10) = 1;
      *(undefined4 *)(param_1 + 0x14) = 0;
    }
    else if (param_2 != 2) goto LAB_0004bc38;
    FUN_000432e0(param_1);
  }
LAB_0004bc38:
  free(unaff_r4);
  *(undefined4 *)(param_1 + 4) = uVar7;
  *(undefined4 *)(param_1 + 8) = uVar8;
  *(uint *)(param_1 + 0xc) = uVar4;
LAB_0004bc48:
  local_b8[0] = *(int **)(param_1 + 0x44);
  iVar5 = *(int *)(param_1 + 0x68);
  iVar3 = snprintf(acStack_a8,0x80,"%s_",*(undefined4 *)(param_1 + 0x20));
  if (0 < iVar5) {
    unaff_r8 = auStack_28;
  }
  iVar6 = iVar5 + -1;
  if (0 < iVar5) {
    unaff_r4 = *(int **)(unaff_r8 + -0x90);
  }
  if (0 < iVar5) {
LAB_0004bc9c:
    do {
      iVar6 = iVar6 + -1;
      if (((unaff_r4[4] & 0x100U) == 0) && ((short)unaff_r4[2] == -0x8000)) {
        pcVar1 = (char *)unaff_r4[0xc];
        sVar2 = strlen(pcVar1);
        if (sVar2 + 1 <= 0x7fU - iVar3) {
          memcpy(acStack_a8 + iVar3,pcVar1,sVar2 + 1);
          FUN_00045090(local_b8,acStack_a8,param_1,param_2);
          unaff_r4 = local_b8[0] + 0x10;
          local_b8[0] = unaff_r4;
          if (iVar6 == -1) break;
          goto LAB_0004bc9c;
        }
      }
      unaff_r4 = unaff_r4 + 0x10;
      local_b8[0] = unaff_r4;
    } while (iVar6 != -1);
  }
  if ((*(ushort *)(param_1 + 0x5e) & 0x7fff) != 0) {
    local_b8[0] = (int *)(*(int *)(param_1 + 0x44) + (*(ushort *)(param_1 + 0x5e) + 1) * 0x40);
    pcVar1 = (char *)local_b8[0][0xc];
    if (pcVar1 != (char *)0x0) {
      sVar2 = strlen(pcVar1);
      if (sVar2 + 1 <= 0x7fU - iVar3) {
        memcpy(acStack_a8 + iVar3,pcVar1,sVar2 + 1);
        FUN_00045090(local_b8,acStack_a8,param_1,param_2);
      }
    }
  }
  return;
}




int FUN_0004bd84(int *param_1,int param_2,undefined4 *param_3)

{
  int iVar1;
  undefined4 *puVar2;
  ushort uVar3;
  int iVar4;
  char *pcVar5;
  void *__ptr;
  void *__src;
  char cVar6;
  int iVar7;
  int iVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  short *psVar12;
  int *piVar13;
  int iVar14;
  int *piVar15;
  undefined4 *puVar16;
  int local_38;
  int local_34;
  undefined4 local_30;
  int local_2c;
  
  iVar4 = FUN_000433d8(param_1,*param_3);
  if (iVar4 != 0) {
                    /* WARNING: Subroutine does not return */
    exit(0x46);
  }
  if ((param_1[3] & 0x40U) == 0) {
    param_1[3] = param_1[3] | 0x40;
    param_1[1] = param_2;
    param_1[2] = (int)param_3;
    if (0x21fff < *param_1) {
      DAT_0007bb78 = param_1[0x1f];
    }
    iVar4 = FUN_00045328(param_1);
    if (iVar4 != 0) {
      return 0;
    }
    uVar3 = *(ushort *)((int)param_1 + 0x5e);
    uVar11 = uVar3 & 0x7fff;
    if (((uVar3 & 0x7fff) == 0) || (uVar11 = param_1[0x11] + (uVar3 + 1) * 0x40, (*(uint *)(uVar11 + 0x10) & 0x20) == 0)
       ) {
      iVar4 = param_1[0xd];
      param_1[3] = param_1[3] | 0x80000;
      if (iVar4 != 0) {
        FUN_0004bba4(param_1,1);
        if ((uVar11 != 0) && ((*(uint *)(uVar11 + 0x10) & 0x20) == 0)) {
          FUN_0004b664(param_1);
        }
        iVar4 = 2;
      }
      FUN_0004bba4(param_1,iVar4);
      uVar11 = param_1[3] & 0xfff7ffff;
      param_1[3] = uVar11;
    }
    else {
      uVar11 = param_1[3];
    }
    if ((((uVar11 & 0x2000) != 0) && ((code *)param_1[0x16] != (code *)0x0)) && ((uVar11 & 0x30000) == 0x10000)) {
      param_1[3] = uVar11 & 0xfffeffff;
      (*(code *)param_1[0x16])();
      uVar11 = param_1[3];
    }
    if ((uVar11 & 0x800) != 0) {
      local_38 = 0;
      local_34 = 0;
      local_2c = 0;
      local_30 = 4;
      pcVar5 = getenv("POSIXLY_CORRECT");
      if ((pcVar5 == (char *)0x0) && ((param_1[3] & 3U) != 0)) {
        __ptr = (void *)FUN_00044484(param_1[1] << 2);
        if (__ptr != (void *)0x0) {
          __src = (void *)FUN_00044484(param_1[1] << 2);
          if (__src != (void *)0x0) {
            uVar11 = param_1[1];
            uVar9 = 1;
            param_1[5] = 0;
            param_1[4] = 1;
            iVar4 = 0;
            iVar14 = 0;
LAB_0004c13c:
            iVar8 = iVar14;
            if (uVar9 < uVar11) {
              while ((pcVar5 = *(char **)(param_1[2] + uVar9 * 4), *pcVar5 != '-' || (cVar6 = pcVar5[1], cVar6 == '\0'))
                    ) {
                uVar9 = uVar9 + 1;
                *(char **)((int)__src + iVar4 * 4) = pcVar5;
                iVar4 = iVar4 + 1;
                param_1[4] = uVar9;
                if (uVar11 <= uVar9) goto LAB_0004c170;
              }
              if (cVar6 == '-') {
                if (pcVar5[2] == '\0') {
                  uVar10 = uVar9 + 1;
                  *(char **)((int)__ptr + iVar8 * 4) = pcVar5;
                  iVar14 = iVar8 + 1;
                  param_1[4] = uVar10;
                  if (uVar10 < uVar11) {
                    iVar8 = uVar10 * 4;
                    puVar16 = (undefined4 *)((int)__src + (iVar4 + -1) * 4);
                    do {
                      puVar2 = (undefined4 *)(param_1[2] + iVar8);
                      iVar8 = iVar8 + 4;
                      puVar16 = puVar16 + 1;
                      *puVar16 = *puVar2;
                    } while (iVar8 != uVar11 * 4);
                    iVar4 = iVar4 + ((uVar11 - 1) - uVar9);
                    param_1[4] = ((uVar11 - 1) + uVar10) - uVar9;
                  }
                  goto LAB_0004c390;
                }
                iVar14 = FUN_00042bb4(param_1,pcVar5 + 2,&local_38);
              }
              else if ((param_1[3] & 2U) == 0) {
                iVar14 = FUN_00042bb4(param_1,pcVar5 + 1,&local_38);
              }
              else {
                iVar14 = FUN_00041f8c(param_1,cVar6,&local_38);
              }
              if (iVar14 < 0) {
LAB_0004c46c:
                piVar13 = __errno_location();
                *piVar13 = 0x16;
                goto LAB_0004c1a8;
              }
              iVar7 = param_1[4];
              iVar14 = iVar8 + 1;
              uVar9 = iVar7 + 1;
              *(undefined4 *)((int)__ptr + iVar8 * 4) = *(undefined4 *)(param_1[2] + iVar7 * 4);
              param_1[4] = uVar9;
              if ((*(uint *)(local_38 + 0x10) & 0xf000) == 0) {
                if (local_2c == 1) {
                  cVar6 = pcVar5[2];
                  pcVar5 = pcVar5 + 2;
                  if (cVar6 == '\0') {
LAB_0004c4ec:
                    uVar11 = param_1[1];
                  }
                  else {
                    do {
                      iVar7 = FUN_00041f8c(param_1,cVar6,&local_38);
                      if (iVar7 < 0) goto LAB_0004c46c;
                      if ((*(uint *)(local_38 + 0x10) & 0xf000) != 0) {
                        if ((*(uint *)(local_38 + 0x10) & 0x10000) == 0) {
                          if (pcVar5[1] == '\0') {
                            uVar10 = param_1[4];
                            uVar11 = param_1[1];
                            if (uVar11 <= uVar10) goto LAB_0004c46c;
                            uVar9 = uVar10 + 1;
                            *(undefined4 *)((int)__ptr + iVar14 * 4) = *(undefined4 *)(param_1[2] + uVar10 * 4);
                            param_1[4] = uVar9;
                            iVar14 = iVar8 + 2;
                            goto LAB_0004c13c;
                          }
                        }
                        else if (pcVar5[1] == '\0') {
                          uVar9 = param_1[4];
                          pcVar5 = *(char **)(param_1[2] + uVar9 * 4);
                          if (*pcVar5 == '-') goto LAB_0004c4ec;
                          *(char **)((int)__ptr + iVar14 * 4) = pcVar5;
                          uVar9 = uVar9 + 1;
                          uVar11 = param_1[1];
                          param_1[4] = uVar9;
                          iVar14 = iVar8 + 2;
                          goto LAB_0004c13c;
                        }
                        break;
                      }
                      pcVar5 = pcVar5 + 1;
                      cVar6 = *pcVar5;
                    } while (cVar6 != '\0');
                    uVar11 = param_1[1];
                    uVar9 = param_1[4];
                  }
                  goto LAB_0004c13c;
                }
              }
              else {
                if ((*(uint *)(local_38 + 0x10) & 0x10000) == 0) {
                  if (local_2c == 1) {
                    if (pcVar5[2] != '\0') goto LAB_0004c30c;
LAB_0004c400:
                    uVar11 = param_1[1];
                    if (uVar11 <= uVar9) goto LAB_0004c2d4;
                    iVar1 = uVar9 * 4;
                    uVar9 = iVar7 + 2;
                    *(undefined4 *)((int)__ptr + iVar14 * 4) = *(undefined4 *)(param_1[2] + iVar1);
                    param_1[4] = uVar9;
                    iVar14 = iVar8 + 2;
                  }
                  else {
                    if (local_2c != 2) goto LAB_0004c2d4;
                    if (local_34 == 0) goto LAB_0004c400;
LAB_0004c30c:
                    uVar11 = param_1[1];
                  }
                  goto LAB_0004c13c;
                }
                if (local_2c == 1) {
                  if (pcVar5[2] != '\0') goto LAB_0004c28c;
LAB_0004c3b4:
                  uVar11 = param_1[1];
                  if (uVar11 <= uVar9) {
                    piVar13 = __errno_location();
                    *piVar13 = 0;
                    goto LAB_0004c390;
                  }
                  pcVar5 = *(char **)(param_1[2] + uVar9 * 4);
                  if (*pcVar5 != '-') {
                    *(char **)((int)__ptr + iVar14 * 4) = pcVar5;
                    uVar9 = iVar7 + 2;
                    param_1[4] = uVar9;
                    iVar14 = iVar8 + 2;
                  }
                  goto LAB_0004c13c;
                }
                if (local_2c != 2) {
LAB_0004c2d4:
                  piVar13 = __errno_location();
                  *piVar13 = 5;
                  goto LAB_0004c1a8;
                }
                if (local_34 == 0) goto LAB_0004c3b4;
              }
LAB_0004c28c:
              uVar11 = param_1[1];
              goto LAB_0004c13c;
            }
LAB_0004c170:
            piVar13 = __errno_location();
            *piVar13 = 0;
            iVar14 = iVar8;
            if (iVar8 != 0) {
LAB_0004c390:
              memcpy((void *)(param_1[2] + 4),__ptr,iVar14 << 2);
            }
            if (iVar4 != 0) {
              memcpy((void *)(param_1[2] + (iVar14 + 1) * 4),__src,iVar4 << 2);
            }
LAB_0004c1a8:
            free(__ptr);
            free(__src);
            goto LAB_0004be88;
          }
          free(__ptr);
        }
        piVar13 = __errno_location();
        *piVar13 = 0xc;
      }
    }
LAB_0004be88:
    param_1[4] = 1;
    param_1[5] = 0;
    iVar4 = FUN_000432e0(param_1);
  }
  else {
    if (param_1[4] == 0) {
      param_1[5] = 0;
      param_1[4] = 1;
    }
    iVar4 = FUN_000432e0(param_1);
  }
  if (iVar4 != 0) {
    return param_1[1];
  }
  if (((*(ushort *)((int)param_1 + 0x5e) & 0x7fff) != 0) &&
     ((*(uint *)(param_1[0x11] + (uint)*(ushort *)((int)param_1 + 0x5e) * 0x40 + 0x10) & 5) != 0)) {
    FUN_0004a280(param_1);
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  if ((param_1[3] & 4U) == 0) goto LAB_0004bed8;
  iVar14 = 0;
  iVar4 = param_1[0x1a];
  psVar12 = (short *)param_1[0x11];
  do {
    piVar15 = *(int **)(psVar12 + 0x10);
    piVar13 = *(int **)(psVar12 + 0x12);
    if ((*(uint *)(psVar12 + 8) & 5) != 0) {
      if (piVar15 != (int *)0x0) {
        iVar8 = *piVar15;
        do {
          while (iVar8 = param_1[0x11] + iVar8 * 0x40, (*(uint *)(iVar8 + 0x10) & 0xf) == 0) {
            iVar14 = iVar14 + 1;
            fprintf(stderr,DAT_0007ba00,*(undefined4 *)(psVar12 + 0x1a),*(undefined4 *)(iVar8 + 0x34));
            piVar15 = piVar15 + 1;
            iVar8 = *piVar15;
            if (iVar8 == 0x8000) goto LAB_0004bfa4;
          }
          piVar15 = piVar15 + 1;
          iVar8 = *piVar15;
        } while (iVar8 != 0x8000);
      }
LAB_0004bfa4:
      if (piVar13 != (int *)0x0) {
        iVar8 = *piVar13;
        do {
          while (iVar8 = param_1[0x11] + iVar8 * 0x40, (*(uint *)(iVar8 + 0x10) & 5) != 0) {
            iVar14 = iVar14 + 1;
            fprintf(stderr,DAT_0007b8a0,*(undefined4 *)(psVar12 + 0x1a),*(undefined4 *)(iVar8 + 0x34));
            piVar13 = piVar13 + 1;
            iVar8 = *piVar13;
            if (iVar8 == 0x8000) goto LAB_0004bff8;
          }
          piVar13 = piVar13 + 1;
          iVar8 = *piVar13;
        } while (iVar8 != 0x8000);
      }
    }
LAB_0004bff8:
    if ((((psVar12[4] == -0x8000) || (*psVar12 == psVar12[4])) && ((ushort)psVar12[7] < (ushort)psVar12[5])) &&
       (((*(uint *)(psVar12 + 8) & 0x100000) == 0 || ((*(uint *)(psVar12 + 8) & 3) == 0)))) {
      iVar14 = iVar14 + 1;
      if ((ushort)psVar12[5] < 2) {
        fprintf(stderr,DAT_0007b94c,*(undefined4 *)(psVar12 + 0x1a));
      }
      else {
        fprintf(stderr,DAT_0007b990,*(undefined4 *)(psVar12 + 0x1a));
      }
    }
    iVar4 = iVar4 + -1;
    psVar12 = psVar12 + 0x20;
  } while (0 < iVar4);
  uVar11 = param_1[3];
  if ((uVar11 & 4) == 0) {
LAB_0004c0bc:
    if (iVar14 == 0) goto LAB_0004bed8;
  }
  else if ((uVar11 & 0x200) == 0) {
    if (((uVar11 & 0x400) == 0) || ((uint)param_1[4] < (uint)param_1[1])) goto LAB_0004c0bc;
    fprintf(stderr,DAT_0007b88c,param_1[7]);
  }
  else {
    if ((uint)param_1[1] <= (uint)param_1[4]) goto LAB_0004c0bc;
    fprintf(stderr,DAT_0007b958,param_1[7]);
  }
  (*(code *)param_1[0x15])(param_1,1);
LAB_0004bed8:
  return param_1[4];
}




void FUN_0004c614(int param_1,int param_2)

{
  int iVar1;
  undefined4 local_14;
  
  local_14 = 0;
  FUN_000423ac(param_1,0);
  if ((param_2 == 0) || ((*(uint *)(param_1 + 0xc) & 0x4000) == 0)) {
    if ((*(uint *)(param_1 + 0xc) & 0x1000) == 0) {
      FUN_00041e3c();
    }
    else {
      FUN_00041d44(param_1,&local_14);
    }
    FUN_000454c8(param_1,param_2,local_14);
    fflush(DAT_000c9a98);
    iVar1 = ferror(DAT_000c9a98);
    if (iVar1 != 0) {
      fputs(DAT_0007b9b8,stderr);
                    /* WARNING: Subroutine does not return */
      exit(1);
    }
  }
  return;
}




void FUN_0004c6c0(int *param_1,int param_2)

{
  undefined4 uVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  char *__s;
  int __status;
  int iVar5;
  char *local_28;
  int local_24;
  
  if ((param_2 == 0x40) || (__s = (char *)0x0, param_2 == 0)) {
    if (*param_1 < 0x1e000) {
      __s = (char *)0x0;
    }
    else {
      __s = (char *)param_1[0x1b];
    }
    if (DAT_000c9a98 == (FILE *)0x0) {
      DAT_000c9a98 = stdout;
    }
    __status = 0;
  }
  else {
    if (0x1dfff < *param_1) {
      __s = (char *)param_1[0x1c];
    }
    __status = param_2;
    if (DAT_000c9a98 == (FILE *)0x0) {
      DAT_000c9a98 = stderr;
    }
  }
  DAT_000c9ab8 = 0;
  if (__s != (char *)0x0) {
    fputs(__s,DAT_000c9a98);
                    /* WARNING: Subroutine does not return */
    exit(__status);
  }
  fprintf(DAT_000c9a98,(char *)param_1[0xe],param_1[7]);
  FUN_000423ac(param_1,0);
  if ((__status == 0) || ((param_1[3] & 0x4000U) == 0)) {
    local_28 = (char *)0x0;
    if ((param_1[3] & 0x1000U) == 0) {
      uVar1 = FUN_00041e3c();
      sprintf(&DAT_000c9aa8,DAT_0007b8dc,uVar1);
      if ((param_2 != 0) || ((*(uint *)(param_1[0x11] + 0x10) & 0x200000) == 0)) {
        fputs(local_28,DAT_000c9a98);
      }
    }
    else {
      uVar1 = FUN_00041d44(param_1,&local_28);
      sprintf(&DAT_000c9aa8,DAT_0007b8dc,uVar1);
      fputc(10,DAT_000c9a98);
    }
    FUN_000454c8(param_1,param_2,local_28);
    uVar4 = param_1[3];
    uVar3 = uVar4 & 3;
    if (uVar3 == 1) {
      fputs(DAT_0007b960,DAT_000c9a98);
      uVar4 = param_1[3];
    }
    else if (uVar3 == 0) {
      fputs(DAT_0007b9b4,DAT_000c9a98);
      uVar4 = param_1[3];
    }
    else if (uVar3 == 3) {
      fputs(DAT_0007b8d8,DAT_000c9a98);
      uVar4 = param_1[3];
    }
    if ((uVar4 & 0x20) != 0) {
      fputs(DAT_0007b9a8,DAT_000c9a98);
      uVar4 = param_1[3];
    }
    if ((uVar4 & 0x800) != 0) {
      fputs(DAT_0007b9d4,DAT_000c9a98);
    }
    if ((char *)param_1[0xf] != (char *)0x0) {
      fputs((char *)param_1[0xf],DAT_000c9a98);
    }
    if (param_2 == 0) {
      local_24 = 1;
      FUN_00048e0c(param_1[0xd],&local_24,param_1[9],param_1[6]);
      if ((param_1[3] & 0x100U) != 0) {
        if (local_24 != 0) {
          fputs(DAT_0007b9cc,DAT_000c9a98);
        }
        fprintf(DAT_000c9a98,DAT_0007b8d0,param_1[8]);
      }
      if (DAT_000c9ab8 != 0) {
        iVar5 = param_1[0x19];
        iVar2 = param_1[0x11];
        fputc(10,DAT_000c9a98);
        fflush(DAT_000c9a98);
        do {
          uVar3 = (uint)(*(int *)(iVar2 + 0x10) << 0x10) >> 0x1c;
          if ((uVar3 == 2) || (uVar3 == 4)) {
            (**(code **)(iVar2 + 0x28))(1,iVar2);
          }
          iVar5 = iVar5 + -1;
          iVar2 = iVar2 + 0x40;
        } while (0 < iVar5);
      }
      if ((char *)param_1[0x10] != (char *)0x0) {
        fputs((char *)param_1[0x10],DAT_000c9a98);
      }
    }
    if ((*param_1 < 0x22000) || ((char *)param_1[0x20] == (char *)0x0)) {
      if (param_1[0x12] != 0) {
        fprintf(DAT_000c9a98,DAT_0007b9c0);
      }
    }
    else {
      fputs((char *)param_1[0x20],DAT_000c9a98);
    }
    fflush(DAT_000c9a98);
    iVar2 = ferror(DAT_000c9a98);
    if (iVar2 != 0) {
      fputs(DAT_0007b9b8,stderr);
                    /* WARNING: Subroutine does not return */
      exit(1);
    }
  }
                    /* WARNING: Subroutine does not return */
  exit(__status);
}




void FUN_0004cba8(int *param_1)

{
  int iVar1;
  double dVar2;
  timespec local_18;
  
  clock_gettime(0,&local_18);
  *param_1 = local_18.tv_sec + -0x7c558180;
  if (0.0005 < DAT_000c9ad8) {
    iVar1 = FUN_000504ec();
    dVar2 = ((double)(longlong)iVar1 + (double)(longlong)iVar1) * 2.3283064365386963e-10 * DAT_000c9ad8 * 1000000000.0;
  }
  else if (DAT_000c9ad8 <= 0.0) {
    dVar2 = 0.0;
  }
  else {
    iVar1 = FUN_000504ec();
    dVar2 = ((double)(longlong)iVar1 + (double)(longlong)iVar1) * 2.3283064365386963e-10;
  }
  dVar2 = ((double)(longlong)local_18.tv_nsec + dVar2) * 1e-09;
  if (dVar2 < 1.0) {
    if (dVar2 < 0.0) {
      dVar2 = dVar2 + 1.0;
      *param_1 = *param_1 + -1;
    }
  }
  else {
    dVar2 = dVar2 - 1.0;
    *param_1 = *param_1 + 1;
  }
  param_1[1] = (uint)(0.0 < dVar2 * 4294967296.0) * (int)(longlong)(dVar2 * 4294967296.0);
  return;
}




undefined4 FUN_0004cce4(void)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  double in_d0;
  double dVar4;
  timeval local_18;
  timeval tStack_10;
  
  dVar4 = in_d0 + DAT_000c9ae0;
  bVar1 = dVar4 < 0.0;
  if (bVar1) {
    dVar4 = -dVar4;
  }
  local_18.tv_sec = (__time_t)(longlong)dVar4;
  local_18.tv_usec =
       (__suseconds_t)
       (longlong)
       (DAT_000c9ad8 *
        (double)(longlong)(int)(longlong)((dVar4 - (double)(longlong)local_18.tv_sec) / DAT_000c9ad8 + 0.5) * 1000000.0)
  ;
  DAT_000c9ae0 = (dVar4 - (double)(longlong)local_18.tv_sec) - (double)(longlong)local_18.tv_usec / 1000000.0;
  if (bVar1) {
    local_18.tv_sec = -local_18.tv_sec;
    DAT_000c9ae0 = -DAT_000c9ae0;
    local_18.tv_usec = -local_18.tv_usec;
  }
  if (((local_18.tv_sec == 0) && (local_18.tv_usec == 0)) || (iVar2 = adjtime(&local_18,&tStack_10), -1 < iVar2)) {
    uVar3 = 1;
  }
  else {
    FUN_0004fe78(3,"adj_systime: %m");
    uVar3 = 0;
  }
  return uVar3;
}




undefined4 FUN_0004cde0(void)

{
  bool bVar1;
  int iVar2;
  undefined4 uVar3;
  double in_d0;
  int iVar4;
  double dVar5;
  int local_330;
  int local_32c;
  timespec local_328;
  undefined1 auStack_320 [384];
  undefined1 auStack_1a0 [384];
  
  dVar5 = in_d0 + DAT_000c9ae0;
  bVar1 = dVar5 < 0.0;
  if (bVar1) {
    dVar5 = -dVar5;
    iVar2 = (int)(longlong)dVar5;
  }
  else {
    iVar2 = (int)(longlong)dVar5;
  }
  dVar5 = (dVar5 - (double)(longlong)iVar2) * 1000000.0 + 0.5;
  iVar4 = (uint)(0.0 < dVar5) * (int)(longlong)dVar5;
  clock_gettime(0,&local_328);
  local_330 = local_328.tv_sec;
  local_32c = local_328.tv_nsec / 1000;
  if (DAT_0007cf4c != 0) {
    printf("step_systime: step %.6f residual %.6f\n");
  }
  if (bVar1) {
    local_32c = local_32c - iVar4;
    local_330 = local_330 - iVar2;
    if (local_32c < 0) {
      local_330 = local_330 + -1;
      local_32c = local_32c + 1000000;
    }
  }
  else {
    iVar4 = iVar4 + local_32c;
    local_32c = iVar4;
    if (999999 < iVar4) {
      local_32c = iVar4 + -1000000;
    }
    local_330 = iVar2 + local_330;
    if (999999 < iVar4) {
      local_330 = local_330 + 1;
    }
  }
  iVar2 = FUN_0004f818(&local_330,0);
  if (iVar2 == 0) {
    DAT_000c9ae0._0_4_ = 0;
    DAT_000c9ae0._4_4_ = 0;
    if (local_328.tv_sec == local_330) {
      uVar3 = 1;
    }
    else {
      memset(auStack_320,0,0x180);
      memset(auStack_1a0,0,0x180);
      uVar3 = 1;
    }
  }
  else {
    FUN_0004fe78(3,"step-systime: %m");
    uVar3 = 0;
  }
  return uVar3;
}




int FUN_0004d01c(undefined4 param_1,undefined4 param_2,int param_3,int param_4,int param_5)

{
  uint uVar1;
  int iVar2;
  undefined1 auStack_b0 [64];
  undefined1 auStack_70 [92];
  
  FUN_0005594c(auStack_70);
  FUN_00055994(auStack_70,param_2,DAT_000cb730);
  FUN_00055994(auStack_70,param_3,param_4);
  FUN_00055aa8(auStack_70,auStack_b0);
  if (param_5 == 0x14) {
    uVar1 = memcmp(auStack_b0,(void *)(param_3 + param_4 + 4),0x10);
    iVar2 = 1 - uVar1;
    if (1 < uVar1) {
      iVar2 = 0;
    }
  }
  else {
    FUN_0004fe78(3,"MAC decrypt: MAC length error");
    iVar2 = 0;
  }
  return iVar2;
}




undefined4 FUN_0004d0b4(short *param_1)

{
  undefined4 local_74 [5];
  undefined1 auStack_60 [88];
  
  if (*param_1 == 2) {
    local_74[0] = *(undefined4 *)(param_1 + 2);
  }
  else {
    FUN_0005594c(auStack_60);
    FUN_00055994(auStack_60,param_1 + 4,0x10);
    FUN_00055aa8(auStack_60,local_74);
  }
  return local_74[0];
}




undefined4 FUN_0004d104(byte *param_1,int *param_2)

{
  ushort **ppuVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  uint uVar5;
  bool bVar6;
  
  uVar4 = (uint)*param_1;
  bVar6 = uVar4 == 0x2d;
  if (bVar6) {
    uVar4 = (uint)param_1[1];
    uVar5 = 0x38;
    param_1 = param_1 + 1;
  }
  else {
    uVar5 = 0x37;
  }
  if (uVar4 != 0) {
    ppuVar1 = __ctype_b_loc();
    iVar2 = 0;
    while( true ) {
      if (((*ppuVar1)[uVar4] & 0x800) == 0) break;
      iVar3 = (uVar4 - 0x30) + iVar2 * 10;
      if (0xccccccc < iVar2) {
        return 0;
      }
      if ((iVar2 == 0xccccccc) && (uVar5 < uVar4)) {
        return 0;
      }
      param_1 = param_1 + 1;
      uVar4 = (uint)*param_1;
      iVar2 = iVar3;
      if (uVar4 == 0) {
        if (bVar6) {
          *param_2 = -iVar3;
        }
        else {
          *param_2 = iVar3;
        }
        return 1;
      }
    }
  }
  return 0;
}




undefined4 FUN_0004d1c0(byte *param_1,uint *param_2)

{
  ushort **ppuVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  
  uVar3 = (uint)*param_1;
  if (uVar3 != 0) {
    ppuVar1 = __ctype_b_loc();
    uVar2 = 0;
    while (((uVar4 = (uVar3 + uVar2 * 10) - 0x30, ((*ppuVar1)[uVar3] & 0x800) != 0 && (uVar2 < 0x1999999a)) &&
           ((uVar2 != 0x19999999 || (uVar3 < 0x36))))) {
      param_1 = param_1 + 1;
      uVar3 = (uint)*param_1;
      uVar2 = uVar4;
      if (uVar3 == 0) {
        *param_2 = uVar4;
        return 1;
      }
    }
  }
  return 0;
}




uint FUN_0004d24c(char *param_1,int param_2)

{
  int iVar1;
  uint uVar2;
  
  uVar2 = 0;
  while (((param_2 >> (uVar2 & 0xff) & 1U) == 0 || (iVar1 = strcmp((char *)(&DAT_0007bcf4)[uVar2],param_1), iVar1 != 0))
        ) {
    uVar2 = uVar2 + 1;
    if (uVar2 == 0x19) {
      return 0xffffffff;
    }
  }
  return uVar2;
}




int FUN_0004d29c(char *param_1,undefined4 param_2,undefined4 param_3)

{
  byte bVar1;
  ushort uVar2;
  byte bVar3;
  FILE *__stream;
  char *pcVar4;
  size_t sVar5;
  ushort **ppuVar6;
  ushort *puVar7;
  __int32_t **pp_Var8;
  int iVar9;
  undefined4 uVar10;
  int iVar11;
  int iVar12;
  int *piVar13;
  byte *__s1;
  byte *pbVar14;
  byte *pbVar15;
  uint uVar16;
  uint uVar17;
  size_t sVar18;
  byte *pbVar19;
  char local_124 [4];
  char acStack_120 [4];
  char acStack_11c [4];
  undefined2 uStack_118;
  undefined1 local_116;
  char acStack_110 [31];
  byte abStack_f1 [101];
  char acStack_8c [104];
  
  snprintf(acStack_110,0x1e,"/dev/mixer%d",param_3);
  snprintf(local_124,0x14,"%s%d","/etc/ntp.audio",param_3);
  __stream = fopen(local_124,"r");
  if (__stream == (FILE *)0x0) {
    printf("audio_config_read: <%s> NO\n",local_124);
    snprintf(local_124,0x14,"%s.%d","/etc/ntp.audio",param_3);
    __stream = fopen(local_124,"r");
    if (__stream == (FILE *)0x0) {
      printf("audio_config_read: <%s> NO\n",local_124);
      local_124[0] = '/';
      local_124[1] = 'e';
      local_124[2] = 't';
      local_124[3] = 'c';
      acStack_120[0] = '/';
      acStack_120[1] = 'n';
      acStack_120[2] = 't';
      acStack_120[3] = 'p';
      acStack_11c[0] = '.';
      acStack_11c[1] = 'a';
      acStack_11c[2] = 'u';
      acStack_11c[3] = 'd';
      uStack_118 = 0x6f69;
      local_116 = 0;
      __stream = fopen(local_124,"r");
      if (__stream == (FILE *)0x0) {
        printf("audio_config_read: <%s> NO\n",local_124);
        goto LAB_0004d634;
      }
    }
  }
  printf("audio_config_read: reading <%s>\n",local_124);
LAB_0004d308:
  pcVar4 = fgets((char *)(abStack_f1 + 1),100,__stream);
  if (pcVar4 != (char *)0x0) {
    pcVar4 = strchr((char *)(abStack_f1 + 1),0x23);
    if (pcVar4 != (char *)0x0) {
      *pcVar4 = '\0';
    }
    sVar5 = strlen((char *)(abStack_f1 + 1));
    if (0 < (int)sVar5) {
      bVar1 = abStack_f1[sVar5];
      bVar3 = bVar1 & 0x80;
      if ((bVar1 & 0x80) == 0) {
        ppuVar6 = __ctype_b_loc();
        puVar7 = *ppuVar6;
        pbVar15 = abStack_f1 + sVar5 + 1;
        while (sVar18 = sVar5 - 1, (puVar7[bVar1] & 0x2000) != 0) {
          pbVar15[-1] = bVar3;
          sVar5 = sVar18;
          if ((sVar18 == 0) || (bVar1 = pbVar15[-2], pbVar15 = pbVar15 + -1, (bVar1 & 0x80) != 0)) break;
        }
      }
    }
    uVar17 = (uint)abStack_f1[1];
    if (uVar17 != 0) {
      uVar16 = uVar17 & 0xffffff80;
      if ((abStack_f1[1] & 0x80) == 0) {
        ppuVar6 = __ctype_b_loc();
        __s1 = abStack_f1 + 1;
        do {
          pbVar14 = __s1 + 1;
          if (((*ppuVar6)[uVar17] & 0x2000) == 0) {
            uVar17 = (uint)*__s1;
            pbVar19 = __s1;
            if (uVar17 == 0) goto LAB_0004d49c;
            uVar16 = uVar17 & 0xffffff80;
            pbVar14 = __s1;
            pbVar15 = __s1;
            break;
          }
          pbVar19 = __s1 + 1;
          uVar17 = (uint)*pbVar19;
          if (uVar17 == 0) goto LAB_0004d308;
          uVar16 = uVar17 & 0xffffff80;
          __s1 = pbVar14;
          pbVar15 = pbVar14;
        } while ((*pbVar19 & 0x80) == 0);
      }
      else {
        pbVar14 = abStack_f1 + 1;
        pbVar15 = pbVar14;
        __s1 = pbVar14;
      }
      do {
        if (uVar16 == 0) {
          ppuVar6 = __ctype_b_loc();
          uVar2 = (*ppuVar6)[(short)uVar17];
          if ((uVar2 & 0x200) == 0) {
            if (((uVar2 & 0x2000) != 0) || (uVar17 == 0x3d)) {
              uVar17 = (uint)*pbVar14;
              pbVar19 = pbVar14;
              if ((uVar17 != 0) && ((*pbVar14 & 0x80) == 0)) goto LAB_0004d480;
              break;
            }
          }
          else {
            pp_Var8 = __ctype_toupper_loc();
            *pbVar15 = (byte)(*pp_Var8)[(short)uVar17];
          }
        }
        uVar17 = (uint)pbVar14[1];
        uVar16 = uVar17 & 0xffffff80;
        pbVar14 = pbVar14 + 1;
        pbVar19 = pbVar15 + 1;
        pbVar15 = pbVar15 + 1;
      } while (uVar17 != 0);
LAB_0004d49c:
      iVar9 = strncmp((char *)__s1,"IDEV",4);
      if ((iVar9 == 0) && (iVar9 = sscanf((char *)pbVar19,"%99s",acStack_8c), iVar9 == 1)) {
        strncpy(&DAT_000cb5fc,acStack_8c,100);
        printf("idev <%s>\n",acStack_8c);
      }
      else {
        iVar9 = strncmp((char *)__s1,"CDEV",4);
        if ((iVar9 == 0) && (iVar9 = sscanf((char *)pbVar19,"%99s",acStack_8c), iVar9 == 1)) {
          strncpy(&DAT_000cb660,acStack_8c,100);
          printf("cdev <%s>\n",acStack_8c);
        }
        else {
          iVar9 = strncmp((char *)__s1,"AGC",3);
          if ((iVar9 == 0) && (iVar9 = sscanf((char *)pbVar19,"%99s",acStack_8c), iVar9 == 1)) {
            strncpy(&DAT_000cb598,acStack_8c,100);
            printf("agc <%s> %d\n",acStack_8c,sVar5);
          }
          else {
            iVar9 = strncmp((char *)__s1,"MONITOR",7);
            if ((iVar9 == 0) && (iVar9 = sscanf((char *)pbVar19,"%99s",acStack_8c), iVar9 == 1)) {
              strncpy(&DAT_000cb6c4,acStack_8c,100);
              uVar10 = FUN_0004d24c(acStack_8c,0xffffffff);
              printf("monitor <%s> %d\n",acStack_8c,uVar10);
            }
          }
        }
      }
    }
    goto LAB_0004d308;
  }
  fclose(__stream);
LAB_0004d634:
  if (DAT_000cb5fc != '\0') {
    param_1 = &DAT_000cb5fc;
  }
  pcVar4 = acStack_110;
  if (DAT_000cb660 != '\0') {
    pcVar4 = &DAT_000cb660;
  }
  iVar9 = open(param_1,0x802,0x1ff);
  if (iVar9 < 0) {
    FUN_0004fe78(3,"audio_init: %s %m\n",param_1);
  }
  else {
    DAT_000c9ae8 = open(pcVar4,2);
    if (DAT_000c9ae8 < 0) {
      FUN_0004fe78(3,"audio_init: invalid control device <%s>\n",pcVar4);
      close(iVar9);
      iVar9 = DAT_000c9ae8;
    }
    else {
      printf("audio_init: <%s> bufsiz %d\n",param_1,param_2);
      iVar11 = ioctl(iVar9,0xc004500a);
      if (iVar11 == -1) {
        piVar13 = __errno_location();
        pcVar4 = strerror(*piVar13);
        printf("audio_init: SNDCTL_DSP_SETFRAGMENT: %s\n",pcVar4);
      }
      iVar11 = DAT_000c9ae8;
      iVar12 = ioctl(DAT_000c9ae8,0x80044dfe,&DAT_000c9aec);
      if (iVar12 == -1) {
        piVar13 = __errno_location();
        pcVar4 = strerror(*piVar13);
        printf("SOUND_MIXER_READ_DEVMASK: %s\n",pcVar4);
        iVar11 = DAT_000c9ae8;
      }
      iVar11 = ioctl(iVar11,0x80044dfd,&DAT_000c9af0);
      if (iVar11 == -1) {
        piVar13 = __errno_location();
        pcVar4 = strerror(*piVar13);
        printf("SOUND_MIXER_READ_RECMASK: %s\n",pcVar4);
      }
      if (DAT_000cb598 != '\0') {
        uVar17 = FUN_0004d24c(&DAT_000cb598,DAT_000c9aec);
        if ((int)uVar17 < 0) {
          printf("input %s not in recmask %#x\n",&DAT_000cb598,DAT_000c9af0);
        }
        else {
          DAT_0007bd58 = uVar17 | 0xc0044d00;
        }
      }
      uVar10 = DAT_000c9aec;
      if (DAT_000cb6c4 != '\0') {
        uVar17 = FUN_0004d24c(&DAT_000cb6c4,DAT_000c9aec);
        if ((int)uVar17 < 0) {
          printf("monitor %s not in devmask %#x\n",&DAT_000cb6c4,uVar10);
        }
        else {
          DAT_0007bd5c = uVar17 | 0xc0044d00;
        }
      }
    }
  }
  return iVar9;
LAB_0004d480:
  if ((((*ppuVar6)[uVar17] & 0x2000) == 0) && (pbVar19 = pbVar14, uVar17 != 0x3d)) goto LAB_0004d49c;
  pbVar15 = pbVar14 + 1;
  uVar17 = (uint)*pbVar15;
  pbVar14 = pbVar14 + 1;
  pbVar19 = pbVar14;
  if ((uVar17 == 0) || ((*pbVar15 & 0x80) != 0)) goto LAB_0004d49c;
  goto LAB_0004d480;
}




int FUN_0004d950(int param_1,int param_2,int param_3)

{
  ulong __request;
  int __fd;
  int iVar1;
  int iVar2;
  int *piVar3;
  char *pcVar4;
  uint uVar5;
  uint local_24;
  
  uVar5 = (param_1 * 100) / 0xff;
  local_24 = uVar5;
  if (1 < DAT_0007cf4c) {
    printf("audio_gain: gain %d/%d\n",param_1,uVar5);
  }
  local_24 = local_24 | uVar5 * 0x100;
  if (DAT_000cb598 == '\0') {
    if (param_3 == 2) {
      uVar5 = 0x4d06;
    }
    else {
      uVar5 = 0x4d07;
    }
    iVar1 = ioctl(DAT_000c9ae8,uVar5 | 0xc0040000,&local_24);
  }
  else {
    iVar1 = ioctl(DAT_000c9ae8,DAT_0007bd58,&local_24);
  }
  if (iVar1 == -1) {
    piVar3 = __errno_location();
    pcVar4 = strerror(*piVar3);
    printf("audio_gain: agc write: %s\n",pcVar4);
    iVar2 = DAT_0007bd64;
  }
  else {
    iVar2 = DAT_0007bd60;
    if (DAT_0007bd60 != param_2) {
      uVar5 = (param_2 * 100) / 0xff;
      local_24 = uVar5;
      if (1 < DAT_0007cf4c) {
        printf("audio_gain: mongain %d/%d\n",param_2,uVar5);
      }
      local_24 = local_24 | uVar5 * 0x100;
      __request = DAT_0007bd5c;
      if (DAT_000cb6c4 == '\0') {
        __request = 0xc0044d00;
      }
      iVar1 = ioctl(DAT_000c9ae8,__request,&local_24);
      iVar2 = param_2;
      if (iVar1 == -1) {
        piVar3 = __errno_location();
        pcVar4 = strerror(*piVar3);
        printf("audio_gain: mongain write: %s\n",pcVar4);
        return -1;
      }
    }
    DAT_0007bd60 = iVar2;
    iVar2 = DAT_0007bd64;
    if (DAT_0007bd64 != param_3) {
      if (1 < DAT_0007cf4c) {
        printf("audio_gain: port %d\n",param_3);
      }
      __fd = DAT_000c9ae8;
      if (param_3 == 2) {
        local_24 = 0x40;
      }
      else {
        local_24 = 0x80;
      }
      iVar1 = ioctl(DAT_000c9ae8,0xc0044dff,&local_24);
      if (iVar1 == -1) {
        piVar3 = __errno_location();
        pcVar4 = strerror(*piVar3);
        printf("SOUND_MIXER_WRITE_RECSRC: %s\n",pcVar4);
        iVar2 = DAT_0007bd64;
      }
      else {
        iVar2 = param_3;
        if (1 < DAT_0007cf4c) {
          iVar2 = ioctl(__fd,0x80044dff,&local_24);
          if (iVar2 == -1) {
            piVar3 = __errno_location();
            pcVar4 = strerror(*piVar3);
            printf("SOUND_MIXER_WRITE_RECSRC: %s\n",pcVar4);
            iVar2 = param_3;
          }
          else {
            printf("audio_gain: recsrc is %d\n",local_24);
            iVar2 = param_3;
          }
        }
      }
    }
  }
  DAT_0007bd64 = iVar2;
  return iVar1;
}




void FUN_0004dbe8(void)

{
  int iVar1;
  int *piVar2;
  char *pcVar3;
  undefined4 local_14 [2];
  
  local_14[0] = 0;
  printf("audio_show: ctl_fd %d\n",DAT_000c9ae8);
  iVar1 = ioctl(DAT_000c9ae8,0x80044dff,local_14);
  if (iVar1 == -1) {
    piVar2 = __errno_location();
    pcVar3 = strerror(*piVar2);
    printf("SOUND_MIXER_READ_RECSRC: %s\n",pcVar3);
  }
  return;
}




void FUN_0004dc58(void)

{
  memset(&DAT_000cb754,0,0x100);
  return;
}




ushort FUN_0004dd08(uint param_1)

{
  ushort uVar1;
  int *piVar2;
  
  DAT_000cb740 = DAT_000cb740 + 1;
  if ((param_1 == 0) || (param_1 == DAT_000cb738)) {
    uVar1 = 1;
  }
  else {
    DAT_000cb854 = DAT_000cb854 + 1;
    for (piVar2 = (int *)(&DAT_000cb754)[param_1 & 0x3f]; piVar2 != (int *)0x0; piVar2 = (int *)*piVar2) {
      if (param_1 == piVar2[0x11]) {
        if (piVar2[0x12] != 0) {
          uVar1 = *(ushort *)(piVar2 + 0x13);
          if ((uVar1 & 1) != 0) {
            DAT_000cb730 = piVar2[0x15];
            DAT_000cb734 = uVar1;
            DAT_000cb738 = piVar2[0x11];
            DAT_000cb748 = piVar2[0x12];
            DAT_000cb85c = (int)(piVar2 + 1);
            return 1;
          }
          DAT_000cb728 = DAT_000cb728 + 1;
          return uVar1 & 1;
        }
        break;
      }
    }
    uVar1 = 0;
    DAT_000cb73c = DAT_000cb73c + 1;
  }
  return uVar1;
}




void FUN_0004de24(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  
  puVar1 = (undefined4 *)calloc(0xc,0x58);
  if (puVar1 == (undefined4 *)0x0) {
    return;
  }
  puVar2 = puVar1;
  do {
    puVar3 = puVar2 + 0x16;
    *puVar2 = DAT_000cb858;
    DAT_000cb858 = puVar2;
    puVar2 = puVar3;
  } while (puVar3 != puVar1 + 0x108);
  DAT_000cb858 = puVar1 + 0xf2;
  DAT_000cb860 = DAT_000cb860 + 0xc;
  return;
}




void FUN_0004de88(uint param_1,uint param_2)

{
  undefined2 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  uint uVar6;
  int *piVar7;
  uint uVar8;
  
  uVar8 = param_1 & 0x3f;
  piVar3 = (int *)(&DAT_000cb754)[uVar8];
  if (piVar3 != (int *)0x0) {
    uVar6 = piVar3[0x11];
    piVar7 = piVar3;
    while( true ) {
      if (uVar6 == param_1) {
        if (DAT_000cb738 == param_1) {
          DAT_000cb738 = 0;
          DAT_000cb734 = 0;
        }
        if (param_2 == 0) {
          *(ushort *)(piVar7 + 0x13) = *(ushort *)(piVar7 + 0x13) & 0xfffe;
          if (piVar7 == piVar3) {
            (&DAT_000cb754)[uVar8] = *piVar7;
          }
          else {
            do {
              piVar4 = piVar3;
              piVar3 = (int *)*piVar4;
            } while (piVar3 != piVar7);
            *piVar4 = *piVar7;
          }
          DAT_000cb744 = DAT_000cb744 + -1;
          *piVar7 = (int)DAT_000cb858;
          DAT_000cb858 = piVar7;
          DAT_000cb860 = DAT_000cb860 + 1;
          return;
        }
        *(ushort *)(piVar7 + 0x13) = *(ushort *)(piVar7 + 0x13) | 1;
        if (param_2 < 2) {
          piVar7[0x14] = 0;
        }
        else {
          piVar7[0x14] = param_2 + DAT_000cb548;
        }
        return;
      }
      piVar7 = (int *)*piVar7;
      if (piVar7 == (int *)0x0) break;
      uVar6 = piVar7[0x11];
    }
  }
  if (param_2 == 0) {
    return;
  }
  if (DAT_000cb860 == 0) {
    iVar5 = FUN_0004de24();
    if (iVar5 == 0) {
      return;
    }
    piVar3 = (int *)(&DAT_000cb754)[uVar8];
  }
  puVar2 = DAT_000cb858;
  DAT_000cb860 = DAT_000cb860 + -1;
  DAT_000cb744 = DAT_000cb744 + 1;
  DAT_000cb858[0x11] = param_1;
  puVar1 = (undefined2 *)(DAT_000cb858 + 0x13);
  DAT_000cb858 = (int *)*DAT_000cb858;
  *puVar1 = 1;
  *puVar2 = piVar3;
  puVar2[0x12] = 0;
  puVar2[0x15] = 0;
  (&DAT_000cb754)[uVar8] = puVar2;
  return;
}




ushort FUN_0004e030(uint param_1)

{
  int *piVar1;
  
  if (param_1 == DAT_000cb738) {
    return DAT_000cb734 & 1;
  }
  piVar1 = (int *)(&DAT_000cb754)[param_1 & 0x3f];
  DAT_000cb854 = DAT_000cb854 + 1;
  while( true ) {
    if (piVar1 == (int *)0x0) {
      DAT_000cb73c = DAT_000cb73c + 1;
      return 0;
    }
    if (piVar1[0x11] == param_1) break;
    piVar1 = (int *)*piVar1;
  }
  if ((*(ushort *)(piVar1 + 0x13) & 1) == 0) {
    DAT_000cb73c = DAT_000cb73c + 1;
    return *(ushort *)(piVar1 + 0x13) & 1;
  }
  return 1;
}




void FUN_0004e0e4(uint param_1,int param_2,void *param_3,size_t param_4)

{
  byte *pbVar1;
  int *piVar2;
  void *__dest;
  uint uVar3;
  int iVar4;
  uint uVar5;
  byte local_3c [16];
  undefined1 local_2c;
  
  uVar5 = param_1 & 0x3f;
  piVar2 = (int *)(&DAT_000cb754)[uVar5];
  if (piVar2 == (int *)0x0) {
LAB_0004e138:
    if ((DAT_000cb860 != 0) || (iVar4 = FUN_0004de24(), iVar4 != 0)) {
      piVar2 = DAT_000cb858;
      if (0x3f < param_4) {
        param_4 = 0x40;
      }
      DAT_000cb860 = DAT_000cb860 + -1;
      __dest = DAT_000cb858 + 1;
      DAT_000cb858[0x11] = param_1;
      DAT_000cb858[0x12] = param_2;
      DAT_000cb858[0x15] = param_4;
      *(undefined2 *)(DAT_000cb858 + 0x13) = 0;
      DAT_000cb858[0x14] = 0;
      DAT_000cb858 = (int *)*DAT_000cb858;
      memcpy(__dest,param_3,param_4);
      iVar4 = DAT_0007cf4c;
      *piVar2 = (&DAT_000cb754)[uVar5];
      (&DAT_000cb754)[uVar5] = piVar2;
      if (1 < iVar4) {
        local_3c[0] = '0';
        local_3c[1] = '1';
        local_3c[2] = '2';
        local_3c[3] = '3';
        local_3c[4] = '4';
        local_3c[5] = '5';
        local_3c[6] = '6';
        local_3c[7] = '7';
        local_3c[8] = '8';
        local_3c[9] = '9';
        local_3c[10] = 'a';
        local_3c[0xb] = 'b';
        local_3c[0xc] = 'c';
        local_3c[0xd] = 'd';
        local_3c[0xe] = 'e';
        local_3c[0xf] = 'f';
        local_2c = 0;
        printf("auth_setkey: key %d type %d len %d ",piVar2[0x11],piVar2[0x12],piVar2[0x15]);
        if (0 < piVar2[0x15]) {
          iVar4 = 0;
          do {
            pbVar1 = (byte *)((int)param_3 + iVar4);
            iVar4 = iVar4 + 1;
            printf("%c%c",(uint)local_3c[*pbVar1 >> 4],(uint)local_3c[*pbVar1 & 0xf]);
          } while (iVar4 < piVar2[0x15]);
        }
        putchar(10);
      }
      DAT_000cb744 = DAT_000cb744 + 1;
    }
  }
  else {
    uVar3 = piVar2[0x11];
    while (uVar3 != param_1) {
      piVar2 = (int *)*piVar2;
      if (piVar2 == (int *)0x0) goto LAB_0004e138;
      uVar3 = piVar2[0x11];
    }
    if (0x3f < param_4) {
      param_4 = 0x40;
    }
    piVar2[0x12] = param_2;
    piVar2[0x15] = param_4;
    memcpy(piVar2 + 1,param_3,param_4);
    if (DAT_000cb738 == param_1) {
      DAT_000cb738 = 0;
      DAT_000cb734 = 0;
    }
  }
  return;
}




void FUN_0004e2bc(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  int iVar4;
  undefined4 *local_2c;
  
  iVar4 = 0;
  local_2c = &DAT_000cb750;
  do {
    local_2c = local_2c + 1;
    puVar1 = (undefined4 *)*local_2c;
    puVar3 = &DAT_000cb754 + iVar4;
    while (puVar1 != (undefined4 *)0x0) {
      while( true ) {
        puVar2 = puVar1;
        if (0xffff < (uint)puVar2[0x11]) goto LAB_0004e354;
        if ((*(ushort *)(puVar2 + 0x13) & 1) != 0) break;
        *puVar3 = *puVar2;
        DAT_000cb744 = DAT_000cb744 + -1;
        DAT_000cb860 = DAT_000cb860 + 1;
        *puVar2 = DAT_000cb858;
        puVar1 = (undefined4 *)*puVar3;
        DAT_000cb858 = puVar2;
        if ((undefined4 *)*puVar3 == (undefined4 *)0x0) goto LAB_0004e354;
      }
      memset(puVar2 + 1,0,0x40);
      puVar2[0x14] = 0;
      puVar2[0x15] = 0;
      puVar3 = puVar2;
      puVar1 = (undefined4 *)*puVar2;
    }
LAB_0004e354:
    iVar4 = iVar4 + 1;
    if (iVar4 == 0x40) {
      return;
    }
  } while( true );
}




uint FUN_0004e458(uint param_1,int param_2,int param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  undefined4 uVar5;
  int iVar6;
  int iVar7;
  bool bVar8;
  undefined4 local_a8;
  undefined4 uStack_a4;
  undefined4 uStack_a0;
  undefined4 uStack_9c;
  undefined1 auStack_68 [84];
  int local_14;
  
  iVar6 = param_3 + 3;
  if (-1 < param_3) {
    iVar6 = param_3;
  }
  bVar8 = param_1 != 0;
  uVar1 = param_1 >> 8;
  uVar2 = param_1 >> 0x10;
  uVar3 = param_1 >> 0x18;
  uVar4 = param_1 << 0x18;
  DAT_000cb750 = DAT_000cb750 + 1;
  if (!bVar8) {
    param_1 = 4;
  }
  *(uint *)(param_2 + (iVar6 >> 2) * 4) = uVar4 | (uVar1 & 0xff) << 0x10 | (uVar2 & 0xff) << 8 | uVar3;
  if (bVar8) {
    local_14 = param_2;
    param_1 = FUN_0004dd08(param_1);
    iVar6 = local_14;
    uVar5 = DAT_000cb85c;
    if (param_1 != 0) {
      FUN_0005594c(auStack_68);
      FUN_00055994(auStack_68,uVar5,DAT_000cb730);
      FUN_00055994(auStack_68,iVar6,param_3);
      FUN_00055aa8(auStack_68,&local_a8);
      iVar7 = iVar6 + param_3 + 4;
      *(undefined4 *)(iVar6 + param_3 + 4) = local_a8;
      *(undefined4 *)(iVar7 + 4) = uStack_a4;
      *(undefined4 *)(iVar7 + 8) = uStack_a0;
      *(undefined4 *)(iVar7 + 0xc) = uStack_9c;
      return 0x14;
    }
  }
  return param_1;
}




undefined4 FUN_0004e4e4(int param_1,undefined4 param_2,undefined4 param_3,int param_4)

{
  undefined4 uVar1;
  int iVar2;
  
  DAT_000cb74c = DAT_000cb74c + 1;
  if (((param_1 == 0) || (iVar2 = FUN_0004dd08(), iVar2 == 0)) || (param_4 < 4)) {
    uVar1 = 0;
  }
  else {
    uVar1 = FUN_0004d01c(DAT_000cb748,DAT_000cb85c,param_2,param_3,param_4);
  }
  return uVar1;
}




char * FUN_0004e560(undefined4 *param_1)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  char *pcVar4;
  
  pcVar1 = (char *)*param_1;
  cVar3 = *pcVar1;
  if (cVar3 == ' ' || cVar3 == '\t') {
    do {
      pcVar1 = pcVar1 + 1;
      cVar3 = *pcVar1;
    } while (cVar3 == ' ' || cVar3 == '\t');
  }
  if (((cVar3 != '\n' && cVar3 != '\0') && (cVar3 != '\t')) && (pcVar2 = pcVar1, cVar3 != '#')) {
    while( true ) {
      pcVar4 = pcVar2;
      pcVar2 = pcVar4 + 1;
      cVar3 = *pcVar2;
      if ((cVar3 == '\n' || cVar3 == '\0') || (cVar3 == ' ')) break;
      if ((cVar3 == '\t') || (cVar3 == '#')) break;
    }
    if (pcVar2 != pcVar1) {
      if (cVar3 == ' ' || cVar3 == '\t') {
        pcVar4 = pcVar4 + 2;
        *pcVar2 = '\0';
      }
      else {
        *pcVar2 = '\0';
        pcVar4 = pcVar2;
      }
      *param_1 = pcVar4;
      return pcVar1;
    }
  }
  return (char *)0x0;
}




bool FUN_0004e858(int *param_1,int *param_2)

{
  uint uVar1;
  
  uVar1 = param_1[1];
  *param_2 = *param_1 + -0x7c558180;
  if ((int)uVar1 < 1000000) {
    param_2[1] = (&DAT_0007c19c)[(uVar1 << 0x10) >> 0x18] + (&DAT_0007c15c)[(uVar1 << 0xc) >> 0x1c] +
                 (&DAT_0007c59c)[uVar1 & 0xff];
  }
  return (int)uVar1 < 1000000;
}




void FUN_0004e8ec(uint param_1,short *param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  byte bVar2;
  short sVar3;
  char cVar4;
  char cVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  int iVar9;
  uint uVar10;
  bool bVar11;
  
  if (param_2 == (short *)0x0) {
    (*DAT_0007c9fc)("caljulian.c",0x30,2,"((void *)0) != jt",param_4);
  }
  uVar6 = time((time_t *)0x0);
  iVar9 = (int)uVar6 >> 0x1f;
  uVar7 = (uVar6 & 0xffff) + 0xffff;
  if ((uVar7 & 0x10000) == 0) {
    uVar6 = (uVar6 >> 0x10) + 0x7fff;
  }
  else {
    uVar6 = (uVar6 >> 0x10) + 0x8000;
  }
  if ((uVar6 & 0x10000) != 0) {
    iVar9 = iVar9 + 1;
  }
  uVar7 = (uVar7 & 0xffff) + 0x7e80;
  if ((uVar7 & 0x10000) == 0) {
    uVar6 = (uVar6 & 0xffff) + 0x83aa;
  }
  else {
    uVar6 = (uVar6 & 0xffff) + 0x83ab;
  }
  if ((uVar6 & 0x10000) != 0) {
    iVar9 = iVar9 + 1;
  }
  if ((uVar7 & 0xffff | uVar6 << 0x10) < param_1 && 0 < iVar9) {
    iVar9 = iVar9 + -1;
  }
  uVar7 = param_1 >> 7 | iVar9 << 0x19;
  uVar6 = uVar7 / 0x2a3;
  uVar7 = (param_1 & 0x7f) + (uVar7 % 0x2a3) * 0x80;
  if (0x1517f < uVar7) {
    (*DAT_0007c9fc)("caljulian.c",0x60,1,"ntptime < ((60)*(60)*(24))");
  }
  if (param_1 != uVar6 * 0x15180 + uVar7) {
    (*DAT_0007c9fc)("caljulian.c",0x61,3,
                    "(unsigned int)(ntptime + ntp_day * ((60)*(60)*(24))) == (unsigned int)saved_time");
  }
  cVar4 = (char)(uVar7 / 0x3c);
  *(char *)(param_2 + 4) = (char)uVar7 + cVar4 * -0x3c;
  uVar7 = (uVar7 / 0x3c) / 0x3c;
  cVar5 = (char)uVar7;
  *(char *)(param_2 + 3) = cVar5;
  *(char *)((int)param_2 + 7) = cVar4 + cVar5 * -0x3c;
  if (0x17 < uVar7) {
    (*DAT_0007c9fc)("caljulian.c",0x70,1,"jt->hour < (24)");
  }
  uVar6 = uVar6 + 0xa955b;
  uVar10 = uVar6 % 0x23ab1;
  uVar7 = uVar10 / 0x8eac;
  uVar10 = uVar10 % 0x8eac;
  uVar1 = uVar10 / 0x5b5;
  uVar10 = uVar10 % 0x5b5;
  uVar8 = uVar10 / 0x16d;
  sVar3 = (short)(uVar6 / 0x23ab1) * 400 + (short)uVar7 * 100 + (short)uVar1 * 4 + (short)uVar8;
  *param_2 = sVar3;
  if ((uVar8 | uVar7) < 4) {
    bVar11 = uVar8 == 3;
    uVar10 = uVar10 % 0x16d;
    if (!bVar11) {
      uVar7 = 0x3b;
      uVar8 = 0;
    }
    if (bVar11) {
      bVar11 = uVar7 != 3;
      if (uVar1 == 0x18 && bVar11) {
        uVar7 = 0x3b;
      }
      else {
        uVar7 = 0x3c;
      }
      uVar8 = (uint)(uVar1 != 0x18 || !bVar11);
    }
    if (uVar10 < uVar7) {
      uVar6 = uVar10 * 7 + 0xd9;
    }
    else {
      uVar6 = uVar10 * 7 + 0xe7 + uVar8 * -7;
    }
    param_2[1] = (short)uVar10 + 1;
    *param_2 = sVar3 + 1;
    *(char *)(param_2 + 2) = (char)(uVar6 / 0xd6);
    *(char *)((int)param_2 + 5) = (char)((uVar6 % 0xd6) / 7) + '\x01';
    if (0xb < (uVar6 / 0xd6 & 0xff) - 1) {
      (*DAT_0007c9fc)("caljulian.c",0xa2,1,"1 <= jt->month && jt->month <= 12");
      bVar2 = *(byte *)((int)param_2 + 5);
      goto joined_r0x0004ebf8;
    }
  }
  else {
    *(undefined1 *)(param_2 + 2) = 0xc;
    *(undefined1 *)((int)param_2 + 5) = 0x1f;
    param_2[1] = 0x16e;
  }
  bVar2 = *(byte *)((int)param_2 + 5);
joined_r0x0004ebf8:
  if (0x1e < bVar2 - 1) {
    (*DAT_0007c9fc)("caljulian.c",0xa3,1,"1 <= jt->monthday && jt->monthday <= 31");
  }
  if ((ushort)(param_2[1] - 1U) < 0x16e) {
    return;
  }
  (*DAT_0007c9fc)("caljulian.c",0xa4,1,"1 <= jt->yearday && jt->yearday <= 366");
  return;
}




int FUN_0004ecd0(ushort *param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  
  if (param_1 == (ushort *)0x0) {
    (*DAT_0007c9fc)("caltontp.c",0x29,2,"jt != ((void *)0)");
  }
  if (0xd < (byte)param_1[2]) {
    (*DAT_0007c9fc)("caltontp.c",0x2b,0,"jt->month <= 13");
  }
  if (0x20 < *(byte *)((int)param_1 + 5)) {
    (*DAT_0007c9fc)("caltontp.c",0x2c,0,"jt->monthday <= 32");
  }
  if (0x16e < param_1[1]) {
    (*DAT_0007c9fc)("caltontp.c",0x2d,0,"jt->yearday <= 366");
  }
  if (0x18 < (byte)param_1[3]) {
    (*DAT_0007c9fc)("caltontp.c",0x2e,0,"jt->hour <= 24");
  }
  if (0x3c < *(byte *)((int)param_1 + 7)) {
    (*DAT_0007c9fc)("caltontp.c",0x2f,0,"jt->minute <= (60)");
  }
  uVar3 = (uint)(byte)param_1[4];
  if (0x3c < uVar3) {
    (*DAT_0007c9fc)("caltontp.c",0x30,0,"jt->second <= (60)");
    uVar3 = (uint)(byte)param_1[4];
  }
  if (param_1[1] == 0) {
    uVar4 = (byte)param_1[2] + 9;
    uVar2 = (*param_1 - 1) + uVar4 / 0xc;
    iVar1 = (uVar2 * 0x16d + (*(byte *)((int)param_1 + 5) - 0xa968e) + (uVar2 >> 2) + uVar2 / 400 +
            ((uVar4 % 0xc) * 0x99 + 2) / 5) - uVar2 / 100;
  }
  else {
    uVar2 = *param_1 - 1;
    iVar1 = (uVar2 * 0x16d + (param_1[1] - 0xa955c) + (uVar2 >> 2) + uVar2 / 400) - uVar2 / 100;
  }
  return iVar1 * 0x15180 + (uint)(byte)param_1[3] * 0xe10 + (uint)*(byte *)((int)param_1 + 7) * 0x3c + uVar3;
}




int FUN_0004ef18(int param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  undefined1 auStack_1c [2];
  ushort local_1a;
  undefined1 local_18;
  undefined1 local_17;
  byte local_16;
  byte local_15;
  byte local_14;
  
  FUN_0004e8ec(param_1,auStack_1c);
  uVar5 = (uint)local_14;
  uVar2 = (uint)local_1a;
  uVar6 = (uint)local_16;
  uVar3 = (uint)local_15;
  local_18 = 1;
  local_1a = 0;
  local_16 = 0;
  local_15 = 0;
  local_14 = 0;
  local_17 = 1;
  iVar4 = uVar6 * 0xe10 + uVar2 * 0x15180 + (uVar5 - 0x15180) + uVar3 * 0x3c;
  iVar1 = FUN_0004ecd0(auStack_1c);
  if (iVar1 + iVar4 != param_1) {
    (*DAT_0007c9fc)("calyearstart.c",0x31,3,"(ntp_u_int32_t)(caltontp(&jt) + delta) == (ntp_u_int32_t)ntp_time");
  }
  return param_1 - iVar4;
}




undefined4
FUN_0004efc8(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,int *param_7,uint *param_8)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  
  iVar1 = *param_7;
  param_4 = (((param_1 + -1) * 0x18 + param_2 + param_5) * 0x3c + param_3) * 0x3c + param_4;
  if (iVar1 == 0) {
    iVar1 = FUN_0004ef18(param_6);
    *param_7 = iVar1;
  }
  uVar2 = param_4 + iVar1;
  uVar3 = param_6 + 0x3840;
  if ((uVar2 < uVar3) && (param_6 - 0x3840U < uVar2)) {
    *param_8 = uVar2;
    return 1;
  }
  iVar1 = FUN_0004ef18(param_6);
  if (*param_7 != iVar1) {
    uVar2 = iVar1 + param_4;
    *param_8 = uVar2;
    if ((uVar2 < uVar3) && (param_6 - 0x3840U < uVar2)) {
      *param_7 = iVar1;
      return 1;
    }
  }
  if ((uint)(param_6 - iVar1) < 0x2a300) {
    iVar1 = FUN_0004ef18(iVar1 + -0x2a300);
    if (((*param_7 != iVar1) && (uVar2 = param_4 + iVar1, uVar2 < uVar3)) && (param_6 - 0x3840U < uVar2)) {
      *param_7 = iVar1;
      *param_8 = uVar2;
      return 1;
    }
  }
  iVar1 = FUN_0004ef18(param_6 + 0x2a300);
  if (((*param_7 != iVar1) && (uVar2 = iVar1 + param_4, uVar2 < uVar3)) && (param_6 - 0x3840U < uVar2)) {
    *param_7 = iVar1;
    *param_8 = uVar2;
    return 1;
  }
  return 0;
}




char * FUN_0004f124(uint param_1,uint param_2,int param_3,int param_4,int param_5)

{
  int iVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  int iVar5;
  byte *extraout_r2;
  byte *pbVar6;
  byte *pbVar7;
  char *pcVar8;
  char *pcVar9;
  uint uVar10;
  byte bVar11;
  uint uVar12;
  byte *pbVar13;
  char *__s;
  bool bVar14;
  undefined4 local_44;
  undefined4 local_40;
  undefined4 local_3c;
  undefined4 local_38;
  undefined4 local_34;
  undefined4 local_30;
  undefined4 local_2c;
  byte abStack_27 [3];
  
  local_44 = param_3;
  if (DAT_000c9af4 == 0) {
    FUN_0004f7c0();
  }
  iVar2 = DAT_000cb86c;
  iVar5 = DAT_000cb86c + 1;
  if (199 < iVar5) {
    iVar5 = 0;
  }
  iVar1 = DAT_000cb86c * 0x50;
  __s = &DAT_000cb870 + iVar1;
  DAT_000cb86c = iVar5;
  memset(__s,0,0x50);
  bVar14 = param_1 >> 0x10 == 0;
  pbVar6 = extraout_r2;
  if (bVar14) {
    pbVar6 = (byte *)((int)&local_38 + 2);
  }
  local_40 = 0;
  local_3c = 0;
  local_38 = 0;
  local_34 = 0;
  local_30 = 0;
  local_2c = 0;
  if (!bVar14) {
    uVar10 = param_1 / 10;
    local_38 = (uint)(byte)((char)param_1 - ((char)(uVar10 << 3) + (char)uVar10 * '\x02')) << 8;
    uVar12 = param_1 / 0xa0000;
    pbVar6 = (byte *)((int)&local_38 + 1);
    param_1 = uVar10;
    pbVar4 = (byte *)&local_38;
    while (uVar12 != 0) {
      uVar10 = param_1 / 10;
      if (pbVar4 == (byte *)((int)&local_44 + 2)) goto LAB_0004f3f8;
      *pbVar4 = (char)param_1 - ((char)(uVar10 << 1) + (char)uVar10 * '\b');
      uVar12 = param_1 / 0xa0000;
      pbVar6 = pbVar4;
      param_1 = uVar10;
      pbVar4 = pbVar4 + -1;
    }
  }
  if (param_1 != 0) {
    pbVar4 = pbVar6;
    uVar10 = param_1 & 0xffff;
    do {
      uVar12 = uVar10 / 10;
      if (pbVar4 < &local_40) goto LAB_0004f3f8;
      pbVar6 = pbVar4 + -1;
      pbVar4[-1] = (char)uVar10 + (char)uVar12 * -10;
      pbVar4 = pbVar6;
      uVar10 = uVar12;
    } while (uVar12 != 0);
  }
  if (param_5 == 0) {
    if (-1 < param_4) {
      pbVar4 = (byte *)((int)&local_38 + 2);
      goto LAB_0004f350;
    }
    pbVar4 = (byte *)((int)&local_38 + 2);
    param_4 = 0;
LAB_0004f28c:
    if (param_2 != 0) {
      if (param_4 == 0) {
        pbVar13 = (byte *)((int)&local_38 + 2);
      }
      else {
LAB_0004f374:
        pbVar7 = (byte *)((int)&local_38 + 2);
        do {
          uVar10 = param_2 << 1;
          param_4 = param_4 + -1;
          uVar12 = ((int)param_2 >> 0x1f) * -2;
          if ((int)uVar10 < 0) {
            uVar12 = uVar12 | 1;
          }
          bVar11 = (byte)(uVar12 << 1);
          uVar12 = (uVar10 >> 0x10) + ((param_2 << 3) >> 0x10);
          uVar10 = (param_2 << 3 & 0xffff) + (uVar10 & 0xffff);
          if ((int)(param_2 << 2) < 0) {
            bVar11 = bVar11 | 1;
          }
          bVar11 = bVar11 - (char)((int)param_2 >> 0x1f);
          if ((uVar10 & 0x10000) != 0) {
            uVar12 = uVar12 + 1;
          }
          param_2 = uVar10 & 0xffff | uVar12 << 0x10;
          if ((uVar12 & 0x10000) != 0) {
            bVar11 = bVar11 + 1;
          }
          pbVar13 = pbVar7 + 1;
          *pbVar7 = bVar11;
          if (param_2 == 0) {
            pbVar13 = pbVar13 + param_4;
            goto LAB_0004f2a0;
          }
          if (pbVar13 == abStack_27) {
LAB_0004f3f8:
                    /* WARNING: Subroutine does not return */
            abort();
          }
          pbVar7 = pbVar13;
        } while (param_4 != 0);
      }
      if ((int)param_2 < 0) {
        bVar11 = pbVar13[-1];
        pbVar7 = pbVar13 + -1;
        pbVar13[-1] = bVar11 + 1;
        if (9 < (byte)(bVar11 + 1)) {
          pbVar3 = pbVar13 + -2;
          do {
            pbVar7 = pbVar3;
            bVar11 = *pbVar7;
            pbVar7[1] = 0;
            *pbVar7 = bVar11 + 1;
            pbVar3 = pbVar7 + -1;
          } while (9 < (byte)(bVar11 + 1));
        }
        if (pbVar7 <= pbVar6) {
          pbVar6 = pbVar7;
        }
      }
      goto LAB_0004f2a0;
    }
  }
  else {
    param_4 = param_4 + 3;
    pbVar4 = (byte *)((int)&local_34 + 1);
    if (param_4 < 3) {
      param_4 = 3;
      goto LAB_0004f28c;
    }
LAB_0004f350:
    if (param_4 < 0xd) goto LAB_0004f28c;
    param_4 = 0xc;
    if (param_2 != 0) goto LAB_0004f374;
  }
  pbVar13 = (byte *)((int)&local_38 + param_4 + 2);
LAB_0004f2a0:
  if (pbVar6 < pbVar4) {
    bVar11 = *pbVar6;
    while ((bVar11 == 0 && (pbVar6 = pbVar6 + 1, pbVar6 != pbVar4))) {
      bVar11 = *pbVar6;
    }
  }
  if (pbVar6 == pbVar4) {
    pbVar6 = pbVar6 + -1;
  }
  pcVar9 = __s;
  if (local_44 != 0) {
    (&DAT_000cb870)[iVar2 * 0x50] = 0x2d;
    pcVar9 = &DAT_000cb871 + iVar1;
  }
  if (pbVar6 < pbVar13) {
    do {
      pbVar7 = pbVar6 + 1;
      bVar11 = *pbVar6;
      pcVar8 = pcVar9;
      if (pbVar6 == pbVar4) {
        pcVar8 = pcVar9 + 1;
        *pcVar9 = '.';
      }
      pcVar9 = pcVar8 + 1;
      *pcVar8 = bVar11 + 0x30;
      pbVar6 = pbVar7;
    } while (pbVar7 != pbVar13);
  }
  *pcVar9 = '\0';
  return __s;
}




void * FUN_0004f478(void *param_1,uint param_2,uint param_3,int param_4)

{
  void *pvVar1;
  uint __size;
  int iVar2;
  
  __size = param_2;
  if (param_2 == 0) {
    __size = 1;
  }
  iVar2 = param_4;
  pvVar1 = realloc(param_1,__size);
  if (pvVar1 != (void *)0x0) {
    if (param_4 != 0 && param_3 < param_2) {
      memset((void *)((int)pvVar1 + param_3),0,param_2 - param_3);
    }
    return pvVar1;
  }
  DAT_000c9b08 = 1;
  FUN_0004fe78(3,"fatal out of memory (%lu bytes)",param_2,&DAT_000c9b08,iVar2);
                    /* WARNING: Subroutine does not return */
  exit(1);
}




void * FUN_0004f4e8(char *param_1)

{
  size_t sVar1;
  void *__dest;
  
  sVar1 = strlen(param_1);
  __dest = (void *)FUN_0004f478(0,sVar1 + 1,0,0);
  memcpy(__dest,param_1,sVar1 + 1);
  return __dest;
}




void FUN_0004f524(undefined4 param_1)

{
  FUN_0004f478(0,param_1,0,0);
  return;
}




void FUN_0004f538(void)

{
  return;
}




ushort FUN_0004f53c(byte *param_1,uint *param_2)

{
  ushort **ppuVar1;
  uint uVar2;
  byte *pbVar3;
  uint uVar4;
  int iVar5;
  uint uVar6;
  
  uVar6 = (uint)*param_1;
  if (uVar6 != 0) {
    ppuVar1 = __ctype_b_loc();
    uVar4 = 0;
    pbVar3 = param_1 + 1;
    while( true ) {
      iVar5 = uVar4 * 0x10;
      if (((*ppuVar1)[uVar6] & 0x1000) == 0) {
        return (*ppuVar1)[uVar6] & 0x1000;
      }
      uVar2 = uVar4 & 0xf0000000;
      uVar4 = (uVar6 + iVar5) - 0x30;
      if (uVar2 != 0) break;
      if (9 < uVar6 - 0x30) {
        iVar5 = uVar6 + iVar5;
        uVar4 = iVar5 - 0x57;
        if ((5 < uVar6 - 0x61) && (uVar4 = iVar5 - 0x37, 5 < uVar6 - 0x41)) {
          return 0;
        }
      }
      uVar6 = (uint)*pbVar3;
      pbVar3 = pbVar3 + 1;
      if (uVar6 == 0) {
        *param_2 = uVar4;
        return 1;
      }
    }
  }
  return 0;
}




undefined4 FUN_0004f5e8(int param_1,int param_2)

{
  byte *pbVar1;
  byte bVar2;
  byte bVar3;
  byte *pbVar4;
  uint uVar5;
  uint uVar6;
  size_t __n;
  byte *pbVar7;
  uint uVar8;
  uint uVar9;
  double in_d0;
  undefined3 local_34;
  undefined1 uStack_31;
  undefined4 uStack_30;
  undefined4 uStack_2c;
  char acStack_28 [8];
  byte local_20 [12];
  
  uStack_30 = 0x5e0;
  uStack_2c = 0xfdfd0000;
  if (param_2 == 4) {
    __n = 0xb;
    uVar6 = 4;
  }
  else {
    __n = 0xc;
    uVar6 = 5;
  }
  _local_34 = CONCAT13((char)param_2,0xfefeff);
  snprintf(acStack_28,0x10," %10.0f",acStack_28,in_d0 * 1000000.0);
  if (local_20[2] == 0x20) {
    uVar8 = 0;
    uVar9 = uVar8;
  }
  else {
    pbVar7 = local_20 + 2;
    pbVar4 = (byte *)((int)&uStack_30 + 1);
    uVar8 = 0;
    bVar3 = local_20[2];
    do {
      uVar5 = uVar8;
      bVar2 = bVar3 & 0xf;
      pbVar1 = pbVar7 + -1;
      pbVar7 = pbVar7 + -2;
      bVar3 = *pbVar7;
      uVar8 = uVar5 + 1;
      pbVar4 = pbVar4 + 1;
      *pbVar4 = bVar2 | *pbVar1 << 4;
    } while (bVar3 != 0x20);
    uVar9 = uVar8;
    if ((int)uVar6 <= (int)uVar8) goto LAB_0004f6c8;
  }
  do {
    uVar5 = uVar8 + 1;
    *(undefined1 *)((int)&uStack_30 + uVar8 + 2) = 0;
    uVar8 = uVar5;
  } while (uVar5 != uVar6);
  uVar5 = uVar9 + ~uVar9 + uVar5;
LAB_0004f6c8:
  *(undefined1 *)((int)&uStack_30 + uVar5 + 3) = 0xfd;
  write(param_1,&local_34,__n);
  return 0;
}




int FUN_0004f708(char *param_1,speed_t param_2)

{
  int __fd;
  int iVar1;
  int *piVar2;
  termios local_4c;
  
  __fd = open(param_1,2,0x1ff);
  if (-1 < __fd) {
    iVar1 = tcgetattr(__fd,&local_4c);
    if (-1 < iVar1) {
      local_4c.c_cflag = 0x839;
      local_4c.c_cc[5] = '\x05';
      local_4c.c_iflag = 0;
      local_4c.c_oflag = 0;
      local_4c.c_lflag = 0;
      local_4c.c_cc[6] = '\0';
      cfsetispeed(&local_4c,param_2);
      cfsetospeed(&local_4c,param_2);
      iVar1 = tcsetattr(__fd,0,&local_4c);
      if (-1 < iVar1) {
        return __fd;
      }
    }
    piVar2 = __errno_location();
    iVar1 = *piVar2;
    close(__fd);
    *piVar2 = iVar1;
  }
  return -1;
}




void FUN_0004f7c0(void)

{
  uint uVar1;
  
  DAT_000cb86c = 0;
  uVar1 = FUN_00055f2c();
  DAT_000cb868 = 1 - uVar1;
  if (1 < uVar1) {
    DAT_000cb868 = 0;
  }
  uVar1 = FUN_00055f44();
  DAT_000c9af4 = 1;
  DAT_000cb864 = 1 - uVar1;
  if (1 < uVar1) {
    DAT_000cb864 = 0;
  }
  return;
}




int FUN_0004f818(timeval *param_1,timezone *param_2)

{
  int *piVar1;
  char *pcVar2;
  int iVar3;
  undefined4 uVar4;
  uint uVar5;
  int __errnum;
  uint uVar6;
  __time_t local_3c;
  timespec local_38;
  timeval local_30;
  
  if (DAT_0007cf4c != 0) {
    puts("In ntp_set_tod");
  }
  uVar5 = DAT_000c9af8;
  if (DAT_000c9af8 < 2) {
    local_38.tv_sec = param_1->tv_sec;
    local_38.tv_nsec = param_1->tv_usec * 1000;
    piVar1 = __errno_location();
    *piVar1 = 0;
    iVar3 = clock_settime(0,&local_38);
    __errnum = *piVar1;
    if (DAT_0007cf4c != 0) {
      pcVar2 = strerror(__errnum);
      printf("ntp_set_tod: clock_settime: %d: %s\n",iVar3,pcVar2);
      uVar5 = DAT_000c9af8;
    }
    if (uVar5 == 0 && iVar3 == 0) {
      DAT_000c9af8 = 1;
      iVar3 = 0;
      goto LAB_0004f864;
    }
    if (iVar3 == 0) goto LAB_0004f864;
  }
  else {
    __errnum = 0;
    iVar3 = -1;
  }
  uVar5 = DAT_000c9af8;
  uVar6 = DAT_000c9af8 & 0xfffffffd;
  if (uVar6 == 0) {
    local_30.tv_sec = uVar6;
    local_30.tv_usec = uVar6;
    adjtime(&local_30,(timeval *)0x0);
    piVar1 = __errno_location();
    *piVar1 = 0;
    iVar3 = settimeofday(param_1,param_2);
    __errnum = *piVar1;
    if (DAT_0007cf4c != 0) {
      pcVar2 = strerror(__errnum);
      printf("ntp_set_tod: settimeofday: %d: %s\n",iVar3,pcVar2);
      uVar5 = DAT_000c9af8;
    }
    if (uVar5 == 0 && iVar3 == 0) {
      DAT_000c9af8 = 2;
      iVar3 = 0;
      goto LAB_0004f864;
    }
    if ((iVar3 == 0) || (DAT_000c9af8 != 3 && DAT_000c9af8 != 0)) goto LAB_0004f864;
  }
  else if (DAT_000c9af8 != 3 && DAT_000c9af8 != 0) goto LAB_0004f864;
  uVar5 = DAT_000c9af8;
  local_3c = param_1->tv_sec;
  piVar1 = __errno_location();
  *piVar1 = 0;
  iVar3 = stime(&local_3c);
  __errnum = *piVar1;
  if (DAT_0007cf4c != 0) {
    pcVar2 = strerror(__errnum);
    printf("ntp_set_tod: stime: %d: %s\n",iVar3,pcVar2);
    uVar5 = DAT_000c9af8;
  }
  if (uVar5 == 0 && iVar3 == 0) {
    DAT_000c9af8 = 3;
  }
LAB_0004f864:
  if (DAT_0007cf4c != 0) {
    uVar4 = *(undefined4 *)(&DAT_0006dab0 + DAT_000c9af8 * 4);
    pcVar2 = strerror(__errnum);
    printf("ntp_set_tod: Final result: %s: %d: %s\n",uVar4,iVar3,pcVar2);
  }
  if (iVar3 == 0) {
    if (DAT_000c9afc != (code *)0x0) {
      (*DAT_000c9afc)(*(undefined4 *)(&DAT_0006dab0 + DAT_000c9af8 * 4));
      DAT_000c9afc = (code *)0x0;
    }
  }
  else {
    piVar1 = __errno_location();
    *piVar1 = __errnum;
  }
  return iVar3;
}




void FUN_0004fa94(uint param_1,int param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
  if ((int)param_1 < 0) {
    uVar1 = 1;
    if (param_2 == 0) {
      param_1 = -param_1;
    }
    else {
      param_2 = -param_2;
      param_1 = ~param_1;
    }
  }
  else {
    uVar1 = 0;
  }
  FUN_0004f124(param_1,param_2,uVar1,param_3,0);
  return;
}




void FUN_0004fad4(uint param_1,int param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
  if ((int)param_1 < 0) {
    uVar1 = 1;
    if (param_2 == 0) {
      param_1 = -param_1;
    }
    else {
      param_2 = -param_2;
      param_1 = ~param_1;
    }
  }
  else {
    uVar1 = 0;
  }
  FUN_0004f124(param_1,param_2,uVar1,param_3,1);
  return;
}




void FUN_0004fb14(int param_1,char *param_2)

{
  bool bVar1;
  char *pcVar2;
  char *pcVar3;
  undefined4 uVar4;
  size_t sVar5;
  __pid_t _Var6;
  undefined4 *puVar7;
  int iVar8;
  FILE *pFVar9;
  undefined2 *puVar10;
  undefined1 local_28 [4];
  undefined2 local_24 [2];
  
  pcVar2 = DAT_000caa7c;
  local_24[0] = 10;
  local_28[0] = 0;
  if (DAT_000caa7c != DAT_000c9b00) {
    DAT_000c9b00 = DAT_000caa7c;
    pcVar3 = strrchr(DAT_000caa7c,0x2f);
    if (pcVar3 == (char *)0x0) {
      DAT_000c9b04 = pcVar2;
    }
    else {
      DAT_000c9b04 = pcVar3 + 1;
    }
  }
  iVar8 = DAT_000c9b08;
  if (DAT_0007be68 == 0) {
    if (DAT_000cf6f0 == (FILE *)0x0) {
      iVar8 = 1;
      bVar1 = false;
    }
    else {
      bVar1 = true;
    }
  }
  else {
    bVar1 = false;
    syslog(param_1,"%s",param_2);
  }
  if (0 < DAT_0007cf4c) {
    iVar8 = 1;
  }
  if (iVar8 != 0 || bVar1) {
    uVar4 = FUN_00057f14();
    sVar5 = strlen(param_2);
    pcVar2 = DAT_000c9b04;
    if (param_2[sVar5 - 1] == '\n') {
      puVar10 = (undefined2 *)local_28;
    }
    else {
      puVar10 = local_24;
    }
    if (iVar8 != 0) {
      if (param_1 < 4) {
        puVar7 = &stderr;
      }
      else {
        puVar7 = &stdout;
      }
      pFVar9 = (FILE *)*puVar7;
      _Var6 = getpid();
      fprintf(pFVar9,"%s %s[%d]: %s%s",uVar4,pcVar2,_Var6,param_2,puVar10);
      fflush(pFVar9);
    }
    pFVar9 = DAT_000cf6f0;
    pcVar2 = DAT_000c9b04;
    if (bVar1) {
      _Var6 = getpid();
      fprintf(pFVar9,"%s %s[%d]: %s%s",uVar4,pcVar2,_Var6,param_2,puVar10);
      fflush(DAT_000cf6f0);
    }
  }
  return;
}




void FUN_0004fca0(char *param_1,int param_2,char *param_3,int param_4)

{
  char cVar1;
  char *__s;
  size_t __n;
  char *__dest;
  
  __dest = param_1;
  while( true ) {
    while( true ) {
      cVar1 = *param_3;
      while( true ) {
        if ((cVar1 == '\0') || (param_1 + param_2 + -1 <= __dest)) goto LAB_0004fce8;
        if (cVar1 == '%') break;
        param_3 = param_3 + 1;
        *__dest = cVar1;
        cVar1 = *param_3;
        __dest = __dest + 1;
      }
      cVar1 = param_3[1];
      param_3 = param_3 + 2;
      if (cVar1 != 'm') break;
      __s = strerror(param_4);
      __n = strlen(__s);
      if (__dest + __n < param_1 + param_2 + -1) {
        memcpy(__dest,__s,__n);
        __dest = __dest + __n;
      }
    }
    *__dest = '%';
    if (cVar1 == '\0') break;
    __dest[1] = cVar1;
    __dest = __dest + 2;
  }
  __dest = __dest + 1;
LAB_0004fce8:
  *__dest = '\0';
  return;
}




void FUN_0004fd54(char *param_1,size_t param_2,undefined4 param_3,__gnuc_va_list param_4)

{
  int *piVar1;
  char acStack_118 [260];
  
  piVar1 = __errno_location();
  FUN_0004fca0(acStack_118,0x100,param_3,*piVar1);
  vsnprintf(param_1,param_2,acStack_118,param_4);
  return;
}




void FUN_0004fda0(FILE *param_1,undefined4 param_2,__gnuc_va_list param_3)

{
  int *piVar1;
  char acStack_110 [256];
  
  piVar1 = __errno_location();
  FUN_0004fca0(acStack_110,0x100,param_2,*piVar1);
  vfprintf(param_1,acStack_110,param_3);
  return;
}




void FUN_0004fde4(undefined4 param_1,undefined4 param_2)

{
  FUN_0004fda0(param_1,param_2);
  return;
}




void FUN_0004fe4c(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  FUN_0004fd54(param_1,param_2,param_3);
  return;
}




void FUN_0004fe78(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined1 auStack_418 [1028];
  undefined4 uStack_8;
  undefined4 uStack_4;
  
  uStack_8 = param_3;
  uStack_4 = param_4;
  FUN_0004fd54(auStack_418,0x400,param_2,&uStack_8);
  FUN_0004fb14(param_1,auStack_418);
  return;
}




undefined * FUN_0004fecc(undefined4 *param_1)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  undefined4 uVar8;
  bool bVar9;
  
  iVar1 = DAT_000c9b0c * 0x1c;
  uVar6 = param_1[1];
  uVar8 = param_1[2];
  uVar7 = param_1[3];
  DAT_000c9b0c = DAT_000c9b0c + 1 & 7;
  *(undefined4 *)(&DAT_000c9b10 + iVar1) = *param_1;
  *(undefined4 *)(&DAT_000c9b14 + iVar1) = uVar6;
  *(undefined4 *)(&DAT_000c9b18 + iVar1) = uVar8;
  *(undefined4 *)(&DAT_000c9b1c + iVar1) = uVar7;
  uVar6 = param_1[5];
  uVar7 = param_1[6];
  *(undefined4 *)(&DAT_000c9b20 + iVar1) = param_1[4];
  *(undefined4 *)(&DAT_000c9b24 + iVar1) = uVar6;
  *(undefined4 *)(&DAT_000c9b28 + iVar1) = uVar7;
  if (*(short *)(&DAT_000c9b10 + iVar1) == 2) {
    uVar4 = *(uint *)(&DAT_000c9b14 + iVar1);
    uVar5 = uVar4 >> 0x18;
    uVar2 = uVar4 << 0x18;
    uVar3 = uVar2 | (uVar4 >> 8 & 0xff) << 0x10;
    bVar9 = (uVar2 & 0xe0000000) == 0xc0000000;
    if (bVar9) {
      uVar5 = 0;
    }
    uVar5 = uVar3 | (uVar4 >> 0x10 & 0xff) << 8 | uVar5;
    if ((!bVar9) && ((uVar2 & 0xc0000000) == 0x80000000)) {
      uVar5 = uVar3;
    }
    *(uint *)(&DAT_000c9b14 + iVar1) =
         uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 | (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
    return &DAT_000c9b10 + iVar1;
  }
  if (*(short *)(&DAT_000c9b10 + iVar1) != 10) {
    FUN_0004fe78(3,"netof unknown AF %d");
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  (&DAT_000c9b20)[iVar1] = 0;
  (&DAT_000c9b21)[iVar1] = 0;
  (&DAT_000c9b22)[iVar1] = 0;
  (&DAT_000c9b23)[iVar1] = 0;
  (&DAT_000c9b24)[iVar1] = 0;
  (&DAT_000c9b25)[iVar1] = 0;
  (&DAT_000c9b26)[iVar1] = 0;
  (&DAT_000c9b27)[iVar1] = 0;
  return &DAT_000c9b10 + iVar1;
}




undefined4 FUN_0004ffc0(int param_1,undefined4 param_2,undefined4 param_3)

{
  size_t sVar1;
  size_t sVar2;
  char *__s;
  undefined4 uVar3;
  char *__s_00;
  
  __s_00 = *(char **)(param_1 + 0x30);
  sVar1 = strlen(__s_00);
  sVar2 = strlen(DAT_00079e4c);
  sVar1 = sVar1 + sVar2 + 2;
  __s = (char *)FUN_0004f524(sVar1);
  snprintf(__s,sVar1,"%s\n%s",__s_00,DAT_00079e4c);
  *(char **)(param_1 + 0x30) = __s;
  uVar3 = FUN_0004bd84(param_1,param_2,param_3);
  *(char **)(param_1 + 0x30) = __s_00;
  free(__s);
  return uVar3;
}




char * FUN_00050054(uint param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  char *__s;
  
  if (DAT_000c9af4 == 0) {
    FUN_0004f7c0();
  }
  iVar2 = DAT_000cb86c;
  iVar3 = DAT_000cb86c + 1;
  iVar1 = DAT_000cb86c + -0xc6;
  if (iVar3 < 200) {
    DAT_000cb86c = iVar3;
  }
  __s = &DAT_000cb870 + iVar2 * 0x50;
  if (iVar3 != 199 && iVar1 < 0 == SBORROW4(iVar3,199)) {
    DAT_000cb86c = 0;
  }
  memset(__s,0,0x50);
  snprintf(__s,0x50,"%lu.%lu.%lu.%lu",param_1 & 0xff,param_1 >> 8 & 0xff,param_1 >> 0x10 & 0xff,param_1 >> 0x18);
  return __s;
}




int FUN_000500f4(int param_1,int param_2)

{
  uint uVar1;
  uint uVar2;
  code *pcVar3;
  int iVar4;
  int iVar5;
  int iVar6;
  uint local_1c;
  
  uVar1 = time((time_t *)0x0);
  iVar6 = (int)uVar1 >> 0x1f;
  uVar2 = (uVar1 & 0xffff) + 0xffff;
  if ((uVar2 & 0x10000) == 0) {
    uVar1 = (uVar1 >> 0x10) + 0x7fff;
  }
  else {
    uVar1 = (uVar1 >> 0x10) + 0x8000;
  }
  if ((uVar1 & 0x10000) != 0) {
    iVar6 = iVar6 + 1;
  }
  local_1c = param_1 + 0x7c558180;
  iVar4 = 0;
  if ((uVar2 & 0xffff | uVar1 << 0x10) < local_1c) {
    iVar6 = iVar6 + -1;
  }
  while (iVar5 = iVar4, iVar6 != (int)local_1c >> 0x1f) {
    while (-1 < iVar6) {
      iVar5 = iVar5 + 1;
      if (3 < iVar5) {
        return 0;
      }
      uVar1 = (local_1c & 0xffff) + 0x2380;
      if ((uVar1 & 0x10000) == 0) {
        uVar2 = (local_1c >> 0x10) + 0xcb55;
      }
      else {
        uVar2 = (local_1c >> 0x10) + 0xcb56;
      }
      local_1c = uVar1 & 0xffff | uVar2 << 0x10;
      if ((uVar2 & 0x10000) == 0) {
        iVar6 = iVar6 + -1;
      }
      if (iVar6 == (int)local_1c >> 0x1f) goto LAB_000501a8;
    }
    iVar4 = iVar5 + -1;
    if (iVar5 + 2 < 0 != SCARRY4(iVar4,3)) {
      return 0;
    }
    uVar1 = (int)&PTR_caseD_10b_0000dc80 + (local_1c & 0xffff);
    if ((uVar1 & 0x10000) == 0) {
      uVar2 = (local_1c >> 0x10) + 0x34aa;
    }
    else {
      uVar2 = (local_1c >> 0x10) + 0x34ab;
    }
    local_1c = uVar1 & 0xffff | uVar2 << 0x10;
    if ((uVar2 & 0x10000) != 0) {
      iVar6 = iVar6 + 1;
    }
  }
LAB_000501a8:
  do {
    while( true ) {
      pcVar3 = gmtime;
      if (param_2 != 0) {
        pcVar3 = localtime;
      }
      iVar6 = (*pcVar3)(&local_1c);
      if (iVar6 != 0) {
        if (iVar5 == 0) {
          return iVar6;
        }
        iVar4 = *(int *)(iVar6 + 0x14) + iVar5 * 0x1c;
        *(int *)(iVar6 + 0x14) = iVar4;
        if (0xc6 < iVar4 - 1U) {
          return 0;
        }
        return iVar6;
      }
      uVar1 = local_1c + 0xcb552380;
      if (-1 < (int)local_1c) break;
      iVar4 = iVar5 + -1;
      iVar6 = iVar5 + 2;
      local_1c = local_1c + 0x34aadc80;
      iVar5 = iVar4;
      if (iVar6 < 0 != SCARRY4(iVar4,3)) {
        return 0;
      }
    }
    if (3 < iVar5 + 1) {
      return 0;
    }
    iVar5 = iVar5 + 1;
    local_1c = uVar1;
  } while (-1 < (int)uVar1);
  return 0;
}




char * FUN_000503e0(undefined4 *param_1)

{
  int iVar1;
  int iVar2;
  int iVar3;
  undefined4 *puVar4;
  uint uVar5;
  char *__s;
  
  if (DAT_000c9af4 == 0) {
    FUN_0004f7c0();
  }
  iVar2 = DAT_000cb86c;
  iVar3 = DAT_000cb86c + 1;
  iVar1 = DAT_000cb86c + -0xc6;
  if (iVar3 < 200) {
    DAT_000cb86c = iVar3;
  }
  __s = &DAT_000cb870 + iVar2 * 0x50;
  if (iVar3 != 199 && iVar1 < 0 == SBORROW4(iVar3,199)) {
    DAT_000cb86c = 0;
  }
  memset(__s,0,0x50);
  uVar5 = param_1[1];
  puVar4 = (undefined4 *)FUN_000500f4(*param_1,1);
  if (puVar4 == (undefined4 *)0x0) {
    snprintf(__s,0x50,"%08lx.%08lx  --- --- -- ---- --:--:--",*param_1,param_1[1]);
  }
  else {
    snprintf(__s,0x50,"%08lx.%08lx  %s, %s %2d %4d %2d:%02d:%02d.%03lu",*param_1,param_1[1],
             (&PTR_DAT_0006dbd0)[puVar4[6]],(&PTR_DAT_0007be70)[puVar4[4]],puVar4[3],puVar4[5] + 0x76c,puVar4[2],
             puVar4[1],*puVar4,uVar5 / 0x418937);
  }
  return __s;
}




uint FUN_000504ec(void)

{
  uint *puVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  
  puVar1 = DAT_0007beb8;
  if (DAT_0007bea4 == 0) {
    uVar2 = *DAT_0007bea0 * 0x41a7 + ((int)*DAT_0007bea0 / 0x1f31d) * -0x7fffffff;
    if ((int)uVar2 < 1) {
      uVar2 = uVar2 + 0x7fffffff;
    }
    uVar2 = uVar2 & 0x7fffffff;
    *DAT_0007bea0 = uVar2;
  }
  else {
    uVar4 = *DAT_0007beb4;
    uVar2 = *DAT_0007bea8;
    DAT_0007bea8 = DAT_0007bea8 + 1;
    puVar3 = DAT_0007beb4 + 1;
    *DAT_0007beb4 = uVar4 + uVar2;
    uVar2 = uVar4 + uVar2 >> 1;
    DAT_0007beb4 = DAT_0007bea0;
    if ((puVar3 < puVar1) && (DAT_0007beb4 = puVar3, puVar1 <= DAT_0007bea8)) {
      DAT_0007bea8 = DAT_0007bea0;
    }
  }
  return uVar2;
}




void FUN_000505a4(undefined4 param_1)

{
  undefined4 *puVar1;
  int iVar2;
  int *piVar3;
  int *piVar4;
  int iVar5;
  
  iVar2 = DAT_0007beac;
  puVar1 = DAT_0007bea0;
  if (DAT_0007bea4 == 0) {
    *DAT_0007bea0 = param_1;
    return;
  }
  *DAT_0007bea0 = param_1;
  if (1 < iVar2) {
    piVar3 = puVar1 + 1;
    do {
      iVar5 = piVar3[-1] * 0x41a7 + (piVar3[-1] / 0x1f31d) * -0x7fffffff;
      if (iVar5 < 1) {
        iVar5 = iVar5 + 0x7fffffff;
      }
      piVar4 = piVar3 + 1;
      *piVar3 = iVar5;
      piVar3 = piVar4;
    } while (piVar4 != puVar1 + iVar2);
  }
  DAT_0007bea8 = puVar1;
  DAT_0007beb4 = puVar1 + DAT_0007beb0;
  if (iVar2 * 10 < 1) {
    return;
  }
  iVar5 = 0;
  do {
    iVar5 = iVar5 + 1;
    FUN_000504ec();
  } while (iVar5 != iVar2 * 10);
  return;
}




int FUN_00050670(undefined4 param_1,int *param_2,int param_3)

{
  int iVar1;
  int iVar2;
  int *piVar3;
  int iVar4;
  
  iVar1 = (int)DAT_0007bea0;
  iVar2 = DAT_0007bea4;
  if (DAT_0007bea4 != 0) {
    iVar2 = DAT_0007bea4 + (DAT_0007bea8 - (int)DAT_0007bea0 >> 2) * 5;
  }
  *(int *)((int)DAT_0007bea0 + -4) = iVar2;
  if (param_3 < 8) {
    fprintf(stderr,"random: not enough state (%ld bytes); ignored.\n");
    return 0;
  }
  if (param_3 < 0x20) {
    DAT_0007bea0 = param_2 + 1;
    DAT_0007bea4 = 0;
    DAT_0007beac = 0;
    DAT_0007beb0 = 0;
    DAT_0007beb8 = DAT_0007bea0;
    FUN_000505a4();
    *param_2 = 0;
    return iVar1 + -4;
  }
  if (param_3 < 0x40) {
    DAT_0007beac = 7;
    iVar2 = 0x1c;
    iVar4 = 1;
    DAT_0007bea4 = 1;
    DAT_0007beb0 = 3;
  }
  else if (param_3 < 0x80) {
    iVar4 = 2;
    DAT_0007beac = 0xf;
    DAT_0007bea4 = 2;
    iVar2 = 0x3c;
    DAT_0007beb0 = 1;
  }
  else if (param_3 < 0x100) {
    iVar4 = 3;
    DAT_0007bea4 = 3;
    DAT_0007beb0 = 3;
    iVar2 = 0x7c;
    DAT_0007beac = 0x1f;
  }
  else {
    iVar4 = 4;
    DAT_0007beac = 0x3f;
    DAT_0007bea4 = 4;
    iVar2 = 0xfc;
    DAT_0007beb0 = 1;
  }
  piVar3 = param_2 + 1;
  DAT_0007beb8 = (int *)((int)piVar3 + iVar2);
  DAT_0007bea0 = piVar3;
  FUN_000505a4();
  *param_2 = (DAT_0007bea8 - (int)piVar3 >> 2) * 5 + iVar4;
  return iVar1 + -4;
}




undefined4 FUN_000508d8(void)

{
  return DAT_000c9bfc;
}




undefined4 FUN_000508e8(void)

{
  return DAT_000c9c00;
}




undefined4 FUN_000508f8(void)

{
  return DAT_000c9c04;
}




undefined4 FUN_00050908(void)

{
  return DAT_000c9c08;
}




void FUN_00050918(int param_1,void *param_2,int param_3,undefined4 param_4)

{
  void *__s;
  int iVar1;
  
  iVar1 = 0;
  DAT_000c9bf0 = 0;
  param_1 = param_1 + DAT_000c9c0c;
  DAT_000c9bf4 = 0;
  DAT_000c9c04 = 0;
  DAT_000c9bfc = 0;
  DAT_000c9c08 = 0;
  DAT_000c9c00 = 0;
  DAT_000c9c0c = 0;
  __s = DAT_000c9bf8;
  if (param_1 < 1) {
    DAT_000c9c08 = 1;
  }
  else {
    do {
      DAT_000c9bf8 = __s;
      iVar1 = iVar1 + 1;
      __s = (void *)FUN_0004f524(0x448);
      memset(__s,0,0x448);
      param_3 = DAT_000c9bfc + 1;
      *(void **)((int)__s + 4) = DAT_000c9bf8;
      DAT_000c9c04 = DAT_000c9c04 + 1;
      DAT_000c9bfc = param_3;
    } while (param_1 != iVar1);
    DAT_000c9c08 = DAT_000c9c08 + 1;
    param_2 = DAT_000c9bf8;
    DAT_000c9bf8 = __s;
  }
  FUN_0005b388(&LAB_000507c8,param_2,param_3,param_4);
  return;
}




void FUN_000509c4(int param_1)

{
  int iVar1;
  
  if (param_1 != 0) {
    iVar1 = *(int *)(param_1 + 0x444) + -1;
    *(int *)(param_1 + 0x444) = iVar1;
    if (iVar1 != 0) {
      FUN_0004fe78(3,"******** freerecvbuff non-zero usage: %d *******");
    }
    iVar1 = param_1;
    *(int *)(param_1 + 4) = DAT_000c9bf8;
    DAT_000c9bf8 = iVar1;
    DAT_000c9bfc = DAT_000c9bfc + 1;
    return;
  }
  FUN_0004fe78(3,"freerecvbuff received NULL buffer");
  return;
}




void FUN_00050a30(int *param_1)

{
  undefined4 *puVar1;
  int iVar2;
  int *piVar3;
  bool bVar4;
  
  if (param_1 != (int *)0x0) {
    param_1[1] = -1;
    *param_1 = -1;
    iVar2 = (int)DAT_000c9bf4;
    bVar4 = DAT_000c9bf4 != (int *)0x0;
    piVar3 = param_1;
    if (bVar4) {
      puVar1 = (undefined4 *)((int)DAT_000c9bf4 + 4);
      DAT_000c9bf4 = param_1;
      *puVar1 = param_1;
      piVar3 = DAT_000c9bf4;
    }
    DAT_000c9bf4 = piVar3;
    *param_1 = iVar2;
    if (!bVar4) {
      DAT_000c9bf0 = param_1;
    }
    param_1[1] = 0;
    DAT_000c9c00 = DAT_000c9c00 + 1;
    return;
  }
  FUN_0004fe78(3,"add_full_recv_buffer received NULL buffer");
  return;
}




void * FUN_00050a8c(void)

{
  void *__s;
  undefined4 uVar1;
  
  __s = DAT_000c9bf8;
  if (DAT_000c9bf8 != (void *)0x0) {
    uVar1 = *(undefined4 *)((int)DAT_000c9bf8 + 4);
    *(undefined4 *)((int)DAT_000c9bf8 + 4) = 0;
    DAT_000c9bfc = DAT_000c9bfc + -1;
    DAT_000c9bf8 = (void *)uVar1;
    memset(__s,0,0x448);
    *(undefined4 *)((int)__s + 0x444) = 1;
    return __s;
  }
  DAT_000c9c0c = DAT_000c9c0c + 1;
  return (void *)0x0;
}




undefined4 * FUN_00050af4(void)

{
  undefined4 *puVar1;
  undefined4 in_r3;
  undefined4 *puVar2;
  
  puVar1 = DAT_000c9bf0;
  if (DAT_000c9bf0 != (undefined4 *)0x0) {
    if ((undefined4 *)DAT_000c9bf0[1] == (undefined4 *)0x0) {
      if (DAT_000c9bf4 != DAT_000c9bf0) {
        (*DAT_0007c9fc)("recvbuff.c",0xfa,2,"(full_recv_list).tail == (rbuf)",in_r3);
      }
      puVar2 = (undefined4 *)*puVar1;
      DAT_000c9bf4 = puVar2;
    }
    else {
      *(undefined4 *)DAT_000c9bf0[1] = *DAT_000c9bf0;
      puVar2 = (undefined4 *)*puVar1;
    }
    if (puVar2 == (undefined4 *)0x0) {
      if (DAT_000c9bf0 != puVar1) {
        (*DAT_0007c9fc)("recvbuff.c",0xfa,2,"(full_recv_list).head == (rbuf)");
      }
      DAT_000c9bf0 = (undefined4 *)puVar1[1];
    }
    else {
      puVar2[1] = puVar1[1];
    }
    *puVar1 = 0xffffffff;
    puVar1[1] = 0xffffffff;
    DAT_000c9c00 = DAT_000c9c00 + -1;
    return puVar1;
  }
  DAT_000c9c00 = 0;
  return (undefined4 *)0x0;
}




int FUN_00050bd4(void)

{
  int iVar1;
  
  iVar1 = DAT_000c9bf0;
  if (DAT_000c9bf0 != 0) {
    iVar1 = 1;
  }
  return iVar1;
}




char * FUN_00050bec(short *param_1)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  char *__format;
  char *__s;
  uint uVar6;
  
  if (DAT_000c9af4 == 0) {
    FUN_0004f7c0();
  }
  iVar3 = DAT_000cb86c;
  iVar5 = DAT_000cb86c + 1;
  iVar1 = DAT_000cb86c + -0xc6;
  if (iVar5 < 200) {
    DAT_000cb86c = iVar5;
  }
  __s = &DAT_000cb870 + iVar3 * 0x50;
  if (iVar5 != 199 && iVar1 < 0 == SBORROW4(iVar5,199)) {
    DAT_000cb86c = 0;
  }
  memset(__s,0,0x50);
  if (*param_1 == 2) {
    uVar6 = *(uint *)(param_1 + 2);
    uVar2 = uVar6 >> 0x10 & 0xff;
    if ((uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10) == 0x7f7f0000) {
      uVar4 = FUN_00057ec0(uVar2);
      if (uVar4 == 0) {
        __format = "REFCLK(%lu,%lu)";
      }
      else {
        __format = "%s(%lu)";
        uVar2 = uVar4;
      }
      snprintf(__s,0x50,__format,uVar2,uVar6 >> 0x18);
    }
  }
  return __s;
}




char * FUN_00050cd0(ushort *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  int iVar3;
  uint uVar4;
  char *__dest;
  
  if (DAT_000c9af4 == 0) {
    FUN_0004f7c0();
  }
  iVar2 = DAT_000cb86c;
  iVar3 = DAT_000cb86c + 1;
  iVar1 = DAT_000cb86c + -0xc6;
  if (iVar3 < 200) {
    DAT_000cb86c = iVar3;
  }
  __dest = &DAT_000cb870 + iVar2 * 0x50;
  if (iVar3 != 199 && iVar1 < 0 == SBORROW4(iVar3,199)) {
    DAT_000cb86c = 0;
  }
  memset(__dest,0,0x50);
  if (param_1 == (ushort *)0x0) {
    strncpy(__dest,"(null)",0x50);
  }
  else {
    uVar4 = (uint)*param_1;
    if (uVar4 != 2) {
      if (uVar4 == 10) {
        inet_ntop(10,param_1 + 4,__dest,0x50);
        return __dest;
      }
      if (uVar4 != 0) {
        snprintf(__dest,0x50,"(socktoa unknown family %d)",uVar4,param_4);
        return __dest;
      }
    }
    inet_ntop(2,param_1 + 2,__dest,0x50);
  }
  return __dest;
}




undefined * FUN_00050dc4(int param_1,int *param_2)

{
  int iVar1;
  
  iVar1 = *param_2;
  while( true ) {
    if (iVar1 == -1) {
      snprintf(&DAT_000c9c10,0x1e,"%s_%d",param_2[1],param_1);
      return &DAT_000c9c10;
    }
    if (iVar1 == param_1) break;
    param_2 = param_2 + 2;
    iVar1 = *param_2;
  }
  return (undefined *)param_2[1];
}




char * FUN_00050e24(int param_1)

{
  char *pcVar1;
  undefined *puVar2;
  
  if (param_1 == 0) {
    pcVar1 = "no events";
  }
  else {
    puVar2 = &DAT_000665cc;
    if (param_1 != 1) {
      puVar2 = &DAT_0006dbbc;
    }
    snprintf(&DAT_000c9c30,0x14,"%d event%s",param_1,puVar2);
    pcVar1 = &DAT_000c9c30;
  }
  return pcVar1;
}




char * FUN_00050e84(int param_1,uint param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  char *pcVar4;
  size_t sVar5;
  undefined4 *puVar6;
  int iVar7;
  char *__s;
  
  if (DAT_000c9af4 == 0) {
    FUN_0004f7c0();
  }
  iVar2 = DAT_000cb86c;
  iVar7 = DAT_000cb86c + 1;
  if (199 < iVar7) {
    iVar7 = 0;
  }
  iVar1 = DAT_000cb86c * 0x50;
  __s = &DAT_000cb870 + iVar1;
  DAT_000cb86c = iVar7;
  memset(__s,0,0x50);
  if (param_1 == 2) {
    uVar3 = (int)param_2 >> 8;
    if ((uVar3 & 0x80) == 0) {
      if ((uVar3 & 0x40) != 0) {
        sVar5 = strlen(__s);
        builtin_strncpy(&DAT_000cb870 + sVar5 + iVar2 * 0x50,"auth",4);
        builtin_strncpy(&DAT_000cb874 + sVar5 + iVar2 * 0x50,"enb",4);
      }
    }
    else {
      builtin_strncpy(&DAT_000cb870 + iVar1,"conf",4);
      (&DAT_000cb874)[iVar1] = 0;
      if ((uVar3 & 0x40) != 0) {
        iVar7 = iVar2 * 0x50;
        builtin_strncpy(&DAT_000cb874 + iVar7,", au",4);
        builtin_strncpy(&DAT_000cb878 + iVar7,"then",4);
        (&DAT_000cb87c + iVar7)[0] = 'b';
        (&DAT_000cb87c + iVar7)[1] = '\0';
      }
    }
    if ((uVar3 & 0x20) != 0) {
      if ((uVar3 & 0xc0) == 0) {
        sVar5 = strlen(__s);
        builtin_strncpy(&DAT_000cb870 + sVar5 + iVar2 * 0x50,"auth",4);
        (&DAT_000cb874)[sVar5 + iVar2 * 0x50] = '\0';
      }
      else {
        sVar5 = strlen(__s);
        iVar7 = sVar5 + iVar2 * 0x50;
        builtin_strncpy(&DAT_000cb870 + sVar5 + iVar2 * 0x50,", au",4);
        (&DAT_000cb874 + iVar7)[0] = 't';
        (&DAT_000cb874 + iVar7)[1] = 'h';
        (&DAT_000cb876)[iVar7] = '\0';
      }
    }
    if ((uVar3 & 0x10) != 0) {
      if ((uVar3 & 0xe0) == 0) {
        sVar5 = strlen(__s);
        builtin_strncpy(&DAT_000cb870 + sVar5 + iVar2 * 0x50,"reac",4);
        (&DAT_000cb874 + sVar5 + iVar2 * 0x50)[0] = 'h';
        (&DAT_000cb874 + sVar5 + iVar2 * 0x50)[1] = '\0';
      }
      else {
        sVar5 = strlen(__s);
        builtin_strncpy(&DAT_000cb870 + sVar5 + iVar2 * 0x50,", re",4);
        builtin_strncpy(&DAT_000cb874 + sVar5 + iVar2 * 0x50,"ach",4);
      }
    }
    if ((uVar3 & 8) != 0) {
      if ((uVar3 & 0xf0) == 0) {
        sVar5 = strlen(__s);
        iVar7 = sVar5 + iVar2 * 0x50;
        *(undefined4 *)(&DAT_000cb870 + iVar7) = 0x74736362;
        (&DAT_000cb874)[iVar7] = 0;
      }
      else {
        sVar5 = strlen(__s);
        iVar7 = sVar5 + iVar2 * 0x50;
        *(undefined4 *)(&DAT_000cb870 + iVar7) = 0x6362202c;
        *(undefined2 *)(&DAT_000cb874 + iVar7) = 0x7473;
        (&DAT_000cb876)[iVar7] = 0;
      }
    }
    sVar5 = strlen(__s);
    iVar2 = iVar2 * 0x50;
    *(undefined2 *)(&DAT_000cb870 + iVar2 + sVar5) = 0x202c;
    (&DAT_000cb872)[iVar2 + sVar5] = 0;
    pcVar4 = (char *)FUN_00050dc4(uVar3 & 7,&DAT_0007c04c);
    sVar5 = strlen(__s);
    pcVar4 = stpcpy(&DAT_000cb870 + iVar2 + sVar5,pcVar4);
    *(undefined2 *)(&DAT_000cb870 + (int)(pcVar4 + (iVar2 - (int)__s))) = 0x202c;
    (&DAT_000cb872)[(int)(pcVar4 + (iVar2 - (int)__s))] = 0;
    pcVar4 = (char *)FUN_00050e24((param_2 << 0x18) >> 0x1c);
    sVar5 = strlen(__s);
    pcVar4 = stpcpy(&DAT_000cb870 + iVar2 + sVar5,pcVar4);
    if ((param_2 & 0xf) != 0) {
      *(undefined2 *)(&DAT_000cb870 + (int)(pcVar4 + (iVar2 - (int)__s))) = 0x202c;
      (&DAT_000cb872)[(int)(pcVar4 + (iVar2 - (int)__s))] = 0;
      pcVar4 = (char *)FUN_00050dc4(param_2 & 0xf,&DAT_0007c094);
      strcat(__s,pcVar4);
    }
    return __s;
  }
  if (param_1 == 3) {
    sVar5 = strlen(__s);
    iVar7 = iVar2 * 0x50 + sVar5;
    *(undefined2 *)(&DAT_000cb870 + iVar7) = 0x202c;
    (&DAT_000cb872)[iVar7] = 0;
    pcVar4 = (char *)FUN_00050e24((param_2 << 0x18) >> 0x1c);
    sVar5 = strlen(__s);
    pcVar4 = stpcpy(&DAT_000cb870 + iVar2 * 0x50 + sVar5,pcVar4);
    puVar6 = (undefined4 *)&DAT_0007c11c;
  }
  else {
    if (param_1 != 1) {
      return __s;
    }
    pcVar4 = (char *)FUN_00050dc4((param_2 << 0x10) >> 0x1e,&DAT_0007bf3c);
    iVar7 = iVar2 * 0x50;
    pcVar4 = stpcpy(__s,pcVar4);
    pcVar4 = pcVar4 + (iVar7 - (int)__s);
    *(undefined2 *)(&DAT_000cb870 + (int)pcVar4) = 0x202c;
    (&DAT_000cb872)[(int)pcVar4] = 0;
    pcVar4 = (char *)FUN_00050dc4((param_2 << 0x12) >> 0x1a,&DAT_0007bf64,&DAT_000cb870 + (int)pcVar4,pcVar4,param_4);
    sVar5 = strlen(__s);
    pcVar4 = stpcpy(&DAT_000cb870 + iVar7 + sVar5,pcVar4);
    *(undefined2 *)(&DAT_000cb870 + (int)(pcVar4 + (iVar7 - (int)__s))) = 0x202c;
    (&DAT_000cb872)[(int)(pcVar4 + (iVar7 - (int)__s))] = 0;
    pcVar4 = (char *)FUN_00050e24((param_2 << 0x18) >> 0x1c);
    sVar5 = strlen(__s);
    pcVar4 = stpcpy(&DAT_000cb870 + iVar7 + sVar5,pcVar4);
    puVar6 = &DAT_0007bfbc;
  }
  *(undefined2 *)(&DAT_000cb870 + (int)(pcVar4 + (iVar2 * 0x50 - (int)__s))) = 0x202c;
  (&DAT_000cb872)[(int)(pcVar4 + (iVar2 * 0x50 - (int)__s))] = 0;
  pcVar4 = (char *)FUN_00050dc4(param_2 & 0xf,puVar6);
  strcat(__s,pcVar4);
  return __s;
}




void FUN_000512ec(uint param_1)

{
  if ((param_1 & 0x80) == 0) {
    FUN_00050dc4(param_1,&DAT_0007bfbc);
    return;
  }
  FUN_00050dc4(param_1 & 0xffffff7f,&DAT_0007c094);
  return;
}




void FUN_00051310(undefined4 param_1)

{
  FUN_00050dc4(param_1,&DAT_0007c11c);
  return;
}




void FUN_0005131c(int param_1,_union_1051 param_2)

{
  int iVar1;
  int *piVar2;
  _union_1051 local_130;
  sigset_t sStack_12c;
  undefined4 local_ac;
  sigaction sStack_a4;
  
  local_130 = param_2;
  sigemptyset(&sStack_12c);
  if (param_1 == 0x1d) {
    local_ac = 0x10000000;
  }
  else {
    local_ac = 0;
  }
  do {
    iVar1 = sigaction(param_1,(sigaction *)&local_130,&sStack_a4);
    if (iVar1 != -1) break;
    piVar2 = __errno_location();
  } while (*piVar2 == 4);
  if ((sStack_a4.sa_flags & 0xefffffffU) != 0) {
    FUN_0004fe78(7,"signal_no_reset: signal %d had flags %x",param_1);
  }
  if (iVar1 == -1) {
    perror("sigaction");
                    /* WARNING: Subroutine does not return */
    exit(1);
  }
  return;
}




int FUN_000513cc(uint param_1,int param_2,int param_3)

{
  int *piVar1;
  undefined4 *puVar2;
  int iVar3;
  uint uVar4;
  
  uVar4 = param_2 - 1;
  if ((uVar4 < 0xc) && (0 < param_3)) {
    if ((((param_1 & 3) == 0) && ((int)param_1 % 100 != 0)) || ((int)param_1 % 400 == 0)) {
      puVar2 = &DAT_0007c99c;
    }
    else {
      puVar2 = &DAT_0007c9cc;
    }
    if (param_3 <= (int)puVar2[uVar4]) {
      if (param_2 == 1) {
        return param_3;
      }
      iVar3 = 0;
      do {
        piVar1 = (int *)((int)puVar2 + iVar3);
        iVar3 = iVar3 + 4;
        param_3 = param_3 + *piVar1;
      } while (uVar4 * 4 - iVar3 != 0);
      return param_3;
    }
  }
  return -1;
}




void FUN_00051490(undefined4 param_1,undefined4 param_2,uint param_3,undefined4 param_4)

{
  FILE *__stream;
  undefined4 uVar1;
  undefined *puVar2;
  
  __stream = stderr;
  if (param_3 < 4) {
    puVar2 = (&PTR_s_REQUIRE_0006e20c)[param_3];
  }
  else {
    puVar2 = (undefined *)0x0;
  }
  uVar1 = FUN_00055ca4(DAT_000c9c48,1,0x65,"failed");
  fprintf(__stream,"%s:%d: %s(%s) %s.\n",param_1,param_2,puVar2,param_4,uVar1);
  fflush(stderr);
                    /* WARNING: Subroutine does not return */
  abort();
}




void FUN_00051514(code *param_1)

{
  DAT_0007c9fc = param_1;
  if (param_1 == (code *)0x0) {
    DAT_0007c9fc = FUN_00051490;
  }
  return;
}




undefined * FUN_00051534(uint param_1)

{
  undefined *puVar1;
  
  if (param_1 < 4) {
    puVar1 = (&PTR_s_REQUIRE_0006e20c)[param_1];
  }
  else {
    puVar1 = (undefined *)0x0;
  }
  return puVar1;
}




void FUN_0005154c(undefined4 param_1,undefined4 param_2,char *param_3,__gnuc_va_list param_4)

{
  FILE *__stream;
  undefined4 uVar1;
  
  __stream = stderr;
  uVar1 = FUN_00055ca4(DAT_000c9c48,1,0x6e,"fatal error");
  fprintf(__stream,"%s:%d: %s: ",param_1,param_2,uVar1);
  vfprintf(stderr,param_3,param_4);
  fputc(10,stderr);
  fflush(stderr);
  return;
}




void FUN_000515d8(undefined4 param_1,undefined4 param_2,char *param_3,__gnuc_va_list param_4)

{
  fprintf(stderr,"%s:%d: ",param_1,param_2);
  vfprintf(stderr,param_3,param_4);
  fputc(10,stderr);
  fflush(stderr);
  return;
}




void FUN_0005162c(code *param_1)

{
  DAT_0007ca00 = param_1;
  if (param_1 == (code *)0x0) {
    DAT_0007ca00 = FUN_000515d8;
  }
  return;
}




void FUN_0005164c(code *param_1)

{
  DAT_0007ca04 = param_1;
  if (param_1 == (code *)0x0) {
    DAT_0007ca04 = FUN_0005154c;
  }
  return;
}




void FUN_0005166c(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uStack_4;
  
  uStack_4 = param_4;
  (*DAT_0007ca00)(param_1,param_2,param_3,&uStack_4);
  return;
}




void FUN_000516a8(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uStack_4;
  
  uStack_4 = param_4;
  (*DAT_0007ca04)(param_1,param_2,param_3,&uStack_4);
                    /* WARNING: Subroutine does not return */
  abort();
}




void FUN_000516d8(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  undefined4 uVar1;
  
  uVar1 = FUN_00055ca4(DAT_000c9c48,1,0x65,"failed");
                    /* WARNING: Subroutine does not return */
  FUN_000516a8(param_1,param_2,"RUNTIME_CHECK(%s) %s",param_3,uVar1);
}




void FUN_00051728(int param_1)

{
  char *pcVar1;
  
  if ((*(FILE **)(param_1 + 0x24) != (FILE *)0x0) &&
     (pcVar1 = fgets((char *)(param_1 + 0x28),0x3f,*(FILE **)(param_1 + 0x24)), pcVar1 != (char *)0x0)) {
    *(undefined4 *)(param_1 + 0x68) = 0;
    return;
  }
  *(undefined4 *)(param_1 + 0x68) = 0x1d;
  return;
}




undefined4 FUN_00051768(int param_1)

{
  undefined4 uVar1;
  uint uVar2;
  
  uVar2 = *(uint *)(param_1 + 0x20);
  if (*(uint *)(param_1 + 0x10) <= uVar2) {
    if (uVar2 != *(uint *)(param_1 + 0x10)) {
      (*DAT_0007c9fc)("./../lib/isc/unix/ifiter_ioctl.c",900,2,"iter->pos == (unsigned int) iter->ifc.ifc_len");
    }
    uVar1 = FUN_00051728(param_1);
    return uVar1;
  }
  *(uint *)(param_1 + 0x20) = uVar2 + 0x20;
  return 0;
}




void FUN_000517c8(int param_1,int *param_2,int param_3,char *param_4)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  int iVar4;
  
  memset(param_2,0,0x18);
  *param_2 = param_1;
  if (param_1 == 2) {
    param_2[1] = *(int *)(param_3 + 4);
    return;
  }
  if (param_1 != 10) {
    (*DAT_0007c9fc)("./../lib/isc/unix/interfaceiter.c",0x8f,2,"0");
    return;
  }
  iVar4 = *(int *)(param_3 + 0xc);
  iVar1 = *(int *)(param_3 + 0x10);
  iVar3 = *(int *)(param_3 + 0x14);
  param_2[1] = *(int *)(param_3 + 8);
  param_2[2] = iVar4;
  param_2[3] = iVar1;
  param_2[4] = iVar3;
  if (*(int *)(param_3 + 0x18) != 0) {
    FUN_000568f4(param_2,*(int *)(param_3 + 0x18),(int *)(param_3 + 8),param_4);
    return;
  }
  if ((*(uint *)(param_3 + 8) & 0xc0ff) != 0x80fe) {
    return;
  }
  if ((*(ushort *)(param_3 + 10) & 0xff) != 0 || *(ushort *)(param_3 + 10) >> 8 != 0) {
    FUN_000568f4(param_2);
    *(undefined1 *)((int)param_2 + 6) = 0;
    *(undefined1 *)((int)param_2 + 7) = 0;
    return;
  }
  if (param_4 == (char *)0x0) {
    return;
  }
  uVar2 = if_nametoindex(param_4);
  if (uVar2 == 0) {
    return;
  }
  FUN_000568f4(param_2);
  return;
}




int FUN_000518e0(int *param_1)

{
  byte *pbVar1;
  undefined1 uVar2;
  undefined4 *puVar3;
  size_t sVar4;
  char *pcVar5;
  undefined4 uVar6;
  undefined4 uVar7;
  uint uVar8;
  char *pcVar9;
  uint uVar10;
  int iVar11;
  int iVar12;
  int *piVar13;
  byte *pbVar14;
  byte *pbVar15;
  int local_1a0;
  int local_19c;
  undefined1 auStack_198 [4];
  undefined4 local_194;
  byte local_190 [16];
  char acStack_180 [20];
  char local_16c [16];
  uint local_15c;
  undefined4 local_158;
  undefined4 local_154;
  undefined4 local_150;
  undefined4 local_14c;
  int local_148;
  int local_144;
  int local_140;
  uint local_13c;
  int local_138;
  int local_134;
  int local_130;
  byte abStack_12c [4];
  undefined1 auStack_128 [260];
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x49464954)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/ifiter_ioctl.c",0x1bb,0,
                    "(((iter) != ((void *)0)) && (((const isc__magic_t *)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | (\'I\') << 8 | (\'T\')))))"
                   );
  }
  uVar10 = param_1[4];
  if (uVar10 == 0) {
LAB_000519c4:
    if (param_1[0x1a] != 0) {
      return param_1[0x1a];
    }
    if (param_1[9] == 0) {
      FUN_000548c4(DAT_000c9c5c,&DAT_0007ca10,&DAT_0007ca30,0xfffffffc,"/proc/net/if_inet6:iter->proc == NULL");
      return 0x19;
    }
    puVar3 = (undefined4 *)
             sscanf((char *)(param_1 + 10),"%32[a-f0-9] %x %x %x %x %16s\n",&local_14c,&local_1a0,&local_19c,auStack_198
                    ,&local_194,acStack_180);
    if (puVar3 == (undefined4 *)0x6) {
      sVar4 = strlen((char *)&local_14c);
      if (sVar4 == 0x20) {
        if ((local_194 & 0x40) == 0) {
          pbVar15 = (byte *)((int)&local_194 + 3);
          pbVar14 = (byte *)&local_14c;
          do {
            pcVar9 = strchr("0123456789abcdef",(uint)*pbVar14);
            pbVar1 = pbVar14 + 1;
            pbVar14 = pbVar14 + 2;
            pcVar5 = strchr("0123456789abcdef",(uint)*pbVar1);
            pbVar15 = pbVar15 + 1;
            *pbVar15 = (char)pcVar5 + 0x74U | ((char)pcVar9 + 't') * '\x10';
          } while (pbVar14 != abStack_12c);
          param_1[0x3c] = 0;
          param_1[0x23] = 10;
          local_16c[0] = '\0';
          local_16c[1] = '\0';
          local_16c[2] = '\0';
          local_16c[3] = '\0';
          local_16c[4] = '\0';
          local_16c[5] = '\0';
          local_16c[6] = '\0';
          local_16c[7] = '\0';
          local_16c[8] = '\0';
          local_16c[9] = '\0';
          local_16c[10] = '\0';
          local_16c[0xb] = '\0';
          local_16c[0xc] = '\0';
          local_16c[0xd] = '\0';
          local_16c[0xe] = '\0';
          local_16c[0xf] = '\0';
          local_15c = 0;
          local_158 = 0;
          local_154 = 0;
          local_150 = 0;
          strncpy(local_16c,acStack_180,0x10);
          iVar12 = ioctl(param_1[3],0x8913,local_16c);
          if (-1 < iVar12) {
            piVar13 = param_1 + 0x24;
            if ((local_15c & 1) != 0) {
              param_1[0x3c] = param_1[0x3c] | 1;
            }
            if ((local_15c & 0x10) != 0) {
              param_1[0x3c] = param_1[0x3c] | 2;
            }
            if ((local_15c & 8) != 0) {
              param_1[0x3c] = param_1[0x3c] | 4;
            }
            if ((local_15c & 2) != 0) {
              param_1[0x3c] = param_1[0x3c] | 8;
            }
            if ((local_15c & 0x1000) != 0) {
              param_1[0x3c] = param_1[0x3c] | 0x10;
            }
            FUN_000568bc(piVar13,local_190);
            param_1[0x3d] = local_1a0;
            iVar12 = FUN_00056a98(piVar13);
            if (iVar12 != 0) {
              FUN_000568f4(piVar13,local_1a0);
            }
            iVar12 = 0;
            do {
              uVar10 = 8 - local_19c;
              if (local_19c < 9) {
                local_19c = 0;
                local_190[iVar12] = (byte)(0xff << (uVar10 & 0xff));
              }
              else {
                local_19c = local_19c + -8;
                local_190[iVar12] = 0xff;
              }
              iVar12 = iVar12 + 1;
            } while (iVar12 != 0x10);
            FUN_000568bc(param_1 + 0x2a,local_190);
            strncpy((char *)(param_1 + 0x1b),acStack_180,0x20);
            return 0;
          }
          piVar13 = __errno_location();
          FUN_00057070(*piVar13,auStack_128,0x80);
          FUN_0005166c("./../lib/isc/unix/interfaceiter.c",0xf8,"%s: getting interface flags: %s",local_16c,auStack_128)
          ;
          return 0x24;
        }
        goto LAB_000519b4;
      }
      pcVar9 = "/proc/net/if_inet6:strlen(%s) != 32";
      puVar3 = &local_14c;
    }
    else {
      pcVar9 = "/proc/net/if_inet6:sscanf() -> %d (expected 6)";
    }
    iVar12 = 0x19;
    FUN_000548c4(DAT_000c9c5c,&DAT_0007ca10,&DAT_0007ca30,0xfffffffc,pcVar9,puVar3);
  }
  else {
    uVar8 = param_1[8];
    if (uVar8 == uVar10) goto LAB_000519c4;
    if (uVar10 <= uVar8) {
      (*DAT_0007c9fc)("./../lib/isc/unix/ifiter_ioctl.c",0x1c6,2,"iter->pos < (unsigned int) iter->ifc.ifc_len");
      uVar8 = param_1[8];
    }
    piVar13 = (int *)(param_1[5] + uVar8);
    local_14c = *piVar13;
    local_148 = piVar13[1];
    local_144 = piVar13[2];
    local_140 = piVar13[3];
    local_13c = piVar13[4];
    local_138 = piVar13[5];
    local_134 = piVar13[6];
    local_130 = piVar13[7];
    uVar10 = local_13c & 0xffff;
    if ((local_13c & 0xfff7) == 2) {
      memset(param_1 + 0x1b,0,0x8c);
      param_1[0x23] = uVar10;
      memset(param_1 + 0x1b,0,0x20);
      param_1[0x1b] = local_14c;
      param_1[0x1c] = local_148;
      param_1[0x1d] = local_144;
      param_1[0x1e] = local_140;
      FUN_000517c8(uVar10,param_1 + 0x24,piVar13 + 4,&local_14c);
      if (uVar10 == 2) {
        iVar12 = param_1[0x25];
      }
      else {
        if (uVar10 != 10) goto LAB_00051af8;
        iVar12 = memcmp(param_1 + 0x25,in6addr_any,0x10);
      }
      if (iVar12 != 0) {
LAB_00051af8:
        param_1[0x3c] = 0;
        iVar12 = ioctl(param_1[3],0x8913,&local_14c);
        if (iVar12 < 0) {
          piVar13 = __errno_location();
          FUN_00057070(*piVar13,auStack_128,0x80);
          FUN_0005166c("./../lib/isc/unix/ifiter_ioctl.c",0x1fb,"%s: getting interface flags: %s",&local_14c,auStack_128
                      );
          return 0x24;
        }
        if ((local_13c & 1) != 0) {
          param_1[0x3c] = param_1[0x3c] | 1;
        }
        if ((local_13c & 0x10) != 0) {
          param_1[0x3c] = param_1[0x3c] | 2;
        }
        if ((local_13c & 8) != 0) {
          param_1[0x3c] = param_1[0x3c] | 4;
        }
        if ((local_13c & 2) != 0) {
          param_1[0x3c] = param_1[0x3c] | 8;
        }
        if ((local_13c & 0x1000) != 0) {
          param_1[0x3c] = param_1[0x3c] | 0x10;
        }
        if (uVar10 != 2) {
          FUN_00056698(param_1 + 0x24,auStack_128,0x100);
          uVar7 = DAT_000c9c5c;
          uVar6 = FUN_00055ca4(DAT_000c9c48,7,0x1f6,"prefix length for %s is unknown (assume 128)");
          FUN_000548c4(uVar7,&DAT_0007ca10,&DAT_0007ca30,0xffffffff,uVar6,auStack_128);
          iVar11 = 0x80;
          iVar12 = 0;
          param_1[0x2a] = uVar10;
          do {
            iVar12 = iVar12 + 1;
            uVar2 = 0xff;
            if (iVar11 < 9) {
              uVar2 = (undefined1)(-1 << (8U - iVar11 & 0xff));
              iVar11 = 0;
            }
            else {
              iVar11 = iVar11 + -8;
            }
            *(undefined1 *)(param_1 + 0x2b) = uVar2;
            param_1 = (int *)((int)param_1 + 1);
          } while (iVar12 != 0x10);
          return 0;
        }
        uVar10 = param_1[0x3c];
        if ((uVar10 & 2) != 0) {
          iVar12 = ioctl(param_1[3],0x8917,&local_14c);
          if (iVar12 < 0) {
            piVar13 = __errno_location();
            FUN_00057070(*piVar13,auStack_128,0x80);
            uVar7 = FUN_00055ca4(DAT_000c9c48,7,0x1f8,"%s: getting destination address: %s");
            FUN_0005166c("./../lib/isc/unix/ifiter_ioctl.c",0x252,uVar7,&local_14c,auStack_128);
            return 0x24;
          }
          FUN_000517c8(2,param_1 + 0x36,&local_13c,&local_14c);
          uVar10 = param_1[0x3c];
        }
        if ((uVar10 & 8) != 0) {
          iVar12 = ioctl(param_1[3],0x8919,&local_14c);
          if (iVar12 < 0) {
            piVar13 = __errno_location();
            FUN_00057070(*piVar13,auStack_128,0x80);
            uVar7 = FUN_00055ca4(DAT_000c9c48,7,0x1fa,"%s: getting broadcast address: %s");
            FUN_0005166c("./../lib/isc/unix/ifiter_ioctl.c",0x269,uVar7,&local_14c,auStack_128);
            return 0x24;
          }
          FUN_000517c8(2,param_1 + 0x30,&local_13c,&local_14c);
        }
        local_14c = *piVar13;
        local_148 = piVar13[1];
        local_144 = piVar13[2];
        local_140 = piVar13[3];
        local_13c = piVar13[4];
        local_138 = piVar13[5];
        local_134 = piVar13[6];
        local_130 = piVar13[7];
        iVar12 = ioctl(param_1[3],0x891b,&local_14c);
        if (-1 < iVar12) {
          FUN_000517c8(2,param_1 + 0x2a,&local_13c,&local_14c);
          return 0;
        }
        piVar13 = __errno_location();
        FUN_00057070(*piVar13,auStack_128,0x80);
        uVar7 = FUN_00055ca4(DAT_000c9c48,7,0x1f9,"%s: getting netmask: %s");
        FUN_0005166c("./../lib/isc/unix/ifiter_ioctl.c",0x282,uVar7,&local_14c,auStack_128);
        return 0x24;
      }
    }
LAB_000519b4:
    iVar12 = 0x24;
  }
  return iVar12;
}




undefined4 FUN_000520bc(int param_1,int *param_2)

{
  undefined4 *__ptr;
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  FILE *pFVar4;
  uint uVar5;
  undefined4 uVar6;
  undefined1 auStack_98 [128];
  
  if (param_1 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/ifiter_ioctl.c",0x128,0,"mctx != ((void *)0)");
  }
  if (param_2 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/ifiter_ioctl.c",0x129,0,"iterp != ((void *)0)");
  }
  if (*param_2 != 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/ifiter_ioctl.c",0x12a,0,"*iterp == ((void *)0)");
  }
  __ptr = (undefined4 *)FUN_0004f524(0xfc);
  if (__ptr == (undefined4 *)0x0) {
    uVar6 = 1;
  }
  else {
    __ptr[1] = param_1;
    __ptr[6] = 0;
    __ptr[2] = 4;
    __ptr[8] = 0xffffffff;
    iVar1 = socket(2,2,0);
    __ptr[3] = iVar1;
    if (iVar1 < 0) {
      piVar2 = __errno_location();
      uVar6 = 0x22;
      FUN_00057070(*piVar2,auStack_98,0x80);
      uVar3 = FUN_00055ca4(DAT_000c9c48,7,0x1f5,"making interface scan socket: %s");
      FUN_0005166c("./../lib/isc/unix/ifiter_ioctl.c",0x15c,uVar3,auStack_98);
    }
    else {
      iVar1 = 0x1000;
      __ptr[7] = 0x1000;
      while( true ) {
        iVar1 = FUN_0004f524(iVar1);
        __ptr[6] = iVar1;
        if (iVar1 == 0) break;
        *(undefined1 *)(__ptr + 4) = 0;
        __ptr[5] = iVar1;
        __ptr[4] = __ptr[7];
        iVar1 = ioctl(__ptr[3],0x8912,__ptr + 4);
        if (iVar1 == -1) {
          piVar2 = __errno_location();
          if (*piVar2 == 0x16) {
            uVar5 = __ptr[7];
            goto joined_r0x000521e8;
          }
          FUN_00057070(*piVar2,auStack_98,0x80);
          uVar6 = FUN_00055ca4(DAT_000c9c48,7,0x1f6,"get interface configuration: %s");
          FUN_0005166c("./../lib/isc/unix/ifiter_ioctl.c",0x87,uVar6,auStack_98);
LAB_00052214:
          uVar6 = 0x22;
          free((void *)__ptr[6]);
          __ptr[6] = 0;
          goto LAB_00052288;
        }
        uVar5 = __ptr[7];
        if (__ptr[4] + 0x40 < uVar5) {
          pFVar4 = fopen("/proc/net/if_inet6","r");
          __ptr[0x1a] = 0x19;
          __ptr[0x3e] = 0x19;
          *__ptr = 0x49464954;
          __ptr[9] = pFVar4;
          *param_2 = (int)__ptr;
          return 0;
        }
joined_r0x000521e8:
        if (0xfffff < uVar5) {
          uVar6 = FUN_00055ca4(DAT_000c9c48,7,0x1f7,"get interface configuration: maximum buffer size exceeded");
          FUN_0005166c("./../lib/isc/unix/ifiter_ioctl.c",0xa2,uVar6);
          goto LAB_00052214;
        }
        free((void *)__ptr[6]);
        iVar1 = __ptr[7] << 1;
        __ptr[7] = iVar1;
      }
      uVar6 = 1;
LAB_00052288:
      close(__ptr[3]);
    }
    free(__ptr);
  }
  return uVar6;
}




undefined4 FUN_00052370(int param_1,void *param_2,undefined4 param_3,undefined4 param_4)

{
  if (*(int *)(param_1 + 0xf8) != 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/interfaceiter.c",0x12a,0,"iter->result == 0",param_4);
  }
  memcpy(param_2,(void *)(param_1 + 0x6c),0x8c);
  return 0;
}




int FUN_000523c8(int *param_1)

{
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x49464954)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/interfaceiter.c",0x133,0,
                    "(((iter) != ((void *)0)) && (((const isc__magic_t *)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | (\'I\') << 8 | (\'T\')))))"
                   );
  }
  param_1[8] = 0;
  if ((FILE *)param_1[9] == (FILE *)0x0) {
    param_1[0x1a] = 0x1d;
  }
  else {
    rewind((FILE *)param_1[9]);
    FUN_00051728(param_1);
  }
  do {
    iVar1 = FUN_000518e0(param_1);
    if (iVar1 != 0x24) break;
    iVar1 = FUN_00051768(param_1);
  } while (iVar1 == 0);
  param_1[0x3e] = iVar1;
  return iVar1;
}




int FUN_00052468(int *param_1)

{
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x49464954)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/interfaceiter.c",0x146,0,
                    "(((iter) != ((void *)0)) && (((const isc__magic_t *)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | (\'I\') << 8 | (\'T\')))))"
                   );
  }
  if (param_1[0x3e] != 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/interfaceiter.c",0x147,0,"iter->result == 0");
  }
  do {
    iVar1 = FUN_00051768(param_1);
    if (iVar1 != 0) break;
    iVar1 = FUN_000518e0(param_1);
  } while (iVar1 == 0x24);
  param_1[0x3e] = iVar1;
  return iVar1;
}




void FUN_00052510(undefined4 *param_1)

{
  int *__ptr;
  
  if (param_1 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/interfaceiter.c",0x159,0,"iterp != ((void *)0)");
  }
  __ptr = (int *)*param_1;
  if ((__ptr == (int *)0x0) || (*__ptr != 0x49464954)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/interfaceiter.c",0x15b,0,
                    "(((iter) != ((void *)0)) && (((const isc__magic_t *)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | (\'I\') << 8 | (\'T\')))))"
                   );
  }
  close(__ptr[3]);
  if ((FILE *)__ptr[9] != (FILE *)0x0) {
    fclose((FILE *)__ptr[9]);
  }
  if ((void *)__ptr[6] != (void *)0x0) {
    free((void *)__ptr[6]);
  }
  *__ptr = 0;
  free(__ptr);
  *param_1 = 0;
  return;
}




void FUN_000525c8(void)

{
  if (DAT_000c9c44 != 0) {
    return;
  }
  FUN_00055b84("libisc.cat",&DAT_000c9c48);
  DAT_000c9c44 = 1;
  return;
}




int FUN_000525fc(int param_1)

{
  char *pcVar1;
  size_t __n;
  int iVar2;
  int iVar3;
  long lVar4;
  uint uVar5;
  undefined4 uVar6;
  int iVar7;
  char *pcVar8;
  char *__s;
  char *pcStack_2034;
  char acStack_2030 [4100];
  char acStack_102c [1028];
  char acStack_c28 [256];
  uint local_b28;
  
  if (*(int *)(param_1 + 0x18) != -2) {
    pcVar8 = *(char **)(param_1 + 0x14);
    __s = pcVar8;
    if (*(int *)(param_1 + 4) != 3) {
      (*DAT_0007c9fc)("./../lib/isc/log.c",0x484,0,"channel->type == 3");
      __s = *(char **)(param_1 + 0x14);
    }
    pcVar1 = strrchr(__s,0x2f);
    if (pcVar1 == (char *)0x0) {
      pcVar1 = ".";
    }
    else {
      __s = pcVar1 + 1;
      *pcVar1 = '\0';
      pcVar1 = *(char **)(param_1 + 0x14);
    }
    __n = strlen(__s);
    FUN_000593b4(acStack_102c);
    iVar2 = FUN_0005940c(acStack_102c,pcVar1);
    if (__s != *(char **)(param_1 + 0x14)) {
      __s[-1] = '/';
    }
    if (iVar2 != 0) {
      return iVar2;
    }
    iVar2 = -1;
    while( true ) {
      iVar3 = FUN_00059518(acStack_102c);
      if (iVar3 != 0) break;
      if ((((__n < local_b28) && (iVar3 = strncmp(acStack_c28,__s,__n), iVar3 == 0)) && (acStack_c28[__n] == '.')) &&
         ((lVar4 = strtol(acStack_c28 + __n + 1,&pcStack_2034,10), *pcStack_2034 == '\0' && (iVar2 < lVar4)))) {
        iVar2 = lVar4;
      }
    }
    iVar2 = iVar2 + 1;
    FUN_000595c8(acStack_102c);
    iVar3 = *(int *)(param_1 + 0x18);
    if ((iVar3 != -1) && (iVar3 <= iVar2)) {
      while (iVar2 = iVar2 + -1, iVar3 <= iVar2) {
        uVar5 = snprintf(acStack_2030,0x1001,"%s.%d",pcVar8,iVar2);
        iVar3 = 0x13;
        if ((0x1000 < uVar5) || (iVar3 = FUN_0005a284(acStack_2030), iVar3 != 0x26 && iVar3 != 0)) {
          uVar6 = FUN_00056dc4(iVar3);
          syslog(3,"unable to remove log file \'%s.%d\': %s",pcVar8,iVar2,uVar6);
        }
        iVar3 = *(int *)(param_1 + 0x18);
      }
    }
    if (0 < iVar2) {
      do {
        iVar3 = iVar2 + -1;
        uVar5 = snprintf(acStack_2030,0x1001,"%s.%d",pcVar8,iVar3);
        if (uVar5 < 0x1001) {
          uVar5 = snprintf(acStack_102c,0x1001,"%s.%d",pcVar8,iVar2);
          if (0x1000 < uVar5) goto LAB_0005288c;
          iVar7 = FUN_0005a2dc(acStack_2030,acStack_102c);
          if (iVar7 != 0x26 && iVar7 != 0) goto LAB_00052890;
        }
        else {
LAB_0005288c:
          iVar7 = 0x13;
LAB_00052890:
          uVar6 = FUN_00056dc4(iVar7);
          syslog(3,"unable to rename log file \'%s.%d\' to \'%s.%d\': %s",pcVar8,iVar3,pcVar8,iVar2,uVar6);
        }
        iVar2 = iVar3;
      } while (iVar3 != 0);
      iVar3 = *(int *)(param_1 + 0x18);
    }
    if (iVar3 != 0) {
      uVar5 = snprintf(acStack_102c,0x1001,"%s.0",pcVar8);
      if (uVar5 < 0x1001) {
        iVar2 = FUN_0005a2dc(pcVar8,acStack_102c);
        if (iVar2 == 0x26 || iVar2 == 0) {
          return 0;
        }
      }
      else {
        iVar2 = 0x13;
      }
      uVar6 = FUN_00056dc4(iVar2);
      syslog(3,"unable to rename log file \'%s\' to \'%s.0\': %s",pcVar8,pcVar8,uVar6);
      return 0;
    }
    iVar2 = FUN_0005a284(pcVar8);
    if (iVar2 != 0x26 && iVar2 != 0) {
      uVar6 = FUN_00056dc4();
      syslog(3,"unable to remove log file \'%s\': %s",pcVar8,uVar6);
      return 0;
    }
  }
  return 0;
}




void FUN_00052988(int *param_1,undefined4 *param_2,undefined4 *param_3,int param_4,int param_5,int param_6,
                 undefined4 param_7,undefined4 param_8,char *param_9,__gnuc_va_list param_10)

{
  char *pcVar1;
  uint uVar2;
  FILE *__stream;
  undefined4 uVar3;
  size_t sVar4;
  undefined4 *puVar5;
  int *piVar6;
  uint uVar7;
  char *pcVar8;
  char *pcVar9;
  int iVar10;
  char *pcVar11;
  char *pcVar12;
  int iVar13;
  uint uVar14;
  int iVar15;
  int iVar16;
  char *pcVar17;
  char *pcVar18;
  undefined4 uVar19;
  uint uVar20;
  undefined4 *puVar21;
  undefined4 *puVar22;
  char *pcVar23;
  undefined *puVar24;
  char *pcVar25;
  char *local_14c;
  undefined1 auStack_140 [8];
  undefined1 auStack_138 [8];
  char local_130 [24];
  char local_118 [64];
  stat sStack_d8;
  stat sStack_80;
  
  if ((param_1 != (int *)0x0) && (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x58d,0,
                    "lctx == ((void *)0) || (((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                   );
  }
  if (param_2 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x58e,0,"category != ((void *)0)");
  }
  if (param_3 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x58f,0,"module != ((void *)0)");
  }
  if (param_4 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x590,0,"level != 0");
  }
  if (param_9 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x591,0,"format != ((void *)0)");
  }
  if (param_1 != (int *)0x0) {
    if ((uint)param_1[3] <= (uint)param_2[1]) {
      (*DAT_0007c9fc)("./../lib/isc/log.c",0x59b,0,"category->id < lctx->category_count");
    }
    if ((uint)param_1[5] <= (uint)param_3[1]) {
      (*DAT_0007c9fc)("./../lib/isc/log.c",0x59c,0,"module->id < lctx->module_count");
    }
    iVar13 = param_1[8];
    if ((iVar13 != 0) &&
       ((param_4 <= *(int *)(iVar13 + 0x1c) || ((*(int *)(iVar13 + 0x24) != 0 && (param_4 <= param_1[6])))))) {
      if (param_6 != 0) {
        param_9 = (char *)FUN_00055ca4(param_6,param_7,param_8,param_9);
      }
      iVar13 = param_1[7];
      local_118[0] = '\0';
      local_130[0] = '\0';
      param_1[7] = iVar13 + 1;
      if (iVar13 != 0) {
        FUN_000516d8("./../lib/isc/log.c",0x5a9,"((*((&lctx->lock)))++ == 0 ? 0 : 34) == 0");
      }
      iVar13 = param_1[8];
      uVar7 = 0;
      *(undefined1 *)(param_1 + 9) = 0;
      puVar21 = *(undefined4 **)(*(int *)(iVar13 + 0x10) + param_2[1] * 8);
      uVar14 = (uint)(puVar21 == (undefined4 *)0x0);
      do {
        while( true ) {
          if ((uVar14 & (uVar7 ^ 1)) != 0) {
            puVar21 = (undefined4 *)**(undefined4 **)(iVar13 + 0x10);
            if ((undefined4 *)**(undefined4 **)(iVar13 + 0x10) == (undefined4 *)0x0) {
              puVar21 = &DAT_000c9c4c;
            }
          }
          if (((undefined4 *)*puVar21 != (undefined4 *)0x0) && (param_3 != (undefined4 *)*puVar21)) break;
          iVar16 = puVar21[1];
          puVar21 = (undefined4 *)puVar21[3];
          uVar14 = *(uint *)(iVar16 + 0xc);
          if (((uVar14 & 0x1000) == 0) || (param_1[6] != 0)) {
            iVar10 = *(int *)(iVar16 + 8);
            if (iVar10 == 0) {
              iVar10 = param_1[6];
            }
            if (param_4 <= iVar10) {
              if (((uVar14 & 1) != 0) && (local_118[0] == '\0')) {
                iVar10 = FUN_000573bc(auStack_140);
                if (iVar10 != 0) {
                  FUN_000516d8("./../lib/isc/log.c",0x5e8,"isc_time_now((&isctime)) == 0");
                }
                FUN_00057c30(auStack_140,local_118,0x40);
                uVar14 = *(uint *)(iVar16 + 0xc);
              }
              if (((uVar14 & 2) != 0) && (local_130[0] == '\0')) {
                if (param_4 + 5 < 0 == SCARRY4(param_4,5)) {
                  if (param_4 < 1) {
                    snprintf(local_130,0x18,"%s: ",(&PTR_s_debug_0006e608)[-param_4]);
                  }
                  else {
                    snprintf(local_130,0x18,"%s %d: ","debug",param_4);
                  }
                }
                else {
                  pcVar11 = (char *)FUN_00055ca4(DAT_000c9c48,10,0x322,"level %d: ");
                  snprintf(local_130,0x18,pcVar11,param_4);
                }
              }
              if ((char)param_1[9] == '\0') {
                piVar6 = param_1 + 9;
                vsnprintf((char *)piVar6,0x2000,param_9,param_10);
                if (param_5 != 0) {
                  FUN_00057154(auStack_138,*(undefined4 *)(iVar13 + 0x18),0);
                  iVar10 = FUN_000573bc(auStack_140);
                  if (iVar10 != 0) {
                    FUN_000516d8("./../lib/isc/log.c",0x616,"isc_time_now((&oldest)) == 0");
                  }
                  iVar10 = FUN_000578bc(auStack_140,auStack_138,auStack_140);
                  if (iVar10 == 0) {
                    puVar5 = (undefined4 *)param_1[0x809];
                    while (puVar5 != (undefined4 *)0x0) {
                      iVar10 = FUN_000576c8(puVar5 + 1,auStack_140);
                      if (iVar10 < 0) {
                        puVar22 = (undefined4 *)puVar5[4];
                        if (puVar22 == (undefined4 *)0x0) {
                          if ((undefined4 *)param_1[0x80a] != puVar5) {
                            (*DAT_0007c9fc)("./../lib/isc/log.c",0x634,2,"(lctx->messages).tail == (message)");
                          }
                          iVar10 = puVar5[3];
                          param_1[0x80a] = iVar10;
                        }
                        else {
                          puVar22[3] = puVar5[3];
                          iVar10 = puVar5[3];
                        }
                        if (iVar10 == 0) {
                          if ((undefined4 *)param_1[0x809] != puVar5) {
                            (*DAT_0007c9fc)("./../lib/isc/log.c",0x634,2,"(lctx->messages).head == (message)");
                          }
                          param_1[0x809] = puVar5[4];
                        }
                        else {
                          *(undefined4 *)(iVar10 + 0x10) = puVar5[4];
                        }
                        puVar5[3] = 0xffffffff;
                        puVar5[4] = 0xffffffff;
                        free(puVar5);
                        puVar5 = puVar22;
                      }
                      else {
                        iVar10 = strcmp((char *)piVar6,(char *)*puVar5);
                        if (iVar10 == 0) {
                          iVar13 = param_1[7];
                          param_1[7] = iVar13 + -1;
                          if (iVar13 + -1 == 0) {
                            return;
                          }
                          FUN_000516d8("./../lib/isc/log.c",0x64a,"(--(*((&lctx->lock))) == 0 ? 0 : 34) == 0");
                          return;
                        }
                        puVar5 = (undefined4 *)puVar5[4];
                      }
                    }
                  }
                  sVar4 = strlen((char *)piVar6);
                  puVar5 = (undefined4 *)FUN_0004f524(sVar4 + 0x15);
                  if (puVar5 != (undefined4 *)0x0) {
                    *puVar5 = puVar5 + 5;
                    strcpy((char *)(puVar5 + 5),(char *)piVar6);
                    iVar10 = FUN_000573bc(puVar5 + 1);
                    if (iVar10 != 0) {
                      FUN_000516d8("./../lib/isc/log.c",0x660,"isc_time_now((&new->time)) == 0");
                    }
                    iVar10 = param_1[0x80a];
                    if (iVar10 == 0) {
                      param_1[0x809] = (int)puVar5;
                    }
                    else {
                      *(undefined4 **)(iVar10 + 0x10) = puVar5;
                    }
                    puVar5[3] = iVar10;
                    puVar5[4] = 0;
                    param_1[0x80a] = (int)puVar5;
                  }
                }
              }
              uVar14 = *(uint *)(iVar16 + 0xc);
              uVar20 = uVar14 & 0x10;
              uVar7 = uVar14 & 1;
              if ((uVar20 != 0) && (uVar20 = *(uint *)(iVar13 + 0x20), uVar20 != 0)) {
                uVar20 = 1;
              }
              iVar10 = *(int *)(iVar16 + 4);
              if (iVar10 == 3) {
                if (*(int *)(iVar16 + 0x20) == 0) {
                  __stream = *(FILE **)(iVar16 + 0x10);
                  if (__stream != (FILE *)0x0) goto LAB_00052e70;
                }
                else {
                  if ((*(int *)(iVar16 + 0x18) == -2) &&
                     (((iVar10 = __xstat(3,*(char **)(iVar16 + 0x14),&sStack_d8), iVar10 == 0 ||
                       (piVar6 = __errno_location(), *piVar6 != 2)) && (*(int *)(iVar16 + 0x1c) <= sStack_d8.st_size))))
                  goto LAB_00052c04;
                  fclose(*(FILE **)(iVar16 + 0x10));
                  *(undefined4 *)(iVar16 + 0x10) = 0;
                  *(undefined4 *)(iVar16 + 0x20) = 0;
                  if ((*(int *)(iVar16 + 4) != 3) &&
                     ((*DAT_0007c9fc)("./../lib/isc/log.c",0x52d,0,"channel->type == 3"), *(int *)(iVar16 + 0x10) != 0))
                  {
                    (*DAT_0007c9fc)("./../lib/isc/log.c",0x52e,0,"(channel->destination.file.stream) == ((void *)0)");
                  }
                }
                pcVar11 = *(char **)(iVar16 + 0x14);
                if ((pcVar11 == (char *)0x0) || (*pcVar11 == '\0')) {
                  (*DAT_0007c9fc)("./../lib/isc/log.c",0x532,0,"path != ((void *)0) && *path != \'\\0\'");
                }
                iVar10 = __xstat(3,pcVar11,&sStack_80);
                if (iVar10 == 0) {
                  iVar10 = *(int *)(iVar16 + 0x1c);
                  if (iVar10 != 0) {
                    if ((0 < iVar10) && (iVar10 <= sStack_80.st_size)) goto LAB_00053080;
                    goto LAB_000533e8;
                  }
                  if (*(int *)(iVar16 + 0x18) == -2) goto LAB_000533e8;
LAB_00053080:
                  if ((sStack_80.st_mode & 0xf000) != 0x8000) goto LAB_000533e8;
                  if (*(int *)(iVar16 + 0x18) == -2) goto LAB_00052c04;
                  iVar10 = FUN_000525fc(iVar16);
                  if (iVar10 == 0) goto LAB_000533e8;
                  uVar14 = *(uint *)(iVar16 + 0xc);
                  if ((uVar14 & 0x8000) == 0) {
                    uVar19 = *(undefined4 *)(iVar16 + 0x14);
                    uVar3 = FUN_00056dc4();
                    syslog(3,"isc_log_open: roll_log \'%s\' failed: %s",uVar19,uVar3);
                    uVar14 = *(uint *)(iVar16 + 0xc) | 0x8000;
                    *(uint *)(iVar16 + 0xc) = uVar14;
                  }
                  if (iVar10 == 0x3a) goto LAB_00052c04;
                }
                else {
LAB_000533e8:
                  iVar10 = FUN_00056eec(pcVar11,&DAT_000687dc,iVar16 + 0x10);
                  iVar15 = iVar10;
                  if (iVar10 != 0) {
                    iVar15 = 1;
                  }
                  if (iVar10 == 0x3a || iVar10 == 0) {
                    if (iVar15 != 0) goto LAB_00052c04;
                    __stream = *(FILE **)(iVar16 + 0x10);
                    *(uint *)(iVar16 + 0xc) = *(uint *)(iVar16 + 0xc) & 0xffff7fff;
                    goto LAB_00052e70;
                  }
                  uVar14 = *(uint *)(iVar16 + 0xc);
                }
                if ((uVar14 & 0x8000) == 0) {
                  uVar19 = *(undefined4 *)(iVar16 + 0x14);
                  uVar3 = FUN_00056dc4(iVar10);
                  syslog(3,"isc_log_open \'%s\' failed: %s",uVar19,uVar3);
                  *(uint *)(iVar16 + 0xc) = *(uint *)(iVar16 + 0xc) | 0x8000;
                }
              }
              else {
                if (iVar10 != 4) {
                  if (iVar10 == 2) {
                    if (param_4 < 1) {
                      uVar2 = 2;
                      if (param_4 + 5 < 0 == SCARRY4(param_4,5)) {
                        uVar2 = *(uint *)(&DAT_0006e620 + param_4 * -4);
                      }
                    }
                    else {
                      uVar2 = 7;
                    }
                    if (uVar7 != 0) {
                      pcVar11 = local_118;
                    }
                    else {
                      pcVar11 = "";
                    }
                    pcVar12 = pcVar11;
                    if (uVar7 != 0) {
                      pcVar12 = " ";
                    }
                    if (uVar20 == 0) {
                      pcVar23 = "";
                      pcVar1 = pcVar23;
                    }
                    else {
                      pcVar23 = ": ";
                      pcVar1 = *(char **)(iVar13 + 0x20);
                    }
                    if ((int)(uVar14 << 0x1d) < 0) {
                      pcVar9 = (char *)*param_2;
                      pcVar8 = ": ";
                    }
                    else {
                      pcVar8 = "";
                      pcVar9 = pcVar8;
                    }
                    if ((int)(uVar14 << 0x1c) < 0) {
                      pcVar25 = ": ";
                      pcVar18 = (char *)*param_3;
                    }
                    else {
                      pcVar25 = "";
                      pcVar18 = pcVar25;
                    }
                    if ((int)(uVar14 << 0x1e) < 0) {
                      pcVar17 = local_130;
                    }
                    else {
                      pcVar17 = "";
                    }
                    syslog(uVar2 | *(uint *)(iVar16 + 0x10),"%s%s%s%s%s%s%s%s%s%s",pcVar11,pcVar12,pcVar1,pcVar23,pcVar9
                           ,pcVar8,pcVar18,pcVar25,pcVar17,param_1 + 9);
                    uVar7 = 1;
                    goto LAB_00052ad4;
                  }
                  goto LAB_00052c04;
                }
                __stream = *(FILE **)(iVar16 + 0x10);
LAB_00052e70:
                if (uVar7 == 0) {
                  pcVar12 = "";
                  pcVar11 = pcVar12;
                }
                else {
                  pcVar12 = " ";
                  pcVar11 = local_118;
                }
                if (uVar20 == 0) {
                  puVar24 = &DAT_000665cc;
                  local_14c = "";
                }
                else {
                  puVar24 = *(undefined **)(iVar13 + 0x20);
                  local_14c = ": ";
                }
                if ((int)(uVar14 << 0x1d) < 0) {
                  pcVar23 = ": ";
                  pcVar1 = (char *)*param_2;
                }
                else {
                  pcVar23 = "";
                  pcVar1 = pcVar23;
                }
                if ((int)(uVar14 << 0x1c) < 0) {
                  pcVar8 = ": ";
                  pcVar9 = (char *)*param_3;
                }
                else {
                  pcVar8 = "";
                  pcVar9 = pcVar8;
                }
                if ((int)(uVar14 << 0x1e) < 0) {
                  pcVar18 = local_130;
                }
                else {
                  pcVar18 = "";
                }
                fprintf(__stream,"%s%s%s%s%s%s%s%s%s%s\n",pcVar11,pcVar12,puVar24,local_14c,pcVar1,pcVar23,pcVar9,pcVar8
                        ,pcVar18,param_1 + 9);
                fflush(*(FILE **)(iVar16 + 0x10));
                if (0 < *(int *)(iVar16 + 0x1c)) {
                  if (*(int *)(iVar16 + 4) != 3) {
                    (*DAT_0007c9fc)("./../lib/isc/log.c",0x6b6,2,"channel->type == 3");
                  }
                  iVar10 = fileno(*(FILE **)(iVar16 + 0x10));
                  iVar10 = __fxstat(3,iVar10,&sStack_d8);
                  if ((-1 < iVar10) && (*(int *)(iVar16 + 0x1c) < sStack_d8.st_size)) {
                    uVar7 = 1;
                    *(undefined4 *)(iVar16 + 0x20) = 1;
                    goto LAB_00052ad4;
                  }
                }
              }
            }
          }
LAB_00052c04:
          uVar7 = 1;
          uVar14 = 1 - (int)puVar21;
          if ((undefined4 *)0x1 < puVar21) {
            uVar14 = 0;
          }
          if ((uVar14 & 1) != 0) goto LAB_00052c14;
        }
        puVar21 = (undefined4 *)puVar21[3];
LAB_00052ad4:
        uVar14 = 1 - (int)puVar21;
        if ((undefined4 *)0x1 < puVar21) {
          uVar14 = 0;
        }
      } while ((uVar14 & uVar7) == 0);
LAB_00052c14:
      iVar13 = param_1[7];
      param_1[7] = iVar13 + -1;
      if (iVar13 + -1 != 0) {
        FUN_000516d8("./../lib/isc/log.c",0x6e1,"(--(*((&lctx->lock))) == 0 ? 0 : 34) == 0");
      }
    }
  }
  return;
}




undefined4 FUN_000534b4(int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  void *__s;
  int iVar1;
  int iVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c636667)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x457,0,
                    "(((lcfg) != ((void *)0)) && (((const isc__magic_t *)(lcfg))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'f\') << 8 | (\'g\')))))"
                    ,param_4);
  }
  iVar2 = param_1[1];
  iVar1 = *(int *)(iVar2 + 0xc);
  if (iVar1 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x45b,0,"lctx->category_count != 0");
    iVar1 = *(int *)(iVar2 + 0xc);
  }
  if (param_1[5] != iVar1) {
    __s = (void *)FUN_0004f524(iVar1 << 3);
    if (__s != (void *)0x0) {
      memset(__s,0,iVar1 << 3);
      if (param_1[5] != 0) {
        memcpy(__s,(void *)param_1[4],param_1[5] << 3);
        free((void *)param_1[4]);
      }
      iVar1 = *(int *)(iVar2 + 0xc);
      param_1[4] = (int)__s;
      param_1[5] = iVar1;
      return 0;
    }
    return 1;
  }
  return 0;
}




int FUN_000535a8(int *param_1,uint param_2,int param_3,int param_4)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c636667)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x426,0,
                    "(((lcfg) != ((void *)0)) && (((const isc__magic_t *)(lcfg))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'f\') << 8 | (\'g\')))))"
                   );
  }
  iVar4 = param_1[1];
  if (*(uint *)(iVar4 + 0xc) <= param_2) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x42a,0,"category_id < lctx->category_count");
  }
  if ((param_3 != 0) && (*(uint *)(iVar4 + 0x14) <= *(uint *)(param_3 + 4))) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x42b,0,"module == ((void *)0) || module->id < lctx->module_count");
  }
  if (param_4 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x42c,0,"channel != ((void *)0)");
  }
  iVar4 = FUN_000534b4(param_1);
  if (iVar4 == 0) {
    piVar1 = (int *)FUN_0004f524(0x10);
    if (piVar1 == (int *)0x0) {
      iVar4 = 1;
    }
    else {
      iVar3 = param_1[4];
      iVar5 = *(int *)(param_4 + 4);
      *piVar1 = param_3;
      piVar1[1] = param_4;
      iVar2 = *(int *)(iVar3 + param_2 * 8);
      if (iVar2 == 0) {
        *(int **)(iVar3 + param_2 * 8 + 4) = piVar1;
      }
      else {
        *(int **)(iVar2 + 8) = piVar1;
      }
      piVar1[3] = iVar2;
      piVar1[2] = 0;
      *(int **)(iVar3 + param_2 * 8) = piVar1;
      if (iVar5 != 1) {
        iVar4 = *(int *)(param_4 + 8);
        if (param_1[7] < iVar4) {
          param_1[7] = iVar4;
        }
        if (iVar4 == 0) {
          param_1[9] = 1;
        }
        return 0;
      }
    }
  }
  return iVar4;
}




int FUN_00053724(int *param_1)

{
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x1a7,0,
                    "(((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                   );
  }
  if (param_1[8] != 0) {
    return param_1[8];
  }
  (*DAT_0007c9fc)("./../lib/isc/log.c",0x1a9,1,"lctx->logconfig != ((void *)0)");
  return param_1[8];
}




void FUN_000537a0(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  void *__ptr;
  uint uVar1;
  int iVar2;
  int iVar3;
  undefined4 *__ptr_00;
  void *__ptr_01;
  int *__ptr_02;
  uint uVar4;
  
  if (((param_1 == (undefined4 *)0x0) || (__ptr_02 = (int *)*param_1, __ptr_02 == (int *)0x0)) ||
     (*__ptr_02 != 0x4c636667)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x1fe,0,
                    "lcfgp != ((void *)0) && (((*lcfgp) != ((void *)0)) && (((const isc__magic_t *)(*lcfgp))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'f\') << 8 | (\'g\')))))"
                    ,param_4);
    __ptr_02 = (int *)*param_1;
  }
  if ((__ptr_02[1] == 0) || (*(int **)(__ptr_02[1] + 0x20) == __ptr_02)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x206,0,"lcfg->lctx != ((void *)0) && lcfg->lctx->logconfig != lcfg");
  }
  __ptr_00 = (undefined4 *)__ptr_02[2];
  do {
    if (__ptr_00 == (undefined4 *)0x0) {
      uVar1 = __ptr_02[5];
      if (uVar1 != 0) {
        __ptr = (void *)__ptr_02[4];
        uVar4 = 0;
        do {
          __ptr_01 = *(void **)((int)__ptr + uVar4 * 8);
          iVar3 = uVar4 * 8;
          if (__ptr_01 != (void *)0x0) {
            do {
              if (*(int *)((int)__ptr_01 + 0xc) == 0) {
                if (*(void **)((int)__ptr + iVar3 + 4) != __ptr_01) {
                  (*DAT_0007c9fc)("./../lib/isc/log.c",0x221,2,"(lcfg->channellists[i]).tail == (item)");
                  __ptr = (void *)__ptr_02[4];
                }
                iVar2 = *(int *)((int)__ptr_01 + 8);
                *(int *)((int)__ptr + iVar3 + 4) = iVar2;
                if (iVar2 != 0) goto LAB_00053938;
LAB_000539b0:
                if (*(void **)((int)__ptr + iVar3) != __ptr_01) {
                  (*DAT_0007c9fc)("./../lib/isc/log.c",0x221,2,"(lcfg->channellists[i]).head == (item)");
                  __ptr = (void *)__ptr_02[4];
                }
                *(undefined4 *)((int)__ptr + iVar3) = *(undefined4 *)((int)__ptr_01 + 0xc);
              }
              else {
                *(undefined4 *)(*(int *)((int)__ptr_01 + 0xc) + 8) = *(undefined4 *)((int)__ptr_01 + 8);
                iVar2 = *(int *)((int)__ptr_01 + 8);
                if (iVar2 == 0) goto LAB_000539b0;
LAB_00053938:
                *(undefined4 *)(iVar2 + 0xc) = *(undefined4 *)((int)__ptr_01 + 0xc);
              }
              *(undefined4 *)((int)__ptr_01 + 8) = 0xffffffff;
              *(undefined4 *)((int)__ptr_01 + 0xc) = 0xffffffff;
              free(__ptr_01);
              __ptr = (void *)__ptr_02[4];
              __ptr_01 = *(void **)((int)__ptr + iVar3);
            } while (__ptr_01 != (void *)0x0);
            uVar1 = __ptr_02[5];
          }
          uVar4 = uVar4 + 1;
        } while (uVar4 < uVar1);
        if (uVar1 != 0) {
          free(__ptr);
        }
      }
      __ptr_02[9] = 0;
      if ((void *)__ptr_02[8] != (void *)0x0) {
        free((void *)__ptr_02[8]);
      }
      __ptr_02[8] = 0;
      __ptr_02[7] = 0;
      __ptr_02[6] = 0;
      *__ptr_02 = 0;
      free(__ptr_02);
      *param_1 = 0;
      return;
    }
    if (__ptr_00[10] == 0) {
      if ((undefined4 *)__ptr_02[3] != __ptr_00) {
        (*DAT_0007c9fc)("./../lib/isc/log.c",0x20b,2,"(lcfg->channels).tail == (channel)");
      }
      iVar3 = __ptr_00[9];
      __ptr_02[3] = iVar3;
      if (iVar3 != 0) goto LAB_0005382c;
LAB_000538a8:
      if ((undefined4 *)__ptr_02[2] != __ptr_00) {
        (*DAT_0007c9fc)("./../lib/isc/log.c",0x20b,2,"(lcfg->channels).head == (channel)");
      }
      __ptr_02[2] = __ptr_00[10];
    }
    else {
      *(undefined4 *)(__ptr_00[10] + 0x24) = __ptr_00[9];
      iVar3 = __ptr_00[9];
      if (iVar3 == 0) goto LAB_000538a8;
LAB_0005382c:
      *(undefined4 *)(iVar3 + 0x28) = __ptr_00[10];
    }
    __ptr_00[9] = 0xffffffff;
    __ptr_00[10] = 0xffffffff;
    if (__ptr_00[1] == 3) {
      free((void *)__ptr_00[5]);
      if ((FILE *)__ptr_00[4] != (FILE *)0x0) {
        fclose((FILE *)__ptr_00[4]);
      }
    }
    free((void *)*__ptr_00);
    free(__ptr_00);
    __ptr_00 = (undefined4 *)__ptr_02[2];
  } while( true );
}




void FUN_00053a88(undefined4 *param_1)

{
  int iVar1;
  void *__ptr;
  int *__ptr_00;
  
  if (((param_1 == (undefined4 *)0x0) || (__ptr_00 = (int *)*param_1, __ptr_00 == (int *)0x0)) ||
     (*__ptr_00 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x1d3,0,
                    "lctxp != ((void *)0) && (((*lctxp) != ((void *)0)) && (((const isc__magic_t *)(*lctxp))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                   );
    __ptr_00 = (int *)*param_1;
  }
  if (__ptr_00[8] != 0) {
    __ptr_00[8] = 0;
    FUN_000537a0();
  }
  if (__ptr_00[7] == 0) {
    __ptr_00[7] = -1;
  }
  else {
    FUN_000516d8("./../lib/isc/log.c",0x1de,"(*((&lctx->lock)) == 0 ? (*((&lctx->lock)) = -1, 0) : 34) == 0");
  }
  __ptr = (void *)__ptr_00[0x809];
  do {
    if (__ptr == (void *)0x0) {
      *(undefined1 *)(__ptr_00 + 9) = 0;
      __ptr_00[6] = 0;
      __ptr_00[2] = 0;
      __ptr_00[3] = 0;
      __ptr_00[4] = 0;
      __ptr_00[5] = 0;
      __ptr_00[1] = 0;
      *__ptr_00 = 0;
      free(__ptr_00);
      *param_1 = 0;
      return;
    }
    if (*(int *)((int)__ptr + 0x10) == 0) {
      if ((void *)__ptr_00[0x80a] != __ptr) {
        (*DAT_0007c9fc)("./../lib/isc/log.c",0x1e1,2,"(lctx->messages).tail == (message)");
      }
      iVar1 = *(int *)((int)__ptr + 0xc);
      __ptr_00[0x80a] = iVar1;
      if (iVar1 != 0) goto LAB_00053b3c;
LAB_00053ba8:
      if ((void *)__ptr_00[0x809] != __ptr) {
        (*DAT_0007c9fc)("./../lib/isc/log.c",0x1e1,2,"(lctx->messages).head == (message)");
      }
      __ptr_00[0x809] = *(int *)((int)__ptr + 0x10);
    }
    else {
      *(undefined4 *)(*(int *)((int)__ptr + 0x10) + 0xc) = *(undefined4 *)((int)__ptr + 0xc);
      iVar1 = *(int *)((int)__ptr + 0xc);
      if (iVar1 == 0) goto LAB_00053ba8;
LAB_00053b3c:
      *(undefined4 *)(iVar1 + 0x10) = *(undefined4 *)((int)__ptr + 0x10);
    }
    *(undefined4 *)((int)__ptr + 0xc) = 0xffffffff;
    *(undefined4 *)((int)__ptr + 0x10) = 0xffffffff;
    free(__ptr);
    __ptr = (void *)__ptr_00[0x809];
  } while( true );
}




int FUN_00053c44(int *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  int iVar3;
  int local_14;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x1b3,0,
                    "(((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                   );
  }
  if ((param_2 == (int *)0x0) || (*param_2 != 0x4c636667)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x1b4,0,
                    "(((lcfg) != ((void *)0)) && (((const isc__magic_t *)(lcfg))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'f\') << 8 | (\'g\')))))"
                   );
  }
  if ((int *)param_2[1] != param_1) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x1b5,0,"lcfg->lctx == lctx");
  }
  iVar1 = FUN_000534b4(param_2);
  if (iVar1 == 0) {
    iVar2 = param_1[7];
    iVar3 = iVar2 + 1;
    param_1[7] = iVar3;
    if (iVar2 != 0) {
      FUN_000516d8("./../lib/isc/log.c",0x1c0,"((*((&lctx->lock)))++ == 0 ? 0 : 34) == 0");
      iVar3 = param_1[7];
    }
    local_14 = param_1[8];
    param_1[7] = iVar3 + -1;
    param_1[8] = (int)param_2;
    if (iVar3 + -1 != 0) {
      FUN_000516d8("./../lib/isc/log.c",0x1c5,"(--(*((&lctx->lock))) == 0 ? 0 : 34) == 0");
    }
    FUN_000537a0(&local_14);
  }
  return iVar1;
}




void FUN_00053d84(int *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x23b,0,
                    "(((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                    ,param_4);
  }
  if ((param_2 == (int *)0x0) || (*param_2 == 0)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x23c,0,"categories != ((void *)0) && categories[0].name != ((void *)0)");
    piVar4 = (int *)param_1[2];
  }
  else {
    piVar4 = (int *)param_1[2];
  }
  if (piVar4 == (int *)0x0) {
    param_1[2] = (int)param_2;
  }
  else {
    while (piVar2 = (int *)*piVar4, piVar2 != (int *)0x0) {
      piVar1 = piVar4 + 1;
      piVar4 = piVar4 + 2;
      if (*piVar1 == -1) {
        piVar4 = piVar2;
      }
    }
    *piVar4 = (int)param_2;
    piVar4[1] = -1;
  }
  if (*param_2 == 0) {
    return;
  }
  iVar5 = param_1[3];
  piVar4 = param_2 + 2;
  do {
    piVar4[-1] = iVar5;
    iVar5 = iVar5 + 1;
    iVar3 = *piVar4;
    piVar4 = piVar4 + 2;
  } while (iVar3 != 0);
  param_1[3] = iVar5;
  return;
}




char * FUN_00053e80(int *param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  char *__s1;
  char *pcVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x267,0,
                    "(((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                    ,param_4);
  }
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x268,0,"name != ((void *)0)");
  }
  __s1 = (char *)param_1[2];
  while( true ) {
    do {
      pcVar2 = __s1;
      __s1 = *(char **)pcVar2;
      if (__s1 == (char *)0x0) {
        return (char *)0x0;
      }
    } while (*(int *)(pcVar2 + 4) == -1);
    iVar1 = strcmp(__s1,param_2);
    if (iVar1 == 0) break;
    __s1 = pcVar2 + 8;
  }
  return pcVar2;
}




void FUN_00053f44(int *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  int *piVar1;
  int *piVar2;
  int iVar3;
  int *piVar4;
  int iVar5;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x27e,0,
                    "(((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                    ,param_4);
  }
  if ((param_2 == (int *)0x0) || (*param_2 == 0)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x27f,0,"modules != ((void *)0) && modules[0].name != ((void *)0)");
    piVar4 = (int *)param_1[4];
  }
  else {
    piVar4 = (int *)param_1[4];
  }
  if (piVar4 == (int *)0x0) {
    param_1[4] = (int)param_2;
  }
  else {
    while (piVar2 = (int *)*piVar4, piVar2 != (int *)0x0) {
      piVar1 = piVar4 + 1;
      piVar4 = piVar4 + 2;
      if (*piVar1 == -1) {
        piVar4 = piVar2;
      }
    }
    *piVar4 = (int)param_2;
    piVar4[1] = -1;
  }
  if (*param_2 == 0) {
    return;
  }
  iVar5 = param_1[5];
  piVar4 = param_2 + 2;
  do {
    piVar4[-1] = iVar5;
    iVar5 = iVar5 + 1;
    iVar3 = *piVar4;
    piVar4 = piVar4 + 2;
  } while (iVar3 != 0);
  param_1[5] = iVar5;
  return;
}




char * FUN_00054040(int *param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  char *__s1;
  char *pcVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x2aa,0,
                    "(((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                    ,param_4);
  }
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x2ab,0,"name != ((void *)0)");
  }
  __s1 = (char *)param_1[4];
  while( true ) {
    do {
      pcVar2 = __s1;
      __s1 = *(char **)pcVar2;
      if (__s1 == (char *)0x0) {
        return (char *)0x0;
      }
    } while (*(int *)(pcVar2 + 4) == -1);
    iVar1 = strcmp(__s1,param_2);
    if (iVar1 == 0) break;
    __s1 = pcVar2 + 8;
  }
  return pcVar2;
}




undefined4 FUN_00054104(int *param_1,char *param_2,int param_3,int param_4,undefined4 *param_5,uint param_6)

{
  undefined4 *__ptr;
  void *__ptr_00;
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  int iVar4;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c636667)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x2c6,0,
                    "(((lcfg) != ((void *)0)) && (((const isc__magic_t *)(lcfg))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'f\') << 8 | (\'g\')))))"
                    ,param_4);
  }
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x2c7,0,"name != ((void *)0)");
  }
  if (3 < param_3 - 1U) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x2c9,0,"type == 2 || type == 3 || type == 4 || type == 1");
  }
  if (param_5 == (undefined4 *)0x0 && param_3 != 1) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x2ca,0,"destination != ((void *)0) || type == 1");
    if (param_4 + 5 < 0 == SCARRY4(param_4,5)) goto joined_r0x00054198;
  }
  else if (param_4 + 5 < 0 == SCARRY4(param_4,5)) goto joined_r0x00054198;
  (*DAT_0007c9fc)("./../lib/isc/log.c",0x2cb,0,"level >= (-5)");
joined_r0x00054198:
  if ((param_6 & 0xffffefe0) == 0) {
    __ptr = (undefined4 *)FUN_0004f524(0x2c);
  }
  else {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x2cd,0,"(flags & (unsigned int)~(0x001F | 0x1000)) == 0");
    __ptr = (undefined4 *)FUN_0004f524(0x2c);
  }
  if (__ptr == (undefined4 *)0x0) {
    return 1;
  }
  __ptr_00 = (void *)FUN_0004f4e8(param_2);
  *__ptr = __ptr_00;
  if (__ptr_00 == (void *)0x0) {
    free(__ptr);
    return 1;
  }
  __ptr[1] = param_3;
  __ptr[2] = param_4;
  __ptr[3] = param_6;
  __ptr[9] = 0xffffffff;
  __ptr[10] = 0xffffffff;
  switch(param_3 - 1U) {
  case 0:
    break;
  case 1:
    __ptr[4] = *param_5;
    break;
  case 2:
    uVar1 = FUN_0004f4e8(param_5[1]);
    uVar2 = param_5[2];
    uVar3 = param_5[3];
    __ptr[4] = 0;
    __ptr[6] = uVar2;
    __ptr[7] = uVar3;
    __ptr[8] = 0;
    __ptr[5] = uVar1;
    break;
  case 3:
    uVar1 = *param_5;
    __ptr[5] = 0;
    __ptr[7] = 0;
    __ptr[4] = uVar1;
    __ptr[6] = 0xfffffffe;
    break;
  default:
    free(__ptr_00);
    free(__ptr);
    return 0x22;
  }
  iVar4 = param_1[2];
  if (iVar4 == 0) {
    param_1[3] = (int)__ptr;
  }
  else {
    *(undefined4 **)(iVar4 + 0x24) = __ptr;
  }
  __ptr[10] = iVar4;
  __ptr[9] = 0;
  param_1[2] = (int)__ptr;
  iVar4 = strcmp(param_2,"default_stderr");
  if (iVar4 != 0) {
    return 0;
  }
  DAT_000c9c50 = __ptr;
  return 0;
}




int FUN_0005439c(int *param_1,int *param_2)

{
  int iVar1;
  undefined4 *local_38;
  undefined4 local_34;
  int local_30;
  undefined4 local_2c;
  int local_28;
  
  if ((param_2 == (int *)0x0) || (*param_2 != 0)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x150,0,"lcfgp != ((void *)0) && *lcfgp == ((void *)0)");
  }
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x151,0,
                    "(((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                   );
  }
  local_38 = (undefined4 *)FUN_0004f524(0x28);
  if (local_38 == (undefined4 *)0x0) {
    iVar1 = 1;
  }
  else {
    local_38[1] = param_1;
    local_38[7] = 0xffffffff;
    local_38[4] = 0;
    local_38[5] = 0;
    local_38[6] = 0;
    *local_38 = 0x4c636667;
    local_34 = 0x18;
    local_38[8] = 0;
    local_38[9] = 0;
    local_38[2] = 0;
    local_38[3] = 0;
    iVar1 = FUN_00054104(local_38,"default_syslog",2,0xffffffff,&local_34,0);
    if (iVar1 == 0) {
      local_34 = stderr;
      local_2c = 0xfffffffe;
      local_30 = iVar1;
      local_28 = iVar1;
      iVar1 = FUN_00054104(local_38,"default_stderr",4,0xffffffff,&local_34,1);
      if (iVar1 == 0) {
        local_34 = stderr;
        DAT_000c9c50 = local_38[2];
        local_2c = 0xfffffffe;
        local_30 = iVar1;
        local_28 = iVar1;
        iVar1 = FUN_00054104(local_38,"default_debug",4,0,&local_34,1);
        if ((iVar1 == 0) && (iVar1 = FUN_00054104(local_38,&DAT_0006efb0,1,0,0,0), iVar1 == 0)) {
          *param_2 = (int)local_38;
          return 0;
        }
      }
    }
    if (local_38 != (undefined4 *)0x0) {
      FUN_000537a0(&local_38);
    }
  }
  return iVar1;
}




int FUN_00054584(int param_1,int *param_2,int *param_3)

{
  int iVar1;
  undefined4 *local_18;
  int local_14;
  
  local_14 = 0;
  if (param_1 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x110,0,"mctx != ((void *)0)");
  }
  if ((param_2 == (int *)0x0) || (*param_2 != 0)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x111,0,"lctxp != ((void *)0) && *lctxp == ((void *)0)");
  }
  if ((param_3 != (int *)0x0) && (*param_3 != 0)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x112,0,"lcfgp == ((void *)0) || *lcfgp == ((void *)0)");
  }
  local_18 = (undefined4 *)FUN_0004f524(0x202c);
  if (local_18 == (undefined4 *)0x0) {
    iVar1 = 1;
  }
  else {
    local_18[1] = param_1;
    local_18[0x80a] = 0;
    local_18[0x809] = 0;
    local_18[2] = 0;
    *local_18 = 0x4c637478;
    local_18[3] = 0;
    local_18[4] = 0;
    local_18[5] = 0;
    local_18[6] = 0;
    local_18[7] = 0;
    FUN_00053d84(local_18,&DAT_0007ca08);
    FUN_00053f44(local_18,&DAT_0007ca20);
    iVar1 = FUN_0005439c(local_18,&local_14);
    if ((iVar1 == 0) && (iVar1 = FUN_000534b4(local_14), iVar1 == 0)) {
      local_18[8] = local_14;
      *param_2 = (int)local_18;
      if (param_3 == (int *)0x0) {
        return 0;
      }
      *param_3 = local_14;
      return 0;
    }
  }
  if (local_14 != 0) {
    FUN_000537a0(&local_14);
  }
  if (local_18 != (undefined4 *)0x0) {
    FUN_00053a88(&local_18);
  }
  return iVar1;
}




int FUN_0005472c(int *param_1,char *param_2,int param_3,int param_4)

{
  int iVar1;
  undefined4 *puVar2;
  uint uVar3;
  int iVar4;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c636667)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x31c,0,
                    "(((lcfg) != ((void *)0)) && (((const isc__magic_t *)(lcfg))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'f\') << 8 | (\'g\')))))"
                   );
  }
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x31d,0,"name != ((void *)0)");
  }
  iVar4 = param_1[1];
  if ((param_3 != 0) && (*(uint *)(iVar4 + 0xc) <= *(uint *)(param_3 + 4))) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x321,0,"category == ((void *)0) || category->id < lctx->category_count");
  }
  if ((param_4 != 0) && (*(uint *)(iVar4 + 0x14) <= *(uint *)(param_4 + 4))) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x322,0,"module == ((void *)0) || module->id < lctx->module_count");
  }
  puVar2 = (undefined4 *)param_1[2];
  while( true ) {
    if (puVar2 == (undefined4 *)0x0) {
      return 0x17;
    }
    iVar1 = strcmp(param_2,(char *)*puVar2);
    if (iVar1 == 0) break;
    puVar2 = (undefined4 *)puVar2[10];
  }
  if (param_3 == 0) {
    if (*(int *)(iVar4 + 0xc) != 0) {
      uVar3 = 0;
      do {
        iVar1 = FUN_000535a8(param_1,uVar3,param_4,puVar2);
        uVar3 = uVar3 + 1;
        if (iVar1 != 0) {
          return iVar1;
        }
      } while (uVar3 < *(uint *)(iVar4 + 0xc));
    }
    return 0;
  }
  iVar4 = FUN_000535a8(param_1,*(undefined4 *)(param_3 + 4),param_4,puVar2);
  return iVar4;
}




void FUN_000548c4(void)

{
  FUN_00052988();
  return;
}




void FUN_00054900(void)

{
  FUN_00052988();
  return;
}




void FUN_00054938(void)

{
  FUN_00052988();
  return;
}




void FUN_00054978(void)

{
  FUN_00052988();
  return;
}




void FUN_000549b4(void)

{
  FUN_00052988();
  return;
}




void FUN_000549fc(void)

{
  FUN_00052988();
  return;
}




void FUN_00054a40(void)

{
  FUN_00052988();
  return;
}




void FUN_00054a88(void)

{
  FUN_00052988();
  return;
}




void FUN_00054adc(int *param_1,int param_2)

{
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x3bc,0,
                    "(((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                   );
  }
  iVar1 = param_1[7];
  param_1[7] = iVar1 + 1;
  if (iVar1 != 0) {
    FUN_000516d8("./../lib/isc/log.c",0x3be,"((*((&lctx->lock)))++ == 0 ? 0 : 34) == 0");
  }
  param_1[6] = param_2;
  if (param_2 == 0) {
    for (iVar1 = *(int *)(param_1[8] + 8); iVar1 != 0; iVar1 = *(int *)(iVar1 + 0x28)) {
      if (((*(int *)(iVar1 + 4) == 3) && ((*(uint *)(iVar1 + 0xc) & 0x1000) != 0)) &&
         (*(FILE **)(iVar1 + 0x10) != (FILE *)0x0)) {
        fclose(*(FILE **)(iVar1 + 0x10));
        *(undefined4 *)(iVar1 + 0x10) = 0;
      }
    }
  }
  iVar1 = param_1[7];
  param_1[7] = iVar1 + -1;
  if (iVar1 + -1 != 0) {
    FUN_000516d8("./../lib/isc/log.c",0x3ce,"(--(*((&lctx->lock))) == 0 ? 0 : 34) == 0");
    return;
  }
  return;
}




int FUN_00054bd8(int *param_1)

{
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x3d3,0,
                    "(((lctx) != ((void *)0)) && (((const isc__magic_t *)(lctx))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                   );
  }
  return param_1[6];
}




void FUN_00054c28(int *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c636667)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x3da,0,
                    "(((lcfg) != ((void *)0)) && (((const isc__magic_t *)(lcfg))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'f\') << 8 | (\'g\')))))"
                    ,param_4);
  }
  param_1[6] = param_2;
  return;
}




int FUN_00054c7c(int *param_1)

{
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c637478)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x3e1,0,
                    "(((lcfg) != ((void *)0)) && (((const isc__magic_t *)(lcfg))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))"
                   );
  }
  return param_1[6];
}




int FUN_00054ccc(int *param_1,char *param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  int iVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c636667)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",1000,0,
                    "(((lcfg) != ((void *)0)) && (((const isc__magic_t *)(lcfg))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'f\') << 8 | (\'g\')))))"
                    ,param_4);
  }
  if ((param_2 != (char *)0x0) && (*param_2 != '\0')) {
    if ((void *)param_1[8] != (void *)0x0) {
      free((void *)param_1[8]);
    }
    uVar1 = FUN_0004f4e8(param_2);
    param_1[8] = uVar1;
    iVar2 = 1 - uVar1;
    if (1 < uVar1) {
      iVar2 = 0;
    }
    return iVar2;
  }
  if ((void *)param_1[8] != (void *)0x0) {
    free((void *)param_1[8]);
  }
  param_1[8] = 0;
  return 0;
}




int FUN_00054d70(int *param_1)

{
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4c636667)) {
    (*DAT_0007c9fc)("./../lib/isc/log.c",0x3fc,0,
                    "(((lcfg) != ((void *)0)) && (((const isc__magic_t *)(lcfg))->magic == (((\'L\') << 24 | (\'c\') << 16 | (\'f\') << 8 | (\'g\')))))"
                   );
  }
  return param_1[8];
}




void FUN_00054efc(undefined4 *param_1,int param_2)

{
  do {
    param_2 = param_2 + -1;
    *param_1 = *param_1;
    param_1 = param_1 + 1;
  } while (param_2 != 0);
  return;
}




void FUN_00054f30(int *param_1,int *param_2)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  int iVar8;
  int iVar9;
  int iVar10;
  uint uVar11;
  int iVar12;
  int iVar13;
  int iVar14;
  int iVar15;
  int iVar16;
  int iVar17;
  int iVar18;
  uint uVar19;
  int iVar20;
  uint uVar21;
  uint uVar22;
  int iVar23;
  
  uVar5 = param_1[3];
  uVar11 = param_1[1];
  iVar10 = *param_2;
  iVar16 = param_2[1];
  uVar3 = *param_1 + -0x28955b88 + iVar10 + ((uVar5 ^ param_1[2]) & uVar11 ^ uVar5);
  uVar4 = uVar11 + (uVar3 >> 0x19 | uVar3 * 0x80);
  uVar3 = uVar5 + 0xe8c7b756 + iVar16 + (uVar4 & (param_1[2] ^ uVar11) ^ param_1[2]);
  iVar2 = param_2[2];
  uVar5 = uVar4 + (uVar3 >> 0x14 | uVar3 * 0x1000);
  uVar3 = param_1[2] + 0x242070dbU + iVar2 + (uVar5 & (uVar4 ^ uVar11) ^ uVar11);
  iVar8 = param_2[3];
  uVar22 = uVar5 + (uVar3 >> 0xf | uVar3 * 0x20000);
  iVar12 = param_2[4];
  uVar3 = uVar11 + 0xc1bdceee + iVar8 + (uVar22 & (uVar5 ^ uVar4) ^ uVar4);
  uVar3 = uVar22 + (uVar3 >> 10 | uVar3 * 0x400000);
  uVar4 = iVar12 + -0xa83f051 + uVar4 + (uVar3 & (uVar22 ^ uVar5) ^ uVar5);
  iVar14 = param_2[5];
  uVar4 = uVar3 + (uVar4 >> 0x19 | uVar4 * 0x80);
  uVar5 = iVar14 + 0x4787c62a + uVar5 + (uVar4 & (uVar3 ^ uVar22) ^ uVar22);
  iVar17 = param_2[6];
  uVar5 = uVar4 + (uVar5 >> 0x14 | uVar5 * 0x1000);
  uVar11 = iVar17 + -0x57cfb9ed + uVar22 + (uVar5 & (uVar4 ^ uVar3) ^ uVar3);
  iVar13 = param_2[7];
  uVar11 = uVar5 + (uVar11 >> 0xf | uVar11 * 0x20000);
  iVar20 = param_2[8];
  uVar3 = iVar13 + -0x2b96aff + uVar3 + (uVar11 & (uVar5 ^ uVar4) ^ uVar4);
  uVar3 = uVar11 + (uVar3 >> 10 | uVar3 * 0x400000);
  iVar6 = param_2[9];
  uVar4 = iVar20 + 0x698098d8 + uVar4 + (uVar3 & (uVar11 ^ uVar5) ^ uVar5);
  uVar4 = uVar3 + (uVar4 >> 0x19 | uVar4 * 0x80);
  uVar5 = iVar6 + -0x74bb0851 + uVar5 + (uVar4 & (uVar3 ^ uVar11) ^ uVar11);
  iVar18 = param_2[10];
  iVar7 = param_2[0xb];
  uVar22 = uVar4 + (uVar5 >> 0x14 | uVar5 * 0x1000);
  uVar5 = iVar18 + -0xa44f + uVar11 + (uVar22 & (uVar4 ^ uVar3) ^ uVar3);
  uVar11 = uVar22 + (uVar5 >> 0xf | uVar5 * 0x20000);
  iVar23 = param_2[0xc];
  uVar3 = iVar7 + -0x76a32842 + uVar3 + (uVar11 & (uVar22 ^ uVar4) ^ uVar4);
  uVar5 = uVar11 + (uVar3 >> 10 | uVar3 * 0x400000);
  iVar15 = param_2[0xd];
  uVar3 = iVar23 + 0x6b901122 + uVar4 + (uVar5 & (uVar11 ^ uVar22) ^ uVar22);
  uVar4 = uVar5 + (uVar3 >> 0x19 | uVar3 * 0x80);
  iVar9 = param_2[0xe];
  uVar3 = iVar15 + -0x2678e6d + uVar22 + (uVar4 & (uVar5 ^ uVar11) ^ uVar11);
  uVar22 = uVar4 + (uVar3 >> 0x14 | uVar3 * 0x1000);
  iVar1 = param_2[0xf];
  uVar3 = iVar9 + -0x5986bc72 + uVar11 + (uVar22 & (uVar4 ^ uVar5) ^ uVar5);
  uVar11 = uVar22 + (uVar3 >> 0xf | uVar3 * 0x20000);
  uVar3 = iVar1 + 0x49b40821 + uVar5 + (uVar11 & (uVar22 ^ uVar4) ^ uVar4);
  uVar3 = uVar11 + (uVar3 >> 10 | uVar3 * 0x400000);
  uVar4 = iVar16 + -0x9e1da9e + uVar4 + ((uVar3 ^ uVar11) & uVar22 ^ uVar11);
  uVar19 = uVar3 + (uVar4 >> 0x1b | uVar4 * 0x20);
  uVar4 = iVar17 + -0x3fbf4cc0 + uVar22 + ((uVar19 ^ uVar3) & uVar11 ^ uVar3);
  uVar4 = uVar19 + (uVar4 >> 0x17 | uVar4 * 0x200);
  uVar5 = iVar7 + 0x265e5a51 + uVar11 + ((uVar4 ^ uVar19) & uVar3 ^ uVar19);
  uVar21 = uVar4 + (uVar5 >> 0x12 | uVar5 * 0x4000);
  uVar3 = iVar10 + -0x16493856 + uVar3 + ((uVar21 ^ uVar4) & uVar19 ^ uVar4);
  uVar5 = uVar21 + (uVar3 >> 0xc | uVar3 * 0x100000);
  uVar3 = iVar14 + -0x29d0efa3 + uVar19 + ((uVar5 ^ uVar21) & uVar4 ^ uVar21);
  uVar22 = uVar5 + (uVar3 >> 0x1b | uVar3 * 0x20);
  uVar3 = iVar18 + 0x2441453 + uVar4 + ((uVar22 ^ uVar5) & uVar21 ^ uVar5);
  uVar11 = uVar22 + (uVar3 >> 0x17 | uVar3 * 0x200);
  uVar3 = iVar1 + -0x275e197f + uVar21 + ((uVar11 ^ uVar22) & uVar5 ^ uVar22);
  uVar3 = uVar11 + (uVar3 >> 0x12 | uVar3 * 0x4000);
  uVar4 = iVar12 + -0x182c0438 + uVar5 + ((uVar3 ^ uVar11) & uVar22 ^ uVar11);
  uVar4 = uVar3 + (uVar4 >> 0xc | uVar4 * 0x100000);
  uVar5 = iVar6 + 0x21e1cde6 + uVar22 + ((uVar4 ^ uVar3) & uVar11 ^ uVar3);
  uVar19 = uVar4 + (uVar5 >> 0x1b | uVar5 * 0x20);
  uVar5 = iVar9 + -0x3cc8f82a + uVar11 + ((uVar19 ^ uVar4) & uVar3 ^ uVar4);
  uVar21 = uVar19 + (uVar5 >> 0x17 | uVar5 * 0x200);
  uVar3 = iVar8 + -0xb2af279 + uVar3 + ((uVar21 ^ uVar19) & uVar4 ^ uVar19);
  uVar5 = uVar21 + (uVar3 >> 0x12 | uVar3 * 0x4000);
  uVar3 = iVar20 + 0x455a14ed + uVar4 + ((uVar5 ^ uVar21) & uVar19 ^ uVar21);
  uVar22 = uVar5 + (uVar3 >> 0xc | uVar3 * 0x100000);
  uVar3 = iVar15 + -0x561c16fb + uVar19 + ((uVar22 ^ uVar5) & uVar21 ^ uVar5);
  uVar11 = uVar22 + (uVar3 >> 0x1b | uVar3 * 0x20);
  uVar3 = iVar2 + -0x3105c08 + uVar21 + ((uVar11 ^ uVar22) & uVar5 ^ uVar22);
  uVar4 = uVar11 + (uVar3 >> 0x17 | uVar3 * 0x200);
  uVar3 = iVar13 + 0x676f02d9 + uVar5 + ((uVar4 ^ uVar11) & uVar22 ^ uVar11);
  uVar3 = uVar4 + (uVar3 >> 0x12 | uVar3 * 0x4000);
  uVar5 = iVar23 + -0x72d5b376 + uVar22 + ((uVar3 ^ uVar4) & uVar11 ^ uVar4);
  uVar5 = uVar3 + (uVar5 >> 0xc | uVar5 * 0x100000);
  uVar11 = iVar14 + -0x5c6be + uVar11 + (uVar5 ^ uVar3 ^ uVar4);
  uVar22 = uVar5 + (uVar11 >> 0x1c | uVar11 * 0x10);
  uVar4 = iVar20 + -0x788e097f + uVar4 + (uVar5 ^ uVar3 ^ uVar22);
  uVar4 = uVar22 + (uVar4 >> 0x15 | uVar4 * 0x800);
  uVar3 = iVar7 + 0x6d9d6122 + uVar3 + (uVar22 ^ uVar5 ^ uVar4);
  uVar11 = uVar4 + (uVar3 >> 0x10 | uVar3 * 0x10000);
  uVar3 = iVar9 + -0x21ac7f4 + uVar5 + (uVar4 ^ uVar22 ^ uVar11);
  uVar19 = uVar11 + (uVar3 >> 9 | uVar3 * 0x800000);
  uVar3 = iVar16 + -0x5b4115bc + uVar22 + (uVar11 ^ uVar4 ^ uVar19);
  uVar3 = uVar19 + (uVar3 >> 0x1c | uVar3 * 0x10);
  uVar4 = iVar12 + 0x4bdecfa9 + uVar4 + (uVar19 ^ uVar11 ^ uVar3);
  uVar5 = uVar3 + (uVar4 >> 0x15 | uVar4 * 0x800);
  uVar4 = iVar13 + -0x944b4a0 + uVar11 + (uVar3 ^ uVar19 ^ uVar5);
  uVar22 = uVar5 + (uVar4 >> 0x10 | uVar4 * 0x10000);
  uVar4 = iVar18 + -0x41404390 + uVar19 + (uVar5 ^ uVar3 ^ uVar22);
  uVar4 = uVar22 + (uVar4 >> 9 | uVar4 * 0x800000);
  uVar3 = iVar15 + 0x289b7ec6 + uVar3 + (uVar22 ^ uVar5 ^ uVar4);
  uVar11 = uVar4 + (uVar3 >> 0x1c | uVar3 * 0x10);
  uVar3 = iVar10 + -0x155ed806 + uVar5 + (uVar4 ^ uVar22 ^ uVar11);
  uVar19 = uVar11 + (uVar3 >> 0x15 | uVar3 * 0x800);
  uVar3 = iVar8 + -0x2b10cf7b + uVar22 + (uVar11 ^ uVar4 ^ uVar19);
  uVar3 = uVar19 + (uVar3 >> 0x10 | uVar3 * 0x10000);
  uVar4 = iVar17 + 0x4881d05 + uVar4 + (uVar19 ^ uVar11 ^ uVar3);
  uVar5 = uVar3 + (uVar4 >> 9 | uVar4 * 0x800000);
  uVar4 = iVar6 + -0x262b2fc7 + uVar11 + (uVar3 ^ uVar19 ^ uVar5);
  uVar22 = uVar5 + (uVar4 >> 0x1c | uVar4 * 0x10);
  uVar4 = iVar23 + -0x1924661b + uVar19 + (uVar5 ^ uVar3 ^ uVar22);
  uVar4 = uVar22 + (uVar4 >> 0x15 | uVar4 * 0x800);
  uVar3 = iVar1 + 0x1fa27cf8 + uVar3 + (uVar22 ^ uVar5 ^ uVar4);
  uVar11 = uVar4 + (uVar3 >> 0x10 | uVar3 * 0x10000);
  uVar3 = iVar2 + -0x3b53a99b + uVar5 + (uVar4 ^ uVar22 ^ uVar11);
  uVar5 = uVar11 + (uVar3 >> 9 | uVar3 * 0x800000);
  uVar3 = iVar10 + -0xbd6ddbc + uVar22 + ((uVar5 | ~uVar4) ^ uVar11);
  uVar22 = uVar5 + (uVar3 >> 0x1a | uVar3 * 0x40);
  uVar3 = iVar13 + 0x432aff97 + uVar4 + ((uVar22 | ~uVar11) ^ uVar5);
  uVar3 = uVar22 + (uVar3 >> 0x16 | uVar3 * 0x400);
  uVar4 = iVar9 + -0x546bdc59 + uVar11 + ((uVar3 | ~uVar5) ^ uVar22);
  uVar4 = uVar3 + (uVar4 >> 0x11 | uVar4 * 0x8000);
  uVar5 = iVar14 + -0x36c5fc7 + uVar5 + ((uVar4 | ~uVar22) ^ uVar3);
  uVar11 = uVar4 + (uVar5 >> 0xb | uVar5 * 0x200000);
  uVar5 = iVar23 + 0x655b59c3 + uVar22 + ((uVar11 | ~uVar3) ^ uVar4);
  uVar5 = uVar11 + (uVar5 >> 0x1a | uVar5 * 0x40);
  uVar3 = iVar8 + -0x70f3336e + uVar3 + ((uVar5 | ~uVar4) ^ uVar11);
  uVar19 = uVar5 + (uVar3 >> 0x16 | uVar3 * 0x400);
  uVar3 = iVar18 + -0x100b83 + uVar4 + ((uVar19 | ~uVar11) ^ uVar5);
  uVar22 = uVar19 + (uVar3 >> 0x11 | uVar3 * 0x8000);
  uVar3 = iVar16 + -0x7a7ba22f + uVar11 + ((uVar22 | ~uVar5) ^ uVar19);
  uVar11 = uVar22 + (uVar3 >> 0xb | uVar3 * 0x200000);
  uVar3 = iVar20 + 0x6fa87e4f + uVar5 + ((uVar11 | ~uVar19) ^ uVar22);
  uVar4 = uVar11 + (uVar3 >> 0x1a | uVar3 * 0x40);
  uVar3 = iVar1 + -0x1d31920 + uVar19 + ((uVar4 | ~uVar22) ^ uVar11);
  uVar3 = uVar4 + (uVar3 >> 0x16 | uVar3 * 0x400);
  uVar5 = iVar17 + -0x5cfebcec + uVar22 + ((uVar3 | ~uVar11) ^ uVar4);
  uVar5 = uVar3 + (uVar5 >> 0x11 | uVar5 * 0x8000);
  uVar11 = iVar15 + 0x4e0811a1 + uVar11 + ((uVar5 | ~uVar4) ^ uVar3);
  uVar11 = uVar5 + (uVar11 >> 0xb | uVar11 * 0x200000);
  uVar4 = iVar12 + -0x8ac817e + uVar4 + ((uVar11 | ~uVar3) ^ uVar5);
  uVar4 = uVar11 + (uVar4 >> 0x1a | uVar4 * 0x40);
  uVar3 = iVar7 + -0x42c50dcb + uVar3 + ((uVar4 | ~uVar5) ^ uVar11);
  *param_1 = uVar4 + *param_1;
  uVar3 = uVar4 + (uVar3 >> 0x16 | uVar3 * 0x400);
  uVar5 = iVar2 + 0x2ad7d2bb + uVar5 + ((uVar3 | ~uVar11) ^ uVar4);
  param_1[3] = uVar3 + param_1[3];
  uVar5 = uVar3 + (uVar5 >> 0x11 | uVar5 * 0x8000);
  uVar3 = iVar6 + -0x14792c6f + uVar11 + ((uVar5 | ~uVar4) ^ uVar3);
  param_1[2] = uVar5 + param_1[2];
  param_1[1] = uVar5 + param_1[1] + (uVar3 >> 0xb | uVar3 * 0x200000);
  return;
}




void FUN_0005594c(undefined4 *param_1)

{
  *param_1 = 0x67452301;
  param_1[1] = 0xefcdab89;
  param_1[2] = 0x98badcfe;
  param_1[3] = 0x10325476;
  param_1[4] = 0;
  param_1[5] = 0;
  return;
}




void FUN_00055994(int param_1,void *param_2,uint param_3)

{
  undefined4 uVar1;
  undefined4 uVar2;
  uint uVar3;
  undefined4 *puVar4;
  undefined4 *puVar5;
  undefined4 uVar6;
  size_t __n;
  uint __n_00;
  undefined4 *__src;
  undefined4 *__dest;
  undefined4 *puVar7;
  undefined4 uVar8;
  
  uVar3 = *(uint *)(param_1 + 0x10);
  *(uint *)(param_1 + 0x10) = param_3 + uVar3;
  __n_00 = 0x40 - (uVar3 & 0x3f);
  if (param_3 + uVar3 < uVar3) {
    *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
  }
  if (__n_00 <= param_3) {
    __dest = (undefined4 *)(param_1 + 0x18);
    __n = param_3 - __n_00;
    memcpy((void *)((param_1 + 0x58) - __n_00),param_2,__n_00);
    __src = (undefined4 *)((int)param_2 + __n_00);
    FUN_00054efc(__dest,0x10);
    FUN_00054f30(param_1,__dest);
    puVar5 = __src;
    uVar3 = __n;
    if (0x3f < __n) {
      do {
        puVar7 = puVar5 + 0x10;
        puVar4 = __dest;
        do {
          uVar1 = *puVar5;
          uVar2 = puVar5[1];
          uVar6 = puVar5[2];
          uVar8 = puVar5[3];
          puVar5 = puVar5 + 4;
          *puVar4 = uVar1;
          puVar4[1] = uVar2;
          puVar4[2] = uVar6;
          puVar4[3] = uVar8;
          puVar4 = puVar4 + 4;
        } while (puVar5 != puVar7);
        FUN_00054efc(__dest,0x10);
        uVar3 = uVar3 - 0x40;
        FUN_00054f30(param_1,__dest);
      } while (0x3f < uVar3);
      uVar3 = __n - 0x40;
      __n = __n & 0x3f;
      __src = (undefined4 *)((int)__src + (uVar3 & 0xffffffc0) + 0x40);
    }
    memcpy(__dest,__src,__n);
    return;
  }
  memcpy((void *)((param_1 + 0x58) - __n_00),param_2,param_3);
  return;
}




void FUN_00055aa8(undefined4 *param_1,undefined4 *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  undefined4 *__s;
  size_t __n;
  uint uVar2;
  undefined4 uVar3;
  undefined4 *puVar4;
  undefined4 uVar5;
  undefined4 uVar6;
  
  puVar4 = param_1 + 6;
  uVar2 = param_1[4] & 0x3f;
  __n = 0x37 - uVar2;
  *(undefined1 *)((int)puVar4 + uVar2) = 0x80;
  __s = (undefined4 *)((int)puVar4 + uVar2 + 1);
  if ((int)__n < 0) {
    memset(__s,0,0x3f - uVar2);
    FUN_00054efc(puVar4,0x10);
    FUN_00054f30(param_1,puVar4);
    __n = 0x38;
    __s = puVar4;
  }
  memset(__s,0,__n);
  FUN_00054efc(puVar4,0xe);
  uVar2 = param_1[5] << 3 | (uint)param_1[4] >> 0x1d;
  iVar1 = param_1[4] << 3;
  param_1[0x15] = uVar2;
  param_1[0x14] = iVar1;
  FUN_00054f30(param_1,puVar4,uVar2,iVar1,param_4);
  FUN_00054efc(param_1,4);
  uVar5 = param_1[1];
  uVar6 = param_1[2];
  uVar3 = param_1[3];
  *param_2 = *param_1;
  param_2[1] = uVar5;
  param_2[2] = uVar6;
  param_2[3] = uVar3;
  memset(param_1,0,0x58);
  return;
}




void FUN_00055b84(int param_1,int *param_2)

{
  undefined4 *puVar1;
  
  if (param_1 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/nls/msgcat.c",0x40,0,"name != ((void *)0)");
  }
  if ((param_2 == (int *)0x0) || (*param_2 != 0)) {
    (*DAT_0007c9fc)("./../lib/isc/nls/msgcat.c",0x41,0,"msgcatp != ((void *)0) && *msgcatp == ((void *)0)");
  }
  puVar1 = (undefined4 *)malloc(4);
  if (puVar1 != (undefined4 *)0x0) {
    *puVar1 = 0x4d436174;
  }
  *param_2 = (int)puVar1;
  return;
}




void FUN_00055c10(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int *__ptr;
  
  if (param_1 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/nls/msgcat.c",0x5e,0,"msgcatp != ((void *)0)",param_4);
  }
  __ptr = (int *)*param_1;
  if (__ptr != (int *)0x0) {
    if (*__ptr != 0x4d436174) {
      (*DAT_0007c9fc)("./../lib/isc/nls/msgcat.c",0x60,0,
                      "(((msgcat) != ((void *)0)) && (((const isc__magic_t *)(msgcat))->magic == (((\'M\') << 24 | (\'C\') << 16 | (\'a\') << 8 | (\'t\'))))) || msgcat == ((void *)0)"
                     );
    }
    *__ptr = 0;
    free(__ptr);
  }
  *param_1 = 0;
  return;
}




int FUN_00055ca4(int *param_1,int param_2,int param_3,int param_4)

{
  if ((param_1 != (int *)0x0) && (*param_1 != 0x4d436174)) {
    (*DAT_0007c9fc)("./../lib/isc/nls/msgcat.c",0x77,0,
                    "(((msgcat) != ((void *)0)) && (((const isc__magic_t *)(msgcat))->magic == (((\'M\') << 24 | (\'C\') << 16 | (\'a\') << 8 | (\'t\'))))) || msgcat == ((void *)0)"
                   );
  }
  if (param_2 < 1) {
    (*DAT_0007c9fc)("./../lib/isc/nls/msgcat.c",0x78,0,"set > 0");
  }
  if (param_3 < 1) {
    (*DAT_0007c9fc)("./../lib/isc/nls/msgcat.c",0x79,0,"message > 0");
  }
  if (param_4 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/nls/msgcat.c",0x7a,0,"default_text != ((void *)0)");
    return 0;
  }
  return param_4;
}




undefined4 FUN_00055d90(int param_1)

{
  int iVar1;
  int *piVar2;
  int iVar3;
  char *pcVar4;
  undefined4 uVar5;
  socklen_t local_b0;
  sockaddr sStack_ac;
  undefined1 auStack_90 [128];
  
  iVar1 = socket(param_1,1,0);
  if (iVar1 == -1) {
    piVar2 = __errno_location();
    iVar1 = *piVar2;
    if (((iVar1 != 0x5d) && (iVar1 != 0x61)) && (iVar1 != 0x16)) {
      FUN_00057070(iVar1,auStack_90,0x80);
      uVar5 = FUN_00055ca4(DAT_000c9c48,1,0x65,"failed");
      FUN_0005166c("./../lib/isc/unix/net.c",0x8f,"socket() %s: %s",uVar5,auStack_90);
      return 0x22;
    }
    return 0x17;
  }
  if (param_1 == 10) {
    local_b0 = 0x1c;
    iVar3 = getsockname(iVar1,&sStack_ac,&local_b0);
    if (iVar3 < 0) {
      pcVar4 = "retrieving the address of an IPv6 socket from the kernel failed.";
    }
    else {
      if (local_b0 == 0x1c) goto LAB_00055dbc;
      pcVar4 = "IPv6 structures in kernel and user space do not match.";
    }
    uVar5 = 0x17;
    FUN_000548c4(DAT_000c9c5c,&DAT_0007ca10,&DAT_0007ca20,0xfffffffc,pcVar4);
    FUN_000548c4(DAT_000c9c5c,&DAT_0007ca10,&DAT_0007ca20,0xfffffffc,"IPv6 is not supported.");
  }
  else {
LAB_00055dbc:
    uVar5 = 0;
  }
  close(iVar1);
  return uVar5;
}




void FUN_00055ee8(void)

{
  if (DAT_000c9c60 != 0) {
    return;
  }
  DAT_0007ca50 = FUN_00055d90(2);
  DAT_0007ca54 = FUN_00055d90(10);
  DAT_000c9c60 = 1;
  return;
}




undefined4 FUN_00055f2c(void)

{
  FUN_00055ee8();
  return DAT_0007ca50;
}




undefined4 FUN_00055f44(void)

{
  FUN_00055ee8();
  return DAT_0007ca54;
}




undefined4 FUN_00055f5c(void)

{
  FUN_00055ee8();
  return 0x17;
}




int FUN_00055f6c(void)

{
  int __fd;
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined4 uVar4;
  undefined4 local_a4;
  undefined1 auStack_a0 [128];
  
  if (DAT_000c9c64 != 0) {
    return DAT_0007ca58;
  }
  FUN_00055ee8();
  if (DAT_0007ca54 != 0) {
    DAT_0007ca58 = DAT_0007ca54;
    DAT_000c9c64 = 1;
    return DAT_0007ca54;
  }
  __fd = socket(10,1,0);
  if (__fd == -1) {
    piVar2 = __errno_location();
    FUN_00057070(*piVar2,auStack_a0,0x80);
    uVar3 = FUN_00055ca4(DAT_000c9c48,1,0x65,"failed");
    uVar4 = 0x109;
LAB_000560b0:
    FUN_0005166c("./../lib/isc/unix/net.c",uVar4,"socket() %s: %s",uVar3,auStack_a0);
    DAT_0007ca58 = 0x22;
  }
  else {
    local_a4 = 1;
    iVar1 = setsockopt(__fd,0x29,0x1a,&local_a4,4);
    if (iVar1 < 0) {
LAB_00056058:
      DAT_0007ca58 = 0x17;
    }
    else {
      close(__fd);
      __fd = socket(10,2,0);
      if (__fd == -1) {
        piVar2 = __errno_location();
        FUN_00057070(*piVar2,auStack_a0,0x80);
        uVar3 = FUN_00055ca4(DAT_000c9c48,1,0x65,"failed");
        uVar4 = 0x120;
        goto LAB_000560b0;
      }
      local_a4 = 1;
      iVar1 = setsockopt(__fd,0x29,0x1a,&local_a4,4);
      if (iVar1 < 0) goto LAB_00056058;
      close(__fd);
      DAT_0007ca58 = 0;
    }
    close(__fd);
  }
  DAT_000c9c64 = 1;
  return DAT_0007ca58;
}




int FUN_00056124(void)

{
  int __fd;
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  undefined4 local_9c;
  undefined1 auStack_98 [132];
  
  if (DAT_000c9c68 == 0) {
    FUN_00055ee8();
    if (DAT_0007ca54 == 0) {
      __fd = socket(10,2,0x11);
      if (__fd == -1) {
        piVar2 = __errno_location();
        FUN_00057070(*piVar2,auStack_98,0x80);
        uVar3 = FUN_00055ca4(DAT_000c9c48,1,0x65,"failed");
        FUN_0005166c("./../lib/isc/unix/net.c",0x153,"socket() %s: %s",uVar3,auStack_98);
        DAT_0007ca5c = 0x22;
      }
      else {
        local_9c = 1;
        iVar1 = setsockopt(__fd,0x29,0x31,&local_9c,4);
        if (iVar1 < 0) {
          DAT_0007ca5c = 0x17;
        }
        else {
          close(__fd);
          DAT_0007ca5c = 0;
        }
        close(__fd);
      }
    }
    else {
      DAT_0007ca5c = DAT_0007ca54;
    }
    DAT_000c9c68 = 1;
  }
  return DAT_0007ca5c;
}




bool FUN_000563ec(int *param_1,int *param_2,uint param_3,undefined4 param_4)

{
  int iVar1;
  uint uVar2;
  uint uVar3;
  
  if (param_2 == (int *)0x0 || param_1 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/netaddr.c",0x4d,0,"a != ((void *)0) && b != ((void *)0)",param_4);
  }
  iVar1 = *param_1;
  if ((iVar1 == *param_2) && ((param_1[5] == param_2[5] || (param_2[5] == 0)))) {
    if (iVar1 == 2) {
      uVar2 = 0x20;
      uVar3 = 4;
    }
    else {
      if (iVar1 != 10) {
        return false;
      }
      uVar2 = 0x80;
      uVar3 = 0x10;
    }
    if (uVar2 < param_3) {
      param_3 = uVar2;
    }
    uVar2 = param_3 >> 3;
    if ((uVar2 == 0) || (iVar1 = memcmp(param_1 + 1,param_2 + 1,uVar2), iVar1 == 0)) {
      if ((param_3 & 7) != 0) {
        if (uVar3 <= uVar2) {
          (*DAT_0007c9fc)("./../lib/isc/netaddr.c",0x75,2,"nbytes < ipabytes");
        }
        return ((uint)(*(byte *)((int)(param_2 + 1) + (param_3 >> 3)) ^ *(byte *)((int)(param_1 + 1) + (param_3 >> 3)))
               & 0xff << (8 - (param_3 & 7) & 0xff)) == 0;
      }
      return true;
    }
  }
  return false;
}




undefined4 FUN_0005652c(int *param_1,int param_2)

{
  int __af;
  undefined4 uVar1;
  char *pcVar2;
  size_t sVar3;
  uint uVar4;
  char acStack_4c [12];
  char acStack_40 [48];
  
  if (param_1 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/netaddr.c",0x89,0,"netaddr != ((void *)0)");
  }
  __af = *param_1;
  if (((__af == 2) || (__af == 10)) && (pcVar2 = inet_ntop(__af,param_1 + 1,acStack_40,0x2e), pcVar2 != (char *)0x0)) {
    sVar3 = strlen(acStack_40);
    if (sVar3 < 0x2e) {
      if (*param_1 == 10) {
LAB_0005660c:
        if (param_1[5] == 0) {
          uVar4 = 0;
        }
        else {
          uVar4 = snprintf(acStack_4c,0xc,"%%%u");
          if ((int)uVar4 < 0) goto LAB_00056554;
          if (0xb < uVar4) {
            (*DAT_0007c9fc)("./../lib/isc/netaddr.c",0xab,2,"(unsigned int)zlen < sizeof(zbuf)");
          }
        }
      }
      else {
        uVar4 = 0;
      }
    }
    else {
      (*DAT_0007c9fc)("./../lib/isc/netaddr.c",0xa4,2,"alen < sizeof(abuf)");
      if (*param_1 == 10) goto LAB_0005660c;
      uVar4 = 0;
    }
    if ((uint)(*(int *)(param_2 + 8) - *(int *)(param_2 + 0xc)) < uVar4 + sVar3) {
      uVar1 = 0x13;
    }
    else {
      FUN_00058fd4(param_2,acStack_40,sVar3);
      FUN_00058fd4(param_2,acStack_4c,uVar4);
      uVar1 = 0;
    }
  }
  else {
LAB_00056554:
    uVar1 = 0x19;
  }
  return uVar1;
}




void FUN_00056698(undefined4 *param_1,char *param_2,size_t param_3)

{
  int iVar1;
  char *__format;
  undefined1 auStack_34 [8];
  int local_2c;
  int local_28;
  
  FUN_00057ff4(auStack_34);
  iVar1 = FUN_0005652c(param_1,auStack_34);
  if ((iVar1 == 0) && (local_2c != local_28)) {
    FUN_00058a00(auStack_34);
    return;
  }
  __format = (char *)FUN_00055ca4(DAT_000c9c48,0xc,0x3e9,"<unknown address, family %u>");
  snprintf(param_2,param_3,__format,*param_1);
  param_2[param_3 - 1] = '\0';
  return;
}




void FUN_000568bc(undefined4 *param_1,undefined4 *param_2)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
  memset(param_1,0,0x18);
  *param_1 = 10;
  uVar1 = param_2[1];
  uVar2 = param_2[2];
  uVar3 = param_2[3];
  param_1[1] = *param_2;
  param_1[2] = uVar1;
  param_1[3] = uVar2;
  param_1[4] = uVar3;
  return;
}




void FUN_000568f4(int *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  if (*param_1 != 10) {
    (*DAT_0007c9fc)("./../lib/isc/netaddr.c",0x145,0,"netaddr->family == 10",param_4);
  }
  param_1[5] = param_2;
  return;
}




void FUN_00056944(uint *param_1,ushort *param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  
  uVar1 = (uint)*param_2;
  *param_1 = uVar1;
  if (uVar1 == 2) {
    uVar1 = *(uint *)(param_2 + 2);
    param_1[5] = 0;
    param_1[1] = uVar1;
    return;
  }
  if (uVar1 != 10) {
    (*DAT_0007c9fc)("./../lib/isc/netaddr.c",0x167,2,"0",param_4);
    return;
  }
  uVar2 = *(uint *)(param_2 + 6);
  uVar3 = *(uint *)(param_2 + 8);
  uVar1 = *(uint *)(param_2 + 10);
  param_1[1] = *(uint *)(param_2 + 4);
  param_1[2] = uVar2;
  param_1[3] = uVar3;
  param_1[4] = uVar1;
  param_1[5] = *(uint *)(param_2 + 0xc);
  return;
}




void FUN_000569f0(undefined4 *param_1)

{
  undefined4 uVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
  memset(param_1,0,0x18);
  *param_1 = 10;
  uVar3 = in6addr_any._12_4_;
  uVar2 = in6addr_any._8_4_;
  uVar1 = in6addr_any._4_4_;
  param_1[1] = in6addr_any._0_4_;
  param_1[2] = uVar1;
  param_1[3] = uVar2;
  param_1[4] = uVar3;
  return;
}




bool FUN_00056a98(int *param_1)

{
  if (*param_1 != 10) {
    return false;
  }
  return (param_1[1] & 0xc0ffU) == 0x80fe;
}




void FUN_00056b00(undefined4 *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  if (*param_2 != 10) {
    (*DAT_0007c9fc)("./../lib/isc/netaddr.c",0x1ad,0,"s->family == 10",param_4);
  }
  if (((param_2[1] != 0) || (param_2[2] != 0)) || (param_2[3] != -0x10000)) {
    (*DAT_0007c9fc)("./../lib/isc/netaddr.c",0x1ae,0,
                    "(__extension__ ({ const struct in6_addr *__a = (const struct in6_addr *) (&src->type.in6); __a->__in6_u.__u6_addr32[0] == 0 && __a->__in6_u.__u6_addr32[1] == 0 && __a->__in6_u.__u6_addr32[2] == __bswap_32 (0xffff); }))"
                   );
  }
  memset(param_1,0,0x18);
  *param_1 = 2;
  param_1[1] = param_2[4];
  return;
}




undefined4 FUN_00056bac(uint param_1,uint param_2,uint param_3,uint param_4,uint param_5)

{
  uint *puVar1;
  bool bVar2;
  
  if ((param_1 & 0xffff) != 0) {
    (*DAT_0007c9fc)("./../lib/isc/result.c",0x78,0,"base % 65536 == 0",param_4);
  }
  if (0x10000 < param_2) {
    (*DAT_0007c9fc)("./../lib/isc/result.c",0x79,0,"nresults <= 65536");
  }
  if (param_3 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/result.c",0x7a,0,"text != ((void *)0)");
  }
  puVar1 = (uint *)malloc(0x1c);
  if (puVar1 != (uint *)0x0) {
    *puVar1 = param_1;
    puVar1[2] = param_3;
    bVar2 = DAT_000c9c6c != 0;
    puVar1[1] = (param_1 - 1) + param_2;
    DAT_000c9c6c = DAT_000c9c6c + 1;
    puVar1[3] = param_4;
    puVar1[4] = param_5;
    puVar1[5] = 0xffffffff;
    puVar1[6] = 0xffffffff;
    if (bVar2) {
      FUN_000516d8("./../lib/isc/result.c",0x8a,"((*((&lock)))++ == 0 ? 0 : 34) == 0");
    }
    DAT_000c9c6c = DAT_000c9c6c + -1;
    if (DAT_000c9c74 != (uint *)0x0) {
      *(uint **)((int)DAT_000c9c74 + 0x18) = puVar1;
    }
    puVar1[5] = (uint)DAT_000c9c74;
    if (DAT_000c9c74 == (uint *)0x0) {
      DAT_000c9c70 = puVar1;
    }
    bVar2 = DAT_000c9c6c == 0;
    DAT_000c9c74 = puVar1;
    puVar1[6] = 0;
    if (bVar2) {
      return 0;
    }
    FUN_000516d8("./../lib/isc/result.c",0x8e,"(--(*((&lock))) == 0 ? 0 : 34) == 0");
    return 0;
  }
  return 1;
}




void FUN_00056d1c(void)

{
  int iVar1;
  undefined4 uVar2;
  
  FUN_000525c8();
  if (DAT_000c9c78 == 0) {
    DAT_000c9c6c = 0;
    DAT_000c9c70 = 0;
    DAT_000c9c74 = 0;
    iVar1 = FUN_00056bac(0,0x3d,&PTR_s_success_0007ca60,DAT_000c9c48,2);
    if (iVar1 != 0) {
      uVar2 = FUN_00055ca4(DAT_000c9c48,1,0x65,"failed");
      FUN_0005166c("./../lib/isc/result.c",0x9d,"register_table() %s: %u",uVar2,iVar1);
    }
    DAT_000c9c78 = 1;
  }
  return;
}




int FUN_00056dc4(uint param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint *puVar1;
  int iVar2;
  bool bVar3;
  
  FUN_00056d1c();
  bVar3 = DAT_000c9c6c != 0;
  DAT_000c9c6c = DAT_000c9c6c + 1;
  puVar1 = DAT_000c9c70;
  if (bVar3) {
    FUN_000516d8("./../lib/isc/result.c",0xb2,"((*((&lock)))++ == 0 ? 0 : 34) == 0",DAT_000c9c6c,param_4);
    puVar1 = DAT_000c9c70;
  }
  do {
    if (puVar1 == (uint *)0x0) {
LAB_00056e18:
      iVar2 = FUN_00055ca4(DAT_000c9c48,3,1,"(result code text not available)");
LAB_00056e34:
      DAT_000c9c6c = DAT_000c9c6c + -1;
      if (DAT_000c9c6c != 0) {
        FUN_000516d8("./../lib/isc/result.c",0xc9,"(--(*((&lock))) == 0 ? 0 : 34) == 0",DAT_000c9c6c,param_4);
      }
      return iVar2;
    }
    if ((*puVar1 <= param_1) && (param_1 <= puVar1[1])) {
      iVar2 = param_1 - *puVar1;
      iVar2 = FUN_00055ca4(puVar1[3],puVar1[4],iVar2 + 1,*(undefined4 *)(puVar1[2] + iVar2 * 4));
      if (iVar2 != 0) goto LAB_00056e34;
      goto LAB_00056e18;
    }
    puVar1 = (uint *)puVar1[6];
  } while( true );
}




void FUN_00056eb4(undefined4 param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  FUN_00056d1c();
  FUN_00056bac(param_1,param_2,param_3,param_4);
  return;
}




undefined4 FUN_00056eec(char *param_1,char *param_2,undefined4 *param_3)

{
  FILE *pFVar1;
  int *piVar2;
  undefined4 uVar3;
  
  pFVar1 = fopen(param_1,param_2);
  if (pFVar1 != (FILE *)0x0) {
    *param_3 = pFVar1;
    return 0;
  }
  piVar2 = __errno_location();
  uVar3 = FUN_000598c0(*piVar2);
  return uVar3;
}




void FUN_0005702c(FILE *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int *piVar2;
  undefined4 extraout_r1;
  undefined4 extraout_r2;
  
  iVar1 = fflush(param_1);
  if (iVar1 == 0) {
    return;
  }
  piVar2 = __errno_location();
  FUN_000598c0(*piVar2,extraout_r1,extraout_r2,param_4);
  return;
}




void FUN_00057070(char *param_1,char *param_2,size_t param_3,undefined4 param_4)

{
  char *pcVar1;
  char *__format;
  bool bVar2;
  
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/strerror.c",0x37,0,"buf != ((void *)0)");
  }
  if (DAT_000c9c7c == 0) {
    DAT_000c9c7c = 1;
    DAT_000c9c80 = 1;
  }
  else {
    bVar2 = DAT_000c9c80 != 0;
    DAT_000c9c80 = DAT_000c9c80 + 1;
    if (bVar2) {
      FUN_000516d8("./../lib/isc/unix/strerror.c",0x3b,"((*((&isc_strerror_lock)))++ == 0 ? 0 : 34) == 0");
    }
  }
  pcVar1 = strerror((int)param_1);
  if (pcVar1 == (char *)0x0) {
    __format = "Unknown error: %u";
  }
  else {
    __format = "%s";
    param_1 = pcVar1;
  }
  snprintf(param_2,param_3,__format,param_1);
  DAT_000c9c80 = DAT_000c9c80 + -1;
  if (DAT_000c9c80 != 0) {
    FUN_000516d8("./../lib/isc/unix/strerror.c",0x41,"(--(*((&isc_strerror_lock))) == 0 ? 0 : 34) == 0",param_4);
    return;
  }
  return;
}




void FUN_00057154(undefined4 *param_1,undefined4 param_2,uint param_3)

{
  if (param_1 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x5a,0,"i != ((void *)0)");
  }
  if (999999999 < param_3) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x5b,0,"nanoseconds < 1000000000");
  }
  *param_1 = param_2;
  param_1[1] = param_3;
  return;
}




int FUN_000571d0(int *param_1)

{
  int iVar1;
  
  if (param_1 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",99,0,"i != ((void *)0)");
  }
  if (999999999 < (uint)param_1[1]) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",100,2,"i->nanoseconds < 1000000000");
  }
  if (*param_1 == 0) {
    iVar1 = 1 - param_1[1];
    if (1 < (uint)param_1[1]) {
      iVar1 = 0;
    }
    return iVar1;
  }
  return 0;
}




void FUN_00057264(undefined4 *param_1,undefined4 param_2,uint param_3)

{
  if (param_1 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x76,0,"t != ((void *)0)");
  }
  if (999999999 < param_3) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x77,0,"nanoseconds < 1000000000");
  }
  *param_1 = param_2;
  param_1[1] = param_3;
  return;
}




void FUN_000572e0(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x7f,0,"t != ((void *)0)");
  }
  *param_1 = 0;
  param_1[1] = 0;
  return;
}




int FUN_00057328(int *param_1)

{
  int iVar1;
  
  if (param_1 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x87,0,"t != ((void *)0)");
  }
  if (999999999 < (uint)param_1[1]) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x88,2,"t->nanoseconds < 1000000000");
  }
  if (*param_1 == 0) {
    iVar1 = 1 - param_1[1];
    if (1 < (uint)param_1[1]) {
      iVar1 = 0;
    }
    return iVar1;
  }
  return 0;
}




void FUN_000573bc(int *param_1)

{
  int iVar1;
  int *piVar2;
  timeval local_90;
  undefined1 auStack_88 [128];
  
  if (param_1 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x96,0,"t != ((void *)0)");
  }
  iVar1 = gettimeofday(&local_90,(__timezone_ptr_t)0x0);
  if (iVar1 == -1) {
    piVar2 = __errno_location();
    FUN_00057070(*piVar2,auStack_88,0x80);
    FUN_0005166c("./../lib/isc/unix/time.c",0x9a,"%s",auStack_88);
    return;
  }
  if (local_90.tv_usec < 0) {
    do {
      local_90.tv_sec = local_90.tv_sec + -1;
      local_90.tv_usec = local_90.tv_usec + 1000000;
    } while (local_90.tv_usec < 0);
  }
  else {
    if (local_90.tv_usec < 1000000) goto LAB_0005742c;
    do {
      local_90.tv_sec = local_90.tv_sec + 1;
      local_90.tv_usec = local_90.tv_usec + -1000000;
    } while (999999 < local_90.tv_usec);
  }
  syslog(3,"gettimeofday returned bad tv_usec: corrected");
LAB_0005742c:
  if (-1 < local_90.tv_sec) {
    *param_1 = local_90.tv_sec;
    param_1[1] = local_90.tv_usec * 1000;
  }
  return;
}




void FUN_000574dc(int *param_1,uint *param_2)

{
  int iVar1;
  int *piVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  timeval local_a0;
  undefined1 auStack_98 [132];
  
  if (param_1 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0xc0,0,"t != ((void *)0)");
  }
  if (param_2 == (uint *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0xc1,0,"i != ((void *)0)");
  }
  if (999999999 < param_2[1]) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0xc2,2,"i->nanoseconds < 1000000000");
  }
  iVar1 = gettimeofday(&local_a0,(__timezone_ptr_t)0x0);
  if (iVar1 == -1) {
    piVar2 = __errno_location();
    FUN_00057070(*piVar2,auStack_98,0x80);
    FUN_0005166c("./../lib/isc/unix/time.c",0xc6,"%s",auStack_98);
    return;
  }
  if (local_a0.tv_usec < 0) {
    do {
      local_a0.tv_sec = local_a0.tv_sec - 1;
      local_a0.tv_usec = local_a0.tv_usec + 1000000;
    } while (local_a0.tv_usec < 0);
  }
  else {
    if (local_a0.tv_usec < 1000000) goto LAB_0005756c;
    do {
      local_a0.tv_sec = local_a0.tv_sec + 1;
      local_a0.tv_usec = local_a0.tv_usec + -1000000;
    } while (999999 < local_a0.tv_usec);
  }
  syslog(3,"gettimeofday returned bad tv_usec: corrected");
LAB_0005756c:
  if ((-1 < local_a0.tv_sec) &&
     ((uVar4 = *param_2, -1 < (int)uVar4 || ((int)((local_a0.tv_sec >> 0x1f) + (uint)CARRY4(uVar4,local_a0.tv_sec)) < 1)
      ))) {
    uVar5 = param_2[1];
    *param_1 = local_a0.tv_sec + uVar4;
    uVar3 = local_a0.tv_usec * 1000 + uVar5;
    if (999999999 < uVar3) {
      *param_1 = local_a0.tv_sec + uVar4 + 1;
      uVar5 = 0xc4653600;
    }
    param_1[1] = uVar3;
    if (999999999 < uVar3) {
      param_1[1] = uVar3 + uVar5;
    }
  }
  return;
}




uint FUN_000576c8(uint *param_1,uint *param_2,undefined4 param_3,undefined4 param_4)

{
  if (param_2 == (uint *)0x0 || param_1 == (uint *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0xf0,0,"t1 != ((void *)0) && t2 != ((void *)0)",param_4);
  }
  if ((999999999 < param_1[1]) || (999999999 < param_2[1])) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0xf1,2,"t1->nanoseconds < 1000000000 && t2->nanoseconds < 1000000000");
  }
  if (*param_2 <= *param_1) {
    if (*param_2 < *param_1) {
      return 1;
    }
    if (param_2[1] <= param_1[1]) {
      return (uint)(param_2[1] < param_1[1]);
    }
  }
  return 0xffffffff;
}




undefined4 FUN_000578bc(uint *param_1,uint *param_2,int *param_3)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  bool bVar5;
  
  if ((param_2 == (uint *)0x0 || param_1 == (uint *)0x0) || (param_3 == (int *)0x0)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x11c,0,"t != ((void *)0) && i != ((void *)0) && result != ((void *)0)");
  }
  if ((param_1[1] < 1000000000) && (param_2[1] < 1000000000)) {
    uVar3 = *param_1;
    uVar4 = *param_2;
    bVar5 = uVar3 == uVar4;
    if (uVar3 < uVar4) {
      return 0x29;
    }
  }
  else {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x11d,2,"t->nanoseconds < 1000000000 && i->nanoseconds < 1000000000");
    uVar3 = *param_1;
    uVar4 = *param_2;
    bVar5 = uVar3 == uVar4;
    if (uVar3 < uVar4) {
      return 0x29;
    }
  }
  uVar2 = param_1[1];
  if (bVar5) {
    uVar1 = param_2[1];
    if (uVar2 < uVar1) {
      return 0x29;
    }
    *param_3 = 0;
  }
  else {
    uVar1 = param_2[1];
    *param_3 = uVar3 - uVar4;
    if (uVar2 < uVar1) {
      *param_3 = (uVar3 - uVar4) + -1;
      param_3[1] = (uVar2 + 1000000000) - uVar1;
      return 0;
    }
  }
  param_3[1] = uVar2 - uVar1;
  return 0;
}




undefined4 FUN_00057abc(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x149,0,"t != ((void *)0)");
  }
  if (999999999 < (uint)param_1[1]) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x14a,2,"t->nanoseconds < 1000000000");
  }
  return *param_1;
}




undefined4 FUN_00057b30(int *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  undefined4 uVar1;
  
  if (param_1 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x154,0,"t != ((void *)0)",param_4);
  }
  if (999999999 < (uint)param_1[1]) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x155,2,"t->nanoseconds < 1000000000");
  }
  if (*param_1 < 0) {
    uVar1 = 0x29;
  }
  else {
    *param_2 = *param_1;
    uVar1 = 0;
  }
  return uVar1;
}




uint FUN_00057bbc(int param_1)

{
  if (param_1 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x188,0,"t != ((void *)0)");
  }
  if (*(uint *)(param_1 + 4) < 1000000000) {
    return *(uint *)(param_1 + 4);
  }
  (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x18a,1,"t->nanoseconds < 1000000000");
  return *(uint *)(param_1 + 4);
}




void FUN_00057c30(time_t *param_1,char *param_2,size_t param_3)

{
  tm *ptVar1;
  size_t sVar2;
  time_t local_1c;
  
  if (param_3 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x194,0,"len > 0");
    local_1c = *param_1;
    ptVar1 = localtime(&local_1c);
    sVar2 = strftime(param_2,0,"%d-%b-%Y %X",ptVar1);
  }
  else {
    local_1c = *param_1;
    ptVar1 = localtime(&local_1c);
    sVar2 = strftime(param_2,param_3,"%d-%b-%Y %X",ptVar1);
    if (sVar2 < param_3) goto LAB_00057c78;
  }
  (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x198,2,"flen < len");
LAB_00057c78:
  if (sVar2 == 0) {
    snprintf(param_2,param_3,"99-Bad-9999 99:99:99.999");
  }
  else {
    snprintf(param_2 + sVar2,param_3 - sVar2,".%03u",(uint)param_1[1] / 1000000);
  }
  return;
}




void FUN_00057d40(time_t *param_1,char *param_2,size_t param_3)

{
  tm *ptVar1;
  size_t sVar2;
  time_t local_1c [2];
  
  if (param_3 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x1a5,0,"len > 0");
    local_1c[0] = *param_1;
    ptVar1 = gmtime(local_1c);
    strftime(param_2,0,"%a, %d %b %Y %H:%M:%S GMT",ptVar1);
  }
  else {
    local_1c[0] = *param_1;
    ptVar1 = gmtime(local_1c);
    sVar2 = strftime(param_2,param_3,"%a, %d %b %Y %H:%M:%S GMT",ptVar1);
    if (sVar2 < param_3) {
      return;
    }
  }
  (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x1a9,2,"flen < len");
  return;
}




void FUN_00057e00(time_t *param_1,char *param_2,size_t param_3)

{
  tm *ptVar1;
  size_t sVar2;
  time_t local_1c [2];
  
  if (param_3 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x1b1,0,"len > 0");
    local_1c[0] = *param_1;
    ptVar1 = gmtime(local_1c);
    strftime(param_2,0,"%Y-%m-%dT%H:%M:%SZ",ptVar1);
  }
  else {
    local_1c[0] = *param_1;
    ptVar1 = gmtime(local_1c);
    sVar2 = strftime(param_2,param_3,"%Y-%m-%dT%H:%M:%SZ",ptVar1);
    if (sVar2 < param_3) {
      return;
    }
  }
  (*DAT_0007c9fc)("./../lib/isc/unix/time.c",0x1b5,2,"flen < len");
  return;
}




int FUN_00057ec0(int param_1)

{
  int *piVar1;
  int *piVar2;
  
  piVar2 = &DAT_0007cb5c;
  if (DAT_0007cb5c == -1) {
    return 0;
  }
  if (DAT_0007cb5c != param_1) {
    piVar1 = &DAT_0007cb68;
    do {
      piVar2 = piVar1;
      if (*piVar2 == -1) {
        return 0;
      }
      piVar1 = piVar2 + 3;
    } while (*piVar2 != param_1);
  }
  return piVar2[2];
}




char * FUN_00057f14(void)

{
  int iVar1;
  int iVar2;
  tm *ptVar3;
  int iVar4;
  char *__s;
  time_t local_14 [2];
  
  local_14[0] = time((time_t *)0x0);
  ptVar3 = localtime(local_14);
  if (ptVar3 == (tm *)0x0) {
    __s = "-- --- --:--:--";
  }
  else {
    if (DAT_000c9af4 == 0) {
      FUN_0004f7c0();
    }
    iVar2 = DAT_000cb86c;
    iVar4 = DAT_000cb86c + 1;
    iVar1 = DAT_000cb86c + -0xc6;
    if (iVar4 < 200) {
      DAT_000cb86c = iVar4;
    }
    __s = &DAT_000cb870 + iVar2 * 0x50;
    if (iVar4 != 199 && iVar1 < 0 == SBORROW4(iVar4,199)) {
      DAT_000cb86c = 0;
    }
    memset(__s,0,0x50);
    snprintf(__s,0x50,"%2d %s %02d:%02d:%02d",ptVar3->tm_mday,(&PTR_DAT_0007be70)[ptVar3->tm_mon],ptVar3->tm_hour,
             ptVar3->tm_min,ptVar3->tm_sec);
  }
  return __s;
}




void FUN_00057ff4(undefined4 *param_1,undefined4 param_2,undefined4 param_3)

{
  if (param_1 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x25,0,"b != ((void *)0)");
  }
  param_1[1] = param_2;
  param_1[2] = param_3;
  *param_1 = 0x42756621;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  param_1[8] = 0;
  param_1[6] = 0xffffffff;
  param_1[7] = 0xffffffff;
  return;
}




void FUN_00058130(int *param_1)

{
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x4d,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  if (param_1[6] != -1) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x4e,0,"!((void *)((b)->link.prev) != (void *)(-1))");
  }
  if (param_1[8] != 0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x4f,0,"b->mctx == ((void *)0)");
  }
  *param_1 = 0;
  param_1[1] = 0;
  param_1[2] = 0;
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  return;
}




void FUN_000581f0(int *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x5a,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  if (param_2 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x5b,0,"r != ((void *)0)");
  }
  iVar1 = param_1[2];
  *param_2 = param_1[1];
  param_2[1] = iVar1;
  return;
}




void FUN_00058274(int *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x66,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  if (param_2 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x67,0,"r != ((void *)0)");
  }
  iVar1 = param_1[3];
  *param_2 = param_1[1];
  param_2[1] = iVar1;
  return;
}




void FUN_000582fc(int *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x72,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  if (param_2 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x73,0,"r != ((void *)0)");
  }
  iVar1 = param_1[2];
  iVar2 = param_1[3];
  *param_2 = param_1[1] + iVar2;
  param_2[1] = iVar1 - iVar2;
  return;
}




void FUN_0005838c(int *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x7e,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  uVar1 = param_2 + param_1[3];
  if ((uint)param_1[2] < uVar1) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x7f,0,"b->used + n <= b->length");
    uVar1 = param_2 + param_1[3];
  }
  param_1[3] = uVar1;
  return;
}




void FUN_0005841c(int *param_1,uint param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x8a,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  uVar1 = param_1[3];
  if (uVar1 < param_2) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x8b,0,"b->used >= n");
    uVar1 = param_1[3];
  }
  uVar1 = uVar1 - param_2;
  param_1[3] = uVar1;
  if (uVar1 < (uint)param_1[4]) {
    param_1[4] = uVar1;
  }
  if (uVar1 < (uint)param_1[5]) {
    param_1[5] = uVar1;
  }
  return;
}




void FUN_000584c0(int *param_1)

{
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x96,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  param_1[3] = 0;
  param_1[4] = 0;
  param_1[5] = 0;
  return;
}




void FUN_0005851c(int *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xa1,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  if (param_2 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xa2,0,"r != ((void *)0)");
  }
  iVar1 = param_1[4];
  *param_2 = param_1[1];
  param_2[1] = iVar1;
  return;
}




void FUN_000585a4(int *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xad,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  if (param_2 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xae,0,"r != ((void *)0)");
  }
  iVar2 = param_1[4];
  iVar1 = param_1[3];
  *param_2 = param_1[1] + iVar2;
  param_2[1] = iVar1 - iVar2;
  return;
}




void FUN_0005863c(int *param_1,int *param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  uint uVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xb9,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  if (param_2 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xba,0,"r != ((void *)0)");
  }
  uVar2 = param_1[4];
  if (uVar2 < (uint)param_1[5]) {
    iVar1 = param_1[1];
    param_2[1] = param_1[5] - uVar2;
    *param_2 = iVar1 + uVar2;
  }
  else {
    *param_2 = 0;
    param_2[1] = 0;
  }
  return;
}




void FUN_000586e4(int *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xc5,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  uVar1 = param_2 + param_1[4];
  if ((uint)param_1[3] < uVar1) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xc6,0,"b->current + n <= b->used");
    uVar1 = param_2 + param_1[4];
  }
  param_1[5] = uVar1;
  return;
}




void FUN_00058774(int *param_1)

{
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xd1,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  param_1[4] = 0;
  return;
}




void FUN_000587c8(int *param_1,int param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xdc,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  uVar1 = param_2 + param_1[4];
  if ((uint)param_1[3] < uVar1) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xdd,0,"b->current + n <= b->used");
    uVar1 = param_2 + param_1[4];
  }
  param_1[4] = uVar1;
  return;
}




void FUN_00058858(int *param_1,uint param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xe8,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  uVar1 = param_1[4];
  if (uVar1 < param_2) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xe9,0,"n <= b->current");
    uVar1 = param_1[4];
  }
  param_1[4] = uVar1 - param_2;
  return;
}




void FUN_000588e0(int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  size_t __n;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0xf9,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  __n = param_1[3] - param_1[4];
  memmove((void *)param_1[1],(void *)(param_1[1] + param_1[4]),__n);
  param_1[3] = __n;
  if ((uint)param_1[4] < (uint)param_1[5]) {
    iVar1 = param_1[5] - param_1[4];
  }
  else {
    iVar1 = 0;
  }
  param_1[5] = iVar1;
  param_1[4] = 0;
  return;
}




undefined1 FUN_0005896c(int *param_1)

{
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x110,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  iVar1 = param_1[4];
  if (param_1[3] == iVar1) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x111,0,"b->used - b->current >= 1");
    iVar1 = param_1[4];
  }
  param_1[4] = iVar1 + 1;
  return *(undefined1 *)(param_1[1] + iVar1);
}




void FUN_00058a00(int *param_1,undefined1 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  int iVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x11c,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  iVar2 = param_1[3];
  uVar1 = iVar2 + 1;
  if ((uint)param_1[2] < uVar1) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x11d,0,"b->used + 1 <= b->length");
    iVar2 = param_1[3];
    uVar1 = iVar2 + 1;
  }
  param_1[3] = uVar1;
  *(undefined1 *)(param_1[1] + iVar2) = param_2;
  return;
}




undefined2 FUN_00058a98(int *param_1)

{
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",300,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  iVar1 = param_1[4];
  if ((uint)(param_1[3] - iVar1) < 2) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x12d,0,"b->used - b->current >= 2");
    iVar1 = param_1[4];
  }
  param_1[4] = iVar1 + 2;
  return CONCAT11(*(undefined1 *)(param_1[1] + iVar1),*(undefined1 *)(param_1[1] + iVar1 + 1));
}




void FUN_00058b3c(int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  uint uVar2;
  int iVar3;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x139,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  iVar3 = param_1[3];
  uVar2 = iVar3 + 2;
  if ((uint)param_1[2] < uVar2) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x13a,0,"b->used + 2 <= b->length");
    iVar3 = param_1[3];
    uVar2 = iVar3 + 2;
  }
  iVar1 = param_1[1];
  param_1[3] = uVar2;
  *(char *)(iVar1 + iVar3) = (char)((uint)param_2 >> 8);
  *(char *)(iVar1 + iVar3 + 1) = (char)param_2;
  return;
}




void FUN_00058be0(int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x141,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  iVar3 = param_1[3];
  uVar1 = iVar3 + 3;
  if ((uint)param_1[2] < uVar1) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x142,0,"b->used + 3 <= b->length");
    iVar3 = param_1[3];
    uVar1 = iVar3 + 3;
  }
  param_1[3] = uVar1;
  iVar2 = param_1[1] + iVar3;
  *(char *)(param_1[1] + iVar3) = (char)((uint)param_2 >> 0x10);
  *(char *)(iVar2 + 2) = (char)param_2;
  *(char *)(iVar2 + 1) = (char)((uint)param_2 >> 8);
  return;
}




uint FUN_00058c8c(int *param_1)

{
  int iVar1;
  int iVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x151,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  iVar2 = param_1[4];
  if ((uint)(param_1[3] - iVar2) < 4) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x152,0,"b->used - b->current >= 4");
    iVar2 = param_1[4];
  }
  param_1[4] = iVar2 + 4;
  iVar1 = param_1[1] + iVar2;
  return (uint)*(byte *)(iVar1 + 1) << 0x10 | (uint)*(byte *)(param_1[1] + iVar2) << 0x18 | (uint)*(byte *)(iVar1 + 3) |
         (uint)*(byte *)(iVar1 + 2) << 8;
}




void FUN_00058d40(int *param_1,undefined4 param_2)

{
  uint uVar1;
  int iVar2;
  int iVar3;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x160,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  iVar3 = param_1[3];
  uVar1 = iVar3 + 4;
  if ((uint)param_1[2] < uVar1) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x161,0,"b->used + 4 <= b->length");
    iVar3 = param_1[3];
    uVar1 = iVar3 + 4;
  }
  param_1[3] = uVar1;
  iVar2 = param_1[1] + iVar3;
  *(char *)(param_1[1] + iVar3) = (char)((uint)param_2 >> 0x18);
  *(char *)(iVar2 + 3) = (char)param_2;
  *(char *)(iVar2 + 1) = (char)((uint)param_2 >> 0x10);
  *(char *)(iVar2 + 2) = (char)((uint)param_2 >> 8);
  return;
}




undefined8 FUN_00058df4(int *param_1)

{
  int iVar1;
  int iVar2;
  ulonglong uVar3;
  ulonglong uVar4;
  ulonglong uVar5;
  ulonglong uVar6;
  ulonglong uVar7;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x170,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  iVar1 = param_1[4];
  if ((uint)(param_1[3] - iVar1) < 6) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x171,0,"b->used - b->current >= 6");
    iVar1 = param_1[4];
  }
  param_1[4] = iVar1 + 6;
  iVar2 = param_1[1] + iVar1;
  uVar4 = VectorShiftLeft((ulonglong)*(byte *)(param_1[1] + iVar1),0x28,0x40,0);
  uVar7 = VectorShiftLeft((ulonglong)*(byte *)(iVar2 + 1),0x20,0x40,0);
  uVar6 = VectorShiftLeft((ulonglong)*(byte *)(iVar2 + 2),0x18,0x40,0);
  uVar5 = VectorShiftLeft((ulonglong)*(byte *)(iVar2 + 3),0x10,0x40,0);
  uVar3 = VectorShiftLeft((ulonglong)*(byte *)(iVar2 + 4),8,0x40,0);
  uVar3 = uVar7 | uVar4 | uVar6 | uVar5 | uVar3;
  return CONCAT44((int)(uVar3 >> 0x20),(uint)uVar3 | (uint)*(byte *)(iVar2 + 5));
}




void FUN_00058efc(int *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  int iVar2;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x184,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  iVar1 = param_1[3];
  if ((uint)param_1[2] < iVar1 + 6U) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x185,0,"b->used + 6 <= b->length");
    iVar1 = param_1[3];
  }
  iVar2 = param_1[1];
  param_1[3] = iVar1 + 2;
  *(char *)(iVar2 + iVar1) = (char)((uint)param_4 >> 8);
  *(char *)(iVar2 + iVar1 + 1) = (char)param_4;
  iVar1 = param_1[3];
  param_1[3] = iVar1 + 4;
  iVar2 = param_1[1] + iVar1;
  *(char *)(param_1[1] + iVar1) = (char)((uint)param_3 >> 0x18);
  *(char *)(iVar2 + 3) = (char)param_3;
  *(char *)(iVar2 + 1) = (char)((uint)param_3 >> 0x10);
  *(char *)(iVar2 + 2) = (char)((uint)param_3 >> 8);
  return;
}




void FUN_00058fd4(int *param_1,void *param_2,size_t param_3)

{
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x191,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  iVar1 = param_1[3];
  if ((uint)param_1[2] < param_3 + iVar1) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x192,0,"b->used + length <= b->length");
    iVar1 = param_1[3];
  }
  memcpy((void *)(param_1[1] + iVar1),param_2,param_3);
  param_1[3] = param_1[3] + param_3;
  return;
}




void FUN_00059080(int *param_1,char *param_2)

{
  size_t __n;
  int iVar1;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x19c,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))");
  }
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x19d,0,"source != ((void *)0)");
  }
  __n = strlen(param_2);
  iVar1 = param_1[3];
  if ((uint)(param_1[2] - iVar1) < __n) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x1a4,0,"l <= ((b)->length - (b)->used)");
    iVar1 = param_1[3];
  }
  memcpy((void *)(param_1[1] + iVar1),param_2,__n);
  param_1[3] = param_1[3] + __n;
  return;
}




undefined4 FUN_00059160(int *param_1,undefined4 *param_2,undefined4 param_3,undefined4 param_4)

{
  if ((param_1 == (int *)0x0) || (*param_1 != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x1b0,0,
                    "(((b) != ((void *)0)) && (((const isc__magic_t *)(b))->magic == (0x42756621U)))",param_4);
  }
  if (param_2 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x1b1,0,"r != ((void *)0)");
  }
  if ((uint)(param_1[2] - param_1[3]) < (uint)param_2[1]) {
    return 0x13;
  }
  memcpy((void *)(param_1[1] + param_1[3]),(void *)*param_2,param_2[1]);
  param_1[3] = param_1[3] + param_2[1];
  return 0;
}




undefined4 FUN_00059220(undefined4 param_1,int *param_2,int param_3)

{
  undefined4 *puVar1;
  
  if (param_2 == (int *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x1c6,0,"dynbuffer != ((void *)0)");
  }
  if (*param_2 != 0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x1c7,0,"*dynbuffer == ((void *)0)");
  }
  puVar1 = (undefined4 *)FUN_0004f524(param_3 + 0x24);
  if (puVar1 != (undefined4 *)0x0) {
    puVar1[2] = param_3;
    puVar1[8] = param_1;
    puVar1[3] = 0;
    puVar1[4] = 0;
    puVar1[5] = 0;
    *puVar1 = 0x42756621;
    puVar1[1] = puVar1 + 9;
    puVar1[6] = 0xffffffff;
    puVar1[7] = 0xffffffff;
    *param_2 = (int)puVar1;
    return 0;
  }
  return 1;
}




void FUN_000592e8(undefined4 *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int *__ptr;
  
  if (param_1 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x1dc,0,"dynbuffer != ((void *)0)",param_4);
  }
  __ptr = (int *)*param_1;
  if ((__ptr == (int *)0x0) || (*__ptr != 0x42756621)) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x1dd,0,
                    "(((*dynbuffer) != ((void *)0)) && (((const isc__magic_t *)(*dynbuffer))->magic == (0x42756621U)))")
    ;
    __ptr = (int *)*param_1;
  }
  if (__ptr[8] == 0) {
    (*DAT_0007c9fc)("./../lib/isc/buffer.c",0x1de,0,"(*dynbuffer)->mctx != ((void *)0)");
    __ptr = (int *)*param_1;
  }
  *param_1 = 0;
  __ptr[8] = 0;
  FUN_00058130(__ptr);
  free(__ptr);
  return;
}




void FUN_000593b4(undefined4 *param_1)

{
  if (param_1 == (undefined4 *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/dir.c",0x2c,0,"dir != ((void *)0)");
  }
  *(undefined1 *)(param_1 + 0x101) = 0;
  param_1[0x141] = 0;
  *param_1 = 0x4449522a;
  param_1[0x142] = 0;
  return;
}




undefined4 FUN_0005940c(int *param_1,char *param_2)

{
  size_t sVar1;
  DIR *pDVar2;
  undefined4 uVar3;
  int *piVar4;
  
  if ((param_1 == (int *)0x0) || (*param_1 != 0x4449522a)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/dir.c",0x3f,0,
                    "(((dir) != ((void *)0)) && (((const isc__magic_t *)(dir))->magic == (((\'D\') << 24 | (\'I\') << 16 | (\'R\') << 8 | (\'*\')))))"
                   );
  }
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/dir.c",0x40,0,"dirname != ((void *)0)");
  }
  sVar1 = strlen(param_2);
  if (0x400 < sVar1 + 3) {
    return 0x13;
  }
  memcpy(param_1 + 1,param_2,sVar1 + 1);
  piVar4 = (int *)((int)param_1 + sVar1 + 4);
  if ((param_1 + 1 < piVar4) && (*(char *)((int)param_1 + sVar1 + 3) != '/')) {
    piVar4 = (int *)((int)param_1 + sVar1 + 5);
    *(undefined1 *)((int)param_1 + sVar1 + 4) = 0x2f;
  }
  *(undefined1 *)piVar4 = 0x2a;
  *(undefined1 *)((int)piVar4 + 1) = 0;
  pDVar2 = opendir(param_2);
  param_1[0x142] = (int)pDVar2;
  if (pDVar2 == (DIR *)0x0) {
    piVar4 = __errno_location();
    uVar3 = FUN_000598c0(*piVar4);
    return uVar3;
  }
  return 0;
}




undefined4 FUN_00059518(int *param_1)

{
  DIR *__dirp;
  dirent *pdVar1;
  size_t sVar2;
  
  if (((param_1 == (int *)0x0) || (*param_1 != 0x4449522a)) || (__dirp = (DIR *)param_1[0x142], __dirp == (DIR *)0x0)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/dir.c",0x6a,0,
                    "(((dir) != ((void *)0)) && (((const isc__magic_t *)(dir))->magic == (((\'D\') << 24 | (\'I\') << 16 | (\'R\') << 8 | (\'*\'))))) && dir->handle != ((void *)0)"
                   );
    __dirp = (DIR *)param_1[0x142];
  }
  pdVar1 = readdir(__dirp);
  if (pdVar1 != (dirent *)0x0) {
    sVar2 = strlen(pdVar1->d_name);
    if (sVar2 < 0x100) {
      memcpy(param_1 + 0x101,pdVar1->d_name,sVar2 + 1);
      param_1[0x141] = sVar2;
      return 0;
    }
    return 0x22;
  }
  return 0x1d;
}




void FUN_000595c8(int *param_1)

{
  DIR *__dirp;
  
  if (((param_1 == (int *)0x0) || (*param_1 != 0x4449522a)) || (__dirp = (DIR *)param_1[0x142], __dirp == (DIR *)0x0)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/dir.c",0x89,0,
                    "(((dir) != ((void *)0)) && (((const isc__magic_t *)(dir))->magic == (((\'D\') << 24 | (\'I\') << 16 | (\'R\') << 8 | (\'*\'))))) && dir->handle != ((void *)0)"
                   );
    __dirp = (DIR *)param_1[0x142];
  }
  closedir(__dirp);
  param_1[0x142] = 0;
  return;
}




undefined4 FUN_00059634(int *param_1)

{
  DIR *__dirp;
  
  if (((param_1 == (int *)0x0) || (*param_1 != 0x4449522a)) || (__dirp = (DIR *)param_1[0x142], __dirp == (DIR *)0x0)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/dir.c",0x94,0,
                    "(((dir) != ((void *)0)) && (((const isc__magic_t *)(dir))->magic == (((\'D\') << 24 | (\'I\') << 16 | (\'R\') << 8 | (\'*\'))))) && dir->handle != ((void *)0)"
                   );
    __dirp = (DIR *)param_1[0x142];
  }
  rewinddir(__dirp);
  return 0;
}




undefined4 FUN_0005969c(char *param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/dir.c",0xa1,0,"dirname != ((void *)0)");
  }
  iVar1 = chdir(param_1);
  if (-1 < iVar1) {
    return 0;
  }
  piVar2 = __errno_location();
  uVar3 = FUN_000598c0(*piVar2);
  return uVar3;
}




undefined4 FUN_0005973c(char *param_1)

{
  int iVar1;
  size_t sVar2;
  int *piVar3;
  ushort **ppuVar4;
  undefined4 uVar5;
  char *pcVar6;
  byte *pbVar7;
  uint uVar8;
  char *pcVar9;
  char *pcVar10;
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/dir.c",0xc0,0,"templet != ((void *)0)");
    iVar1 = getpid();
    sVar2 = strlen((char *)0x0);
    pcVar9 = (char *)(sVar2 - 1);
    pcVar10 = pcVar9;
    if (*(char *)(sVar2 - 1) != 'X') goto LAB_000597c0;
  }
  else {
    iVar1 = getpid();
    sVar2 = strlen(param_1);
    pcVar9 = param_1 + (sVar2 - 1);
    if ((param_1[sVar2 - 1] != 'X') || (pcVar10 = pcVar9, pcVar9 < param_1)) goto LAB_000597c0;
  }
  do {
    pcVar6 = pcVar9 + -1;
    *pcVar9 = (char)iVar1 + (char)(iVar1 / 10) * -10 + '0';
    pcVar9 = pcVar6;
    if (pcVar10[-1] != 'X') break;
    iVar1 = iVar1 / 10;
    pcVar10 = pcVar10 + -1;
  } while (param_1 <= pcVar6);
LAB_000597c0:
LAB_000597c8:
  do {
    iVar1 = mkdir(param_1,0x1c0);
    if (iVar1 == 0) {
      return 0;
    }
    piVar3 = __errno_location();
    if (*piVar3 != 0x11) goto LAB_0005983c;
    uVar8 = (uint)(byte)pcVar9[1];
    if (uVar8 == 0) {
LAB_00059834:
      *piVar3 = 0x11;
LAB_0005983c:
      if (iVar1 != -1) {
        return 0;
      }
      uVar5 = FUN_000598c0(*piVar3);
      return uVar5;
    }
    ppuVar4 = __ctype_b_loc();
    pbVar7 = (byte *)(pcVar9 + 1);
    while (((*ppuVar4)[uVar8] & 0x800) == 0) {
      if (uVar8 != 0x7a) {
        *pbVar7 = (byte)(uVar8 + 1);
        if ((uVar8 + 1 & 0xff) == 0) goto LAB_00059834;
        goto LAB_000597c8;
      }
      *pbVar7 = 0x61;
      pbVar7 = pbVar7 + 1;
      uVar8 = (uint)*pbVar7;
      if (uVar8 == 0) goto LAB_00059834;
    }
    *pbVar7 = 0x61;
  } while( true );
}




undefined4 FUN_000598c0(undefined4 param_1)

{
  undefined4 uVar1;
  undefined1 auStack_90 [132];
  
  switch(param_1) {
  case 1:
  case 0xd:
    uVar1 = 6;
    break;
  case 2:
    uVar1 = 0x26;
    break;
  default:
    FUN_00057070(param_1,auStack_90,0x80);
    FUN_0005166c("./../lib/isc/unix/errno2result.c",0x6f,"unable to convert errno to isc_result: %d: %s",param_1,
                 auStack_90);
    uVar1 = 0x22;
    break;
  case 5:
    uVar1 = 0x1a;
    break;
  case 9:
  case 0x14:
  case 0x16:
  case 0x24:
  case 0x28:
    uVar1 = 0x1e;
    break;
  case 0xc:
    uVar1 = 1;
    break;
  case 0x11:
    uVar1 = 0x27;
    break;
  case 0x17:
  case 0x18:
    uVar1 = 0x32;
    break;
  case 0x20:
  case 0x67:
  case 0x68:
    uVar1 = 0x36;
    break;
  case 0x61:
    uVar1 = 0x30;
    break;
  case 0x62:
    uVar1 = 5;
    break;
  case 99:
    uVar1 = 4;
    break;
  case 100:
    uVar1 = 10;
    break;
  case 0x65:
    uVar1 = 8;
    break;
  case 0x69:
    uVar1 = 0xd;
    break;
  case 0x6b:
    uVar1 = 0x28;
    break;
  case 0x6e:
    uVar1 = 2;
    break;
  case 0x6f:
    uVar1 = 0xc;
    break;
  case 0x70:
    uVar1 = 0xb;
    break;
  case 0x71:
    uVar1 = 9;
  }
  return uVar1;
}




void FUN_00059b74(char *param_1,stat *param_2)

{
  int iVar1;
  int *piVar2;
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x5a,0,"file != ((void *)0)");
  }
  if (param_2 == (stat *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x5b,0,"stats != ((void *)0)");
  }
  iVar1 = __xstat(3,param_1,param_2);
  if (iVar1 == 0) {
    return;
  }
  piVar2 = __errno_location();
  FUN_000598c0(*piVar2);
  return;
}




int FUN_00059c04(int param_1,int param_2)

{
  int iVar1;
  undefined1 auStack_68 [64];
  undefined4 local_28;
  
  if (param_1 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x68,0,"file != ((void *)0)");
  }
  if (param_2 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x69,0,"time != ((void *)0)");
  }
  iVar1 = FUN_00059b74(param_1,auStack_68);
  if (iVar1 == 0) {
    FUN_00057264(param_2,local_28,0);
  }
  return iVar1;
}




undefined4 FUN_00059d5c(char *param_1,char *param_2,char *param_3,char *param_4)

{
  char *pcVar1;
  size_t sVar2;
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0xac,0,"path != ((void *)0)");
  }
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0xad,0,"templet != ((void *)0)");
  }
  if (param_3 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0xae,0,"buf != ((void *)0)");
  }
  pcVar1 = strrchr(param_2,0x2f);
  if (pcVar1 != (char *)0x0) {
    param_2 = pcVar1 + 1;
  }
  pcVar1 = strrchr(param_1,0x2f);
  if (pcVar1 == (char *)0x0) {
    sVar2 = strlen(param_2);
    if ((char *)(sVar2 + 1) <= param_4) {
      memcpy(param_3,param_2,sVar2 + 1);
      return 0;
    }
  }
  else {
    sVar2 = strlen(param_2);
    if (pcVar1 + sVar2 + (2 - (int)param_1) <= param_4) {
      strncpy(param_3,param_1,(size_t)(pcVar1 + (1 - (int)param_1)));
      param_3[(int)(pcVar1 + (1 - (int)param_1))] = '\0';
      strcat(param_3,param_2);
      return 0;
    }
  }
  return 0x13;
}




undefined4 FUN_00059eac(char *param_1,byte *param_2)

{
  byte bVar1;
  int iVar2;
  int *piVar3;
  char *pcVar4;
  undefined4 uVar5;
  byte *extraout_r1;
  byte *extraout_r1_00;
  byte *pbVar6;
  byte *pbVar7;
  byte *pbVar8;
  uint local_24 [2];
  
  pbVar8 = param_2;
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0xd0,0,"file != ((void *)0)");
    pbVar8 = extraout_r1;
  }
  if (param_2 == (byte *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0xd1,0,"templet != ((void *)0)");
    pbVar8 = extraout_r1_00;
  }
  pbVar7 = param_2;
  if (*param_2 != 0) {
    do {
      pbVar6 = pbVar7;
      pbVar7 = pbVar6 + 1;
    } while (pbVar6[1] != 0);
    if (param_2 != pbVar7) {
      if (param_2 <= pbVar6) {
        bVar1 = *pbVar6;
        while (bVar1 == 0x58) {
          FUN_0005a788(local_24,pbVar8);
          pbVar8 = (byte *)((local_24[0] >> 1) * -0x7bdef7bd);
          *pbVar6 = s_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdef_0007cd84[local_24[0] + ((local_24[0] >> 1) / 0x1f) * -0x3e];
          pbVar7 = pbVar6;
          if (pbVar6 == param_2) break;
          bVar1 = pbVar6[-1];
          pbVar6 = pbVar6 + -1;
        }
      }
      do {
        iVar2 = link(param_1,(char *)param_2);
        if (iVar2 != -1) {
          iVar2 = unlink(param_1);
          if ((-1 < iVar2) || (piVar3 = __errno_location(), *piVar3 == 2)) {
            return 0;
          }
LAB_0005a02c:
          uVar5 = FUN_000598c0();
          return uVar5;
        }
        piVar3 = __errno_location();
        if (*piVar3 != 0x11) goto LAB_0005a02c;
        bVar1 = *pbVar7;
        pbVar8 = pbVar7;
        while( true ) {
          if (bVar1 == 0) {
            return 0x19;
          }
          pcVar4 = strchr(s_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdef_0007cd84,(uint)bVar1);
          if ((pcVar4 != (char *)0x0) && (pcVar4[1] != 0)) break;
          *pbVar8 = s_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdef_0007cd84[0];
          pbVar8 = pbVar8 + 1;
          bVar1 = *pbVar8;
        }
        *pbVar8 = pcVar4[1];
      } while( true );
    }
  }
  return 0x19;
}




undefined4 FUN_0005a060(byte *param_1,int *param_2)

{
  byte bVar1;
  int __fd;
  int *piVar2;
  char *pcVar3;
  FILE *pFVar4;
  int iVar5;
  undefined4 uVar6;
  int *extraout_r1;
  int *extraout_r1_00;
  byte *pbVar7;
  byte *pbVar8;
  uint local_24 [2];
  
  piVar2 = param_2;
  if (param_1 == (byte *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x100,0,"templet != ((void *)0)");
    piVar2 = extraout_r1_00;
  }
  if ((param_2 == (int *)0x0) || (*param_2 != 0)) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x101,0,"fp != ((void *)0) && *fp == ((void *)0)");
    piVar2 = extraout_r1;
  }
  pbVar7 = param_1;
  if (*param_1 != 0) {
    do {
      pbVar8 = pbVar7;
      pbVar7 = pbVar8 + 1;
    } while (pbVar8[1] != 0);
    if (param_1 != pbVar7) {
      if (param_1 <= pbVar8) {
        bVar1 = *pbVar8;
        while (bVar1 == 0x58) {
          FUN_0005a788(local_24,piVar2);
          piVar2 = (int *)((local_24[0] >> 1) * -0x7bdef7bd);
          *pbVar8 = s_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdef_0007cd84[local_24[0] + ((local_24[0] >> 1) / 0x1f) * -0x3e];
          pbVar7 = pbVar8;
          if (pbVar8 == param_1) break;
          bVar1 = pbVar8[-1];
          pbVar8 = pbVar8 + -1;
        }
      }
      while( true ) {
        __fd = open((char *)param_1,0xc2,0x1b6);
        if (__fd != -1) {
          pFVar4 = fdopen(__fd,"w+");
          if (pFVar4 != (FILE *)0x0) {
            *param_2 = (int)pFVar4;
            return 0;
          }
          piVar2 = __errno_location();
          uVar6 = FUN_000598c0(*piVar2);
          iVar5 = remove((char *)param_1);
          if (iVar5 < 0) {
            FUN_000548c4(DAT_000c9c5c,&DAT_0007ca10,&DAT_0007ca40,0xfffffffc,"remove \'%s\': failed",param_1);
          }
          close(__fd);
          return uVar6;
        }
        piVar2 = __errno_location();
        if (*piVar2 != 0x11) break;
        bVar1 = *pbVar7;
        pbVar8 = pbVar7;
        while( true ) {
          if (bVar1 == 0) {
            return 0x19;
          }
          pcVar3 = strchr(s_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdef_0007cd84,(uint)bVar1);
          if ((pcVar3 != (char *)0x0) && (pcVar3[1] != 0)) break;
          *pbVar8 = s_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdef_0007cd84[0];
          pbVar8 = pbVar8 + 1;
          bVar1 = *pbVar8;
        }
        *pbVar8 = pcVar3[1];
      }
      uVar6 = FUN_000598c0();
      return uVar6;
    }
  }
  return 0x19;
}




void FUN_0005a284(char *param_1)

{
  int iVar1;
  int *piVar2;
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x135,0,"filename != ((void *)0)");
  }
  iVar1 = unlink(param_1);
  if (iVar1 == 0) {
    return;
  }
  piVar2 = __errno_location();
  FUN_000598c0(*piVar2);
  return;
}




void FUN_0005a2dc(char *param_1,char *param_2)

{
  int iVar1;
  int *piVar2;
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x142,0,"oldname != ((void *)0)");
  }
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x143,0,"newname != ((void *)0)");
  }
  iVar1 = rename(param_1,param_2);
  if (iVar1 == 0) {
    return;
  }
  piVar2 = __errno_location();
  FUN_000598c0(*piVar2);
  return;
}




int FUN_0005a368(int param_1)

{
  uint uVar1;
  int iVar2;
  undefined1 auStack_60 [88];
  
  if (param_1 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x150,0,"pathname != ((void *)0)");
  }
  uVar1 = FUN_00059b74(param_1,auStack_60);
  iVar2 = 1 - uVar1;
  if (1 < uVar1) {
    iVar2 = 0;
  }
  return iVar2;
}




bool FUN_0005a3c0(char *param_1)

{
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x157,0,"filename != ((void *)0)");
  }
  return *param_1 == '/';
}




int FUN_0005a40c(char *param_1)

{
  int iVar1;
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x15d,0,"filename != ((void *)0)");
  }
  if (*param_1 != '.') {
    return 0;
  }
  iVar1 = 1 - (uint)(byte)param_1[1];
  if (1 < (byte)param_1[1]) {
    iVar1 = 0;
  }
  return iVar1;
}




int FUN_0005a468(char *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x163,0,"filename != ((void *)0)",param_4);
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x157,0,"filename != ((void *)0)");
  }
  if (*param_1 != '/') {
    iVar1 = FUN_0005a40c(param_1);
    if (iVar1 != 0) {
      iVar1 = 1;
    }
    return iVar1;
  }
  return 1;
}




char * FUN_0005a4e0(char *param_1)

{
  char *pcVar1;
  
  if (param_1 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x16f,0,"filename != ((void *)0)");
  }
  pcVar1 = strrchr(param_1,0x2f);
  if (pcVar1 != (char *)0x0) {
    param_1 = pcVar1 + 1;
  }
  return param_1;
}




undefined4 FUN_0005a534(int param_1,void *param_2,uint param_3)

{
  char *__s;
  size_t sVar1;
  
  if (param_1 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x17d,0,"filename != ((void *)0)");
  }
  if (param_2 == (void *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x17e,0,"buf != ((void *)0)");
  }
  __s = (char *)FUN_0005a4e0(param_1);
  sVar1 = strlen(__s);
  if (param_3 < sVar1 + 1) {
    return 0x13;
  }
  memcpy(param_2,__s,sVar1 + 1);
  return 0;
}




int FUN_0005a5d8(char *param_1,char *param_2,uint param_3,undefined4 param_4)

{
  char *pcVar1;
  size_t sVar2;
  size_t sVar3;
  int *piVar4;
  int iVar5;
  
  if (param_2 == (char *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x195,0,"dirname != ((void *)0)",param_4);
  }
  if (param_3 == 0) {
    (*DAT_0007c9fc)("./../lib/isc/unix/file.c",0x196,0,"length > 0U");
  }
  pcVar1 = getcwd(param_2,param_3);
  if (pcVar1 == (char *)0x0) {
    piVar4 = __errno_location();
    if (*piVar4 == 0x22) {
      return 0x13;
    }
    iVar5 = FUN_000598c0();
    if (iVar5 != 0) {
      return iVar5;
    }
    sVar2 = strlen(param_2);
  }
  else {
    sVar2 = strlen(param_2);
    if (param_3 == sVar2 + 1) {
      return 0x13;
    }
    if (param_2[1] != '\0') {
      (param_2 + sVar2)[0] = '/';
      (param_2 + sVar2)[1] = '\0';
      sVar2 = strlen(param_2);
    }
  }
  sVar3 = strlen(param_1);
  if (param_3 < sVar3 + sVar2 + 1) {
    return 0x13;
  }
  memcpy(param_2 + sVar2,param_1,sVar3 + 1);
  return 0;
}




undefined4 FUN_0005a704(char *param_1,__off_t param_2)

{
  int iVar1;
  int *piVar2;
  undefined4 uVar3;
  
  iVar1 = truncate(param_1,param_2);
  if (-1 < iVar1) {
    return 0;
  }
  piVar2 = __errno_location();
  uVar3 = FUN_000598c0(*piVar2);
  return uVar3;
}




void FUN_0005a72c(void)

{
  uint uVar1;
  uint uVar2;
  
  uVar1 = getpid();
  uVar2 = time((time_t *)0x0);
  srand(uVar2 ^ (uVar1 >> 0x10 | uVar1 << 0x10));
  return;
}




void FUN_0005a74c(uint param_1)

{
  if (DAT_000c9c94 == 0) {
    FUN_0005a72c();
    DAT_000c9c94 = 1;
  }
  srand(param_1);
  return;
}




void FUN_0005a788(uint *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  uint uVar2;
  
  if (param_1 == (uint *)0x0) {
    (*DAT_0007c9fc)("./../lib/isc/random.c",0x4e,0,"val != ((void *)0)",param_4);
  }
  if (DAT_000c9c94 == 0) {
    FUN_0005a72c();
    DAT_000c9c94 = 1;
  }
  iVar1 = rand();
  uVar2 = rand();
  *param_1 = (uint)(iVar1 << 0xc) >> 0x10 | (uVar2 & 0xffff0) << 0xc;
  return;
}




ulonglong FUN_0005a860(uint param_1,uint param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  bool bVar4;
  
  if (param_2 - 1 == 0) {
    return CONCAT44(param_2,param_1);
  }
  if (param_2 == 0) {
    uVar1 = raise(8);
    return (ulonglong)uVar1;
  }
  if (param_1 <= param_2) {
    return CONCAT44(param_2,(uint)(param_1 == param_2));
  }
  if ((param_2 & param_2 - 1) == 0) {
    return CONCAT44(param_2,param_1 >> (0x1fU - LZCOUNT(param_2) & 0xff));
  }
  uVar2 = param_2 << (LZCOUNT(param_2) - LZCOUNT(param_1) & 0xffU);
  uVar1 = 1 << (LZCOUNT(param_2) - LZCOUNT(param_1) & 0xffU);
  uVar3 = 0;
  while( true ) {
    if (uVar2 <= param_1) {
      param_1 = param_1 - uVar2;
      uVar3 = uVar3 | uVar1;
    }
    if (uVar2 >> 1 <= param_1) {
      param_1 = param_1 - (uVar2 >> 1);
      uVar3 = uVar3 | uVar1 >> 1;
    }
    if (uVar2 >> 2 <= param_1) {
      param_1 = param_1 - (uVar2 >> 2);
      uVar3 = uVar3 | uVar1 >> 2;
    }
    if (uVar2 >> 3 <= param_1) {
      param_1 = param_1 - (uVar2 >> 3);
      uVar3 = uVar3 | uVar1 >> 3;
    }
    bVar4 = param_1 == 0;
    if (!bVar4) {
      uVar1 = uVar1 >> 4;
      bVar4 = uVar1 == 0;
    }
    if (bVar4) break;
    uVar2 = uVar2 >> 4;
  }
  return CONCAT44(uVar2,uVar3);
}




void FUN_0005a908(undefined4 param_1,int param_2)

{
  if (param_2 != 0) {
    FUN_0005a860();
    return;
  }
  raise(8);
  return;
}




ulonglong FUN_0005a928(uint param_1,uint param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  bool bVar6;
  
  if (param_2 == 0) {
    uVar2 = raise(8);
    return (ulonglong)uVar2;
  }
  uVar5 = param_1 ^ param_2;
  uVar2 = param_2;
  if ((int)param_2 < 0) {
    uVar2 = -param_2;
  }
  if (uVar2 - 1 == 0) {
    if ((int)param_2 < 0) {
      param_1 = -param_1;
    }
    return CONCAT44(uVar2,param_1);
  }
  uVar4 = param_1;
  if ((int)param_1 < 0) {
    uVar4 = -param_1;
  }
  if (uVar4 <= uVar2) {
    if (uVar4 < uVar2) {
      param_1 = 0;
    }
    if (uVar4 == uVar2) {
      param_1 = (int)uVar5 >> 0x1f | 1;
    }
    return CONCAT44(uVar2,param_1);
  }
  if ((uVar2 & uVar2 - 1) == 0) {
    uVar4 = uVar4 >> (0x1fU - LZCOUNT(uVar2) & 0xff);
    if ((int)uVar5 < 0) {
      uVar4 = -uVar4;
    }
    return CONCAT44(uVar2,uVar4);
  }
  uVar3 = uVar2 << (LZCOUNT(uVar2) - LZCOUNT(uVar4) & 0xffU);
  uVar2 = 1 << (LZCOUNT(uVar2) - LZCOUNT(uVar4) & 0xffU);
  uVar1 = 0;
  while( true ) {
    if (uVar3 <= uVar4) {
      uVar4 = uVar4 - uVar3;
      uVar1 = uVar1 | uVar2;
    }
    if (uVar3 >> 1 <= uVar4) {
      uVar4 = uVar4 - (uVar3 >> 1);
      uVar1 = uVar1 | uVar2 >> 1;
    }
    if (uVar3 >> 2 <= uVar4) {
      uVar4 = uVar4 - (uVar3 >> 2);
      uVar1 = uVar1 | uVar2 >> 2;
    }
    if (uVar3 >> 3 <= uVar4) {
      uVar4 = uVar4 - (uVar3 >> 3);
      uVar1 = uVar1 | uVar2 >> 3;
    }
    bVar6 = uVar4 == 0;
    if (!bVar6) {
      uVar2 = uVar2 >> 4;
      bVar6 = uVar2 == 0;
    }
    if (bVar6) break;
    uVar3 = uVar3 >> 4;
  }
  if ((int)uVar5 < 0) {
    uVar1 = -uVar1;
  }
  return CONCAT44(uVar3,uVar1);
}




uint FUN_0005a930(uint param_1,uint param_2)

{
  uint uVar1;
  uint uVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  bool in_NG;
  bool bVar6;
  
  uVar5 = param_1 ^ param_2;
  uVar2 = param_2;
  if (in_NG) {
    uVar2 = -param_2;
  }
  if (uVar2 - 1 == 0) {
    if ((int)param_2 < 0) {
      param_1 = -param_1;
    }
    return param_1;
  }
  uVar4 = param_1;
  if ((int)param_1 < 0) {
    uVar4 = -param_1;
  }
  if (uVar4 <= uVar2) {
    if (uVar4 < uVar2) {
      param_1 = 0;
    }
    if (uVar4 == uVar2) {
      param_1 = (int)uVar5 >> 0x1f | 1;
    }
    return param_1;
  }
  if ((uVar2 & uVar2 - 1) == 0) {
    uVar4 = uVar4 >> (0x1fU - LZCOUNT(uVar2) & 0xff);
    if ((int)uVar5 < 0) {
      uVar4 = -uVar4;
    }
    return uVar4;
  }
  uVar3 = uVar2 << (LZCOUNT(uVar2) - LZCOUNT(uVar4) & 0xffU);
  uVar2 = 1 << (LZCOUNT(uVar2) - LZCOUNT(uVar4) & 0xffU);
  uVar1 = 0;
  while( true ) {
    if (uVar3 <= uVar4) {
      uVar4 = uVar4 - uVar3;
      uVar1 = uVar1 | uVar2;
    }
    if (uVar3 >> 1 <= uVar4) {
      uVar4 = uVar4 - (uVar3 >> 1);
      uVar1 = uVar1 | uVar2 >> 1;
    }
    if (uVar3 >> 2 <= uVar4) {
      uVar4 = uVar4 - (uVar3 >> 2);
      uVar1 = uVar1 | uVar2 >> 2;
    }
    if (uVar3 >> 3 <= uVar4) {
      uVar4 = uVar4 - (uVar3 >> 3);
      uVar1 = uVar1 | uVar2 >> 3;
    }
    bVar6 = uVar4 == 0;
    if (!bVar6) {
      uVar2 = uVar2 >> 4;
      bVar6 = uVar2 == 0;
    }
    if (bVar6) break;
    uVar3 = uVar3 >> 4;
  }
  if ((int)uVar5 < 0) {
    uVar1 = -uVar1;
  }
  return uVar1;
}




void FUN_0005aa04(undefined4 param_1,int param_2)

{
  if (param_2 != 0) {
    FUN_0005a930();
    return;
  }
  raise(8);
  return;
}




void FUN_0005aa70(uint param_1,int param_2,undefined4 param_3,undefined4 param_4,int *param_5)

{
  uint uVar1;
  longlong lVar2;
  
  lVar2 = FUN_0005aae8();
  lVar2 = lVar2 * CONCAT44(param_4,param_3);
  uVar1 = (uint)lVar2;
  *param_5 = param_1 - uVar1;
  param_5[1] = param_2 - ((int)((ulonglong)lVar2 >> 0x20) + (uint)(param_1 < uVar1));
  return;
}




void FUN_0005aaac(uint param_1,int param_2,undefined4 param_3,undefined4 param_4,int *param_5)

{
  uint uVar1;
  longlong lVar2;
  
  lVar2 = FUN_0005af40();
  lVar2 = lVar2 * CONCAT44(param_4,param_3);
  uVar1 = (uint)lVar2;
  *param_5 = param_1 - uVar1;
  param_5[1] = param_2 - ((int)((ulonglong)lVar2 >> 0x20) + (uint)(param_1 < uVar1));
  return;
}




undefined8 FUN_0005aae8(uint param_1,uint param_2,uint param_3,uint param_4)

{
  longlong lVar1;
  int iVar2;
  int iVar3;
  int extraout_r1;
  int extraout_r1_00;
  int extraout_r1_01;
  uint extraout_r1_02;
  int extraout_r1_03;
  int extraout_r1_04;
  int extraout_r1_05;
  int extraout_r1_06;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  int iVar13;
  bool bVar14;
  
  if ((int)param_2 < 0) {
    uVar8 = -param_1;
    uVar11 = -(param_2 + (param_1 != 0));
    uVar6 = 0xffffffff;
  }
  else {
    uVar6 = 0;
    uVar8 = param_1;
    uVar11 = param_2;
  }
  uVar5 = param_3;
  if ((int)param_4 < 0) {
    uVar5 = -param_3;
    param_4 = -(param_4 + (param_3 != 0));
    uVar6 = ~uVar6;
  }
  if (param_4 == 0) {
    if (uVar5 <= uVar11) {
      if (uVar5 == 0) {
        uVar5 = FUN_0005a860(1,0);
      }
      iVar4 = LZCOUNT(uVar5);
      if (iVar4 == 0) {
        iVar4 = uVar11 - uVar5;
        uVar7 = 1;
      }
      else {
        uVar5 = uVar5 << iVar4;
        uVar12 = uVar11 >> (0x20U - iVar4 & 0xff);
        uVar7 = uVar5 >> 0x10;
        uVar9 = uVar8 >> (0x20U - iVar4 & 0xff) | uVar11 << iVar4;
        uVar8 = uVar8 << iVar4;
        FUN_0005a908(uVar12,uVar7);
        iVar4 = FUN_0005a860(uVar12,uVar7);
        uVar12 = uVar9 >> 0x10 | extraout_r1_01 << 0x10;
        uVar11 = (uVar5 & 0xffff) * iVar4;
        iVar2 = iVar4;
        if (uVar12 < uVar11) {
          bVar14 = CARRY4(uVar12,uVar5);
          uVar12 = uVar12 + uVar5;
          iVar2 = iVar4 + -1;
          if ((!bVar14) && (uVar12 < uVar11)) {
            uVar12 = uVar12 + uVar5;
            iVar2 = iVar4 + -2;
          }
        }
        FUN_0005a908(uVar12 - uVar11,uVar7,uVar11,uVar12,param_1,param_2,param_3);
        param_1 = extraout_r1_02;
        uVar11 = FUN_0005a860(uVar12 - uVar11,uVar7);
        uVar12 = uVar9 & 0xffff | param_1 << 0x10;
        uVar9 = (uVar5 & 0xffff) * uVar11;
        uVar7 = uVar11;
        if (uVar12 < uVar9) {
          bVar14 = CARRY4(uVar12,uVar5);
          uVar12 = uVar12 + uVar5;
          uVar7 = uVar11 - 1;
          if ((!bVar14) && (uVar12 < uVar9)) {
            uVar12 = uVar12 + uVar5;
            uVar7 = uVar11 - 2;
          }
        }
        iVar4 = uVar12 - uVar9;
        uVar7 = uVar7 | iVar2 << 0x10;
      }
      uVar11 = uVar5 >> 0x10;
      FUN_0005a908(iVar4,uVar11);
      iVar2 = FUN_0005a860(iVar4,uVar11);
      uVar9 = uVar8 >> 0x10 | extraout_r1_03 << 0x10;
      uVar12 = (uVar5 & 0xffff) * iVar2;
      iVar4 = iVar2;
      if (uVar9 < uVar12) {
        bVar14 = CARRY4(uVar9,uVar5);
        uVar9 = uVar9 + uVar5;
        iVar4 = iVar2 + -1;
        if ((!bVar14) && (uVar9 < uVar12)) {
          uVar9 = uVar9 + uVar5;
          iVar4 = iVar2 + -2;
        }
      }
      FUN_0005a908(uVar9 - uVar12,uVar11,uVar12,uVar9,param_1,param_2,param_3);
      iVar2 = extraout_r1_04;
      uVar11 = FUN_0005a860(uVar9 - uVar12,uVar11);
      uVar9 = uVar8 & 0xffff | iVar2 << 0x10;
      uVar12 = (uVar5 & 0xffff) * uVar11;
      uVar8 = uVar11;
      if (uVar9 < uVar12) {
        uVar8 = uVar11 - 1;
        if ((!CARRY4(uVar9,uVar5)) && (uVar9 + uVar5 < uVar12)) {
          uVar8 = uVar11 - 2;
        }
      }
      uVar11 = uVar8 | iVar4 << 0x10;
      goto LAB_0005af20;
    }
    iVar4 = LZCOUNT(uVar5);
    uVar7 = uVar5;
    if (iVar4 != 0) {
      uVar7 = uVar5 << iVar4;
      uVar5 = uVar8 >> (0x20U - iVar4 & 0xff);
      uVar8 = uVar8 << iVar4;
      uVar11 = uVar5 | uVar11 << iVar4;
    }
    uVar12 = uVar7 >> 0x10;
    FUN_0005a908(uVar11,uVar12,uVar5,iVar4,param_1,param_2,param_3);
    iVar2 = FUN_0005a860(uVar11,uVar12);
    uVar5 = uVar8 >> 0x10 | extraout_r1 << 0x10;
    uVar11 = (uVar7 & 0xffff) * iVar2;
    iVar4 = iVar2;
    if (uVar5 < uVar11) {
      bVar14 = CARRY4(uVar5,uVar7);
      uVar5 = uVar5 + uVar7;
      iVar4 = iVar2 + -1;
      if ((!bVar14) && (uVar5 < uVar11)) {
        uVar5 = uVar5 + uVar7;
        iVar4 = iVar2 + -2;
      }
    }
    FUN_0005a908(uVar5 - uVar11,uVar12,uVar11,uVar5,param_1,param_2,param_3);
    uVar5 = FUN_0005a860(uVar5 - uVar11,uVar12);
    uVar12 = uVar8 & 0xffff | extraout_r1_00 << 0x10;
    uVar8 = (uVar7 & 0xffff) * uVar5;
    uVar11 = uVar5;
    if (uVar12 < uVar8) {
      uVar11 = uVar5 - 1;
      if ((!CARRY4(uVar12,uVar7)) && (uVar12 + uVar7 < uVar8)) {
        uVar11 = uVar5 - 2;
      }
    }
    uVar11 = uVar11 | iVar4 << 0x10;
LAB_0005af10:
    uVar7 = 0;
  }
  else {
    if (param_4 <= uVar11) {
      iVar4 = LZCOUNT(param_4);
      if (iVar4 != 0) {
        uVar12 = 0x20 - iVar4;
        uVar7 = uVar11 >> (uVar12 & 0xff);
        uVar9 = uVar5 >> (uVar12 & 0xff) | param_4 << iVar4;
        uVar10 = uVar8 >> (uVar12 & 0xff) | uVar11 << iVar4;
        uVar11 = uVar9 >> 0x10;
        FUN_0005a908(uVar7,uVar11,uVar7,param_4,param_1,uVar7,param_3);
        iVar2 = extraout_r1_05;
        iVar3 = FUN_0005a860(uVar7,uVar11);
        uVar7 = uVar10 >> 0x10 | iVar2 << 0x10;
        uVar12 = (uVar9 & 0xffff) * iVar3;
        iVar2 = iVar3;
        if (uVar7 < uVar12) {
          bVar14 = CARRY4(uVar7,uVar9);
          uVar7 = uVar7 + uVar9;
          iVar2 = iVar3 + -1;
          if ((!bVar14) && (uVar7 < uVar12)) {
            uVar7 = uVar7 + uVar9;
            iVar2 = iVar3 + -2;
          }
        }
        iVar13 = uVar7 - uVar12;
        FUN_0005a908(iVar13,uVar11);
        iVar3 = extraout_r1_06;
        uVar7 = FUN_0005a860(iVar13,uVar11);
        uVar12 = uVar10 & 0xffff | iVar3 << 0x10;
        uVar10 = (uVar9 & 0xffff) * uVar7;
        uVar11 = uVar7;
        if (uVar12 < uVar10) {
          bVar14 = CARRY4(uVar12,uVar9);
          uVar12 = uVar12 + uVar9;
          uVar11 = uVar7 - 1;
          if ((!bVar14) && (uVar12 < uVar10)) {
            uVar12 = uVar12 + uVar9;
            uVar11 = uVar7 - 2;
          }
        }
        uVar11 = uVar11 | iVar2 << 0x10;
        lVar1 = (ulonglong)(uVar5 << iVar4) * (ulonglong)uVar11;
        uVar5 = (uint)((ulonglong)lVar1 >> 0x20);
        if (uVar5 <= uVar12 - uVar10) {
          uVar7 = (uint)(uVar5 == uVar12 - uVar10);
          if ((uint)lVar1 <= uVar8 << iVar4) {
            uVar7 = 0;
          }
          if (uVar7 == 0) goto LAB_0005af20;
        }
        uVar11 = uVar11 - 1;
        goto LAB_0005af10;
      }
      bVar14 = param_4 <= uVar11;
      if (uVar11 <= param_4) {
        bVar14 = uVar5 <= uVar8;
      }
      if (bVar14) {
        uVar7 = 0;
        uVar11 = 1;
        goto LAB_0005af20;
      }
    }
    uVar7 = 0;
    uVar11 = uVar7;
  }
LAB_0005af20:
  if (uVar6 != 0) {
    bVar14 = uVar11 != 0;
    uVar11 = -uVar11;
    uVar7 = -(uVar7 + bVar14);
  }
  return CONCAT44(uVar7,uVar11);
}




undefined8 FUN_0005af40(uint param_1,uint param_2,uint param_3,uint param_4)

{
  longlong lVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  int extraout_r1;
  int extraout_r1_00;
  int extraout_r1_01;
  int extraout_r1_02;
  int extraout_r1_03;
  int extraout_r1_04;
  int extraout_r1_05;
  int extraout_r1_06;
  uint uVar5;
  int iVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  int iVar13;
  bool bVar14;
  
  if (param_4 == 0) {
    if (param_3 <= param_2) {
      uVar3 = param_1;
      uVar12 = param_2;
      uVar10 = param_3;
      if (param_3 == 0) {
        param_3 = FUN_0005a860(1,0);
      }
      iVar6 = LZCOUNT(param_3);
      if (iVar6 == 0) {
        iVar6 = param_2 - param_3;
        uVar9 = 1;
        uVar7 = param_1;
      }
      else {
        param_3 = param_3 << iVar6;
        uVar5 = param_2 >> (0x20U - iVar6 & 0xff);
        uVar7 = param_1 << iVar6;
        uVar9 = param_3 >> 0x10;
        uVar11 = param_1 >> (0x20U - iVar6 & 0xff) | param_2 << iVar6;
        FUN_0005a908(uVar5,uVar9);
        iVar6 = FUN_0005a860(uVar5,uVar9);
        uVar8 = uVar11 >> 0x10 | extraout_r1_01 << 0x10;
        uVar5 = (param_3 & 0xffff) * iVar6;
        iVar2 = iVar6;
        if (uVar8 < uVar5) {
          bVar14 = CARRY4(uVar8,param_3);
          uVar8 = uVar8 + param_3;
          iVar2 = iVar6 + -1;
          if ((!bVar14) && (uVar8 < uVar5)) {
            uVar8 = uVar8 + param_3;
            iVar2 = iVar6 + -2;
          }
        }
        FUN_0005a908(uVar8 - uVar5,uVar9,uVar5,uVar8,uVar3,uVar12,uVar10);
        uVar5 = FUN_0005a860(uVar8 - uVar5,uVar9);
        uVar8 = uVar11 & 0xffff | extraout_r1_02 << 0x10;
        uVar11 = (param_3 & 0xffff) * uVar5;
        uVar9 = uVar5;
        if (uVar8 < uVar11) {
          bVar14 = CARRY4(uVar8,param_3);
          uVar8 = uVar8 + param_3;
          uVar9 = uVar5 - 1;
          if ((!bVar14) && (uVar8 < uVar11)) {
            uVar8 = uVar8 + param_3;
            uVar9 = uVar5 - 2;
          }
        }
        iVar6 = uVar8 - uVar11;
        uVar9 = uVar9 | iVar2 << 0x10;
      }
      uVar5 = param_3 >> 0x10;
      FUN_0005a908(iVar6,uVar5);
      iVar2 = FUN_0005a860(iVar6,uVar5);
      uVar11 = uVar7 >> 0x10 | extraout_r1_03 << 0x10;
      uVar8 = (param_3 & 0xffff) * iVar2;
      iVar6 = iVar2;
      if (uVar11 < uVar8) {
        bVar14 = CARRY4(uVar11,param_3);
        uVar11 = uVar11 + param_3;
        iVar6 = iVar2 + -1;
        if ((!bVar14) && (uVar11 < uVar8)) {
          uVar11 = uVar11 + param_3;
          iVar6 = iVar2 + -2;
        }
      }
      FUN_0005a908(uVar11 - uVar8,uVar5,uVar8,uVar11,uVar3,uVar12,uVar10);
      uVar12 = FUN_0005a860(uVar11 - uVar8,uVar5);
      uVar10 = uVar7 & 0xffff | extraout_r1_04 << 0x10;
      uVar7 = (param_3 & 0xffff) * uVar12;
      uVar3 = uVar12;
      if (uVar10 < uVar7) {
        uVar3 = uVar12 - 1;
        if ((!CARRY4(uVar10,param_3)) && (uVar10 + param_3 < uVar7)) {
          uVar3 = uVar12 - 2;
        }
      }
      uVar3 = uVar3 | iVar6 << 0x10;
      goto LAB_0005b314;
    }
    iVar6 = LZCOUNT(param_3);
    uVar12 = param_2;
    uVar9 = param_3;
    uVar3 = param_1;
    if (iVar6 != 0) {
      uVar9 = param_3 << iVar6;
      uVar3 = param_1 << iVar6;
      uVar12 = param_1 >> (0x20U - iVar6 & 0xff) | param_2 << iVar6;
    }
    uVar10 = uVar9 >> 0x10;
    FUN_0005a908(uVar12,uVar10,param_3,iVar6,param_1,param_2,param_3);
    iVar2 = FUN_0005a860(uVar12,uVar10);
    uVar7 = uVar3 >> 0x10 | extraout_r1 << 0x10;
    uVar12 = (uVar9 & 0xffff) * iVar2;
    iVar6 = iVar2;
    if (uVar7 < uVar12) {
      bVar14 = CARRY4(uVar7,uVar9);
      uVar7 = uVar7 + uVar9;
      iVar6 = iVar2 + -1;
      if ((!bVar14) && (uVar7 < uVar12)) {
        uVar7 = uVar7 + uVar9;
        iVar6 = iVar2 + -2;
      }
    }
    FUN_0005a908(uVar7 - uVar12,uVar10,uVar12,uVar7,param_1,param_2,param_3);
    uVar12 = FUN_0005a860(uVar7 - uVar12,uVar10);
    uVar10 = uVar3 & 0xffff | extraout_r1_00 << 0x10;
    uVar7 = (uVar9 & 0xffff) * uVar12;
    uVar3 = uVar12;
    if (uVar10 < uVar7) {
      uVar3 = uVar12 - 1;
      if ((!CARRY4(uVar10,uVar9)) && (uVar10 + uVar9 < uVar7)) {
        uVar3 = uVar12 - 2;
      }
    }
    uVar3 = uVar3 | iVar6 << 0x10;
LAB_0005b304:
    uVar9 = 0;
  }
  else {
    if (param_4 <= param_2) {
      iVar6 = LZCOUNT(param_4);
      if (iVar6 != 0) {
        uVar3 = 0x20 - iVar6;
        uVar9 = param_2 >> (uVar3 & 0xff);
        uVar12 = param_3 >> (uVar3 & 0xff) | param_4 << iVar6;
        uVar10 = param_1 >> (uVar3 & 0xff) | param_2 << iVar6;
        uVar3 = uVar12 >> 0x10;
        FUN_0005a908(uVar9,uVar3,param_3,param_4,param_1,param_2,param_3);
        iVar2 = extraout_r1_05;
        iVar4 = FUN_0005a860(uVar9,uVar3);
        uVar7 = uVar10 >> 0x10 | iVar2 << 0x10;
        uVar9 = (uVar12 & 0xffff) * iVar4;
        iVar2 = iVar4;
        if (uVar7 < uVar9) {
          bVar14 = CARRY4(uVar7,uVar12);
          uVar7 = uVar7 + uVar12;
          iVar2 = iVar4 + -1;
          if ((!bVar14) && (uVar7 < uVar9)) {
            uVar7 = uVar7 + uVar12;
            iVar2 = iVar4 + -2;
          }
        }
        iVar13 = uVar7 - uVar9;
        FUN_0005a908(iVar13,uVar3);
        iVar4 = extraout_r1_06;
        uVar9 = FUN_0005a860(iVar13,uVar3);
        uVar10 = uVar10 & 0xffff | iVar4 << 0x10;
        uVar7 = (uVar12 & 0xffff) * uVar9;
        uVar3 = uVar9;
        if (uVar10 < uVar7) {
          bVar14 = CARRY4(uVar10,uVar12);
          uVar10 = uVar10 + uVar12;
          uVar3 = uVar9 - 1;
          if ((!bVar14) && (uVar10 < uVar7)) {
            uVar10 = uVar10 + uVar12;
            uVar3 = uVar9 - 2;
          }
        }
        uVar3 = uVar3 | iVar2 << 0x10;
        lVar1 = (ulonglong)(param_3 << iVar6) * (ulonglong)uVar3;
        uVar9 = (uint)((ulonglong)lVar1 >> 0x20);
        if (uVar9 <= uVar10 - uVar7) {
          uVar9 = (uint)(uVar9 == uVar10 - uVar7);
          if ((uint)lVar1 <= param_1 << iVar6) {
            uVar9 = 0;
          }
          if (uVar9 == 0) goto LAB_0005b314;
        }
        uVar3 = uVar3 - 1;
        goto LAB_0005b304;
      }
      bVar14 = param_4 <= param_2;
      if (param_2 <= param_4) {
        bVar14 = param_3 <= param_1;
      }
      if (bVar14) {
        uVar3 = 1;
        uVar9 = 0;
        goto LAB_0005b314;
      }
    }
    uVar3 = 0;
    uVar9 = uVar3;
  }
LAB_0005b314:
  return CONCAT44(uVar9,uVar3);
}




/* WARNING: Removing unreachable block (ram,0x0005b34c) */

void FUN_0005b320(EVP_PKEY_CTX *param_1,undefined4 param_2,undefined4 param_3,undefined4 param_4)

{
  int iVar1;
  undefined4 *puVar2;
  
  _init(param_1);
  puVar2 = (undefined4 *)0x78ffc;
  iVar1 = 0;
  do {
    iVar1 = iVar1 + 1;
    puVar2 = puVar2 + 1;
    (*(code *)*puVar2)(param_1,param_2,param_3,(code *)*puVar2,param_4);
  } while (iVar1 != 1);
  return;
}




/* WARNING: Removing unreachable block (ram,0x0005b3a4) */

void FUN_0005b388(undefined4 param_1)

{
  __cxa_atexit(param_1,0,DAT_0007942c);
  return;
}




void _fini(void)

{
  return;
}



