// Decompiled: ntpd_af6bfd6309f1a6c2

void _DT_INIT(void)

{
    FUN_0001c6f8();
    return;
}

void FUN_0001c170(int param_1, byte param_2, uint param_3, uint param_4)

{
    undefined4 uVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    uint local_884;
    uint local_880;
    int local_87c;
    uint local_878;
    byte local_874;
    char local_873;
    byte local_872;
    undefined1 local_871;
    uint local_870;
    uint local_86c;
    undefined4 local_868;
    uint local_864;
    uint uStack_860;
    uint local_85c;
    uint uStack_858;
    uint local_854;
    uint local_850;
    uint local_84c;
    uint local_848;
    int local_2c;

    iVar3 = param_1 + 4;
    local_2c = __stack_chk_guard;
    if ((*(uint *)(*(int *)(param_1 + 0x3c) + 0x90) & 0x40) != 0) {
        uVar1 = FUN_000278f8(iVar3);
        *(undefined4 *)(param_1 + 0x3c) = uVar1;
    }
    local_874 = *(byte *)(param_1 + 0x58) & 0x38;
    local_872 = *(byte *)(param_1 + 0x5a);
    if (*(byte *)(param_1 + 0x5a) < ntp_minpoll) {
        local_872 = ntp_minpoll;
    }
    if ((param_4 & 0x800) == 0) {
        local_874 = local_874 | param_2 | xmt_leap << 6;
        local_873 = sys_stratum;
        if (sys_stratum == '\x10') {
            local_873 = '\0';
        }
        local_871 = sys_precision;
        local_85c = *(uint *)(param_1 + 0x80);
        uStack_858 = *(uint *)(param_1 + 0x84);
        uVar5 = *(uint *)(param_1 + 0x48);
        local_868 = sys_refid;
        local_854 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
        uVar5 = *(uint *)(param_1 + 0x4c);
        local_850 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
        uVar5 = (uint)(longlong)(sys_rootdelay * 65536.0);
        local_870 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
        uVar5 = (uint)(0.0 < sys_rootdisp * 65536.0) *
                (int)(longlong)(sys_rootdisp * 65536.0);
        local_86c = uVar5 * 0x1000000 | (uVar5 >> 8 & 0xff) << 0x10 |
                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
        local_864 = (uint)sys_reftime << 0x18 |
                    ((uint)sys_reftime >> 8 & 0xff) << 0x10 |
                    ((uint)sys_reftime >> 0x10 & 0xff) << 8 |
                    (uint)sys_reftime >> 0x18;
        uStack_860 = sys_reftime._4_4_ << 0x18 |
                     (sys_reftime._4_4_ >> 8 & 0xff) << 0x10 |
                     (sys_reftime._4_4_ >> 0x10 & 0xff) << 8 |
                     sys_reftime._4_4_ >> 0x18;
        FUN_0006f724(&local_884);
        local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                    (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
        local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                    (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
    } else {
        local_864 = *(uint *)(param_1 + 0x68);
        uStack_860 = *(uint *)(param_1 + 0x6c);
        local_85c = *(uint *)(param_1 + 0x80);
        uStack_858 = *(uint *)(param_1 + 0x84);
        local_874 =
            local_874 |
            ~((byte) ~(byte)((uint)((int)(char)param_2 << 0x1a) >> 0x18) >> 2);
        local_870 = *(uint *)(param_1 + 0x5c);
        local_871 = *(undefined1 *)(param_1 + 0x5b);
        sys_kodsent = sys_kodsent + 1;
        local_86c = *(uint *)(param_1 + 0x60);
        local_868 = 0x45544152;
        local_873 = '\0';
        local_854 = local_85c;
        local_850 = uStack_858;
        local_84c = local_85c;
        local_848 = uStack_858;
    }
    if (*(int *)(param_1 + 0x54) == 0x30) {
        FUN_00026a68(iVar3, *(undefined4 *)(param_1 + 0x3c), 0, &local_874,
                     0x30);
    } else {
        if (param_3 < 0x10000) {
            iVar4 = 0x30;
        } else {
            uVar1 = FUN_000372c8(iVar3, *(int *)(param_1 + 0x3c) + 0x18, 0,
                                 sys_private, 0);
            if (*(uint *)(param_1 + 0x54) < 0x49) {
                iVar4 = 0x30;
                FUN_000372c8(*(int *)(param_1 + 0x3c) + 0x18, iVar3, param_3,
                             uVar1, 2);
            } else {
                FUN_000372c8(*(int *)(param_1 + 0x3c) + 0x18, iVar3, param_3, 0,
                             2);
                *(uint *)(param_1 + 0x88) = *(uint *)(param_1 + 0x88) | 0x80;
                iVar4 = FUN_00039774(0, &local_874, param_1, 0x30,
                                     (uint *)(param_1 + 0x88), uVar1);
                iVar4 = iVar4 + 0x30;
            }
        }
        FUN_0006f724(&local_884);
        iVar2 = FUN_0007278c(param_3, &local_874, iVar4);
        if (0xffff < param_3) {
            FUN_000721bc(param_3, 0);
        }
        FUN_00026a68(iVar3, *(undefined4 *)(param_1 + 0x3c), 0, &local_874,
                     iVar4 + iVar2);
        FUN_0006f724(&local_87c);
        local_87c = local_87c - local_884;
        if (local_878 < local_880) {
            local_87c = local_87c + -1;
        }
        local_878 = local_878 - local_880;
        sys_authdelay._0_4_ = local_87c;
        sys_authdelay._4_4_ = local_878;
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001c534(char *param_1, char *param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        iVar2 = 0;
    } else {
        iVar2 = strcmp(param_1, sys_groupname);
        if (iVar2 != 0) {
            if (param_2 == (char *)0x0) {
                iVar2 = 1;
            } else {
                iVar2 = strcmp(param_1, param_2);
                if (iVar2 != 0) {
                    iVar2 = 1;
                }
            }
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_0001c5c4(void)

{
    int *piVar1;

    piVar1 = __errno_location();
    FUN_00074e00(3, "read system clock failed: %m (%d)", *piVar1);
    /* WARNING: Subroutine does not return */
    exit(1);
}

void FUN_0001c610(undefined4 param_1)

{
    fprintf(stderr, (char *)option_xlateable_txt._20_4_, param_1);
    /* WARNING: Subroutine does not return */
    FUN_0008ce5c(1);
}

/* WARNING: Removing unreachable block (ram,0x0001c6a4) */

void main(int param_1, undefined4 *param_2)

{
    uint uVar1;
    int iVar2;
    __mode_t __mask;
    size_t sVar3;
    __uid_t _Var4;
    undefined4 uVar5;
    __pid_t _Var6;
    undefined4 *puVar7;
    time_t tVar8;
    int iVar9;
    int *piVar10;
    int iVar11;
    code *pcVar12;
    uint uVar13;
    char *pcVar14;
    int iVar15;
    undefined4 *puVar16;
    int __nfds;
    undefined4 local_4d4;
    undefined4 *local_4d0;
    int local_4cc[2];
    int local_4c4;
    int local_4c0;
    timeval local_4bc;
    uint local_4b4;
    int local_4b0;
    pthread_attr_t local_4ac[3];
    int iStack_430;
    char acStack_42c[1024];
    undefined4 local_2c;

    local_2c = __stack_chk_guard;
    local_4d0 = param_2;
    local_4cc[0] = param_1;
    pthread_attr_init(local_4ac);
    iVar2 = pthread_attr_setstacksize(local_4ac, 0x8000);
    if (iVar2 != 0) {
        pcVar14 = strerror(iVar2);
        FUN_00074e00(3, "my_pthread_warmup: pthread_attr_setstacksize() -> %s",
                     pcVar14);
    }
    iVar2 = pthread_create((pthread_t *)&local_4bc, local_4ac,
                           (__start_routine *)&DAT_0002d250, (void *)0x0);
    pthread_attr_destroy(local_4ac);
    if (iVar2 == 0) {
        pthread_cancel(local_4bc.tv_sec);
        pthread_join(local_4bc.tv_sec, (void **)0x0);
    } else {
        pcVar14 = strerror(iVar2);
        FUN_00074e00(3, "my_pthread_warmup: pthread_create() -> %s", pcVar14);
    }
    __mask = umask(0);
    if (__mask == 0) {
        __mask = 0x12;
    }
    umask(__mask);
    puVar16 = &saved_argc;
    saved_argc = local_4cc[0];
    progname = *local_4d0;
    saved_argv = local_4d0;
    initializing = 1;
    FUN_0002d284(local_4cc, &local_4d0);
    if ((((*(uint *)(ntpdOptions._68_4_ + 0x450) & 0xf) != 0) ||
         ((*(uint *)(ntpdOptions._68_4_ + 0x550) & 0xf) != 0)) ||
        ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) != 0)) {
        nofork = 1;
    }
    FUN_00074efc(progname, 0xf000, 1);
    if ((*(uint *)(ntpdOptions._68_4_ + 0x390) & 0xf) == 0) {
        if (nofork != 0) {
            msyslog_term = 1;
        }
        if ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) == 0) {
            local_4d4 = 0;
        } else {
            local_4d4 = 0;
            syslogit = 0;
        }
    } else {
        local_4d4 = *(undefined4 *)(ntpdOptions._68_4_ + 0x398);
        syslogit = 0;
        FUN_00074fec(local_4d4, 0);
    }
    FUN_00074e00(5, "%s: Starting", Version);
    FUN_0007c054(acStack_42c, 0x400, "Command line:");
    sVar3 = strlen(acStack_42c);
    pcVar14 = acStack_42c + sVar3;
    if (0 < saved_argc) {
        iVar2 = 0;
        do {
            puVar7 = saved_argv + iVar2;
            iVar2 = iVar2 + 1;
            FUN_0007c054(pcVar14, 0x400 - ((int)pcVar14 - (int)acStack_42c),
                         " %s", *puVar7);
            sVar3 = strlen(pcVar14);
            pcVar14 = pcVar14 + sVar3;
        } while (iVar2 < saved_argc);
    }
    FUN_00074e00(6, "%s", acStack_42c);
    FUN_0007ed00(&LAB_0002d1cc);
    FUN_0007f4d8(&LAB_0002d124);
    FUN_0007f45c(&LAB_0002d044);
    _Var4 = getuid();
    if ((_Var4 != 0) && ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) == 0)) {
        msyslog_term = 1;
        FUN_00074e00(3, "must be run as root, not uid %ld");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x3d0) & 0xf) != 0) {
        listen_to_virtual_ips = 0;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x310) & 0xf) != 0) {
        iVar2 = **(int **)(ntpdOptions._68_4_ + 0x31c);
        iVar15 = iVar2 + -1;
        if (0 < iVar2) {
            piVar10 = *(int **)(ntpdOptions._68_4_ + 0x31c) + 1;
            do {
                piVar10 = piVar10 + 1;
                iVar15 = iVar15 + -1;
                iVar2 = FUN_00074054(*piVar10, 0, local_4ac);
                if (iVar2 == 0) {
                    uVar5 = 4;
                } else {
                    uVar5 = 5;
                }
                FUN_00025e04(uVar5, *piVar10, 0xffffffff, 0);
            } while (iVar15 != -1);
        }
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x490) & 0xf) != 0) {
        priority_done = 0;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x510) & 0xf) != 0) {
        config_priority = *(undefined4 **)(ntpdOptions._68_4_ + 0x518);
        config_priority_override = 1;
        priority_done = 0;
    }
    local_4b4 = 0xffffffff;
    local_4b0 = -1;
    if ((*(uint *)(ntpdOptions._68_4_ + 0x790) & 0xf) == 0) {
        iVar2 = 0;
    } else {
        iVar2 = *(int *)(ntpdOptions._68_4_ + 0x798);
        if (iVar2 < 1) {
            iVar2 = 0;
        } else {
            nofork = 0;
            iVar15 = pipe((int *)&local_4b4);
            if (iVar15 != 0) {
                piVar10 = __errno_location();
                iVar2 = *piVar10;
                pcVar14 = "Pipe creation failed for --wait-sync: %m";
                goto LAB_0002d970;
            }
            waitsync_fd_to_close = local_4b0;
        }
    }
    FUN_00074244();
    FUN_0006f724(&local_4c4);
    FUN_00078b80(local_4c0 * local_4c4);
    if (nofork == 0) {
        _Var6 = fork();
        uVar1 = local_4b4;
        if (_Var6 == -1) {
            piVar10 = __errno_location();
            iVar2 = *piVar10;
            pcVar14 = "fork: %m";
        LAB_0002d970:
            if (iVar2 == 0) {
                iVar2 = -1;
            }
            FUN_00074e00(3, pcVar14);
            /* WARNING: Subroutine does not return */
            exit(iVar2);
        }
        if (0 < _Var6) {
            iVar15 = 0;
            if (iVar2 != 0) {
                __nfds = local_4b4 + 1;
                close(waitsync_fd_to_close);
                tVar8 = time((time_t *)0x0);
                uVar13 = uVar1 & 0x1f;
                iVar11 = iVar2 + tVar8;
                if ((int)uVar1 < 1) {
                    uVar13 = -(-uVar1 & 0x1f);
                }
                uVar13 = 1 << (uVar13 & 0xff);
                while (true) {
                    tVar8 = time((time_t *)0x0);
                    local_4bc.tv_usec = 0;
                    if (tVar8 < iVar11) {
                        puVar16 = (undefined4 *)(iVar11 - tVar8);
                    }
                    piVar10 = &local_4b0;
                    if (iVar11 <= tVar8) {
                        puVar16 = (undefined4 *)0x0;
                    }
                    do {
                        piVar10 = piVar10 + 1;
                        *piVar10 = 0;
                    } while (&iStack_430 != piVar10);
                    local_4bc.tv_sec = (__time_t)puVar16;
                    iVar9 = __fdelt_chk(uVar1);
                    *(uint *)((int)local_4ac + iVar9 * 4) =
                        *(uint *)((int)local_4ac + iVar9 * 4) | uVar13;
                    puVar7 = (undefined4 *)select(__nfds, (fd_set *)local_4ac,
                                                  (fd_set *)0x0, (fd_set *)0x0,
                                                  &local_4bc);
                    if (puVar7 != (undefined4 *)0xffffffff)
                        break;
                    piVar10 = __errno_location();
                    iVar9 = *piVar10;
                    if (iVar9 != 4) {
                        if (iVar9 == 0) {
                            iVar9 = -1;
                        }
                        FUN_00074e00(3, "--wait-sync select failed: %m");
                        iVar15 = iVar9;
                        goto LAB_0002ddbc;
                    }
                    if (puVar16 == (undefined4 *)0x0)
                        goto LAB_0002df30;
                }
                if (puVar7 != (undefined4 *)0x0)
                    goto LAB_0002ddbc;
                iVar11 = 0;
                do {
                    *(undefined4 *)((int)local_4ac + iVar11 * 4) = 0;
                    iVar11 = iVar11 + 1;
                } while (iVar11 != 0x20);
                iVar11 = __fdelt_chk(uVar1);
                *(uint *)((int)local_4ac + iVar11 * 4) =
                    *(uint *)((int)local_4ac + iVar11 * 4) | uVar13;
                local_4bc.tv_sec = (__time_t)puVar7;
                local_4bc.tv_usec = (__suseconds_t)puVar7;
                iVar11 = select(__nfds, (fd_set *)local_4ac, (fd_set *)0x0,
                                (fd_set *)0x0, &local_4bc);
                if (iVar11 != 0)
                    goto LAB_0002ddbc;
            LAB_0002df30:
                iVar15 = 0x6e;
                __fprintf_chk(stderr, 1, "%s: -w/--wait-sync %ld timed out.\n",
                              progname, iVar2);
            }
        LAB_0002ddbc:
            /* WARNING: Subroutine does not return */
            exit(iVar15);
        }
        closelog();
        if (syslog_file != (FILE *)0x0) {
            fclose(syslog_file);
            syslog_file = (FILE *)0x0;
            syslogit = 1;
        }
        FUN_00079020(waitsync_fd_to_close);
        iVar2 = open64("/dev/null", 0);
        if (((iVar2 != 0) || (iVar2 = dup2(0, 1), iVar2 != 1)) ||
            (iVar2 = dup2(0, 2), iVar2 != 2)) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntpd.c", 0x244, 2,
                         "0 == open(\"/dev/null\", 0) && 1 == dup2(0, 1) && 2 "
                         "== dup2(0, 2)");
        }
        FUN_00074efc(progname, 0, 1);
        FUN_00075384(local_4d4);
        _Var6 = setsid();
        if (_Var6 == -1) {
            FUN_00074e00(3, "setsid(): %m");
        }
    }
    FUN_0001fb7c(3, &DAT_0009d000, 0x32000, 0, 0x1000, &DAT_0009d000);
    FUN_0001fb7c(8, &DAT_0009cfd0, 0xfff00000, 0xffffffff, 0x100000,
                 &DAT_0009cfd0);
    FUN_0007d6f0(1, &DAT_0002cf78);
    FUN_0007d6f0(2, &DAT_0002cf78);
    FUN_0007d6f0(3, &DAT_0002cf78);
    FUN_0007d6f0(0xf, &DAT_0002cf78);
    FUN_0007d6f0(7, &DAT_0002cf78);
    FUN_0007d6f0(10, &LAB_0002cfd4);
    FUN_0007d6f0(0xc, &LAB_0002cfd4);
    FUN_0007d6f0(0xd, 1);
    if (ssl_init_done == 0) {
        FUN_0007c6b8();
    }
    FUN_00071b14();
    FUN_000518a8();
    FUN_0004ffbc();
    FUN_00040c68();
    FUN_00050cf0();
    FUN_0004f3e4();
    FUN_0003430c();
    FUN_00041958();
    FUN_000495b0();
    if (priority_done == 0) {
        puVar16 = (undefined4 *)sched_get_priority_max(1);
        local_4bc.tv_sec = (__time_t)puVar16;
        if (((config_priority_override != 0) &&
             (puVar7 = (undefined4 *)sched_get_priority_min(1),
              local_4bc.tv_sec = (__time_t)puVar16,
              (int)config_priority <= (int)puVar16)) &&
            (local_4bc.tv_sec = (__time_t)puVar7,
             (int)puVar7 < (int)config_priority)) {
            local_4bc.tv_sec = (__time_t)config_priority;
        }
        iVar2 = sched_setscheduler(0, 1, (sched_param *)&local_4bc);
        if (iVar2 == -1) {
            FUN_00074e00(3, "sched_setscheduler(): %m");
        } else {
            priority_done = priority_done + 1;
        }
        if (priority_done == 0) {
            iVar2 = setpriority(PRIO_PROCESS, 0, -0xc);
            if (iVar2 == -1) {
                FUN_00074e00(3, "setpriority() error: %m");
            } else {
                priority_done = priority_done + 1;
            }
            if (priority_done == 0) {
                FUN_00074e00(3, "set_process_priority: No way found to improve "
                                "our priority");
            }
        }
    }
    FUN_00048d98();
    FUN_00025cf0();
    FUN_0003f40c();
    FUN_00040cd4(1);
    FUN_00023380(local_4cc[0], local_4d0);
    FUN_000405f8(0, 1);
    FUN_00035ee0(6, 0);
    initializing = 0;
    was_alarmed = 0;
    do {
        iVar2 = DAT_000c93e4;
        if (DAT_000c93e0 != 0) {
            pcVar14 = strsignal(DAT_000c93e4);
            if (pcVar14 == (char *)0x0) {
                pcVar14 = "";
            }
            FUN_00074e00(5, "%s exiting on signal %d (%s)", progname, iVar2,
                         pcVar14);
            FUN_00042e6c();
            /* WARNING: Subroutine does not return */
            exit(0);
        }
        if (alarm_flag == 0) {
            if (was_alarmed == 0) {
                FUN_000794b8();
                if (was_alarmed != 0)
                    goto LAB_0002d858;
                iVar2 = FUN_0007a3a0();
                if (iVar2 == 0) {
                    FUN_00026d04();
                }
            }
            if (alarm_flag != 0)
                goto LAB_0002d9d8;
            if (was_alarmed != 0)
                goto LAB_0002d864;
        } else {
            alarm_flag = 0;
            was_alarmed = 1;
        LAB_0002d858:
            if (alarm_flag != 0) {
            LAB_0002d9d8:
                alarm_flag = 0;
                was_alarmed = 1;
            }
        LAB_0002d864:
            FUN_00050ed4();
            was_alarmed = 0;
        }
        iVar2 = FUN_0007a1a4();
        while (iVar2 != 0) {
            if (alarm_flag == 0) {
                if (was_alarmed != 0)
                    goto LAB_0002d880;
                pcVar12 = *(code **)(iVar2 + 0x50);
            } else {
                was_alarmed = 1;
                alarm_flag = 0;
            LAB_0002d880:
                FUN_00050ed4();
                pcVar12 = *(code **)(iVar2 + 0x50);
                was_alarmed = 0;
            }
            if (pcVar12 == (code *)0x0) {
                FUN_00074e00(3, "fatal: receive buffer callback NULL");
                /* WARNING: Subroutine does not return */
                abort();
            }
            (*pcVar12)(iVar2);
            FUN_00079fa8(iVar2);
            iVar2 = FUN_0007a1a4();
        }
    } while (true);
}

/* WARNING: Control flow encountered bad instruction data */

void entry(undefined4 param_1, undefined4 *param_2)

{
    undefined4 *extraout_r1;
    undefined1 *unaff_r10;
    undefined4 unaff_r11;
    undefined1 in_NG;
    undefined1 in_ZR;
    char in_OV;
    undefined4 in_cr0;
    undefined4 in_cr15;

    if ((bool)in_ZR) {
        FUN_000587f4();
        param_2 = extraout_r1;
    }
    if ((bool)in_ZR) {
        coprocessor_function(0, 0, 2, in_cr15, in_cr0, in_cr15);
    }
    if ((bool)in_NG) {
        *unaff_r10 = (char)unaff_r11;
    }
    if (in_NG != in_OV) {
        *param_2 = unaff_r11;
    }
    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
}

/* WARNING: Removing unreachable block (ram,0x0001c70c) */

void FUN_0001c6f8(void)

{
    __gmon_start__();
    return;
}

/* WARNING: Removing unreachable block (ram,0x0001c72c) */
/* WARNING: Removing unreachable block (ram,0x0001c732) */

void FUN_0001c71c(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x0001c760) */
/* WARNING: Removing unreachable block (ram,0x0001c766) */

void FUN_0001c748(void)

{
    return;
}

void _FINI_0(void)

{
    if (DAT_000c8608 == '\0') {
        __cxa_finalize(DAT_000c6004);
        FUN_0001c71c();
        DAT_000c8608 = '\x01';
    }
    return;
}

void FUN_0001c7c0(void)

{
    char cVar1;
    int iVar2;
    char *pcVar3;
    char *pcVar4;
    char *__s;
    uint uVar5;

    iVar2 = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar5 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar5 & 0xf;
    FUN_0007c054(__s, 0x80, &DAT_0009c1d4);
    pcVar3 = strchr(__s, 0x65);
    if (pcVar3 == (char *)0x0) {
        pcVar3 = strchr(__s, 0x45);
        if (pcVar3 == (char *)0x0)
            goto LAB_0001c888;
        *pcVar3 = 'e';
    }
    cVar1 = pcVar3[1];
    if (cVar1 == '-') {
        cVar1 = pcVar3[2];
        pcVar3 = pcVar3 + 2;
    } else {
        pcVar3 = pcVar3 + 1;
    }
    pcVar4 = pcVar3;
    if (cVar1 == '0') {
        do {
            pcVar4 = pcVar4 + 1;
        } while (*pcVar4 == '0');
        if (pcVar3 != pcVar4) {
            FUN_0007d4dc(pcVar3, pcVar4, 0x80 - ((int)pcVar3 - (int)__s));
        }
    }
LAB_0001c888:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_0001c8e0(char *param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((param_1 != (char *)0x0) &&
        (param_1 = *(char **)(param_1 + 4), param_1 != (char *)0x0)) {
        iVar2 = strncmp(param_1, "127.127.", 8);
        param_1 = (char *)(uint)(iVar2 == 0);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0001c954(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    undefined4 uStack_c;
    undefined4 uStack_8;
    undefined4 uStack_4;

    uStack_c = param_2;
    uStack_8 = param_3;
    uStack_4 = param_4;
    FUN_00074e88(0, param_1, &uStack_c, __stack_chk_guard, &uStack_c,
                 __stack_chk_guard);
    /* WARNING: Subroutine does not return */
    _exit(1);
}

void FUN_0001c9a0(int *param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 == (int *)0x0) {
    LAB_0001ca44:
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    param_1 = (int *)*param_1;
joined_r0x0001c9d4:
    if (param_1 != (int *)0x0) {
        iVar2 = param_1[4];
        if (iVar2 == 0x16b)
            goto LAB_0001cae0;
        do {
            if (iVar2 < 0x16c) {
                if (iVar2 == 0x113) {
                    FUN_00048810(0, 0xd, param_2, 0);
                } else if (iVar2 < 0x114) {
                    if (iVar2 == 0x107) {
                        FUN_00048810(0, 3, param_2, 0);
                    } else {
                        if (iVar2 != 0x10c)
                            goto LAB_0001ca2c;
                        FUN_00048810(0, 1, param_2, 0);
                    }
                } else if (iVar2 == 0x148) {
                    FUN_00048810(0, 9, param_2, 0);
                } else {
                    if (iVar2 != 0x16a)
                        goto LAB_0001ca2c;
                    FUN_00048810(0, 0x1c, param_2, 0);
                }
            } else if (iVar2 == 0x19c) {
                FUN_00048810(0, 0xb, param_2, 0);
            } else if (iVar2 < 0x19d) {
                if (iVar2 == 0x17c) {
                    FUN_00048810(0, 8, param_2, 0);
                } else {
                    if (iVar2 != 0x181)
                        goto LAB_0001ca2c;
                    FUN_00048810(0, 0x20, param_2, 0);
                }
            } else if (iVar2 == 0x1b4) {
                FUN_00048810(0, 0x1e, param_2, 0);
            } else if (iVar2 == 0x1b5) {
                FUN_00048810(0, 0x1f, param_2, 0);
            } else {
                if (iVar2 != 0x1b3)
                    goto LAB_0001ca2c;
                FUN_00048810(0, 0x1d, param_2, 0);
            }
            while (true) {
                param_1 = (int *)*param_1;
                if (param_1 == (int *)0x0)
                    goto LAB_0001ca44;
                iVar2 = param_1[4];
                if (iVar2 != 0x16b)
                    break;
            LAB_0001cae0:
                FUN_00048810(0, 10, param_2, 0);
            }
        } while (true);
    }
    goto LAB_0001ca44;
LAB_0001ca2c:
    FUN_00074e00(3, "can not apply enable/disable token %d, unknown");
    param_1 = (int *)*param_1;
    goto joined_r0x0001c9d4;
}

void FUN_0001cc78(short *param_1, int param_2)

{
    short sVar1;
    uint uVar2;
    uint uVar3;
    bool bVar4;
    int iVar5;
    undefined4 uVar6;
    int iVar7;
    uint uVar8;

    iVar5 = __stack_chk_guard;
    sVar1 = *param_1;
    if (sVar1 == 2) {
        uVar8 = *(uint *)(param_1 + 2);
        uVar2 = uVar8 << 0x18;
        uVar3 = uVar2 | (uVar8 >> 8 & 0xff) << 0x10;
        if ((uVar3 != 0x7f7f0000) && ((uVar3 | (uVar8 >> 0x10 & 0xff) << 8 |
                                       uVar8 >> 0x18) != 0x7f000001 &&
                                      uVar2 == 0x7f000000)) {
        LAB_0001cd20:
            uVar6 = FUN_0007c2e8();
            FUN_00074e00(3, "attempt to configure invalid address %s", uVar6);
            iVar7 = 0;
            goto LAB_0001cce8;
        }
        if ((param_2 == 0x183 || param_2 == 0x197) || (param_2 == 0x188)) {
            bVar4 = (uVar2 & 0xf0000000) == 0xe0000000;
            goto LAB_0001ccc8;
        }
        if (param_2 == 0x157) {
        LAB_0001cdb0:
            if ((uVar8 & 0xf0) != 0xe0)
                goto LAB_0001cd20;
        }
    } else {
        if ((param_2 == 0x183 || param_2 == 0x197) || (param_2 == 0x188)) {
            bVar4 = (char)param_1[4] == -1;
        LAB_0001ccc8:
            if (bVar4)
                goto LAB_0001cd20;
            if (param_2 == 0x157) {
                if (sVar1 == 2) {
                    uVar8 = *(uint *)(param_1 + 2);
                    goto LAB_0001cdb0;
                }
                goto LAB_0001cd14;
            }
        } else if (param_2 == 0x157) {
        LAB_0001cd14:
            if ((char)param_1[4] != -1)
                goto LAB_0001cd20;
        }
        if (sVar1 == 10) {
            iVar7 = ipv6_works;
            if (ipv6_works != 0) {
                iVar7 = 1;
            }
            goto LAB_0001cce8;
        }
    }
    iVar7 = 1;
LAB_0001cce8:
    if (iVar5 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar7);
}

void FUN_0001ce10(undefined4 param_1, ushort *param_2)

{
    ushort uVar1;
    int iVar2;
    int iVar3;

    iVar2 = __stack_chk_guard;
    uVar1 = *param_2;
    if ((uVar1 & 0xfffd) != 0 && uVar1 != 10) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_config.c", 0x143d, 0,
                     "0 == ((addr)->sa.sa_family) || 2 == "
                     "((addr)->sa.sa_family) || 10 == ((addr)->sa.sa_family)");
    }
    iVar3 = FUN_00074054(param_1, uVar1, param_2);
    if (iVar3 != 0) {
        if ((*param_2 == 10) && (ipv6_works == 0)) {
            iVar3 = -1;
        } else {
            iVar3 = 1;
            param_2[1] = 0x7b00;
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

void FUN_0001cee8(int *param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int extraout_r2;
    int *piVar4;
    int *extraout_r3;
    int iVar5;
    int extraout_r12;
    int iVar6;
    undefined8 uVar7;

    iVar1 = __stack_chk_guard;
    if (param_1 != (int *)0x0) {
        piVar4 = (int *)*param_1;
        if (piVar4 == (int *)0x0) {
            param_1 = (int *)0x0;
        } else {
            param_1 = (int *)0x0;
            iVar3 = 0x18b;
            iVar5 = 0x112;
            iVar6 = 0x137;
        LAB_0001cf68:
            do {
                iVar2 = piVar4[4];
                uVar7 = CONCAT44(iVar2, param_1);
                if (iVar2 == 0x178) {
                    param_1 = (int *)((uint)param_1 | 0x200);
                } else if (iVar2 < 0x179) {
                    if (iVar2 == iVar5) {
                        param_1 = (int *)((uint)param_1 | 0x40);
                    } else if (iVar2 == iVar6) {
                        param_1 = (int *)((uint)param_1 | 0x100);
                    } else {
                        if (iVar2 != 0x108) {
                        LAB_0001cf90:
                            do {
                                iVar6 = 0x1cf9c;
                                uVar7 = FUN_0001c954(
                                    "peerflag_bits: option-token=%d");
                                iVar3 = extraout_r2;
                                piVar4 = extraout_r3;
                                iVar5 = extraout_r12;
                            LAB_0001cf9c:
                            } while ((int)((ulonglong)uVar7 >> 0x20) != 0x18a);
                            piVar4 = (int *)*piVar4;
                            param_1 = (int *)((uint)uVar7 | 2);
                            if (piVar4 == (int *)0x0)
                                break;
                            goto LAB_0001cf68;
                        }
                        param_1 = (int *)((uint)param_1 | 0x800);
                    }
                } else if (iVar2 == iVar3) {
                    param_1 = (int *)((uint)param_1 | 0x20);
                } else {
                    if (iVar2 < 0x18c)
                        goto LAB_0001cf9c;
                    if (iVar2 == 0x1ae) {
                        param_1 = (int *)((uint)param_1 | 0x400);
                    } else {
                        if (iVar2 != 0x1bc)
                            goto LAB_0001cf90;
                        param_1 = (int *)((uint)param_1 | 0x1000);
                    }
                }
                piVar4 = (int *)*piVar4;
            } while (piVar4 != (int *)0x0);
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0001d014(int param_1, undefined4 param_2, void *param_3,
                  undefined4 param_4, undefined4 param_5, undefined4 param_6,
                  int param_7)

{
    int iVar1;
    int iVar2;
    char *pcVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    int local_38;
    int local_34;
    int local_30;
    int local_2c;
    int local_28;
    int local_24;
    int local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_1 == 0) {
        if (0x1c < *(uint *)(param_7 + 0x10)) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_config.c", 0xdfe, 2,
                         "sizeof(peeraddr) >= res->ai_addrlen");
        }
        local_38 = param_1;
        local_34 = param_1;
        local_30 = param_1;
        local_2c = param_1;
        local_28 = param_1;
        local_24 = param_1;
        local_20 = param_1;
        __memcpy_chk(&local_38, *(undefined4 *)(param_7 + 0x14),
                     *(uint *)(param_7 + 0x10), 0x1c);
        if (((*(int *)((int)param_3 + 0x1c) == 0) ||
             (iVar2 = FUN_000278f8(param_3), iVar2 == 0)) &&
            (iVar2 = any_interface, (short)local_38 != 2)) {
            iVar2 = any6_interface;
        }
        iVar1 = FUN_00033d98(&local_38, iVar2, 0, 4);
        if (iVar1 == 0) {
            uVar4 = FUN_00028fb4(iVar2);
            uVar5 = FUN_0007c2e8(&local_38);
            FUN_00074e00(3, "set trap %s -> %s failed.", uVar4, uVar5);
        }
        if (local_1c != __stack_chk_guard) {
        LAB_0001d128:
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
    } else {
        pcVar3 = gai_strerror(param_1);
        FUN_00074e00(3, "giving up resolving trap host %s: %s (%d)", param_4,
                     pcVar3, param_1);
        if (local_1c != __stack_chk_guard)
            goto LAB_0001d128;
    }
    free(param_3);
    return;
}

void FUN_0001d1a8(int param_1, undefined4 param_2, undefined4 *param_3,
                  undefined4 param_4, undefined4 param_5, undefined4 param_6,
                  int param_7)

{
    int iVar1;
    undefined4 uVar2;
    char *pcVar3;
    undefined *puVar4;
    undefined1 auStack_40[28];
    int local_24;

    local_24 = __stack_chk_guard;
    if (param_1 == 0) {
        if (param_7 != 0) {
            do {
                __memcpy_chk(auStack_40, *(undefined4 *)(param_7 + 0x14),
                             *(undefined4 *)(param_7 + 0x10), 0x1c);
                iVar1 = FUN_0001cc78(auStack_40, param_3[1]);
                if (iVar1 != 0) {
                    if ((ntp_syslogmask & 1) != 0) {
                        if (*(short *)(param_3 + 2) == 10) {
                            puVar4 = &UNK_0009c348;
                        } else if (*(short *)(param_3 + 2) == 2) {
                            puVar4 = &DAT_0009c350;
                        } else {
                            puVar4 = &DAT_000a7f7c;
                        }
                        uVar2 = FUN_0007c2e8(auStack_40);
                        FUN_00074e00(6, "DNS %s %s-> %s", param_4, puVar4,
                                     uVar2);
                    }
                    FUN_00042898(auStack_40, 0, 0, 0xffffffff,
                                 *(undefined1 *)(param_3 + 4),
                                 *(undefined1 *)((int)param_3 + 0x11),
                                 *(undefined1 *)((int)param_3 + 0x12),
                                 *(undefined1 *)((int)param_3 + 0x13), *param_3,
                                 param_3[5], param_3[3], param_3[6]);
                    break;
                }
                param_7 = *(int *)(param_7 + 0x1c);
            } while (param_7 != 0);
        }
        if (local_24 == __stack_chk_guard) {
            free(param_3);
            return;
        }
    } else {
        free(param_3);
        pcVar3 = gai_strerror(param_1);
        FUN_00074e00(3, "giving up resolving host %s: %s (%d)", param_4, pcVar3,
                     param_1);
        if (local_24 == __stack_chk_guard) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001d580(char *param_1)

{
    int iVar1;
    int iVar2;
    size_t __n;
    char *__s2;
    int *piVar3;
    char *pcVar4;
    char *__s1;
    uint *puVar5;

    iVar1 = __stack_chk_guard;
    piVar3 = (int *)&DAT_000c601c;
    pcVar4 = DAT_000c601c;
    if (DAT_000c601c != (char *)0x0) {
        do {
            iVar2 = strcmp(param_1, pcVar4);
            if (iVar2 == 0) {
                iVar2 = piVar3[1];
                if (iVar2 != 0)
                    goto LAB_0001d5e4;
                break;
            }
            piVar3 = piVar3 + 2;
            pcVar4 = (char *)*piVar3;
        } while (pcVar4 != (char *)0x0);
    }
    pcVar4 = DAT_000c606c;
    __s1 = param_1;
    if (DAT_000c606c != (char *)0x0) {
        puVar5 = (uint *)&DAT_000c606c;
        do {
            __n = strlen(pcVar4);
            iVar2 = strncmp(param_1, pcVar4, __n);
            if (iVar2 == 0) {
                pcVar4 = (char *)puVar5[1];
                __s1 = param_1 + __n;
                break;
            }
            puVar5 = puVar5 + 2;
            pcVar4 = (char *)*puVar5;
        } while (pcVar4 != (char *)0x0);
    }
    if (DAT_000c6094 != (char *)0x0) {
        piVar3 = (int *)&DAT_000c6094;
        __s2 = DAT_000c6094;
        do {
            iVar2 = strcmp(__s1, __s2);
            if (iVar2 == 0) {
                if (piVar3[1] != 0) {
                    iVar2 = piVar3[1] << ((uint)pcVar4 & 0xff);
                    goto LAB_0001d5e4;
                }
                break;
            }
            piVar3 = piVar3 + 2;
            __s2 = (char *)*piVar3;
        } while (__s2 != (char *)0x0);
    }
    FUN_00074e00(3, "logconfig: \'%s\' not recognized - ignored", param_1);
    iVar2 = 0;
LAB_0001d5e4:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

void FUN_0001d6d4(int param_1, FILE *param_2, int param_3)

{
    bool bVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    char *pcVar4;
    size_t sVar5;
    void *__ptr;
    void *__ptr_00;
    tm *__tp;
    int iVar6;
    char *pcVar7;
    int *piVar8;
    int *piVar9;
    int *piVar10;
    int iVar11;
    char *__s1;
    undefined2 local_88[2];
    undefined1 local_84;
    undefined1 local_83;
    char local_7c[80];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_3 != 0) {
        __tp = localtime((time_t *)(param_1 + 0x20));
        sVar5 = strftime(local_7c, 0x50, "%Y-%m-%d %H:%M:%S", __tp);
        if (sVar5 == 0) {
            local_7c[0] = '\0';
        }
        if (*(int *)(param_1 + 0xc) == 1) {
            pcVar4 = "ntpq remote config from";
        } else {
            pcVar4 = "startup configuration file";
        }
        __fprintf_chk(param_2, 1, "# %s %s %s\n", local_7c, pcVar4,
                      *(undefined4 *)(param_1 + 0x18));
    }
    if (*(int **)(param_1 + 0xa0) != (int *)0x0) {
        for (piVar8 = (int *)**(int **)(param_1 + 0xa0); piVar8 != (int *)0x0;
             piVar8 = (int *)*piVar8) {
            while (iVar6 = piVar8[2], iVar6 != 0x13f) {
                piVar9 = piVar8;
                if (iVar6 == 0x1a3) {
                    uVar2 = FUN_0002c0bc(piVar8[1]);
                    iVar6 = piVar8[4];
                    __fprintf_chk(param_2, 1, "%s \"%s\"", uVar2, iVar6);
                    if (((piVar8[1] == 0x122) &&
                         (piVar9 = (int *)*piVar8, piVar9 != (int *)0x0)) &&
                        (piVar9[1] == 0x1b9)) {
                        uVar2 = FUN_0001c7c0((int)*(undefined8 *)(piVar9 + 4));
                        __fprintf_chk(param_2, 1, " %s\n", uVar2, iVar6);
                    } else {
                        fputc(10, param_2);
                        piVar9 = piVar8;
                    }
                } else if (iVar6 == 0x121) {
                    uVar2 = FUN_0002c0bc(piVar8[1]);
                    uVar3 = FUN_0001c7c0((int)*(undefined8 *)(piVar8 + 4));
                    __fprintf_chk(param_2, 1, "%s %s\n", uVar2, uVar3);
                }
                piVar8 = (int *)*piVar9;
                if (piVar8 == (int *)0x0)
                    goto LAB_0001d7d0;
            }
            uVar2 = FUN_0002c0bc(piVar8[1]);
            __fprintf_chk(param_2, 1, "%s %d\n", uVar2, piVar8[4]);
        }
    }
LAB_0001d7d0:
    if ((*(int **)(param_1 + 0x8c) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x8c), piVar8 != (int *)0x0)) {
        fwrite("logconfig", 1, 9, param_2);
        do {
            __fprintf_chk(param_2, 1, " %c%s", piVar8[1], piVar8[4]);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int *)(param_1 + 0x40) != 0) {
        __fprintf_chk(param_2, 1, "statsdir \"%s\"\n");
    }
    if ((*(int **)(param_1 + 0x3c) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x3c), piVar8 != (int *)0x0)) {
        fwrite("statistics", 1, 10, param_2);
        do {
            uVar2 = FUN_0002c0bc(piVar8[1]);
            __fprintf_chk(param_2, 1, " %s", uVar2);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x44) != (int *)0x0) {
        for (piVar8 = (int *)**(int **)(param_1 + 0x44); piVar8 != (int *)0x0;
             piVar8 = (int *)*piVar8) {
            while (((int *)piVar8[2] == (int *)0x0 ||
                    (piVar9 = *(int **)piVar8[2], piVar9 == (int *)0x0))) {
                piVar8 = (int *)*piVar8;
                if (piVar8 == (int *)0x0)
                    goto LAB_0001d9d0;
            }
            uVar2 = FUN_0002c0bc(piVar8[1]);
            __fprintf_chk(param_2, 1, "filegen %s", uVar2);
            do {
                while (iVar6 = piVar9[1], iVar6 == 0x1b1) {
                    uVar2 = FUN_0002c0bc(piVar9[4]);
                    __fprintf_chk(param_2, 1, " type %s", uVar2);
                    piVar9 = (int *)*piVar9;
                    if (piVar9 == (int *)0x0)
                        goto LAB_0001d9b8;
                }
                if (iVar6 == 0x1be) {
                    uVar2 = FUN_0002c0bc(piVar9[4]);
                    __fprintf_chk(param_2, 1, " %s", uVar2);
                } else if (iVar6 == 0x12a) {
                    __fprintf_chk(param_2, 1, " file %s", piVar9[4]);
                }
                piVar9 = (int *)*piVar9;
            } while (piVar9 != (int *)0x0);
        LAB_0001d9b8:
            fputc(10, param_2);
        }
    }
LAB_0001d9d0:
    if ((*(int **)(param_1 + 0x70) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x70), piVar8 != (int *)0x0)) {
        fwrite("crypto", 1, 6, param_2);
        do {
            uVar2 = FUN_0002c0bc(piVar8[1]);
            __fprintf_chk(param_2, 1, " %s %s", uVar2, piVar8[4]);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int *)(param_1 + 0x80) != 0) {
        __fprintf_chk(param_2, 1, "revoke %d\n");
    }
    if (*(int *)(param_1 + 0x78) != 0) {
        __fprintf_chk(param_2, 1, "keysdir \"%s\"\n");
    }
    if (*(int *)(param_1 + 0x74) != 0) {
        __fprintf_chk(param_2, 1, "keys \"%s\"\n");
    }
    if ((*(int **)(param_1 + 0x84) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x84), piVar8 != (int *)0x0)) {
        fwrite("trustedkey", 1, 10, param_2);
        do {
            while (piVar8[2] == 0x13f) {
                __fprintf_chk(param_2, 1, " %d", piVar8[4]);
                piVar8 = (int *)*piVar8;
                if (piVar8 == (int *)0x0)
                    goto LAB_0001db1c;
            }
            if (piVar8[2] == 0x141) {
                __fprintf_chk(param_2, 1, " (%d ... %d)", piVar8[4], piVar8[5]);
            }
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
    LAB_0001db1c:
        fputc(10, param_2);
    }
    if (*(int *)(param_1 + 0x68) != 0) {
        __fprintf_chk(param_2, 1, "controlkey %d\n");
    }
    if (*(int *)(param_1 + 0x7c) != 0) {
        __fprintf_chk(param_2, 1, "requestkey %d\n");
    }
    bVar1 = true;
    if (*(int **)(param_1 + 0x60) == (int *)0x0)
        goto LAB_0001dbb0;
    piVar8 = (int *)**(int **)(param_1 + 0x60);
    pcVar4 = "enable";
    if (piVar8 == (int *)0x0)
        goto LAB_0001dbb0;
    do {
        fputs(pcVar4, param_2);
        do {
            uVar2 = FUN_0002c0bc(piVar8[4]);
            __fprintf_chk(param_2, 1, " %s", uVar2);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    LAB_0001dbb0:
    } while (
        ((bVar1) && (*(undefined4 **)(param_1 + 100) != (undefined4 *)0x0)) &&
        (piVar8 = (int *)**(undefined4 **)(param_1 + 100), pcVar4 = "disable",
         bVar1 = false, piVar8 != (int *)0x0));
    if ((*(int **)(param_1 + 0x38) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x38), piVar8 != (int *)0x0)) {
        fwrite(&DAT_0009c568, 1, 3, param_2);
        do {
            while (piVar8[2] == 0x121) {
                uVar2 = FUN_0002c0bc(piVar8[1]);
                uVar3 = FUN_0001c7c0((int)*(undefined8 *)(piVar8 + 4));
                __fprintf_chk(param_2, 1, " %s %s", uVar2, uVar3);
                piVar8 = (int *)*piVar8;
                if (piVar8 == (int *)0x0)
                    goto LAB_0001dd3c;
            }
            if (piVar8[2] == 0x13f) {
                if (piVar8[1] == 0x10b) {
                    FUN_00075bf4(
                        local_88,
                        "Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m" +
                            piVar8[4] + 0x1c);
                    uVar2 = FUN_0002c0bc(piVar8[1]);
                    __fprintf_chk(param_2, 1, " %s \"%04hu-%02hu-%02hu\"",
                                  uVar2, local_88[0], local_84, local_83);
                } else {
                    uVar2 = FUN_0002c0bc();
                    __fprintf_chk(param_2, 1, " %s %d", uVar2, piVar8[4]);
                }
            }
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
    LAB_0001dd3c:
        fputc(10, param_2);
    }
    if ((*(int **)(param_1 + 0x58) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x58), piVar8 != (int *)0x0)) {
        fwrite("rlimit", 1, 6, param_2);
        do {
            if (piVar8[2] != 0x13f) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_config.c", 0x2f8, 2, "319 == atrv->type");
            }
            uVar2 = FUN_0002c0bc(piVar8[1]);
            __fprintf_chk(param_2, 1, " %s %d", uVar2, piVar8[4]);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if ((*(int **)(param_1 + 0x5c) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x5c), piVar8 != (int *)0x0)) {
        fwrite("tinker", 1, 6, param_2);
        do {
            if (piVar8[2] != 0x121) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_config.c", 0x303, 2, "289 == atrv->type");
            }
            uVar2 = FUN_0002c0bc(piVar8[1]);
            uVar3 = FUN_0001c7c0((int)*(undefined8 *)(piVar8 + 4));
            __fprintf_chk(param_2, 1, " %s %s", uVar2, uVar3);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int *)(param_1 + 0x2c) != 0) {
        fwrite("broadcastclient\n", 1, 0x10, param_2);
    }
    if (*(int **)(param_1 + 0x24) != (int *)0x0) {
        for (piVar8 = (int *)**(int **)(param_1 + 0x24); piVar8 != (int *)0x0;
             piVar8 = (int *)*piVar8) {
            iVar6 = piVar8[2];
            pcVar4 = (char *)FUN_0002c0bc(piVar8[1]);
            fputs(pcVar4, param_2);
            if (*(short *)(iVar6 + 8) == 2) {
                fwrite(&DAT_0009c5d8, 1, 3, param_2);
            } else if (*(short *)(iVar6 + 8) == 10) {
                fwrite(&DAT_0009c5dc, 1, 3, param_2);
            }
            __fprintf_chk(param_2, 1, " %s", *(undefined4 *)(iVar6 + 4));
            if (*(char *)(piVar8 + 4) != '\0') {
                __fprintf_chk(param_2, 1, " minpoll %u");
            }
            if (*(char *)((int)piVar8 + 0x11) != '\0') {
                __fprintf_chk(param_2, 1, " maxpoll %u");
            }
            iVar11 = piVar8[5];
            if (iVar11 != 0) {
                pcVar4 = *(char **)(iVar6 + 4);
                sVar5 = strlen(pcVar4);
                if ((sVar5 < 9) ||
                    (iVar6 = memcmp(pcVar4, "127.127.", 8), iVar6 != 0)) {
                    __fprintf_chk(param_2, 1, " ttl %u", iVar11);
                } else {
                    __fprintf_chk(param_2, 1, " mode %u", iVar11);
                }
            }
            if (*(char *)(piVar8 + 6) != '\x04') {
                __fprintf_chk(param_2, 1, " version %u");
            }
            if (piVar8[7] != 0) {
                __fprintf_chk(param_2, 1, " key %u");
            }
            if (piVar8[8] != 0) {
                __fprintf_chk(param_2, 1, " ident \"%s\"");
            }
            if (((int *)piVar8[3] != (int *)0x0) &&
                (piVar9 = *(int **)piVar8[3], piVar9 != (int *)0x0)) {
                if (piVar9[1] != 0x1be) {
                LAB_0001ec88:
                    /* WARNING: Subroutine does not return */
                    FUN_0007ecc0("ntp_config.c", 0x340, 2, "446 == atrv->attr");
                }
                iVar6 = piVar9[2];
                while (true) {
                    if (iVar6 != 0x13f) {
                        /* WARNING: Subroutine does not return */
                        FUN_0007ecc0("ntp_config.c", 0x341, 2,
                                     "319 == atrv->type");
                    }
                    uVar2 = FUN_0002c0bc(piVar9[4]);
                    __fprintf_chk(param_2, 1, " %s", uVar2);
                    piVar9 = (int *)*piVar9;
                    if (piVar9 == (int *)0x0)
                        break;
                    if (piVar9[1] != 0x1be)
                        goto LAB_0001ec88;
                    iVar6 = piVar9[2];
                }
            }
            fputc(10, param_2);
            if (*(int **)(param_1 + 0x54) != (int *)0x0) {
                for (piVar9 = (int *)**(int **)(param_1 + 0x54);
                     piVar9 != (int *)0x0; piVar9 = (int *)*piVar9) {
                    while (true) {
                        pcVar4 = *(char **)(piVar8[2] + 4);
                        iVar6 = strcmp(pcVar4, *(char **)(piVar9[1] + 4));
                        if (iVar6 != 0)
                            break;
                        __fprintf_chk(param_2, 1, "fudge %s", pcVar4);
                        if ((int *)piVar9[2] != (int *)0x0) {
                            for (piVar10 = *(int **)piVar9[2];
                                 piVar10 != (int *)0x0;
                                 piVar10 = (int *)*piVar10) {
                                while (iVar6 = piVar10[2], iVar6 != 0x13f) {
                                    if (iVar6 == 0x1a3) {
                                        uVar2 = FUN_0002c0bc(piVar10[1]);
                                        __fprintf_chk(param_2, 1, " %s %s",
                                                      uVar2, piVar10[4]);
                                    } else if (iVar6 == 0x121) {
                                        uVar2 = FUN_0002c0bc(piVar10[1]);
                                        uVar3 = FUN_0001c7c0(
                                            (int)*(undefined8 *)(piVar10 + 4));
                                        __fprintf_chk(param_2, 1, " %s %s",
                                                      uVar2, uVar3);
                                    }
                                    piVar10 = (int *)*piVar10;
                                    if (piVar10 == (int *)0x0)
                                        goto LAB_0001e150;
                                }
                                uVar2 = FUN_0002c0bc(piVar10[1]);
                                __fprintf_chk(param_2, 1, " %s %d", uVar2,
                                              piVar10[4]);
                            }
                        }
                    LAB_0001e150:
                        fputc(10, param_2);
                        piVar9 = (int *)*piVar9;
                        if (piVar9 == (int *)0x0)
                            goto LAB_0001e168;
                    }
                }
            }
        LAB_0001e168:
        }
    }
    if ((*(int **)(param_1 + 0x30) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x30), piVar8 != (int *)0x0)) {
        fwrite("manycastserver", 1, 0xe, param_2);
        do {
            __fprintf_chk(param_2, 1, " %s", piVar8[1]);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if ((*(int **)(param_1 + 0x34) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x34), piVar8 != (int *)0x0)) {
        fwrite("multicastclient", 1, 0xf, param_2);
        do {
            __fprintf_chk(param_2, 1, " %s", piVar8[1]);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x28) != (int *)0x0) {
        for (piVar8 = (int *)**(int **)(param_1 + 0x28); piVar8 != (int *)0x0;
             piVar8 = (int *)*piVar8) {
            __fprintf_chk(param_2, 1, "unpeer %s\n",
                          *(undefined4 *)(piVar8[2] + 4));
        }
    }
    if ((*(int **)(param_1 + 0x4c) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x4c), piVar8 != (int *)0x0)) {
        fwrite(&DAT_0009c678, 1, 3, param_2);
        do {
            uVar2 = FUN_0002c0bc(piVar8[1]);
            __fprintf_chk(param_2, 1, " %s %d", uVar2, piVar8[4]);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if ((*(int **)(param_1 + 0x48) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x48), piVar8 != (int *)0x0)) {
        fwrite("discard", 1, 7, param_2);
        do {
            uVar2 = FUN_0002c0bc(piVar8[1]);
            __fprintf_chk(param_2, 1, " %s %d", uVar2, piVar8[4]);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x50) != (int *)0x0) {
        for (piVar8 = (int *)**(int **)(param_1 + 0x50); piVar8 != (int *)0x0;
             piVar8 = (int *)*piVar8) {
            iVar6 = piVar8[1];
            if (iVar6 == 0) {
                if ((int *)piVar8[3] == (int *)0x0) {
                    pcVar4 = "default";
                } else {
                    piVar9 = *(int **)piVar8[3];
                    if (piVar9 == (int *)0x0) {
                        pcVar4 = "default";
                    } else if (piVar9[1] == 0x199) {
                        pcVar4 = "source";
                    } else {
                        do {
                            piVar9 = (int *)*piVar9;
                            if (piVar9 == (int *)0x0) {
                                pcVar4 = "default";
                                goto LAB_0001e3d0;
                            }
                        } while (piVar9[1] != 0x199);
                        pcVar4 = "source";
                    }
                }
            LAB_0001e3d0:
                __fprintf_chk(param_2, 1, "restrict %s", pcVar4);
                iVar6 = piVar8[2];
                if (iVar6 != 0) {
                LAB_0001e5e4:
                    __fprintf_chk(param_2, 1, " mask %s",
                                  *(undefined4 *)(iVar6 + 4));
                }
            } else {
                iVar11 = piVar8[2];
                pcVar4 = *(char **)(iVar6 + 4);
                if (iVar11 == 0)
                    goto LAB_0001e3d0;
                __s1 = *(char **)(iVar11 + 4);
                if ((*(short *)(iVar6 + 8) != 2) ||
                    (iVar6 = strcmp(pcVar4, "0.0.0.0"), iVar6 != 0)) {
                LAB_0001e3c4:
                    if (*(short *)(iVar11 + 8) != 10)
                        goto LAB_0001e3d0;
                    if ((*pcVar4 == ':') && (pcVar4[1] == ':')) {
                        if (pcVar4[2] == '\0') {
                            if ((*__s1 != ':') || (__s1[1] != ':'))
                                goto LAB_0001e5c0;
                            if (__s1[2] == '\0') {
                                pcVar7 = "-6 default";
                                goto LAB_0001e638;
                            }
                        }
                        goto LAB_0001e3d0;
                    }
                LAB_0001e5c0:
                    __fprintf_chk(param_2, 1, "restrict %s", pcVar4);
                    iVar6 = piVar8[2];
                    if (iVar6 == 0)
                        goto LAB_0001e3f0;
                    goto LAB_0001e5e4;
                }
                iVar6 = strcmp(__s1, "0.0.0.0");
                pcVar7 = "-4 default";
                if (iVar6 != 0)
                    goto LAB_0001e3c4;
            LAB_0001e638:
                __fprintf_chk(param_2, 1, "restrict %s", pcVar7);
            }
        LAB_0001e3f0:
            __fprintf_chk(param_2, 1, " ippeerlimit %d",
                          (int)*(short *)(piVar8 + 5));
            if ((int *)piVar8[3] != (int *)0x0) {
                for (piVar9 = *(int **)piVar8[3]; piVar9 != (int *)0x0;
                     piVar9 = (int *)*piVar9) {
                    if (piVar9[1] != 0x199) {
                        uVar2 = FUN_0002c0bc();
                        __fprintf_chk(param_2, 1, " %s", uVar2);
                    }
                }
            }
            fputc(10, param_2);
        }
    }
    if (*(int **)(param_1 + 0xa4) != (int *)0x0) {
        for (piVar8 = (int *)**(int **)(param_1 + 0xa4); piVar8 != (int *)0x0;
             piVar8 = (int *)*piVar8) {
            uVar2 = FUN_0002c0bc(piVar8[3]);
            if (piVar8[1] == 0) {
                uVar3 = piVar8[2];
            } else {
                uVar3 = FUN_0002c0bc();
            }
            __fprintf_chk(param_2, 1, "interface %s %s\n", uVar2, uVar3);
        }
    }
    if ((*(int **)(param_1 + 0x90) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x90), piVar8 != (int *)0x0)) {
        fwrite("phone", 1, 5, param_2);
        do {
            __fprintf_chk(param_2, 1, " \"%s\"", piVar8[1]);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x94) != (int *)0x0) {
        for (piVar8 = (int *)**(int **)(param_1 + 0x94); piVar8 != (int *)0x0;
             piVar8 = (int *)*piVar8) {
            __ptr = (void *)FUN_0002c50c(piVar8[1]);
            __ptr_00 = (void *)FUN_0002c50c(piVar8[2]);
            __fprintf_chk(param_2, 1, "setvar %s = %s", __ptr, __ptr_00);
            free(__ptr);
            free(__ptr_00);
            if (piVar8[3] != 0) {
                fwrite(" default", 1, 8, param_2);
            }
            fputc(10, param_2);
        }
    }
    if ((*(int **)(param_1 + 0x98) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0x98), piVar8 != (int *)0x0)) {
        fwrite(&DAT_0009c6f4, 1, 3, param_2);
        do {
            __fprintf_chk(param_2, 1, " %d", piVar8[1]);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if (*(int **)(param_1 + 0x9c) != (int *)0x0) {
        for (piVar8 = (int *)**(int **)(param_1 + 0x9c); piVar8 != (int *)0x0;
             piVar8 = (int *)*piVar8) {
            __fprintf_chk(param_2, 1, "trap %s",
                          *(undefined4 *)(piVar8[1] + 4));
            if ((int *)piVar8[2] != (int *)0x0) {
                for (piVar9 = *(int **)piVar8[2]; piVar9 != (int *)0x0;
                     piVar9 = (int *)*piVar9) {
                    while (piVar9[1] != 0x140) {
                        if (piVar9[1] == 0x189) {
                            __fprintf_chk(param_2, 1, " port %d", piVar9[4]);
                        }
                        piVar9 = (int *)*piVar9;
                        if (piVar9 == (int *)0x0)
                            goto LAB_0001ea0c;
                    }
                    __fprintf_chk(param_2, 1, " interface %s", piVar9[4]);
                }
            }
        LAB_0001ea0c:
            fputc(10, param_2);
        }
    }
    if ((*(int **)(param_1 + 0xa8) != (int *)0x0) &&
        (piVar8 = (int *)**(int **)(param_1 + 0xa8), piVar8 != (int *)0x0)) {
        fwrite("reset", 1, 5, param_2);
        do {
            uVar2 = FUN_0002c0bc(piVar8[1]);
            __fprintf_chk(param_2, 1, " %s", uVar2);
            piVar8 = (int *)*piVar8;
        } while (piVar8 != (int *)0x0);
        fputc(10, param_2);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(0);
}

void FUN_0001ed20(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    uint uVar2;
    int *piVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    if (cfg_tree_history == (int *)0x0) {
        uVar4 = 0;
    } else {
        uVar4 = 0;
        piVar3 = cfg_tree_history;
        do {
            uVar2 = FUN_0001d6d4(piVar3, param_1, param_2);
            piVar3 = (int *)*piVar3;
            uVar4 = uVar4 | uVar2;
        } while (piVar3 != (int *)0x0);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar4);
    }
    return;
}

void FUN_0001edb0(undefined4 *param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 *puVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 == (undefined4 *)0x0) {
        param_1 = (undefined4 *)FUN_00073ba4(0, 8, 0, 1);
    }
    if (param_2 != (undefined4 *)0x0) {
        puVar2 = (undefined4 *)param_1[1];
        *param_2 = 0;
        if (puVar2 == (undefined4 *)0x0) {
            *param_1 = param_2;
            param_1[1] = param_1;
        } else {
            *(undefined4 **)*puVar2 = param_2;
            param_1[1] = *puVar2;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_1);
    }
    return;
}

void FUN_0001ee48(undefined4 *param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 uVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;

    iVar1 = __stack_chk_guard;
    puVar2 = param_2;
    if ((param_1 != (undefined4 *)0x0) &&
        (puVar2 = param_1, param_2 != (undefined4 *)0x0)) {
        puVar5 = (undefined4 *)param_2[1];
        if (puVar5 != (undefined4 *)0x0) {
            puVar4 = (undefined4 *)param_1[1];
            if (puVar4 == (undefined4 *)0x0) {
                uVar3 = param_2[1];
                *param_1 = *param_2;
                param_1[1] = uVar3;
            } else {
                *(undefined4 *)*puVar4 = *param_2;
                if (puVar5 == param_2) {
                    puVar5 = (undefined4 *)*puVar4;
                }
                param_1[1] = puVar5;
            }
        }
        free(param_2);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(puVar2);
    }
    return;
}

void FUN_0001eef0(int *param_1, code *param_2)

{
    int iVar1;
    int *piVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 != (int *)0x0) {
        if (param_2 == (code *)0x0) {
            param_2 = free;
        }
        while (piVar2 = (int *)*param_1, piVar2 != (int *)0x0) {
            iVar3 = *piVar2;
            *param_1 = iVar3;
            if (iVar3 == 0) {
                param_1[1] = 0;
            } else if ((int *)param_1[1] == piVar2) {
                param_1[1] = (int)param_1;
            }
            (*param_2)();
        }
        free(param_1);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(0);
    }
    return;
}

void destroy_attr_val(void *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (param_1 == (void *)0x0) {
        return;
    }
    if (*(int *)((int)param_1 + 8) == 0x1a3) {
        free(*(void **)((int)param_1 + 0x10));
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    free(param_1);
    return;
}

void FUN_0001f020(undefined4 param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    undefined8 in_d0;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0x18, 0, 1);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    *(undefined8 *)(iVar3 + 0x10) = in_d0;
    *(undefined4 *)(iVar3 + 8) = 0x121;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f098(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0x18, 0, 1);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    *(undefined4 *)(iVar3 + 0x10) = param_2;
    *(undefined4 *)(iVar3 + 8) = 0x13f;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f108(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0x18, 0, 1);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    *(undefined4 *)(iVar3 + 0x10) = param_2;
    *(undefined4 *)(iVar3 + 8) = 0x1b2;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f178(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0x18, 0, 1);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    *(undefined4 *)(iVar3 + 0x10) = param_2;
    *(undefined4 *)(iVar3 + 0x14) = param_3;
    *(undefined4 *)(iVar3 + 8) = 0x141;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f1f0(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0x18, 0, 1);
    *(undefined4 *)(iVar3 + 4) = param_1;
    if (param_2 == 0) {
        param_2 = FUN_00073d08(&DAT_000a7f7c);
    }
    iVar2 = __stack_chk_guard;
    *(int *)(iVar3 + 0x10) = param_2;
    *(undefined4 *)(iVar3 + 8) = 0x1a3;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

void FUN_0001f288(undefined4 param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 8, 0, 1);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f2e8(undefined4 param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 8, 0, 1);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f348(int param_1, uint param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_config.c", 0x4f3, 0, "((void *)0) != addr");
    }
    if ((param_2 & 0xfffffffd) != 0 && param_2 != 10) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_config.c", 0x4f4, 0,
                     "2 == type || 10 == type || 0 == type");
    }
    iVar3 = FUN_00073ba4(0, 0xc, 0, 1);
    iVar2 = __stack_chk_guard;
    *(int *)(iVar3 + 4) = param_1;
    *(short *)(iVar3 + 8) = (short)param_2;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0001f410(void *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (param_1 == (void *)0x0) {
        return;
    }
    if (*(void **)((int)param_1 + 4) != (void *)0x0) {
        free(*(void **)((int)param_1 + 4));
        if (iVar1 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        free(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("ntp_config.c", 0x504, 0, "((void *)0) != my_node->address");
}

void FUN_0001f4b0(int param_1, int param_2, int *param_3)

{
    bool bVar1;
    int iVar2;
    int *__ptr;
    undefined4 uVar3;
    uint uVar4;
    int iVar5;
    int *__ptr_00;

    iVar2 = __stack_chk_guard;
    __ptr = (int *)FUN_00073ba4(0, 0x24, 0, 1);
    __ptr[1] = param_1;
    __ptr[2] = param_2;
    *(undefined1 *)(__ptr + 6) = 4;
    if (param_3 != (int *)0x0) {
        __ptr_00 = (int *)*param_3;
        if (__ptr_00 == (int *)0x0) {
            free(param_3);
        } else {
            bVar1 = false;
            do {
                while (true) {
                    iVar5 = *__ptr_00;
                    *param_3 = iVar5;
                    if (iVar5 == 0) {
                        param_3[1] = 0;
                    } else if ((int *)param_3[1] == __ptr_00) {
                        param_3[1] = (int)param_3;
                    }
                    iVar5 = __ptr_00[1];
                    if (iVar5 != 0x167)
                        break;
                    iVar5 = __ptr_00[4];
                    if (iVar5 - 3U < 0xfd) {
                        *(char *)(__ptr + 4) = (char)iVar5;
                    } else {
                        FUN_00074e00(6,
                                     "minpoll: provided value (%d) is out of "
                                     "range [%d-%d])",
                                     iVar5, 3, 0xff);
                        *(undefined1 *)(__ptr + 4) = 3;
                    }
                LAB_0001f5e8:
                    free(__ptr_00);
                    __ptr_00 = (int *)*param_3;
                    if (__ptr_00 == (int *)0x0)
                        goto LAB_0001f5fc;
                }
                if (iVar5 < 0x168) {
                    if (iVar5 == 0x149) {
                        if (__ptr_00[4] == -1) {
                            bVar1 = true;
                            FUN_00074e00(3, "key: invalid argument");
                        } else {
                            __ptr[7] = __ptr_00[4];
                        }
                    } else if (iVar5 == 0x15f) {
                        uVar4 = __ptr_00[4];
                        if (uVar4 < 0x12) {
                            *(char *)((int)__ptr + 0x11) = (char)uVar4;
                        } else {
                            FUN_00074e00(6,
                                         "maxpoll: provided value (%d) is out "
                                         "of range [0-%d])",
                                         uVar4, 0x11);
                            *(undefined1 *)((int)__ptr + 0x11) = 0x11;
                        }
                    } else {
                        if (iVar5 != 0x138)
                            goto LAB_0001f5cc;
                        __ptr[8] = __ptr_00[4];
                    }
                    goto LAB_0001f5e8;
                }
                if (iVar5 == 0x1b0) {
                    iVar5 = FUN_0001c8e0(param_2);
                    if (iVar5 == 0) {
                        uVar4 = __ptr_00[4];
                        if (uVar4 < 8) {
                        LAB_0001f6d4:
                            __ptr[5] = uVar4;
                        } else {
                            FUN_00074e00(3, "ttl: invalid argument");
                            bVar1 = true;
                        }
                    } else {
                        bVar1 = true;
                        FUN_00074e00(3, "\'ttl\' does not apply for refclocks");
                    }
                    goto LAB_0001f5e8;
                }
                if (iVar5 < 0x1b1) {
                    if (iVar5 == 0x169) {
                        iVar5 = FUN_0001c8e0(param_2);
                        if (iVar5 != 0) {
                            uVar4 = __ptr_00[4];
                            goto LAB_0001f6d4;
                        }
                        FUN_00074e00(
                            3, "\'mode\' does not apply for network peers");
                        bVar1 = true;
                    } else {
                    LAB_0001f5cc:
                        uVar3 = FUN_0002bbb4();
                        bVar1 = true;
                        FUN_00074e00(3, "Unknown peer/server option token %s",
                                     uVar3);
                    }
                    goto LAB_0001f5e8;
                }
                if (iVar5 == 0x1b8) {
                    if ((uint)__ptr_00[4] < 0xff) {
                        *(char *)(__ptr + 6) = (char)__ptr_00[4];
                    } else {
                        FUN_00074e00(3, "version: invalid argument");
                        bVar1 = true;
                    }
                    goto LAB_0001f5e8;
                }
                if (iVar5 != 0x1be)
                    goto LAB_0001f5cc;
                iVar5 = FUN_0001edb0(__ptr[3], __ptr_00);
                __ptr_00 = (int *)*param_3;
                __ptr[3] = iVar5;
            } while (__ptr_00 != (int *)0x0);
        LAB_0001f5fc:
            free(param_3);
            if (bVar1) {
                free(__ptr);
                __ptr = __ptr_00;
            }
        }
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__ptr);
    }
    return;
}

void FUN_0001f7bc(int param_1)

{
    ushort uVar1;
    int iVar2;
    int iVar3;
    ushort **ppuVar4;
    byte *pbVar5;
    uint uVar6;
    uint uVar7;

    iVar2 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0xc, 0, 1);
    ppuVar4 = __ctype_b_loc();
    uVar6 = 0;
    pbVar5 = (byte *)(*(int *)(param_1 + 4) + -1);
    while (true) {
        pbVar5 = pbVar5 + 1;
        uVar7 = (uint)*pbVar5;
        uVar1 = (*ppuVar4)[uVar7];
        if ((uVar1 & 0x800) == 0)
            break;
        uVar6 = (uVar7 - 0x30) + uVar6 * 10 | uVar6 & 0xff000000;
    }
    if (uVar7 == 0 && uVar6 < 0x10000) {
        *(short *)(iVar3 + 4) = (short)uVar6;
        *(uint *)(iVar3 + 8) = uVar1 & 0x800;
        FUN_0001f410(param_1);
    } else {
        *(undefined2 *)(iVar3 + 4) = 0;
        *(int *)(iVar3 + 8) = param_1;
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_0001f898(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0xc, 0, 1);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    *(undefined4 *)(iVar3 + 8) = param_2;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f900(undefined4 param_1, undefined4 param_2, undefined2 param_3,
                  undefined4 param_4, undefined4 param_5)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0x18, 0, 1);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    *(undefined4 *)(iVar3 + 8) = param_2;
    *(undefined2 *)(iVar3 + 0x14) = param_3;
    *(undefined4 *)(iVar3 + 0xc) = param_4;
    *(undefined4 *)(iVar3 + 0x10) = param_5;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001f980(char *param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    char *pcVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    pcVar3 = strchr(param_1, 0x3d);
    if (pcVar3 != (char *)0x0) {
        *pcVar3 = '\0';
    }
    iVar4 = FUN_00073ba4(0, 0x10, 0, 1);
    iVar2 = __stack_chk_guard;
    *(char **)(iVar4 + 4) = param_1;
    *(undefined4 *)(iVar4 + 8) = param_2;
    *(undefined4 *)(iVar4 + 0xc) = param_3;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0001fa04(int param_1, int param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = param_2;
    if (param_2 != 0) {
        iVar3 = 1;
    }
    if (param_1 != 0) {
        iVar3 = 1;
    }
    if (iVar3 != 0) {
        iVar2 = FUN_00073ba4(0, 0x10, 0, 1);
        iVar3 = __stack_chk_guard;
        *(int *)(iVar2 + 4) = param_1;
        *(int *)(iVar2 + 8) = param_2;
        *(undefined4 *)(iVar2 + 0xc) = param_3;
        if (iVar1 == iVar3) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("ntp_config.c", 0x698, 0,
                 "match_class != 0 || if_name != ((void *)0)");
}

void FUN_0001faac(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0xc, 0, 1);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    *(undefined4 *)(iVar3 + 8) = param_2;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0001fb14(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = FUN_00073ba4(0, 0xc, 0);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 4) = param_1;
    *(undefined4 *)(iVar3 + 8) = param_2;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Enum "__rlimit_resource": Some values do not have unique names */

void FUN_0001fb7c(__rlimit_resource_t param_1, undefined4 param_2, uint param_3,
                  uint param_4)

{
    int iVar1;
    undefined **ppuVar2;
    undefined **extraout_r12;
    bool bVar3;
    rlimit64 local_30;
    int local_1c;

    ppuVar2 = &__DT_PLTGOT;
    local_1c = __stack_chk_guard;
    if (param_1 == RLIMIT_NOFILE) {
        local_30.rlim_cur._0_4_ = param_3;
        local_30.rlim_cur._4_4_ = param_4;
        local_30.rlim_max._0_4_ = param_3;
        local_30.rlim_max._4_4_ = param_4;
        iVar1 = setrlimit64(RLIMIT_NOFILE, &local_30);
        if (iVar1 == -1) {
            FUN_00074e00(3, "Cannot set RLIMIT_NOFILE: %m");
        }
    } else {
        if (param_1 != __RLIMIT_MEMLOCK) {
            if (param_1 == RLIMIT_STACK) {
                iVar1 = getrlimit64(RLIMIT_STACK, &local_30);
                if (iVar1 == -1) {
                    FUN_00074e00(3, "getrlimit(RLIMIT_STACK) failed: %m");
                } else {
                    bVar3 = param_4 <= local_30.rlim_max._4_4_;
                    if (local_30.rlim_max._4_4_ == param_4) {
                        bVar3 = param_3 <= (uint)local_30.rlim_max;
                    }
                    if (!bVar3) {
                        FUN_00074e00(4,
                                     "ntp_rlimit: using maximum allowed stack "
                                     "limit %lu instead of %lu.",
                                     (uint)local_30.rlim_max, param_3);
                        param_3 = (uint)local_30.rlim_max;
                        param_4 = local_30.rlim_max._4_4_;
                    }
                    local_30.rlim_cur._0_4_ = param_3;
                    local_30.rlim_cur._4_4_ = param_4;
                    iVar1 = setrlimit64(RLIMIT_STACK, &local_30);
                    if (iVar1 == -1) {
                        FUN_00074e00(3,
                                     "ntp_rlimit: Cannot set RLIMIT_STACK: %m");
                    }
                }
                goto LAB_0001fbe8;
            }
            param_1 =
                FUN_0001c954("ntp_rlimit: unexpected RLIMIT case: %d", param_1);
            ppuVar2 = extraout_r12;
        }
        if ((*(uint *)(*(int *)(ppuVar2[0x281] + 0x44) + 0x5d0) & 0xf) == 0) {
            local_30.rlim_cur._0_4_ = param_3;
            local_30.rlim_cur._4_4_ = param_4;
            local_30.rlim_max._0_4_ = param_3;
            local_30.rlim_max._4_4_ = param_4;
            iVar1 = setrlimit64(param_1, &local_30);
            if (iVar1 == -1) {
                FUN_00074e00(3, "Cannot set RLIMIT_MEMLOCK: %m");
            }
        }
    }
LAB_0001fbe8:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_0001fd04(int param_1)

{
    int *piVar1;
    undefined2 uVar2;
    longlong lVar3;
    addrinfo *paVar4;
    undefined4 *puVar5;
    undefined4 *__dest;
    FILE *pFVar6;
    int iVar7;
    undefined4 uVar8;
    size_t sVar9;
    undefined4 *puVar10;
    size_t sVar11;
    int *piVar12;
    int iVar13;
    int iVar14;
    int extraout_r2;
    uint uVar15;
    undefined1 *puVar16;
    int iVar17;
    undefined4 uVar18;
    char *pcVar19;
    addrinfo *paVar20;
    char *pcVar21;
    char *pcVar22;
    void *pvVar23;
    addrinfo *paVar24;
    undefined **unaff_r8;
    undefined **ppuVar25;
    char *pcVar26;
    undefined1 uVar27;
    undefined **unaff_r9;
    undefined **ppuVar28;
    char *unaff_r11;
    int *piVar29;
    int *extraout_r12;
    undefined4 uVar30;
    bool bVar31;
    double dVar32;
    char *local_f8;
    undefined **local_f4;
    char *local_ec;
    char *local_e8;
    char *local_e4;
    addrinfo *local_d4;
    undefined4 local_d0;
    uint local_cc;
    undefined4 local_c8;
    undefined4 local_c4;
    int local_a8;
    int iStack_a4;
    int local_a0;
    int iStack_9c;
    int local_98;
    undefined4 local_94[4];
    undefined1 local_84[32];
    short local_64;
    ushort uStack_62;
    short local_60;
    ushort uStack_5e;
    short local_5c;
    ushort uStack_5a;
    short local_58;
    ushort uStack_56;
    short local_54;
    ushort uStack_52;
    short local_50;
    ushort uStack_4e;
    undefined1 auStack_4c[8];
    int local_44;

    local_44 = __stack_chk_guard;
    __dest = (undefined4 *)FUN_00073ba4(0, 0xb8, 0);
    memcpy(__dest, cfgt, 0xb8);
    memset(cfgt, 0, 0xb8);
    puVar10 = &cfg_tree_history;
    for (puVar5 = cfg_tree_history; puVar5 != (undefined4 *)0x0;
         puVar5 = (undefined4 *)*puVar5) {
        puVar10 = puVar5;
    }
    pcVar19 = (char *)0x0;
    *__dest = 0;
    *puVar10 = __dest;
    puVar16 = ntpdOptions;
    if ((*(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf) != 0) {
        pFVar6 = fopen64(*(char **)(ntpdOptions._68_4_ + 0x5d8), "w");
        if (pFVar6 == (FILE *)0x0) {
            piVar12 = __errno_location();
            iVar7 = *piVar12;
            FUN_00074cc4(stderr, "can not create save file %s, error %d %m\n",
                         *(undefined4 *)(ntpdOptions._68_4_ + 0x5d8), iVar7);
            /* WARNING: Subroutine does not return */
            exit(iVar7);
        }
        iVar7 = FUN_0001ed20(pFVar6, 0);
        if (iVar7 == 0) {
            __fprintf_chk(stderr, 1, "configuration saved to %s\n",
                          *(undefined4 *)(ntpdOptions._68_4_ + 0x5d8));
        } else {
            __fprintf_chk(stderr, 1, "--saveconfigquit %s error %d\n",
                          *(undefined4 *)(ntpdOptions._68_4_ + 0x5d8), iVar7);
        }
        /* WARNING: Subroutine does not return */
        exit(iVar7);
    }
    if (param_1 != 0) {
        if (((undefined4 *)__dest[0xe] == (undefined4 *)0x0) ||
            (pcVar19 = *(char **)__dest[0xe], pcVar19 == (char *)0x0)) {
            uVar15 = FUN_00076fd8();
            if (uVar15 < 0x63e0) {
                iVar7 = FUN_00076e18();
                FUN_0007702c(iVar7 + -0xb);
            }
        } else {
            iVar7 = 0;
            do {
                while (*(int *)(pcVar19 + 4) != 0x10b) {
                    pcVar19 = *(char **)pcVar19;
                    if (pcVar19 == (char *)0x0)
                        goto LAB_00022de8;
                }
                FUN_0007702c(*(undefined4 *)(pcVar19 + 0x10));
                pcVar19 = *(char **)pcVar19;
                iVar7 = param_1;
            } while (pcVar19 != (char *)0x0);
        LAB_00022de8:
            uVar15 = FUN_00076fd8();
            if (uVar15 < 0x63e0) {
                iVar14 = FUN_00076e18();
                FUN_0007702c(iVar14 + -0xb);
            }
            if (iVar7 != 0) {
                FUN_000702c8();
            }
        }
    }
    local_f4 = &__DT_PLTGOT;
    if (((undefined4 *)__dest[0x29] != (undefined4 *)0x0) &&
        (pcVar19 = *(char **)__dest[0x29], pcVar19 != (char *)0x0)) {
        if (((*(uint *)(ntpdOptions._68_4_ + 0x3d0) & 0xf) == 0) &&
            ((*(uint *)(ntpdOptions._68_4_ + 0x310) & 0xf) == 0)) {
            unaff_r8 = (undefined **)0xa8490;
            do {
                local_d0 = 0xffffffff;
                unaff_r9 = local_f4;
                if (*(int *)(pcVar19 + 8) == 0) {
                    iVar7 = *(int *)(pcVar19 + 4);
                    pcVar22 = (char *)0x0;
                    if (iVar7 == 0x144) {
                        uVar8 = 1;
                    } else {
                        if (iVar7 < 0x145) {
                            if (iVar7 == 0) {
                            LAB_0002312c:
                                /* WARNING: Subroutine does not return */
                                FUN_0007ecc0("ntp_config.c", 0xbeb, 2,
                                             "if_name != ((void *)0)");
                            }
                            bVar31 = iVar7 == 0x104;
                            if (!bVar31)
                                goto LAB_00023228;
                            uVar8 = 0;
                            goto LAB_00022a7c;
                        }
                        if (iVar7 == 0x146) {
                            uVar8 = 2;
                        } else {
                            bVar31 = iVar7 == 0x1bb;
                            if (!bVar31) {
                            LAB_00023228:
                                FUN_0001c954(
                                    "config_nic_rules: match-class-token=%d",
                                    iVar7);
                                if (bVar31) {
                                    _DAT_00000139 = (undefined2)iVar7;
                                }
                                /* WARNING: Bad instruction - Truncating control
                                 * flow here */
                                halt_baddata();
                            }
                            uVar8 = 3;
                        }
                    }
                    iVar7 = *(int *)(pcVar19 + 0xc);
                    if (iVar7 == 0x139) {
                    LAB_00022a58:
                        uVar18 = 1;
                    LAB_00022a2c:
                        FUN_00025e04(uVar8, pcVar22, local_d0, uVar18);
                        FUN_00050e80(current_time + 2);
                        if (pcVar22 != (char *)0x0)
                            goto LAB_0001ff28;
                    } else {
                        if (iVar7 != 0x152) {
                            if (iVar7 == 0x123) {
                            LAB_00022a28:
                                uVar18 = 2;
                                goto LAB_00022a2c;
                            }
                        LAB_0001ff9c:
                            FUN_0001c954("config_nic_rules: action-token=%d");
                            goto LAB_0001ffa8;
                        }
                        FUN_00025e04(uVar8, 0, 0xffffffff);
                        FUN_00050e80(current_time + 2);
                    }
                } else {
                    pcVar22 = (char *)FUN_00073d08(*(int *)(pcVar19 + 8));
                    iVar7 = *(int *)(pcVar19 + 4);
                    if (iVar7 == 0x144) {
                        uVar8 = 1;
                    LAB_00022a7c:
                        iVar7 = *(int *)(pcVar19 + 0xc);
                        if (iVar7 != 0x139) {
                            if (iVar7 != 0x152) {
                            LAB_00022a18:
                                if (iVar7 != 0x123)
                                    goto LAB_0001ff9c;
                                goto LAB_00022a28;
                            }
                            uVar18 = 0;
                            goto LAB_00022a2c;
                        }
                        goto LAB_00022a58;
                    }
                    if (0x144 < iVar7) {
                        if (iVar7 == 0x146) {
                            uVar8 = 2;
                        } else {
                            bVar31 = iVar7 == 0x1bb;
                            if (!bVar31)
                                goto LAB_00023228;
                            uVar8 = 3;
                        }
                        goto LAB_00022a7c;
                    }
                    if (iVar7 != 0) {
                        bVar31 = iVar7 == 0x104;
                        if (!bVar31)
                            goto LAB_00023228;
                        uVar8 = 0;
                        goto LAB_00022a7c;
                    }
                    if (pcVar22 == (char *)0x0)
                        goto LAB_0002312c;
                    unaff_r11 = strchr(pcVar22, 0x2f);
                    if (unaff_r11 == (char *)0x0) {
                        iVar7 = FUN_00074054(pcVar22, 0, local_84 + 0x1c);
                        if (iVar7 == 0) {
                            uVar8 = 4;
                            goto LAB_00022a7c;
                        }
                    LAB_00022c4c:
                        uVar8 = 5;
                    } else {
                        *unaff_r11 = '\0';
                        iVar7 = FUN_00074054(pcVar22, 0, local_84 + 0x1c);
                        if (iVar7 == 0) {
                            uVar8 = 4;
                            *unaff_r11 = '/';
                        } else {
                            iVar7 = sscanf(unaff_r11 + 1, "%d", &local_d0);
                            if (iVar7 != 1)
                                goto LAB_00022c4c;
                            uVar8 = 5;
                            if (local_84._28_2_ == 2) {
                                uVar15 = 0x20;
                            } else {
                                uVar15 = 0x80;
                            }
                            if ((int)local_d0 < -1) {
                                local_d0 = 0xffffffff;
                            }
                            if ((int)uVar15 <= (int)local_d0) {
                                local_d0 = uVar15;
                            }
                        }
                    }
                    iVar7 = *(int *)(pcVar19 + 0xc);
                    if (iVar7 == 0x139)
                        goto LAB_00022a58;
                    if (iVar7 != 0x152)
                        goto LAB_00022a18;
                    FUN_00025e04(uVar8, pcVar22, local_d0, 0);
                    FUN_00050e80(current_time + 2);
                LAB_0001ff28:
                    free(pcVar22);
                }
                pcVar19 = *(char **)pcVar19;
            } while (pcVar19 != (char *)0x0);
        } else {
            if (param_1 != 0) {
                FUN_00074e00(3,
                             "interface/nic rules are not allowed with "
                             "--interface (-I) or --novirtualips (-L)%s",
                             ", exiting");
                /* WARNING: Subroutine does not return */
                exit(1);
            }
        LAB_0001ffa8:
            FUN_00074e00(3,
                         "interface/nic rules are not allowed with --interface "
                         "(-I) or --novirtualips (-L)%s",
                         &DAT_000a7f7c);
        }
    }
    if (__dest[0x10] != 0) {
        FUN_0005294c(2);
    }
    if ((undefined4 *)__dest[0xf] != (undefined4 *)0x0) {
        for (pcVar19 = *(char **)__dest[0xf]; pcVar19 != (char *)0x0;
             pcVar19 = *(char **)pcVar19) {
            while (true) {
                uVar8 = FUN_0002c0bc(*(undefined4 *)(pcVar19 + 4));
                iVar7 = FUN_0003c718();
                if (iVar7 != 0)
                    break;
                FUN_00074e00(3, "stats %s unrecognized", uVar8);
                pcVar19 = *(char **)pcVar19;
                if (pcVar19 == (char *)0x0)
                    goto LAB_00020064;
            }
            FUN_0003c570(iVar7, statsdir, uVar8, *(undefined1 *)(iVar7 + 0x14),
                         *(byte *)(iVar7 + 0x15) | 0x80);
        }
    }
LAB_00020064:
    if ((int *)__dest[0x11] != (int *)0x0) {
        for (piVar12 = *(int **)__dest[0x11]; piVar12 != (int *)0x0;
             piVar12 = (int *)*piVar12) {
            unaff_r9 = (undefined **)FUN_0002c0bc(piVar12[1]);
            iVar7 = FUN_0003c718();
            if (iVar7 == 0) {
                FUN_00074e00(3, "filegen category \'%s\' unrecognized",
                             unaff_r9);
            } else {
                if (((int *)piVar12[2] != (int *)0x0) &&
                    (piVar29 = *(int **)piVar12[2], piVar29 != (int *)0x0)) {
                    pcVar19 = (char *)0x1b1;
                    unaff_r11 = (char *)0x1bd;
                    iVar14 = 0x186;
                    do {
                        iVar13 = piVar29[1];
                        if (iVar13 == 0x1b1) {
                            iVar13 = piVar29[4];
                            if (iVar13 != 0x173) {
                                if (iVar13 < 0x174) {
                                    if (((iVar13 != 0x11b) &&
                                         (iVar13 != 0x16c)) &&
                                        (iVar13 != 0x103)) {
                                    LAB_00020154:
                                        iVar7 = FUN_0001c954(
                                            "config-monitor: type-token=%d");
                                        iVar14 = extraout_r2;
                                        piVar29 = extraout_r12;
                                        goto LAB_00020160;
                                    }
                                } else if (((iVar13 != 0x1ba) &&
                                            (iVar13 != 0x1bd)) &&
                                           (iVar13 != iVar14))
                                    goto LAB_00020154;
                            }
                        } else if (iVar13 == 0x1be) {
                            iVar13 = piVar29[4];
                            if (iVar13 != 0x126) {
                                if (iVar13 < 0x127) {
                                    if (iVar13 != 0x11e)
                                        goto LAB_00023070;
                                } else if ((iVar13 != 0x151) &&
                                           (iVar13 != 0x170)) {
                                LAB_00023070:
                                    FUN_00074e00(
                                        3, "Unknown filegen flag token %d",
                                        iVar13);
                                    /* WARNING: Subroutine does not return */
                                    exit(1);
                                }
                            }
                        } else {
                            if (iVar13 != 0x12a) {
                                FUN_00074e00(3,
                                             "Unknown filegen option token %d",
                                             iVar13);
                                /* WARNING: Subroutine does not return */
                                exit(1);
                            }
                        LAB_00020160:
                            unaff_r9 = (undefined **)piVar29[4];
                        }
                        piVar29 = (int *)*piVar29;
                    } while (piVar29 != (int *)0x0);
                }
                FUN_0003c570(iVar7, statsdir, unaff_r9);
            }
            unaff_r8 = local_f4;
        }
    }
    if ((undefined4 *)__dest[0x1c] != (undefined4 *)0x0) {
        for (pcVar19 = *(char **)__dest[0x1c]; pcVar19 != (char *)0x0;
             pcVar19 = *(char **)pcVar19) {
            iVar7 = *(int *)(pcVar19 + 4);
            if (iVar7 == 0x138) {
                uVar8 = 2;
            } else if (iVar7 < 0x139) {
                if (iVar7 == 0x11d) {
                    uVar8 = 9;
                } else {
                    if (iVar7 != 0x135)
                        goto LAB_000231c8;
                    uVar8 = 1;
                }
            } else if (iVar7 == 0x18d) {
                uVar8 = 8;
            } else {
                if (iVar7 != 0x18e)
                    goto LAB_000231c8;
                uVar8 = 4;
            }
            FUN_0003bca8(uVar8, *(undefined4 *)(pcVar19 + 0x10));
        }
    }
    iVar7 = __dest[0x1e];
    if (iVar7 != 0) {
        pcVar19 = (char *)&keysdir;
        if (keysdir != &default_keysdir) {
            free(keysdir);
            iVar7 = __dest[0x1e];
        }
        keysdir = (undefined5 *)FUN_00073d08(iVar7);
    }
    iVar7 = __dest[0x22];
    if (iVar7 != 0) {
        pcVar19 = (char *)&ntp_signd_socket;
        if (ntp_signd_socket != &DAT_000c860c) {
            free(ntp_signd_socket);
            iVar7 = __dest[0x22];
        }
        ntp_signd_socket = (undefined *)FUN_00073d08(iVar7);
    }
    if ((__dest[0x1b] != 0) && (pcVar19 = (char *)&cryptosw, cryptosw == 0)) {
        FUN_0003b408();
        cryptosw = 1;
    }
    piVar12 = (int *)__dest[0x21];
    if (piVar12 != (int *)0x0) {
        piVar29 = (int *)*piVar12;
        if (piVar29 == (int *)0x0) {
            piVar12 = (int *)0x0;
        } else {
            piVar12 = (int *)0x0;
            pcVar19 = (char *)0x141;
            do {
                while (piVar29[2] != 0x13f) {
                    if (piVar29[2] != 0x141) {
                        /* WARNING: Subroutine does not return */
                        FUN_0007ecc0("ntp_config.c", 0x7dc, 0,
                                     "321 == my_val->type");
                    }
                    iVar7 = piVar29[5];
                    iVar14 = piVar29[4];
                    piVar29 = (int *)*piVar29;
                    if (iVar7 < 0x10000 && (0 < iVar14 && iVar14 <= iVar7)) {
                        piVar12 =
                            (int *)((int)piVar12 + ((iVar7 + 1) - iVar14));
                    }
                    if (piVar29 == (int *)0x0)
                        goto LAB_00020438;
                }
                piVar1 = piVar29 + 4;
                piVar29 = (int *)*piVar29;
                if (*piVar1 - 2U < 0xfffe) {
                    piVar12 = (int *)((int)piVar12 + 1);
                }
            } while (piVar29 != (int *)0x0);
        }
    }
LAB_00020438:
    FUN_00071dbc(piVar12);
    if (__dest[0x1d] != 0) {
        FUN_00052744();
    }
    if (__dest[0x1a] != 0) {
        ctl_auth_keyid = __dest[0x1a];
    }
    if (__dest[0x1f] != 0) {
        info_auth_keyid = __dest[0x1f];
    }
    if ((undefined4 *)__dest[0x21] != (undefined4 *)0x0) {
        for (pcVar19 = *(char **)__dest[0x21]; pcVar19 != (char *)0x0;
             pcVar19 = *(char **)pcVar19) {
            while (unaff_r8 = *(undefined ***)(pcVar19 + 0x10),
                   *(int *)(pcVar19 + 8) == 0x13f) {
                if ((char *)0xfffe < (char *)((int)unaff_r8 + -1)) {
                    FUN_00074e00(
                        5, "Ignoring invalid trustedkey %d, min 1 max %d.",
                        unaff_r8, 0xffff);
                    goto LAB_000204fc;
                }
                FUN_000721bc(unaff_r8, 1);
                pcVar19 = *(char **)pcVar19;
                if (pcVar19 == (char *)0x0)
                    goto LAB_00020540;
            }
            unaff_r9 = *(undefined ***)(pcVar19 + 0x14);
            bVar31 = unaff_r9 == unaff_r8;
            ppuVar28 = (undefined **)((int)unaff_r9 - (int)unaff_r8);
            if ((int)unaff_r9 >= (int)unaff_r8) {
                bVar31 = unaff_r8 == (undefined **)0x0;
                ppuVar28 = unaff_r8;
            }
            ppuVar25 = unaff_r8;
            if ((int)unaff_r9 < 0x10000 &&
                (!bVar31 && (int)ppuVar28 < 0 ==
                                ((int)unaff_r9 < (int)unaff_r8 &&
                                 SBORROW4((int)unaff_r9, (int)unaff_r8)))) {
                do {
                    unaff_r8 = (undefined **)((int)ppuVar25 + 1);
                    FUN_000721bc(ppuVar25);
                    ppuVar25 = unaff_r8;
                } while ((int)unaff_r8 <= (int)unaff_r9);
            } else {
                FUN_00074e00(5,
                             "Ignoring invalid trustedkey range %d ... %d, min "
                             "1 max %d.",
                             unaff_r8, unaff_r9, 0xffff);
            }
        LAB_000204fc:
        }
    }
LAB_00020540:
    iVar7 = __dest[0x20];
    if (iVar7 - 3U < 0x1d) {
        sys_revoke = (undefined1)iVar7;
    } else if (iVar7 != 0) {
        FUN_00074e00(3, "\'revoke\' value %d ignored");
    }
    paVar20 = sys_minclock;
    pcVar22 = (char *)sys_maxclock;
    paVar24 = sys_minsane;
    if (((undefined4 *)__dest[0xe] == (undefined4 *)0x0) ||
        (pcVar19 = *(char **)__dest[0xe], pcVar19 == (char *)0x0)) {
        bVar31 = SBORROW4((int)sys_maxclock, (int)sys_minclock);
        iVar7 = (int)sys_maxclock - (int)sys_minclock;
        paVar4 = sys_maxclock;
        if ((int)sys_minclock <= (int)sys_maxclock) {
            bVar31 = SBORROW4((int)sys_minclock, (int)sys_minsane);
            iVar7 = (int)sys_minclock - (int)sys_minsane;
            paVar4 = sys_minsane;
        }
        if (paVar4 != sys_minclock && iVar7 < 0 == bVar31)
            goto LAB_00020928;
    LAB_00022e20:
        FUN_00074e00(3,
                     "tos error: must have minsane (%d) < minclock (%d) <= "
                     "maxclock (%d) - daemon will not operate properly!",
                     paVar24, paVar20, pcVar22);
    } else {
        unaff_r8 = (undefined **)0x0;
        unaff_r9 = (undefined **)0x0;
        do {
            while (iVar7 = *(int *)(pcVar19 + 4), iVar7 == 0x15b) {
                pcVar22 = (char *)(longlong) * (double *)(pcVar19 + 0x10);
                if ((int)pcVar22 < 1) {
                    pcVar19[0x10] = '\0';
                    pcVar19[0x11] = '\0';
                    pcVar19[0x12] = '\0';
                    pcVar19[0x13] = '\0';
                    pcVar19[0x14] = '\0';
                    pcVar19[0x15] = '\0';
                    pcVar19[0x16] = -0x10;
                    pcVar19[0x17] = '?';
                    pcVar22 = (char *)0x1;
                }
            LAB_000205e8:
                pcVar19 = *(char **)pcVar19;
                if (pcVar19 == (char *)0x0)
                    goto LAB_00020644;
            }
            if (iVar7 < 0x15c) {
                if (iVar7 == 0x10d) {
                    dVar32 = *(double *)(pcVar19 + 0x10);
                    if (4.0 < dVar32) {
                        FUN_00074e00(4,
                                     "Using maximum bcpollbstep ceiling %d, %d "
                                     "requested",
                                     4, (int)(longlong)dVar32);
                        pcVar19[0x10] = '\0';
                        pcVar19[0x11] = '\0';
                        pcVar19[0x12] = '\0';
                        pcVar19[0x13] = '\0';
                        pcVar19[0x14] = '\0';
                        pcVar19[0x15] = '\0';
                        pcVar19[0x16] = '\x10';
                        pcVar19[0x17] = '@';
                    } else if (dVar32 < 0.0) {
                        FUN_00074e00(
                            4,
                            "Using minimum bcpollbstep floor %d, %d requested",
                            0, (int)(longlong)dVar32);
                        pcVar19[0x10] = '\0';
                        pcVar19[0x11] = '\0';
                        pcVar19[0x12] = '\0';
                        pcVar19[0x13] = '\0';
                        pcVar19[0x14] = '\0';
                        pcVar19[0x15] = '\0';
                        pcVar19[0x16] = '\0';
                        pcVar19[0x17] = '\0';
                    }
                } else if (iVar7 == 0x114) {
                    dVar32 = *(double *)(pcVar19 + 0x10);
                    if (15.0 < dVar32) {
                        FUN_00074e00(
                            4, "Using maximum tos ceiling %d, %d requested",
                            0xf, (int)(longlong)dVar32);
                        pcVar19[0x10] = '\0';
                        pcVar19[0x11] = '\0';
                        pcVar19[0x12] = '\0';
                        pcVar19[0x13] = '\0';
                        pcVar19[0x14] = '\0';
                        pcVar19[0x15] = '\0';
                        pcVar19[0x16] = '.';
                        pcVar19[0x17] = '@';
                    } else if (dVar32 < 1.0) {
                        FUN_00074e00(4,
                                     "Using minimum tos floor %d, %d requested",
                                     1, (int)(longlong)dVar32);
                        pcVar19[0x10] = '\0';
                        pcVar19[0x11] = '\0';
                        pcVar19[0x12] = '\0';
                        pcVar19[0x13] = '\0';
                        pcVar19[0x14] = '\0';
                        pcVar19[0x15] = '\0';
                        pcVar19[0x16] = -0x10;
                        pcVar19[0x17] = '?';
                    }
                }
                goto LAB_000205e8;
            }
            if (iVar7 == 0x163) {
                paVar20 = (addrinfo *)(longlong) * (double *)(pcVar19 + 0x10);
                if ((int)paVar20 < 1) {
                    pcVar19[0x10] = '\0';
                    pcVar19[0x11] = '\0';
                    pcVar19[0x12] = '\0';
                    pcVar19[0x13] = '\0';
                    pcVar19[0x14] = '\0';
                    pcVar19[0x15] = '\0';
                    pcVar19[0x16] = -0x10;
                    pcVar19[0x17] = '?';
                    paVar20 = (addrinfo *)0x1;
                }
                goto LAB_000205e8;
            }
            if (iVar7 != 0x168)
                goto LAB_000205e8;
            paVar24 = (addrinfo *)(longlong) * (double *)(pcVar19 + 0x10);
            if ((int)paVar24 < 0) {
                pcVar19[0x10] = '\0';
                pcVar19[0x11] = '\0';
                pcVar19[0x12] = '\0';
                pcVar19[0x13] = '\0';
                pcVar19[0x14] = '\0';
                pcVar19[0x15] = '\0';
                pcVar19[0x16] = '\0';
                pcVar19[0x17] = '\0';
                paVar24 = (addrinfo *)0x0;
            }
            pcVar19 = *(char **)pcVar19;
        } while (pcVar19 != (char *)0x0);
    LAB_00020644:
        bVar31 = SBORROW4((int)pcVar22, (int)paVar20);
        iVar7 = (int)pcVar22 - (int)paVar20;
        paVar4 = (addrinfo *)pcVar22;
        if ((int)paVar20 <= (int)pcVar22) {
            bVar31 = SBORROW4((int)paVar20, (int)paVar24);
            iVar7 = (int)paVar20 - (int)paVar24;
            paVar4 = paVar24;
        }
        if (paVar4 == paVar20 || iVar7 < 0 != bVar31)
            goto LAB_00022e20;
    }
    if (((undefined4 *)__dest[0xe] != (undefined4 *)0x0) &&
        (pcVar19 = *(char **)__dest[0xe], pcVar19 != (char *)0x0)) {
    LAB_0002066c:
        switch (*(undefined4 *)(pcVar19 + 4)) {
        case 0x10b:
            goto LAB_0002091c;
        case 0x10c:
            break;
        case 0x10d:
            uVar8 = 0x21;
            goto LAB_0002090c;
        case 0x10e:
            uVar8 = 0x19;
            goto LAB_0002090c;
        case 0x10f:
            break;
        case 0x110:
            break;
        case 0x111:
            break;
        case 0x112:
            break;
        case 0x113:
            break;
        case 0x114:
            uVar8 = 0x12;
            goto LAB_0002090c;
        case 0x115:
            break;
        case 0x116:
            uVar8 = 0x13;
            goto LAB_0002090c;
        case 0x117:
            break;
        case 0x118:
            break;
        case 0x119:
            break;
        case 0x11a:
            break;
        case 0x11b:
            break;
        case 0x11c:
            break;
        case 0x11d:
            break;
        case 0x11e:
            break;
        case 0x11f:
            break;
        case 0x120:
            break;
        case 0x121:
            break;
        case 0x122:
            break;
        case 0x123:
            break;
        case 0x124:
            break;
        case 0x125:
            break;
        case 0x126:
            break;
        case 0x127:
            break;
        case 0x128:
            break;
        case 0x129:
            break;
        case 0x12a:
            break;
        case 299:
            break;
        case 300:
            break;
        case 0x12d:
            break;
        case 0x12e:
            break;
        case 0x12f:
            break;
        case 0x130:
            break;
        case 0x131:
            break;
        case 0x132:
            uVar8 = 0x11;
            goto LAB_0002090c;
        case 0x133:
            break;
        case 0x134:
            break;
        case 0x135:
            break;
        case 0x136:
            break;
        case 0x137:
            break;
        case 0x138:
            break;
        case 0x139:
            break;
        case 0x13a:
            break;
        case 0x13b:
            break;
        case 0x13c:
            break;
        case 0x13d:
            break;
        case 0x13e:
            break;
        case 0x13f:
            break;
        case 0x140:
            break;
        case 0x141:
            break;
        case 0x142:
            break;
        case 0x143:
            break;
        case 0x144:
            break;
        case 0x145:
            break;
        case 0x146:
            break;
        case 0x147:
            break;
        case 0x148:
            break;
        case 0x149:
            break;
        case 0x14a:
            break;
        case 0x14b:
            break;
        case 0x14c:
            break;
        case 0x14d:
            break;
        case 0x14e:
            break;
        case 0x14f:
            break;
        case 0x150:
            break;
        case 0x151:
            break;
        case 0x152:
            break;
        case 0x153:
            break;
        case 0x154:
            break;
        case 0x155:
            break;
        case 0x156:
            break;
        case 0x157:
            break;
        case 0x158:
            break;
        case 0x159:
            break;
        case 0x15a:
            break;
        case 0x15b:
            uVar8 = 0xf;
            goto LAB_0002090c;
        case 0x15c:
            break;
        case 0x15d:
            uVar8 = 0x16;
            goto LAB_0002090c;
        case 0x15e:
            break;
        case 0x15f:
            break;
        case 0x160:
            break;
        case 0x161:
            break;
        case 0x162:
            break;
        case 0x163:
            uVar8 = 0xe;
            goto LAB_0002090c;
        case 0x164:
            break;
        case 0x165:
            uVar8 = 0x15;
            goto LAB_0002090c;
        case 0x166:
            break;
        case 0x167:
            break;
        case 0x168:
            uVar8 = 0x10;
            goto LAB_0002090c;
        case 0x169:
            break;
        case 0x16a:
            break;
        case 0x16b:
            break;
        case 0x16c:
            break;
        case 0x16d:
            break;
        case 0x16e:
            break;
        case 0x16f:
            break;
        case 0x170:
            break;
        case 0x171:
            break;
        case 0x172:
            break;
        case 0x173:
            break;
        case 0x174:
            break;
        case 0x175:
            break;
        case 0x176:
            break;
        case 0x177:
            break;
        case 0x178:
            break;
        case 0x179:
            break;
        case 0x17a:
            break;
        case 0x17b:
            break;
        case 0x17c:
            break;
        case 0x17d:
            break;
        case 0x17e:
            break;
        case 0x17f:
            uVar8 = 0x1a;
            goto LAB_0002090c;
        case 0x180:
            uVar8 = 0x1b;
        LAB_0002090c:
            FUN_00048810((int)*(undefined8 *)(pcVar19 + 0x10), uVar8, 0);
        LAB_0002091c:
            pcVar19 = *(char **)pcVar19;
            if (pcVar19 == (char *)0x0)
                goto LAB_00020928;
            goto LAB_0002066c;
        }
        FUN_0001c954("config-tos: attr-token=%d");
        goto switchD_00020968_default;
    }
LAB_00020928:
    lVar3 = CONCAT44(unaff_r9, unaff_r8);
    if (((undefined4 *)__dest[0x13] != (undefined4 *)0x0) &&
        (pcVar19 = *(char **)__dest[0x13], lVar3 = CONCAT44(unaff_r9, unaff_r8),
         pcVar19 != (char *)0x0)) {
        paVar20 = (addrinfo *)0x38e38e39;
        pcVar22 = "mru %s %d out of range, ignored.";
        do {
            iVar7 = mru_mindepth;
            iVar13 = mru_incalloc;
            iVar14 = mru_initalloc;
            switch (*(undefined4 *)(pcVar19 + 4)) {
            case 0x13a:
                iVar13 = *(int *)(pcVar19 + 0x10);
                if (-1 < *(int *)(pcVar19 + 0x10))
                    break;
                goto LAB_000215c8;
            case 0x13b:
                if (*(int *)(pcVar19 + 0x10) < 0)
                    goto LAB_000215c8;
                uVar15 = *(int *)(pcVar19 + 0x10) << 10;
                iVar7 = 0x950;
                goto LAB_00020b20;
            case 0x13c:
                iVar14 = *(int *)(pcVar19 + 0x10);
                iVar17 = iVar14;
                goto joined_r0x00020a7c;
            case 0x13d:
                if (*(int *)(pcVar19 + 0x10) < 0)
                    goto LAB_000215c8;
                uVar15 = *(int *)(pcVar19 + 0x10) << 10;
                iVar7 = 0x658;
                goto LAB_00020b20;
            case 0x13e:
            default:
            switchD_00020968_default:
                uVar8 = FUN_0002c0bc();
                FUN_00074e00(3, "Unknown mru option %s (%d)", uVar8,
                             *(undefined4 *)(pcVar19 + 4));
                /* WARNING: Subroutine does not return */
                exit(1);
            case 0x13f:
                goto switchD_00020968_default;
            case 0x140:
                goto switchD_00020968_default;
            case 0x141:
                goto switchD_00020968_default;
            case 0x142:
                goto switchD_00020968_default;
            case 0x143:
                goto switchD_00020968_default;
            case 0x144:
                goto switchD_00020968_default;
            case 0x145:
                goto switchD_00020968_default;
            case 0x146:
                goto switchD_00020968_default;
            case 0x147:
                goto switchD_00020968_default;
            case 0x148:
                goto switchD_00020968_default;
            case 0x149:
                goto switchD_00020968_default;
            case 0x14a:
                goto switchD_00020968_default;
            case 0x14b:
                goto switchD_00020968_default;
            case 0x14c:
                goto switchD_00020968_default;
            case 0x14d:
                goto switchD_00020968_default;
            case 0x14e:
                goto switchD_00020968_default;
            case 0x14f:
                goto switchD_00020968_default;
            case 0x150:
                goto switchD_00020968_default;
            case 0x151:
                goto switchD_00020968_default;
            case 0x152:
                goto switchD_00020968_default;
            case 0x153:
                goto switchD_00020968_default;
            case 0x154:
                goto switchD_00020968_default;
            case 0x155:
                goto switchD_00020968_default;
            case 0x156:
                goto switchD_00020968_default;
            case 0x157:
                goto switchD_00020968_default;
            case 0x158:
                goto switchD_00020968_default;
            case 0x159:
                goto switchD_00020968_default;
            case 0x15a:
                mru_maxage = *(undefined4 *)(pcVar19 + 0x10);
                break;
            case 0x15b:
                goto switchD_00020968_default;
            case 0x15c:
                mru_maxdepth = *(int *)(pcVar19 + 0x10);
                if (mru_maxdepth < 0) {
                LAB_00021640:
                    mru_maxdepth = -1;
                }
                break;
            case 0x15d:
                goto switchD_00020968_default;
            case 0x15e:
                if (*(int *)(pcVar19 + 0x10) < 0)
                    goto LAB_00021640;
                iVar7 = 0x7a8;
                uVar15 = *(int *)(pcVar19 + 0x10) << 10;
            LAB_00020b20:
                lVar3 = (ulonglong)uVar15 * 0x38e38e39;
                **(uint **)((int)&__DT_PLTGOT + iVar7) = uVar15 / 0x48;
                iVar7 = mru_mindepth;
                iVar13 = mru_incalloc;
                iVar14 = mru_initalloc;
                break;
            case 0x15f:
                goto switchD_00020968_default;
            case 0x160:
                goto switchD_00020968_default;
            case 0x161:
                goto switchD_00020968_default;
            case 0x162:
                goto switchD_00020968_default;
            case 0x163:
                goto switchD_00020968_default;
            case 0x164:
                iVar7 = *(int *)(pcVar19 + 0x10);
                iVar17 = *(int *)(pcVar19 + 0x10);
            joined_r0x00020a7c:
                if (iVar17 < 0) {
                LAB_000215c8:
                    uVar8 = FUN_0002c0bc();
                    FUN_00074e00(3, "mru %s %d out of range, ignored.", uVar8,
                                 *(undefined4 *)(pcVar19 + 0x10));
                    iVar7 = mru_mindepth;
                    iVar13 = mru_incalloc;
                    iVar14 = mru_initalloc;
                }
            }
            mru_initalloc = iVar14;
            mru_incalloc = iVar13;
            mru_mindepth = iVar7;
            pcVar19 = *(char **)pcVar19;
            paVar24 = (addrinfo *)local_f4;
        } while (pcVar19 != (char *)0x0);
    }
    ppuVar28 = (undefined **)((ulonglong)lVar3 >> 0x20);
    pcVar26 = (char *)lVar3;
    if (((undefined4 *)__dest[0x12] != (undefined4 *)0x0) &&
        (pcVar19 = *(char **)__dest[0x12], pcVar19 != (char *)0x0)) {
        paVar20 = (addrinfo *)&DAT_00000166;
        paVar24 = (addrinfo *)0x16b;
        pcVar22 = "discard average %d out of range, ignored.";
        do {
            iVar7 = *(int *)(pcVar19 + 4);
            if (iVar7 == 0x166) {
                ntp_minpkt = *(undefined4 *)(pcVar19 + 0x10);
            } else if (iVar7 == 0x16b) {
                mon_age = *(undefined4 *)(pcVar19 + 0x10);
            } else {
                if (iVar7 != 0x10a) {
                    uVar8 = FUN_0002c0bc();
                    FUN_00074e00(3, "Unknown discard option %s (%d)", uVar8,
                                 *(undefined4 *)(pcVar19 + 4));
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                if (*(uint *)(pcVar19 + 0x10) < 0x100) {
                    ntp_minpoll = (undefined1) * (uint *)(pcVar19 + 0x10);
                } else {
                    FUN_00074e00(3,
                                 "discard average %d out of range, ignored.");
                }
            }
            pcVar19 = *(char **)pcVar19;
            pcVar26 = (char *)local_f4;
        } while (pcVar19 != (char *)0x0);
    }
    if (((undefined4 *)__dest[0x14] != (undefined4 *)0x0) &&
        (local_f8 = *(char **)__dest[0x14], local_f8 != (char *)0x0)) {
        local_e8 = "restrict: ignoring line %d, mask \'%s\' unusable.";
        local_ec = "ntp";
    LAB_00020d64:
        iVar7 = (int)*(short *)(local_f8 + 0x14);
        if ((*(int **)(local_f8 + 0xc) != (int *)0x0) &&
            (piVar12 = (int *)**(int **)(local_f8 + 0xc),
             piVar12 != (int *)0x0)) {
            pcVar26 = (char *)0x0;
            ppuVar28 = (undefined **)0x0;
        LAB_00020d8c:
            switch (piVar12[1]) {
            case 0x131:
                pcVar26 = (char *)((uint)pcVar26 | 0x2000);
                goto LAB_00020fc8;
            case 0x132:
                break;
            case 0x133:
                break;
            case 0x134:
                break;
            case 0x135:
                break;
            case 0x136:
                break;
            case 0x137:
                break;
            case 0x138:
                break;
            case 0x139:
                pcVar26 = (char *)((uint)pcVar26 | 1);
                goto LAB_00020fc8;
            case 0x13a:
                break;
            case 0x13b:
                break;
            case 0x13c:
                break;
            case 0x13d:
                break;
            case 0x13e:
                break;
            case 0x13f:
                break;
            case 0x140:
                break;
            case 0x141:
                break;
            case 0x142:
                break;
            case 0x143:
                break;
            case 0x144:
                break;
            case 0x145:
                break;
            case 0x146:
                break;
            case 0x147:
                break;
            case 0x148:
                break;
            case 0x149:
                break;
            case 0x14a:
                break;
            case 0x14b:
                break;
            case 0x14c:
                pcVar26 = (char *)((uint)pcVar26 | 0x800);
                goto LAB_00020fc8;
            case 0x14d:
                pcVar26 = (char *)((uint)pcVar26 | 0x1000);
                goto LAB_00020fc8;
            case 0x14e:
                break;
            case 0x14f:
                break;
            case 0x150:
                pcVar26 = (char *)((uint)pcVar26 | 0x40);
                goto LAB_00020fc8;
            case 0x151:
                break;
            case 0x152:
                break;
            case 0x153:
                break;
            case 0x154:
                break;
            case 0x155:
                break;
            case 0x156:
                pcVar26 = (char *)((uint)pcVar26 | 0x400);
                goto LAB_00020fc8;
            case 0x157:
                break;
            case 0x158:
                break;
            case 0x159:
                break;
            case 0x15a:
                break;
            case 0x15b:
                break;
            case 0x15c:
                break;
            case 0x15d:
                break;
            case 0x15e:
                break;
            case 0x15f:
                break;
            case 0x160:
                break;
            case 0x161:
                break;
            case 0x162:
                break;
            case 0x163:
                break;
            case 0x164:
                break;
            case 0x165:
                break;
            case 0x166:
                break;
            case 0x167:
                break;
            case 0x168:
                break;
            case 0x169:
                break;
            case 0x16a:
                break;
            case 0x16b:
                break;
            case 0x16c:
                break;
            case 0x16d:
                break;
            case 0x16e:
                break;
            case 0x16f:
                break;
            case 0x170:
                break;
            case 0x171:
                pcVar26 = (char *)((uint)pcVar26 | 0x100);
                goto LAB_00020fc8;
            case 0x172:
                pcVar26 = (char *)((uint)pcVar26 | 0x4000);
                goto LAB_00020fc8;
            case 0x173:
                break;
            case 0x174:
                break;
            case 0x175:
                pcVar26 = (char *)((uint)pcVar26 | 0x20);
                goto LAB_00020fc8;
            case 0x176:
                pcVar26 = (char *)((uint)pcVar26 | 0x10);
                goto LAB_00020fc8;
            case 0x177:
                pcVar26 = (char *)((uint)pcVar26 | 0x80);
                goto LAB_00020fc8;
            case 0x178:
                break;
            case 0x179:
                pcVar26 = (char *)((uint)pcVar26 | 2);
                goto LAB_00020fc8;
            case 0x17a:
                pcVar26 = (char *)((uint)pcVar26 | 0x200);
                goto LAB_00020fc8;
            case 0x17b:
                pcVar26 = (char *)((uint)pcVar26 | 4);
                goto LAB_00020fc8;
            case 0x17c:
                break;
            case 0x17d:
                ppuVar28 = (undefined **)((uint)ppuVar28 | 0x2000);
                goto LAB_00020fc8;
            case 0x17e:
                break;
            case 0x17f:
                break;
            case 0x180:
                break;
            case 0x181:
                break;
            case 0x182:
                break;
            case 0x183:
                break;
            case 0x184:
                break;
            case 0x185:
                break;
            case 0x186:
                break;
            case 0x187:
                break;
            case 0x188:
                break;
            case 0x189:
                break;
            case 0x18a:
                break;
            case 0x18b:
                break;
            case 0x18c:
                break;
            case 0x18d:
                break;
            case 0x18e:
                break;
            case 399:
                break;
            case 400:
                break;
            case 0x191:
                break;
            case 0x192:
                break;
            case 0x193:
                break;
            case 0x194:
                break;
            case 0x195:
                break;
            case 0x196:
                break;
            case 0x197:
                break;
            case 0x198:
                break;
            case 0x199:
                ppuVar28 = (undefined **)((uint)ppuVar28 | 0x4000);
                goto LAB_00020fc8;
            case 0x19a:
                break;
            case 0x19b:
                break;
            case 0x19c:
                break;
            case 0x19d:
                break;
            case 0x19e:
                break;
            case 0x19f:
                break;
            case 0x1a0:
                break;
            case 0x1a1:
                break;
            case 0x1a2:
                break;
            case 0x1a3:
                break;
            case 0x1a4:
                break;
            case 0x1a5:
                break;
            case 0x1a6:
                break;
            case 0x1a7:
                break;
            case 0x1a8:
                break;
            case 0x1a9:
                break;
            case 0x1aa:
                break;
            case 0x1ab:
                break;
            case 0x1ac:
                break;
            case 0x1ad:
                break;
            case 0x1ae:
                break;
            case 0x1af:
                break;
            case 0x1b0:
                break;
            case 0x1b1:
                break;
            case 0x1b2:
                break;
            case 0x1b3:
                break;
            case 0x1b4:
                break;
            case 0x1b5:
                break;
            case 0x1b6:
                break;
            case 0x1b7:
                break;
            case 0x1b8:
                pcVar26 = (char *)((uint)pcVar26 | 8);
            LAB_00020fc8:
                piVar12 = (int *)*piVar12;
                if (piVar12 == (int *)0x0)
                    goto code_r0x00020fd4;
                goto LAB_00020d8c;
            }
            FUN_0001c954("config_access: flag-type-token=%d");
            local_e4 = puVar16;
            goto LAB_00022994;
        }
        ppuVar28 = (undefined **)0x0;
        iVar14 = *(int *)(local_f8 + 4);
        if (iVar14 != 0) {
            pcVar26 = (char *)0x0;
            goto LAB_00021090;
        }
        pcVar26 = (char *)0x0;
        ppuVar28 = (undefined **)0x0;
        goto LAB_00021474;
    }
LAB_0002121c:
    if ((undefined4 *)__dest[0x17] != (undefined4 *)0x0) {
        for (pcVar19 = *(char **)__dest[0x17]; pcVar19 != (char *)0x0;
             pcVar19 = *(char **)pcVar19) {
            iVar7 = *(int *)(pcVar19 + 4);
            if (iVar7 == 0x182) {
                uVar8 = 6;
            } else if (iVar7 < 0x183) {
                if (iVar7 == 0x120) {
                    uVar8 = 7;
                } else if (iVar7 < 0x121) {
                    if (iVar7 != 0x105) {
                    LAB_000231bc:
                        FUN_0001c954("config_tinker: attr-token=%d");
                    LAB_000231c8:
                        FUN_0001c954("config_auth: attr-token=%d");
                    LAB_000231d4:
                        /* WARNING: Subroutine does not return */
                        FUN_0007ecc0("ntp_config.c", 0xacf, pcVar19,
                                     "ai_list != ((void *)0)");
                    }
                    uVar8 = 10;
                } else if (iVar7 == 0x133) {
                    uVar8 = 0xc;
                } else {
                    if (iVar7 != 0x136)
                        goto LAB_000231bc;
                    uVar8 = 0xb;
                }
            } else if (iVar7 == 0x1a0) {
                uVar8 = 5;
            } else if (iVar7 < 0x1a1) {
                if (iVar7 == 0x19e) {
                    uVar8 = 3;
                } else {
                    if (iVar7 != 0x19f)
                        goto LAB_000231bc;
                    uVar8 = 4;
                }
            } else if (iVar7 == 0x1a1) {
                uVar8 = 8;
            } else {
                if (iVar7 != 0x1a6)
                    goto LAB_000231bc;
                uVar8 = 0xf;
            }
            FUN_000405f8((int)*(undefined8 *)(pcVar19 + 0x10), uVar8);
        }
    }
    if ((int *)__dest[0x16] == (int *)0x0)
        goto LAB_0002176c;
    piVar12 = *(int **)__dest[0x16];
    if (piVar12 == (int *)0x0)
        goto LAB_0002176c;
    pcVar26 = "\'rlimit memlock\' value of %d is unexpected!";
    paVar24 = (addrinfo *)&DAT_0009cfd0;
    pcVar22 = "mlockall() failed: %m";
    ppuVar28 = local_f4;
LAB_000216d4:
    iVar7 = piVar12[1];
    if (iVar7 == 0x162) {
    LAB_00021704:
        if ((*(uint *)(*(undefined **)((int)puVar16 + 0x44) + 0x5d0) & 0xf) ==
            0) {
            iVar7 = piVar12[4];
            if (iVar7 == -1) {
                piVar29 = (int *)ppuVar28[0x1fc];
                if ((*piVar29 != 0) && (iVar7 = munlockall(), iVar7 == -1)) {
                    FUN_00074e00(3, "munlockall() failed: %m");
                }
                *piVar29 = 0;
            } else if (iVar7 < 0) {
                FUN_00074e00(4, pcVar26);
            } else {
                piVar29 = (int *)ppuVar28[0x1fc];
                if (*piVar29 != 1) {
                    iVar7 = mlockall(3);
                    if (iVar7 == -1) {
                        FUN_00074e00(3, pcVar22);
                    }
                    iVar7 = piVar12[4];
                }
                FUN_0001fb7c(8, 0x100000, iVar7 << 0x14,
                             (iVar7 << 0x14) >> 0x1f, 0x100000, paVar24);
                *piVar29 = 1;
            }
        }
    } else {
        if (iVar7 != 0x19a) {
            if (iVar7 == 300)
                goto LAB_000217cc;
            FUN_0001c954("config-rlimit: value-token=%d");
            goto LAB_00021704;
        }
        FUN_0001fb7c(3, 0x1000, piVar12[4] << 0xc, (piVar12[4] << 0xc) >> 0x1f,
                     0x1000, &DAT_0009d000);
    }
LAB_00021760:
    piVar12 = (int *)*piVar12;
    if (piVar12 != (int *)0x0)
        goto LAB_000216d4;
LAB_0002176c:
    FUN_0001c9a0(__dest[0x18], 1);
    FUN_0001c9a0(__dest[0x19], 0);
    if (((undefined4 *)__dest[0x23] != (undefined4 *)0x0) &&
        (piVar12 = *(int **)__dest[0x23], piVar12 != (int *)0x0)) {
        do {
            iVar7 = piVar12[1];
            if (iVar7 == 0x2d) {
                uVar15 = FUN_0001d580(piVar12[4]);
                ntp_syslogmask = ntp_syslogmask & ~uVar15;
            } else if (iVar7 == 0x3d) {
                ntp_syslogmask = FUN_0001d580(piVar12[4]);
            } else {
                if (iVar7 != 0x2b)
                    goto code_r0x000217c0;
                uVar15 = FUN_0001d580(piVar12[4]);
                ntp_syslogmask = ntp_syslogmask | uVar15;
            }
            piVar12 = (int *)*piVar12;
            if (piVar12 == (int *)0x0)
                break;
        } while (true);
    }
    if (((undefined4 *)__dest[0x24] != (undefined4 *)0x0) &&
        (piVar12 = *(int **)__dest[0x24], piVar12 != (int *)0x0)) {
        uVar15 = 0;
        do {
            if (uVar15 < 9) {
                uVar8 = FUN_00073d08(piVar12[1]);
                piVar12 = (int *)*piVar12;
                *(undefined4 *)(sys_phone + uVar15 * 4) = uVar8;
                *(undefined4 *)(sys_phone + (uVar15 + 1) * 4) = 0;
                uVar15 = uVar15 + 1;
            } else {
                FUN_00074e00(6,
                             "phone: Number of phone entries exceeds %zu. "
                             "Ignoring phone %s...",
                             9);
                piVar12 = (int *)*piVar12;
            }
        } while (piVar12 != (int *)0x0);
    }
    if (((int *)__dest[0x25] != (int *)0x0) &&
        (piVar12 = *(int **)__dest[0x25], piVar12 != (int *)0x0)) {
        pvVar23 = (void *)0x0;
        do {
            sVar11 = strlen((char *)piVar12[1]);
            sVar9 = strlen((char *)piVar12[2]);
            iVar7 = sVar11 + sVar9 + 2;
            pvVar23 = (void *)FUN_00073ba4(pvVar23, iVar7, 0);
            FUN_0007c054(pvVar23, iVar7, "%s=%s", piVar12[1], piVar12[2]);
            if (piVar12[3] == 0) {
                uVar8 = 0;
            } else {
                uVar8 = 0x20;
            }
            FUN_000345c4(pvVar23, iVar7, uVar8);
            piVar12 = (int *)*piVar12;
        } while (piVar12 != (int *)0x0);
        if (pvVar23 != (void *)0x0) {
            free(pvVar23);
        }
    }
    if (((int *)__dest[0x26] != (int *)0x0) &&
        (piVar12 = *(int **)__dest[0x26], piVar12 != (int *)0x0)) {
        uVar15 = 0;
        do {
            while (uVar15 < 8) {
                *(char *)((int)&sys_ttl + uVar15) = (char)piVar12[1];
                uVar15 = uVar15 + 1;
                piVar12 = (int *)*piVar12;
                if (piVar12 == (int *)0x0)
                    goto LAB_000219f0;
            }
            FUN_00074e00(
                6, "ttl: Number of TTL entries exceeds %zu. Ignoring TTL %d...",
                8);
            piVar12 = (int *)*piVar12;
        } while (piVar12 != (int *)0x0);
    LAB_000219f0:
        sys_ttlmax = uVar15 - 1;
    }
    if ((int *)__dest[0x28] != (int *)0x0) {
        for (piVar12 = *(int **)__dest[0x28]; piVar12 != (int *)0x0;
             piVar12 = (int *)*piVar12) {
            iVar7 = piVar12[1];
            if (iVar7 == 0x14e) {
                FUN_0005294c(4, piVar12[4]);
                pvVar23 = saveconfigdir;
            } else {
                pvVar23 = saveconfigdir;
                if (iVar7 < 0x14f) {
                    if (iVar7 == 0x122) {
                        if (*(char *)piVar12[4] == '\0') {
                            stats_drift_file = 0;
                            FUN_00074e00(6, "config: driftfile disabled");
                            pvVar23 = saveconfigdir;
                        } else {
                            FUN_0005294c(1);
                            pvVar23 = saveconfigdir;
                        }
                    } else if (iVar7 < 0x123) {
                        if (iVar7 == 0x109) {
                            if (piVar12[4] - 3U < 0x1d) {
                                sys_automax = (undefined1)piVar12[4];
                            } else {
                                FUN_00074e00(3, "\'automax\' value %d ignored");
                                pvVar23 = saveconfigdir;
                            }
                        } else if (iVar7 == 0x111) {
                            FUN_00048810((int)*(undefined8 *)(piVar12 + 4), 4,
                                         0);
                            pvVar23 = saveconfigdir;
                        } else {
                        LAB_00022e78:
                            FUN_00074e00(3,
                                         "config_vars(): unexpected token %d");
                            pvVar23 = saveconfigdir;
                        }
                    } else if (iVar7 == 0x124) {
                        qos = piVar12[4] << 2;
                    } else {
                        if (iVar7 != 0x138)
                            goto LAB_00022e78;
                        sys_ident = piVar12[4];
                    }
                } else if (iVar7 == 0x187) {
                    FUN_0005294c(3, piVar12[4]);
                    pvVar23 = saveconfigdir;
                } else if (iVar7 < 0x188) {
                    if (iVar7 == 0x154) {
                        iVar7 = FUN_00074fec(piVar12[4], 1);
                        pvVar23 = saveconfigdir;
                        if (iVar7 == -1) {
                            FUN_00074e00(3, "Cannot open logfile %s: %m",
                                         piVar12[4]);
                            pvVar23 = saveconfigdir;
                        }
                    } else {
                        if (iVar7 != 0x174)
                            goto LAB_00022e78;
                    LAB_00022f28:
                        wander_threshold._0_4_ = piVar12[4];
                        wander_threshold._4_4_ = piVar12[5];
                    }
                } else if (iVar7 == 0x1a6) {
                    FUN_000405f8((int)*(undefined8 *)(piVar12 + 4), 0xf);
                    pvVar23 = saveconfigdir;
                } else {
                    if (iVar7 == 0x1b9)
                        goto LAB_00022f28;
                    if (iVar7 != 0x196)
                        goto LAB_00022e78;
                    if (saveconfigdir != (void *)0x0) {
                        free(saveconfigdir);
                    }
                    pcVar19 = (char *)piVar12[4];
                    pvVar23 = (void *)strlen(pcVar19);
                    if (pvVar23 != (void *)0x0) {
                        if ((pcVar19 + (int)pvVar23)[-1] == '/') {
                            pvVar23 = (void *)FUN_00073d08(pcVar19);
                        } else {
                            saveconfigdir =
                                (void *)FUN_00073ba4(0, (int)pvVar23 + 2, 0);
                            FUN_0007c054(saveconfigdir, (int)pvVar23 + 2,
                                         &DAT_0009d0e4, piVar12[4], 0x2f);
                            pvVar23 = saveconfigdir;
                        }
                    }
                }
            }
            saveconfigdir = pvVar23;
        }
    }
    FUN_00028484();
    local_84._0_4_ = local_84._0_4_ & 0xffff0000;
    if (((undefined4 *)__dest[0x27] != (undefined4 *)0x0) &&
        (paVar20 = *(addrinfo **)__dest[0x27], paVar20 != (addrinfo *)0x0)) {
        local_ec = "%u";
        local_e8 = "set trap %s -> %s failed.";
        local_e4 = "can\'t find interface with address %s";
        local_f8 = "invalid port number %d, trap ignored";
        do {
            while (((undefined4 *)paVar20->ai_socktype == (undefined4 *)0x0 ||
                    (pcVar19 = *(char **)paVar20->ai_socktype,
                     pcVar19 == (char *)0x0))) {
                local_84._28_2_ = 0;
                local_84._30_2_ = 0;
                local_64 = 0;
                uStack_62 = 0;
                local_60 = 0;
                uStack_5e = 0;
                local_5c = 0;
                uStack_5a = 0;
                local_58 = 0;
                uStack_56 = 0;
                local_54 = 0;
                uStack_52 = 0;
                local_50 = 0;
                uStack_4e = 0;
                iVar7 = FUN_0001ce10(*(undefined4 *)(paVar20->ai_family + 4),
                                     local_84 + 0x1c);
                if (iVar7 != 1) {
                    memset(&local_d0, 0, 0x20);
                    local_c4 = 0x11;
                    local_c8 = 2;
                    FUN_0007c054(auStack_4c, 8, local_ec, 0x480f);
                    local_d0 = 0x400;
                    puVar10 = (undefined4 *)FUN_00073ba4(0, 0x20, 0, 1);
                LAB_00021d40:
                    iVar7 = FUN_00078520(
                        *(undefined4 *)(paVar20->ai_family + 4), auStack_4c,
                        &local_d0, 2, FUN_0001d014, puVar10);
                    if (iVar7 == 0) {
                        FUN_00074e00(
                            3, "config_trap: getaddrinfo_sometime(%s,%s): %m",
                            *(undefined4 *)(paVar20->ai_family + 4),
                            auStack_4c);
                    }
                    goto LAB_00021d90;
                }
                local_84._30_2_ = 0xf48;
            LAB_00022bc0:
                iVar14 = any_interface;
                if (local_84._28_2_ != 2) {
                    iVar14 = any6_interface;
                }
            LAB_00022bdc:
                iVar7 = FUN_00033d98(local_84 + 0x1c, iVar14, 0, 4);
                if (iVar7 != 0)
                    goto LAB_00021d90;
                uVar8 = FUN_00028fb4(iVar14);
                uVar18 = FUN_0007c2e8(local_84 + 0x1c);
                FUN_00074e00(3, local_e8, uVar8, uVar18);
                paVar20 = (addrinfo *)paVar20->ai_flags;
                if (paVar20 == (addrinfo *)0x0)
                    goto LAB_00021d9c;
            }
            unaff_r11 = (char *)0x0;
            iVar7 = 0x189;
            iVar14 = 0;
            pcVar22 = (char *)0x0;
            do {
                while (*(int *)(pcVar19 + 4) != iVar7) {
                    if (*(int *)(pcVar19 + 4) == 0x140) {
                    LAB_00022994:
                        local_84._4_4_ = 0;
                        local_84._0_4_ = 0;
                        local_84._8_4_ = 0;
                        local_84._12_4_ = 0;
                        local_84._16_4_ = 0;
                        local_84._20_4_ = (sockaddr *)0x0;
                        local_84._24_4_ = (char *)0x0;
                        iVar14 = FUN_0001ce10(*(undefined4 *)(pcVar19 + 0x10),
                                              local_84);
                        if (iVar14 == 1) {
                            iVar14 = FUN_000278f8(local_84);
                            if (iVar14 == 0) {
                                uVar8 = FUN_0007c2e8(local_84);
                                FUN_00074e00(3, local_e4, uVar8);
                                pcVar22 = (char *)0x1;
                            }
                            goto LAB_00021c0c;
                        }
                        goto LAB_00021d90;
                    }
                LAB_00021c0c:
                    pcVar19 = *(char **)pcVar19;
                    if (pcVar19 == (char *)0x0)
                        goto LAB_00021c48;
                }
                uVar15 = *(uint *)(pcVar19 + 0x10);
                if (0xfffe < uVar15 - 1) {
                    FUN_00074e00(3, local_f8);
                    pcVar22 = (char *)0x1;
                    uVar15 = *(uint *)(pcVar19 + 0x10);
                }
                pcVar19 = *(char **)pcVar19;
                unaff_r11 = (char *)(uVar15 & 0xffff);
            } while (pcVar19 != (char *)0x0);
        LAB_00021c48:
            if ((addrinfo *)pcVar22 == (addrinfo *)0x0) {
                local_84._28_2_ = 0;
                local_84._30_2_ = 0;
                if (unaff_r11 == (char *)0x0) {
                    unaff_r11 = (char *)0x480f;
                }
                local_64 = local_84._28_2_;
                uStack_62 = local_84._30_2_;
                local_60 = local_84._28_2_;
                uStack_5e = local_84._30_2_;
                local_5c = local_84._28_2_;
                uStack_5a = local_84._30_2_;
                local_58 = local_84._28_2_;
                uStack_56 = local_84._30_2_;
                local_54 = local_84._28_2_;
                uStack_52 = local_84._30_2_;
                local_50 = local_84._28_2_;
                uStack_4e = local_84._30_2_;
                iVar7 = FUN_0001ce10(*(undefined4 *)(paVar20->ai_family + 4),
                                     local_84 + 0x1c);
                if (iVar7 != 1) {
                    memset(&local_d0, 0, 0x20);
                    local_c4 = 0x11;
                    local_c8 = 2;
                    FUN_0007c054(auStack_4c, 8, "%u", unaff_r11);
                    local_d0 = 0x400;
                    puVar10 = (undefined4 *)FUN_00073ba4(0, 0x20, 0, 1);
                    if (iVar14 != 0) {
                        local_cc = (uint) * (ushort *)(iVar14 + 0x8c);
                        puVar10[7] = 1;
                        uVar8 = *(undefined4 *)(iVar14 + 0x1c);
                        uVar18 = *(undefined4 *)(iVar14 + 0x20);
                        uVar30 = *(undefined4 *)(iVar14 + 0x24);
                        *puVar10 = *(undefined4 *)(iVar14 + 0x18);
                        puVar10[1] = uVar8;
                        puVar10[2] = uVar18;
                        puVar10[3] = uVar30;
                        uVar8 = *(undefined4 *)(iVar14 + 0x2c);
                        uVar18 = *(undefined4 *)(iVar14 + 0x30);
                        puVar10[4] = *(undefined4 *)(iVar14 + 0x28);
                        puVar10[5] = uVar8;
                        puVar10[6] = uVar18;
                    }
                    goto LAB_00021d40;
                }
                local_84._30_2_ = (ushort)(((uint)unaff_r11 & 0xff) << 8) |
                                  (ushort)((uint)unaff_r11 >> 8) & 0xff;
                if (iVar14 == 0)
                    goto LAB_00022bc0;
                local_84._28_2_ = local_84._0_2_;
                goto LAB_00022bdc;
            }
        LAB_00021d90:
            paVar20 = (addrinfo *)paVar20->ai_flags;
        } while (paVar20 != (addrinfo *)0x0);
    }
LAB_00021d9c:
    if (__dest[0xb] != 0) {
        FUN_00048810(0, 1, __dest[0xb], 0);
    }
    if (((int *)__dest[0xc] != (int *)0x0) &&
        (piVar12 = *(int **)__dest[0xc], piVar12 != (int *)0x0)) {
        do {
            while (true) {
                local_84._30_2_ = 0;
                local_64 = 0;
                uStack_62 = 0;
                local_60 = 0;
                uStack_5e = 0;
                local_5c = 0;
                uStack_5a = 0;
                local_58 = 0;
                uStack_56 = 0;
                local_54 = 0;
                uStack_52 = 0;
                local_50 = 0;
                uStack_4e = 0;
                local_84._28_2_ = (undefined2)piVar12[2];
                iVar7 = FUN_0001ce10(piVar12[1], local_84 + 0x1c);
                if (iVar7 != 1)
                    break;
                FUN_00048810(0, 6, 0, local_84 + 0x1c);
                piVar12 = (int *)*piVar12;
                sys_manycastserver = 1;
                if (piVar12 == (int *)0x0)
                    goto LAB_00021e50;
            }
            piVar12 = (int *)*piVar12;
        } while (piVar12 != (int *)0x0);
    }
LAB_00021e50:
    if (((int *)__dest[0xd] != (int *)0x0) &&
        (piVar12 = *(int **)__dest[0xd], piVar12 != (int *)0x0)) {
        do {
            while (true) {
                local_84._30_2_ = 0;
                local_64 = 0;
                uStack_62 = 0;
                local_60 = 0;
                uStack_5e = 0;
                local_5c = 0;
                uStack_5a = 0;
                local_58 = 0;
                uStack_56 = 0;
                local_54 = 0;
                uStack_52 = 0;
                local_50 = 0;
                uStack_4e = 0;
                local_84._28_2_ = (undefined2)piVar12[2];
                iVar7 = FUN_0001ce10(piVar12[1], local_84 + 0x1c);
                if (iVar7 != 1)
                    break;
                FUN_00048810(0, 6, 0, local_84 + 0x1c);
                piVar12 = (int *)*piVar12;
                if (piVar12 == (int *)0x0)
                    goto LAB_00021ee0;
            }
            piVar12 = (int *)*piVar12;
        } while (piVar12 != (int *)0x0);
    LAB_00021ee0:
        FUN_00048810(0, 6, 1, piVar12);
    }
    if (0 < cmdline_server_count) {
        puVar16 = local_84 + 0x1c;
        do {
            local_84._28_2_ = 0;
            local_84._30_2_ = 0;
            local_64 = 0;
            uStack_62 = 0;
            local_60 = 0;
            uStack_5e = 0;
            local_5c = 0;
            uStack_5a = 0;
            local_58 = 0;
            uStack_56 = 0;
            local_54 = 0;
            uStack_52 = 0;
            local_50 = 0;
            uStack_4e = 0;
            iVar7 = FUN_00074054(*cmdline_servers, 0, puVar16);
            if (iVar7 == 0) {
                puVar10 = (undefined4 *)FUN_00073ba4(0, 0x1c, 0, 1);
                *(undefined2 *)(puVar10 + 2) = 0;
                puVar10[1] = 0x197;
                *(undefined2 *)(puVar10 + 4) = 0x403;
                *puVar10 = 0x100;
                memset(&local_d0, 0, 0x20);
                local_cc = (uint) * (ushort *)(puVar10 + 2);
                local_c8 = 2;
                local_c4 = 0x11;
                FUN_00077f40(*cmdline_servers, &DAT_0009ce60, &local_d0, 2,
                             FUN_0001d1a8, puVar10, 0);
            } else {
                local_84._30_2_ = 0x7b00;
                iVar7 = FUN_0001cc78(puVar16, 0x197);
                if (iVar7 != 0) {
                    FUN_00042898(puVar16, 0, 0, 0xffffffff, 3, 4, 0, 0, 0x100,
                                 0, 0, 0);
                }
            }
            cmdline_server_count = cmdline_server_count + -1;
            cmdline_servers = cmdline_servers + 1;
        } while (0 < cmdline_server_count);
    }
    if (((int *)__dest[9] != (int *)0x0) &&
        (piVar12 = *(int **)__dest[9], piVar12 != (int *)0x0)) {
        puVar16 = local_84 + 0x1c;
    LAB_00022154:
        do {
            local_84._28_2_ = 0;
            local_84._30_2_ = 0;
            local_64 = 0;
            uStack_62 = 0;
            local_60 = 0;
            uStack_5e = 0;
            local_5c = 0;
            uStack_5a = 0;
            local_58 = 0;
            uStack_56 = 0;
            local_54 = 0;
            uStack_52 = 0;
            local_50 = 0;
            uStack_4e = 0;
            iVar7 = piVar12[1];
            if (iVar7 == 0x183) {
                uVar27 = 1;
                iVar14 = piVar12[2];
            LAB_000220c4:
                iVar7 = FUN_00074054(*(undefined4 *)(iVar14 + 4),
                                     *(undefined2 *)(iVar14 + 8), puVar16);
                if (iVar7 == 0) {
                    puVar10 = (undefined4 *)FUN_00073ba4(0, 0x1c, 0, 1);
                    uVar2 = *(undefined2 *)(piVar12[2] + 8);
                    puVar10[1] = piVar12[1];
                    *(undefined1 *)(puVar10 + 4) = uVar27;
                    *(undefined2 *)(puVar10 + 2) = uVar2;
                    *(char *)((int)puVar10 + 0x11) = (char)piVar12[6];
                    *(char *)((int)puVar10 + 0x12) = (char)piVar12[4];
                    *(undefined1 *)((int)puVar10 + 0x13) =
                        *(undefined1 *)((int)piVar12 + 0x11);
                    uVar8 = FUN_0001cee8(piVar12[3]);
                    iVar13 = piVar12[5];
                    iVar7 = piVar12[7];
                    iVar14 = piVar12[8];
                    *puVar10 = uVar8;
                    puVar10[5] = iVar13;
                    puVar10[3] = iVar7;
                    puVar10[6] = iVar14;
                    memset(&local_d0, 0, 0x20);
                    local_cc = (uint) * (ushort *)(puVar10 + 2);
                    local_c8 = 2;
                    local_c4 = 0x11;
                    FUN_00077f40(*(undefined4 *)(piVar12[2] + 4), &DAT_0009ce60,
                                 &local_d0, 2, FUN_0001d1a8, puVar10, 0);
                    piVar12 = (int *)*piVar12;
                    if (piVar12 == (int *)0x0)
                        break;
                    goto LAB_00022154;
                }
                local_84._30_2_ = 0x7b00;
                iVar7 = FUN_0001cc78(puVar16, piVar12[1]);
                if (iVar7 != 0) {
                    uVar8 = FUN_0001cee8(piVar12[3]);
                    FUN_00042898(puVar16, 0, 0, 0xffffffff, uVar27,
                                 (char)piVar12[6], (char)piVar12[4],
                                 *(undefined1 *)((int)piVar12 + 0x11), uVar8,
                                 piVar12[5], piVar12[7], piVar12[8]);
                }
            } else {
                if (iVar7 < 0x184) {
                    if (iVar7 == 0x10f) {
                        iVar14 = piVar12[2];
                        uVar27 = 5;
                        goto LAB_000220c4;
                    }
                    if (iVar7 != 0x157)
                        goto LAB_000226f8;
                } else if ((iVar7 != 0x188) && (iVar7 != 0x197)) {
                LAB_000226f8:
                    /* WARNING: Subroutine does not return */
                    FUN_0007ecc0("ntp_config.c", 0xfd9, 2, "hmode != 0");
                }
                iVar14 = piVar12[2];
                uVar8 = *(undefined4 *)(iVar14 + 4);
                if (iVar7 != 0x188) {
                    uVar27 = 3;
                    goto LAB_000220c4;
                }
                local_84._28_2_ = *(short *)(iVar14 + 8);
                uVar18 = FUN_0001cee8(piVar12[3]);
                FUN_00042898(puVar16, uVar8, 0, 0xffffffff, 3, (char)piVar12[6],
                             (char)piVar12[4],
                             *(undefined1 *)((int)piVar12 + 0x11), uVar18,
                             piVar12[5], piVar12[7], piVar12[8]);
            }
            piVar12 = (int *)*piVar12;
        } while (piVar12 != (int *)0x0);
    }
    if ((int *)__dest[10] != (int *)0x0) {
        for (piVar12 = *(int **)__dest[10]; piVar12 != (int *)0x0;
             piVar12 = (int *)*piVar12) {
            if (piVar12[2] == 0) {
                iVar7 = FUN_00041c78(*(undefined2 *)(piVar12 + 1));
                if (iVar7 != 0) {
                    uVar8 = FUN_0007c2e8(iVar7 + 0x10);
                    FUN_00074e00(5, "unpeered %s", uVar8);
                    FUN_00046214(iVar7, &DAT_0009c3f0);
                    FUN_00041fc4(iVar7);
                }
            } else {
                puVar16 = local_84 + 0x1c;
                local_84._30_2_ = 0;
                local_64 = 0;
                uStack_62 = 0;
                local_60 = 0;
                uStack_5e = 0;
                local_5c = 0;
                uStack_5a = 0;
                local_58 = 0;
                uStack_56 = 0;
                local_54 = 0;
                uStack_52 = 0;
                local_50 = 0;
                uStack_4e = 0;
                pcVar19 = *(char **)(piVar12[2] + 4);
                local_84._28_2_ = *(short *)(piVar12[2] + 8);
                iVar7 = FUN_0001ce10(pcVar19, puVar16);
                piVar29 = peer_list;
                if (iVar7 < 1) {
                    for (; piVar29 != (int *)0x0; piVar29 = (int *)*piVar29) {
                        if (((char *)piVar29[0xb] != (char *)0x0) &&
                            (iVar7 = strcasecmp((char *)piVar29[0xb], pcVar19),
                             iVar7 == 0)) {
                            FUN_00074e00(5, "unpeered %s", pcVar19);
                            FUN_00046214(piVar29, &DAT_0009c3f0);
                            FUN_00041fc4(piVar29);
                            break;
                        }
                    }
                    memset(&local_d0, 0, 0x20);
                    local_cc = (uint) * (ushort *)(piVar12[2] + 8);
                    local_c8 = 2;
                    local_c4 = 0x11;
                    FUN_00078520(pcVar19, &DAT_0009ce60, &local_d0, 2,
                                 &LAB_0001d368, 0);
                } else {
                    iVar7 = FUN_00041a44(puVar16, 0, 0, 0xffffffff, 0, 0);
                    if (iVar7 != 0) {
                        uVar8 = FUN_0007c2e8(puVar16);
                        FUN_00074e00(5, "unpeered %s", uVar8);
                        FUN_00046214(iVar7, &DAT_0009c3f0);
                        FUN_00041fc4(iVar7);
                    }
                }
            }
        }
    }
    if (((int *)__dest[0x15] != (int *)0x0) &&
        (piVar12 = *(int **)__dest[0x15], piVar12 != (int *)0x0)) {
        puVar16 = local_84 + 0x1c;
        do {
            iVar14 = piVar12[1];
            local_84._28_2_ = 0;
            local_84._30_2_ = 0;
            local_64 = 0;
            uStack_62 = 0;
            local_60 = 0;
            uStack_5e = 0;
            local_5c = 0;
            uStack_5a = 0;
            local_58 = 0;
            uStack_56 = 0;
            local_54 = 0;
            uStack_52 = 0;
            local_50 = 0;
            uStack_4e = 0;
            iVar7 = FUN_0001ce10(*(undefined4 *)(iVar14 + 4), puVar16);
            if (iVar7 == 1) {
                if ((local_84._28_2_ != 2) || (local_64 != 0x7f7f)) {
                    uVar8 = FUN_0007c2e8(puVar16);
                    FUN_00074e00(3,
                                 "inappropriate address %s for the fudge "
                                 "command, line ignored",
                                 uVar8);
                    goto LAB_000224b0;
                }
                memset(&local_d0, 0, 0x48);
                if (((undefined4 *)piVar12[2] != (undefined4 *)0x0) &&
                    (piVar29 = *(int **)piVar12[2], piVar29 != (int *)0x0)) {
                    bVar31 = false;
                    goto LAB_00022528;
                }
            LAB_00022590:
                FUN_0004a3b4(puVar16, &local_d0, 0);
            } else {
                FUN_00074e00(3,
                             "unrecognized fudge reference clock address %s, "
                             "line ignored",
                             *(undefined4 *)(iVar14 + 4));
            LAB_000224b0:
                memset(&local_d0, 0, 0x48);
                if (((int *)piVar12[2] != (int *)0x0) &&
                    (piVar29 = *(int **)piVar12[2], piVar29 != (int *)0x0)) {
                    bVar31 = true;
                LAB_00022528:
                    do {
                        iVar7 = piVar29[1];
                        uVar15 = local_d0 >> 0x10;
                        if (iVar7 == 0x130) {
                            if (piVar29[4] == 0) {
                                local_d0._1_1_ = local_d0._1_1_ & 0xf7;
                            } else {
                                local_d0._1_1_ = local_d0._1_1_ | 8;
                            }
                            local_d0 = CONCAT22(
                                CONCAT11(local_d0._3_1_,
                                         ~((byte) ~(byte)((uVar15 << 0x19) >>
                                                          0x18) >>
                                           1)),
                                (undefined2)local_d0);
                        LAB_0002251c:
                            piVar29 = (int *)*piVar29;
                            if (piVar29 == (int *)0x0)
                                break;
                            goto LAB_00022528;
                        }
                        if (0x130 < iVar7) {
                            if (iVar7 == 0x1a2) {
                                local_d0 = local_d0 | 0x40000;
                                local_98 = piVar29[4];
                            } else if (iVar7 < 0x1a3) {
                                if (iVar7 != 400) {
                                LAB_00023094:
                                    uVar8 = FUN_0002bbb4();
                                    FUN_00074e00(
                                        3,
                                        "Unexpected fudge flag %s (%d) for %s",
                                        uVar8, piVar29[1],
                                        *(undefined4 *)(iVar14 + 4));
                                    iVar7 = piVar29[1];
                                    if (iVar7 == 0) {
                                        iVar7 = 1;
                                    }
                                    /* WARNING: Subroutine does not return */
                                    exit(iVar7);
                                }
                                local_94[0] = 0;
                                local_d0 = local_d0 | 0x80000;
                                pcVar19 = (char *)piVar29[4];
                                sVar11 = strlen(pcVar19);
                                if (3 < sVar11) {
                                    sVar11 = 4;
                                }
                                __memcpy_chk(local_94, pcVar19, sVar11, 0xc);
                            } else if (iVar7 == 0x1a7) {
                                local_d0 = local_d0 | 0x10000;
                                local_a8 = piVar29[4];
                                iStack_a4 = piVar29[5];
                            } else {
                                if (iVar7 != 0x1a8)
                                    goto LAB_00023094;
                                local_d0 = local_d0 | 0x20000;
                                local_a0 = piVar29[4];
                                iStack_9c = piVar29[5];
                            }
                            goto LAB_0002251c;
                        }
                        uVar2 = (undefined2)(local_d0 >> 0x10);
                        if (iVar7 == 0x12e) {
                            if (piVar29[4] == 0) {
                                local_d0._1_1_ = local_d0._1_1_ & 0xfd;
                            } else {
                                local_d0._1_1_ = local_d0._1_1_ | 2;
                            }
                            local_d0 = CONCAT22(uVar2, (undefined2)local_d0) |
                                       0x200000;
                            goto LAB_0002251c;
                        }
                        if (0x12e < iVar7) {
                            if (piVar29[4] == 0) {
                                local_d0._1_1_ = local_d0._1_1_ & 0xfb;
                            } else {
                                local_d0._1_1_ = local_d0._1_1_ | 4;
                            }
                            local_d0 = CONCAT22(uVar2, (undefined2)local_d0) |
                                       0x400000;
                            goto LAB_0002251c;
                        }
                        if (iVar7 != 0x12d)
                            goto LAB_00023094;
                        if (piVar29[4] == 0) {
                            local_d0._1_1_ = local_d0._1_1_ & 0xfe;
                        } else {
                            local_d0._1_1_ = local_d0._1_1_ | 1;
                        }
                        local_d0 =
                            CONCAT22(uVar2, (undefined2)local_d0) | 0x100000;
                        piVar29 = (int *)*piVar29;
                    } while (piVar29 != (int *)0x0);
                    if (!bVar31)
                        goto LAB_00022590;
                }
            }
            piVar12 = (int *)*piVar12;
        } while (piVar12 != (int *)0x0);
    }
    if ((int *)__dest[0x2a] != (int *)0x0) {
        for (piVar12 = *(int **)__dest[0x2a]; piVar12 != (int *)0x0;
             piVar12 = (int *)*piVar12) {
            while (iVar7 = piVar12[1], iVar7 != 0x142) {
                if (iVar7 < 0x143) {
                    if (iVar7 == 0x107) {
                        FUN_0004a860();
                    } else if (iVar7 == 0x11a) {
                        FUN_000341c4();
                    } else if (iVar7 == 0x106) {
                        FUN_00042b9c();
                    }
                    goto LAB_00022600;
                }
                if (iVar7 == 0x1a4) {
                    FUN_00048c70();
                    goto LAB_00022600;
                }
                if (iVar7 == 0x1a9) {
                    FUN_00051648();
                    goto LAB_00022600;
                }
                if (iVar7 != 0x161)
                    goto LAB_00022600;
                FUN_00042a70();
                piVar12 = (int *)*piVar12;
                if (piVar12 == (int *)0x0)
                    goto LAB_00022644;
            }
            FUN_00028d18();
        LAB_00022600:
        }
    }
LAB_00022644:
    if (local_44 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
code_r0x00020fd4:
    pcVar19 = (char *)((uint)pcVar26 & 0x840);
    if ((((uint)pcVar26 & 0x1000) != 0) && (DAT_000c8610 == 0)) {
        DAT_000c8610 = 1;
        __fprintf_chk(stderr, 1, "%s\n",
                      "mssntp restrict bit ignored, this ntpd was configured "
                      "without --enable-ntp-signd.");
        FUN_00074e00(4, "%s",
                     "mssntp restrict bit ignored, this ntpd was configured "
                     "without --enable-ntp-signd.");
    }
    if (pcVar19 == (char *)0x800) {
        if (*(int *)(local_f8 + 4) == 0) {
            if (((uint)ppuVar28 & 0x4000) == 0) {
                pcVar21 = "default";
            } else {
                pcVar21 = "source";
            }
        } else {
            pcVar21 = *(char **)(*(int *)(local_f8 + 4) + 4);
        }
        pcVar19 = "KOD does nothing without LIMITED.";
        __fprintf_chk(stderr, 1, "restrict %s: %s\n", pcVar21,
                      "KOD does nothing without LIMITED.");
        FUN_00074e00(4, "restrict %s: %s", pcVar21,
                     "KOD does nothing without LIMITED.");
    }
    local_84._0_4_ = 0;
    local_84._4_4_ = 0;
    local_84._8_4_ = 0;
    local_84._12_4_ = 0;
    local_84._16_4_ = 0;
    local_84._20_4_ = (sockaddr *)0x0;
    local_84._24_4_ = (char *)0x0;
    iVar14 = *(int *)(local_f8 + 4);
    local_d4 = (addrinfo *)0x0;
    if (iVar14 == 0) {
        unaff_r11 = local_84 + 0x1c;
        local_84._28_2_ = 0;
        local_84._30_2_ = 0;
        if (((uint)ppuVar28 & 0x4000) != 0) {
            local_64 = local_84._28_2_;
            uStack_62 = local_84._30_2_;
            local_60 = local_84._28_2_;
            uStack_5e = local_84._30_2_;
            local_5c = local_84._28_2_;
            uStack_5a = local_84._30_2_;
            local_58 = local_84._28_2_;
            uStack_56 = local_84._30_2_;
            local_54 = local_84._28_2_;
            uStack_52 = local_84._30_2_;
            local_50 = local_84._28_2_;
            uStack_4e = local_84._30_2_;
            FUN_00050238(1, 0, 0, iVar7, ppuVar28, pcVar26, 0);
            goto LAB_00021208;
        }
    LAB_00021474:
        uStack_4e = 0;
        local_50 = 0;
        uStack_52 = 0;
        local_84._24_4_ = (char *)0x0;
        local_84._20_4_ = (sockaddr *)0x0;
        local_84._16_4_ = 0;
        local_84._12_4_ = 0;
        local_84._8_4_ = 0;
        local_84._4_4_ = 0;
        local_d4 = (addrinfo *)0x0;
        local_84._0_2_ = 2;
        local_84._2_2_ = 0;
        local_84._28_2_ = 2;
        local_84._30_2_ = uStack_52;
        local_64 = local_50;
        uStack_62 = uStack_52;
        local_60 = local_50;
        uStack_5e = uStack_52;
        local_5c = local_50;
        uStack_5a = uStack_52;
        local_58 = local_50;
        uStack_56 = uStack_52;
        local_54 = local_50;
        FUN_00050238(1, local_84, local_84 + 0x1c, iVar7, ppuVar28, pcVar26, 0);
        local_84._0_2_ = 10;
        local_84._28_2_ = 10;
        FUN_00050238(1, local_84, local_84 + 0x1c, iVar7, ppuVar28, pcVar26, 0);
    } else {
    LAB_00021090:
        local_84._24_4_ = (char *)0x0;
        local_84._20_4_ = (sockaddr *)0x0;
        local_84._16_4_ = 0;
        local_84._12_4_ = 0;
        local_84._8_4_ = 0;
        local_84._4_4_ = 0;
        local_d4 = (addrinfo *)0x0;
        local_84._2_2_ = 0;
        local_84._0_2_ = *(ushort *)(iVar14 + 8);
        iVar14 = FUN_0001ce10(*(undefined4 *)(iVar14 + 4), local_84);
        if (iVar14 == 1) {
            pcVar22 = (char *)0x0;
        } else {
            local_d4 = (addrinfo *)0x0;
            paVar20 = (addrinfo *)memset(&local_d0, 0, 0x20);
            pcVar19 = (char *)0x2;
            local_c4 = 0x11;
            local_cc = (uint) * (ushort *)(*(int *)(local_f8 + 4) + 8);
            local_c8 = 2;
            iVar14 = getaddrinfo(*(char **)(*(int *)(local_f8 + 4) + 4), "ntp",
                                 paVar20, &local_d4);
            paVar20 = local_d4;
            if (iVar14 != 0) {
                FUN_00074e00(
                    3,
                    "restrict: ignoring line %d, address/host \'%s\' unusable.",
                    *(undefined4 *)(local_f8 + 0x10),
                    *(undefined4 *)(*(int *)(local_f8 + 4) + 4));
                goto LAB_00021208;
            }
            if (local_d4 == (addrinfo *)0x0)
                goto LAB_000231d4;
            if (local_d4->ai_addr == (sockaddr *)0x0) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_config.c", 0xad1, 2,
                             "pai->ai_addr != ((void *)0)");
            }
            if (0x1c < local_d4->ai_addrlen) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_config.c", 0xad3, 2,
                             "sizeof(addr) >= pai->ai_addrlen");
            }
            __memcpy_chk(local_84, local_d4->ai_addr, local_d4->ai_addrlen,
                         0x1c);
            pcVar22 = (char *)paVar20;
            if ((local_84._0_4_ & 0xfff7) != 2) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_config.c", 0xad7, 2,
                             "2 == ((&addr)->sa.sa_family) || 10 == "
                             "((&addr)->sa.sa_family)");
            }
        }
        uVar15 = local_84._0_4_ & 0xffff;
        bVar31 = uVar15 == 10;
        paVar24 = (addrinfo *)(local_84 + 0x1e);
        local_84._28_2_ = (undefined2)local_84._0_4_;
        uStack_62 = 0;
        if (bVar31) {
            uVar15 = 0xffffffff;
        }
        local_84._30_2_ = 0;
        local_64 = 0;
        local_54 = 0;
        uStack_52 = 0;
        local_50 = 0;
        uStack_4e = 0;
        if (bVar31) {
            local_5c = (short)uVar15;
            uStack_5a = (ushort)(uVar15 >> 0x10);
            local_54 = local_5c;
            uStack_52 = uStack_5a;
        } else {
            local_64 = -1;
            uStack_62 = 0xffff;
        }
        local_60 = local_54;
        uStack_5e = uStack_52;
        local_5c = local_54;
        uStack_5a = uStack_52;
        local_58 = local_54;
        uStack_56 = uStack_52;
        if (*(int *)(local_f8 + 8) != 0) {
            unaff_r11 = local_84 + 0x1c;
            local_84._30_2_ = 0;
            local_64 = 0;
            uStack_62 = 0;
            local_60 = 0;
            uStack_5e = 0;
            local_5c = 0;
            uStack_5a = 0;
            local_58 = 0;
            uStack_56 = 0;
            local_54 = 0;
            uStack_52 = 0;
            local_50 = 0;
            uStack_4e = 0;
            local_84._28_2_ = *(short *)(*(int *)(local_f8 + 8) + 8);
            iVar14 = FUN_0001ce10(*(undefined4 *)(*(int *)(local_f8 + 8) + 4),
                                  unaff_r11);
            if (iVar14 != 1) {
                FUN_00074e00(
                    3, "restrict: ignoring line %d, mask \'%s\' unusable.",
                    *(undefined4 *)(local_f8 + 0x10),
                    *(undefined4 *)(*(int *)(local_f8 + 8) + 4));
                pcVar19 = local_f8;
                goto LAB_00021208;
            }
        }
        while ((FUN_00050238(1, local_84, local_84 + 0x1c, iVar7, ppuVar28,
                             pcVar26, 0),
                (addrinfo *)pcVar22 != (addrinfo *)0x0 &&
                    (pcVar22 = (char *)((addrinfo *)pcVar22)->ai_next,
                     (addrinfo *)pcVar22 != (addrinfo *)0x0))) {
            if (((addrinfo *)pcVar22)->ai_addr == (sockaddr *)0x0) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_config.c", 0xafa, 2,
                             "pai->ai_addr != ((void *)0)");
            }
            if (0x1c < ((addrinfo *)pcVar22)->ai_addrlen) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_config.c", 0xafc, 2,
                             "sizeof(addr) >= pai->ai_addrlen");
            }
            local_84._0_4_ = 0;
            local_84._4_4_ = 0;
            local_84._8_4_ = 0;
            local_84._12_4_ = 0;
            local_84._16_4_ = 0;
            local_84._20_4_ = (sockaddr *)0x0;
            local_84._24_4_ = (char *)0x0;
            __memcpy_chk(local_84, ((addrinfo *)pcVar22)->ai_addr,
                         ((addrinfo *)pcVar22)->ai_addrlen, 0x1c);
            if ((local_84._0_4_ & 0xfff7) != 2) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_config.c", 0xb01, 2,
                             "2 == ((&addr)->sa.sa_family) || 10 == "
                             "((&addr)->sa.sa_family)");
            }
            bVar31 = (local_84._0_4_ & 0xffff) == 10;
            local_84._30_2_ = 0;
            local_64 = 0;
            uStack_62 = 0;
            uVar8 = 2;
            if (bVar31) {
                uVar8 = 0xffffffff;
            }
            local_54 = 0;
            uStack_52 = 0;
            local_50 = 0;
            uStack_4e = 0;
            local_84._28_2_ = local_84._0_2_;
            if (bVar31) {
                local_5c = (short)uVar8;
                uStack_5a = (ushort)((uint)uVar8 >> 0x10);
                local_60 = local_5c;
                uStack_5e = uStack_5a;
                local_58 = local_5c;
                uStack_56 = uStack_5a;
                local_54 = local_5c;
                uStack_52 = uStack_5a;
            } else {
                local_64 = -1;
                uStack_62 = 0xffff;
                local_60 = local_54;
                uStack_5e = uStack_52;
                local_5c = local_54;
                uStack_5a = uStack_52;
                local_58 = local_54;
                uStack_56 = uStack_52;
            }
        }
    }
    unaff_r11 = local_84 + 0x1c;
    pcVar19 = (char *)0x0;
    if (local_d4 != (addrinfo *)0x0) {
        freeaddrinfo(local_d4);
    }
LAB_00021208:
    paVar20 = (addrinfo *)local_84;
    local_f8 = *(char **)local_f8;
    if (local_f8 == (char *)0x0)
        goto LAB_0002121c;
    goto LAB_00020d64;
code_r0x000217c0:
    FUN_0001c954("config-logconfig: modifier=\'%c\'");
    puVar16 = (undefined1 *)local_f4;
LAB_000217cc:
    FUN_0001fb7c(7, &DAT_000a7f7c, piVar12[4], piVar12[4] >> 0x1f, 1,
                 &DAT_000a7f7c);
    goto LAB_00021760;
}

void FUN_000232b0(undefined4 param_1)

{
    undefined4 uVar1;
    undefined1 auStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    uVar1 = FUN_0007c2e8();
    FUN_0007c054(auStack_9c, 0x80, "remote config from %s", uVar1);
    FUN_0002c148(auStack_9c, 0);
    memset(cfgt, 0, 0xb8);
    cfgt._176_4_ = 5;
    FUN_0002973c();
    FUN_0002c1cc();
    cfgt._12_4_ = 1;
    cfgt._32_4_ = time((time_t *)0x0);
    FUN_0007c2e8(param_1);
    cfgt._24_4_ = FUN_00073d08();
    FUN_0001fd04(0);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00023380(undefined4 param_1, undefined4 param_2)

{
    size_t sVar1;
    undefined4 uVar2;
    int iVar3;
    char acStack_124[256];
    int local_24;

    local_24 = __stack_chk_guard;
    config_file = "/etc/ntp.conf";
    FUN_0007c054(acStack_124, 0x100, "daemon_version=\"%s\"", Version);
    sVar1 = strlen(acStack_124);
    FUN_000345c4(acStack_124, sVar1 + 1);
    set_tod_using = &LAB_0001cbfc;
    FUN_0002e008(param_1, param_2);
    memset(cfgt, 0, 0xb8);
    cfgt._176_4_ = 5;
    uVar2 = FUN_00073d78(config_file);
    iVar3 = FUN_0002c148(uVar2, "r");
    if (iVar3 == 0) {
        uVar2 = FUN_00073d78(config_file);
        FUN_00074e00(6, "getconfig: Couldn\'t open <%s>: %m", uVar2);
        FUN_00028484();
    } else {
        cfgt._24_4_ = FUN_00073d08();
        FUN_0002973c();
        FUN_0002c1cc();
        cfgt._12_4_ = 0;
        cfgt._32_4_ = time((time_t *)0x0);
        FUN_0001fd04(1);
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00023d38(short *param_1)

{
    int iVar1;
    bool bVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (*param_1 == 2) {
        bVar2 = *(int *)(param_1 + 2) == 0;
    } else if (*param_1 == 10) {
        iVar3 = memcmp(param_1 + 4, &in6addr_any, 0x10);
        bVar2 = iVar3 == 0;
    } else {
        bVar2 = false;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(bVar2);
    }
    return;
}

void FUN_00023dc8(short *param_1)

{
    short sVar1;
    int iVar2;
    int iVar3;
    int *piVar4;

    iVar2 = __stack_chk_guard;
    piVar4 = remoteaddr_list;
    if (remoteaddr_list != (int *)0x0) {
        sVar1 = *param_1;
    LAB_00023e18:
        do {
            if ((short)piVar4[1] == sVar1) {
                if (sVar1 == 2) {
                    if (piVar4[2] != *(int *)(param_1 + 2)) {
                        piVar4 = (int *)*piVar4;
                        if (piVar4 == (int *)0x0)
                            break;
                        goto LAB_00023e18;
                    }
                } else {
                    iVar3 = memcmp(piVar4 + 3, param_1 + 4, 0x10);
                    if ((iVar3 != 0) || (piVar4[7] != *(int *)(param_1 + 0xc)))
                        goto LAB_00023e0c;
                }
                piVar4 = (int *)piVar4[8];
                break;
            }
        LAB_00023e0c:
            piVar4 = (int *)*piVar4;
        } while (piVar4 != (int *)0x0);
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar4);
    }
    return;
}

void FUN_00023ea4(undefined4 *param_1, undefined4 param_2)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    bool bVar6;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined4 *)FUN_00073ba4(0, 0x24, 0);
    uVar3 = param_1[1];
    uVar4 = param_1[2];
    uVar5 = param_1[3];
    puVar2[1] = *param_1;
    puVar2[2] = uVar3;
    puVar2[3] = uVar4;
    puVar2[4] = uVar5;
    uVar3 = param_1[5];
    uVar4 = param_1[6];
    bVar6 = iVar1 == __stack_chk_guard;
    puVar2[5] = param_1[4];
    puVar2[6] = uVar3;
    puVar2[7] = uVar4;
    puVar2[8] = param_2;
    *puVar2 = remoteaddr_list;
    remoteaddr_list = puVar2;
    if (bVar6) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00023f3c(void *param_1)

{
    int iVar1;
    void *__s;
    bool bVar2;

    iVar1 = __stack_chk_guard;
    __s = (void *)FUN_00073ba4(0, 0xc0, 0);
    if (param_1 == (void *)0x0) {
        memset(__s, 0, 0xc0);
        *(undefined4 *)((int)__s + 0xc) = 0xffffffff;
        *(undefined4 *)((int)__s + 0x10) = 0xffffffff;
        *(undefined2 *)((int)__s + 0x8e) = DAT_000c9240;
    } else {
        memcpy(__s, param_1, 0xc0);
    }
    bVar2 = iVar1 == __stack_chk_guard;
    *(int *)((int)__s + 0x14) = sys_ifnum;
    sys_ifnum = sys_ifnum + 1;
    *(undefined4 *)((int)__s + 0xa0) = current_time;
    if (bVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_0002400c(int param_1, int param_2, short *param_3)

{
    int iVar1;
    undefined4 uVar2;
    bool bVar3;
    undefined4 local_18;
    int local_14;

    local_18 = 1;
    local_14 = __stack_chk_guard;
    if (*param_3 == 2) {
        iVar1 = setsockopt(param_2, 1, 6, &local_18, 4);
        if (iVar1 != 0) {
            uVar2 = FUN_0007c2e8(param_3);
            FUN_00074e00(
                3, "setsockopt(SO_BROADCAST) enable failure on address %s: %m",
                uVar2);
        }
    }
    bVar3 = local_14 == __stack_chk_guard;
    *(uint *)(param_1 + 0x90) = *(uint *)(param_1 + 0x90) | 0x400;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(1);
}

void FUN_000240c0(int param_1, int param_2)

{
    int iVar1;
    char *pcVar2;
    int local_14[2];
    int local_c;

    local_c = __stack_chk_guard;
    iVar1 = any_interface;
    if (param_1 != 2) {
        iVar1 = any6_interface;
    }
    local_14[0] = param_2;
    if (((iVar1 != 0) && (*(int *)(iVar1 + 0xc) != -1)) &&
        (iVar1 = setsockopt(*(int *)(iVar1 + 0xc), 1, 2, local_14, 4),
         iVar1 != 0)) {
        if (local_14[0] == 0) {
            pcVar2 = "off";
        } else {
            pcVar2 = "on";
        }
        FUN_00074e00(
            3, "set_wildcard_reuse: setsockopt(SO_REUSEADDR, %s) failed: %m",
            pcVar2);
    }
    if (local_c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000241a4(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    char *pcVar3;
    int *piVar4;
    int local_24[2];
    int local_1c;

    local_1c = __stack_chk_guard;
    local_24[0] = param_1;
    if (ep_list != (int *)0x0) {
        piVar4 = ep_list;
        do {
            if ((((piVar4[0x24] & 0x80U) == 0) && (piVar4[3] != -1)) &&
                (iVar1 = setsockopt(piVar4[3], 1, 2, local_24, 4),
                 iVar1 != 0)) {
                uVar2 = FUN_0007c2e8(piVar4 + 6);
                pcVar3 = "on";
                if (local_24[0] == 0) {
                    pcVar3 = "off";
                }
                FUN_00074e00(3,
                             "set_reuseaddr: setsockopt(%s, SO_REUSEADDR, %s) "
                             "failed: %m",
                             uVar2, pcVar3);
            }
            piVar4 = (int *)*piVar4;
        } while (piVar4 != (int *)0x0);
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00024298(undefined4 *param_1)

{
    short sVar1;
    short sVar2;
    bool bVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;
    int iVar6;
    int iVar7;
    undefined4 uVar8;
    int iVar9;
    uint *puVar10;
    int *piVar11;
    uint *puVar12;
    uint uVar13;
    uint uVar14;
    uint uVar15;
    int iVar16;
    int iVar17;
    undefined4 *puVar18;
    uint uVar19;
    uint *__s1;
    uint *puVar20;
    bool bVar21;
    uint local_50;
    int *local_4c;
    uint local_48;
    uint local_40;

    iVar7 = __stack_chk_guard;
    puVar18 = param_1 + 6;
    uVar8 = FUN_0007083c(puVar18);
    param_1[0x26] = uVar8;
    puVar4 = &ep_list;
    for (puVar5 = ep_list; puVar5 != (undefined4 *)0x0;
         puVar5 = (undefined4 *)*puVar5) {
        puVar4 = puVar5;
    }
    *param_1 = 0;
    *puVar4 = param_1;
    ninterfaces = ninterfaces + 1;
    if ((param_1[0x2d] == 0) && ((param_1[0x24] & 0x14) == 0x10)) {
        sVar1 = *(short *)(param_1 + 0x23);
        local_50 = 0;
        local_48 = local_50;
        local_40 = local_50;
        if (sVar1 == 2) {
            local_4c = &mc4_list;
            iVar16 = mc4_list;
            if (mc4_list != 0)
                goto LAB_00024388;
            iVar16 = 0;
        LAB_0002474c:
            param_1[1] = iVar16;
            *local_4c = (int)param_1;
        } else {
            local_4c = &mc6_list;
            iVar16 = mc6_list;
            if (sVar1 == 10) {
                local_48 = (uint)(param_1[0x24] << 0x16) >> 0x1f;
                local_50 = (uint)((param_1[8] & 0x80ff) == 0x80fe);
                local_40 = ((uint) * (byte *)(param_1 + 10) << 0x1e) >> 0x1f;
                if (mc6_list != 0)
                    goto LAB_00024388;
                if ((param_1[8] & 0x80ff) != 0x80fe)
                    goto LAB_0002474c;
            } else {
                if (mc6_list == 0)
                    goto LAB_0002474c;
            LAB_00024388:
            LAB_00024400:
                do {
                    iVar17 = *(int *)(iVar16 + 4);
                    if ((*(short *)(iVar16 + 0x8c) == sVar1) &&
                        (iVar9 = strcmp((char *)(param_1 + 0x1b),
                                        (char *)(iVar16 + 0x6c)),
                         iVar9 == 0)) {
                        sVar2 = *(short *)(param_1 + 0xd);
                        if (sVar2 != *(short *)(param_1 + 6)) {
                            /* WARNING: Subroutine does not return */
                            FUN_0007ecc0("ntp_io.c", 699, 0,
                                         "((a)->sa.sa_family) == "
                                         "((a_mask)->sa.sa_family)");
                        }
                        if (*(short *)(iVar16 + 0x34) !=
                            *(short *)(iVar16 + 0x18)) {
                            /* WARNING: Subroutine does not return */
                            FUN_0007ecc0("ntp_io.c", 700, 0,
                                         "((b)->sa.sa_family) == "
                                         "((b_mask)->sa.sa_family)");
                        }
                        if (sVar2 == *(short *)(iVar16 + 0x34)) {
                            if (sVar2 == 2) {
                                if (param_1[0xe] == *(int *)(iVar16 + 0x38)) {
                                LAB_000246e8:
                                    puVar10 = param_1 + 7;
                                    puVar12 = (uint *)(iVar16 + 0x1c);
                                    __s1 = param_1 + 0xe;
                                    iVar9 = 4;
                                LAB_00024634:
                                    if ((uint *)((int)puVar10 + iVar9) <=
                                        puVar10) {
                                    LAB_0002468c:
                                        bVar3 = true;
                                        goto LAB_00024450;
                                    }
                                    if (((*puVar12 ^ *puVar10) & *__s1) == 0) {
                                        puVar20 =
                                            (uint *)((int)puVar12 +
                                                     (~(uint)puVar10 +
                                                          (int)puVar10 + iVar9 &
                                                      0xfffffffc));
                                        do {
                                            if (puVar20 == puVar12)
                                                goto LAB_0002468c;
                                            puVar10 = puVar10 + 1;
                                            puVar12 = puVar12 + 1;
                                            __s1 = __s1 + 1;
                                        } while (((*puVar10 ^ *puVar12) &
                                                  *__s1) == 0);
                                    }
                                }
                                goto LAB_0002444c;
                            }
                            __s1 = param_1 + 0xf;
                            iVar9 = memcmp(__s1, (void *)(iVar16 + 0x3c), 0x10);
                            if (iVar9 != 0)
                                goto LAB_0002444c;
                            bVar3 = false;
                            if (param_1[0x13] == *(int *)(iVar16 + 0x4c)) {
                                if (sVar2 != 10)
                                    goto LAB_000246e8;
                                puVar10 = param_1 + 8;
                                puVar12 = (uint *)(iVar16 + 0x20);
                                iVar9 = 0x10;
                                goto LAB_00024634;
                            }
                        } else {
                        LAB_0002444c:
                            bVar3 = false;
                        }
                    LAB_00024450:
                        uVar13 = local_50;
                        if (sVar1 == 10) {
                            uVar14 =
                                ((uint) * (byte *)(iVar16 + 0x28) << 0x1e) >>
                                0x1f;
                            uVar15 =
                                (uint)(*(int *)(iVar16 + 0x90) << 0x16) >> 0x1f;
                            bVar21 =
                                (*(uint *)(iVar16 + 0x20) & 0x80ff) == 0x80fe;
                            if (bVar21) {
                                uVar13 = 0;
                            }
                            uVar19 = (uint)bVar21;
                        } else {
                            uVar15 = 0;
                            uVar14 = 0;
                            uVar19 = 0;
                        }
                        if (uVar13 != 0)
                            goto LAB_00024334;
                        if (bVar3) {
                            if ((((uVar15 ^ 1) & local_48) != 0) ||
                                (((local_40 ^ 1) & uVar14) != 0))
                                goto LAB_00024334;
                            if ((((local_50 ^ 1) & uVar19) == 0) &&
                                (((local_48 ^ 1) & uVar15) == 0)) {
                                uVar19 = (uVar14 ^ 1) & local_40;
                                goto joined_r0x000243f4;
                            }
                        } else {
                            uVar19 = (local_50 ^ 1) & uVar19;
                        joined_r0x000243f4:
                            if (uVar19 == 0)
                                goto LAB_000243f8;
                        }
                        iVar9 = *local_4c;
                        piVar11 = local_4c;
                        if (iVar9 == iVar16) {
                        LAB_000244c4:
                            *piVar11 = *(int *)(iVar16 + 4);
                            iVar16 = iVar17;
                            if (iVar17 == 0)
                                break;
                            goto LAB_00024400;
                        }
                        if (iVar9 != 0) {
                            for (iVar6 = *(int *)(iVar9 + 4); iVar6 != 0;
                                 iVar6 = *(int *)(iVar6 + 4)) {
                                if (iVar6 == iVar16) {
                                    piVar11 = (int *)(iVar9 + 4);
                                    iVar16 = iVar6;
                                    goto LAB_000244c4;
                                }
                                iVar9 = iVar6;
                            }
                        }
                    }
                LAB_000243f8:
                    iVar16 = iVar17;
                } while (iVar17 != 0);
                iVar16 = *local_4c;
                if (local_50 == 0)
                    goto LAB_0002474c;
                if (iVar16 != 0) {
                    do {
                        iVar17 = iVar16;
                        iVar16 = *(int *)(iVar17 + 4);
                    } while (iVar16 != 0);
                    local_4c = (int *)(iVar17 + 4);
                }
            }
            param_1[1] = 0;
            *local_4c = (int)param_1;
        }
        iVar16 = param_1[3];
        if (iVar16 != -1) {
            if (*(short *)(param_1 + 6) == 2) {
                iVar16 = setsockopt(iVar16, 0, 0x20, param_1 + 7, 4);
                if (iVar16 != 0) {
                    uVar8 = FUN_0007c2e8(puVar18);
                    if (iVar7 == __stack_chk_guard) {
                        FUN_00074e00(3,
                                     "setsockopt IP_MULTICAST_IF %s fails: %m",
                                     uVar8);
                        return;
                    }
                    goto LAB_000247c0;
                }
            } else if ((*(short *)(param_1 + 6) == 10) &&
                       (iVar16 =
                            setsockopt(iVar16, 0x29, 0x11, param_1 + 0x2c, 4),
                        iVar16 != 0)) {
                iVar16 = param_1[0x2c];
                if (*(short *)(param_1 + 6) == 2) {
                    iVar17 = 0;
                } else {
                    iVar17 = param_1[0xc];
                }
                if (iVar16 != iVar17) {
                    uVar8 = FUN_0007c2e8(puVar18);
                    if (iVar7 == __stack_chk_guard) {
                        FUN_00074e00(
                            3,
                            "setsockopt IPV6_MULTICAST_IF %u for %s fails: %m",
                            iVar16, uVar8);
                        return;
                    }
                    goto LAB_000247c0;
                }
            }
        }
    }
LAB_00024334:
    if (iVar7 == __stack_chk_guard) {
        return;
    }
LAB_000247c0:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002482c(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    char *pcVar3;
    undefined4 uVar4;

    iVar1 = __stack_chk_guard;
    if (*(int *)(param_1 + 0xb4) == 0) {
        pcVar3 = "Listen normally";
    } else {
        pcVar3 = "Listen and drop";
    }
    uVar4 = *(undefined4 *)(param_1 + 0x14);
    uVar2 = FUN_0007c47c(param_1 + 0x18);
    FUN_00074e00(6, "%s on %d %s %s", pcVar3, uVar4, param_1 + 0x6c, uVar2);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000248d0(int param_1, short *param_2)

{
    undefined4 uVar1;
    int iVar2;
    undefined4 local_30;
    undefined4 local_2c;
    undefined4 local_28;
    undefined4 uStack_24;
    undefined4 uStack_20;
    undefined4 uStack_1c;
    undefined4 local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    if (*param_2 == 2) {
        local_30 = *(undefined4 *)(param_2 + 2);
        local_2c = 0;
        iVar2 = setsockopt(*(int *)(param_1 + 0xc), 0, 0x23, &local_30, 8);
        if (iVar2 != 0) {
            uVar1 = 0;
            goto LAB_00024924;
        }
    } else if (*param_2 == 10) {
        local_28 = *(undefined4 *)(param_2 + 4);
        uStack_24 = *(undefined4 *)(param_2 + 6);
        uStack_20 = *(undefined4 *)(param_2 + 8);
        uStack_1c = *(undefined4 *)(param_2 + 10);
        local_18 = *(undefined4 *)(param_1 + 0xb0);
        iVar2 =
            setsockopt(*(int *)(param_1 + 0xc), 0x29, 0x14, &local_28, 0x14);
        if (iVar2 != 0) {
            uVar1 = 0;
            goto LAB_00024924;
        }
    }
    uVar1 = 1;
    *(uint *)(param_1 + 0x90) = *(uint *)(param_1 + 0x90) | 0x40;
    *(int *)(param_1 + 0x9c) = *(int *)(param_1 + 0x9c) + 1;
LAB_00024924:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1);
}

void FUN_000249cc(char *param_1, int *param_2, uint param_3)

{
    int iVar1;
    char *pcVar2;
    int *piVar3;
    int iVar4;
    undefined1 auStack_84[24];
    undefined1 auStack_6c[24];
    int local_54;
    int iStack_50;
    int iStack_4c;
    int iStack_48;
    int local_44;
    int iStack_40;
    int iStack_3c;
    undefined4 local_38;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar1 = FUN_00023d38(param_2);
    if (nic_rule_list != (int *)0x0) {
        piVar3 = nic_rule_list;
        do {
            switch (piVar3[2]) {
            case 0:
                if (iVar1 == 0 && -1 < (int)(param_3 << 0x1d)) {
                LAB_00024b98:
                    piVar3 = (int *)piVar3[1];
                    goto LAB_00024b70;
                }
                break;
            case 1:
                if ((short)*param_2 == 2)
                    goto LAB_00024b98;
                break;
            case 2:
                if ((short)*param_2 == 10)
                    goto LAB_00024b98;
                break;
            case 3:
                iVar4 = iVar1;
            joined_r0x00024b0c:
                if (iVar4 != 0)
                    goto LAB_00024b98;
                break;
            case 4:
                if ((param_1 != (char *)0x0) &&
                    (iVar4 = fnmatch((char *)piVar3[3], param_1, 0x10),
                     iVar4 == 0))
                    goto LAB_00024b98;
                break;
            case 5:
                iVar4 = piVar3[0xb];
                if (iVar4 != -1) {
                    local_54 = *param_2;
                    iStack_50 = param_2[1];
                    iStack_4c = param_2[2];
                    iStack_48 = param_2[3];
                    local_34 = 0;
                    local_38 = 0;
                    local_30 = 0;
                    local_44 = param_2[4];
                    iStack_40 = param_2[5];
                    iStack_3c = param_2[6];
                    FUN_00084ce8(auStack_84, &local_54);
                    local_38 = 0;
                    local_34 = 0;
                    local_30 = 0;
                    local_54 = piVar3[4];
                    iStack_50 = piVar3[5];
                    iStack_4c = piVar3[6];
                    iStack_48 = piVar3[7];
                    iStack_3c = piVar3[10];
                    local_44 = piVar3[8];
                    iStack_40 = piVar3[9];
                    FUN_00084ce8(auStack_6c, &local_54);
                    iVar4 = FUN_00084518(auStack_84, auStack_6c, iVar4);
                    goto joined_r0x00024b0c;
                }
                if ((short)piVar3[4] == (short)*param_2) {
                    if ((short)piVar3[4] == 2) {
                        if (param_2[1] == piVar3[5])
                            goto LAB_00024b98;
                    } else {
                        iVar4 = memcmp(param_2 + 2, piVar3 + 6, 0x10);
                        if ((iVar4 == 0) && (param_2[6] == piVar3[10]))
                            goto LAB_00024b98;
                    }
                }
            }
            piVar3 = (int *)*piVar3;
        } while (piVar3 != (int *)0x0);
    }
    if ((param_3 & 4) == 0) {
        if (iVar1 == 0) {
            pcVar2 = param_1;
            if (param_1 != (char *)0x0) {
                pcVar2 = (char *)0x1;
            }
            if (listen_to_virtual_ips != 0) {
                pcVar2 = (char *)0x0;
            }
            if ((pcVar2 == (char *)0x0) ||
                (pcVar2 = strchr(param_1, 0x3a), pcVar2 == (char *)0x0)) {
                piVar3 = nic_rule_list;
                if (nic_rule_list != (int *)0x0) {
                    piVar3 = (int *)0x1;
                }
            } else {
                piVar3 = (int *)0x1;
            }
        } else {
            piVar3 = (int *)0x2;
        }
    } else {
        piVar3 = (int *)0x0;
    }
LAB_00024b70:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar3);
    }
    return;
}

void FUN_00024c78(int param_1, int param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    ssize_t sVar2;
    uint uVar3;
    undefined4 uVar4;
    int iVar5;
    int *piVar6;
    uint uVar7;
    uint uVar8;
    uint *puVar9;
    void *pvVar10;
    double dVar11;
    longlong lVar12;
    undefined8 uVar13;
    socklen_t local_690;
    iovec local_68c[2];
    msghdr local_67c;
    sockaddr sStack_660;
    uint local_644[384];
    int local_44;

    local_44 = __stack_chk_guard;
    iVar1 = FUN_0007a108();
    if (iVar1 != 0) {
        if (*(int *)(param_2 + 0xb4) == 0) {
            local_68c[0].iov_base = (void *)(iVar1 + 0x58);
            local_67c.msg_iov = local_68c;
            local_690 = 0x1c;
            pvVar10 = (void *)(iVar1 + 4);
            local_67c.msg_namelen = 0x1c;
            local_68c[0].iov_len = 0x848;
            local_67c.msg_iovlen = 1;
            local_67c.msg_control = local_644;
            local_67c.msg_controllen = 0x600;
            local_67c.msg_name = pvVar10;
            local_67c.msg_flags = *(int *)(param_2 + 0xb4);
            sVar2 = recvmsg(param_1, &local_67c, 0);
            *(ssize_t *)(iVar1 + 0x54) = sVar2;
            if (sVar2 != 0) {
                if (sVar2 == -1) {
                    piVar6 = __errno_location();
                    if (*piVar6 == 0xb)
                        goto LAB_00025010;
                } else if (-1 < sVar2) {
                    if ((*(short *)(iVar1 + 4) == 2) &&
                        (*(short *)(iVar1 + 8) == 0x7f7f)) {
                        uVar4 = FUN_0007c2e8(pvVar10);
                        FUN_00074e00(3,
                                     "recvfrom(%s) fd=%d: refclock srcadr on a "
                                     "network interface!",
                                     uVar4, param_1);
                    } else if (((*(short *)(param_2 + 0x8c) != 10) ||
                                ((((*(int *)(iVar1 + 0xc) != 0 ||
                                    (*(int *)(iVar1 + 0x10) != 0)) ||
                                   (*(int *)(iVar1 + 0x14) != 0)) ||
                                  (*(int *)(iVar1 + 0x18) != 0x1000000)))) ||
                               ((((*(int *)(param_2 + 0x20) == 0 &&
                                   (*(int *)(param_2 + 0x24) == 0)) &&
                                  (*(int *)(param_2 + 0x28) == 0)) &&
                                 (*(int *)(param_2 + 0x2c) == 0x1000000)))) {
                        *(int *)(iVar1 + 0x3c) = param_2;
                        *(int *)(iVar1 + 0x40) = param_1;
                        lVar12 = CONCAT44(param_3, param_4);
                        if ((0xb < local_67c.msg_controllen) &&
                            (puVar9 = (uint *)local_67c.msg_control,
                             lVar12 = CONCAT44(param_3, param_4),
                             (uint *)local_67c.msg_control != (uint *)0x0)) {
                            while (true) {
                                if (puVar9[2] == 0x23) {
                                    uVar3 = puVar9[3];
                                    uVar7 = puVar9[4];
                                    if ((measured_tick < sys_tick) &&
                                        (1e-09 < sys_tick)) {
                                        dVar11 = ((double)(longlong)(int)uVar7 *
                                                  1e-09) /
                                                 sys_tick;
                                        uVar7 =
                                            (uint)(longlong)((double)((uint)(0.0 <
                                                                             dVar11) *
                                                                      (int)(longlong)
                                                                          dVar11) *
                                                             1000000000.0 *
                                                             sys_tick);
                                    }
                                    if ((int)uVar7 < 0) {
                                        do {
                                            uVar8 = uVar7 + 1000000000;
                                            uVar3 = uVar3 - 1;
                                            uVar7 = uVar8;
                                        } while ((int)uVar8 < 0);
                                    } else {
                                        uVar8 = uVar7;
                                        if (999999999 < (int)uVar7) {
                                            uVar8 = uVar7 + 0xc4653600;
                                            iVar5 = uVar7 + 0x88ca6c01;
                                            if ((int)uVar8 < 1000000000) {
                                                uVar3 = uVar3 + 1;
                                            } else {
                                                uVar7 = uVar7 + 0x88ca0000;
                                            }
                                            if (uVar8 != 999999999 &&
                                                iVar5 < 0 ==
                                                    SBORROW4(uVar8,
                                                             999999999)) {
                                                uVar3 = uVar3 + 2;
                                                uVar8 = uVar7 + 0x6c00;
                                            }
                                        }
                                    }
                                    uVar4 = FUN_0009bfd0(500000000, uVar8,
                                                         1000000000, 0);
                                    iVar5 = FUN_00078ae4();
                                    dVar11 = ((double)(longlong)iVar5 +
                                              (double)(longlong)iVar5) *
                                             2.3283064365386963e-10 * sys_fuzz;
                                    if (dVar11 < 0.0) {
                                        dVar11 = ldexp(-dVar11, 0x20);
                                        uVar13 = FUN_0009c010(
                                            SUB84(dVar11, 0),
                                            (int)((ulonglong)dVar11 >> 0x20));
                                        lVar12 = CONCAT44(
                                            -((int)((ulonglong)uVar13 >> 0x20) +
                                              (uint)((int)uVar13 != 0)),
                                            -(int)uVar13);
                                    } else {
                                        dVar11 = ldexp(dVar11, 0x20);
                                        lVar12 = FUN_0009c010(
                                            SUB84(dVar11, 0),
                                            (int)((ulonglong)dVar11 >> 0x20));
                                    }
                                    lVar12 =
                                        lVar12 +
                                        CONCAT44(uVar3 + 0x83aa7e80, uVar4);
                                }
                                if (*puVar9 < 0xc)
                                    break;
                                puVar9 = (uint *)((int)puVar9 +
                                                  (*puVar9 + 3 & 0xfffffffc));
                                if (((uint *)((int)local_67c.msg_control +
                                              local_67c.msg_controllen) <
                                     puVar9 + 3) ||
                                    ((uint *)((int)local_67c.msg_control +
                                              local_67c.msg_controllen) <
                                     (uint *)((int)puVar9 +
                                              (*puVar9 + 3 & 0xfffffffc))))
                                    break;
                            }
                        }
                        *(int *)(iVar1 + 0x48) =
                            (int)((ulonglong)lVar12 >> 0x20);
                        *(int *)(iVar1 + 0x4c) = (int)lVar12;
                        *(code **)(iVar1 + 0x50) = receive;
                        FUN_0007a044(iVar1);
                        *(int *)(param_2 + 0xa4) = *(int *)(param_2 + 0xa4) + 1;
                        packets_received = packets_received + 1;
                        goto LAB_00024d24;
                    }
                    packets_dropped = packets_dropped + 1;
                    FUN_00079fa8(iVar1);
                    goto LAB_00024d24;
                }
                uVar4 = FUN_0007c2e8(pvVar10);
                FUN_00074e00(3, "recvfrom(%s) fd=%d: %m", uVar4, param_1);
            }
        LAB_00025010:
            FUN_00079fa8(iVar1);
            goto LAB_00024d24;
        }
        FUN_00079fa8();
    }
    local_690 = 0x1c;
    sVar2 = recvfrom(param_1, local_644, 0x4b0, 0, &sStack_660, &local_690);
    if (*(int *)(param_2 + 0xb4) == 0) {
        packets_dropped = packets_dropped + 1;
    } else {
        packets_ignored = packets_ignored + 1;
    }
LAB_00024d24:
    if (local_44 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(sVar2);
    }
    return;
}

void FUN_00025184(short *param_1)

{
    short sVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    uint uVar5;
    int *piVar6;

    iVar2 = __stack_chk_guard;
    piVar4 = remoteaddr_list;
    if (remoteaddr_list != (int *)0x0) {
        sVar1 = *param_1;
        piVar6 = remoteaddr_list;
        do {
            if ((short)piVar6[1] == sVar1) {
                if (sVar1 == 2) {
                    if (piVar6[2] == *(int *)(param_1 + 2)) {
                        piVar4 = (int *)piVar6[8];
                        uVar5 = piVar4[0x24];
                        goto joined_r0x00025254;
                    }
                } else {
                    iVar3 = memcmp(piVar6 + 3, param_1 + 4, 0x10);
                    if ((iVar3 == 0) &&
                        (piVar6[7] == *(int *)(param_1 + 0xc))) {
                        piVar4 = (int *)piVar6[8];
                        uVar5 = piVar4[0x24];
                    joined_r0x00025254:
                        if ((uVar5 & 0x40) != 0)
                            break;
                    }
                }
            }
            piVar4 = (int *)*piVar6;
            piVar6 = piVar4;
        } while (piVar4 != (int *)0x0);
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar4);
}

void FUN_00025274(uint param_1, int param_2)

{
    uint uVar1;
    bool bVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    bool bVar6;

    iVar3 = __stack_chk_guard;
    if (0x3ff < param_1) {
        FUN_00074e00(3,
                     "Too many sockets in use, FD_SETSIZE %d exceeded by fd %d",
                     0x400, param_1);
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    uVar1 = 1 << (param_1 & 0x1f);
    if (param_2 == 0) {
        iVar4 = __fdelt_chk();
        if ((int)DAT_000c92c4 < (int)param_1) {
            DAT_000c92c4 = param_1;
        }
        (&DAT_000c9244)[iVar4] = (&DAT_000c9244)[iVar4] | uVar1;
    } else {
        iVar4 = __fdelt_chk();
        uVar5 = DAT_000c92c4;
        bVar6 = DAT_000c92c4 != 0;
        bVar2 = param_1 == DAT_000c92c4;
        (&DAT_000c9244)[iVar4] = (&DAT_000c9244)[iVar4] & ~uVar1;
        if (bVar6 && bVar2) {
            do {
                uVar5 = uVar5 - 1;
                iVar4 = __fdelt_chk(uVar5);
                uVar1 = uVar5;
                if (((&DAT_000c9244)[iVar4] & 1 << (uVar5 & 0x1f)) != 0)
                    break;
                uVar1 = DAT_000c92c4;
            } while (uVar5 != 0);
            DAT_000c92c4 = uVar1;
            if (DAT_000c92c4 == param_1) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_io.c", 0x17c, 2, "fd != maxactivefd");
            }
        }
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00025420(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    undefined4 *puVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined4 *)FUN_00073ba4(0, 0xc, 0);
    puVar2[1] = param_1;
    puVar2[2] = param_2;
    bVar3 = iVar1 == __stack_chk_guard;
    *puVar2 = fd_list;
    fd_list = puVar2;
    if (bVar3) {
        FUN_00025274(param_1, 0);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000254a8(sockaddr *param_1, int param_2, int param_3, int param_4)

{
    int iVar1;
    uint *puVar2;
    undefined4 uVar3;
    int iVar4;
    int iVar5;
    undefined4 uVar6;
    socklen_t __len;
    uint extraout_r2;
    char *pcVar7;
    uint uVar8;
    char *pcVar9;
    sa_family_t sVar10;
    bool bVar11;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;

    local_34 = 1;
    local_30 = 0;
    local_2c = __stack_chk_guard;
    if ((param_1->sa_family != 10) || (ipv6_works != 0)) {
        iVar1 = socket((uint)param_1->sa_family, 2, 0);
        if (iVar1 != -1) {
            iVar1 = FUN_0007c0b8();
            if (param_3 == 0) {
                iVar4 = setsockopt(iVar1, 1, 2, &local_34, 4);
                if (iVar4 != 0) {
                    pcVar9 = "on";
                    goto LAB_00025678;
                }
            } else {
                iVar4 = setsockopt(iVar1, 1, 2, &local_30, 4);
                if (iVar4 != 0) {
                    pcVar9 = "off";
                LAB_00025678:
                    uVar3 = FUN_0007c2e8(param_1);
                    FUN_00074e00(
                        3,
                        "setsockopt SO_REUSEADDR %s fails for address %s: %m",
                        pcVar9, uVar3);
                    iVar4 = -1;
                    close(iVar1);
                    goto LAB_00025570;
                }
            }
            sVar10 = param_1->sa_family;
            if (sVar10 == 2) {
                iVar4 = setsockopt(iVar1, 0, 1, &qos, 4);
                uVar3 = qos;
                if (iVar4 != 0) {
                    uVar6 = FUN_0007c2e8(param_1);
                    FUN_00074e00(
                        3, "setsockopt IP_TOS (%02x) fails on address %s: %m",
                        uVar3, uVar6);
                }
                if (param_2 != 0) {
                    FUN_0002400c(param_4, iVar1, param_1);
                }
                sVar10 = param_1->sa_family;
            }
            if (sVar10 == 10) {
                iVar4 = setsockopt(iVar1, 0x29, 0x43, &qos, 4);
                uVar3 = qos;
                if (iVar4 != 0) {
                    uVar6 = FUN_0007c2e8(param_1);
                    FUN_00074e00(
                        3,
                        "setsockopt IPV6_TCLASS (%02x) fails on address %s: %m",
                        uVar3, uVar6);
                }
                iVar4 = FUN_000840d8();
                if ((iVar4 == 0) &&
                    (iVar4 = setsockopt(iVar1, 0x29, 0x1a, &local_34, 4),
                     iVar4 != 0)) {
                    uVar3 = FUN_0007c2e8(param_1);
                    FUN_00074e00(
                        3, "setsockopt IPV6_V6ONLY on fails on address %s: %m",
                        uVar3);
                }
                sVar10 = param_1->sa_family;
            }
            iVar4 = FUN_00023d38(param_1);
            if (iVar4 == 0) {
                FUN_000240c0(sVar10, 1);
                sVar10 = param_1->sa_family;
            }
            if (sVar10 == 2) {
                __len = 0x10;
            } else {
                __len = 0x1c;
            }
            iVar4 = bind(iVar1, param_1, __len);
            iVar5 = FUN_00023d38(param_1);
            if (iVar5 == 0) {
                FUN_000240c0(param_1->sa_family);
            }
            if (iVar4 < 0) {
                if (param_3 == 0) {
                    if (param_1->sa_family == 10) {
                        pcVar9 = "6";
                    } else {
                        pcVar9 = "";
                    }
                    uVar3 = FUN_0007c2e8(param_1);
                    bVar11 = param_1->sa_family == 2;
                    uVar8 = extraout_r2;
                    if (bVar11) {
                        uVar8 = *(uint *)(param_1->sa_data + 2);
                    }
                    if (bVar11) {
                        iVar4 = (uVar8 & 0xf0) - 0xe0;
                    } else {
                        iVar4 = (byte)param_1->sa_data[6] - 0xff;
                    }
                    if (iVar4 == 0) {
                        pcVar7 = " (multicast)";
                    } else {
                        pcVar7 = "";
                    }
                    FUN_00074e00(
                        3, "bind(%d) AF_INET%s %s#%d%s flags 0x%x failed: %m",
                        iVar1, pcVar9, uVar3,
                        *(ushort *)param_1->sa_data << 8 |
                            *(ushort *)param_1->sa_data >> 8,
                        pcVar7, *(undefined4 *)(param_4 + 0x90));
                }
                iVar4 = -1;
                close(iVar1);
            } else {
                iVar4 = setsockopt(iVar1, 1, 0x23, &local_34, 4);
                if (iVar4 != 0) {
                    uVar3 = FUN_0007c2e8(param_1);
                    FUN_00074e00(
                        7,
                        "setsockopt SO_TIMESTAMPNS on fails on address %s: %m",
                        uVar3);
                }
                FUN_0007c26c(iVar1);
                FUN_00025420(iVar1, 0);
                iVar4 = iVar1;
            }
            goto LAB_00025570;
        }
        puVar2 = (uint *)__errno_location();
        uVar8 = *puVar2;
        if (param_1->sa_family == 10) {
            pcVar9 = "6";
        } else {
            pcVar9 = "";
        }
        uVar3 = FUN_0007c2e8(param_1);
        FUN_00074e00(
            3, "socket(AF_INET%s, SOCK_DGRAM, 0) failed on address %s: %m",
            pcVar9, uVar3);
        bVar11 = 0x5c < uVar8;
        if (uVar8 != 0x5d) {
            bVar11 = uVar8 != 0x60;
        }
        if (bVar11 && (uVar8 != 0x5d && uVar8 != 0x61)) {
            *puVar2 = uVar8;
            FUN_00074e00(
                3,
                "unexpected socket() error %m code %d (not EPROTONOSUPPORT nor "
                "EAFNOSUPPORT nor EPFNOSUPPORT) - exiting",
                uVar8);
            /* WARNING: Subroutine does not return */
            exit(1);
        }
    }
    iVar4 = -1;
LAB_00025570:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar4);
    }
    return;
}

void FUN_00025954(int param_1)

{
    int iVar1;
    uint uVar2;
    undefined4 *puVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;

    iVar1 = __stack_chk_guard;
    puVar3 = &fd_list;
    puVar4 = (undefined4 *)*fd_list;
    puVar5 = fd_list;
    if (fd_list[1] != param_1) {
        while (true) {
            puVar3 = puVar5;
            puVar5 = puVar4;
            if (puVar5 == (undefined4 *)0x0) {
                return;
            }
            if (puVar5[1] == param_1)
                break;
            puVar4 = (undefined4 *)*puVar5;
        }
        puVar5 = (undefined4 *)*puVar3;
        puVar4 = (undefined4 *)*puVar5;
    }
    uVar2 = puVar5[2];
    *puVar3 = puVar4;
    if (1 < uVar2) {
        FUN_00074e00(3, "internal error - illegal descriptor type %d - EXITING",
                     uVar2);
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    close(puVar5[1]);
    free(puVar5);
    if (iVar1 == __stack_chk_guard) {
        FUN_00025274(param_1, 1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00025a58(undefined4 *param_1)

{
    undefined4 *puVar1;
    int iVar2;
    int iVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;

    iVar2 = __stack_chk_guard;
    puVar5 = &asyncio_reader_list;
    puVar4 = asyncio_reader_list;
    if (param_1 == asyncio_reader_list) {
    LAB_00025acc:
        *puVar5 = *puVar4;
    } else if (asyncio_reader_list != (undefined4 *)0x0) {
        puVar4 = (undefined4 *)*asyncio_reader_list;
        puVar5 = asyncio_reader_list;
        while (puVar1 = puVar4, puVar1 != (undefined4 *)0x0) {
            if (param_1 == puVar1) {
                puVar4 = (undefined4 *)*puVar5;
                goto LAB_00025acc;
            }
            puVar5 = puVar1;
            puVar4 = (undefined4 *)*puVar1;
        }
    }
    if (param_1[1] != -1) {
        FUN_00025954();
    }
    iVar3 = __stack_chk_guard;
    param_1[1] = 0xffffffff;
    if (iVar2 == iVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00025b14(void *param_1)

{
    uint uVar1;
    int *piVar2;
    uint uVar3;
    uint *__buf;
    uint local_141c[1280];
    int local_1c;

    local_1c = __stack_chk_guard;
    if (disable_dynamic_updates == 0) {
        __buf = local_141c;
        uVar1 = read(*(int *)((int)param_1 + 4), __buf, 0x1400);
        if ((int)uVar1 < 0) {
            piVar2 = __errno_location();
            if (*piVar2 != 0x69) {
                FUN_00074e00(3, "routing socket reports: %m - disabling");
                goto LAB_00025c28;
            }
            FUN_00074e00(3, "routing socket reports: %m");
        } else if (((0xf < (int)uVar1) && (0xf < local_141c[0])) &&
                   (local_141c[0] <= uVar1)) {
            do {
                switch ((short)__buf[1]) {
                case 3:
                    goto LAB_00025c68;
                case 4:
                    break;
                case 5:
                    break;
                case 6:
                    break;
                case 7:
                    break;
                case 8:
                    break;
                case 9:
                    break;
                case 10:
                    break;
                case 0xb:
                    break;
                case 0xc:
                    break;
                case 0xd:
                    break;
                case 0xe:
                    break;
                case 0xf:
                    break;
                case 0x10:
                    goto LAB_00025c8c;
                case 0x11:
                    goto LAB_00025c8c;
                case 0x12:
                    break;
                case 0x13:
                    break;
                case 0x14:
                    goto LAB_00025c8c;
                case 0x15:
                    goto LAB_00025c8c;
                case 0x16:
                    break;
                case 0x17:
                    break;
                case 0x18:
                    goto LAB_00025c8c;
                case 0x19:
                LAB_00025c8c:
                    FUN_00050e80(current_time + 2);
                }
                uVar3 = *__buf + 3 & 0xfffffffc;
                uVar1 = uVar1 - uVar3;
                __buf = (uint *)((int)__buf + uVar3);
                if ((((int)uVar1 < 0x10) || (*__buf < 0x10)) ||
                    (uVar1 < *__buf))
                    break;
            } while (true);
        }
    LAB_00025c68:
        if (local_1c == __stack_chk_guard) {
            return;
        }
    } else {
    LAB_00025c28:
        FUN_00025a58(param_1);
        if (local_1c == __stack_chk_guard) {
            free(param_1);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00025cf0(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00079ea8(10);
    interface_interval = 300;
    addremove_io_fd = &DAT_000253d4;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00025e04(int param_1, int param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 *puVar2;
    int iVar3;
    undefined4 uVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined4 *)FUN_00073ba4(0, 0x30, 0, 1);
    puVar2[0xb] = param_3;
    puVar2[2] = param_1;
    puVar2[1] = param_4;
    if (param_1 == 4) {
        if (param_2 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_io.c", 0x4b7, 0, "((void *)0) != if_name");
        }
        uVar4 = FUN_00073d08(param_2);
        puVar2[3] = uVar4;
    } else if (param_1 == 5) {
        if (param_2 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_io.c", 0x4ba, 0, "((void *)0) != if_name");
        }
        iVar3 = FUN_00074054(param_2, 0, puVar2 + 4);
        if (iVar3 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_io.c", 0x4bd, 0, "is_ip");
        }
    } else if (param_2 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_io.c", 0x4bf, 0, "((void *)0) == if_name");
    }
    bVar5 = iVar1 == __stack_chk_guard;
    *puVar2 = nic_rule_list;
    nic_rule_list = puVar2;
    if (bVar5) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00026064) */

void FUN_00026020(int param_1, undefined4 param_2)

{
    FUN_0002400c(param_1, *(undefined4 *)(param_1 + 0xc), param_2);
    return;
}

void FUN_000260c4(int param_1, short *param_2)

{
    short sVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    undefined4 local_24;
    undefined4 local_20;
    int local_1c;

    sVar1 = *(short *)(param_1 + 0x18);
    local_24 = 0;
    local_1c = __stack_chk_guard;
    local_20 = 0;
    if (sVar1 != *param_2) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0(
            "ntp_io.c", 0x95e, 0,
            "((maddr)->sa.sa_family) == ((&iface->sin)->sa.sa_family)");
    }
    if (sVar1 == 2) {
        iVar2 = setsockopt(*(int *)(param_1 + 0xc), 0, 0x22, &local_24, 4);
        if (iVar2 != 0) {
            uVar5 = *(undefined4 *)(param_1 + 0xc);
            uVar3 = FUN_0007c2e8(param_1 + 0x18);
            uVar4 = FUN_0007c2e8(param_2);
            FUN_00074e00(3,
                         "setsockopt IP_MULTICAST_LOOP failed: %m on socket "
                         "%d, addr %s for multicast address %s",
                         uVar5, uVar3, uVar4);
        }
    } else if (sVar1 == 10) {
        iVar2 = setsockopt(*(int *)(param_1 + 0xc), 0x29, 0x13, &local_20, 4);
        if (iVar2 != 0) {
            uVar5 = *(undefined4 *)(param_1 + 0xc);
            uVar3 = FUN_0007c2e8(param_1 + 0x18);
            uVar4 = FUN_0007c2e8(param_2);
            FUN_00074e00(3,
                         "setsockopt IPV6_MULTICAST_LOOP failed: %m on socket "
                         "%d, addr %s for multicast address %s",
                         uVar5, uVar3, uVar4);
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002621c(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    undefined4 uVar4;
    uint uVar5;
    int *piVar6;
    int iVar7;
    int *piVar8;

    iVar1 = __stack_chk_guard;
    FUN_000241a4(1);
    if (ep_list == (int *)0x0) {
        FUN_000241a4(0);
    } else {
        iVar7 = 0;
        piVar6 = ep_list;
        do {
            while (((uVar5 = piVar6[0x24],
                     (uVar5 & 0x84) != 0 || (piVar6[0x2d] != 0)) ||
                    ((uVar5 & 8) == 0))) {
            LAB_000262a4:
                piVar6 = (int *)*piVar6;
                if (piVar6 == (int *)0x0)
                    goto LAB_00026350;
            }
            if ((short)piVar6[0x14] != 2) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_io.c", 0xa46, 0,
                             "(2 == ((&interf->bcast)->sa.sa_family))");
            }
            if ((uVar5 & 0x20) != 0) {
                iVar7 = iVar7 + 1;
                goto LAB_000262a4;
            }
            piVar8 = piVar6 + 0x14;
            *(undefined2 *)(piVar6 + 0x23) = 2;
            iVar2 = FUN_000254a8(piVar8, 1, 0, piVar6);
            piVar6[4] = iVar2;
            if (iVar2 != -1) {
                iVar7 = iVar7 + 1;
                piVar6[0x24] = piVar6[0x24] | 0x20;
                uVar4 = FUN_0007c2e8(piVar8);
                FUN_00074e00(6,
                             "Listen for broadcasts to %s on interface #%d %s",
                             uVar4, piVar6[5], piVar6 + 0x1b);
                goto LAB_000262a4;
            }
            piVar3 = __errno_location();
            if (*piVar3 - 0x62U < 2)
                goto LAB_000262a4;
            uVar4 = FUN_0007c2e8(piVar8);
            FUN_00074e00(
                6, "failed to listen for broadcasts to %s on interface #%d %s",
                uVar4, piVar6[5], piVar6 + 0x1b);
            piVar6 = (int *)*piVar6;
        } while (piVar6 != (int *)0x0);
    LAB_00026350:
        FUN_000241a4(piVar6);
        if (iVar7 != 0) {
            broadcast_client_enabled = 1;
            if (iVar1 == __stack_chk_guard) {
                return;
            }
            goto LAB_000263e4;
        }
    }
    broadcast_client_enabled = 0;
    if (iVar1 == __stack_chk_guard) {
        FUN_00074e00(3, "Unable to listen for broadcasts, no broadcast "
                        "interfaces available");
        return;
    }
LAB_000263e4:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000264f4(short *param_1)

{
    short sVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    void *__ptr;
    char *pcVar5;
    int iVar6;
    undefined4 uVar7;

    iVar2 = __stack_chk_guard;
    if (*param_1 == 2) {
        iVar6 = (*(uint *)(param_1 + 2) & 0xf0) - 0xe0;
    } else {
        iVar6 = *(byte *)(param_1 + 4) - 0xff;
    }
    if (iVar6 != 0) {
        return;
    }
    iVar6 = FUN_00025184();
    if (iVar6 == 0) {
        __ptr = (void *)FUN_00023f3c();
        uVar3 = *(undefined4 *)(param_1 + 2);
        uVar4 = *(undefined4 *)(param_1 + 4);
        uVar7 = *(undefined4 *)(param_1 + 6);
        *(undefined4 *)((int)__ptr + 0x18) = *(undefined4 *)param_1;
        *(undefined4 *)((int)__ptr + 0x1c) = uVar3;
        *(undefined4 *)((int)__ptr + 0x20) = uVar4;
        *(undefined4 *)((int)__ptr + 0x24) = uVar7;
        sVar1 = *(short *)((int)__ptr + 0x18);
        uVar3 = *(undefined4 *)(param_1 + 10);
        uVar4 = *(undefined4 *)(param_1 + 0xc);
        *(undefined4 *)((int)__ptr + 0x28) = *(undefined4 *)(param_1 + 8);
        *(undefined4 *)((int)__ptr + 0x2c) = uVar3;
        *(undefined4 *)((int)__ptr + 0x30) = uVar4;
        if (sVar1 == 10) {
            uVar4 = 0xffffffff;
        }
        *(short *)((int)__ptr + 0x8c) = sVar1;
        *(short *)((int)__ptr + 0x34) = sVar1;
        if (sVar1 == 10) {
            *(undefined4 *)((int)__ptr + 0x3c) = uVar4;
            *(undefined4 *)((int)__ptr + 0x40) = uVar4;
            *(undefined4 *)((int)__ptr + 0x44) = uVar4;
            *(undefined4 *)((int)__ptr + 0x48) = uVar4;
        } else {
            *(undefined4 *)((int)__ptr + 0x38) = 0xffffffff;
        }
        *(undefined2 *)((int)__ptr + 0x1a) = 0x7b00;
        FUN_000241a4(1);
        *(undefined4 *)((int)__ptr + 0x10) = 0xffffffff;
        iVar6 = FUN_000254a8((undefined4 *)((int)__ptr + 0x18), 0, 0, __ptr);
        *(int *)((int)__ptr + 0xc) = iVar6;
        if (iVar6 == -1) {
            free(__ptr);
            __ptr = DAT_000c92c8;
            if (((*param_1 != 2) && (__ptr = DAT_000c92cc, *param_1 != 10)) ||
                (__ptr == (void *)0x0)) {
                uVar3 = FUN_0007c2e8(param_1);
                if (iVar2 == __stack_chk_guard) {
                    uVar4 = 3;
                    pcVar5 =
                        "No multicast socket available to use for address %s";
                    goto LAB_00026590;
                }
                goto LAB_00026784;
            }
            uVar3 = *(undefined4 *)(param_1 + 2);
            uVar4 = *(undefined4 *)(param_1 + 4);
            uVar7 = *(undefined4 *)(param_1 + 6);
            *(undefined4 *)((int)__ptr + 0x50) = *(undefined4 *)param_1;
            *(undefined4 *)((int)__ptr + 0x54) = uVar3;
            *(undefined4 *)((int)__ptr + 0x58) = uVar4;
            *(undefined4 *)((int)__ptr + 0x5c) = uVar7;
            uVar3 = *(undefined4 *)(param_1 + 10);
            uVar4 = *(undefined4 *)(param_1 + 0xc);
            *(undefined4 *)((int)__ptr + 0x60) = *(undefined4 *)(param_1 + 8);
            *(undefined4 *)((int)__ptr + 100) = uVar3;
            *(undefined4 *)((int)__ptr + 0x68) = uVar4;
            uVar3 = FUN_0007c2e8(param_1);
            FUN_00074e00(
                3, "multicast address %s using wildcard interface #%d %s",
                uVar3, *(undefined4 *)((int)__ptr + 0x14), (int)__ptr + 0x6c);
        } else {
            uVar3 = 0;
            *(undefined4 *)((int)__ptr + 0xb4) = 0;
            *(uint *)((int)__ptr + 0x90) = *(uint *)((int)__ptr + 0x90) | 0x100;
            if (*param_1 != 2) {
                uVar3 = *(undefined4 *)(param_1 + 0xc);
            }
            *(undefined4 *)((int)__ptr + 0xb0) = uVar3;
            FUN_0007d4dc((int)__ptr + 0x6c, "multicast", 0x20);
            FUN_00024298(__ptr);
            FUN_0002482c(__ptr);
        }
        iVar6 = FUN_000248d0(__ptr, param_1);
        if (iVar6 != 0) {
            uVar3 = FUN_0007c2e8((int)__ptr + 0x18);
            uVar4 = FUN_0007c2e8(param_1);
            FUN_00074e00(6, "Joined %s socket to multicast group %s", uVar3,
                         uVar4);
        }
        if (iVar2 == __stack_chk_guard) {
            FUN_00023ea4(param_1, __ptr);
            return;
        }
    } else {
        uVar3 = FUN_0007c2e8(param_1);
        if (iVar2 == __stack_chk_guard) {
            uVar4 = 6;
            pcVar5 = "Duplicate request found for multicast address %s";
        LAB_00026590:
            FUN_00074e00(uVar4, pcVar5, uVar3);
            return;
        }
    }
LAB_00026784:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00026c14 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_00026a68(sockaddr *param_1, int param_2, int param_3, void *param_4,
                  size_t param_5)

{
    bool bVar1;
    int iVar2;
    ssize_t sVar3;
    undefined4 uVar4;
    socklen_t __addr_len;
    bool bVar5;
    int local_3c;
    undefined1 local_35;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;

    bVar5 = false;
    local_34 = 0;
    local_30 = 0;
    local_2c = __stack_chk_guard;
    if (param_1->sa_family == 2) {
        bVar5 = (*(uint *)(param_1->sa_data + 2) & 0xf0) == 0xe0;
        if (bVar5) {
            param_2 = mc4_list;
        }
    } else if (param_1->sa_data[6] == -1) {
        bVar5 = true;
        param_2 = mc6_list;
    }
    local_3c = param_3;
    if (param_2 != 0) {
        do {
            iVar2 = *(int *)(param_2 + 0xc);
            bVar1 = bVar5;
            if (local_3c < 1) {
                bVar1 = false;
            }
            if ((bVar1) && (local_3c != *(int *)(param_2 + 0x94))) {
                if (*(short *)(param_2 + 0x18) == 2) {
                    local_35 = (undefined1)local_3c;
                    iVar2 = setsockopt(iVar2, 0, 0x21, &local_35, 1);
                    if (iVar2 == 0)
                        goto LAB_00026b34;
                LAB_00026c90:
                    uVar4 = FUN_0007c2e8(param_2 + 0x18);
                    FUN_00074e00(
                        3,
                        "setsockopt IP_MULTICAST_TTL/IPV6_MULTICAST_HOPS fails "
                        "on address %s: %m",
                        uVar4);
                    iVar2 = *(int *)(param_2 + 0xc);
                } else {
                    if (*(short *)(param_2 + 0x18) == 10) {
                        iVar2 = setsockopt(iVar2, 0x29, 0x12, &local_3c, 4);
                        if (iVar2 != 0)
                            goto LAB_00026c90;
                    LAB_00026b34:
                        iVar2 = *(int *)(param_2 + 0xc);
                    }
                    *(int *)(param_2 + 0x94) = local_3c;
                }
            }
            if (param_1->sa_family == 2) {
                __addr_len = 0x10;
            } else {
                __addr_len = 0x1c;
            }
            sVar3 = sendto(iVar2, param_4, param_5, 0, param_1, __addr_len);
            if (sVar3 == -1) {
                *(int *)(param_2 + 0xac) = *(int *)(param_2 + 0xac) + 1;
                packets_notsent = packets_notsent + 1;
            } else {
                *(int *)(param_2 + 0xa8) = *(int *)(param_2 + 0xa8) + 1;
                packets_sent = packets_sent + 1;
            }
            if (!bVar5) {
                param_2 = param_2 + 0x18;
                goto LAB_00026b9c;
            }
            param_2 = *(int *)(param_2 + 4);
        } while (param_2 != 0);
        param_2 = 0;
    LAB_00026b9c:
        FUN_000520f0(
            SUB84((double)*(uint *)((int)param_4 + 4), 0),
            (int)((ulonglong)(double)*(uint *)((int)param_4 + 4) >> 0x20),
            SUB84((double)*(uint *)((int)param_4 + 8), 0), param_2, param_1,
            (int)param_4 + 0x18, (int)param_4 + 0x20);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00026d04(void)

{
    uint uVar1;
    int iVar2;
    ssize_t sVar3;
    int *piVar4;
    undefined4 uVar5;
    int iVar6;
    int iVar7;
    int *piVar8;
    int iVar9;
    undefined1 uVar10;
    uint uVar11;
    uint uVar12;
    undefined1 *puVar13;
    undefined2 *puVar14;
    uint uVar15;
    size_t sVar16;
    __time_t local_57c;
    __suseconds_t _Stack_578;
    __time_t local_574;
    __suseconds_t _Stack_570;
    __time_t local_56c;
    __suseconds_t _Stack_568;
    timeval local_564;
    fd_set fStack_55c;
    undefined1 auStack_4dc[1200];
    int local_2c;

    local_2c = __stack_chk_guard;
    handler_calls = handler_calls + 1;
    memcpy(&fStack_55c, &DAT_000c9244, 0x80);
    iVar2 = select(DAT_000c92c4 + 1, &fStack_55c, (fd_set *)0x0, (fd_set *)0x0,
                   (timeval *)0x0);
    if (iVar2 < 0) {
        piVar4 = __errno_location();
        iVar9 = *piVar4;
        if (iVar9 != 4) {
            iVar6 = DAT_000c92c4 + 1;
            uVar11 = DAT_000c92c4;
            if (0xfe < (int)DAT_000c92c4) {
                uVar11 = 0xff;
            }
            if ((int)DAT_000c92c4 < 0) {
                puVar13 = &DAT_000c92d0;
            } else {
                uVar15 = uVar11;
                puVar13 = &DAT_000c92d0;
                do {
                    iVar7 = __fdelt_chk(uVar15);
                    uVar12 = uVar15 & 0x1f;
                    uVar15 = uVar15 - 1;
                    if (((&DAT_000c9244)[iVar7] & 1 << uVar12) == 0) {
                        uVar10 = 0x2d;
                    } else {
                        uVar10 = 0x23;
                    }
                    *puVar13 = uVar10;
                    puVar13 = puVar13 + 1;
                } while (uVar15 != 0xffffffff);
                puVar14 = &DAT_000c9240;
                if (-1 < (int)uVar11) {
                    puVar14 = (undefined2 *)((int)&DAT_000c9240 + uVar11);
                }
                puVar13 = (undefined1 *)((int)puVar14 + 0x91);
            }
            uVar11 = 0;
            *puVar13 = 0;
            FUN_00074e00(3, "select(%d, %s, 0L, 0L, &0.0) error: %m", iVar6,
                         &DAT_000c92d0);
            if (iVar9 == 9) {
                if ((int)DAT_000c92c4 < 0) {
                    iVar2 = 1;
                LAB_00027470:
                    DAT_000c92c4 = uVar11;
                } else {
                    uVar12 = 0;
                    uVar15 = uVar11;
                    do {
                        iVar2 = __fdelt_chk(uVar12);
                        uVar1 = 1 << (uVar12 & 0x1f);
                        uVar11 = uVar15;
                        if (((uVar1 & (&DAT_000c9244)[iVar2]) != 0) &&
                            (sVar3 = read(uVar12, &local_564, 0),
                             uVar11 = uVar12, sVar3 == -1)) {
                            FUN_00074e00(3,
                                         "Removing bad file descriptor %d from "
                                         "select set",
                                         uVar12);
                            iVar2 = __fdelt_chk(uVar12);
                            (&DAT_000c9244)[iVar2] =
                                (&DAT_000c9244)[iVar2] & ~uVar1;
                            uVar11 = uVar15;
                        }
                        uVar12 = uVar12 + 1;
                        uVar15 = uVar11;
                    } while ((int)uVar12 <= (int)DAT_000c92c4);
                    iVar2 = uVar11 + 1;
                    if (DAT_000c92c4 != uVar11)
                        goto LAB_00027470;
                }
                local_564.tv_sec = 0;
                local_564.tv_usec = 0;
                memcpy(&fStack_55c, &DAT_000c9244, 0x80);
                iVar2 = select(iVar2, &fStack_55c, (fd_set *)0x0, (fd_set *)0x0,
                               &local_564);
                goto LAB_00026d84;
            }
        }
    } else {
    LAB_00026d84:
        if (0 < iVar2) {
            FUN_0006f724(&local_57c);
            local_574 = local_57c;
            _Stack_570 = _Stack_578;
            handler_pkts = handler_pkts + 1;
            if (DAT_000c93d0 != (int *)0x0) {
                piVar4 = DAT_000c93d0;
            LAB_00026e08:
                uVar15 = piVar4[5];
                iVar2 = __fdelt_chk(uVar15);
                uVar11 = uVar15 & 0x1f;
                if ((int)uVar15 < 1) {
                    uVar11 = -(-uVar15 & 0x1f);
                }
                if ((fStack_55c.fds_bits[iVar2] & 1 << (uVar11 & 0xff)) == 0)
                    goto LAB_00027064;
                local_56c = local_574;
                _Stack_568 = _Stack_570;
                iVar2 = FUN_0007a108();
                if (iVar2 == 0) {
                    sVar3 = read(uVar15, auStack_4dc, 0x4b0);
                    packets_dropped = packets_dropped + 1;
                } else {
                    sVar16 = piVar4[4];
                    if (0x847 < sVar16 - 1) {
                        sVar16 = 0x848;
                    }
                    do {
                        sVar3 = read(uVar15, (void *)(iVar2 + 0x58), sVar16);
                        if (-1 < sVar3) {
                            if (sVar3 != 0) {
                                iVar9 = piVar4[3];
                                *(ssize_t *)(iVar2 + 0x54) = sVar3;
                                *(int *)(iVar2 + 4) = iVar9;
                                iVar9 = piVar4[1];
                                *(uint *)(iVar2 + 0x40) = uVar15;
                                *(undefined4 *)(iVar2 + 0x3c) = 0;
                                *(__time_t *)(iVar2 + 0x48) = local_56c;
                                *(__suseconds_t *)(iVar2 + 0x4c) = _Stack_568;
                                *(int *)(iVar2 + 0x50) = iVar9;
                                iVar2 = FUN_0004a02c(piVar4, iVar2);
                                if (iVar2 == 0) {
                                    piVar4[6] = piVar4[6] + 1;
                                    packets_received = packets_received + 1;
                                }
                                goto LAB_00026f14;
                            }
                            piVar8 = __errno_location();
                            iVar9 = *piVar8;
                            break;
                        }
                        piVar8 = __errno_location();
                        iVar9 = *piVar8;
                    } while (iVar9 == 4);
                    FUN_00079fa8(iVar2);
                    *piVar8 = iVar9;
                }
                if (sVar3 < 0) {
                    piVar8 = __errno_location();
                    iVar2 = *piVar8;
                    if (iVar2 == 0xb)
                        goto LAB_00026f14;
                    uVar5 = FUN_0007a3fc(piVar4[3] + 0x10);
                    *piVar8 = iVar2;
                    FUN_00074e00(3, "%s read: %m", uVar5);
                    FUN_00025274(uVar15, 1);
                    goto LAB_00027064;
                }
                if (sVar3 != 0)
                    goto LAB_00026f14;
                uVar5 = FUN_0007a3fc(piVar4[3] + 0x10);
                FUN_00074e00(3, "%s read EOF", uVar5);
                FUN_00025274(uVar15, 1);
                piVar4 = (int *)*piVar4;
                goto joined_r0x0002706c;
            }
        LAB_00027074:
            piVar4 = ep_list;
            piVar8 = (int *)asyncio_reader_list;
            if (ep_list != (int *)0x0) {
            LAB_0002709c:
                iVar2 = 0;
                do {
                    if (iVar2 == 0) {
                        uVar11 = piVar4[3];
                        iVar9 = 1;
                        if (-1 < (int)uVar11)
                            goto LAB_000270c4;
                    } else {
                        if ((piVar4[0x24] & 0x20U) == 0)
                            goto LAB_00027090;
                        uVar11 = piVar4[4];
                        iVar9 = iVar2 + 1;
                        if (-1 < (int)uVar11) {
                        LAB_000270c4:
                            iVar6 = __fdelt_chk(uVar11);
                            if ((fStack_55c.fds_bits[iVar6] &
                                 1 << (uVar11 & 0x1f)) != 0) {
                                do {
                                    iVar6 = FUN_00024c78(uVar11, piVar4,
                                                         local_574, _Stack_570);
                                } while (0 < iVar6);
                            }
                        }
                        if (iVar9 == 2)
                            goto LAB_00027090;
                    }
                    iVar2 = iVar2 + 1;
                } while (true);
            }
        joined_r0x00027180:
            while (piVar4 = piVar8, piVar4 != (int *)0x0) {
                piVar8 = (int *)*piVar4;
                iVar2 = __fdelt_chk(piVar4[1]);
                uVar15 = piVar4[1];
                uVar11 = uVar15 & 0x1f;
                if ((int)uVar15 < 1) {
                    uVar11 = -(-uVar15 & 0x1f);
                }
                if ((fStack_55c.fds_bits[iVar2] & 1 << (uVar11 & 0xff)) != 0) {
                    (*(code *)piVar4[3])(piVar4);
                }
            }
            if (blocking_children_alloc != 0) {
                uVar11 = 0;
                do {
                    iVar2 = *(int *)(blocking_children + uVar11 * 4);
                    if ((iVar2 != 0) && (*(int *)(iVar2 + 0x34) != -1)) {
                        iVar9 = __fdelt_chk();
                        uVar12 = *(uint *)(iVar2 + 0x34);
                        uVar15 = uVar12 & 0x1f;
                        if ((int)uVar12 < 1) {
                            uVar15 = -(-uVar12 & 0x1f);
                        }
                        if ((fStack_55c.fds_bits[iVar9] &
                             1 << (uVar15 & 0xff)) != 0) {
                            *(int *)(iVar2 + 0x44) = *(int *)(iVar2 + 0x44) + 1;
                            blocking_child_ready_seen =
                                blocking_child_ready_seen + 1;
                        }
                    }
                    uVar11 = uVar11 + 1;
                } while (uVar11 < blocking_children_alloc);
            }
            goto LAB_00026d94;
        }
    }
    if ((iVar2 == -1) && (piVar4 = __errno_location(), *piVar4 != 4)) {
        FUN_00074e00(3, "select() error: %m");
    }
LAB_00026d94:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
LAB_00026f14:
    do {
        local_564.tv_sec = local_574;
        local_564.tv_usec = _Stack_570;
        iVar2 = FUN_0007a108();
        if (iVar2 != 0) {
            sVar16 = piVar4[4];
            if (0x847 < sVar16 - 1) {
                sVar16 = 0x848;
            }
            while (true) {
                sVar3 = read(uVar15, (void *)(iVar2 + 0x58), sVar16);
                if (-1 < sVar3)
                    break;
                piVar8 = __errno_location();
                iVar9 = *piVar8;
                if (iVar9 != 4)
                    goto LAB_00027118;
            }
            if (sVar3 == 0) {
                piVar8 = __errno_location();
                iVar9 = *piVar8;
            LAB_00027118:
                FUN_00079fa8(iVar2);
                piVar4 = (int *)*piVar4;
                *piVar8 = iVar9;
                if (piVar4 != (int *)0x0)
                    goto LAB_00026e08;
                goto LAB_00027074;
            }
            iVar9 = piVar4[3];
            *(ssize_t *)(iVar2 + 0x54) = sVar3;
            *(int *)(iVar2 + 4) = iVar9;
            iVar9 = piVar4[1];
            *(uint *)(iVar2 + 0x40) = uVar15;
            *(undefined4 *)(iVar2 + 0x3c) = 0;
            *(__time_t *)(iVar2 + 0x48) = local_564.tv_sec;
            *(__suseconds_t *)(iVar2 + 0x4c) = local_564.tv_usec;
            *(int *)(iVar2 + 0x50) = iVar9;
            iVar2 = FUN_0004a02c(piVar4, iVar2);
            if (iVar2 == 0) {
                piVar4[6] = piVar4[6] + 1;
                packets_received = packets_received + 1;
            }
            goto LAB_00026f14;
        }
        sVar3 = read(uVar15, auStack_4dc, 0x4b0);
        packets_dropped = packets_dropped + 1;
    } while (0 < sVar3);
LAB_00027064:
    piVar4 = (int *)*piVar4;
joined_r0x0002706c:
    if (piVar4 == (int *)0x0)
        goto LAB_00027074;
    goto LAB_00026e08;
LAB_00027090:
    piVar4 = (int *)*piVar4;
    piVar8 = (int *)asyncio_reader_list;
    if (piVar4 == (int *)0x0)
        goto joined_r0x00027180;
    goto LAB_0002709c;
}

void FUN_0002753c(undefined4 param_1, uint param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00023dc8();
    if ((iVar2 != 0) && ((param_2 & *(uint *)(iVar2 + 0x90)) != 0)) {
        iVar2 = 0;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

/* WARNING: Type propagation algorithm not settling */

void FUN_0002759c(sockaddr *param_1, undefined4 param_2, int param_3)

{
    ushort uVar1;
    int iVar2;
    int iVar3;
    char *pcVar4;
    byte *pbVar5;
    socklen_t __len;
    uint uVar6;
    byte bVar7;
    char cVar8;
    byte *pbVar9;
    uint uVar10;
    byte bVar11;
    ushort *unaff_r11;
    char *pcVar12;
    char *pcVar13;
    char *pcVar14;
    bool bVar15;
    socklen_t local_88[2];
    sockaddr local_80;
    ushort local_64;
    ushort uStack_62;
    ushort uStack_60;
    undefined1 auStack_5e[2];
    ushort uStack_5c;
    ushort local_5a;
    ushort uStack_58;
    ushort local_56;
    ushort uStack_54;
    ushort local_52;
    undefined2 uStack_50;
    undefined2 local_4e;
    undefined2 uStack_4c;
    undefined2 local_4a;
    uint local_48;
    undefined4 local_44;
    undefined4 local_40;
    undefined4 local_3c;
    char *local_38;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((param_1->sa_family == 0) ||
        (iVar2 = socket((uint)param_1->sa_family, 2, 0), iVar2 == -1)) {
    LAB_000277e8:
        pcVar14 = (char *)0x0;
    } else {
        if (param_3 == 0) {
        LAB_000275f4:
            if (param_1->sa_family == 2) {
                __len = 0x10;
            } else {
                __len = 0x1c;
            }
            iVar3 = connect(iVar2, param_1, __len);
            if (iVar3 != -1) {
                local_88[0] = 0x1c;
                iVar3 = getsockname(iVar2, &local_80, local_88);
                close(iVar2);
                if (iVar3 != -1) {
                    pcVar4 = (char *)FUN_0002753c(&local_80, param_2);
                    if ((pcVar4 != (char *)0x0) &&
                        (pcVar14 = pcVar4, *(int *)(pcVar4 + 0xb4) == 0))
                        goto LAB_000277cc;
                    local_44 = 0;
                    local_48 = 0;
                    local_40 = 0;
                    local_3c = 0;
                    local_38 = (char *)0x0;
                    local_34 = 0;
                    local_30 = 0;
                    if (ep_list != (char *)0x0) {
                        pcVar12 = ep_list;
                        pcVar13 = (char *)0x0;
                    LAB_000276ac:
                        do {
                            pcVar14 = pcVar12;
                            if (((*(int *)(pcVar14 + 0xb4) == 0) &&
                                 ((byte *)(uint) * (ushort *)(pcVar14 + 0x8c) ==
                                  (byte *)(uint)local_80.sa_family)) &&
                                ((*(uint *)(pcVar14 + 0x90) & 0x84) == 0)) {
                                uVar1 = *(ushort *)(pcVar14 + 0x18);
                                pbVar5 = (byte *)(uint)uVar1;
                                if (pbVar5 != (byte *)(uint) *
                                                  (ushort *)(pcVar14 + 0x8c)) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007ecc0("ntp_io.c", 0x103e, 0,
                                                 "((a1)->sa.sa_family) == "
                                                 "((a2)->sa.sa_family)");
                                }
                                bVar15 = pbVar5 != (byte *)0x2;
                                local_64 = uVar1;
                                uStack_62 = 0;
                                uStack_60 = 0;
                                uStack_5c = uStack_60;
                                if (bVar15) {
                                    pcVar4 = local_80.sa_data + 5;
                                    pbVar5 = (byte *)(pcVar14 + 0x1f);
                                    unaff_r11 = (ushort *)(auStack_5e + 1);
                                }
                                uStack_50 = 0;
                                local_4a = 0;
                                iVar2 = 0;
                                local_5a = uStack_62;
                                uStack_58 = uStack_60;
                                local_56 = uStack_62;
                                uStack_54 = uStack_60;
                                local_52 = uStack_62;
                                local_4e = uStack_62;
                                uStack_4c = uStack_50;
                                if (bVar15) {
                                LAB_00027714:
                                    pcVar4 = pcVar4 + 1;
                                    bVar11 = *pcVar4;
                                    pbVar5 = pbVar5 + 1;
                                    bVar7 = *pbVar5;
                                    auStack_5e = (undefined1[2])uStack_62;
                                    if (bVar11 == bVar7)
                                        goto LAB_000277f0;
                                    pcVar12 = local_80.sa_data + iVar2 + 6;
                                    unaff_r11 =
                                        (ushort *)(uint)(bVar7 < bVar11);
                                    pcVar4 = pcVar14 + iVar2 + 0x21;
                                    while (true) {
                                        if (unaff_r11 == (ushort *)0x0) {
                                            cVar8 = bVar7 - bVar11;
                                        } else {
                                            cVar8 = bVar11 - bVar7;
                                        }
                                        *(char *)((int)&uStack_5c + iVar2) =
                                            cVar8;
                                        if (0xf < iVar2 + 1)
                                            break;
                                        bVar7 = *pcVar4;
                                        pcVar12 = pcVar12 + 1;
                                        bVar11 = *pcVar12;
                                        pcVar4 = pcVar4 + 1;
                                        iVar2 = iVar2 + 1;
                                    }
                                    goto LAB_00027768;
                                }
                                uVar10 = *(uint *)(pcVar14 + 0x1c);
                                uVar6 =
                                    local_80.sa_data._2_4_ << 0x18 |
                                    ((uint)local_80.sa_data._2_4_ >> 8 & 0xff)
                                        << 0x10 |
                                    ((uint)local_80.sa_data._2_4_ >> 0x10 &
                                     0xff)
                                        << 8 |
                                    (uint)local_80.sa_data._2_4_ >> 0x18;
                                uVar10 = uVar10 << 0x18 |
                                         (uVar10 >> 8 & 0xff) << 0x10 |
                                         (uVar10 >> 0x10 & 0xff) << 8 |
                                         uVar10 >> 0x18;
                                if (uVar10 < uVar6) {
                                    uVar6 = uVar6 - uVar10;
                                } else {
                                    uVar6 = uVar10 - uVar6;
                                }
                                auStack_5e = (undefined1[2])(
                                    (ushort)((uVar6 << 0x18) >> 0x10) |
                                    (ushort)(uVar6 >> 8) & 0xff);
                                uStack_60 =
                                    (ushort)((uVar6 >> 0x10 & 0xff) << 8) |
                                    (ushort)(byte)(uVar6 >> 0x18);
                                uStack_58 = uStack_5c;
                                uStack_54 = uStack_5c;
                            LAB_00027768:
                                if (pcVar13 == (char *)0x0) {
                                LAB_00027850:
                                    unaff_r11 = &uStack_54;
                                    local_48 = (uint)uVar1;
                                    local_44 = CONCAT22(auStack_5e, uStack_60);
                                    local_40 = CONCAT22(local_5a, uStack_5c);
                                    local_3c = CONCAT22(local_56, uStack_58);
                                    pcVar4 =
                                        (char *)CONCAT22(local_52, uStack_54);
                                    local_38 = pcVar4;
                                    local_34 = CONCAT22(local_4e, uStack_50);
                                    local_30 = CONCAT22(local_4a, uStack_4c);
                                    pcVar12 = *(char **)pcVar14;
                                    pcVar13 = pcVar14;
                                    if (*(char **)pcVar14 == (char *)0x0)
                                        break;
                                    goto LAB_000276ac;
                                }
                                if ((ushort)local_48 != uVar1) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007ecc0("ntp_io.c", 0x1071, 0,
                                                 "((d1)->sa.sa_family) == "
                                                 "((d2)->sa.sa_family)");
                                }
                                if ((ushort)local_48 == 2) {
                                    if ((CONCAT22(auStack_5e, uStack_60)
                                             << 0x18 |
                                         (uint)(uStack_60 >> 8) << 0x10 |
                                         ((ushort)auStack_5e & 0xff) << 8 |
                                         (uint)((ushort)auStack_5e >> 8)) <
                                        (local_44 << 0x18 |
                                         (local_44 >> 8 & 0xff) << 0x10 |
                                         (local_44 >> 0x10 & 0xff) << 8 |
                                         local_44 >> 0x18))
                                        goto LAB_00027850;
                                } else {
                                    pbVar9 = auStack_5e + 1;
                                    pbVar5 = (byte *)((int)&local_44 + 3);
                                    do {
                                        pbVar9 = pbVar9 + 1;
                                        pcVar4 = (char *)(uint)*pbVar9;
                                        pbVar5 = pbVar5 + 1;
                                        if (pcVar4 < (byte *)(uint)*pbVar5)
                                            goto LAB_00027850;
                                    } while (
                                        (pcVar4 <= (byte *)(uint)*pbVar5) &&
                                        (pbVar9 !=
                                         (byte *)((int)&local_4e + 1)));
                                }
                            }
                            pcVar12 = *(char **)pcVar14;
                            pcVar14 = pcVar13;
                        } while (pcVar12 != (char *)0x0);
                        if ((pcVar14 != (char *)0x0) &&
                            (*(int *)(pcVar14 + 0xb4) == 0))
                            goto LAB_000277cc;
                    }
                }
                goto LAB_000277e8;
            }
        } else {
            local_88[1] = 1;
            iVar3 = setsockopt(iVar2, 1, 6, local_88 + 1, 4);
            if (iVar3 != -1)
                goto LAB_000275f4;
        }
        close(iVar2);
        pcVar14 = (char *)0x0;
    }
LAB_000277cc:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pcVar14);
LAB_000277f0:
    iVar2 = iVar2 + 1;
    unaff_r11 = (ushort *)((int)unaff_r11 + 1);
    *(undefined1 *)unaff_r11 = 0;
    if (iVar2 == 0x10)
        goto LAB_00027768;
    goto LAB_00027714;
}

void FUN_000278f8(short *param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_0002759c(param_1, 0x80, 0);
    if ((iVar2 == 0) && (iVar2 = any6_interface, *param_1 == 2)) {
        iVar2 = any_interface;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_00027984(code *param_1, undefined4 param_2)

{
    int *piVar1;
    uint uVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    undefined4 *puVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    undefined4 **ppuVar9;
    undefined4 **ppuVar10;
    undefined4 **ppuVar11;
    undefined4 **ppuVar12;
    undefined4 **ppuVar13;
    undefined4 local_1c8;
    undefined4 local_1b0;
    undefined4 **local_1ac;
    undefined1 local_1a8;
    short local_1a4;
    undefined2 local_1a2;
    undefined2 uStack_1a0;
    undefined2 local_19e;
    undefined2 uStack_19c;
    undefined2 local_19a;
    undefined2 uStack_198;
    undefined2 local_196;
    undefined2 uStack_194;
    undefined2 local_192;
    undefined2 uStack_190;
    undefined2 local_18e;
    undefined2 uStack_18c;
    undefined2 local_18a;
    undefined1 auStack_188[32];
    uint local_168;
    uint local_164;
    uint local_160;
    int iStack_15c;
    int iStack_158;
    int iStack_154;
    undefined4 local_148;
    uint local_104;
    undefined4 local_100;
    undefined1 auStack_fc[12];
    undefined4 local_f0;
    undefined4 local_ec;
    short local_e4;
    undefined2 local_e2;
    uint local_e0;
    uint local_dc;
    int local_d8;
    int local_d4;
    int local_d0;
    short local_c8;
    undefined2 local_c6;
    undefined4 local_c4;
    short local_ac;
    undefined2 local_aa;
    undefined1 auStack_90[32];
    short local_70;
    ushort local_6e;
    uint local_6c;
    undefined4 local_4c;
    undefined4 *local_48;
    uint local_3c;
    int local_38;
    int local_34;
    int local_30;
    int local_2c;

    local_1b0 = 0;
    local_2c = __stack_chk_guard;
    iVar5 = FUN_0007fd38(0xffffffff, &local_1b0);
    if (iVar5 == 0) {
        DAT_000c9240 = DAT_000c9240 ^ 1;
        iVar5 = FUN_00080050(local_1b0);
        if (iVar5 == 0) {
            local_1c8 = 0;
            do {
                iVar5 = FUN_0007ffc4(local_1b0, auStack_188);
                if (iVar5 != 0)
                    break;
                if (((local_164 & 0xfffffff7) == 2) &&
                    (((iVar5 = ipv4_works,
                       local_164 != 2 &&
                           (iVar5 = ipv6_works, local_164 != 10)) ||
                      (iVar5 != 0)))) {
                    memset(auStack_fc, 0, 0xc0);
                    local_6e = DAT_000c9240;
                    local_3c = 0;
                    local_38 = 0;
                    local_34 = 0;
                    local_f0 = 0xffffffff;
                    local_ec = 0xffffffff;
                    local_30 = 0x1000000;
                    FUN_0007d4dc(auStack_90, auStack_188, 0x20);
                    local_e2 = 0x7b00;
                    local_4c = local_100;
                    local_c6 = 0x7b00;
                    local_aa = 0x7b00;
                    local_e4 = (short)local_168;
                    if ((local_168 & 0xffff) == 2) {
                        local_e0 = local_160;
                        local_c4 = local_148;
                        if ((local_104 & 8) != 0) {
                            local_6c = local_6c | 8;
                        }
                        local_6c = local_6c | (local_104 & 0x20) << 4 |
                                   local_104 & 0x17;
                        if (((local_6c & 4) != 0) &&
                            ((local_160 & 0xff) != 0x7f))
                            goto LAB_00027b90;
                    } else {
                        local_6c = (local_104 & 0x20) << 4 | local_104 & 0x17 |
                                   local_6c;
                        uVar2 = local_160;
                        iVar5 = iStack_15c;
                        iVar3 = iStack_158;
                        iVar4 = iStack_154;
                        if ((local_168 & 0xffff) != 10) {
                            uVar2 = local_dc;
                            iVar5 = local_d8;
                            iVar3 = local_d4;
                            iVar4 = local_d0;
                        }
                        local_d0 = iVar4;
                        local_d4 = iVar3;
                        local_d8 = iVar5;
                        local_dc = uVar2;
                        if (((local_6c & 4) != 0) &&
                            (((local_3c != local_dc ||
                               (local_38 != local_d8)) ||
                              ((local_34 != local_d4 ||
                                (local_30 != local_d0)))))) {
                        LAB_00027b90:
                            local_6c = local_6c & 0xfffffffb;
                        }
                    }
                    local_c8 = local_e4;
                    local_ac = local_e4;
                    local_70 = local_e4;
                    iVar5 = FUN_000249cc(auStack_90, &local_e4, local_6c);
                    if (iVar5 != 1) {
                        if (iVar5 == 0) {
                            local_48 = (undefined4 *)0x0;
                        } else if (iVar5 == 2) {
                            local_48 = (undefined4 *)0x1;
                        }
                        if ((((local_6c & 1) != 0) &&
                             (iVar5 = FUN_00023d38(&local_e4), iVar5 == 0)) &&
                            ((local_e4 == 2 || (local_e4 == 10)))) {
                            ppuVar12 =
                                (undefined4 **)FUN_0002753c(&local_e4, 0x80);
                            if ((ppuVar12 == (undefined4 **)0x0) ||
                                (ppuVar12[3] == (undefined4 *)0xffffffff)) {
                                ppuVar12 =
                                    (undefined4 **)FUN_00023f3c(auStack_fc);
                                ppuVar13 = ppuVar12 + 6;
                                puVar6 = (undefined4 *)FUN_000254a8(
                                    ppuVar13, 0, 0, ppuVar12);
                                ppuVar12[3] = puVar6;
                                if (puVar6 == (undefined4 *)0xffffffff) {
                                    if (((uint)ppuVar12[0x24] & 8) == 0) {
                                    LAB_00028268:
                                        if (ppuVar12[4] !=
                                            (undefined4 *)0xffffffff)
                                            goto LAB_00028274;
                                    } else if (ppuVar12[4] !=
                                               (undefined4 *)0xffffffff) {
                                    LAB_0002823c:
                                        uVar7 = FUN_0007c2e8(ppuVar12 + 0x14);
                                        FUN_00074e00(6,
                                                     "Listening on broadcast "
                                                     "address %s#%d",
                                                     uVar7, 0x7b);
                                        goto LAB_0002825c;
                                    }
                                LAB_00028374:
                                    puVar6 = ppuVar12[5];
                                    uVar7 = FUN_0007c2e8(ppuVar13);
                                    FUN_00074e00(3,
                                                 "unable to create socket on "
                                                 "%s (%d) for %s#%d",
                                                 ppuVar12 + 0x1b, puVar6, uVar7,
                                                 0x7b);
                                    free(ppuVar12);
                                    uVar7 = FUN_0007c2e8(&local_e4);
                                    FUN_00074e00(6,
                                                 "failed to init interface for "
                                                 "address %s",
                                                 uVar7);
                                } else {
                                    FUN_0002482c(ppuVar12);
                                    if (((uint)ppuVar12[0x24] & 8) == 0) {
                                    LAB_0002825c:
                                        if (ppuVar12[3] ==
                                            (undefined4 *)0xffffffff)
                                            goto LAB_00028268;
                                    } else {
                                        if (ppuVar12[4] !=
                                            (undefined4 *)0xffffffff)
                                            goto LAB_0002823c;
                                        if (ppuVar12[3] ==
                                            (undefined4 *)0xffffffff)
                                            goto LAB_00028374;
                                    }
                                LAB_00028274:
                                    local_1a2 = 0;
                                    uStack_1a0 = 0;
                                    local_19e = 0;
                                    uStack_19c = 0;
                                    local_19a = 0;
                                    uStack_198 = 0;
                                    local_196 = 0;
                                    uStack_194 = 0;
                                    local_192 = 0;
                                    uStack_190 = 0;
                                    local_18e = 0;
                                    uStack_18c = 0;
                                    local_18a = 0;
                                    local_1a4 = *(short *)(ppuVar12 + 6);
                                    if (local_1a4 == 10) {
                                        uStack_198 = 0xffff;
                                        local_196 = 0xffff;
                                        uStack_19c = 0xffff;
                                        local_19a = 0xffff;
                                        uStack_194 = 0xffff;
                                        local_192 = 0xffff;
                                        uStack_190 = 0xffff;
                                        local_18e = 0xffff;
                                    } else {
                                        uStack_1a0 = 0xffff;
                                        local_19e = 0xffff;
                                    }
                                    FUN_00050238(1, ppuVar13, &local_1a4,
                                                 0xfffffffc, 0x3000, 1, 0);
                                    if (((loopback_interface ==
                                          (undefined4 *)0x0) &&
                                         (*(short *)(ppuVar12 + 0x23) == 2)) &&
                                        (((uint)ppuVar12[0x24] & 4) != 0)) {
                                        loopback_interface = ppuVar12;
                                    }
                                    FUN_00023ea4(ppuVar13, ppuVar12);
                                    FUN_00024298(ppuVar12);
                                    local_1a8 = 2;
                                    local_1ac = ppuVar12;
                                    if (param_1 == (code *)0x0) {
                                        local_1c8 = 1;
                                    } else {
                                        (*param_1)(param_2, &local_1ac);
                                        local_1c8 = 1;
                                    }
                                }
                            } else {
                                ppuVar13 = ppuVar12 + 0x1b;
                                if (*(ushort *)((int)ppuVar12 + 0x8e) ==
                                    DAT_000c9240) {
                                    FUN_0007d4dc(ppuVar13, "*multiple*", 0x20);
                                    puVar6 = ppuVar12[0x2d];
                                } else {
                                    FUN_0007d4dc(ppuVar13, auStack_90, 0x20);
                                    ppuVar12[0x2d] = local_48;
                                    puVar6 = local_48;
                                }
                                if (local_48 != puVar6) {
                                    uVar7 = FUN_0007c2e8(&local_e4);
                                    FUN_00074e00(
                                        3,
                                        "WARNING: conflicting enable "
                                        "configuration for interfaces %s and "
                                        "%s for address %s - unsupported "
                                        "configuration - address DISABLED",
                                        auStack_90, ppuVar13, uVar7);
                                    ppuVar12[0x2d] = (undefined4 *)0x1;
                                }
                                local_1a8 = 1;
                                *(ushort *)((int)ppuVar12 + 0x8e) =
                                    DAT_000c9240;
                                local_1ac = ppuVar12;
                                if (param_1 != (code *)0x0) {
                                    (*param_1)(param_2, &local_1ac);
                                }
                            }
                        }
                    }
                }
                iVar5 = FUN_00080164(local_1b0);
            } while (iVar5 == 0);
        } else {
            local_1c8 = 0;
        }
        FUN_00080284(&local_1b0);
        ppuVar12 = (undefined4 **)ep_list;
        while (ppuVar13 = ppuVar12, ppuVar13 != (undefined4 **)0x0) {
            puVar6 = ppuVar13[0x24];
            ppuVar12 = (undefined4 **)*ppuVar13;
            if ((((uint)puVar6 & 0x180) == 0) &&
                (*(ushort *)((int)ppuVar13 + 0x8e) != DAT_000c9240)) {
                ppuVar10 = &ep_list;
                ppuVar9 = ppuVar13;
                if ((undefined4 **)ep_list == ppuVar13) {
                LAB_00027ca4:
                    *ppuVar10 = *ppuVar9;
                } else if ((undefined4 **)ep_list != (undefined4 **)0x0) {
                    ppuVar9 = (undefined4 **)*ep_list;
                    ppuVar10 = (undefined4 **)ep_list;
                    while (ppuVar11 = ppuVar9, ppuVar11 != (undefined4 **)0x0) {
                        if (ppuVar13 == ppuVar11) {
                            ppuVar9 = (undefined4 **)*ppuVar10;
                            goto LAB_00027ca4;
                        }
                        ppuVar10 = ppuVar11;
                        ppuVar9 = (undefined4 **)*ppuVar11;
                    }
                }
                if ((ppuVar13[0x2d] == (undefined4 *)0x0) &&
                    (((uint)puVar6 & 0x10) != 0)) {
                    if (*(short *)(ppuVar13 + 0x23) == 2) {
                        ppuVar10 = (undefined4 **)&mc4_list;
                    } else {
                        ppuVar10 = (undefined4 **)&mc6_list;
                    }
                    ppuVar9 = (undefined4 **)*ppuVar10;
                    if (ppuVar9 == ppuVar13) {
                    LAB_00027d18:
                        *ppuVar10 = ppuVar13[1];
                    } else if (ppuVar9 != (undefined4 **)0x0) {
                        for (ppuVar10 = (undefined4 **)ppuVar9[1];
                             ppuVar10 != (undefined4 **)0x0;
                             ppuVar10 = (undefined4 **)ppuVar10[1]) {
                            if (ppuVar13 == ppuVar10) {
                                ppuVar10 = ppuVar9 + 1;
                                goto LAB_00027d18;
                            }
                            ppuVar9 = ppuVar10;
                        }
                    }
                }
            LAB_00027d28:
                ppuVar11 = (undefined4 **)*remoteaddr_list;
                puVar6 = remoteaddr_list;
                ppuVar9 = &remoteaddr_list;
                ppuVar10 = (undefined4 **)remoteaddr_list;
                if ((undefined4 **)remoteaddr_list[8] == ppuVar13)
                    goto LAB_00027d74;
                while (ppuVar9 = ppuVar11, ppuVar9 != (undefined4 **)0x0) {
                    if ((undefined4 **)ppuVar9[8] == ppuVar13)
                        goto code_r0x00027d68;
                    ppuVar10 = ppuVar9;
                    ppuVar11 = (undefined4 **)*ppuVar9;
                }
                if (ppuVar13[3] != (undefined4 *)0xffffffff) {
                    puVar6 = ppuVar13[5];
                    uVar7 = FUN_0007c2e8(ppuVar13 + 6);
                    FUN_00074e00(6,
                                 "Deleting interface #%d %s, %s#%d, interface "
                                 "stats: received=%ld, sent=%ld, dropped=%ld, "
                                 "active_time=%ld secs",
                                 puVar6, ppuVar13 + 0x1b, uVar7,
                                 *(ushort *)((int)ppuVar13 + 0x1a) << 8 |
                                     *(ushort *)((int)ppuVar13 + 0x1a) >> 8,
                                 ppuVar13[0x29], ppuVar13[0x2a], ppuVar13[0x2b],
                                 current_time - (int)ppuVar13[0x28]);
                    FUN_00025954(ppuVar13[3]);
                    ppuVar13[3] = (undefined4 *)0xffffffff;
                }
                if (ppuVar13[4] != (undefined4 *)0xffffffff) {
                    uVar7 = FUN_0007c2e8(ppuVar13 + 0x14);
                    FUN_00074e00(6,
                                 "stop listening for broadcasts to %s on "
                                 "interface #%d %s",
                                 uVar7, ppuVar13[5], ppuVar13 + 0x1b);
                    FUN_00025954(ppuVar13[4]);
                    ppuVar13[4] = (undefined4 *)0xffffffff;
                }
                ninterfaces = ninterfaces + -1;
                FUN_00040f28(ppuVar13);
                local_1a2 = 0;
                uStack_1a0 = 0;
                local_19e = 0;
                uStack_19c = 0;
                local_19a = 0;
                uStack_198 = 0;
                local_196 = 0;
                uStack_194 = 0;
                local_192 = 0;
                uStack_190 = 0;
                local_18e = 0;
                uStack_18c = 0;
                local_18a = 0;
                local_1a4 = *(short *)(ppuVar13 + 6);
                if (local_1a4 == 10) {
                    uStack_198 = 0xffff;
                    local_196 = 0xffff;
                    uStack_19c = 0xffff;
                    local_19a = 0xffff;
                    uStack_194 = 0xffff;
                    local_192 = 0xffff;
                    uStack_190 = 0xffff;
                    local_18e = 0xffff;
                } else {
                    uStack_1a0 = 0xffff;
                    local_19e = 0xffff;
                }
                FUN_00050238(4, ppuVar13 + 6, &local_1a4, 0xfffffffd, 0x3000, 1,
                             0);
                local_1a8 = 3;
                local_1ac = ppuVar13;
                if (param_1 != (code *)0x0) {
                    (*param_1)(param_2, &local_1ac);
                }
                while (ppuVar13[0x2e] != (undefined4 *)0x0) {
                    FUN_00041e54(ppuVar13[0x2e], 0);
                }
                if ((undefined4 **)loopback_interface == ppuVar13) {
                    loopback_interface = (undefined4 *)0x0;
                }
                free(ppuVar13);
            }
        }
        FUN_000420b4();
        if (broadcast_client_enabled != 0) {
            FUN_0002621c();
        }
        piVar1 = ep_list;
        if (sys_bclient != 0) {
            FUN_0002621c();
            piVar1 = ep_list;
        }
        for (; piVar1 != (int *)0x0; piVar1 = (int *)*piVar1) {
            if (((piVar1[0x24] & 0x140U) == 0x100) &&
                (remoteaddr_list != (undefined4 *)0x0)) {
                iVar5 = remoteaddr_list[8];
                puVar6 = remoteaddr_list;
                while (piVar1 != (int *)iVar5) {
                    puVar6 = (undefined4 *)*puVar6;
                    if (puVar6 == (undefined4 *)0x0)
                        goto LAB_00027f80;
                    iVar5 = puVar6[8];
                }
                iVar5 = FUN_000248d0(piVar1, puVar6 + 1);
                if (iVar5 != 0) {
                    uVar7 = FUN_0007c2e8(piVar1 + 6);
                    uVar8 = FUN_0007c2e8(puVar6 + 1);
                    FUN_00074e00(6, "Joined %s socket to multicast group %s",
                                 uVar7, uVar8);
                }
            }
        LAB_00027f80:
        }
    } else {
        local_1c8 = 0;
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(local_1c8);
    }
    return;
code_r0x00027d68:
    ppuVar11 = (undefined4 **)**ppuVar10;
    puVar6 = *ppuVar10;
    ppuVar9 = ppuVar10;
LAB_00027d74:
    *ppuVar9 = ppuVar11;
    free(puVar6);
    goto LAB_00027d28;
}

/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_00028484(void)

{
    undefined4 *puVar1;
    int iVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;
    uint uVar6;
    sockaddr local_54;
    uint local_44;
    undefined4 local_40;
    undefined4 local_3c;
    undefined4 local_38;
    undefined4 local_34;
    uint local_30;
    int local_2c;

    puVar1 = (undefined4 *)&DAT_000c9240;
    local_2c = __stack_chk_guard;
    if ((DAT_000c93d4 == 0) &&
        (uVar6 = *(uint *)(ntpdOptions._68_4_ + 0x5d0) & 0xf, uVar6 == 0)) {
        DAT_000c92c4 = 0;
        DAT_000c93d4 = 1;
        do {
            puVar1 = puVar1 + 1;
            *puVar1 = 0;
        } while (puVar1 != (undefined4 *)0xc92c0);
        local_54.sa_data[10] = '\0';
        local_54.sa_data[0xb] = '\0';
        local_54.sa_data[0xc] = '\0';
        local_54.sa_data[0xd] = '\0';
        local_40 = 0;
        local_3c = 0;
        local_38 = 0;
        local_34 = 0;
        local_44 = uVar6;
        local_30 = uVar6;
        if (ipv6_works != 0) {
            local_54.sa_data[10] = '\n';
            local_54.sa_data[0xb] = '\0';
            local_54.sa_data[0xc] = '\0';
            local_54.sa_data[0xd] = '{';
            local_40 = in6addr_any;
            local_3c = ___memcpy_chk;
            local_38 = ___res_init;
            local_34 = _tcgetattr;
            iVar2 = FUN_000249cc(0, local_54.sa_data + 10);
            if (iVar2 != 1) {
                iVar3 = FUN_00023f3c(0);
                iVar5 = iVar3 + 0x18;
                FUN_0007d4dc(iVar3 + 0x6c, "v6wildcard", 0x20);
                *(undefined4 *)(iVar3 + 0x18) = local_54.sa_data._10_4_;
                *(undefined4 *)(iVar3 + 0x24) = local_3c;
                *(uint *)(iVar3 + 0x1c) = local_44;
                *(undefined4 *)(iVar3 + 0x20) = local_40;
                *(undefined4 *)(iVar3 + 0x28) = local_38;
                *(undefined4 *)(iVar3 + 0x2c) = local_34;
                *(uint *)(iVar3 + 0x30) = local_30;
                *(undefined2 *)(iVar3 + 0x8c) = 10;
                *(undefined2 *)(iVar3 + 0x34) = 10;
                *(undefined4 *)(iVar3 + 0x3c) = 0xffffffff;
                *(undefined4 *)(iVar3 + 0x40) = 0xffffffff;
                *(undefined4 *)(iVar3 + 0x44) = 0xffffffff;
                *(undefined4 *)(iVar3 + 0x48) = 0xffffffff;
                *(uint *)(iVar3 + 0xb4) = (uint)(iVar2 == 2);
                *(undefined4 *)(iVar3 + 0x90) = 0x81;
                iVar2 = FUN_000254a8(iVar5, 0, 1, iVar3);
                *(int *)(iVar3 + 0xc) = iVar2;
                if (iVar2 == -1) {
                    uVar4 = FUN_0007c2e8(iVar5);
                    FUN_00074e00(3,
                                 "unable to bind to wildcard address %s - "
                                 "another process may be running - EXITING",
                                 uVar4);
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                DAT_000c92cc = iVar3;
                any6_interface = iVar3;
                FUN_00023ea4(iVar5, iVar3);
                FUN_00024298(iVar3);
                FUN_0002482c(iVar3);
            }
        }
        if (ipv4_works != 0) {
            local_54.sa_data[10] = '\x02';
            local_54.sa_data[0xb] = '\0';
            local_54.sa_data[0xc] = '\0';
            local_54.sa_data[0xd] = '{';
            local_44 = 0;
            iVar2 = FUN_000249cc(0, local_54.sa_data + 10, 0);
            if (iVar2 != 1) {
                iVar3 = FUN_00023f3c(0);
                iVar5 = iVar3 + 0x18;
                FUN_0007d4dc(iVar3 + 0x6c, "v4wildcard", 0x20);
                *(undefined4 *)(iVar3 + 0x18) = local_54.sa_data._10_4_;
                *(undefined4 *)(iVar3 + 0x24) = local_3c;
                *(uint *)(iVar3 + 0x1c) = local_44;
                *(undefined4 *)(iVar3 + 0x20) = local_40;
                *(undefined4 *)(iVar3 + 0x28) = local_38;
                *(undefined4 *)(iVar3 + 0x2c) = local_34;
                *(uint *)(iVar3 + 0x30) = local_30;
                *(uint *)(iVar3 + 0xb4) = (uint)(iVar2 == 2);
                *(undefined4 *)(iVar3 + 0x50) = 0x7b000002;
                *(undefined4 *)(iVar3 + 0x54) = 0;
                *(undefined4 *)(iVar3 + 0x38) = 0xffffffff;
                *(undefined4 *)(iVar3 + 0x90) = 0x89;
                *(undefined2 *)(iVar3 + 0x8c) = 2;
                *(undefined2 *)(iVar3 + 0x34) = 2;
                iVar2 = FUN_000254a8(iVar5, 0, 1, iVar3);
                *(int *)(iVar3 + 0xc) = iVar2;
                if (iVar2 == -1) {
                    uVar4 = FUN_0007c2e8(iVar5);
                    FUN_00074e00(3,
                                 "unable to bind to wildcard address %s - "
                                 "another process may be running - EXITING",
                                 uVar4);
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                DAT_000c92c8 = iVar3;
                any_interface = iVar3;
                FUN_00023ea4(iVar5, iVar3);
                FUN_00024298(iVar3);
                FUN_0002482c(iVar3);
            }
        }
        FUN_00027984(0);
        FUN_000241a4(0);
        iVar2 = socket(0x10, 3, 0);
        if (iVar2 < 0) {
            FUN_00074e00(3, "unable to open routing socket (%m) - using polled "
                            "interface update");
        } else {
            iVar2 = FUN_0007c0b8();
            local_54.sa_data[4] = '\0';
            local_54.sa_data[5] = '\0';
            local_54.sa_data[0] = '\0';
            local_54.sa_data[1] = '\0';
            local_54.sa_data[2] = '\0';
            local_54.sa_data[3] = '\0';
            local_54.sa_family = 0x10;
            local_54.sa_data[6] = 'q';
            local_54.sa_data[7] = '\a';
            local_54.sa_data[8] = '\0';
            local_54.sa_data[9] = '\0';
            iVar3 = bind(iVar2, &local_54, 0xc);
            if (iVar3 < 0) {
                FUN_00074e00(3, "bind failed on routing socket (%m) - using "
                                "polled interface update");
            } else {
                FUN_0007c26c(iVar2);
                puVar1 = (undefined4 *)FUN_00073ba4(0, 0x10, 0, 1);
                puVar1[1] = iVar2;
                puVar1[3] = FUN_00025b14;
                *puVar1 = asyncio_reader_list;
                asyncio_reader_list = puVar1;
                FUN_00025420(iVar2, 0);
                FUN_00074e00(6,
                             "Listening on routing socket on fd #%d for "
                             "interface updates",
                             iVar2);
            }
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00028908(void)

{
    int iVar1;
    int iVar2;
    sem_t *__sem;
    int iVar3;
    uint uVar4;

    iVar3 = __stack_chk_guard;
    if ((disable_dynamic_updates == 0) &&
        (iVar2 = FUN_00027984(), iVar1 = __stack_chk_guard, iVar2 != 0)) {
        if (iVar3 == __stack_chk_guard) {
            if (blocking_children_alloc != 0) {
                uVar4 = 0;
                do {
                    iVar3 = *(int *)(blocking_children + uVar4 * 4);
                    if ((iVar3 != 0) && (__sem = *(sem_t **)(iVar3 + 0x30),
                                         __sem != (sem_t *)0x0)) {
                        sem_post(__sem);
                    }
                    uVar4 = uVar4 + 1;
                } while (uVar4 < blocking_children_alloc);
            }
            if (iVar1 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
    } else if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002898c(short *param_1)

{
    bool bVar1;
    int iVar2;
    int *piVar3;
    int iVar4;
    short *psVar5;
    int iVar6;
    short sVar7;
    uint uVar8;
    uint uVar9;
    int *piVar10;

    iVar2 = __stack_chk_guard;
    piVar3 = (int *)FUN_0002759c(param_1, 0x84, 1);
    if (piVar3 == (int *)0x0) {
        sVar7 = *param_1;
        if (ep_list != (int *)0x0) {
            piVar3 = ep_list;
            do {
                while ((((uVar9 = piVar3[0x24],
                          (uVar9 & 0x80) != 0 || (piVar3[0x2d] != 0)) ||
                         (piVar10 = piVar3 + 6, (short)*piVar10 != sVar7)) ||
                        ((uVar9 & 4) != 0))) {
                LAB_00028a74:
                    piVar3 = (int *)*piVar3;
                    if (piVar3 == (int *)0x0)
                        goto LAB_00028a80;
                }
                if (sVar7 == 2) {
                    uVar8 = *(uint *)(param_1 + 2);
                    if (((((uVar8 & 0xf0) == 0xe0) && ((uVar9 & 0x10) != 0)) ||
                         (((short)piVar3[0x14] == 2 &&
                           (piVar3[0x15] == uVar8)))) ||
                        (((uVar8 ^ piVar3[7]) & piVar3[0xe]) == 0))
                        goto LAB_000289c4;
                LAB_00028aa0:
                    piVar3 = (int *)*piVar3;
                    sVar7 = (short)*piVar10;
                } else {
                    if (((char)param_1[4] == -1) && ((uVar9 & 0x10) != 0)) {
                        if ((sVar7 == 10) &&
                            (((*(byte *)((int)param_1 + 9) & 0xf) == 2 &&
                              ((piVar3[8] & 0xc0ffU) != 0x80fe))))
                            goto LAB_00028a74;
                        goto LAB_000289c4;
                    }
                    if (sVar7 != 10)
                        goto LAB_00028aa0;
                    if ((((short)piVar3[0x14] == 10) &&
                         (iVar4 = memcmp(piVar3 + 0x16, param_1 + 4, 0x10),
                          iVar4 == 0)) &&
                        (piVar3[0x1a] == *(int *)(param_1 + 0xc)))
                        goto LAB_000289c4;
                    piVar10 = piVar3 + 6;
                    psVar5 = (short *)FUN_00075468(piVar10);
                    sVar7 = *psVar5;
                    psVar5 = (short *)FUN_00075468(param_1);
                    if (*psVar5 == sVar7) {
                        psVar5 = (short *)FUN_00075468(piVar10);
                        if (*psVar5 == 2) {
                            iVar4 = FUN_00075468(piVar10);
                            iVar6 = *(int *)(iVar4 + 4);
                            iVar4 = FUN_00075468(param_1);
                            bVar1 = *(int *)(iVar4 + 4) == iVar6;
                        } else {
                            iVar4 = FUN_00075468(piVar10);
                            iVar6 = FUN_00075468(param_1);
                            iVar4 = memcmp((void *)(iVar4 + 8),
                                           (void *)(iVar6 + 8), 0x10);
                            if (iVar4 != 0)
                                goto LAB_00028b48;
                            iVar4 = FUN_00075468(piVar10);
                            iVar6 = *(int *)(iVar4 + 0x18);
                            iVar4 = FUN_00075468(param_1);
                            bVar1 = *(int *)(iVar4 + 0x18) == iVar6;
                        }
                        if (bVar1)
                            goto LAB_000289c4;
                    }
                LAB_00028b48:
                    piVar3 = (int *)*piVar3;
                    sVar7 = *param_1;
                }
            } while (piVar3 != (int *)0x0);
        }
    LAB_00028a80:
        piVar3 = any_interface;
        if (sVar7 != 2) {
            piVar3 = any6_interface;
        }
    }
LAB_000289c4:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar3);
}

void FUN_00028c28(int param_1, short *param_2, int param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = any6_interface;
    if ((*param_2 == 2) && (iVar2 = loopback_interface, iVar3 = any_interface,
                            param_2[2] == 0x7f7f)) {
    LAB_00028cdc:
        param_3 = iVar2;
        if (iVar2 == iVar3) {
        LAB_00028cf4:
            param_3 = FUN_000278f8(param_2);
        }
        if (param_3 != 0)
            goto LAB_00028c84;
    } else {
        if ((*(byte *)(param_1 + 0x48) & 0x36) != 0) {
            iVar2 = FUN_0002898c(param_2);
            goto LAB_00028cdc;
        }
        if ((param_3 == 0) || (param_3 == iVar3))
            goto LAB_00028cf4;
    LAB_00028c84:
        if ((*(uint *)(param_3 + 0x90) & 0x80) == 0)
            goto LAB_00028c90;
    }
    param_3 = 0;
LAB_00028c90:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_3);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00028dc0) */

void FUN_00028d18(void)

{
    packets_dropped = 0;
    packets_ignored = 0;
    packets_received = 0;
    packets_sent = 0;
    packets_notsent = 0;
    handler_calls = 0;
    handler_pkts = 0;
    io_timereset = current_time;
    return;
}

undefined4 FUN_00028df0(undefined4 *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    param_1[7] = 1;
    *param_1 = DAT_000c93d0;
    DAT_000c93d0 = param_1;
    FUN_00025420(param_1[5], 1);
    if (iVar1 == __stack_chk_guard) {
        return 1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00028e64(undefined4 *param_1)

{
    undefined4 *puVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;

    param_1[7] = 0;
    iVar2 = __stack_chk_guard;
    if (param_1 == DAT_000c93d0) {
        puVar5 = &DAT_000c93d0;
        puVar4 = DAT_000c93d0;
    LAB_00028ee0:
        uVar3 = param_1[5];
        *puVar5 = *puVar4;
        FUN_00025954(uVar3);
        FUN_0007a240(param_1[5]);
        param_1[5] = 0xffffffff;
    } else if (DAT_000c93d0 != (undefined4 *)0x0) {
        puVar4 = (undefined4 *)*DAT_000c93d0;
        puVar5 = DAT_000c93d0;
        while (puVar1 = puVar4, puVar1 != (undefined4 *)0x0) {
            if (param_1 == puVar1) {
                puVar4 = (undefined4 *)*puVar5;
                goto LAB_00028ee0;
            }
            puVar5 = puVar1;
            puVar4 = (undefined4 *)*puVar1;
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00029014) */

void FUN_00028fb4(int param_1)

{
    if (param_1 != 0) {
        FUN_0007c2e8(param_1 + 0x18);
        return;
    }
    return;
}

void FUN_00029024(short *param_1, short *param_2)

{
    int iVar1;
    short *psVar2;
    short *psVar3;
    short *psVar4;

    iVar1 = __stack_chk_guard;
    fwrite("Stack now", 1, 9, stderr);
    if (param_1 <= param_2) {
        psVar2 = param_1 + 1;
        psVar4 = param_1;
        while (psVar3 = psVar2, __fprintf_chk(stderr, 1, " %d", (int)*psVar4),
               psVar3 !=
                   (short *)((int)param_1 +
                             ((int)param_2 - (int)param_1 & 0xfffffffeU) + 2)) {
            psVar4 = psVar3;
            psVar2 = psVar3 + 1;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        fputc(10, stderr);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000290f4(FILE *param_1, int param_2)

{
    int iVar1;
    char *pcVar2;

    iVar1 = __stack_chk_guard;
    if (param_2 < 0xd0) {
        pcVar2 = "token";
    } else {
        pcVar2 = "nterm";
    }
    __fprintf_chk(param_1, 1, "%s %s (", pcVar2, (&PTR_DAT_000c36e0)[param_2]);
    if (iVar1 == __stack_chk_guard) {
        fputc(0x29, param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002919c(undefined4 param_1, undefined4 param_2)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (yydebug == 0) {
        return;
    }
    __fprintf_chk(stderr, 1, &DAT_0009ffa0, param_1);
    FUN_000290f4(stderr, param_2);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    fputc(10, stderr);
    return;
}

void FUN_00029254(char *param_1, byte *param_2)

{
    byte *pbVar1;
    byte bVar2;
    int iVar3;
    uint uVar4;
    char *pcVar5;
    byte *pbVar6;

    iVar3 = __stack_chk_guard;
    uVar4 = (uint)*param_2;
    if (uVar4 == 0x22) {
        uVar4 = 0;
        pbVar6 = param_2;
        while (bVar2 = pbVar6[1], bVar2 != 0x27) {
            if (bVar2 < 0x28) {
                if (bVar2 == 0x22) {
                    if (param_1 != (char *)0x0) {
                        param_1[uVar4] = '\0';
                    }
                    goto LAB_00029298;
                }
            LAB_00029334:
                pbVar6 = pbVar6 + 1;
            } else {
                if (bVar2 == 0x2c)
                    break;
                if (bVar2 != 0x5c)
                    goto LAB_00029334;
                pbVar1 = pbVar6 + 2;
                pbVar6 = pbVar6 + 2;
                if (*pbVar1 != 0x5c)
                    break;
            }
            if (param_1 != (char *)0x0) {
                param_1[uVar4] = *pbVar6;
            }
            uVar4 = uVar4 + 1;
        }
    }
    if (param_1 == (char *)0x0) {
        if (iVar3 == __stack_chk_guard) {
            strlen((char *)param_2);
            return;
        }
    } else {
        pcVar5 = stpcpy(param_1, (char *)param_2);
        uVar4 = (int)pcVar5 - (int)param_1;
    LAB_00029298:
        if (iVar3 == __stack_chk_guard) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_00029348(uint *param_1, undefined4 *param_2, short *param_3,
                  int param_4)

{
    char cVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    int iVar5;
    char *pcVar6;
    short *psVar7;
    char *pcVar8;
    undefined *puVar9;
    int iVar10;
    uint uVar11;
    int iVar12;
    bool bVar13;
    undefined *local_40[5];
    int local_2c;

    puVar9 = (&PTR_DAT_000c36e0)[param_4];
    local_2c = __stack_chk_guard;
    uVar2 = FUN_00029254(0, puVar9);
    uVar11 = uVar2;
    if (param_4 == -2) {
        uVar3 = 0xc;
        iVar4 = 0;
        pcVar6 = "syntax error";
    } else {
        local_40[0] = puVar9;
        iVar4 = (int)(short)(&DAT_0009e108)[*param_3];
        if (iVar4 == -0xd7) {
            uVar3 = 0x1b;
            iVar4 = 1;
            pcVar6 = "syntax error, unexpected %s";
        } else {
            iVar12 = 0x297 - iVar4;
            if (iVar4 < 0) {
                iVar5 = -iVar4;
            } else {
                iVar5 = 0;
            }
            if (0xcf < iVar12) {
                iVar12 = 0xd0;
            }
            if (iVar5 < iVar12) {
                psVar7 = (short *)(&UNK_0009e46e + (iVar5 + iVar4) * 2);
                iVar10 = 1;
                do {
                    psVar7 = psVar7 + 1;
                    iVar4 = iVar10;
                    if (iVar5 != 1 && *psVar7 == iVar5) {
                        if (iVar10 == 5) {
                            uVar3 = 0x1b;
                            iVar4 = 1;
                            pcVar6 = "syntax error, unexpected %s";
                            uVar11 = uVar2;
                            goto LAB_00029484;
                        }
                        iVar4 = iVar10 + 1;
                        local_40[iVar10] = (&PTR_DAT_000c36e0)[iVar5];
                        uVar3 = FUN_00029254(0);
                        bVar13 = CARRY4(uVar3, uVar11);
                        uVar11 = uVar3 + uVar11;
                        if (bVar13)
                            goto LAB_0002946c;
                    }
                    iVar5 = iVar5 + 1;
                    iVar10 = iVar4;
                } while (iVar12 != iVar5);
                switch (iVar4) {
                case 1:
                    uVar3 = 0x1b;
                    pcVar6 = "syntax error, unexpected %s";
                    break;
                case 2:
                    uVar3 = 0x29;
                    pcVar6 = "syntax error, unexpected %s, expecting %s";
                    break;
                case 3:
                    uVar3 = 0x2f;
                    pcVar6 = "syntax error, unexpected %s, expecting %s or %s";
                    break;
                case 4:
                    uVar3 = 0x35;
                    pcVar6 =
                        "syntax error, unexpected %s, expecting %s or %s or %s";
                    break;
                case 5:
                    uVar3 = 0x3b;
                    pcVar6 = "syntax error, unexpected %s, expecting %s or %s "
                             "or %s or %s";
                    break;
                default:
                    uVar3 = strlen((char *)0x0);
                    pcVar6 = (char *)0x0;
                }
            } else {
                uVar3 = 0x1b;
                iVar4 = 1;
                pcVar6 = "syntax error, unexpected %s";
            }
        }
    }
LAB_00029484:
    uVar2 = uVar11 + uVar3;
    if (CARRY4(uVar11, uVar3)) {
    LAB_0002946c:
        cVar1 = '\x02';
    } else if (*param_1 < uVar2) {
        if (uVar2 * 2 < uVar2) {
            cVar1 = '\x01';
            *param_1 = 0xffffffff;
        } else {
            cVar1 = '\x01';
            *param_1 = uVar2 * 2;
        }
    } else {
        cVar1 = *pcVar6;
        pcVar8 = (char *)*param_2;
        iVar12 = 0;
        while (*pcVar8 = cVar1, cVar1 != '\0') {
            bVar13 = cVar1 == '%';
            cVar1 = pcVar6[1];
            if ((bVar13) && (iVar12 < iVar4 && cVar1 == 's')) {
                pcVar6 = pcVar6 + 2;
                iVar5 = FUN_00029254(pcVar8, local_40[iVar12]);
                pcVar8 = pcVar8 + iVar5;
                cVar1 = *pcVar6;
                iVar12 = iVar12 + 1;
            } else {
                pcVar8 = pcVar8 + 1;
                pcVar6 = pcVar6 + 1;
            }
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(cVar1);
    }
    return;
}

void FUN_00029664(undefined4 param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_0002c4b8();
    *(undefined4 *)(iVar2 + 0x28) = *(undefined4 *)(iVar2 + 0x20);
    *(undefined4 *)(iVar2 + 0x2c) = *(undefined4 *)(iVar2 + 0x24);
    FUN_00074e00(3, "line %d column %d %s", *(undefined4 *)(iVar2 + 0x28),
                 *(undefined4 *)(iVar2 + 0x2c), param_1);
    iVar3 = FUN_0002c450();
    if (iVar3 == 0) {
        iVar2 = FUN_0007c054(remote_config._2052_4_ + 0x1178f0,
                             0x400 - remote_config._2052_4_, "column %d %s",
                             *(undefined4 *)(iVar2 + 0x2c), param_1);
        if (0 < iVar2) {
            remote_config._2052_4_ = remote_config._2052_4_ + iVar2;
        }
        remote_config._2056_4_ = remote_config._2056_4_ + 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002973c(void)

{
    byte bVar1;
    ushort uVar2;
    short sVar3;
    short sVar4;
    uint *__src;
    short *psVar5;
    undefined4 uVar6;
    char *pcVar7;
    undefined1 uVar8;
    int iVar9;
    char cVar10;
    uint uVar11;
    uint *puVar12;
    undefined4 uVar13;
    uint uVar14;
    short *psVar15;
    uint uVar16;
    int iVar17;
    uint uVar18;
    uint *puVar19;
    int iVar20;
    short *__src_00;
    uint local_95c;
    uint local_954;
    int local_94c;
    uint local_948;
    uint uStack_944;
    int local_940;
    char *local_908;
    undefined4 local_904;
    short local_900[200];
    uint auStack_770[401];
    char acStack_12c[128];
    undefined1 auStack_ac[128];
    int local_2c;

    local_904 = 0x80;
    local_2c = __stack_chk_guard;
    local_908 = acStack_12c;
    if (yydebug != 0) {
        fwrite("Starting parse\n", 1, 0xf, stderr);
    }
    iVar17 = 0;
    local_94c = 0;
    yynerrs = 0;
    local_900[0] = 0;
    local_95c = 200;
    yychar = 0xfffffffe;
    psVar15 = local_900;
    __src_00 = local_900;
    __src = auStack_770;
    puVar12 = auStack_770;
    do {
        do {
            if (yydebug != 0) {
                __fprintf_chk(stderr, 1, "Entering state %d\n", iVar17);
            }
            if (iVar17 == 0xd8) {
                uVar13 = 0;
                goto LAB_0002a148;
            }
            iVar9 = iVar17 * 2;
            uVar14 = (uint)(short)(&DAT_0009e108)[iVar17];
            if (uVar14 != 0xffffff29) {
                if (yychar == 0xfffffffe) {
                    if (yydebug != 0) {
                        fwrite("Reading a token: ", 1, 0x11, stderr);
                    }
                    yychar = FUN_0002c5e8();
                }
                if ((int)yychar < 1) {
                    uVar18 = 0;
                    yychar = 0;
                    uVar11 = uVar14;
                    if (yydebug == 0) {
                        uVar18 = 0;
                    } else {
                        fwrite("Now at end of input.\n", 1, 0x15, stderr);
                    }
                } else {
                    if ((int)yychar < 0x1ca) {
                        uVar18 = (uint)(byte)(&DAT_0009e9a0)[yychar];
                        uVar11 = uVar14 + uVar18;
                    } else {
                        uVar18 = 2;
                        uVar11 = uVar14 + 2;
                    }
                    if (yydebug != 0) {
                        __fprintf_chk(stderr, 1, &DAT_0009ffa0,
                                      "Next token is");
                        FUN_000290f4(stderr, uVar18);
                        fputc(10, stderr);
                    }
                }
                if (0x296 < uVar11)
                    goto LAB_000298d0;
                sVar3 = *(short *)(&DAT_0009e470 + uVar11 * 2);
                if ((int)sVar3 != uVar18)
                    goto LAB_000298d0;
                iVar17 = (int)*(short *)(&DAT_0009eb6c + uVar11 * 2);
                if (iVar17 < 1) {
                    uVar18 = -iVar17;
                    goto LAB_000298ec;
                }
                if (local_94c != 0) {
                    local_94c = local_94c + -1;
                }
                if (yydebug != 0) {
                    __fprintf_chk(stderr, 1, &DAT_0009ffa0, "Shifting");
                    FUN_000290f4(stderr, (int)sVar3);
                    fputc(10, stderr);
                }
                puVar19 = puVar12 + 2;
                yychar = 0xfffffffe;
                *puVar19 = (uint)yylval;
                puVar12[3] = yylval._4_4_;
                goto LAB_00029eec;
            }
        LAB_000298d0:
            uVar18 = (uint)(ushort)(&DAT_0009f09c)[iVar17];
            if (uVar18 == 0) {
                if (yychar == 0xfffffffe) {
                    uVar18 = 0xfffffffe;
                } else if (yychar < 0x1ca) {
                    uVar18 = (uint)(byte)(&DAT_0009e9a0)[yychar];
                } else {
                    uVar18 = 2;
                }
                if (local_94c == 0) {
                    yynerrs = yynerrs + 1;
                    iVar17 =
                        FUN_00029348(&local_904, &local_908, psVar15, uVar18);
                    if (iVar17 == 0) {
                        FUN_00029664(local_908);
                        goto LAB_0002a07c;
                    }
                    if (iVar17 == 1) {
                        if (local_908 != acStack_12c) {
                            free(local_908);
                        }
                        local_908 = (char *)FUN_00073ba4(0, local_904, 0);
                        if (local_908 != (char *)0x0) {
                            iVar17 = FUN_00029348(&local_904, &local_908,
                                                  psVar15, uVar18);
                            pcVar7 = local_908;
                            goto LAB_0002a548;
                        }
                        local_904 = 0x80;
                        local_908 = acStack_12c;
                        FUN_00029664("syntax error");
                    } else {
                        pcVar7 = "syntax error";
                    LAB_0002a548:
                        FUN_00029664(pcVar7);
                        if (iVar17 != 2)
                            goto LAB_0002a07c;
                    }
                    goto LAB_0002a568;
                }
                if (local_94c == 3) {
                    if ((int)yychar < 1) {
                        if (yychar == 0) {
                            uVar13 = 1;
                            uVar14 = 0;
                            goto LAB_0002a2cc;
                        }
                    } else {
                        FUN_0002919c("Error: discarding", uVar18);
                        yychar = 0xfffffffe;
                    }
                }
            LAB_0002a07c:
                while ((((uVar14 == 0xffffff29 || (0x296 < uVar14 + 1)) ||
                         (iVar17 = (uVar14 + 1) * 2,
                          *(short *)(&DAT_0009e470 + iVar17) != 1)) ||
                        (iVar17 = (int)*(short *)(&DAT_0009eb6c + iVar17),
                         iVar17 < 1))) {
                    if (__src_00 == psVar15) {
                        uVar13 = 1;
                        __src_00 = psVar15;
                        goto LAB_0002a148;
                    }
                    puVar12 = puVar12 + -2;
                    FUN_0002919c("Error: popping",
                                 *(undefined2 *)(&DAT_0009f7d8 + iVar9));
                    psVar15 = psVar15 + -1;
                    sVar3 = *psVar15;
                    if (yydebug != 0) {
                        FUN_00029024(__src_00, psVar15);
                    }
                    iVar9 = sVar3 * 2;
                    uVar14 = (uint)(short)(&DAT_0009e108)[sVar3];
                }
                puVar19 = puVar12 + 2;
                puVar12[2] = (uint)yylval;
                puVar12[3] = yylval._4_4_;
                if (yydebug == 0) {
                    local_94c = 3;
                } else {
                    local_94c = 3;
                    __fprintf_chk(stderr, 1, &DAT_0009ffa0, "Shifting");
                    FUN_000290f4(stderr,
                                 *(undefined2 *)(&DAT_0009f7d8 + iVar17 * 2));
                    fputc(10, stderr);
                }
                goto LAB_00029eec;
            }
        LAB_000298ec:
            bVar1 = (&DAT_0009f404)[uVar18];
            uVar14 = (uint)bVar1;
            local_954 = puVar12[(1 - uVar14) * 2];
            uStack_944 = puVar12[(1 - uVar14) * 2 + 1];
            if (yydebug == 0) {
                local_940 = uVar18 << 1;
            } else {
                local_940 = uVar18 * 2;
                uVar11 = (uint) * (ushort *)(&DAT_0009f54c + local_940);
                __fprintf_chk(stderr, 1,
                              "Reducing stack by rule %d (line %lu):\n",
                              uVar18 - 1, uVar11);
                if (uVar14 != 0) {
                    psVar5 = psVar15 + -uVar14;
                    uVar16 = 0;
                    do {
                        uVar16 = uVar16 + 1;
                        psVar5 = psVar5 + 1;
                        __fprintf_chk(stderr, 1, "   $%d = ", uVar16, uVar11);
                        FUN_000290f4(
                            stderr,
                            *(undefined2 *)(&DAT_0009f7d8 +
                                            psVar5[(int)(short)(ushort)bVar1 -
                                                   uVar14] *
                                                2));
                        fputc(10, stderr);
                    } while (uVar14 != uVar16);
                }
            }
            switch (uVar18) {
            case 5:
                iVar17 = FUN_0002c4b8();
                FUN_00074e00(3, "syntax error in %s line %d, column %d",
                             iVar17 + 0x30, *(undefined4 *)(iVar17 + 0x28),
                             *(undefined4 *)(iVar17 + 0x2c));
                break;
            case 6:
                break;
            case 7:
                break;
            case 8:
                break;
            case 9:
                break;
            case 10:
                break;
            case 0xb:
                break;
            case 0xc:
                break;
            case 0xd:
                break;
            case 0xe:
                break;
            case 0xf:
                break;
            case 0x10:
                break;
            case 0x11:
                break;
            case 0x12:
                break;
            case 0x13:
                break;
            case 0x14:
                uVar13 = FUN_0001f4b0(puVar12[-4], puVar12[-2], *puVar12);
                cfgt._36_4_ = FUN_0001edb0(cfgt._36_4_, uVar13);
                break;
            case 0x15:
                break;
            case 0x16:
                break;
            case 0x17:
                break;
            case 0x18:
                break;
            case 0x19:
                break;
            case 0x1a:
                break;
            case 0x1b:
                local_954 = FUN_0001f348(*puVar12, puVar12[-2]);
                break;
            case 0x1c:
                local_954 = FUN_0001f348(*puVar12, 0);
                break;
            case 0x1d:
                local_954 = 2;
                break;
            case 0x1e:
                local_954 = 10;
                break;
            case 0x1f:
                goto LAB_0002a68c;
            case 0x20:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x21:
                break;
            case 0x22:
                break;
            case 0x23:
                break;
            case 0x24:
                local_954 = FUN_0001f098(0x1be, *puVar12);
                break;
            case 0x25:
                break;
            case 0x26:
                break;
            case 0x27:
                break;
            case 0x28:
                break;
            case 0x29:
                break;
            case 0x2a:
                break;
            case 0x2b:
                break;
            case 0x2c:
                break;
            case 0x2d:
                local_954 = FUN_0001f098(puVar12[-2], *puVar12);
                break;
            case 0x2e:
                local_954 = FUN_0001f108(puVar12[-2], *puVar12);
                break;
            case 0x2f:
                break;
            case 0x30:
                break;
            case 0x31:
                break;
            case 0x32:
                break;
            case 0x33:
                break;
            case 0x34:
                break;
            case 0x35:
                local_954 = FUN_0001f1f0(puVar12[-2], *puVar12);
                break;
            case 0x36:
                break;
            case 0x37:
                iVar17 = FUN_0001f7bc(*puVar12);
                if (iVar17 != 0) {
                    cfgt._40_4_ = FUN_0001edb0(cfgt._40_4_);
                }
                break;
            case 0x38:
                break;
            case 0x39:
                break;
            case 0x3a:
                cfgt._44_4_ = 1;
                break;
            case 0x3b:
                cfgt._48_4_ = FUN_0001ee48(cfgt._48_4_, *puVar12);
                break;
            case 0x3c:
                cfgt._52_4_ = FUN_0001ee48(cfgt._52_4_, *puVar12);
                break;
            case 0x3d:
                cfgt._176_4_ = *puVar12;
                break;
            case 0x3e:
                uVar13 = FUN_0001f098(puVar12[-2], *puVar12);
                cfgt._160_4_ = FUN_0001edb0(cfgt._160_4_, uVar13);
                break;
            case 0x3f:
                cfgt._104_4_ = *puVar12;
                break;
            case 0x40:
                cfgt._108_4_ = cfgt._108_4_ + 1;
                cfgt._112_4_ = FUN_0001ee48(cfgt._112_4_, *puVar12);
                break;
            case 0x41:
                cfgt._116_4_ = *puVar12;
                break;
            case 0x42:
                cfgt._120_4_ = *puVar12;
                break;
            case 0x43:
                cfgt._124_4_ = *puVar12;
                break;
            case 0x44:
                cfgt._128_4_ = *puVar12;
                break;
            case 0x45:
                cfgt._132_4_ = FUN_0001eef0(cfgt._132_4_, destroy_attr_val);
                cfgt._132_4_ = FUN_0001ee48(cfgt._132_4_, *puVar12);
                break;
            case 0x46:
                cfgt._136_4_ = *puVar12;
                break;
            case 0x47:
                goto LAB_0002a68c;
            case 0x48:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x49:
                local_954 = FUN_0001f1f0(puVar12[-2], *puVar12);
                break;
            case 0x4a:
                local_954 = 0;
                cfgt._128_4_ = *puVar12;
                FUN_00074e00(4,
                             "\'crypto revoke %d\' is deprecated, please use "
                             "\'revoke %d\' instead.",
                             cfgt._128_4_, cfgt._128_4_);
                break;
            case 0x4b:
                break;
            case 0x4c:
                break;
            case 0x4d:
                break;
            case 0x4e:
                break;
            case 0x4f:
                break;
            case 0x50:
                cfgt._56_4_ = FUN_0001ee48(cfgt._56_4_, *puVar12);
                break;
            case 0x51:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x52:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0x53:
                local_954 = FUN_0001f020(
                    SUB84((double)(longlong)(int)*puVar12, 0), puVar12[-2]);
                break;
            case 0x54:
                local_954 =
                    FUN_0001f020((int)*(undefined8 *)puVar12, puVar12[-2]);
                break;
            case 0x55:
                local_954 = FUN_0001f020(
                    SUB84((double)(longlong)(int)*puVar12, 0), puVar12[-2]);
                break;
            case 0x56:
                local_954 = FUN_0001f098(0x10b, *puVar12);
                break;
            case 0x57:
                break;
            case 0x58:
                break;
            case 0x59:
                break;
            case 0x5a:
                break;
            case 0x5b:
                break;
            case 0x5c:
                break;
            case 0x5d:
                break;
            case 0x5e:
                break;
            case 0x5f:
                break;
            case 0x60:
                break;
            case 0x61:
                break;
            case 0x62:
                cfgt._60_4_ = FUN_0001ee48(cfgt._60_4_, *puVar12);
                break;
            case 99:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    free((void *)*puVar12);
                    FUN_00029664("statsdir remote configuration ignored");
                } else {
                    cfgt._64_4_ = *puVar12;
                }
                break;
            case 100:
                uVar13 = FUN_0001f898(puVar12[-2], *puVar12);
                cfgt._68_4_ = FUN_0001edb0(cfgt._68_4_, uVar13);
                break;
            case 0x65:
                uVar14 = puVar12[-2];
                uVar13 = FUN_0001f288(*puVar12);
                local_954 = FUN_0001edb0(uVar14, uVar13);
                break;
            case 0x66:
                uVar13 = FUN_0001f288(*puVar12);
                local_954 = FUN_0001edb0(0, uVar13);
                break;
            case 0x67:
                break;
            case 0x68:
                break;
            case 0x69:
                break;
            case 0x6a:
                break;
            case 0x6b:
                break;
            case 0x6c:
                break;
            case 0x6d:
                break;
            case 0x6e:
                break;
            case 0x6f:
                goto LAB_0002a68c;
            case 0x70:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x71:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    free((void *)*puVar12);
                    FUN_00029664("filegen file remote config ignored");
                    local_954 = 0;
                } else {
                    local_954 = FUN_0001f1f0(puVar12[-2], *puVar12);
                }
                break;
            case 0x72:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    FUN_00029664("filegen type remote config ignored");
                    local_954 = 0;
                } else {
                    local_954 = FUN_0001f098(puVar12[-2], *puVar12);
                }
                break;
            case 0x73:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    if (*puVar12 == 0x151) {
                        pcVar7 = "filegen link remote config ignored";
                    } else {
                        pcVar7 = "filegen nolink remote config ignored";
                    }
                    FUN_00029664(pcVar7);
                    local_954 = 0;
                } else {
                    local_954 = FUN_0001f098(0x1be, *puVar12);
                }
                break;
            case 0x74:
                local_954 = FUN_0001f098(0x1be, *puVar12);
                break;
            case 0x75:
                break;
            case 0x76:
                break;
            case 0x77:
                break;
            case 0x78:
                break;
            case 0x79:
                break;
            case 0x7a:
                break;
            case 0x7b:
                break;
            case 0x7c:
                break;
            case 0x7d:
                break;
            case 0x7e:
                break;
            case 0x7f:
                break;
            case 0x80:
                cfgt._72_4_ = FUN_0001ee48(cfgt._72_4_, *puVar12);
                break;
            case 0x81:
                cfgt._76_4_ = FUN_0001ee48(cfgt._76_4_, *puVar12);
                break;
            case 0x82:
                uVar18 = puVar12[-4];
                uVar14 = puVar12[-2];
                uVar11 = *puVar12;
                iVar17 = FUN_0002c4b8();
                uVar13 = FUN_0001f900(uVar18, 0, (int)(short)uVar14, uVar11,
                                      *(undefined4 *)(iVar17 + 0x10));
                cfgt._80_4_ = FUN_0001edb0(cfgt._80_4_, uVar13);
                break;
            case 0x83:
                uVar14 = puVar12[-2];
                uVar18 = puVar12[-8];
                uVar11 = puVar12[-4];
                uVar16 = *puVar12;
                iVar17 = FUN_0002c4b8();
                uVar13 = FUN_0001f900(uVar18, uVar11, (int)(short)uVar14,
                                      uVar16, *(undefined4 *)(iVar17 + 0x10));
                cfgt._80_4_ = FUN_0001edb0(cfgt._80_4_, uVar13);
                break;
            case 0x84:
                uVar14 = puVar12[-2];
                uVar18 = *puVar12;
                iVar17 = FUN_0002c4b8();
                uVar13 = FUN_0001f900(0, 0, (int)(short)uVar14, uVar18,
                                      *(undefined4 *)(iVar17 + 0x10));
                cfgt._80_4_ = FUN_0001edb0(cfgt._80_4_, uVar13);
                break;
            case 0x85:
                uVar13 = FUN_00073d08("0.0.0.0");
                uVar13 = FUN_0001f348(uVar13, 2);
                uVar6 = FUN_00073d08("0.0.0.0");
                uVar6 = FUN_0001f348(uVar6, 2);
                uVar14 = puVar12[-2];
                uVar18 = *puVar12;
                iVar17 = FUN_0002c4b8();
                uVar13 = FUN_0001f900(uVar13, uVar6, (int)(short)uVar14, uVar18,
                                      *(undefined4 *)(iVar17 + 0x10));
                cfgt._80_4_ = FUN_0001edb0(cfgt._80_4_, uVar13);
                break;
            case 0x86:
                uVar13 = FUN_00073d08(&DAT_000a02a0);
                uVar13 = FUN_0001f348(uVar13, 10);
                uVar6 = FUN_00073d08(&DAT_000a02a0);
                uVar6 = FUN_0001f348(uVar6, 10);
                uVar14 = puVar12[-2];
                uVar18 = *puVar12;
                iVar17 = FUN_0002c4b8();
                uVar13 = FUN_0001f900(uVar13, uVar6, (int)(short)uVar14, uVar18,
                                      *(undefined4 *)(iVar17 + 0x10));
                cfgt._80_4_ = FUN_0001edb0(cfgt._80_4_, uVar13);
                break;
            case 0x87:
                uVar14 = *puVar12;
                uVar13 = FUN_0001f288(puVar12[-4]);
                uVar18 = FUN_0001edb0(uVar14, uVar13);
                *puVar12 = uVar18;
                uVar14 = puVar12[-2];
                iVar17 = FUN_0002c4b8();
                uVar13 = FUN_0001f900(0, 0, (int)(short)uVar14, uVar18,
                                      *(undefined4 *)(iVar17 + 0x10));
                cfgt._80_4_ = FUN_0001edb0(cfgt._80_4_, uVar13);
                break;
            case 0x88:
                local_954 = 0xffffffff;
                break;
            case 0x89:
                local_954 = *puVar12;
                if (0x65 < local_954 + 1) {
                    iVar17 = FUN_0002c4b8();
                    FUN_00074e00(3,
                                 "Unreasonable ippeerlimit value (%d) in %s "
                                 "line %d, column %d.  Using 0.",
                                 *puVar12, iVar17 + 0x30,
                                 *(undefined4 *)(iVar17 + 0x28),
                                 *(undefined4 *)(iVar17 + 0x2c));
                    local_954 = 0;
                    *puVar12 = 0;
                }
                break;
            case 0x8a:
                local_954 = 0;
                break;
            case 0x8b:
                uVar14 = puVar12[-2];
                uVar13 = FUN_0001f288(*puVar12);
                local_954 = FUN_0001edb0(uVar14, uVar13);
                break;
            case 0x8c:
                break;
            case 0x8d:
                break;
            case 0x8e:
                break;
            case 0x8f:
                break;
            case 0x90:
                break;
            case 0x91:
                break;
            case 0x92:
                break;
            case 0x93:
                break;
            case 0x94:
                break;
            case 0x95:
                break;
            case 0x96:
                break;
            case 0x97:
                break;
            case 0x98:
                break;
            case 0x99:
                break;
            case 0x9a:
                break;
            case 0x9b:
                break;
            case 0x9c:
                break;
            case 0x9d:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x9e:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0x9f:
                local_954 = FUN_0001f098(puVar12[-2], *puVar12);
                break;
            case 0xa0:
                break;
            case 0xa1:
                break;
            case 0xa2:
                break;
            case 0xa3:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0xa4:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0xa5:
                local_954 = FUN_0001f098(puVar12[-2], *puVar12);
                break;
            case 0xa6:
                break;
            case 0xa7:
                break;
            case 0xa8:
                break;
            case 0xa9:
                break;
            case 0xaa:
                break;
            case 0xab:
                break;
            case 0xac:
                break;
            case 0xad:
                break;
            case 0xae:
                uVar13 = FUN_0001faac(puVar12[-2], *puVar12);
                cfgt._84_4_ = FUN_0001edb0(cfgt._84_4_, uVar13);
                break;
            case 0xaf:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0xb0:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0xb1:
                local_954 =
                    FUN_0001f020((int)*(undefined8 *)puVar12, puVar12[-2]);
                break;
            case 0xb2:
                local_954 = FUN_0001f098(puVar12[-2], *puVar12);
                break;
            case 0xb3:
                if (*puVar12 < 0x11) {
                    local_954 = FUN_0001f098(puVar12[-2]);
                } else {
                    local_954 = 0;
                    FUN_00029664(
                        "fudge factor: stratum value not in [0..16], ignored");
                }
                break;
            case 0xb4:
                local_954 = FUN_0001f1f0(puVar12[-2], *puVar12);
                break;
            case 0xb5:
                local_954 = FUN_0001f1f0(puVar12[-2], *puVar12);
                break;
            case 0xb6:
                break;
            case 0xb7:
                break;
            case 0xb8:
                break;
            case 0xb9:
                break;
            case 0xba:
                break;
            case 0xbb:
                break;
            case 0xbc:
                cfgt._88_4_ = FUN_0001ee48(cfgt._88_4_, *puVar12);
                break;
            case 0xbd:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0xbe:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0xbf:
                local_954 = FUN_0001f098(puVar12[-2], *puVar12);
                break;
            case 0xc0:
                break;
            case 0xc1:
                break;
            case 0xc2:
                break;
            case 0xc3:
                cfgt._96_4_ = FUN_0001ee48(cfgt._96_4_, *puVar12);
                break;
            case 0xc4:
                cfgt._100_4_ = FUN_0001ee48(cfgt._100_4_, *puVar12);
                break;
            case 0xc5:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0xc6:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 199:
                local_954 = FUN_0001f098(0x1be, *puVar12);
                break;
            case 200:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    uVar13 = FUN_0002c0bc(*puVar12);
                    FUN_0007c054(
                        auStack_ac, 0x80,
                        "enable/disable %s remote configuration ignored",
                        uVar13);
                    FUN_00029664(auStack_ac);
                    local_954 = 0;
                } else {
                    local_954 = FUN_0001f098(0x1be, *puVar12);
                }
                break;
            case 0xc9:
                break;
            case 0xca:
                break;
            case 0xcb:
                break;
            case 0xcc:
                break;
            case 0xcd:
                break;
            case 0xce:
                break;
            case 0xcf:
                break;
            case 0xd0:
                break;
            case 0xd1:
                break;
            case 0xd2:
                break;
            case 0xd3:
                break;
            case 0xd4:
                break;
            case 0xd5:
                cfgt._92_4_ = FUN_0001ee48(cfgt._92_4_, *puVar12);
                break;
            case 0xd6:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0xd7:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0xd8:
                local_954 =
                    FUN_0001f020((int)*(undefined8 *)puVar12, puVar12[-2]);
                break;
            case 0xd9:
                break;
            case 0xda:
                break;
            case 0xdb:
                break;
            case 0xdc:
                break;
            case 0xdd:
                break;
            case 0xde:
                break;
            case 0xdf:
                break;
            case 0xe0:
                break;
            case 0xe1:
                break;
            case 0xe2:
                break;
            case 0xe3:
                break;
            case 0xe4:
                break;
            case 0xe5:
                uVar13 = FUN_0001f020((int)*(undefined8 *)puVar12, puVar12[-2]);
                cfgt._160_4_ = FUN_0001edb0(cfgt._160_4_, uVar13);
                break;
            case 0xe6:
                uVar13 = FUN_0001f098(puVar12[-2], *puVar12);
                cfgt._160_4_ = FUN_0001edb0(cfgt._160_4_, uVar13);
                break;
            case 0xe7:
                uVar13 = FUN_0001f1f0(puVar12[-2], *puVar12);
                cfgt._160_4_ = FUN_0001edb0(cfgt._160_4_, uVar13);
                break;
            case 0xe8:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    free((void *)*puVar12);
                    uVar13 = FUN_0002c0bc(puVar12[-2]);
                    FUN_0007c054(auStack_ac, 0x40, "%s remote config ignored",
                                 uVar13);
                    FUN_00029664(auStack_ac);
                } else {
                    uVar13 = FUN_0001f1f0(puVar12[-2], *puVar12);
                    cfgt._160_4_ = FUN_0001edb0(cfgt._160_4_, uVar13);
                }
                break;
            case 0xe9:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    free((void *)puVar12[-2]);
                    FUN_00029664("remote includefile ignored");
                } else {
                    uVar14 = FUN_0002c3dc();
                    if (uVar14 < 6) {
                        uVar13 = FUN_00073d78(puVar12[-2]);
                        iVar17 = FUN_0002c2e8(uVar13, "r");
                        if (iVar17 == 0) {
                            __fprintf_chk(stderr, 1,
                                          "getconfig: Couldn\'t open <%s>\n",
                                          uVar13);
                            FUN_00074e00(3, "getconfig: Couldn\'t open <%s>",
                                         uVar13);
                        }
                    } else {
                        fwrite(
                            "getconfig: Maximum include file level exceeded.\n",
                            1, 0x30, stderr);
                        FUN_00074e00(
                            3,
                            "getconfig: Maximum include file level exceeded.");
                    }
                    free((void *)puVar12[-2]);
                }
                break;
            case 0xea:
                FUN_0002c24c();
                break;
            case 0xeb:
                break;
            case 0xec:
                cfgt._140_4_ = FUN_0001ee48(cfgt._140_4_, *puVar12);
                break;
            case 0xed:
                cfgt._144_4_ = FUN_0001ee48(cfgt._144_4_, *puVar12);
                break;
            case 0xee:
                cfgt._148_4_ = FUN_0001edb0(cfgt._148_4_, *puVar12);
                break;
            case 0xef:
                uVar13 = FUN_0001faac(puVar12[-2], *puVar12);
                cfgt._156_4_ = FUN_0001edb0(cfgt._156_4_, uVar13);
                break;
            case 0xf0:
                cfgt._152_4_ = FUN_0001ee48(cfgt._152_4_, *puVar12);
                break;
            case 0xf1:
                break;
            case 0xf2:
                break;
            case 0xf3:
                break;
            case 0xf4:
                break;
            case 0xf5:
                FUN_00029664("Built without LEAP_SMEAR support.");
                break;
            case 0xf6:
                break;
            case 0xf7:
                break;
            case 0xf8:
                break;
            case 0xf9:
                break;
            case 0xfa:
                break;
            case 0xfb:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    free((void *)*puVar12);
                    FUN_00029664("driftfile remote configuration ignored");
                } else {
                    uVar13 = FUN_0001f1f0(0x122, *puVar12);
                    cfgt._160_4_ = FUN_0001edb0(cfgt._160_4_, uVar13);
                }
                break;
            case 0xfc:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    free((void *)puVar12[-2]);
                    FUN_00029664("driftfile remote configuration ignored");
                } else {
                    uVar13 = FUN_0001f1f0(0x122, puVar12[-2]);
                    cfgt._160_4_ = FUN_0001edb0(cfgt._160_4_, uVar13);
                    uVar13 = FUN_0001f020((int)*(undefined8 *)puVar12, 0x1b9);
                    cfgt._160_4_ = FUN_0001edb0(cfgt._160_4_, uVar13);
                    FUN_00074e00(
                        4, "\'driftfile FILENAME WanderValue\' is deprecated, "
                           "please use separate \'driftfile FILENAME\' and "
                           "\'nonvolatile WanderValue\' lines instead.");
                }
                break;
            case 0xfd:
                iVar17 = FUN_0002c450();
                if (iVar17 == 0) {
                    FUN_00029664("driftfile remote configuration ignored");
                } else {
                    uVar13 = FUN_00073d08(&DAT_000a7f7c);
                    uVar13 = FUN_0001f1f0(0x122, uVar13);
                    cfgt._160_4_ = FUN_0001edb0(cfgt._160_4_, uVar13);
                }
                break;
            case 0xfe:
                local_954 = FUN_0001f980(puVar12[-6], puVar12[-2], *puVar12);
                break;
            case 0xff:
                break;
            case 0x100:
                goto LAB_0002a6c0;
            case 0x101:
            LAB_0002a68c:
                local_954 = 0;
                break;
            case 0x102:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x103:
                local_954 = FUN_0001f098(puVar12[-2], *puVar12);
                break;
            case 0x104:
                uVar14 = puVar12[-2];
                uVar13 = FUN_00073d08(*(undefined4 *)(*puVar12 + 4));
                local_954 = FUN_0001f1f0(uVar14, uVar13);
                FUN_0001f410(*puVar12);
                break;
            case 0x105:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x106:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0x107:
                pcVar7 = (char *)*puVar12;
                cVar10 = *pcVar7;
                if (((cVar10 == '-') || (cVar10 == '=')) || (cVar10 == '+')) {
                    pcVar7 = pcVar7 + 1;
                } else {
                    cVar10 = '=';
                }
                uVar13 = FUN_00073d08(pcVar7);
                local_954 = FUN_0001f1f0(cVar10, uVar13);
                free((void *)*puVar12);
                break;
            case 0x108:
                uVar13 = FUN_0001fa04(*puVar12, 0, puVar12[-2]);
                cfgt._164_4_ = FUN_0001edb0(cfgt._164_4_, uVar13);
                break;
            case 0x109:
                uVar13 = FUN_0001fa04(0, *puVar12, puVar12[-2]);
                cfgt._164_4_ = FUN_0001edb0(cfgt._164_4_, uVar13);
                break;
            case 0x10a:
                break;
            case 0x10b:
                break;
            case 0x10c:
                break;
            case 0x10d:
                break;
            case 0x10e:
                break;
            case 0x10f:
                break;
            case 0x110:
                break;
            case 0x111:
                break;
            case 0x112:
                break;
            case 0x113:
                cfgt._168_4_ = FUN_0001ee48(cfgt._168_4_, *puVar12);
                break;
            case 0x114:
                uVar14 = puVar12[-2];
                uVar13 = FUN_0001f288(*puVar12);
                local_954 = FUN_0001edb0(uVar14, uVar13);
                break;
            case 0x115:
                uVar13 = FUN_0001f288(*puVar12);
                local_954 = FUN_0001edb0(0, uVar13);
                break;
            case 0x116:
                break;
            case 0x117:
                break;
            case 0x118:
                break;
            case 0x119:
                break;
            case 0x11a:
                break;
            case 0x11b:
                break;
            case 0x11c:
                break;
            case 0x11d:
                uVar14 = puVar12[-2];
                uVar13 = FUN_0001f288(*puVar12);
                local_954 = FUN_0001edb0(uVar14, uVar13);
                break;
            case 0x11e:
                uVar13 = FUN_0001f288(*puVar12);
                local_954 = FUN_0001edb0(0, uVar13);
                break;
            case 0x11f:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x120:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0x121:
                local_954 = FUN_0001f098(0x69, *puVar12);
                break;
            case 0x122:
                break;
            case 0x123:
                local_954 = FUN_0001f178(0x2d, puVar12[-6], puVar12[-2]);
                break;
            case 0x124:
                uVar14 = puVar12[-2];
                uVar13 = FUN_0001f2e8(*puVar12);
                local_954 = FUN_0001edb0(uVar14, uVar13);
                break;
            case 0x125:
                uVar13 = FUN_0001f2e8(*puVar12);
                local_954 = FUN_0001edb0(0, uVar13);
                break;
            case 0x126:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x127:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0x128:
                local_954 = *puVar12;
                if (1 < local_954) {
                    local_954 = 1;
                    FUN_00029664(
                        "Integer value is not boolean (0 or 1). Assuming 1");
                }
                break;
            case 0x129:
                local_954 = 1;
                break;
            case 0x12a:
            LAB_0002a6c0:
                local_954 = 0;
                break;
            case 299:
                local_948 = SUB84((double)(longlong)(int)*puVar12, 0);
                local_954 = local_948;
                uStack_944 =
                    (uint)((ulonglong)(double)(longlong)(int)*puVar12 >> 0x20);
                break;
            case 300:
                break;
            case 0x12d:
                local_954 = FUN_00076ea4(*puVar12);
                free((void *)*puVar12);
                break;
            case 0x12e:
                uVar13 = FUN_0001fb14(puVar12[-4], puVar12[-2]);
                cfgt._172_4_ = FUN_0001edb0(cfgt._172_4_, uVar13);
                old_config_style = 1;
                break;
            case 0x12f:
                old_config_style = 0;
                break;
            case 0x130:
                local_954 = FUN_0001edb0(puVar12[-4], puVar12[-2]);
                break;
            case 0x131:
                local_954 = FUN_0001edb0(0, puVar12[-2]);
                break;
            case 0x132:
                local_954 =
                    FUN_0001f020((int)*(undefined8 *)puVar12, puVar12[-4]);
                break;
            case 0x133:
                break;
            case 0x134:
                break;
            case 0x135:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x136:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0x137:
                local_954 = 0;
                break;
            case 0x138:
                local_954 = puVar12[-2];
                uStack_944 = puVar12[-1];
                break;
            case 0x139:
                local_954 = *puVar12;
                break;
            case 0x13a:
                local_954 = FUN_0001edb0(puVar12[-2], *puVar12);
                break;
            case 0x13b:
                local_954 = FUN_0001edb0(0, *puVar12);
                break;
            case 0x13c:
                local_954 = 0;
                break;
            case 0x13d:
                local_954 = FUN_0001edb0(puVar12[-4], puVar12[-2]);
                break;
            case 0x13e:
                local_954 = FUN_0001edb0(0, puVar12[-2]);
                break;
            case 0x13f:
                local_954 =
                    FUN_0001f020((int)*(undefined8 *)puVar12, puVar12[-4]);
            }
            iVar17 = (int)(short)(ushort)bVar1;
            psVar15 = psVar15 + -iVar17;
            uVar2 = *(ushort *)(&DAT_0009fb40 + local_940);
            if (yydebug != 0) {
                __fprintf_chk(stderr, 1, &DAT_0009ffa0, "-> $$ =");
                FUN_000290f4(stderr, (uint)uVar2);
                fputc(10, stderr);
                if (yydebug != 0) {
                    FUN_00029024(__src_00, psVar15);
                }
            }
            iVar9 = (uVar2 - 0xd0) * 2;
            sVar3 = *psVar15;
            puVar19 = puVar12 + iVar17 * -2 + 2;
            sVar4 = *(short *)(&DAT_0009fdcc + iVar9);
            *puVar19 = local_954;
            puVar12[iVar17 * -2 + 3] = uStack_944;
            uVar14 = (int)sVar4 + (int)sVar3;
            if ((uVar14 < 0x297) &&
                (iVar17 = uVar14 * 2,
                 (int)*(short *)(&DAT_0009e470 + iVar17) == (int)sVar3)) {
                iVar17 = (int)*(short *)(&DAT_0009eb6c + iVar17);
            } else {
                iVar17 = (int)*(short *)(&DAT_0009fea4 + iVar9);
            }
        LAB_00029eec:
            psVar5 = psVar15 + 1;
            psVar15[1] = (short)iVar17;
            psVar15 = psVar5;
            puVar12 = puVar19;
        } while (psVar5 < __src_00 + local_95c + 0x7fffffff);
        iVar9 = (int)psVar5 - (int)__src_00 >> 1;
        iVar20 = iVar9 + 1;
        if (999 < local_95c) {
        LAB_0002a568:
            uVar13 = 2;
            FUN_00029664("memory exhausted");
            goto LAB_0002a148;
        }
        local_95c = (local_95c + 0x7fffffff) * 2 + 2;
        if (999 < local_95c) {
            local_95c = 1000;
        }
        psVar5 = (short *)FUN_00073ba4(0, local_95c * 10 + 7, 0);
        if (psVar5 == (short *)0x0)
            goto LAB_0002a568;
        puVar12 = (uint *)((int)psVar5 + (local_95c * 2 + 7 & 0xfffffff8));
        memcpy(psVar5, __src_00, iVar20 * 2);
        memcpy(puVar12, __src, iVar20 * 8);
        if (__src_00 != local_900) {
            free(__src_00);
        }
        psVar15 = psVar5 + iVar9;
        if (yydebug != 0) {
            __fprintf_chk(stderr, 1, "Stack size increased to %lu\n",
                          local_95c);
        }
        __src_00 = psVar5;
        __src = puVar12;
        puVar12 = puVar12 + iVar20 * 2 + -2;
        if (psVar5 + (local_95c - 1) <= psVar15) {
            uVar13 = 1;
        LAB_0002a148:
            if (yychar != 0xfffffffe) {
                uVar14 = yychar;
                if (yychar < 0x1ca) {
                LAB_0002a2cc:
                    uVar8 = (&DAT_0009e9a0)[uVar14];
                } else {
                    uVar8 = 2;
                }
                FUN_0002919c("Cleanup: discarding lookahead", uVar8);
            }
            if (yydebug != 0) {
                FUN_00029024(__src_00, psVar15);
            }
            for (; psVar15 != __src_00; psVar15 = psVar15 + -1) {
                FUN_0002919c("Cleanup: popping",
                             *(undefined2 *)(&DAT_0009f7d8 + *psVar15 * 2));
            }
            if (__src_00 != local_900) {
                free(__src_00);
            }
            if (local_908 != acStack_12c) {
                free(local_908);
            }
            if (local_2c != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail(uVar13);
            }
            return;
        }
    } while (true);
}

/* WARNING: Removing unreachable block (ram,0x0002bc20) */

void FUN_0002bbb4(void)

{
    return;
}

void FUN_0002bc38(uint param_1, int param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((param_2 != 0) && (*(int *)(param_2 + 8) == 0)) {
        iVar2 = *(int *)(param_2 + 0xc) + 1;
        if (iVar2 != 0) {
            iVar2 = 1;
        }
        if (iVar2 == 0 && param_1 != 0xffffffff) {
            param_1 = param_1 & 0xff;
            *(uint *)(param_2 + 0xc) = param_1;
            if (*(int *)(param_2 + 4) != 0) {
                conf_file_sum = conf_file_sum - param_1;
            }
            if (param_1 == 10) {
                *(undefined4 *)(param_2 + 0x10) =
                    *(undefined4 *)(param_2 + 0x18);
                *(undefined4 *)(param_2 + 0x14) =
                    *(undefined4 *)(param_2 + 0x1c);
                *(undefined4 *)(param_2 + 0x1c) = 0xffffffff;
            }
            *(int *)(param_2 + 0x14) = *(int *)(param_2 + 0x14) + -1;
            goto LAB_0002bce0;
        }
    }
    param_1 = 0xffffffff;
LAB_0002bce0:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_1);
    }
    return;
}

void FUN_0002bd14(char *param_1, char *param_2)

{
    int iVar1;
    size_t __n;
    void *__ptr;
    FILE *pFVar2;

    iVar1 = __stack_chk_guard;
    __n = strlen(param_1);
    __ptr = (void *)FUN_00073ba4(0, __n + 0x34, 0, 1);
    *(undefined4 *)((int)__ptr + 0x10) = 1;
    *(undefined4 *)((int)__ptr + 0xc) = 0xffffffff;
    memcpy((void *)((int)__ptr + 0x30), param_1, __n);
    if (param_2 != (char *)0x0) {
        pFVar2 = fopen64(param_1, param_2);
        *(FILE **)((int)__ptr + 4) = pFVar2;
        if (pFVar2 == (FILE *)0x0) {
            free(__ptr);
            __ptr = (void *)0x0;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__ptr);
}

void FUN_0002bdd8(void *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (param_1 == (void *)0x0) {
        return;
    }
    if (*(FILE **)((int)param_1 + 4) != (FILE *)0x0) {
        fclose(*(FILE **)((int)param_1 + 4));
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    free(param_1);
    return;
}

void FUN_0002be54(int param_1)

{
    int iVar1;
    uint uVar2;
    byte *pbVar3;
    FILE *__stream;
    byte *pbVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    if ((param_1 == 0) || (*(int *)(param_1 + 8) != 0)) {
    LAB_0002bf54:
        uVar2 = 0xffffffff;
    } else {
        uVar2 = *(uint *)(param_1 + 0xc);
        __stream = *(FILE **)(param_1 + 4);
        if (uVar2 == 0xffffffff) {
            if (__stream == (FILE *)0x0) {
                pbVar3 = *(byte **)(param_1 + 0x14);
                uVar2 = (uint)(byte)remote_config[remote_config._2048_4_];
                pbVar4 = remote_config + remote_config._2048_4_;
                if (0x7f < uVar2) {
                    iVar5 = (int)pbVar3 - (int)pbVar4;
                    do {
                        pbVar4 = pbVar4 + 1;
                        pbVar3 = pbVar4 + iVar5;
                        *(byte **)(param_1 + 0x14) = pbVar3;
                        uVar2 = (uint)*pbVar4;
                    } while (0x7f < uVar2);
                }
                if (uVar2 != 0) {
                    remote_config._2048_4_ = pbVar4 + -0x1174ef;
                    *(byte **)(param_1 + 0x14) = pbVar3 + 1;
                    goto LAB_0002bec8;
                }
                remote_config._2048_4_ = pbVar4 + -0x1174f0;
            } else {
                while (uVar2 = fgetc(__stream), uVar2 != 0xffffffff) {
                    iVar5 = *(int *)(param_1 + 0x14) + 1;
                    if ((int)uVar2 < 0x80) {
                        *(int *)(param_1 + 0x14) = iVar5;
                        conf_file_sum = conf_file_sum + uVar2;
                        goto LAB_0002bec8;
                    }
                    __stream = *(FILE **)(param_1 + 4);
                    *(int *)(param_1 + 0x14) = iVar5;
                }
                pbVar3 = *(byte **)(param_1 + 0x14);
            }
            if (pbVar3 == (byte *)0x0)
                goto LAB_0002bf54;
        } else {
            *(undefined4 *)(param_1 + 0xc) = 0xffffffff;
            if (__stream != (FILE *)0x0) {
                conf_file_sum = conf_file_sum + uVar2;
            }
            *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
        LAB_0002bec8:
            if (uVar2 != 10)
                goto LAB_0002bed0;
        }
        *(undefined4 *)(param_1 + 0x18) = *(undefined4 *)(param_1 + 0x10);
        *(undefined4 *)(param_1 + 0x1c) = *(undefined4 *)(param_1 + 0x14);
        uVar2 = 10;
        *(int *)(param_1 + 0x10) = *(int *)(param_1 + 0x10) + 1;
        *(undefined4 *)(param_1 + 0x14) = 0;
    }
LAB_0002bed0:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_0002bffc(void)

{
    int iVar1;
    ushort **ppuVar2;
    undefined4 uVar3;
    uint uVar4;
    undefined1 *puVar5;

    iVar1 = __stack_chk_guard;
    puVar5 = yytext;
    uVar4 = (uint)yytext[0];
    if (uVar4 != 0) {
        ppuVar2 = __ctype_b_loc();
        do {
            if (((*ppuVar2)[uVar4] & 0x2000) == 0) {
                yylval._0_4_ = FUN_00073d08(yytext);
                uVar3 = 0x1a3;
                goto LAB_0002c08c;
            }
            puVar5 = puVar5 + 1;
            uVar4 = (uint)(byte)*puVar5;
        } while (uVar4 != 0);
    }
    uVar3 = 0x1bf;
    yylval._0_4_ = 0x1bf;
LAB_0002c08c:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

/* WARNING: Removing unreachable block (ram,0x0002c130) */

void FUN_0002c0bc(void)

{
    return;
}

void FUN_0002c148(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (DAT_000c93d8 == 0 && param_1 != 0) {
        DAT_000c93d8 = FUN_0002bd14(param_1);
        iVar2 = DAT_000c93d8;
        if (DAT_000c93d8 != 0) {
            iVar2 = 1;
        }
    } else {
        iVar2 = 0;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_0002c1cc(void)

{
    int iVar1;
    int *piVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    bVar3 = DAT_000c93d8 != (int *)0x0;
    piVar2 = DAT_000c93d8;
    while (bVar3) {
        piVar2 = (int *)*piVar2;
        FUN_0002bdd8();
        bVar3 = piVar2 != (int *)0x0;
    }
    DAT_000c93d8 = (int *)0x0;
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0002c24c(void)

{
    int *piVar1;
    int iVar2;
    int *piVar3;
    bool bVar4;
    int iVar5;

    iVar2 = __stack_chk_guard;
    piVar1 = DAT_000c93d8;
    if (DAT_000c93d8 == (int *)0x0) {
        bVar4 = false;
    } else {
        piVar3 = (int *)*DAT_000c93d8;
        iVar5 = DAT_000c93d8[2];
        DAT_000c93d8[2] = 1;
        bVar4 = iVar5 == 0;
        while (piVar3 != (int *)0x0) {
            piVar3 = (int *)*piVar3;
            FUN_0002bdd8();
        }
        *piVar1 = 0;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(bVar4);
}

void FUN_0002c2e8(int param_1)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == 0) {
        uVar3 = 0;
    } else {
        puVar2 = (undefined4 *)FUN_0002bd14(param_1);
        if (puVar2 == (undefined4 *)0x0) {
            uVar3 = 0;
        } else {
            uVar3 = 1;
            *puVar2 = DAT_000c93d8;
            DAT_000c93d8 = puVar2;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0002c364(void)

{
    int iVar1;
    int *piVar2;

    iVar1 = __stack_chk_guard;
    piVar2 = DAT_000c93d8;
    if (DAT_000c93d8 != (int *)0x0) {
        if ((int *)*DAT_000c93d8 == (int *)0x0) {
            piVar2 = (int *)0x0;
        } else {
            DAT_000c93d8 = (int *)*DAT_000c93d8;
            FUN_0002bdd8(piVar2);
            piVar2 = (int *)0x1;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar2);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0002c440) */

void FUN_0002c3dc(void)

{
    int *piVar1;

    piVar1 = DAT_000c93d8;
    if (DAT_000c93d8 != (int *)0x0) {
        do {
            piVar1 = (int *)*piVar1;
        } while (piVar1 != (int *)0x0);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0002c4a8) */

void FUN_0002c450(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x0002c4fc) */

void FUN_0002c4b8(void)

{
    return;
}

void FUN_0002c50c(char *param_1)

{
    int iVar1;
    size_t sVar2;
    undefined4 uVar3;
    size_t sVar4;
    char *pcVar5;
    int iVar6;

    iVar1 = __stack_chk_guard;
    sVar2 = strlen(param_1);
    iVar6 = sVar2 + 3;
    uVar3 = FUN_00073ba4(0, iVar6, 0);
    if ((*param_1 == '\"') ||
        ((sVar4 = strcspn(param_1, special_chars),
          sVar2 <= sVar4 &&
              (pcVar5 = strchr(param_1, 0x20), pcVar5 == (char *)0x0)))) {
        FUN_0007d4dc(uVar3, param_1, iVar6);
    } else {
        FUN_0007c054(uVar3, iVar6, "\"%s\"", param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0002c5e8(void)

{
    byte bVar1;
    ushort uVar2;
    bool bVar3;
    uint uVar4;
    ushort **ppuVar5;
    char *pcVar6;
    int iVar7;
    __int32_t **pp_Var8;
    long lVar9;
    int *piVar10;
    uint uVar11;
    int iVar12;
    undefined1 *puVar13;
    uint uVar14;
    byte *pbVar15;
    int iVar16;
    undefined1 *puVar17;
    ushort *puVar18;
    uint uVar19;
    int local_30;
    int local_2c;

    bVar3 = false;
    local_2c = __stack_chk_guard;
    iVar12 = DAT_000c93d8;
LAB_0002c648:
    uVar4 = FUN_0002be54(iVar12);
    if (uVar4 == 0xffffffff) {
        iVar12 = FUN_0002c364();
        if (iVar12 != 0) {
            uVar4 = 0x1bf;
            goto LAB_0002c7fc;
        }
        uVar4 = 0;
        goto LAB_0002ca00;
    }
    ppuVar5 = __ctype_b_loc();
    iVar12 = old_config_style;
    if (((*ppuVar5)[uVar4] & 0x2000) == 0) {
        if (old_config_style == 0) {
            if (uVar4 != 0x3b)
                goto LAB_0002c6b0;
            goto LAB_0002c7e8;
        }
        if (uVar4 == 10)
            goto LAB_0002c7e8;
    LAB_0002c6b0:
        pcVar6 = strchr(special_chars, uVar4);
        iVar7 = DAT_000c93d8;
        if ((pcVar6 == (char *)0x0) || (DAT_000c93dc != 0)) {
            iVar16 = 0;
            FUN_0002bc38(uVar4, DAT_000c93d8);
            *(undefined4 *)(iVar7 + 0x20) = *(undefined4 *)(iVar7 + 0x10);
            *(undefined4 *)(iVar7 + 0x24) = *(undefined4 *)(iVar7 + 0x14);
            puVar13 = yytext;
            puVar17 = puVar13;
            while (iVar7 = FUN_0002be54(iVar7), iVar7 != -1) {
                *puVar17 = (char)iVar7;
                if (((*ppuVar5)[iVar7] & 0x2000) != 0) {
                    if (iVar7 == 0x22) {
                    LAB_0002c8c0:
                        puVar17 = (undefined1 *)((int)&yynerrs + iVar16 + 3);
                        iVar12 = DAT_000c93d8;
                        goto LAB_0002c904;
                    }
                    break;
                }
                if (old_config_style == 0) {
                    if (iVar7 == 0x3b)
                        break;
                } else if (iVar7 == 10)
                    break;
                if (iVar7 == 0x22)
                    goto LAB_0002c8c0;
                if ((DAT_000c93dc == 0) &&
                    (pcVar6 = strchr(special_chars, iVar7),
                     pcVar6 != (char *)0x0))
                    break;
                if (iVar7 == 0x23)
                    goto LAB_0002c960;
                iVar16 = iVar16 + 1;
                iVar7 = DAT_000c93d8;
                iVar12 = DAT_000c93d8;
                puVar17 = puVar17 + 1;
                if (iVar16 == 0x401)
                    goto LAB_0002c9bc;
            }
            goto LAB_0002c834;
        }
        if ((uVar4 == 0x3d) && (iVar12 != 0)) {
            DAT_000c93dc = 1;
        }
        yytext[0] = (byte)uVar4;
        yytext[1] = 0;
        goto LAB_0002c7fc;
    }
    iVar12 = DAT_000c93d8;
    if (old_config_style == 0) {
        if (uVar4 != 0x3b)
            goto LAB_0002c648;
    } else if (uVar4 != 10)
        goto LAB_0002c648;
LAB_0002c7e8:
    uVar4 = 0x1bf;
    DAT_000c93dc = 0;
    goto LAB_0002c7fc;
LAB_0002c904:
    iVar7 = FUN_0002be54(iVar12);
    iVar12 = DAT_000c93d8;
    if (iVar7 == -1)
        goto code_r0x0002c914;
    if (iVar7 == 0x22 || iVar7 == 10) {
        if (iVar7 == 0x22) {
            bVar3 = true;
            iVar7 = FUN_0002be54();
        } else {
            bVar3 = true;
        }
        goto LAB_0002c834;
    }
    iVar16 = iVar16 + 1;
    puVar17 = puVar17 + 1;
    *puVar17 = (char)iVar7;
    if (iVar16 == 0x401)
        goto LAB_0002c9bc;
    goto LAB_0002c904;
code_r0x0002c914:
    bVar3 = true;
    goto LAB_0002c834;
    while (iVar7 != 10) {
    LAB_0002c960:
        iVar7 = FUN_0002be54();
        if (iVar7 == -1)
            break;
    }
LAB_0002c834:
    iVar12 = DAT_000c93d8;
    FUN_0002bc38(iVar7, DAT_000c93d8);
    yytext[iVar16] = 0;
    if (iVar16 != 0)
        goto code_r0x0002c85c;
    goto LAB_0002c648;
LAB_0002c9bc:
    yytext[0x32] = 0;
    FUN_00074e00(3,
                 "configuration item on line %d longer than limit of %lu, "
                 "began with \'%s\'",
                 *(undefined4 *)(iVar12 + 0x10), 0x32, yytext);
    iVar12 = FUN_0002c450();
    if (iVar12 != 0) {
        /* WARNING: Subroutine does not return */
        exit(0x400);
    }
    goto LAB_0002c9f8;
code_r0x0002c85c:
    uVar19 = (uint)yytext[0];
    if (DAT_000c93dc == 0 && !bVar3) {
        if (uVar19 == 0) {
        LAB_0002ce00:
            iVar12 = sscanf(yytext, "%u", &local_30);
            if (iVar12 == 1) {
                if (-1 < local_30)
                    goto LAB_0002ccd8;
                uVar19 = (uint)yytext[0];
            } else {
                uVar19 = (uint)yytext[0];
            }
        LAB_0002cb48:
            if (uVar19 == 0x30) {
                pp_Var8 = __ctype_tolower_loc();
                if ((*pp_Var8)[yytext[1]] != 0x78)
                    goto LAB_0002cb58;
                uVar4 = (uint)yytext[2];
                if (uVar4 != 0) {
                    iVar12 = 2;
                    bVar3 = true;
                    goto LAB_0002cb60;
                }
            LAB_0002cdb8:
                pp_Var8 = __ctype_tolower_loc();
                if ((*pp_Var8)[yytext[1]] != 0x78)
                    goto LAB_0002cd50;
                iVar12 = sscanf(yytext + 2, "%x", &yylval);
            } else {
                if (uVar19 != 0) {
                LAB_0002cb58:
                    iVar12 = 0;
                    bVar3 = false;
                    uVar4 = uVar19;
                LAB_0002cb60:
                    puVar18 = *ppuVar5;
                    pbVar15 = yytext + iVar12;
                    do {
                        if (bVar3) {
                            uVar2 = puVar18[(short)uVar4] & 0x1000;
                        } else {
                            uVar2 = puVar18[(short)uVar4] & 0x800;
                        }
                        if (uVar2 == 0) {
                            uVar4 = (uint)((uVar19 - 0x2b & 0xfd) == 0);
                            uVar19 = (uint)(byte)yytext[uVar4];
                            pbVar15 = yytext + uVar4;
                            if (uVar19 == 0)
                                goto LAB_0002c898;
                            iVar12 = 0;
                            goto LAB_0002cbdc;
                        }
                        pbVar15 = pbVar15 + 1;
                        uVar4 = (uint)*pbVar15;
                    } while (uVar4 != 0);
                    if (uVar19 == 0x30)
                        goto LAB_0002cdb8;
                }
            LAB_0002cd50:
                iVar12 = sscanf(yytext, "%u", &yylval);
            }
            if (iVar12 == 1) {
                uVar4 = 0x1b2;
                goto LAB_0002ca00;
            }
            pcVar6 = "U_int cannot be represented: %s";
        } else {
            uVar14 = 0x74eeb779;
            uVar4 = 0x3ac;
            uVar11 = uVar19;
            while (true) {
                puVar13 = puVar13 + 1;
                while (uVar11 != (uVar14 & 0xff)) {
                    uVar4 = uVar14 >> 0x15;
                    if (uVar4 == 0)
                        goto LAB_0002cb00;
                    uVar14 = *(uint *)(sst + uVar4 * 4);
                }
                uVar11 = (uint)(byte)*puVar13;
                if (uVar11 == 0)
                    break;
                uVar4 = (uVar14 << 0xb) >> 0x15;
                if (uVar4 == 0)
                    goto LAB_0002cb00;
                uVar14 = *(uint *)(sst + uVar4 * 4);
            }
            uVar14 = (uVar14 << 0x16) >> 0x1e;
            if (uVar14 != 3) {
                DAT_000c93dc = uVar14;
                if ((uVar4 == 0x197) && (old_config_style == 0)) {
                    DAT_000c93dc = 0;
                }
                goto LAB_0002c7fc;
            }
        LAB_0002cb00:
            uVar4 = (uint)(byte)yytext[uVar19 == 0x2d];
            pbVar15 = yytext + (uVar19 == 0x2d);
            if (uVar4 != 0) {
                do {
                    if (((*ppuVar5)[uVar4] & 0x800) == 0)
                        goto LAB_0002cb48;
                    pbVar15 = pbVar15 + 1;
                    uVar4 = (uint)*pbVar15;
                } while (uVar4 != 0);
            }
            if (uVar19 != 0x2d)
                goto LAB_0002ce00;
        LAB_0002ccd8:
            piVar10 = __errno_location();
            *piVar10 = 0;
            lVar9 = strtol(yytext, (char **)0x0, 10);
            yylval = (double)CONCAT44(yylval._4_4_, lVar9);
            if ((lVar9 != 0) || (*piVar10 != 0x22 && *piVar10 != 0x16)) {
                uVar4 = 0x13f;
                goto LAB_0002ca00;
            }
            pcVar6 = "Integer cannot be represented: %s";
        }
        FUN_00074e00(3, pcVar6, yytext);
        iVar12 = FUN_0002c450();
        if (iVar12 != 0)
            goto LAB_0002cd3c;
    LAB_0002c9f8:
        uVar4 = 0;
        yylval = (double)((ulonglong)yylval & 0xffffffff00000000);
        goto LAB_0002ca00;
    }
    if (uVar19 == 0x2d) {
        if (yytext[1] == 0x34) {
            uVar4 = 0x145;
        } else {
            if (yytext[1] != 0x36)
                goto LAB_0002c884;
            uVar4 = 0x147;
        }
    LAB_0002c7fc:
        yylval = (double)CONCAT44(yylval._4_4_, uVar4);
        goto LAB_0002ca00;
    }
LAB_0002c884:
    if (DAT_000c93dc == 1) {
        DAT_000c93dc = 0;
    }
    goto LAB_0002c898;
    while (true) {
        pbVar15 = pbVar15 + 1;
        uVar19 = (uint)*pbVar15;
        iVar12 = iVar12 + 1;
        if (uVar19 == 0)
            break;
    LAB_0002cbdc:
        iVar7 = uVar4 + iVar12;
        if ((puVar18[uVar19] & 0x800) == 0) {
            if (uVar19 != 0x2e)
                goto LAB_0002cbf8;
            bVar1 = yytext[iVar7 + 1];
            pbVar15 = yytext + iVar7 + 1;
            goto joined_r0x0002ce5c;
        }
    }
LAB_0002ce8c:
    piVar10 = __errno_location();
    *piVar10 = 0;
    yylval = strtod(yytext, (char **)0x0);
    if ((yylval == 0.0) && (*piVar10 == 0x22)) {
        FUN_00074e00(3, "Double too large to represent: %s", yytext);
    LAB_0002cd3c:
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    uVar4 = 0x121;
    goto LAB_0002ca00;
joined_r0x0002ce5c:
    if (bVar1 == 0)
        goto LAB_0002ce84;
    iVar7 = iVar7 + 1;
    if ((puVar18[bVar1] & 0x800) == 0)
        goto LAB_0002cbf8;
    pbVar15 = pbVar15 + 1;
    bVar1 = *pbVar15;
    iVar12 = iVar12 + 1;
    goto joined_r0x0002ce5c;
LAB_0002ce84:
    if (iVar12 != 0)
        goto LAB_0002ce8c;
    goto LAB_0002c898;
LAB_0002cbf8:
    if (iVar12 != 0) {
        bVar1 = yytext[iVar7];
        if (bVar1 == 0)
            goto LAB_0002ce8c;
        pp_Var8 = __ctype_tolower_loc();
        if ((*pp_Var8)[bVar1] == 0x65) {
            iVar12 = iVar7 + 1;
            if ((yytext[iVar7 + 1] - 0x2b & 0xfd) == 0) {
                iVar12 = iVar7 + 2;
            }
            pbVar15 = (byte *)((int)&yynerrs + iVar12 + 3);
            do {
                pbVar15 = pbVar15 + 1;
                if (*pbVar15 == 0)
                    goto LAB_0002ce8c;
            } while ((puVar18[*pbVar15] & 0x800) != 0);
        }
    }
LAB_0002c898:
    uVar4 = FUN_0002bffc();
LAB_0002ca00:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_0002d284(int *param_1, int *param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;

    iVar2 = __stack_chk_guard;
    iVar3 = *param_1;
    iVar4 = *param_2;
    if (DAT_000c93e8 == 0) {
        DAT_000c93ec = FUN_00078a44(ntpdOptions);
        iVar3 = *param_1;
        iVar4 = *param_2;
    }
    iVar1 = DAT_000c93ec * 4;
    *param_1 = iVar3 - DAT_000c93ec;
    *param_2 = iVar4 + iVar1;
    DAT_000c93e8 = 1;
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0002e008(int param_1, undefined4 param_2)

{
    long lVar1;
    size_t sVar2;
    uint uVar3;
    int iVar4;
    char *pcVar5;
    int *piVar6;
    undefined4 local_38[3];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (ipv4_works == 0) {
        if (ipv6_works == 0) {
            FUN_00074e00(3,
                         "Neither IPv4 nor IPv6 networking detected, fatal.");
            /* WARNING: Subroutine does not return */
            exit(1);
        }
        if ((*(uint *)(ntpdOptions._68_4_ + 0x10) & 0xf) != 0) {
            FUN_00074e00(4, "-4/--ipv4 ignored, IPv4 networking not found.");
        }
    } else if (ipv6_works == 0) {
        if ((*(uint *)(ntpdOptions._68_4_ + 0x50) & 0xf) != 0) {
            FUN_00074e00(4, "-6/--ipv6 ignored, IPv6 networking not found.");
            uVar3 = *(uint *)(ntpdOptions._68_4_ + 0x90);
            goto joined_r0x0002e2d4;
        }
    } else if ((*(uint *)(ntpdOptions._68_4_ + 0x10) & 0xf) == 0) {
        if ((*(uint *)(ntpdOptions._68_4_ + 0x50) & 0xf) != 0) {
            ipv4_works = 0;
        }
    } else {
        ipv6_works = 0;
    }
    uVar3 = *(uint *)(ntpdOptions._68_4_ + 0x90);
joined_r0x0002e2d4:
    if ((uVar3 & 0xf) == 0) {
        if ((*(uint *)(ntpdOptions._68_4_ + 0xd0) & 0xf) != 0) {
            FUN_00048810(0, 3, 0);
        }
        uVar3 = *(uint *)(ntpdOptions._68_4_ + 0x110);
    } else {
        FUN_00048810(0, 3, 1, 0);
        uVar3 = *(uint *)(ntpdOptions._68_4_ + 0x110);
    }
    if ((uVar3 & 0xf) != 0) {
        FUN_00048810(0, 1, 1, 0);
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x150) & 0xf) != 0) {
        config_file = *(undefined4 *)(ntpdOptions._68_4_ + 0x158);
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x210) & 0xf) != 0) {
        FUN_0005294c(1, *(undefined4 *)(ntpdOptions._68_4_ + 0x218));
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x250) & 0xf) != 0) {
        allow_panic = 1;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x290) & 0xf) != 0) {
        force_step_once = 1;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x350) & 0xf) != 0) {
        FUN_00052744(*(undefined4 *)(ntpdOptions._68_4_ + 0x358));
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x4d0) & 0xf) != 0) {
        FUN_0005294c(3, *(undefined4 *)(ntpdOptions._68_4_ + 0x4d8));
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x550) & 0xf) != 0) {
        mode_ntpdate = 1;
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x590) & 0xf) != 0) {
        pcVar5 = *(char **)(ntpdOptions._68_4_ + 0x598);
        iVar4 = sscanf(pcVar5, "%lf", local_38);
        if (iVar4 == 1) {
            FUN_00048810(local_38[0], 4, 0);
        } else {
            FUN_00074e00(3, "command line broadcast delay value %s undecodable",
                         pcVar5);
        }
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x610) & 0xf) != 0) {
        FUN_0005294c(2, *(undefined4 *)(ntpdOptions._68_4_ + 0x618));
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x650) & 0xf) != 0) {
        iVar4 = **(int **)(ntpdOptions._68_4_ + 0x65c);
        piVar6 = *(int **)(ntpdOptions._68_4_ + 0x65c) + 2;
        do {
            while (true) {
                pcVar5 = (char *)*piVar6;
                lVar1 = strtol(pcVar5, (char **)0x0, 10);
                if (0xfffe < lVar1 - 1U)
                    break;
                iVar4 = iVar4 + -1;
                FUN_000721bc(lVar1, 1);
                piVar6 = piVar6 + 1;
                if (iVar4 < 1)
                    goto LAB_0002e1ac;
            }
            iVar4 = iVar4 + -1;
            FUN_00074e00(3, "command line trusted key %s is invalid", pcVar5);
            piVar6 = piVar6 + 1;
        } while (0 < iVar4);
    }
LAB_0002e1ac:
    if ((*(uint *)(ntpdOptions._68_4_ + 0x710) & 0xf) != 0) {
        iVar4 = **(int **)(ntpdOptions._68_4_ + 0x71c);
        piVar6 = *(int **)(ntpdOptions._68_4_ + 0x71c) + 2;
        do {
            pcVar5 = (char *)*piVar6;
            iVar4 = iVar4 + -1;
            sVar2 = strlen(pcVar5);
            FUN_000345c4(pcVar5, sVar2 + 1, 3);
            piVar6 = piVar6 + 1;
        } while (0 < iVar4);
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 0x750) & 0xf) != 0) {
        iVar4 = **(int **)(ntpdOptions._68_4_ + 0x75c);
        piVar6 = *(int **)(ntpdOptions._68_4_ + 0x75c) + 2;
        do {
            pcVar5 = (char *)*piVar6;
            iVar4 = iVar4 + -1;
            sVar2 = strlen(pcVar5);
            FUN_000345c4(pcVar5, sVar2 + 1, 0x23);
            piVar6 = piVar6 + 1;
        } while (0 < iVar4);
    }
    if ((*(uint *)(ntpdOptions._68_4_ + 2000) & 0xf) != 0) {
        FUN_000405f8(0, 3);
    }
    iVar4 = interface_interval;
    if (((*(uint *)(ntpdOptions._68_4_ + 0x6d0) & 0xf) == 0) ||
        (iVar4 = *(int *)(ntpdOptions._68_4_ + 0x6d8), -1 < iVar4)) {
        interface_interval = iVar4;
        if (0 < param_1) {
            cmdline_server_count = param_1;
            cmdline_servers = param_2;
        }
    } else {
        __fprintf_chk(
            stderr, 1,
            "command line interface update interval %ld must not be negative\n",
            iVar4);
        FUN_00074e00(
            3,
            "command line interface update interval %ld must not be negative",
            iVar4);
        if (0 < param_1) {
            cmdline_server_count = param_1;
            cmdline_servers = param_2;
        }
        FUN_00099be8(ntpdOptions, 2);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002e508(short *param_1, undefined4 param_2, undefined4 param_3)

{
    EVP_MD_CTX *ctx;
    char *name;
    EVP_MD *type;
    short *d;
    size_t cnt;
    undefined4 local_68;
    undefined4 local_64;
    uint uStack_60;
    undefined4 local_5c[16];
    int local_1c;

    local_1c = __stack_chk_guard;
    local_68 = param_3;
    local_64 = param_2;
    while (
        (DAT_000c93f4 == 0 || (0xe0f < (uint)(current_time - DAT_000c9404)))) {
        DAT_000c93f4 = FUN_00078ae4();
        DAT_000c93f8 = FUN_00078ae4();
        DAT_000c93fc = FUN_00078ae4();
        DAT_000c9400 = FUN_00078ae4();
        DAT_000c9404 = current_time;
    }
    ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
    EVP_MD_CTX_set_flags(ctx, 8);
    name = OBJ_nid2sn(4);
    type = EVP_get_digestbyname(name);
    EVP_DigestInit_ex(ctx, type, (ENGINE *)0x0);
    EVP_DigestUpdate(ctx, &DAT_000c93f4, 0x10);
    EVP_DigestUpdate(ctx, &local_64, 4);
    EVP_DigestUpdate(ctx, &local_68, 4);
    if (*param_1 == 2) {
        cnt = 4;
        d = param_1 + 2;
    } else {
        cnt = 0x10;
        d = param_1 + 4;
    }
    EVP_DigestUpdate(ctx, d, cnt);
    EVP_DigestUpdate(ctx, param_1 + 1, 2);
    EVP_DigestUpdate(ctx, &DAT_000c93f4, 0x10);
    EVP_DigestFinal(ctx, (uchar *)local_5c, &uStack_60);
    EVP_MD_CTX_free(ctx);
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(local_5c[0]);
    }
    return;
}

void FUN_0002e688(int param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    undefined4 uVar2;

    iVar1 = __stack_chk_guard;
    uVar2 = FUN_0002e508(param_1 + 4, *(undefined4 *)(param_1 + 0x48),
                         *(undefined4 *)(param_1 + 0x4c));
    FUN_0007c054(param_2, param_3, "%08x%08x%08x",
                 *(undefined4 *)(param_1 + 0x48),
                 *(undefined4 *)(param_1 + 0x4c), uVar2);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002e710(short *param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;
    undefined1 *puVar4;

    iVar1 = __stack_chk_guard;
    iVar3 = 0;
    puVar4 = ctl_traps;
    do {
        if ((((*(byte *)((int)puVar4 + 0x32) & 1) != 0) &&
             (param_1[1] == *(short *)((int)puVar4 + 2))) &&
            (*(short *)puVar4 == *param_1)) {
            if (*(short *)puVar4 == 2) {
                if (*(int *)(param_1 + 2) == *(int *)((int)puVar4 + 4))
                    goto LAB_0002e7e4;
            } else {
                iVar2 = memcmp(param_1 + 4, ctl_traps + iVar3 * 0x34 + 8, 0x10);
                if ((iVar2 == 0) &&
                    (*(int *)(param_1 + 0xc) == *(int *)((int)puVar4 + 0x18))) {
                LAB_0002e7e4:
                    if (*(int *)((int)puVar4 + 0x1c) == param_2) {
                        puVar4 = ctl_traps + iVar3 * 0x34;
                        goto LAB_0002e784;
                    }
                }
            }
        }
        iVar3 = iVar3 + 1;
        puVar4 = (undefined1 *)((int)puVar4 + 0x34);
    } while (iVar3 != 3);
    puVar4 = (undefined1 *)0x0;
LAB_0002e784:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(puVar4);
    }
    return;
}

void FUN_0002e820(undefined *param_1, undefined4 *param_2)

{
    ushort uVar1;
    bool bVar2;
    int iVar3;
    ushort **ppuVar4;
    ushort *puVar5;
    undefined4 uVar6;
    byte *pbVar7;
    byte bVar8;
    byte *pbVar9;
    undefined *puVar10;
    byte *pbVar11;
    byte *pbVar12;
    byte *pbVar13;
    uint uVar14;
    byte *pbVar15;
    byte *pbVar16;

    iVar3 = __stack_chk_guard;
    pbVar13 = DAT_000c940c;
    if (DAT_000c9408 < DAT_000c940c) {
        bVar2 = false;
        pbVar11 = DAT_000c9408;
        do {
            pbVar9 = pbVar11 + 1;
            uVar14 = (uint)*pbVar11;
            if (uVar14 != 0x2c) {
                ppuVar4 = __ctype_b_loc();
                puVar5 = *ppuVar4;
                if ((puVar5[uVar14] & 0x2000) == 0) {
                    if (bVar2) {
                        DAT_000c9408 = pbVar11;
                    }
                    if (pbVar13 <= pbVar11)
                        goto LAB_0002e8ac;
                    pbVar9 = (byte *)0x0;
                    pbVar7 = pbVar11;
                    goto LAB_0002e900;
                }
            }
            bVar2 = true;
            pbVar11 = pbVar9;
        } while (pbVar13 != pbVar9);
        DAT_000c9408 = pbVar13;
    }
LAB_0002e8ac:
    param_1 = (undefined *)0x0;
    goto LAB_0002e8b0;
LAB_0002e900:
    if (uVar14 == 0x3d) {
        if (pbVar9 == (byte *)0x0) {
            pbVar9 = pbVar7;
        }
    } else {
        pbVar12 = pbVar7;
        if (uVar14 == 0x2c)
            goto LAB_0002e920;
    }
    pbVar12 = pbVar13;
    if (pbVar13 + -1 == pbVar7)
        goto LAB_0002e920;
    pbVar7 = pbVar7 + 1;
    uVar14 = (uint)*pbVar7;
    goto LAB_0002e900;
LAB_0002e920:
    uVar14 = 0;
    *param_2 = 0;
    pbVar7 = pbVar12;
    if (pbVar9 != (byte *)0x0) {
        pbVar7 = pbVar9 + 1;
        pbVar15 = pbVar7;
        if (pbVar7 != pbVar12) {
            do {
                pbVar7 = pbVar15;
                pbVar15 = pbVar7 + 1;
                uVar14 = puVar5[*pbVar7] & 0x2000;
                if ((puVar5[*pbVar7] & 0x2000) == 0) {
                    pbVar15 = pbVar12;
                    if (pbVar7 == pbVar12)
                        goto LAB_0002e9b0;
                    goto LAB_0002e98c;
                }
                pbVar7 = pbVar12;
            } while (pbVar12 != pbVar15);
            goto LAB_0002eaa0;
        }
        goto LAB_0002e9b0;
    }
    goto joined_r0x0002e9e4;
    while (pbVar15 = pbVar16, pbVar16 != pbVar7) {
    LAB_0002e98c:
        pbVar16 = pbVar15 + -1;
        if ((puVar5[pbVar15[-1]] & 0x2000) == 0) {
            uVar14 = (int)pbVar15 - (int)pbVar7;
            if (uVar14 < 0x80)
                goto LAB_0002e9b0;
            numctlbadpkts = numctlbadpkts + 1;
            if (((ntp_syslogmask & 2) != 0) && (DAT_000c9490 <= current_time)) {
                DAT_000c9490 = current_time + 300;
                uVar6 = FUN_0007c2e8(DAT_000c9494);
                FUN_00074e00(
                    4,
                    "Possible \'ntpdx\' exploit from %s#%u (possibly spoofed)",
                    uVar6,
                    *(ushort *)(DAT_000c9494 + 2) << 8 |
                        *(ushort *)(DAT_000c9494 + 2) >> 8);
                pbVar13 = DAT_000c940c;
            }
            param_1 = (undefined *)0x0;
            DAT_000c9408 = pbVar13;
            goto LAB_0002e8b0;
        }
    }
LAB_0002eaa0:
    uVar14 = 0;
LAB_0002e9b0:
    __memcpy_chk(&DAT_000c9410, pbVar7, uVar14, 0x80);
    (&DAT_000c9410)[uVar14] = 0;
    *param_2 = &DAT_000c9410;
    pbVar7 = pbVar9;
joined_r0x0002e9e4:
    if (param_1 == (undefined *)0x0) {
        param_1 = &DAT_000a3b9c;
    } else {
        uVar1 = *(ushort *)(param_1 + 2);
        if ((uVar1 & 0x80) == 0) {
            do {
                if ((uVar1 & 0x40) == 0) {
                    pbVar9 = *(byte **)(param_1 + 4);
                    bVar8 = *pbVar9;
                    if (pbVar11 == pbVar7) {
                    LAB_0002ea60:
                        if (bVar8 == 0x3d || bVar8 == 0) {
                            DAT_000c9408 = pbVar12;
                            if (pbVar13 != pbVar12) {
                                DAT_000c9408 = pbVar12 + 1;
                            }
                            goto LAB_0002e8b0;
                        }
                    } else if ((bVar8 != 0) &&
                               (pbVar15 = pbVar11, *pbVar11 == bVar8)) {
                        do {
                            pbVar9 = pbVar9 + 1;
                            bVar8 = *pbVar9;
                            if (pbVar7 + -1 == pbVar15)
                                goto LAB_0002ea60;
                        } while ((bVar8 != 0) &&
                                 (pbVar15 = pbVar15 + 1, *pbVar15 == bVar8));
                    }
                }
                puVar10 = param_1 + 8;
                uVar1 = *(ushort *)(param_1 + 10);
                param_1 = puVar10;
            } while ((uVar1 & 0x80) == 0);
        }
        *param_2 = 0;
    }
LAB_0002e8b0:
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0002eba4(int param_1)

{
    uint *puVar1;
    uint *puVar2;
    uint uVar3;
    int iVar4;
    uint *puVar5;
    undefined1 *puVar6;
    uint *puVar7;
    int iVar8;

    iVar4 = __stack_chk_guard;
    puVar7 = DAT_000c9498 + -0x3252a;
    if (((param_1 == 0) && (DAT_000c96a0 != 0)) &&
        ((uint *)((int)DAT_000c9498 + -0xc94a6) < (uint *)0x1d4)) {
        *(undefined1 *)DAT_000c9498 = 0xd;
        *(undefined1 *)((int)DAT_000c9498 + 1) = 10;
        puVar7 = (uint *)((int)DAT_000c9498 + -0xc94a6);
        DAT_000c9498 = (uint *)((int)DAT_000c9498 + 2);
    }
    for (puVar5 = puVar7 + 3; ((uint)puVar5 & 3) != 0;
         puVar5 = (uint *)((int)puVar5 + 1)) {
        *(undefined1 *)DAT_000c9498 = 0;
        DAT_000c9498 = (uint *)((int)DAT_000c9498 + 1);
    }
    DAT_000c94a6 = (ushort)(((uint)puVar7 & 0xff) << 8) |
                   (ushort)((uint)puVar7 >> 8) & 0xff;
    DAT_000c94a4 = (ushort)(((uint)DAT_000c96a8 & 0xff) << 8) |
                   (ushort)((uint)DAT_000c96a8 >> 8) & 0xff;
    DAT_000c949d =
        (byte)param_1 |
        ~((byte) ~(byte)(((DAT_000c96a4 & 0x1f) << 0x19) >> 0x18) >> 1);
    if (DAT_000c96ac == '\0') {
        if ((DAT_000c96ad == '\0') ||
            (puVar1 = puVar5, puVar2 = DAT_000c9498, uVar3 = DAT_000c96b0,
             sys_authenticate == 0)) {
            FUN_00026a68(DAT_000c9494, DAT_000c96b4, 0xfffffffa, &DAT_000c949c,
                         puVar5);
        } else {
            while (DAT_000c96b0 = uVar3, ((uint)puVar1 & 7) != 0) {
                *(undefined1 *)puVar2 = 0;
                puVar1 = (uint *)((((int)puVar2 + 1) - (int)DAT_000c9498) +
                                  (int)puVar5);
                puVar2 = (uint *)((int)puVar2 + 1);
                uVar3 = DAT_000c96b0;
            }
            DAT_000c9498 = puVar2;
            *puVar2 = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                      (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
            iVar8 = FUN_0007278c(uVar3, &DAT_000c949c, puVar1);
            FUN_00026a68(DAT_000c9494, DAT_000c96b4, 0xfffffffb, &DAT_000c949c,
                         (undefined1 *)(iVar8 + (int)puVar1));
        }
        if (param_1 == 0) {
            numctlresponses = numctlresponses + 1;
        } else {
            numctlfrags = numctlfrags + 1;
        }
    } else {
        iVar8 = 0;
        puVar6 = ctl_traps;
        do {
            if ((puVar6[0x32] & 1) != 0) {
                DAT_000c949e = *(ushort *)(puVar6 + 0x30) << 8 |
                               *(ushort *)(puVar6 + 0x30) >> 8;
                DAT_000c949c = sys_leap << 6 | 6U | (puVar6[0x33] & 7) << 3;
                FUN_00026a68(puVar6, *(undefined4 *)(puVar6 + 0x1c), 0xfffffffc,
                             &DAT_000c949c, puVar5);
                if (param_1 == 0) {
                    *(short *)(puVar6 + 0x30) = *(short *)(puVar6 + 0x30) + 1;
                }
                numasyncmsgs = numasyncmsgs + 1;
            }
            iVar8 = iVar8 + 1;
            puVar6 = puVar6 + 0x34;
        } while (iVar8 != 3);
    }
    DAT_000c96a8 = (undefined1 *)((int)DAT_000c96a8 + (int)puVar7);
    DAT_000c9498 = (uint *)&DAT_000c94a8;
    DAT_000c96b8 = DAT_000c96b8 + 1;
    if (iVar4 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002eec8(int *param_1, int param_2, int param_3)

{
    int *piVar1;
    undefined1 *puVar2;
    int iVar3;
    void *pvVar4;
    int iVar5;
    int *piVar6;
    uint __n;
    size_t __n_00;
    void *pvVar7;
    int iVar8;

    iVar3 = __stack_chk_guard;
    if (param_3 == 0) {
        iVar5 = param_2 * 8;
        DAT_000c96a0 = 1;
        if (DAT_000c96bc == 0) {
            iVar8 = 3;
        } else {
            *DAT_000c9498 = 0x2c;
            iVar8 = 0;
            piVar6 = param_1;
            do {
                piVar1 = piVar6 + 1;
                piVar6 = piVar6 + 2;
                iVar8 = iVar8 + *piVar1;
            } while (param_1 + param_2 * 2 != piVar6);
            if ((uint)(DAT_000c96c0 + 2 + iVar8) < 0x48) {
                DAT_000c96c0 = DAT_000c96c0 + 2;
                DAT_000c9498[1] = 0x20;
                iVar8 = 3;
                DAT_000c9498 = DAT_000c9498 + 2;
            } else {
                DAT_000c9498[1] = 0xd;
                iVar8 = 3;
                DAT_000c96c0 = 0;
                puVar2 = DAT_000c9498 + 2;
                DAT_000c9498 = DAT_000c9498 + 3;
                *puVar2 = 10;
            }
        }
    } else {
        iVar5 = param_2 << 3;
        iVar8 = 0;
    }
    piVar6 = (int *)((int)param_1 + iVar5);
    do {
        pvVar7 = (void *)*param_1;
        __n_00 = param_1[1];
        if (__n_00 != 0 && pvVar7 != (void *)0x0) {
            __n = DAT_000c96c4 - (int)DAT_000c9498;
            if (__n < iVar8 + __n_00) {
                do {
                    if (__n_00 <= __n) {
                        __n = __n_00;
                    }
                    __n_00 = __n_00 - __n;
                    pvVar4 = memcpy(DAT_000c9498, pvVar7, __n);
                    DAT_000c9498 = (undefined1 *)((int)pvVar4 + __n);
                    pvVar7 = (void *)((int)pvVar7 + __n);
                    DAT_000c96c0 = DAT_000c96c0 + __n;
                    FUN_0002eba4(0x20);
                    __n = DAT_000c96c4 - (int)DAT_000c9498;
                } while (__n < iVar8 + __n_00);
            }
            pvVar7 = memcpy(DAT_000c9498, pvVar7, __n_00);
            DAT_000c9498 = (undefined1 *)((int)pvVar7 + __n_00);
            DAT_000c96bc = 1;
            DAT_000c96c0 = DAT_000c96c0 + __n_00;
        }
        param_1 = param_1 + 2;
    } while (piVar6 != param_1);
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0002f0e4(char *param_1, int param_2, int param_3)

{
    undefined4 uVar1;
    int iVar2;
    bool bVar3;
    char *local_2c;
    size_t local_28;
    undefined *local_24;
    undefined4 local_20;
    int local_1c;
    int local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    local_2c = param_1;
    local_28 = strlen(param_1);
    iVar2 = param_3;
    if (param_3 != 0) {
        iVar2 = 1;
    }
    if (param_2 == 0) {
        iVar2 = 0;
    }
    bVar3 = iVar2 != 0;
    local_24 = &DAT_000a3d0c;
    if (bVar3) {
        iVar2 = 0;
    }
    local_20 = 1;
    if (bVar3) {
        uVar1 = 3;
    } else {
        uVar1 = 2;
    }
    if (bVar3) {
        local_1c = param_2;
        local_18 = param_3;
    }
    FUN_0002eec8(&local_2c, uVar1, iVar2);
    if (local_14 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0002f188(undefined4 param_1, undefined4 param_2, int param_3)

{
    int iVar1;
    char *__s;
    size_t sVar2;

    iVar1 = __stack_chk_guard;
    if (param_3 == 0) {
        __s = (char *)FUN_000796ec(param_2);
    } else {
        __s = (char *)FUN_0007c2e8(param_3);
    }
    sVar2 = strlen(__s);
    if (iVar1 == __stack_chk_guard) {
        FUN_0002f0e4(param_1, __s, sVar2);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f20c(undefined4 param_1, undefined4 param_2)

{
    ushort **ppuVar1;
    uint uVar2;
    int iVar3;
    byte *pbVar4;
    undefined4 local_28;
    int local_24;

    iVar3 = 0;
    local_28 = param_2;
    local_24 = __stack_chk_guard;
    pbVar4 = (byte *)&local_28;
    do {
        uVar2 = (uint)*pbVar4;
        if (uVar2 == 0)
            break;
        ppuVar1 = __ctype_b_loc();
        iVar3 = iVar3 + 1;
        if (((*ppuVar1)[uVar2] & 0x6000) != 0x4000 || uVar2 == 0x2c) {
            *pbVar4 = 0x2e;
        }
        pbVar4 = pbVar4 + 1;
    } while (iVar3 != 4);
    FUN_0002f0e4(param_1, &local_28, iVar3);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f2c0(char *param_1, int param_2, int param_3)

{
    int iVar1;
    char *local_34;
    size_t local_30;
    undefined *local_2c;
    undefined4 local_28;
    int local_24;
    int local_20;
    undefined *local_1c;
    undefined4 local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    local_34 = param_1;
    local_30 = strlen(param_1);
    iVar1 = param_3;
    if (param_3 != 0) {
        iVar1 = 1;
    }
    if (param_2 == 0) {
        iVar1 = 0;
    }
    if (iVar1 == 0) {
        local_28 = 3;
        local_2c = &DAT_000a3d14;
        FUN_0002eec8(&local_34, 2);
    } else {
        local_2c = &DAT_000a3d10;
        local_1c = &DAT_000a8aac;
        local_28 = 2;
        local_18 = 1;
        local_24 = param_2;
        local_20 = param_3;
        FUN_0002eec8(&local_34, 4, 0);
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f3a0(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    uint uVar1;
    char *local_ac;
    size_t local_a8;
    char acStack_a4[122];
    undefined4 local_2a;
    undefined2 local_26;
    int local_24;
    undefined4 uStack_c;
    undefined4 uStack_8;
    undefined4 uStack_4;

    local_24 = __stack_chk_guard;
    uStack_c = param_2;
    uStack_8 = param_3;
    uStack_4 = param_4;
    uVar1 = FUN_0007b6f8(acStack_a4, 0x80, param_1, &uStack_c, &uStack_c);
    if (0x7f < uVar1) {
        local_2a = 0x2e2e2e5b;
        local_26 = 0x5d;
    }
    local_a8 = strlen(acStack_a4);
    local_ac = acStack_a4;
    FUN_0002eec8(&local_ac, 1, 0);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002f4d0(ushort param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    DAT_000c94a0 = param_1 & 0xff;
    DAT_000c949d =
        ~((byte) ~(byte)(((DAT_000c96a4 & 0x1f) << 0x1a) >> 0x18) >> 2);
    DAT_000c94a6 = 0;
    numctlerrors = numctlerrors + 1;
    if ((DAT_000c96ad == '\0') || (sys_authenticate == 0)) {
        FUN_00026a68(DAT_000c9494, DAT_000c96b4, 0xfffffffd, &DAT_000c949c,
                     0xc);
    } else {
        iVar2 = FUN_0007278c(DAT_000c96b0, &DAT_000c949c, 0xc);
        FUN_00026a68(DAT_000c9494, DAT_000c96b4, 0xfffffffe, &DAT_000c949c,
                     iVar2 + 0xc);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0002f9f0) */

void FUN_0002f95c(int param_1)

{
    ushort *puVar1;
    uint uVar2;
    int iVar3;

    if (param_1 != 0) {
        uVar2 = *(ushort *)(param_1 + 2) & 0x80;
        iVar3 = param_1 + 8;
        if ((*(ushort *)(param_1 + 2) & 0x80) == 0) {
            do {
                puVar1 = (ushort *)(iVar3 + 2);
                uVar2 = uVar2 + 1;
                iVar3 = iVar3 + 8;
            } while ((*puVar1 & 0x80) == 0);
            if (0xffff < uVar2) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_control.c", 0x142d, 1,
                             "c <= (0x7fff * 2 + 1)");
            }
        }
    }
    return;
}

void FUN_0002fa04(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    undefined1 auStack_2c[24];
    int local_14;

    local_14 = __stack_chk_guard;
    uVar1 = FUN_0007c054(auStack_2c, 0x18, "0x%lx", param_2);
    if (0x17 < uVar1) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_control.c", 0x6d7, 2,
                     "rc >= 0 && (size_t)rc < sizeof(buffer)");
    }
    FUN_0002f0e4(param_1, auStack_2c, uVar1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002faa8(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    undefined1 auStack_2c[24];
    int local_14;

    local_14 = __stack_chk_guard;
    uVar1 = FUN_0007c054(auStack_2c, 0x18, &DAT_000a3f30, param_2);
    if (0x17 < uVar1) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_control.c", 0x6e9, 2,
                     "rc >= 0 && (size_t)rc < sizeof(buffer)");
    }
    FUN_0002f0e4(param_1, auStack_2c, uVar1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002fb4c(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    undefined1 auStack_2c[24];
    int local_14;

    local_14 = __stack_chk_guard;
    uVar1 = FUN_0007c054(auStack_2c, 0x18, "%lu", param_2);
    if (0x17 < uVar1) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_control.c", 0x692, 2,
                     "rc >= 0 && (size_t)rc < sizeof(buffer)");
    }
    FUN_0002f0e4(param_1, auStack_2c, uVar1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002fbf0(undefined4 param_1)

{
    uint uVar1;
    int iVar2;
    uint uVar3;
    char local_4c;
    char local_4b;
    char local_4a;
    undefined1 local_49;
    undefined1 auStack_48[28];
    int local_2c;

    local_2c = __stack_chk_guard;
    uVar1 = rand();
    iVar2 = rand();
    uVar3 = uVar1 ^ iVar2 << 0x10;
    local_4b = (char)((int)uVar3 >> 5) +
               (char)(((int)uVar3 >> 5) / 0x1a) * -0x1a + 'a';
    local_4c = (char)uVar1 + (char)((int)uVar3 / 0x1a) * -0x1a + 'a';
    local_4a = (char)((int)uVar3 >> 10) +
               (char)(((int)uVar3 >> 10) / 0x1a) * -0x1a + 'a';
    local_49 = 0x2e;
    FUN_0007c054(auStack_48, 0x1c, "%d", param_1);
    FUN_0002fb4c(&local_4c, (int)uVar3 >> 0xf);
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0002fccc(undefined4 param_1, undefined4 *param_2)

{
    uint uVar1;
    undefined1 auStack_2c[24];
    int local_14;

    local_14 = __stack_chk_guard;
    uVar1 =
        FUN_0007c054(auStack_2c, 0x18, "0x%08lx.%08lx", *param_2, param_2[1]);
    if (0x17 < uVar1) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_control.c", 0x6fd, 2,
                     "rc >= 0 && (size_t)rc < sizeof(buffer)");
    }
    FUN_0002f0e4(param_1, auStack_2c, uVar1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000300e4(undefined4 param_1, int param_2, undefined4 param_3)

{
    uint uVar1;
    undefined *puVar2;
    undefined1 auStack_3c[40];
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_2 == 0) {
        puVar2 = &DAT_000a3f70;
    } else {
        puVar2 = &DAT_000a3f68;
    }
    uVar1 = FUN_0007c054(auStack_3c, 0x28, puVar2, param_3);
    if (uVar1 < 0x28) {
        FUN_0002f0e4(param_1, auStack_3c, uVar1);
        if (local_14 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("ntp_control.c", 0x681, 2,
                 "rc >= 0 && (size_t)rc < sizeof(buffer)");
}

void FUN_000301a8(undefined4 param_1, undefined1 *param_2, int param_3)

{
    byte bVar1;
    size_t sVar2;
    void *pvVar3;
    char *pcVar4;
    char *pcVar5;
    ushort uVar6;
    int iVar7;
    undefined *puVar8;
    int iVar9;
    char *pcVar10;
    char *pcVar11;
    char *local_208;
    int local_204;
    char acStack_200[468];
    int local_2c[2];

    local_2c[0] = __stack_chk_guard;
    switch (param_1) {
    case 1:
        if (((param_3 != 0) || (*(char **)(param_2 + 0x20) == (char *)0x0)) ||
            (**(char **)(param_2 + 0x20) == '\0')) {
            FUN_0002fb4c("type", *param_2);
        }
        break;
    case 2:
        FUN_0002f2c0("timecode", *(undefined4 *)(param_2 + 8),
                     *(undefined2 *)(param_2 + 4));
        break;
    case 3:
        FUN_0002fb4c(&DAT_000a3f84, *(undefined4 *)(param_2 + 0xc));
        break;
    case 4:
        FUN_0002fb4c("noreply", *(undefined4 *)(param_2 + 0x10));
        break;
    case 5:
        FUN_0002fb4c("badformat", *(undefined4 *)(param_2 + 0x14));
        break;
    case 6:
        FUN_0002fb4c("baddata", *(undefined4 *)(param_2 + 0x18));
        break;
    case 7:
        if ((param_3 != 0) || ((param_2[2] & 1) != 0)) {
            FUN_000300e4(SUB84(*(double *)(param_2 + 0x28) * 1000.0, 0),
                         "fudgetime1", 1, 3);
        }
        break;
    case 8:
        if ((param_3 != 0) || ((param_2[2] & 2) != 0)) {
            FUN_000300e4(SUB84(*(double *)(param_2 + 0x30) * 1000.0, 0),
                         "fudgetime2", 1, 3);
        }
        break;
    case 9:
        if ((param_3 != 0) || ((param_2[2] & 4) != 0)) {
            FUN_0002faa8("stratum", *(undefined4 *)(param_2 + 0x38));
        }
        break;
    case 10:
        if ((param_3 != 0) || ((param_2[2] & 8) != 0)) {
            if (*(int *)(param_2 + 0x38) < 2) {
                FUN_0002f20c("refid", *(undefined4 *)(param_2 + 0x3c));
            } else {
                FUN_0002f188("refid", *(undefined4 *)(param_2 + 0x3c), 0);
            }
        }
        break;
    case 0xb:
        FUN_0002fb4c("flags", param_2[1]);
        break;
    case 0xc:
        pcVar10 = *(char **)(param_2 + 0x20);
        if ((pcVar10 == (char *)0x0) || (*pcVar10 == '\0')) {
            if (param_3 != 0) {
                FUN_0002f2c0("device", &DAT_000a7f7c, 0);
            }
        } else {
            sVar2 = strlen(pcVar10);
            FUN_0002f2c0("device", pcVar10, sVar2);
        }
        break;
    case 0xd:
        FUN_0007c054(acStack_200, 0x1d4, &DAT_000a3fd8, "clock_var_list");
        sVar2 = strlen(acStack_200);
        pcVar11 = acStack_200 + sVar2;
        uVar6 = 0;
        puVar8 = &DAT_000c3ef0;
        pcVar10 = pcVar11;
        while ((uVar6 & 0x80) == 0) {
            if ((uVar6 & 0x40) == 0) {
                pcVar4 = *(char **)(puVar8 + 0xc);
                sVar2 = strlen(pcVar4);
                if (local_2c <= pcVar10 + sVar2 + 1)
                    break;
                pcVar5 = pcVar11;
                if (pcVar10 != pcVar11) {
                    *pcVar10 = ',';
                    pcVar5 = pcVar10 + 1;
                }
                pcVar10 = pcVar5 + sVar2;
                memcpy(pcVar5, pcVar4, sVar2);
            }
            uVar6 = *(ushort *)(puVar8 + 0x12);
            puVar8 = puVar8 + 8;
        }
        iVar9 = *(int *)(param_2 + 0x44);
        if (iVar9 != 0) {
            uVar6 = *(ushort *)(iVar9 + 2);
            bVar1 = (byte)uVar6;
            if ((uVar6 & 0x80) == 0) {
                do {
                    if (((uVar6 & 0x40) == 0) &&
                        (pcVar4 = *(char **)(iVar9 + 4),
                         pcVar4 != (char *)0x0)) {
                        pcVar5 = pcVar4;
                        if (*pcVar4 == '=' || *pcVar4 == '\0') {
                            sVar2 = 0;
                            iVar7 = 1;
                        } else {
                            do {
                                pcVar5 = pcVar5 + 1;
                            } while (*pcVar5 != '\0' && *pcVar5 != '=');
                            sVar2 = (int)pcVar5 - (int)pcVar4;
                            iVar7 = sVar2 + 1;
                        }
                        if (local_2c <= pcVar10 + iVar7)
                            break;
                        pcVar5 = pcVar11;
                        if (pcVar11 != pcVar10) {
                            *pcVar10 = ',';
                            pcVar4 = *(char **)(iVar9 + 4);
                            pcVar5 = pcVar10 + 1;
                        }
                        pcVar10 = pcVar5 + sVar2;
                        pvVar3 = memcpy(pcVar5, pcVar4, sVar2);
                        *(byte *)((int)pvVar3 + sVar2) = bVar1 & 0x80;
                    }
                    if ((iVar9 + 8 == 0) ||
                        (uVar6 = *(ushort *)(iVar9 + 10), iVar9 = iVar9 + 8,
                         (uVar6 & 0x80) != 0))
                        break;
                } while (true);
            }
        }
        if (pcVar10 + 2 < local_2c) {
            *pcVar10 = '\"';
            pcVar10[1] = '\0';
            local_204 = (int)(pcVar10 + 1) - (int)acStack_200;
            local_208 = acStack_200;
            FUN_0002eec8(&local_208, 1, 0);
        }
    }
    if (local_2c[0] != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00030608(undefined4 param_1, int param_2, int param_3)

{
    uint uVar1;
    int iVar2;
    undefined1 *puVar3;
    int iVar4;
    bool bVar5;
    undefined1 auStack_fc[200];
    int local_34[2];

    local_34[0] = __stack_chk_guard;
    puVar3 = auStack_fc;
    iVar4 = param_3;
    while (true) {
        bVar5 = iVar4 != 0;
        if (bVar5) {
            iVar4 = iVar4 + -1;
            iVar2 = iVar4 * 8;
        } else {
            iVar2 = 0x38;
        }
        if (!bVar5) {
            iVar4 = 7;
        }
        uVar1 = FUN_0007c054(puVar3, (int)local_34 - (int)puVar3, " %.2f",
                             (double *)(param_2 + iVar2),
                             *(double *)(param_2 + iVar2) * 1000.0);
        if (((int)uVar1 < 0) || ((uint)((int)local_34 - (int)puVar3) <= uVar1))
            break;
        puVar3 = puVar3 + uVar1;
        if (param_3 == iVar4) {
            FUN_0002f0e4(param_1, auStack_fc, (int)puVar3 - (int)auStack_fc);
            if (local_34[0] != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("ntp_control.c", 0x746, 2,
                 "rc >= 0 && (size_t)rc < (size_t)(ep - cp)");
}

void FUN_0003071c(undefined4 param_1, int param_2)

{
    tm *ptVar1;
    uint uVar2;
    int local_28;
    undefined1 auStack_24[16];
    int local_14;

    local_28 = param_2 + 0x7c558180;
    local_14 = __stack_chk_guard;
    ptVar1 = gmtime(&local_28);
    if (ptVar1 != (tm *)0x0) {
        uVar2 = FUN_0007c054(auStack_24, 0x10, "%04d%02d%02d%02d%02d",
                             ptVar1->tm_year + 0x76c, ptVar1->tm_mon + 1,
                             ptVar1->tm_mday, ptVar1->tm_hour, ptVar1->tm_min);
        if (0xf < uVar2) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_control.c", 0x6c4, 2,
                         "rc >= 0 && (size_t)rc < sizeof(buffer)");
        }
        FUN_0002f0e4(param_1, auStack_24, uVar2);
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00030810(undefined4 param_1, int param_2)

{
    EVP_MD *md;
    int iVar1;
    size_t sVar2;
    char *__dest;
    uint uVar3;
    ushort uVar4;
    char *pcVar5;
    undefined *puVar6;
    undefined4 *puVar7;
    char *pcVar8;
    char *__s;
    char *local_208;
    int local_204;
    char acStack_200[468];
    int local_2c[2];

    local_2c[0] = __stack_chk_guard;
    switch (param_1) {
    case 1:
        FUN_0002fb4c("config",
                     ((*(uint *)(param_2 + 0x44) ^ 2) << 0x1e) >> 0x1f);
        break;
    case 2:
        FUN_0002fb4c("authenable", *(int *)(param_2 + 0x7c) == 0);
        break;
    case 3:
        FUN_0002fb4c("authentic",
                     (uint)(*(int *)(param_2 + 0x44) << 0x1d) >> 0x1f);
        break;
    case 4:
        FUN_0002f188("srcadr", 0, param_2 + 0x10);
        break;
    case 5:
        FUN_0002fb4c("srcport", *(ushort *)(param_2 + 0x12) << 8 |
                                    *(ushort *)(param_2 + 0x12) >> 8);
        break;
    case 6:
        iVar1 = *(int *)(param_2 + 0x38);
        if (iVar1 != 0) {
            iVar1 = iVar1 + 0x18;
        }
        FUN_0002f188("dstadr", 0, iVar1);
        break;
    case 7:
        uVar3 = *(uint *)(param_2 + 0x38);
        if (uVar3 != 0) {
            uVar3 = (*(ushort *)(uVar3 + 0x1a) & 0xff) << 8 |
                    (uint)(*(ushort *)(uVar3 + 0x1a) >> 8);
        }
        FUN_0002fb4c("dstport", uVar3);
        break;
    case 8:
        FUN_0002fb4c(&DAT_000a4078, *(undefined1 *)(param_2 + 0x5b));
        break;
    case 9:
        FUN_0002fb4c("hmode", *(undefined1 *)(param_2 + 0x3f));
        break;
    case 10:
        FUN_0002fb4c("stratum", *(undefined1 *)(param_2 + 0x5d));
        break;
    case 0xb:
        FUN_0002fb4c("ppoll", *(undefined1 *)(param_2 + 0x5e));
        break;
    case 0xc:
        FUN_0002fb4c("hpoll", *(undefined1 *)(param_2 + 0x40));
        break;
    case 0xd:
        FUN_0002faa8("precision", (int)*(char *)(param_2 + 0x5f));
        break;
    case 0xe:
        FUN_000300e4(SUB84(*(double *)(param_2 + 0x60) * 1000.0, 0),
                     "rootdelay", 1, 3);
        break;
    case 0xf:
        FUN_000300e4(SUB84(*(double *)(param_2 + 0x68) * 1000.0, 0), "rootdisp",
                     1, 3);
        break;
    case 0x10:
        if ((*(uint *)(param_2 + 0x44) & 8) == 0) {
            if (*(byte *)(param_2 + 0x5d) - 2 < 0xe) {
                FUN_0002f188("refid");
            } else {
                FUN_0002f20c("refid", *(undefined4 *)(param_2 + 0x70));
            }
        } else {
            FUN_0002f20c("refid", *(undefined4 *)(param_2 + 0x70));
        }
        break;
    case 0x11:
        FUN_0002fccc("reftime", param_2 + 0x74);
        break;
    case 0x12:
        FUN_0002fccc(&DAT_000a40c4, param_2 + 0x248);
        break;
    case 0x13:
        FUN_0002fccc("rec", param_2 + 0x240);
        break;
    case 0x14:
        if (*(double *)(param_2 + 0x280) != 0.0) {
            FUN_000300e4(SUB84(*(double *)(param_2 + 0x280) * 1000.0, 0),
                         "xleave", 1, 3);
        }
        break;
    case 0x15:
        FUN_0002fa04("reach", *(undefined1 *)(param_2 + 0x12a));
        break;
    case 0x16:
        FUN_0002fb4c("unreach", *(undefined4 *)(param_2 + 0x2c4));
        break;
    case 0x17:
        FUN_0002fb4c("timer", *(int *)(param_2 + 0x2d0) - current_time);
        break;
    case 0x18:
        FUN_000300e4(SUB84(*(double *)(param_2 + 0x268) * 1000.0, 0), "delay",
                     1, 3);
        break;
    case 0x19:
        FUN_000300e4(SUB84(*(double *)(param_2 + 0x260) * 1000.0, 0), "offset",
                     1, 3);
        break;
    case 0x1a:
        FUN_000300e4(SUB84(*(double *)(param_2 + 0x270) * 1000.0, 0), "jitter",
                     1, 3);
        break;
    case 0x1b:
        FUN_000300e4(SUB84(*(double *)(param_2 + 0x278) * 1000.0, 0),
                     "dispersion", 1, 3);
        break;
    case 0x1c:
        if (*(uint *)(param_2 + 0x7c) < 0x10000) {
            FUN_0002fb4c("keyid");
        } else {
            FUN_0002fa04("keyid");
        }
        break;
    case 0x1d:
        FUN_00030608("filtdelay", param_2 + 0x148,
                     *(undefined4 *)(param_2 + 0x140));
        break;
    case 0x1e:
        FUN_00030608("filtoffset", param_2 + 0x188,
                     *(undefined4 *)(param_2 + 0x140));
        break;
    case 0x1f:
        FUN_0002fb4c("pmode", *(undefined1 *)(param_2 + 0x5c));
        break;
    case 0x20:
        FUN_0002fb4c("received", *(undefined4 *)(param_2 + 0x2e8));
        break;
    case 0x21:
        FUN_0002fb4c(&DAT_000a4120, *(undefined4 *)(param_2 + 0x2e4));
        break;
    case 0x22:
        FUN_00030608("filtdisp", param_2 + 0x1c8,
                     *(undefined4 *)(param_2 + 0x140));
        break;
    case 0x23:
        FUN_0002fa04("flash", *(undefined4 *)(param_2 + 300));
        break;
    case 0x24:
        if ((*(uint *)(param_2 + 0x44) & 8) == 0) {
            if (*(int *)(param_2 + 0x4c) - 1U < 7) {
                FUN_0002faa8(
                    &DAT_0009c6f4,
                    *(undefined1 *)((int)&sys_ttl + *(int *)(param_2 + 0x4c)));
            }
        } else {
            FUN_0002fb4c(&DAT_0009c6f4);
        }
        break;
    case 0x25:
        FUN_0007c054(acStack_200, 0x1d4, &DAT_000a3fd8, "peer_var_list");
        sVar2 = strlen(acStack_200);
        pcVar8 = acStack_200 + sVar2;
        uVar4 = 0;
        puVar6 = &DAT_000c3f68;
        pcVar5 = pcVar8;
        while ((uVar4 & 0x80) == 0) {
            if ((uVar4 & 0x40) == 0) {
                __s = *(char **)(puVar6 + 0xc);
                sVar2 = strlen(__s);
                if (local_2c <= pcVar5 + sVar2 + 1)
                    break;
                __dest = pcVar8;
                if (pcVar5 != pcVar8) {
                    *pcVar5 = ',';
                    __dest = pcVar5 + 1;
                }
                pcVar5 = __dest + sVar2;
                memcpy(__dest, __s, sVar2);
            }
            uVar4 = *(ushort *)(puVar6 + 0x12);
            puVar6 = puVar6 + 8;
        }
        if (pcVar5 + 2 < local_2c) {
            *pcVar5 = '\"';
            pcVar5[1] = '\0';
            local_204 = (int)(pcVar5 + 1) - (int)acStack_200;
            local_208 = acStack_200;
            FUN_0002eec8(&local_208, 1, 0);
        }
        break;
    case 0x26:
        if (0.0 < *(double *)(param_2 + 0x2a0)) {
            FUN_000300e4(SUB84(*(double *)(param_2 + 0x2a0) / 1000.0, 0),
                         &DAT_000a406c, 1, 3);
        }
        break;
    case 0x27:
        if (0.0 < *(double *)(param_2 + 0x2b8)) {
            FUN_000300e4(SUB84(*(double *)(param_2 + 0x2b8) / 1000.0, 0), "out",
                         1, 3);
        }
        break;
    case 0x28:
        FUN_0002fb4c("headway", *(undefined4 *)(param_2 + 0x2c8));
        break;
    case 0x29:
        if (*(double *)(param_2 + 0x288) != 0.0) {
            FUN_000300e4(SUB84(*(double *)(param_2 + 0x288) * 1000.0, 0),
                         &DAT_000a40c8, 1, 3);
        }
        break;
    case 0x2a:
        pcVar5 = *(char **)(param_2 + 0x2c);
        if (pcVar5 != (char *)0x0) {
            sVar2 = strlen(pcVar5);
            FUN_0002f2c0("srchost", pcVar5, sVar2);
        }
        break;
    case 0x2b:
        FUN_0002fb4c("timerec", current_time - *(int *)(param_2 + 0x2dc));
        break;
    case 0x2c:
        FUN_0002fb4c("timereach", current_time - *(int *)(param_2 + 0x2e0));
        break;
    case 0x2d:
        FUN_0002fb4c("badauth", *(undefined4 *)(param_2 + 0x2f0));
        break;
    case 0x2e:
        FUN_0002fb4c("bogusorg", *(undefined4 *)(param_2 + 0x2f8));
        break;
    case 0x2f:
        FUN_0002fb4c("oldpkt", *(undefined4 *)(param_2 + 0x2fc));
        break;
    case 0x30:
        FUN_0002fb4c("seldisp", *(undefined4 *)(param_2 + 0x300));
        break;
    case 0x31:
        FUN_0002fb4c("selbroken", *(undefined4 *)(param_2 + 0x304));
        break;
    case 0x32:
        FUN_0002fb4c("candidate", *(undefined1 *)(param_2 + 0x128));
        break;
    case 0x33:
        if (*(int *)(param_2 + 0x88) != 0) {
            FUN_0002fa04("flags");
        }
        break;
    case 0x34:
        pcVar5 = *(char **)(param_2 + 0x94);
        if (pcVar5 != (char *)0x0) {
            sVar2 = strlen(pcVar5);
            FUN_0002f2c0(&DAT_000a2694, pcVar5, sVar2);
        }
        break;
    case 0x35:
        break;
    case 0x36:
        puVar7 = *(undefined4 **)(param_2 + 0xdc);
        if (puVar7 != (undefined4 *)0x0) {
            FUN_0002faa8("initsequence", puVar7[1]);
            FUN_0002fa04("initkey", *puVar7);
            uVar3 = *(uint *)(param_2 + 0xd0);
            FUN_0003071c("timestamp",
                         uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                             (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18);
        }
        break;
    case 0x37:
        break;
    case 0x38:
        break;
    case 0x39:
        if (*(uint *)(param_2 + 0x88) != 0) {
            pcVar5 = OBJ_nid2sn(*(uint *)(param_2 + 0x88) >> 0x10);
            md = EVP_get_digestbyname(pcVar5);
            iVar1 = EVP_MD_pkey_type(md);
            pcVar5 = OBJ_nid2ln(iVar1);
            sVar2 = strlen(pcVar5);
            FUN_0002f2c0("signature", pcVar5, sVar2);
        }
        break;
    case 0x3a:
        pcVar5 = *(char **)(param_2 + 0x50);
        if (pcVar5 != (char *)0x0) {
            sVar2 = strlen(pcVar5);
            FUN_0002f2c0("ident", pcVar5, sVar2);
        }
    }
    if (local_2c[0] == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00031888(int param_1)

{
    bool bVar1;
    bool bVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;
    char *pcVar6;
    size_t sVar7;
    EVP_MD *md;
    uint uVar8;
    undefined4 uVar9;
    char *pcVar10;
    ushort uVar11;
    int iVar12;
    int *piVar13;
    undefined *puVar14;
    char *pcVar15;
    undefined8 in_d0;
    undefined4 extraout_s1;
    undefined4 extraout_s1_00;
    double dVar16;
    undefined8 uVar17;
    int local_224;
    int local_220;
    char *local_218;
    int local_214;
    undefined1 auStack_210[16];
    char acStack_200[468];
    int local_2c[2];

    uVar9 = (undefined4)((ulonglong)in_d0 >> 0x20);
    local_2c[0] = __stack_chk_guard;
    if ((param_1 - 0x3bU < 0x10) && (current_time != DAT_000c96cc)) {
        memset(&DAT_000c96d0, 0, 0x80);
        iVar5 = adjtimex();
        if (iVar5 < 0) {
            FUN_00074e00(3, "ntp_adjtime() for mode 6 query failed: %m");
            uVar9 = extraout_s1_00;
        } else {
            DAT_000c96cc = current_time;
            uVar9 = extraout_s1;
        }
    }
    uVar4 = hostval._12_4_;
    pcVar15 = sys_ident;
    pcVar6 = Version;
    switch (param_1) {
    case 1:
        FUN_0002fb4c(&DAT_000a4078, sys_leap);
        break;
    case 2:
        FUN_0002fb4c("stratum", sys_stratum);
        break;
    case 3:
        FUN_0002faa8("precision", (int)sys_precision);
        break;
    case 4:
        FUN_000300e4(SUB84(sys_rootdelay * 1000.0, 0), "rootdelay", 1, 3);
        break;
    case 5:
        FUN_000300e4(SUB84(sys_rootdisp * 1000.0, 0), "rootdisp", 1, 3);
        break;
    case 6:
        if (sys_stratum - 2 < 0xe) {
            FUN_0002f188("refid", sys_refid, 0);
        } else {
            FUN_0002f20c("refid");
        }
        break;
    case 7:
        FUN_0002fccc("reftime", &sys_reftime);
        break;
    case 8:
        FUN_0002fb4c(&DAT_000a424c, sys_poll);
        break;
    case 9:
        if (sys_peer == 0) {
            FUN_0002fb4c("peer");
        } else {
            FUN_0002fb4c("peer", *(undefined2 *)(sys_peer + 0x3c));
        }
        break;
    case 10:
        FUN_000300e4(SUB84(last_offset * 1000.0, 0), "offset", 1, 6);
        break;
    case 0xb:
        FUN_000300e4(SUB84(drift_comp * 1000000.0, 0), "frequency", 1, 3);
        break;
    case 0xc:
        FUN_000300e4(SUB84(sys_jitter * 1000.0, 0), "sys_jitter", 1, 6);
        break;
    case 0xd:
        FUN_000300e4(SUB84(clock_jitter * 1000.0, 0), "clk_jitter", 1, 3);
        break;
    case 0xe:
        FUN_0006f724(&local_224);
        FUN_0002fccc("clock", &local_224);
        break;
    case 0xf:
        sVar7 = strlen(&DAT_000c9854);
        FUN_0002f2c0("processor", &DAT_000c9854, sVar7);
        break;
    case 0x10:
        FUN_0007c054(acStack_200, 0x100, "%s/%s", &DAT_000c9750, &DAT_000c97d2);
        sVar7 = strlen(acStack_200);
        FUN_0002f2c0("system", acStack_200, sVar7);
        break;
    case 0x11:
        sVar7 = strlen(Version);
        FUN_0002f2c0("version", pcVar6, sVar7);
        break;
    case 0x12:
        FUN_000300e4(SUB84(clock_stability * 1000000.0, 0), "clk_wander", 1, 3);
        break;
    case 0x13:
        bVar2 = true;
        FUN_0007c054(acStack_200, 0x1d4, &DAT_000a3fd8, "sys_var_list");
        sVar7 = strlen(acStack_200);
        pcVar6 = acStack_200 + sVar7;
        iVar5 = (int)local_2c - (int)pcVar6;
        uVar11 = 0;
        puVar14 = &DAT_000c4148;
        while (iVar3 = DAT_000c98d8, (uVar11 & 0x80) == 0) {
            if ((uVar11 & 0x40) == 0) {
                pcVar15 = *(char **)(puVar14 + 0xc);
                sVar7 = strlen(pcVar15);
                iVar12 = sVar7 + 1;
                iVar3 = DAT_000c98d8;
                if (iVar5 <= iVar12)
                    break;
                if (!bVar2) {
                    iVar12 = 0x2c;
                }
                pcVar10 = pcVar6;
                if (!bVar2) {
                    *pcVar6 = (char)iVar12;
                    pcVar10 = pcVar6 + 1;
                }
                pcVar6 = pcVar10 + sVar7;
                iVar5 = (int)local_2c - (int)pcVar6;
                memcpy(pcVar10, pcVar15, sVar7);
                bVar2 = false;
            }
            uVar11 = *(ushort *)(puVar14 + 0x12);
            puVar14 = puVar14 + 8;
        }
        do {
            if ((iVar3 == 0) || ((*(ushort *)(iVar3 + 2) & 0x80) != 0))
                goto LAB_00032e14;
            bVar1 = bVar2;
            if (((*(ushort *)(iVar3 + 2) & 0x40) == 0) &&
                (pcVar15 = *(char **)(iVar3 + 4), pcVar15 != (char *)0x0)) {
                pcVar10 = strchr(pcVar15, 0x3d);
                if (pcVar10 == (char *)0x0) {
                    sVar7 = strlen(pcVar15);
                } else {
                    sVar7 = (int)pcVar10 - (int)pcVar15;
                }
                if (iVar5 <= (int)(sVar7 + 1))
                    goto LAB_00032e14;
                bVar1 = false;
                pcVar10 = pcVar6;
                if (bVar2) {
                    *pcVar6 = ',';
                    pcVar10 = pcVar6 + 1;
                    pcVar15 = *(char **)(iVar3 + 4);
                }
                pcVar6 = pcVar10 + sVar7;
                iVar5 = (int)local_2c - (int)pcVar6;
                memcpy(pcVar10, pcVar15, sVar7);
            }
            bVar2 = bVar1;
            iVar3 = iVar3 + 8;
        } while (true);
    case 0x14:
        if (sys_tai != 0) {
            FUN_0002fb4c(&DAT_000a42c0);
        }
        break;
    case 0x15:
        FUN_0003db68(&local_224);
        if (local_220 != 0) {
            FUN_0003071c("leapsec");
        }
        break;
    case 0x16:
        FUN_0003db68(&local_224);
        if (local_224 != 0) {
            FUN_0003071c("expire");
        }
        break;
    case 0x17:
        FUN_0002fb4c("mintc", ntp_minpoll);
        break;
    case 0x18:
        FUN_0002fa04("mru_enabled", mon_enabled);
        break;
    case 0x19:
        FUN_0002fb4c("mru_depth", mru_entries);
        break;
    case 0x1a:
        FUN_0002fb4c("mru_deepest", mru_peakentries);
        break;
    case 0x1b:
        FUN_0002fb4c("mru_mindepth", mru_mindepth);
        break;
    case 0x1c:
        FUN_0002faa8("mru_maxage", mru_maxage);
        break;
    case 0x1d:
        FUN_0002fb4c("mru_maxdepth", mru_maxdepth);
        break;
    case 0x1e:
        dVar16 = (double)mru_entries * 0.0703125;
        uVar8 = (uint)(0.0 < dVar16) * (int)(longlong)dVar16;
        if (0.5 <= dVar16 - (double)uVar8) {
            uVar8 = uVar8 + 1;
        }
        FUN_0002fb4c("mru_mem", uVar8);
        break;
    case 0x1f:
        dVar16 = (double)mru_maxdepth * 0.0703125;
        uVar8 = (uint)(0.0 < dVar16) * (int)(longlong)dVar16;
        if (0.5 <= dVar16 - (double)uVar8) {
            uVar8 = uVar8 + 1;
        }
        FUN_0002fb4c("mru_maxmem", uVar8);
        break;
    case 0x20:
        FUN_0002fb4c("ss_uptime", current_time);
        break;
    case 0x21:
        FUN_0002fb4c("ss_reset", current_time - sys_stattime);
        break;
    case 0x22:
        FUN_0002fb4c("ss_received", sys_received);
        break;
    case 0x23:
        FUN_0002fb4c("ss_thisver", sys_newversion);
        break;
    case 0x24:
        FUN_0002fb4c("ss_oldver", sys_oldversion);
        break;
    case 0x25:
        FUN_0002fb4c("ss_badformat", sys_badlength);
        break;
    case 0x26:
        FUN_0002fb4c("ss_badauth", sys_badauth);
        break;
    case 0x27:
        FUN_0002fb4c("ss_declined", sys_declined);
        break;
    case 0x28:
        FUN_0002fb4c("ss_restricted", sys_restricted);
        break;
    case 0x29:
        FUN_0002fb4c("ss_limited", sys_limitrejected);
        break;
    case 0x2a:
        FUN_0002fb4c("ss_kodsent", sys_kodsent);
        break;
    case 0x2b:
        FUN_0002fb4c("ss_processed", sys_processed);
        break;
    case 0x2c:
        FUN_0002fb4c("ss_lamport", sys_lamport);
        break;
    case 0x2d:
        FUN_0002fb4c("ss_tsrounding", sys_tsrounding);
        break;
    case 0x2e:
        if (sys_peer == 0) {
            sVar7 = 9;
            pcVar6 = "0.0.0.0:0";
        } else if (*(int *)(sys_peer + 0x38) == 0) {
            sVar7 = 9;
            pcVar6 = "0.0.0.0:0";
        } else {
            pcVar6 = (char *)FUN_0007c47c(sys_peer + 0x10);
            sVar7 = strlen(pcVar6);
        }
        FUN_0002f0e4("peeradr", pcVar6, sVar7);
        break;
    case 0x2f:
        uVar8 = sys_peer;
        if (sys_peer != 0) {
            uVar8 = (uint) * (byte *)(sys_peer + 0x3f);
        }
        FUN_0002fb4c("peermode", uVar8);
        break;
    case 0x30:
        FUN_000300e4(SUB84(sys_bdelay * 1000.0, 0), "bcastdelay", 1, 3);
        break;
    case 0x31:
        if ((int)sys_authdelay < 0) {
            dVar16 = (double)FUN_0009bec4(
                -sys_authdelay._4_4_,
                -((int)sys_authdelay + (uint)(sys_authdelay._4_4_ != 0)));
            dVar16 = ldexp(dVar16, -0x20);
            dVar16 = -dVar16;
        } else {
            dVar16 =
                (double)FUN_0009bec4(sys_authdelay._4_4_, (int)sys_authdelay);
            dVar16 = ldexp(dVar16, -0x20);
        }
        FUN_000300e4(SUB84(dVar16 * 1000.0, 0), "authdelay", 1, 3);
        break;
    case 0x32:
        FUN_0002fb4c("authkeys", authnumkeys);
        break;
    case 0x33:
        FUN_0002fb4c("authfreek", authnumfreekeys);
        break;
    case 0x34:
        FUN_0002fb4c("authklookups", authkeylookups);
        break;
    case 0x35:
        FUN_0002fb4c("authknotfound", authkeynotfound);
        break;
    case 0x36:
        FUN_0002fb4c("authkuncached", authkeyuncached);
        break;
    case 0x37:
        FUN_0002fb4c("authkexpired", authkeyexpired);
        break;
    case 0x38:
        FUN_0002fb4c("authencrypts", authencryptions);
        break;
    case 0x39:
        FUN_0002fb4c("authdecrypts", authdecryptions);
        break;
    case 0x3a:
        FUN_0002fb4c("authreset", current_time - auth_timereset);
        break;
    case 0x3b:
        FUN_000300e4(SUB84((double)(longlong)DAT_000c96d4 * 1e-06, 0),
                     "koffset", 0, 0xffffffff);
        break;
    case 0x3c:
        uVar17 =
            FixedToFP(CONCAT44(uVar9, DAT_000c96d8), 0x20, 0x40, 0x10, 0, 0);
        FUN_000300e4((int)uVar17, "kfreq", 0, 0xffffffff);
        break;
    case 0x3d:
        FUN_000300e4(SUB84((double)(longlong)DAT_000c96dc * 0.001, 0),
                     "kmaxerr", 0, 6);
        break;
    case 0x3e:
        FUN_000300e4(SUB84((double)(longlong)DAT_000c96e0 * 0.001, 0),
                     "kesterr", 0, 6);
        break;
    case 0x3f:
        pcVar6 = (char *)FUN_0007d0ec(DAT_000c96e4);
        sVar7 = strlen(pcVar6);
        FUN_0002f2c0("kstflags", pcVar6, sVar7);
        break;
    case 0x40:
        FUN_0002faa8("ktimeconst", DAT_000c96e8);
        break;
    case 0x41:
        FUN_000300e4(SUB84((double)(longlong)DAT_000c96ec * 0.001, 0),
                     "kprecis", 0, 6);
        break;
    case 0x42:
        uVar17 =
            FixedToFP(CONCAT44(uVar9, DAT_000c96f0), 0x20, 0x40, 0x10, 0, 0);
        FUN_000300e4((int)uVar17, "kfreqtol", 0, 0xffffffff);
        break;
    case 0x43:
        if (DAT_000c9708 == 0) {
            FUN_0002faa8("kppsfreq");
        } else {
            uVar17 = FixedToFP(CONCAT44(uVar9, DAT_000c9700), 0x20, 0x40, 0x10,
                               0, 0);
            FUN_000300e4((int)uVar17, "kppsfreq", 0, 0xffffffff);
        }
        break;
    case 0x44:
        if (DAT_000c9708 == 0) {
            FUN_0002faa8("kppsstab");
        } else {
            uVar17 = FixedToFP(CONCAT44(uVar9, DAT_000c970c), 0x20, 0x40, 0x10,
                               0, 0);
            FUN_000300e4((int)uVar17, "kppsstab", 0, 0xffffffff);
        }
        break;
    case 0x45:
        if (DAT_000c9708 == 0) {
            FUN_0002faa8("kppsjitter");
        } else {
            FUN_000300e4(SUB84((double)(longlong)DAT_000c9704 * 1e-06, 0),
                         "kppsjitter", 1, 3);
        }
        break;
    case 0x46:
        if (DAT_000c9708 == 0) {
            FUN_0002faa8("kppscalibdur");
        } else {
            FUN_0002faa8("kppscalibdur", 1 << (DAT_000c9708 & 0xff));
        }
        break;
    case 0x47:
        if (DAT_000c9708 == 0) {
            FUN_0002faa8("kppscalibs");
        } else {
            FUN_0002faa8("kppscalibs", DAT_000c9714);
        }
        break;
    case 0x48:
        if (DAT_000c9708 == 0) {
            FUN_0002faa8("kppscaliberrs");
        } else {
            FUN_0002faa8("kppscaliberrs", DAT_000c9718);
        }
        break;
    case 0x49:
        if (DAT_000c9708 == 0) {
            FUN_0002faa8("kppsjitexc");
        } else {
            FUN_0002faa8("kppsjitexc", DAT_000c9710);
        }
        break;
    case 0x4a:
        if (DAT_000c9708 == 0) {
            FUN_0002faa8("kppsstbexc");
        } else {
            FUN_0002faa8("kppsstbexc", DAT_000c971c);
        }
        break;
    case 0x4b:
        FUN_0002fb4c("iostats_reset", current_time - io_timereset);
        break;
    case 0x4c:
        uVar9 = FUN_00079e00();
        FUN_0002fb4c("total_rbuf", uVar9);
        break;
    case 0x4d:
        uVar9 = FUN_00079d58();
        FUN_0002fb4c("free_rbuf", uVar9);
        break;
    case 0x4e:
        uVar9 = FUN_00079dac();
        FUN_0002fb4c("used_rbuf", uVar9);
        break;
    case 0x4f:
        uVar9 = FUN_00079e54();
        FUN_0002fb4c("rbuf_lowater", uVar9);
        break;
    case 0x50:
        FUN_0002fb4c("io_dropped", packets_dropped);
        break;
    case 0x51:
        FUN_0002fb4c("io_ignored", packets_ignored);
        break;
    case 0x52:
        FUN_0002fb4c("io_received", packets_received);
        break;
    case 0x53:
        FUN_0002fb4c("io_sent", packets_sent);
        break;
    case 0x54:
        FUN_0002fb4c("io_sendfailed", packets_notsent);
        break;
    case 0x55:
        FUN_0002fb4c("io_wakeups", handler_calls);
        break;
    case 0x56:
        FUN_0002fb4c("io_goodwakeups", handler_pkts);
        break;
    case 0x57:
        FUN_0002fb4c("timerstats_reset", current_time - timer_timereset);
        break;
    case 0x58:
        FUN_0002fb4c("timer_overruns", alarm_overflow);
        break;
    case 0x59:
        FUN_0002fb4c("timer_xmts", timer_xmtcalls);
        break;
    case 0x5a:
        FUN_000300e4(SUB84(sys_fuzz * 1000.0, 0), &DAT_000a4614, 1, 3);
        break;
    case 0x5b:
        FUN_000300e4(SUB84(wander_threshold * 1000000.0, 0),
                     "clk_wander_threshold", 1, 3);
        break;
    case 0x5c:
        break;
    case 0x5d:
        break;
    case 0x5e:
        if (crypto_flags != 0) {
            FUN_0002fa04("flags");
        }
        break;
    case 0x5f:
        if (hostval._12_4_ != 0) {
            sVar7 = strlen((char *)hostval._12_4_);
            FUN_0002f2c0(&DAT_000a2694, uVar4, sVar7);
        }
        break;
    case 0x60:
        if (hostval._0_4_ != 0) {
            FUN_0003071c("update",
                         hostval._0_4_ << 0x18 |
                             ((uint)hostval._0_4_ >> 8 & 0xff) << 0x10 |
                             ((uint)hostval._0_4_ >> 0x10 & 0xff) << 8 |
                             (uint)hostval._0_4_ >> 0x18);
        }
        break;
    case 0x61:
        if (cinfo != (int *)0x0) {
            piVar13 = cinfo;
            do {
                FUN_0007c054(acStack_200, 0x100, "%s %s 0x%x", piVar13[0xc],
                             piVar13[0xd], piVar13[1]);
                sVar7 = strlen(acStack_200);
                FUN_0002f2c0(&DAT_000a4640, acStack_200, sVar7);
                uVar8 = FUN_0007c054(auStack_210, 0x10, "%04d%02d%02d%02d%02d",
                                     *(undefined2 *)((int)piVar13 + 0x26),
                                     *(undefined1 *)((int)piVar13 + 0x2a),
                                     *(undefined1 *)((int)piVar13 + 0x2b),
                                     (char)piVar13[0xb],
                                     *(undefined1 *)((int)piVar13 + 0x2d));
                if (0xf < uVar8) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007ecc0("ntp_control.c", 0x6a9, 2,
                                 "rc >= 0 && (size_t)rc < sizeof(buffer)");
                }
                FUN_0002f0e4("until", auStack_210, uVar8);
                piVar13 = (int *)*piVar13;
            } while (piVar13 != (int *)0x0);
        }
        break;
    case 0x62:
        if (crypto_flags != 0) {
            pcVar6 = OBJ_nid2sn(crypto_flags >> 0x10);
            md = EVP_get_digestbyname(pcVar6);
            iVar5 = EVP_MD_pkey_type(md);
            pcVar6 = OBJ_nid2ln(iVar5);
            FUN_0007d4dc(acStack_200, pcVar6, 0x100);
            sVar7 = strlen(acStack_200);
            FUN_0002f2c0("signature", acStack_200, sVar7);
        }
        break;
    case 99:
        break;
    case 100:
        if (sys_ident != (char *)0x0) {
            sVar7 = strlen(sys_ident);
            FUN_0002f2c0("ident", pcVar15, sVar7);
        }
        break;
    case 0x65:
        if (crypto_flags != 0) {
            pcVar6 = OBJ_nid2ln(crypto_nid);
            FUN_0007d4dc(acStack_200, pcVar6, 0x100);
            sVar7 = strlen(acStack_200);
            FUN_0002f2c0("digest", acStack_200, sVar7);
        }
    }
switchD_000318e0_default:
    if (local_2c[0] == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
LAB_00032e14:
    if (2 < iVar5) {
        *pcVar6 = '\"';
        pcVar6[1] = '\0';
        local_214 = (int)(pcVar6 + 1) - (int)acStack_200;
        local_218 = acStack_200;
        FUN_0002eec8(&local_218, 1, 0);
    }
    goto switchD_000318e0_default;
}

/* WARNING: Removing unreachable block (ram,0x00033100) */

void FUN_0003305c(byte *param_1)

{
    uint uVar1;
    uint uVar2;

    if ((param_1 != (byte *)0x0) && (uVar2 = (uint)*param_1, uVar2 != 0)) {
        uVar1 = 1;
        while (uVar2 != 0) {
            if (7 < uVar2 >> 4) {
                return;
            }
            if ((uVar1 & *(uint *)(&DAT_000a3ba4 + (uVar2 >> 4) * 4) >>
                             ((uVar2 & 0xf) << 1)) == 0) {
                return;
            }
            param_1 = param_1 + 1;
            uVar1 = 2;
            uVar2 = (uint)*param_1;
        }
    }
    return;
}

void FUN_00033110(int param_1, undefined4 param_2)

{
    byte bVar1;
    short sVar2;
    undefined *puVar3;
    int iVar4;
    int iVar5;
    uint uVar6;
    ushort uVar7;
    ushort uVar8;
    uint uVar9;
    code *UNRECOVERED_JUMPTABLE;
    uint uVar11;
    int iVar12;
    bool bVar13;
    uint uVar10;

    iVar4 = __stack_chk_guard;
    DAT_000c9494 = param_1 + 4;
    uVar6 = *(uint *)(param_1 + 0x54);
    DAT_000c96b4 = *(undefined4 *)(param_1 + 0x3c);
    bVar1 = *(byte *)(param_1 + 0x59);
    uVar7 = (ushort)bVar1;
    sVar2 = *(short *)(param_1 + 0x60);
    numctlreq = numctlreq + 1;
    if ((int)uVar6 < 0xc) {
        numctltooshort = numctltooshort + 1;
    LAB_0003318c:
        if ((bVar1 & 0x80) != 0) {
            numctlinputresp = numctlinputresp + 1;
        }
        if ((bVar1 & 0x20) != 0) {
            numctlinputfrag = numctlinputfrag + 1;
        }
        if ((bVar1 & 0x40) != 0) {
            numctlinputerr = numctlinputerr + 1;
        }
        if (sVar2 != 0) {
            numctlbadoffset = numctlbadoffset + 1;
        }
    } else {
        if (((bVar1 & 0xe0) != 0) || (sVar2 != 0))
            goto LAB_0003318c;
        uVar9 = (uint) * (byte *)(param_1 + 0x58) << 0x1a;
        uVar10 = uVar9 >> 0x1d;
        DAT_000c98dc = (byte)(uVar9 >> 0x1d);
        if (uVar10 - 1 < 4) {
            uVar9 = uVar6 & 3;
            if (uVar9 != 0) {
                uVar9 = 1;
            }
            uVar11 = (*(ushort *)(param_1 + 0x62) & 0xff) << 8 |
                     (uint)(*(ushort *)(param_1 + 0x62) >> 8);
            DAT_000c96a8 = 0;
            if ((int)(uVar6 - 0xc) < (int)uVar11) {
                uVar9 = uVar9 | 1;
            }
            DAT_000c96ac = 0;
            DAT_000c94a2 = *(ushort *)(param_1 + 0x5e);
            DAT_000c96ad = 0;
            DAT_000c96b0 = 0;
            DAT_000c96c8 = DAT_000c94a2 << 8 | DAT_000c94a2 >> 8;
            DAT_000c949c = sys_leap << 6 | 6U | (byte)(uVar10 << 3);
            DAT_000c949e = *(undefined2 *)(param_1 + 0x5a);
            DAT_000c98dd = '\0';
            DAT_000c96a0 = 0;
            DAT_000c96c0 = 0;
            DAT_000c96bc = 0;
            DAT_000c96b8 = 1;
            DAT_000c9498 = &DAT_000c94a8;
            DAT_000c96c4 = &DAT_000c967c;
            DAT_000c94a0 = sVar2;
            DAT_000c96a4 = bVar1;
            if (uVar9 == 0) {
                uVar9 = uVar11 + 0x13 & 0xfffffff8;
                iVar12 = uVar6 - uVar9;
                if ((iVar12 - 4U < 0x15) && (sys_authenticate != 0)) {
                    uVar6 = *(uint *)(param_1 + 0x58 + uVar9);
                    DAT_000c96ad = 1;
                    DAT_000c96b0 = uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                                   (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18;
                    iVar5 = FUN_000723a4(DAT_000c96b0, DAT_000c9494);
                    if (iVar5 != 0) {
                        iVar12 = FUN_00072854(DAT_000c96b0, param_1 + 0x58,
                                              *(int *)(param_1 + 0x54) - iVar12,
                                              iVar12);
                        if (iVar12 == 0) {
                            uVar7 = (ushort)DAT_000c96a4;
                            DAT_000c96b0 = 0;
                            goto LAB_00033348;
                        }
                        DAT_000c98dd = '\x01';
                    }
                    uVar7 = (ushort)DAT_000c96a4;
                }
            LAB_00033348:
                DAT_000c9408 = param_1 + 100;
                DAT_000c940c = DAT_000c9408 + uVar11;
                if (uVar7 == 0) {
                    UNRECOVERED_JUMPTABLE = (code *)&LAB_00033ce8;
                LAB_000333dc:
                    if (iVar4 == __stack_chk_guard) {
                        /* WARNING: Could not recover jumptable at 0x000333fc.
                         * Too many branches */
                        /* WARNING: Treating indirect jump as call */
                        (*UNRECOVERED_JUMPTABLE)(param_1, param_2);
                        return;
                    }
                } else {
                    uVar8 = 1;
                    puVar3 = &DAT_000c4480;
                    while (uVar8 != 0xffff) {
                        if (uVar8 == uVar7) {
                            if ((*(short *)(puVar3 + 10) != 1) ||
                                ((DAT_000c98dd != '\0' &&
                                  (DAT_000c96b0 == ctl_auth_keyid)))) {
                                UNRECOVERED_JUMPTABLE =
                                    *(code **)(puVar3 + 0xc);
                                goto LAB_000333dc;
                            }
                            if (iVar4 != __stack_chk_guard)
                                goto LAB_000334b4;
                            iVar4 = 1;
                            goto LAB_000333c0;
                        }
                        uVar8 = *(ushort *)(puVar3 + 0x10);
                        puVar3 = puVar3 + 8;
                    }
                    bVar13 = iVar4 == __stack_chk_guard;
                    if (bVar13) {
                        iVar4 = 3;
                    }
                    numctlbadop = numctlbadop + 1;
                    if (bVar13) {
                    LAB_000333c0:
                        FUN_0002f4d0(iVar4);
                        return;
                    }
                }
                goto LAB_000334b4;
            }
            FUN_0002f4d0(2);
            numctldatatooshort = numctldatatooshort + 1;
        } else {
            numctlbadversion = numctlbadversion + 1;
        }
    }
    if (iVar4 == __stack_chk_guard) {
        return;
    }
LAB_000334b4:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0003359c) */

void FUN_00033504(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x00033668) */

void FUN_000335a8(void)

{
    return;
}

void FUN_00033684(void)

{
    int iVar1;
    ushort uVar2;
    bool bVar3;
    char cVar4;
    uint uVar5;
    int iVar6;
    char *pcVar7;
    ushort *puVar8;
    uint uVar9;
    char *pcVar10;
    int iVar11;
    char *__s;
    undefined1 auStack_74[4];
    char *local_70;
    size_t local_6c;
    char acStack_68[60];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (DAT_000c96c8 == 0) {
        uVar5 = FUN_000335a8();
        DAT_000c94a0 =
            (ushort)((uVar5 & 0xff) << 8) | (ushort)(uVar5 >> 8) & 0xff;
        bVar3 = false;
        if (DAT_000c98dd != '\0') {
            DAT_000c98df = 0;
        }
        iVar6 = FUN_0002f95c(DAT_000c98d8);
        uVar5 = iVar6 + 0x66;
        pcVar7 = (char *)FUN_00073ba4(0, uVar5, 0, 1);
        while (puVar8 = (ushort *)FUN_0002e820(&DAT_000c4148, auStack_74),
               puVar8 != (ushort *)0x0) {
            if ((puVar8[1] & 0x80) == 0) {
                uVar9 = (uint)*puVar8;
                if (uVar5 <= uVar9) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007ecc0("ntp_control.c", 0xd19, 2,
                                 "v->code < wants_count");
                }
            } else {
                puVar8 = (ushort *)FUN_0002e820(DAT_000c98d8, auStack_74);
                if (puVar8 == (ushort *)0x0) {
                    FUN_0002f4d0(6);
                    free(pcVar7);
                    goto LAB_00033930;
                }
                if ((puVar8[1] & 0x80) != 0) {
                    FUN_0002f4d0(5);
                    free(pcVar7);
                    goto LAB_00033930;
                }
                uVar9 = *puVar8 + 0x66;
                if (uVar5 <= uVar9) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007ecc0("ntp_control.c", 0xd29, 2, "n < wants_count");
                }
            }
            bVar3 = true;
            pcVar7[uVar9] = '\x01';
        }
        if (bVar3) {
            pcVar10 = pcVar7;
            do {
                while (pcVar10 = pcVar10 + 1, *pcVar10 == '\0') {
                    if (pcVar10 == pcVar7 + 0x65)
                        goto LAB_000338b4;
                }
                FUN_00031888((int)pcVar10 - (int)pcVar7);
            } while (pcVar10 != pcVar7 + 0x65);
        LAB_000338b4:
            if (uVar5 != 0x66) {
                iVar11 = 0;
                do {
                    while (pcVar10 = pcVar10 + 1, *pcVar10 != '\0') {
                        iVar1 = iVar11 * 8;
                        iVar11 = iVar11 + 1;
                        __s = *(char **)(DAT_000c98d8 + iVar1 + 4);
                        local_6c = strlen(__s);
                        local_70 = __s;
                        FUN_0002eec8(&local_70, 1, 0);
                        if (iVar11 == iVar6)
                            goto LAB_00033920;
                    }
                    iVar11 = iVar11 + 1;
                } while (iVar11 != iVar6);
            }
        } else {
            cVar4 = '\x11';
            pcVar10 = "\x11\x0f\x10\x01\x02\x03\x04\x05\x06\a\x0e\t\b\x17\n\v\f"
                      "\r\x12\x14\x15\x16\\]_d^eb`a";
            do {
                FUN_00031888(cVar4);
                pcVar10 = pcVar10 + 1;
                cVar4 = *pcVar10;
            } while (cVar4 != '\0');
            if ((DAT_000c98d8 != 0) &&
                (uVar2 = *(ushort *)(DAT_000c98d8 + 2), (uVar2 & 0x80) == 0)) {
                iVar6 = DAT_000c98d8;
                do {
                    if ((uVar2 & 0x20) != 0) {
                        pcVar10 = *(char **)(iVar6 + 4);
                        local_6c = strlen(pcVar10);
                        local_70 = pcVar10;
                        FUN_0002eec8(&local_70, 1, 0);
                    }
                } while ((iVar6 + 8 != 0) &&
                         (uVar2 = *(ushort *)(iVar6 + 10), iVar6 = iVar6 + 8,
                          (uVar2 & 0x80) == 0));
            }
        }
    LAB_00033920:
        free(pcVar7);
    } else {
        iVar6 = FUN_00041c78(DAT_000c96c8);
        if (iVar6 == 0) {
            FUN_0002f4d0(4);
            goto LAB_00033930;
        }
        uVar5 = FUN_00033504();
        DAT_000c94a0 =
            (ushort)((uVar5 & 0xff) << 8) | (ushort)(uVar5 >> 8) & 0xff;
        if (DAT_000c98dd != '\0') {
            *(undefined1 *)(iVar6 + 0x4a) = 0;
        }
        memset(acStack_68, 0, 0x3b);
        bVar3 = false;
        while (puVar8 = (ushort *)FUN_0002e820(&DAT_000c3f68, auStack_74),
               puVar8 != (ushort *)0x0) {
            if ((puVar8[1] & 0x80) != 0) {
                FUN_0002f4d0(5);
                goto LAB_00033930;
            }
            if (0x3a < *puVar8) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_control.c", 0xcee, 2,
                             "v->code < (sizeof(wants) / sizeof((wants)[0]))");
            }
            bVar3 = true;
            acStack_68[*puVar8] = '\x01';
        }
        if (bVar3) {
            pcVar7 = acStack_68;
            do {
                pcVar7 = pcVar7 + 1;
                if (*pcVar7 != '\0') {
                    FUN_00030810((int)pcVar7 - (int)acStack_68, iVar6);
                }
            } while (acStack_68 + 0x3a != pcVar7);
        } else {
            cVar4 = '\x04';
            pcVar7 = "\x04\x05*\x06\a\'&"
                     "\b\n\r\x0e\x0f\x10\x11\x13\x15\x16\t\x1f\f\v(#\x1c$"
                     "\x19\x18\x1b\x1a\x14)\x1d\x1e\"43956:";
            do {
                FUN_00030810(cVar4, iVar6);
                pcVar7 = pcVar7 + 1;
                cVar4 = *pcVar7;
            } while (cVar4 != '\0');
        }
    }
    FUN_0002eba4(0);
LAB_00033930:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00033d98(undefined4 *param_1, undefined4 param_2, int param_3,
                  undefined1 param_4)

{
    byte bVar1;
    byte bVar2;
    bool bVar3;
    uint uVar4;
    int iVar5;
    int iVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    undefined4 uVar9;
    undefined4 uVar10;
    undefined1 *puVar11;
    undefined4 *puVar12;
    undefined4 *puVar13;
    int local_3c;

    iVar5 = __stack_chk_guard;
    iVar6 = FUN_0002e710();
    uVar4 = current_time;
    if (iVar6 == 0) {
        puVar11 = ctl_traps;
        local_3c = num_ctl_traps;
        iVar6 = 0;
        bVar3 = false;
        puVar12 = (undefined4 *)0x0;
        do {
            bVar1 = ctl_traps[iVar6 * 0x34 + 0x32];
            puVar13 = (undefined4 *)puVar11;
            if (((bVar1 & 5) == 1) &&
                (uVar4 < *(int *)((int)puVar11 + 0x20) + 0xe10U)) {
                *(undefined1 *)((int)puVar11 + 0x32) = 0;
                local_3c = local_3c + -1;
                bVar3 = true;
            } else if (((bVar1 & 1) != 0) &&
                       (puVar13 = puVar12, (bVar1 & 4) == 0)) {
                if (param_3 == 0) {
                    puVar13 = (undefined4 *)puVar11;
                    if (puVar12 != (undefined4 *)0x0) {
                        bVar2 = bVar1 & 2;
                        if ((*(byte *)((int)puVar12 + 0x32) & 2) != 0)
                            goto joined_r0x00033ff0;
                        if ((bVar1 & 2) == 0)
                            goto LAB_00033eb4;
                    }
                } else if (((param_3 == 1) && ((bVar1 & 2) != 0)) &&
                           (puVar13 = (undefined4 *)puVar11,
                            puVar12 != (undefined4 *)0x0)) {
                    bVar2 = *(byte *)((int)puVar12 + 0x32) & 1;
                joined_r0x00033ff0:
                    puVar13 = puVar12;
                    if (bVar2 != 0) {
                    LAB_00033eb4:
                        puVar13 = puVar12;
                        if ((uint)puVar12[10] <
                            *(uint *)((int)puVar11 + 0x28)) {
                            puVar13 = (undefined4 *)puVar11;
                        }
                    }
                }
            }
            iVar6 = iVar6 + 1;
            puVar11 = (undefined1 *)((int)puVar11 + 0x34);
            puVar12 = puVar13;
        } while (iVar6 != 3);
        if (bVar3) {
            num_ctl_traps = local_3c;
        }
        if (puVar13 == (undefined4 *)0x0) {
            uVar7 = 0;
        } else {
            *(undefined2 *)(puVar13 + 0xc) = 1;
            uVar7 = *param_1;
            uVar8 = param_1[1];
            uVar9 = param_1[2];
            uVar10 = param_1[3];
            puVar13[10] = uVar4;
            puVar13[8] = uVar4;
            puVar13[0xb] = 0;
            puVar13[9] = 0;
            *puVar13 = uVar7;
            puVar13[1] = uVar8;
            puVar13[2] = uVar9;
            puVar13[3] = uVar10;
            if (param_3 == 0) {
                uVar10 = 5;
            }
            uVar7 = param_1[5];
            uVar8 = param_1[6];
            puVar13[4] = param_1[4];
            puVar13[5] = uVar7;
            puVar13[6] = uVar8;
            puVar13[7] = param_2;
            *(undefined1 *)((int)puVar13 + 0x33) = param_4;
            if (param_3 == 0) {
                *(char *)((int)puVar13 + 0x32) = (char)uVar10;
            } else if (param_3 == 2) {
                *(undefined1 *)((int)puVar13 + 0x32) = 3;
            } else {
                *(undefined1 *)((int)puVar13 + 0x32) = 1;
            }
            uVar7 = 1;
            num_ctl_traps = num_ctl_traps + 1;
        }
        goto LAB_00033e10;
    }
    if (param_3 == 1) {
        if ((*(byte *)(iVar6 + 0x32) & 4) != 0) {
        LAB_00033fe4:
            uVar7 = 1;
            goto LAB_00033e10;
        }
        *(undefined1 *)(iVar6 + 0x32) = 1;
    } else if (param_3 == 2) {
        if ((*(byte *)(iVar6 + 0x32) & 4) != 0)
            goto LAB_00033fe4;
        *(undefined1 *)(iVar6 + 0x32) = 3;
    } else if (param_3 == 0) {
        *(undefined1 *)(iVar6 + 0x32) = 5;
    }
    uVar7 = 1;
    *(int *)(iVar6 + 0x2c) = *(int *)(iVar6 + 0x2c) + 1;
    *(uint *)(iVar6 + 0x20) = current_time;
LAB_00033e10:
    if (iVar5 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar7);
}

void FUN_000340c0(undefined4 param_1, undefined4 param_2, uint param_3)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_0002e710();
    if (iVar2 != 0) {
        if (param_3 != 0) {
            param_3 = 1;
        }
        if ((param_3 & *(byte *)(iVar2 + 0x32) >> 2) == 0) {
            uVar3 = 1;
            *(undefined1 *)(iVar2 + 0x32) = 0;
            num_ctl_traps = num_ctl_traps + -1;
            goto LAB_00034120;
        }
    }
    uVar3 = 0;
LAB_00034120:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

/* WARNING: Removing unreachable block (ram,0x000342c0) */

void FUN_000341c4(void)

{
    ctltimereset = current_time;
    numctlreq = 0;
    numctlbadpkts = 0;
    numctlresponses = 0;
    numctlfrags = 0;
    numctlerrors = 0;
    numctltooshort = 0;
    numctlinputresp = 0;
    numctlinputfrag = 0;
    numctlinputerr = 0;
    numctlbadoffset = 0;
    numctlbadversion = 0;
    numctldatatooshort = 0;
    numctlbadop = 0;
    numasyncmsgs = 0;
    return;
}

void FUN_0003430c(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    uname((utsname *)&DAT_000c9750);
    FUN_000341c4();
    DAT_000c98de = 0;
    DAT_000c98df = 0;
    ctl_auth_keyid = 0;
    num_ctl_traps = 0;
    ctl_traps[0x32] = 0;
    ctl_traps[0x66] = 0;
    ctl_traps[0x9a] = 0;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000343ac(int *param_1, undefined4 param_2, undefined2 param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    iVar5 = *param_1;
    iVar2 = FUN_0002f95c(iVar5);
    iVar3 = FUN_00073ba4(iVar5, (iVar2 + 2) * 8, 0);
    *param_1 = iVar3;
    uVar4 = FUN_00073ba4(0, param_2, 0);
    iVar5 = iVar2 * 8;
    *(short *)(iVar3 + iVar5) = (short)iVar2;
    *(undefined4 *)(iVar3 + iVar5 + 4) = uVar4;
    *(undefined2 *)(iVar3 + iVar5 + 2) = param_3;
    *(undefined4 *)(iVar3 + iVar5 + 8) = 0x800000;
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + iVar5 + 8 + 4) = 0;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003446c(int *param_1, char *param_2, size_t param_3,
                  undefined4 param_4)

{
    char cVar1;
    int iVar2;
    void *pvVar3;
    char *pcVar4;
    char *pcVar5;
    int iVar6;
    int iVar7;
    char cVar8;
    char *pcVar9;

    iVar2 = __stack_chk_guard;
    if (param_3 != 0 && param_2 != (char *)0x0) {
        iVar6 = *param_1;
        if ((iVar6 == 0) || ((*(ushort *)(iVar6 + 2) & 0x80) != 0)) {
        LAB_0003456c:
            pvVar3 = (void *)FUN_000343ac(param_1, param_3, param_4);
            if (iVar2 == __stack_chk_guard) {
                memcpy(pvVar3, param_2, param_3);
                return;
            }
            goto LAB_000345b8;
        }
        pcVar9 = *(char **)(iVar6 + 4);
        if (pcVar9 != (char *)0x0) {
            iVar7 = iVar6;
            do {
                cVar8 = *param_2;
                if (*pcVar9 == '=') {
                LAB_00034508:
                    if (cVar8 == '=')
                        goto LAB_0003453c;
                } else {
                    pcVar4 = param_2;
                    pcVar5 = pcVar9;
                    if (*pcVar9 == *param_2) {
                        do {
                            cVar1 = pcVar5[1];
                            cVar8 = pcVar4[1];
                            if (cVar1 == '=')
                                goto LAB_00034508;
                            pcVar4 = pcVar4 + 1;
                            pcVar5 = pcVar5 + 1;
                        } while (cVar1 == cVar8);
                    }
                }
                iVar6 = iVar7 + 8;
                if ((*(ushort *)(iVar7 + 10) & 0x80) != 0)
                    goto LAB_0003456c;
                pcVar9 = *(char **)(iVar7 + 0xc);
                iVar7 = iVar6;
            } while (pcVar9 != (char *)0x0);
        }
        pcVar9 = (char *)0x0;
        iVar7 = iVar6;
    LAB_0003453c:
        pvVar3 = (void *)FUN_00073ba4(pcVar9, param_3, 0);
        pvVar3 = memcpy(pvVar3, param_2, param_3);
        *(short *)(iVar7 + 2) = (short)param_4;
        *(void **)(iVar7 + 4) = pvVar3;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
LAB_000345b8:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0003461c) */

void FUN_000345c4(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    FUN_0003446c(&DAT_000c98d8, param_1, param_2, param_3);
    return;
}

void FUN_0003462c(int param_1, uint param_2)

{
    void *pvVar1;
    void *pvVar2;
    tm *__tp;
    size_t sVar3;
    int iVar4;
    char *pcVar5;
    undefined4 uVar6;
    FILE *__stream;
    int *piVar7;
    uint uVar8;
    time_t tStack_3c0;
    char *local_3bc;
    size_t local_3b8;
    char acStack_3b4[128];
    char acStack_334[128];
    char acStack_2b4[144];
    char acStack_224[512];
    int local_24;

    pvVar1 = DAT_000c9408;
    local_24 = __stack_chk_guard;
    if ((param_2 & 0x100) == 0) {
        if (saveconfigdir == 0) {
            FUN_0002f3a0("%s",
                         "saveconfig prohibited, no saveconfigdir configured");
            FUN_0002eba4(0);
            if ((ntp_syslogmask & 1) != 0) {
                uVar6 = FUN_0007c2e8(param_1 + 4);
                FUN_00074e00(5, "saveconfig from %s rejected, no saveconfigdir",
                             uVar6);
            }
        } else {
            uVar8 = DAT_000c940c - (int)DAT_000c9408;
            if ((uVar8 != 0) &&
                ((pvVar2 = memchr(DAT_000c9408, 0, uVar8),
                  pvVar2 == (void *)0x0 ||
                      (uVar8 = (int)pvVar2 - (int)pvVar1, uVar8 != 0)))) {
                param_1 = param_1 + 4;
                if (uVar8 < 0x80) {
                    __memcpy_chk(acStack_3b4, pvVar1, uVar8, 0x80);
                    acStack_3b4[uVar8] = '\0';
                    time(&tStack_3c0);
                    __tp = localtime(&tStack_3c0);
                    sVar3 = strftime(acStack_334, 0x80, acStack_3b4, __tp);
                    if (sVar3 == 0) {
                        FUN_0007d4dc(acStack_334, acStack_3b4, 0x80);
                    }
                    iVar4 = FUN_0003305c(acStack_334);
                    if (iVar4 == 0) {
                        FUN_0002f3a0(
                            "saveconfig rejects unsafe file name \'%s\'",
                            acStack_334);
                        FUN_0002eba4(0);
                        uVar6 = FUN_0007c2e8(param_1);
                        FUN_00074e00(
                            5, "saveconfig rejects unsafe file name from %s",
                            uVar6);
                    } else {
                        pcVar5 = strpbrk(acStack_334, "\\/");
                        if (pcVar5 == (char *)0x0) {
                            uVar8 = FUN_0007c054(acStack_224, 0x200, "%s%s",
                                                 saveconfigdir, acStack_334);
                            if (uVar8 < 0x200) {
                                iVar4 = open64(acStack_224, 0x2c1, 0x180);
                                if ((iVar4 == -1) ||
                                    (__stream = fdopen(iVar4, "w"),
                                     __stream == (FILE *)0x0)) {
                                    piVar7 = __errno_location();
                                    pcVar5 = strerror(*piVar7);
                                    FUN_0002f3a0("Unable to save configuration "
                                                 "to file \'%s\': %s",
                                                 acStack_334, pcVar5);
                                    uVar6 = FUN_0007c2e8(param_1);
                                    FUN_00074e00(3,
                                                 "saveconfig %s from %s failed",
                                                 acStack_334, uVar6);
                                } else {
                                    iVar4 = FUN_0001ed20(__stream, 1);
                                    if (iVar4 == -1) {
                                        piVar7 = __errno_location();
                                        pcVar5 = strerror(*piVar7);
                                        FUN_0002f3a0(
                                            "Unable to save configuration to "
                                            "file \'%s\': %s",
                                            acStack_334, pcVar5);
                                        uVar6 = FUN_0007c2e8(param_1);
                                        FUN_00074e00(
                                            3, "saveconfig %s from %s failed",
                                            acStack_334, uVar6);
                                    } else {
                                        FUN_0002f3a0(
                                            "Configuration saved to \'%s\'",
                                            acStack_334);
                                        uVar6 = FUN_0007c2e8(param_1);
                                        FUN_00074e00(5,
                                                     "Configuration saved to "
                                                     "\'%s\' (requested by %s)",
                                                     acStack_224, uVar6);
                                        FUN_0007c054(
                                            acStack_2b4, 0x8d, "%s%s",
                                            "savedconfig=", acStack_334);
                                        sVar3 = strlen(acStack_2b4);
                                        FUN_000345c4(acStack_2b4, sVar3 + 1);
                                    }
                                    fclose(__stream);
                                }
                                FUN_0002eba4(0);
                            } else {
                                FUN_0002f3a0("saveconfig exceeded maximum path "
                                             "length (%u)",
                                             0x200);
                                FUN_0002eba4(0);
                                uVar6 = FUN_0007c2e8(param_1);
                                FUN_00074e00(5,
                                             "saveconfig exceeded maximum path "
                                             "length from %s",
                                             uVar6);
                            }
                        } else {
                            FUN_0007c054(acStack_224, 0x80,
                                         "saveconfig does not allow directory "
                                         "in filename");
                            local_3b8 = strlen(acStack_224);
                            local_3bc = acStack_224;
                            FUN_0002eec8(&local_3bc, 1, 0);
                            FUN_0002eba4(0);
                            uVar6 = FUN_0007c2e8(param_1);
                            FUN_00074e00(
                                5,
                                "saveconfig rejects unsafe file name from %s",
                                uVar6);
                        }
                    }
                } else {
                    FUN_0002f3a0(
                        "saveconfig exceeded maximum raw name length (%u)",
                        0x80);
                    FUN_0002eba4(0);
                    uVar6 = FUN_0007c2e8(param_1);
                    FUN_00074e00(
                        5,
                        "saveconfig exceeded maximum raw name length from %s",
                        uVar6);
                }
            }
        }
    } else {
        FUN_0002f3a0("%s", "saveconfig prohibited by restrict ... nomodify");
        FUN_0002eba4(0);
        if ((ntp_syslogmask & 1) != 0) {
            uVar6 = FUN_0007c2e8(param_1 + 4);
            FUN_00074e00(
                5, "saveconfig from %s rejected due to nomodify restriction",
                uVar6);
        }
        sys_restricted = sys_restricted + 1;
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00034b08(void)

{
    char *pcVar1;
    uint uVar2;
    int iVar3;
    size_t sVar4;
    size_t sVar5;
    char *__s;
    char *pcVar6;
    char *pcVar8;
    char cVar9;
    ushort uVar10;
    ushort uVar11;
    char *local_34;
    uint local_30;
    int local_2c;
    char *pcVar7;

    local_30 = 0;
    local_2c = __stack_chk_guard;
    if (DAT_000c96c8 == 0) {
        uVar2 = FUN_000335a8();
        DAT_000c94a0 =
            (ushort)((uVar2 & 0xff) << 8) | (ushort)(uVar2 >> 8) & 0xff;
        while (iVar3 = FUN_0002e820(&DAT_000c4148, &local_34), iVar3 != 0) {
            uVar10 = *(ushort *)(iVar3 + 2);
            uVar11 = uVar10 & 0x80;
            if ((uVar10 & 0x80) != 0) {
                iVar3 = FUN_0002e820(DAT_000c98d8, &local_34);
                if (iVar3 == 0)
                    break;
                uVar10 = *(ushort *)(iVar3 + 2);
                if ((uVar10 & 0x80) != 0) {
                    FUN_0002f4d0(5);
                    goto LAB_00034c00;
                }
                uVar11 = 1;
            }
            pcVar1 = local_34;
            if ((uVar10 & 2) == 0)
                goto LAB_00034cbc;
            if (local_34 == (char *)0x0) {
            LAB_00034cd4:
                FUN_0002f4d0(2);
                goto LAB_00034c00;
            }
            if (uVar11 == 0) {
                if ((*local_34 == '\0') ||
                    (iVar3 = FUN_00070930(local_34, &local_30), iVar3 == 0))
                    goto LAB_00034cd4;
                if ((local_30 & 0xfffffffc) == 0) {
                    FUN_0002f4d0(0);
                } else {
                    FUN_0002f4d0(6);
                }
                goto LAB_00034c00;
            }
            sVar4 = strlen(*(char **)(iVar3 + 4));
            sVar5 = strlen(pcVar1);
            __s = (char *)FUN_00073ba4(0, sVar4 + sVar5 + 2, 0);
            pcVar1 = local_34;
            pcVar8 = *(char **)(iVar3 + 4);
            cVar9 = *pcVar8;
            pcVar7 = __s;
            pcVar6 = __s;
            if (cVar9 != '\0' && cVar9 != '=') {
                do {
                    pcVar6 = pcVar7 + 1;
                    *pcVar7 = cVar9;
                    pcVar8 = pcVar8 + 1;
                    cVar9 = *pcVar8;
                    pcVar7 = pcVar6;
                } while (cVar9 != '\0' && cVar9 != '=');
            }
            *pcVar6 = '=';
            sVar4 = strlen(local_34);
            memcpy(pcVar6 + 1, pcVar1, sVar4 + 1);
            sVar4 = strlen(__s);
            FUN_000345c4(__s, sVar4 + 1, *(undefined2 *)(iVar3 + 2));
            free(__s);
        }
        FUN_0002eba4(0);
    } else {
    LAB_00034cbc:
        FUN_0002f4d0(1);
    }
LAB_00034c00:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00034d10(char *param_1)

{
    ushort uVar1;
    int iVar2;
    int iVar3;
    size_t __n;
    int iVar4;
    undefined *puVar5;
    void *__s2;

    iVar3 = __stack_chk_guard;
    __n = strlen(param_1);
    uVar1 = *(ushort *)(DAT_000c98d8 + 2);
    iVar2 = DAT_000c98d8;
    do {
        if ((uVar1 & 0x80) != 0) {
            puVar5 = (undefined *)0x0;
        LAB_00034da0:
            if (iVar3 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(puVar5);
        }
        __s2 = *(void **)(iVar2 + 4);
        if ((__s2 != (void *)0x0) &&
            (iVar4 = memcmp(param_1, __s2, __n), iVar4 == 0)) {
            if (*(char *)((int)__s2 + __n) == '=') {
                puVar5 = (undefined *)((int)__s2 + __n + 1);
                goto LAB_00034da0;
            }
            if (*(char *)((int)__s2 + __n) == '\0') {
                puVar5 = &DAT_000a7f7c;
                goto LAB_00034da0;
            }
        }
        uVar1 = *(ushort *)(iVar2 + 10);
        iVar2 = iVar2 + 8;
    } while (true);
}

void FUN_00034de4(void *param_1)

{
    ushort uVar1;
    void *pvVar2;
    int iVar3;

    iVar3 = __stack_chk_guard;
    if (param_1 == (void *)0x0) {
        return;
    }
    uVar1 = *(ushort *)((int)param_1 + 2);
    pvVar2 = param_1;
    while ((uVar1 & 0x80) == 0) {
        free(*(void **)((int)pvVar2 + 4));
        uVar1 = *(ushort *)((int)pvVar2 + 10);
        pvVar2 = (void *)((int)pvVar2 + 8);
    }
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    free(param_1);
    return;
}

/* WARNING: Removing unreachable block (ram,0x00035700) */
/* WARNING: Removing unreachable block (ram,0x000357bc) */
/* WARNING: Removing unreachable block (ram,0x000357c4) */
/* WARNING: Removing unreachable block (ram,0x000357cc) */
/* WARNING: Type propagation algorithm not settling */
/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_00034e78(int param_1, uint param_2)

{
    short sVar1;
    size_t sVar2;
    int iVar3;
    undefined4 uVar4;
    uint uVar5;
    ushort *puVar6;
    undefined4 *puVar7;
    int iVar8;
    char *__s2;
    uint uVar9;
    int *__s2_00;
    char *pcVar10;
    uint uVar11;
    undefined4 *puVar12;
    bool bVar13;
    int local_3ac;
    undefined1 local_38a[2];
    ushort local_388;
    ushort local_386;
    uint local_384;
    int local_380;
    uint local_37c;
    int local_378;
    int local_374;
    uint local_370;
    byte *local_36c;
    int local_368;
    uint local_364;
    int local_360;
    uint local_35c;
    uint local_358;
    undefined1 auStack_354[28];
    int local_338[32];
    short local_2b8[2];
    int local_2b4[111];
    undefined4 local_f8;
    undefined2 local_f4;
    undefined4 local_f0;
    undefined2 local_ec;
    undefined4 local_e8;
    undefined2 local_e4;
    undefined4 local_e0;
    undefined2 local_dc;
    char local_d8[4];
    char acStack_d4[4];
    undefined1 local_d0;
    undefined1 auStack_cc[32];
    char acStack_ac[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((param_2 & 0x4000) == 0) {
        local_370 = param_2 & 0x4000;
        FUN_0003446c(&local_370, "nonce", 6, 0);
        FUN_0003446c(&local_370, "frags", 6, 0);
        FUN_0003446c(&local_370, "limit", 6, 0);
        FUN_0003446c(&local_370, "mincount", 9, 0);
        FUN_0003446c(&local_370, "resall", 7, 0);
        FUN_0003446c(&local_370, "resany", 7, 0);
        FUN_0003446c(&local_370, "maxlstint", 10, 0);
        FUN_0003446c(&local_370, "laddr", 6, 0);
        iVar8 = 0;
        do {
            FUN_0007c054(acStack_ac, 0x80, "last.%d", iVar8);
            sVar2 = strlen(acStack_ac);
            FUN_0003446c(&local_370, acStack_ac, sVar2 + 1, 0);
            FUN_0007c054(acStack_ac, 0x80, "addr.%d", iVar8);
            iVar8 = iVar8 + 1;
            sVar2 = strlen(acStack_ac);
            FUN_0003446c(&local_370, acStack_ac, sVar2 + 1, 0);
        } while (iVar8 != 0x10);
        pcVar10 = (char *)0x0;
        local_384 = 0;
        local_380 = 0;
        local_3ac = 0;
        local_37c = 0;
        local_388 = 0;
        local_386 = 0;
        memset(local_338, 0, 0x80);
        memset(local_2b8, 0, 0x1c0);
        uVar11 = 0;
    LAB_000350b8:
        iVar8 = FUN_0002e820(local_370, &local_36c);
        if ((iVar8 == 0) || ((*(ushort *)(iVar8 + 2) & 0x80) != 0)) {
            FUN_00034de4(local_370);
            local_370 = 0;
            if (pcVar10 == (char *)0x0)
                goto LAB_00034ed8;
            iVar8 = sscanf(pcVar10, "%08x%08x%08x", &local_368, &local_364,
                           &local_360);
            if (iVar8 == 3) {
                iVar8 = FUN_0002e508(param_1 + 4, local_368, local_364);
                FUN_0006f724(&local_35c);
                uVar9 = local_35c - local_368;
                if (local_358 < local_364) {
                    uVar9 = uVar9 - 1;
                }
                bVar13 = uVar9 == 0xf;
                if (uVar9 < 0x10) {
                    bVar13 = local_360 == iVar8;
                }
                if (bVar13) {
                    free(pcVar10);
                    if (0xff < local_384 - 1) {
                        FUN_0002f4d0(6);
                        goto LAB_00034ed8;
                    }
                    puVar7 = (undefined4 *)mon_mru_list._4_4_;
                    if (uVar11 != 0) {
                        __s2_00 = local_2b4 + 1;
                        uVar9 = 0;
                        do {
                            uVar5 = FUN_0007c568((int)__s2_00 + 0xfffffff8);
                            puVar12 = *(undefined4 **)(mon_hash +
                                                       (uVar5 &
                                                        ~(-1 << mon_hash_bits) &
                                                        0xffff) *
                                                           4);
                            if (puVar12 != (undefined4 *)0x0) {
                                sVar1 = *(short *)((int)__s2_00 + -6);
                                do {
                                    if ((*(short *)((int)puVar12 + 0x2e) ==
                                         sVar1) &&
                                        (*(short *)((int)__s2_00 +
                                                    0xfffffff8) ==
                                         *(short *)(puVar12 + 0xb))) {
                                        if (*(short *)((int)__s2_00 +
                                                       0xfffffff8) == 2) {
                                            if (puVar12[0xc] ==
                                                *(int *)((int)__s2_00 +
                                                         0xfffffffc))
                                                goto LAB_00035518;
                                        } else {
                                            iVar8 = memcmp(puVar12 + 0xd,
                                                           __s2_00, 0x10);
                                            if ((iVar8 == 0) &&
                                                (puVar12[0x11] ==
                                                 *(int *)((int)__s2_00 +
                                                          0x10))) {
                                            LAB_00035518:
                                                if ((puVar12[6] ==
                                                     local_338[uVar9 * 2]) &&
                                                    (puVar12[7] ==
                                                     local_338[uVar9 * 2 +
                                                               1])) {
                                                    puVar7 =
                                                        (undefined4 *)
                                                            mon_mru_list._4_4_;
                                                    if (uVar11 == 0)
                                                        goto joined_r0x00035858;
                                                    FUN_0002fccc("last.older",
                                                                 puVar12 + 6);
                                                    pcVar10 =
                                                        (char *)FUN_0007c47c(
                                                            puVar12 + 0xb);
                                                    sVar2 = strlen(pcVar10);
                                                    FUN_0002f0e4("addr.older",
                                                                 pcVar10,
                                                                 sVar2);
                                                    if (local_384 < 2) {
                                                        FUN_0006f724(
                                                            &local_35c);
                                                        FUN_0002e688(param_1,
                                                                     acStack_ac,
                                                                     0x80);
                                                        sVar2 =
                                                            strlen(acStack_ac);
                                                        FUN_0002f0e4("nonce",
                                                                     acStack_ac,
                                                                     sVar2);
                                                        goto LAB_0003559c;
                                                    }
                                                    puVar7 = (undefined4 *)
                                                        puVar12[1];
                                                    goto joined_r0x00035858;
                                                }
                                                break;
                                            }
                                        }
                                    }
                                    puVar12 = (undefined4 *)*puVar12;
                                } while (puVar12 != (undefined4 *)0x0);
                            }
                            uVar9 = uVar9 + 1;
                            __s2_00 = (int *)((int)__s2_00 + 0x1c);
                        } while (uVar9 != uVar11);
                        puVar7 = (undefined4 *)mon_mru_list._4_4_;
                        if (uVar9 != 0) {
                            FUN_0002f4d0(5);
                            goto LAB_00034ed8;
                        }
                    }
                joined_r0x00035858:
                    puVar12 = puVar7;
                    if (puVar12 == (undefined4 *)mon_mru_list) {
                        FUN_0006f724(&local_35c);
                        FUN_0002e688(param_1, acStack_ac, 0x80);
                        sVar2 = strlen(acStack_ac);
                        FUN_0002f0e4("nonce", acStack_ac, sVar2);
                    LAB_00035890:
                        FUN_0002fccc(&DAT_000a49c0, &local_35c);
                    } else {
                        FUN_0006f724(&local_35c);
                        FUN_0002e688(param_1, acStack_ac, 0x80);
                        sVar2 = strlen(acStack_ac);
                        FUN_0002f0e4("nonce", acStack_ac, sVar2);
                        if (puVar12 == (undefined4 *)0x0)
                            goto LAB_00035890;
                    LAB_0003559c:
                        if ((DAT_000c96b8 < 0x80) && (local_384 != 0)) {
                            puVar7 = (undefined4 *)0x0;
                            uVar11 = 0;
                            while (true) {
                                if ((((local_380 <= (int)puVar12[9]) &&
                                      ((local_388 == 0 ||
                                        ((local_388 &
                                          ~*(ushort *)(puVar12 + 10)) ==
                                         0)))) &&
                                     ((local_386 == 0 ||
                                       ((local_386 &
                                         *(ushort *)(puVar12 + 10)) != 0)))) &&
                                    (((local_37c == 0 ||
                                       (local_35c - puVar12[6] <= local_37c)) &&
                                      ((local_3ac == 0 ||
                                        (puVar12[3] == local_3ac)))))) {
                                    iVar3 = 6;
                                    local_d8[0] = 'f';
                                    local_d8[1] = 'i';
                                    local_d8[2] = 'r';
                                    local_d8[3] = 's';
                                    acStack_d4[0] = 't';
                                    acStack_d4[1] = '.';
                                    acStack_d4[2] = '%';
                                    acStack_d4[3] = 'd';
                                    local_f8 = 0x252e7463;
                                    local_d0 = 0;
                                    local_f4 = 100;
                                    local_f0 = 0x252e766d;
                                    local_dc = 0;
                                    local_e0 = 0;
                                    local_ec = 100;
                                    local_e8 = 0x252e7372;
                                    local_e4 = 100;
                                    uVar9 = rand();
                                    iVar8 = rand();
                                    uVar9 = uVar9 ^ iVar8 << 0x10;
                                    do {
                                        for (uVar5 = uVar9 & 7;
                                             uVar5 = uVar5 % 6,
                                            *(char *)((int)&local_e0 + uVar5) !=
                                                 '\0';
                                             uVar5 = uVar5 + 1) {
                                        }
                                        switch (uVar5) {
                                        case 1:
                                            FUN_0007c054(auStack_cc, 0x20,
                                                         "last.%d", uVar11);
                                            FUN_0002fccc(auStack_cc,
                                                         puVar12 + 6);
                                            break;
                                        case 2:
                                            FUN_0007c054(auStack_cc, 0x20,
                                                         local_d8, uVar11);
                                            FUN_0002fccc(auStack_cc,
                                                         puVar12 + 4);
                                            break;
                                        case 3:
                                            FUN_0007c054(auStack_cc, 0x20,
                                                         &local_f8, uVar11);
                                            FUN_0002faa8(auStack_cc,
                                                         puVar12[9]);
                                            break;
                                        case 4:
                                            FUN_0007c054(auStack_cc, 0x20,
                                                         &local_f0, uVar11);
                                            FUN_0002fb4c(
                                                auStack_cc,
                                                *(undefined1 *)((int)puVar12 +
                                                                0x2a));
                                            break;
                                        case 5:
                                            FUN_0007c054(auStack_cc, 0x20,
                                                         &local_e8, uVar11);
                                            FUN_0002fa04(
                                                auStack_cc,
                                                *(undefined2 *)(puVar12 + 10));
                                            break;
                                        default:
                                            FUN_0007c054(auStack_cc, 0x20,
                                                         "addr.%d", uVar11);
                                            pcVar10 = (char *)FUN_0007c47c(
                                                puVar12 + 0xb);
                                            sVar2 = strlen(pcVar10);
                                            FUN_0002f0e4(auStack_cc, pcVar10,
                                                         sVar2);
                                        }
                                        iVar3 = iVar3 + -1;
                                        *(undefined1 *)((int)&local_e0 +
                                                        uVar5) = 1;
                                        uVar9 = uVar9 >> 3;
                                    } while (iVar3 != 0);
                                    if (uVar11 == 0) {
                                        FUN_0002fbf0(0);
                                    }
                                    uVar11 = uVar11 + 1;
                                    puVar7 = puVar12;
                                }
                                puVar12 = (undefined4 *)puVar12[1];
                                if ((puVar12 == (undefined4 *)mon_mru_list) ||
                                    (puVar12 == (undefined4 *)0x0))
                                    break;
                                if ((0x7f < DAT_000c96b8) ||
                                    (local_384 <= uVar11))
                                    goto LAB_000356f4;
                            }
                            if (1 < uVar11) {
                                FUN_0002fbf0(uVar11 - 1);
                            }
                            FUN_0002fccc(&DAT_000a49c0, &local_35c);
                            if (puVar7 != (undefined4 *)0x0) {
                                FUN_0002fccc("last.newest", puVar7 + 6);
                            }
                        }
                    }
                LAB_000356f4:
                    FUN_0002eba4(0);
                    goto LAB_00034ed8;
                }
            }
            free(pcVar10);
            goto LAB_00034ed8;
        }
        __s2 = *(char **)(iVar8 + 4);
        if (local_36c == (byte *)0x0) {
            local_36c = &DAT_000a3ca8;
        }
        iVar3 = strcmp("nonce", __s2);
        if (iVar3 == 0) {
            free(pcVar10);
            pcVar10 = (char *)(uint)*local_36c;
            if (pcVar10 != (char *)0x0) {
                pcVar10 = (char *)FUN_00073d08();
            }
            goto LAB_000350b8;
        }
        iVar3 = strcmp("frags", __s2);
        if (iVar3 == 0) {
            iVar8 = sscanf((char *)local_36c, "%hu", local_38a);
        joined_r0x000353a0:
            if (iVar8 != 1)
                goto LAB_00035208;
            goto LAB_000350b8;
        }
        iVar3 = strcmp("limit", __s2);
        if (iVar3 != 0) {
            iVar3 = strcmp("mincount", __s2);
            if (iVar3 != 0) {
                iVar3 = strcmp("resall", __s2);
                puVar6 = &local_388;
                if (iVar3 != 0) {
                    iVar3 = strcmp("resany", __s2);
                    if (iVar3 != 0) {
                        iVar3 = strcmp("maxlstint", __s2);
                        if (iVar3 == 0) {
                            iVar8 = sscanf((char *)local_36c, "%u", &local_37c);
                            goto joined_r0x000353a0;
                        }
                        iVar3 = strcmp("laddr", __s2);
                        if (iVar3 != 0) {
                            iVar3 = sscanf(__s2, "last.%d", &local_35c);
                            if ((iVar3 == 1) && (local_35c < 0x10)) {
                                iVar8 = sscanf((char *)local_36c, "0x%08x.%08x",
                                               &local_378, &local_374);
                                if (iVar8 != 2)
                                    goto LAB_00035208;
                                bVar13 = local_35c == uVar11;
                                local_338[local_35c * 2] = local_378;
                                local_338[local_35c * 2 + 1] = local_374;
                                if (local_2b8[local_35c * 0xe] == 2) {
                                    bVar13 =
                                        local_2b4[local_35c * 7] != 0 && bVar13;
                                } else if ((((local_2b4[local_35c * 7 + 1] ==
                                              0) &&
                                             (local_2b4[local_35c * 7 + 2] ==
                                              0)) &&
                                            (local_2b4[local_35c * 7 + 3] ==
                                             0)) &&
                                           (local_2b4[local_35c * 7 + 4] == 0))
                                    goto LAB_000350b8;
                                if (!bVar13)
                                    goto LAB_000350b8;
                            } else {
                                iVar8 = sscanf(*(char **)(iVar8 + 4), "addr.%d",
                                               &local_35c);
                                if ((iVar8 != 1) || (0xf < local_35c))
                                    goto LAB_000350b8;
                                iVar8 = FUN_000735a0(
                                    local_36c, local_2b8 + local_35c * 0xe);
                                if (iVar8 == 0)
                                    goto LAB_00035208;
                                if ((local_338[local_35c * 2] == 0) ||
                                    (local_338[local_35c * 2 + 1] == 0 ||
                                     local_35c != uVar11))
                                    goto LAB_000350b8;
                            }
                            uVar11 = uVar11 + 1;
                            goto LAB_000350b8;
                        }
                        iVar8 = FUN_000735a0(local_36c, auStack_354);
                        if (iVar8 == 0)
                            goto LAB_00035208;
                        local_3ac = FUN_0002753c(auStack_354, 0);
                        goto LAB_000350b8;
                    }
                    puVar6 = &local_386;
                }
                iVar8 = sscanf((char *)local_36c, "0x%hx", puVar6);
                goto joined_r0x000353a0;
            }
            iVar8 = sscanf((char *)local_36c, "%d", &local_380);
            if (iVar8 != 1)
                goto LAB_00035208;
            if (local_380 < 0) {
                local_380 = 0;
            }
            goto LAB_000350b8;
        }
        iVar8 = sscanf((char *)local_36c, "%u", &local_384);
        if (iVar8 == 1)
            goto LAB_000350b8;
    LAB_00035208:
        free(pcVar10);
        FUN_00034de4(local_370);
    } else {
        FUN_0002f4d0(1);
        if ((ntp_syslogmask & 1) != 0) {
            uVar4 = FUN_0007c2e8(param_1 + 4);
            FUN_00074e00(
                5, "mrulist from %s rejected due to nomrulist restriction",
                uVar4);
        }
        sys_restricted = sys_restricted + 1;
    }
LAB_00034ed8:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00035ee0(uint param_1, int param_2, int param_3)

{
    ushort uVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    size_t sVar5;
    uint uVar6;
    char cVar7;
    int iVar8;
    int iVar9;
    char *__s;
    undefined1 auStack_180[64];
    byte local_140;
    char local_13f;
    int local_13c;
    char *local_134;
    size_t local_130;
    char acStack_12c[256];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 == 0) {
        if ((uint)DAT_000c98de == (param_1 & 0xff)) {
            if (0xe < DAT_000c98df)
                goto LAB_00036090;
            DAT_000c98df = DAT_000c98df + 1;
        } else {
            DAT_000c98df = 1;
        }
        DAT_000c98de = (byte)param_1;
        uVar2 = FUN_000335a8();
        uVar3 = FUN_0007d3c4(param_1);
        uVar6 = param_1;
        FUN_0007c054(acStack_12c, 0x100, "0.0.0.0 %04x %02x %s", uVar2, param_1,
                     uVar3);
        if (param_3 != 0) {
            sVar5 = strlen(acStack_12c);
            FUN_0007c054(acStack_12c + sVar5, 0x100 - sVar5, " %s", param_3,
                         uVar6, uVar3);
        }
        uVar6 = ntp_syslogmask & 2;
    } else {
        if ((uint) * (byte *)(param_2 + 0x49) == (param_1 & 0x7f)) {
            if (0xe < *(byte *)(param_2 + 0x4a))
                goto LAB_00036090;
            cVar7 = *(byte *)(param_2 + 0x4a) + 1;
        } else {
            cVar7 = '\x01';
        }
        *(char *)(param_2 + 0x49) = (char)(param_1 & 0x7f);
        *(char *)(param_2 + 0x4a) = cVar7;
        if ((*(short *)(param_2 + 0x10) == 2) &&
            (*(short *)(param_2 + 0x14) == 0x7f7f)) {
            uVar2 = FUN_0007a3fc(param_2 + 0x10);
        } else {
            uVar2 = FUN_0007c2e8();
        }
        uVar3 = FUN_00033504(param_2);
        uVar4 = FUN_0007d3c4(param_1);
        uVar6 = param_1;
        FUN_0007c054(acStack_12c, 0x100, "%s %04x %02x %s", uVar2, uVar3,
                     param_1, uVar4);
        if (param_3 != 0) {
            sVar5 = strlen(acStack_12c);
            FUN_0007c054(acStack_12c + sVar5, 0x100 - sVar5, " %s", param_3,
                         uVar3, uVar6, uVar4);
        }
        uVar6 = ntp_syslogmask & 0x20;
    }
    if (uVar6 != 0) {
        FUN_00074e00(6, "%s", acStack_12c);
    }
    FUN_0005241c(acStack_12c);
    if (0 < num_ctl_traps) {
        if ((param_1 & 0x80) == 0) {
            DAT_000c96a8 = 0;
            DAT_000c96ad = 0;
            DAT_000c94a2 = 0;
            DAT_000c96a4 = 7;
            DAT_000c9498 = &DAT_000c94a8;
            DAT_000c96c4 = &DAT_000c967c;
            DAT_000c96ac = 1;
            uVar6 = FUN_000335a8();
            DAT_000c94a0 =
                (ushort)((uVar6 & 0xff) << 8) | (ushort)(uVar6 >> 8) & 0xff;
            iVar9 = 1;
            do {
                iVar8 = iVar9 + 1;
                FUN_00031888(iVar9);
                iVar9 = iVar8;
            } while (iVar8 != 0x14);
        } else {
            if (param_2 == 0)
                goto LAB_00036090;
            DAT_000c96a4 = 7;
            DAT_000c9498 = &DAT_000c94a8;
            DAT_000c94a2 = *(ushort *)(param_2 + 0x3c) << 8 |
                           *(ushort *)(param_2 + 0x3c) >> 8;
            DAT_000c96c4 = &DAT_000c967c;
            DAT_000c96a8 = 0;
            DAT_000c96ad = 0;
            DAT_000c96ac = 1;
            uVar6 = FUN_00033504(param_2);
            DAT_000c94a0 =
                (ushort)((uVar6 & 0xff) << 8) | (ushort)(uVar6 >> 8) & 0xff;
            iVar9 = 1;
            do {
                iVar8 = iVar9 + 1;
                FUN_00030810(iVar9, param_2);
                iVar9 = iVar8;
            } while (iVar8 != 0x33);
            if (param_1 == 0x8b) {
                local_13c = 0;
                FUN_0004a3b4(param_2 + 0x10, 0, auStack_180);
                FUN_0002fa04("refclockstatus",
                             local_140 & 0xf | local_13f << 4);
                iVar9 = 1;
                do {
                    iVar8 = iVar9 + 1;
                    FUN_000301a8(iVar9, auStack_180, 0);
                    iVar9 = iVar8;
                } while (iVar8 != 0xe);
                if ((local_13c != 0) &&
                    (uVar1 = *(ushort *)(local_13c + 2), (uVar1 & 0x80) == 0)) {
                    iVar9 = local_13c;
                    do {
                        if ((uVar1 & 0x20) != 0) {
                            __s = *(char **)(iVar9 + 4);
                            local_130 = strlen(__s);
                            local_134 = __s;
                            FUN_0002eec8(&local_134, 1, 0);
                        }
                    } while ((iVar9 + 8 != 0) &&
                             (uVar1 = *(ushort *)(iVar9 + 10),
                              iVar9 = iVar9 + 8, (uVar1 & 0x80) == 0));
                }
                FUN_00034de4(local_13c);
            }
        }
        FUN_0002eba4(0);
    }
LAB_00036090:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

undefined4 FUN_000362e8(undefined4 param_1, undefined4 param_2,
                        undefined4 param_3, undefined4 param_4)

{
    undefined4 uVar1;
    undefined1 auStack_224[512];
    int local_24;
    undefined4 uStack_4;

    local_24 = __stack_chk_guard;
    uStack_4 = param_4;
    uVar1 = FUN_00074bbc(auStack_224, 0x200, param_3, &uStack_4, &uStack_4);
    FUN_00035ee0(param_1, param_2, auStack_224);
    if (local_24 == __stack_chk_guard) {
        return uVar1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003637c(uint *param_1, uint *param_2, int param_3)

{
    uint uVar1;
    uint uVar2;
    int iVar3;
    void *pvVar4;
    uint uVar5;
    void *pvVar6;
    uint uVar7;
    uint __n;
    uint uVar8;
    void *pvVar9;
    uint __n_00;
    uint uVar10;
    uint uVar11;

    iVar3 = __stack_chk_guard;
    uVar10 = param_2[2];
    uVar8 = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
            (uVar10 >> 0x10 & 0xff) << 8;
    __n = uVar8 | uVar10 >> 0x18;
    if (0xffe7 < __n) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_crypto.c", 0x6ee, 2, "vallen <= (65535 - (6 * 4))");
    }
    uVar11 = param_2[4];
    uVar1 = uVar11 >> 0x18;
    uVar2 = uVar11 << 0x18 | (uVar11 >> 8 & 0xff) << 0x10 |
            (uVar11 >> 0x10 & 0xff) << 8;
    __n_00 = uVar2 | uVar1;
    pvVar4 = (void *)(__n_00 + 3 & 0xfffffffc);
    pvVar9 = (void *)((__n + 3 & 0xfffffffc) + 0x18 + (int)pvVar4);
    if (0x830 < (uint)(param_3 + (int)pvVar9)) {
        pvVar4 = (void *)0x0;
        goto LAB_00036470;
    }
    uVar5 = *param_2;
    uVar7 = param_2[1];
    param_1[4] = uVar10;
    param_1[2] = uVar5;
    param_1[3] = uVar7;
    uVar5 = __n;
    if (__n == 0) {
    LAB_00036400:
        uVar7 = 1;
    } else {
        pvVar6 = (void *)param_2[3];
        if (pvVar6 == (void *)0x0) {
            uVar5 = 0;
            goto LAB_00036400;
        }
        uVar5 = __n >> 2;
        uVar7 = uVar5 + 1;
        if ((uVar8 | uVar10 >> 0x18 & 0xfffffffc) < __n) {
            uVar7 = uVar5 + 2;
            param_1[uVar5 + 5] = 0;
            uVar5 = uVar5 + 1;
        }
        pvVar4 = memcpy(param_1 + 5, pvVar6, __n);
        uVar11 = param_2[4];
    }
    param_1[uVar5 + 5] = uVar11;
    if ((__n_00 != 0) && (pvVar6 = (void *)param_2[5], pvVar6 != (void *)0x0)) {
        if ((uVar2 | uVar1 & 0xfffffffc) < __n_00) {
            param_1[uVar7 + (__n_00 >> 2) + 5] = 0;
        }
        pvVar4 = memcpy(param_1 + uVar7 + 5, pvVar6, __n_00);
    }
    if (pvVar9 < (void *)0xffe8) {
        pvVar4 = pvVar9;
    }
    uVar8 = (uint)(ushort)*param_1 << 0x18 |
            (uint)(ushort)((ushort)*param_1 >> 8) << 0x10 | (uint)pvVar9;
    *param_1 = (int)pvVar9 * 0x1000000 |
               (((uint)pvVar9 & 0xff00) >> 8) << 0x10 |
               (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
    if ((void *)0xffe7 < pvVar9) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_crypto.c", 0x717, 1, "len <= (65535 - (6 * 4))");
    }
LAB_00036470:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pvVar4);
    }
    return;
}

void FUN_00036540(BIGNUM *param_1, BIGNUM *param_2)

{
    int iVar1;
    uchar *to;
    EVP_MD_CTX *ctx;
    EVP_MD *type;
    int iVar2;
    size_t local_60;
    uchar auStack_5c[64];
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = BN_num_bits(param_1);
    iVar2 = iVar1 + 7;
    if (iVar2 < 0) {
        iVar2 = iVar1 + 0xe;
    }
    local_60 = iVar2 >> 3;
    to = (uchar *)FUN_00073ba4(0, local_60, 0);
    BN_bn2bin(param_1, to);
    ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
    EVP_MD_CTX_set_flags(ctx, 8);
    type = EVP_md5();
    EVP_DigestInit_ex(ctx, type, (ENGINE *)0x0);
    EVP_DigestUpdate(ctx, to, local_60);
    EVP_DigestFinal(ctx, auStack_5c, &local_60);
    EVP_MD_CTX_free(ctx);
    BN_bin2bn(auStack_5c, local_60, param_2);
    free(to);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00036630(uint *param_1, uint *param_2, int param_3)

{
    uint uVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;
    EVP_MD_CTX *ctx;
    int iVar5;
    uint uVar6;
    uint uVar7;
    uint uVar8;
    uint uVar9;
    uint uVar10;
    EVP_PKEY *pkey;
    uint uVar11;
    bool bVar12;
    bool bVar13;

    iVar2 = __stack_chk_guard;
    uVar9 = *param_1;
    uVar4 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10;
    if ((uVar9 << 0x18 & 0x40000000) != 0)
        goto LAB_000366a0;
    uVar9 = (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
    if (uVar9 < 0x18) {
    LAB_00036720:
        uVar3 = 0x101;
    } else {
        if ((uVar4 == 0x82040000) &&
            ((*(char *)(param_3 + 0x5c) == '\x05' ||
              ((*(byte *)(param_3 + 0x48) & 0x20) != 0)))) {
            uVar7 = param_1[1];
            if ((uint) * (ushort *)(param_3 + 0x84) ==
                (uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                 (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18)) {
            LAB_000366e8:
                uVar7 = param_1[4];
                uVar7 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                        (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
                if (uVar7 - 1 < 0xffe7) {
                    uVar1 = uVar7 + 3 >> 2;
                    uVar10 = param_1[uVar1 + 5];
                    uVar10 = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                             (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
                    if (uVar10 < 0xffe8) {
                        uVar9 = uVar9 - 0x18;
                        uVar8 = uVar7 + 3 & 0xfffffffc;
                        if ((uVar8 <= uVar9) &&
                            ((uVar10 + 3 & 0xfffffffc) <= uVar9 - uVar8)) {
                            uVar8 = param_1[2];
                            uVar9 = param_1[3];
                            uVar8 = uVar8 << 0x18 |
                                    (uVar8 >> 8 & 0xff) << 0x10 |
                                    (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
                            uVar9 = uVar9 << 0x18 |
                                    (uVar9 >> 8 & 0xff) << 0x10 |
                                    (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
                            if (uVar8 == 0 || uVar8 < uVar9) {
                            LAB_00036778:
                                uVar3 = 0x102;
                                goto LAB_000366a4;
                            }
                            if (param_2 != (uint *)0x0) {
                                uVar11 = *param_2;
                                uVar6 = param_2[1];
                                uVar11 = uVar11 << 0x18 |
                                         (uVar11 >> 8 & 0xff) << 0x10 |
                                         (uVar11 >> 0x10 & 0xff) << 8 |
                                         uVar11 >> 0x18;
                                uVar6 = uVar6 << 0x18 |
                                        (uVar6 >> 8 & 0xff) << 0x10 |
                                        (uVar6 >> 0x10 & 0xff) << 8 |
                                        uVar6 >> 0x18;
                                if (uVar11 != 0 && uVar6 != 0) {
                                    if (uVar8 < uVar11)
                                        goto LAB_00036778;
                                    bVar13 = uVar9 <= uVar6;
                                    bVar12 = uVar6 == uVar9;
                                    if (!bVar13 || bVar12) {
                                        bVar13 = uVar8 <= uVar6;
                                        bVar12 = uVar6 == uVar8;
                                    }
                                    if (bVar13 && !bVar12) {
                                        uVar3 = 0x103;
                                        goto LAB_000366a4;
                                    }
                                }
                            }
                            if (uVar4 != 0x82020000) {
                                pkey = DAT_000c98e0;
                                if ((crypto_flags & 0x10 &
                                     *(uint *)(param_3 + 0x88)) == 0) {
                                    pkey = *(EVP_PKEY **)(param_3 + 0x8c);
                                }
                                if ((pkey == (EVP_PKEY *)0x0 || uVar10 == 0) ||
                                    (*(int *)(param_3 + 0x90) == 0))
                                    goto LAB_000366a0;
                                uVar4 = EVP_PKEY_size(pkey);
                                if (uVar4 != uVar10) {
                                    uVar3 = 0x107;
                                    goto LAB_000366a4;
                                }
                                ctx = (EVP_MD_CTX *)EVP_MD_CTX_new(uVar4);
                                EVP_DigestInit(ctx,
                                               *(EVP_MD **)(param_3 + 0x90));
                                EVP_DigestUpdate(ctx, param_1 + 2, uVar7 + 0xc);
                                iVar5 = EVP_VerifyFinal(
                                    ctx, (uchar *)(param_1 + uVar1 + 6), uVar10,
                                    pkey);
                                if (iVar5 < 1) {
                                    EVP_MD_CTX_free(ctx);
                                    uVar3 = 0x108;
                                    goto LAB_000366a4;
                                }
                                EVP_MD_CTX_free(ctx);
                                if ((*(uint *)(param_3 + 0x88) & 0x200) != 0) {
                                    uVar3 = 0x100;
                                    *(uint *)(param_3 + 0x88) =
                                        *(uint *)(param_3 + 0x88) | 0x400;
                                    goto LAB_000366a4;
                                }
                            }
                            uVar3 = 0x100;
                            goto LAB_000366a4;
                        }
                    }
                }
                goto LAB_00036720;
            }
        } else {
            uVar7 = param_1[1];
            if ((uint) * (ushort *)(param_3 + 0x3c) ==
                (uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                 (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18))
                goto LAB_000366e8;
        }
    LAB_000366a0:
        uVar3 = 0x10f;
    }
LAB_000366a4:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00036980) */

void FUN_000368a4(void)

{
    return;
}

void FUN_0003698c(uint param_1, undefined4 *param_2, undefined2 *param_3)

{
    int iVar1;
    ulong uVar2;
    char *__nptr;
    char acStack_47[35];
    int local_24;

    local_24 = __stack_chk_guard;
    if (0x17 < param_1) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_crypto.c", 0x7f9, 0, "len < sizeof(v)");
    }
    __nptr = acStack_47 + 0xb;
    __strncpy_chk(__nptr, *param_2, param_1, 0x18);
    if (param_1 < 0xd) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_crypto.c", 0x7fb, 0, "len >= 13");
    }
    uVar2 = strtoul(__nptr + (param_1 - 3), (char **)0x0, 10);
    *(char *)(param_3 + 4) = (char)uVar2;
    acStack_47[param_1 + 8] = '\0';
    uVar2 = strtoul(__nptr + (param_1 - 5), (char **)0x0, 10);
    *(char *)((int)param_3 + 7) = (char)uVar2;
    acStack_47[param_1 + 6] = '\0';
    uVar2 = strtoul(__nptr + (param_1 - 7), (char **)0x0, 10);
    *(char *)(param_3 + 3) = (char)uVar2;
    acStack_47[param_1 + 4] = '\0';
    uVar2 = strtoul(__nptr + (param_1 - 9), (char **)0x0, 10);
    *(char *)((int)param_3 + 5) = (char)uVar2;
    acStack_47[param_1 + 2] = '\0';
    uVar2 = strtoul(__nptr + (param_1 - 0xb), (char **)0x0, 10);
    *(char *)(param_3 + 2) = (char)uVar2;
    acStack_47[param_1] = '\0';
    uVar2 = strtoul(__nptr, (char **)0x0, 10);
    iVar1 = __stack_chk_guard;
    if (uVar2 < 0x32) {
        uVar2 = uVar2 + 100;
    } else if (0x95 < uVar2)
        goto LAB_00036ab8;
    uVar2 = uVar2 + 0x76c;
LAB_00036ab8:
    *(undefined1 *)((int)param_3 + 9) = 0;
    *param_3 = (short)uVar2;
    param_3[1] = 0;
    if (local_24 == iVar1) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00036d98(char *param_1, void *param_2, undefined4 param_3)

{
    FILE *__stream;
    char *pcVar1;
    int iVar2;
    EVP_PKEY *pkey;
    ulong e;
    int *piVar3;
    int *piVar4;
    int *piVar5;
    int local_330;
    char acStack_32c[256];
    char acStack_22c[2];
    undefined1 auStack_22a[254];
    undefined1 auStack_12c[256];
    int local_2c;
    int local_1c;

    piVar3 = (int *)0x82c;
    local_1c = __stack_chk_guard;
    piVar5 = pkinfo;
    if (pkinfo != (int *)0x0) {
        do {
            piVar3 = piVar5;
            piVar4 = (int *)strcmp(param_1, (char *)piVar3[2]);
            if (piVar4 == (int *)0x0) {
                if (local_1c == __stack_chk_guard) {
                    return;
                }
                goto LAB_00036e40;
            }
            piVar5 = (int *)*piVar3;
            piVar3 = piVar4;
        } while (piVar5 != (int *)0x0);
    }
    if (local_1c != __stack_chk_guard) {
    LAB_00036e40:
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar3);
    }
    local_2c = __stack_chk_guard;
    if (*param_1 == '/') {
        FUN_0007d4dc(acStack_32c, param_1, 0x100);
    } else {
        FUN_0007c054(acStack_32c, 0x100, "%s/%s", keysdir, param_1);
    }
    __stream = fopen64(acStack_32c, "r");
    if (__stream == (FILE *)0x0) {
        piVar3 = (int *)0x0;
    } else {
        pcVar1 = fgets(acStack_22c, 0x100, __stream);
        if (pcVar1 == (char *)0x0) {
            pcVar1 = "crypto_key: empty file %s";
        } else {
            pcVar1 = strrchr(pcVar1, 0x2e);
            if (pcVar1 == (char *)0x0) {
                pcVar1 = "crypto_key: no filestamp %s";
            } else {
                iVar2 = sscanf(pcVar1 + 1, "%u", &local_330);
                if (iVar2 == 1) {
                    pkey = PEM_read_PrivateKey(__stream, (EVP_PKEY **)0x0,
                                               (undefined1 *)0x0, param_2);
                    fclose(__stream);
                    if (pkey == (EVP_PKEY *)0x0) {
                        e = ERR_get_error();
                        pcVar1 = ERR_error_string(e, (char *)0x0);
                        FUN_00074e00(3, "crypto_key: %s", pcVar1);
                        /* WARNING: Subroutine does not return */
                        exit(-1);
                    }
                    piVar3 = (int *)FUN_00073ba4(0, 0x10, 0);
                    piVar3[1] = (int)pkey;
                    *piVar3 = (int)pkinfo;
                    pkinfo = piVar3;
                    iVar2 = FUN_00073d08(param_1);
                    piVar3[2] = iVar2;
                    piVar3[3] = local_330;
                    pcVar1 = strrchr(acStack_22c, 10);
                    if (pcVar1 != (char *)0x0) {
                        *pcVar1 = '\0';
                    }
                    iVar2 = EVP_PKEY_size(pkey);
                    FUN_0007c054(auStack_12c, 0x100, "%s mod %d", auStack_22a,
                                 iVar2 << 3);
                    FUN_00052514(param_3, auStack_12c);
                    goto LAB_00036cbc;
                }
                pcVar1 = "crypto_key: invalid filestamp %s";
            }
        }
        piVar3 = (int *)0x0;
        FUN_00074e00(3, pcVar1, acStack_32c);
        fclose(__stream);
    }
LAB_00036cbc:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar3);
}

void FUN_00036e50(void)

{
    EVP_MD_CTX *ctx;
    int iVar1;
    undefined4 uVar2;
    uint uVar3;
    int *piVar4;
    uint local_158;
    time_t local_154;
    uint local_150;
    int local_14c;
    uint local_148;
    int local_144;
    short local_13c;
    undefined1 auStack_12c[256];
    int local_2c;

    local_2c = __stack_chk_guard;
    ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
    if (pubkey._8_4_ != 0) {
        pubkey._16_4_ = 0;
        pubkey._0_4_ = hostval._0_4_;
        if (pubkey._20_4_ == 0) {
            pubkey._20_4_ = FUN_00073ba4(0, DAT_000c98e4, 0);
        }
        EVP_DigestInit(ctx, DAT_000c98e8);
        EVP_DigestUpdate(ctx, pubkey, 0xc);
        EVP_DigestUpdate(ctx, (void *)pubkey._12_4_,
                         pubkey._8_4_ << 0x18 |
                             ((uint)pubkey._8_4_ >> 8 & 0xff) << 0x10 |
                             ((uint)pubkey._8_4_ >> 0x10 & 0xff) << 8 |
                             (uint)pubkey._8_4_ >> 0x18);
        iVar1 = EVP_SignFinal(ctx, (uchar *)pubkey._20_4_, &local_158,
                              DAT_000c98e0);
        if (iVar1 != 0) {
            if (DAT_000c98e4 < local_158) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_crypto.c", 0x74c, 2, "len <= sign_siglen");
            }
            pubkey._16_4_ = local_158 << 0x18 |
                            (local_158 >> 8 & 0xff) << 0x10 |
                            (local_158 >> 0x10 & 0xff) << 8 | local_158 >> 0x18;
        }
    }
    uVar2 = hostval._0_4_;
    for (piVar4 = (int *)cinfo; hostval._0_4_ = uVar2, piVar4 != (int *)0x0;
         piVar4 = (int *)*piVar4) {
        piVar4[0x13] = 0;
        piVar4[0xf] = uVar2;
        if (piVar4[0x14] == 0) {
            uVar2 = FUN_00073ba4(0, DAT_000c98e4, 0);
            piVar4[0x14] = uVar2;
        }
        EVP_DigestInit(ctx, DAT_000c98e8);
        EVP_DigestUpdate(ctx, piVar4 + 0xf, 0xc);
        uVar3 = piVar4[0x11];
        EVP_DigestUpdate(ctx, (void *)piVar4[0x12],
                         uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                             (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18);
        iVar1 =
            EVP_SignFinal(ctx, (uchar *)piVar4[0x14], &local_158, DAT_000c98e0);
        if (iVar1 != 0) {
            if (DAT_000c98e4 < local_158) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_crypto.c", 0x761, 2, "len <= sign_siglen");
            }
            piVar4[0x13] = local_158 << 0x18 | (local_158 >> 8 & 0xff) << 0x10 |
                           (local_158 >> 0x10 & 0xff) << 8 | local_158 >> 0x18;
        }
        uVar2 = hostval._0_4_;
    }
    tai_leap._0_4_ = uVar2;
    tai_leap._4_4_ = hostval._4_4_;
    FUN_0003da78(&local_150);
    if ((local_150 == local_148) && (local_14c == local_144)) {
        local_154 = time((time_t *)0x0);
        FUN_0003d7d0(&local_150, local_154 + -0x7c558180);
    }
    local_158 = 0xc;
    if ((tai_leap._12_4_ == 0) || (tai_leap._8_4_ != 0xc000000)) {
        free((void *)tai_leap._12_4_);
        tai_leap._12_4_ = FUN_00073ba4(0, local_158, 0);
        tai_leap._8_4_ = local_158 << 0x18 | (local_158 >> 8 & 0xff) << 0x10 |
                         (local_158 >> 0x10 & 0xff) << 8 | local_158 >> 0x18;
    }
    uVar2 = tai_leap._12_4_;
    uVar3 = (uint)local_13c;
    if ((int)uVar3 < 0xb) {
        memset((void *)tai_leap._12_4_, 0, local_158);
    } else {
        *(uint *)tai_leap._12_4_ = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                                   (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
        *(uint *)(uVar2 + 4) =
            local_150 << 0x18 | (local_150 >> 8 & 0xff) << 0x10 |
            (local_150 >> 0x10 & 0xff) << 8 | local_150 >> 0x18;
        if (local_144 < 0) {
            local_150 = local_150 + 0x20f580;
        } else {
            local_150 = local_148 + 0x93a80;
        }
        *(uint *)(uVar2 + 8) =
            local_150 << 0x18 | (local_150 >> 8 & 0xff) << 0x10 |
            (local_150 >> 0x10 & 0xff) << 8 | local_150 >> 0x18;
    }
    if (tai_leap._20_4_ == 0) {
        tai_leap._20_4_ = FUN_00073ba4(0, DAT_000c98e4, 0);
    }
    EVP_DigestInit(ctx, DAT_000c98e8);
    EVP_DigestUpdate(ctx, tai_leap, 0xc);
    EVP_DigestUpdate(ctx, (void *)tai_leap._12_4_, local_158);
    iVar1 =
        EVP_SignFinal(ctx, (uchar *)tai_leap._20_4_, &local_158, DAT_000c98e0);
    if (iVar1 != 0) {
        if (DAT_000c98e4 < local_158) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_crypto.c", 0x793, 2, "len <= sign_siglen");
        }
        tai_leap._16_4_ = local_158 << 0x18 | (local_158 >> 8 & 0xff) << 0x10 |
                          (local_158 >> 0x10 & 0xff) << 8 | local_158 >> 0x18;
    }
    crypto_flags = crypto_flags | 2;
    FUN_0007c054(auStack_12c, 0x100, "signature update ts %u",
                 hostval._0_4_ << 0x18 |
                     ((uint)hostval._0_4_ >> 8 & 0xff) << 0x10 |
                     ((uint)hostval._0_4_ >> 0x10 & 0xff) << 8 |
                     (uint)hostval._0_4_ >> 0x18);
    FUN_00052514(0, auStack_12c);
    EVP_MD_CTX_free(ctx);
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000372c8(short *param_1, uint param_2, uint param_3, uint param_4,
                  int param_5)

{
    EVP_MD_CTX *ctx;
    char *name;
    EVP_MD *type;
    size_t cnt;
    uint local_98;
    undefined4 local_94;
    undefined4 local_90;
    uint local_8c;
    uint local_88;
    undefined4 local_84;
    undefined4 uStack_80;
    undefined4 uStack_7c;
    undefined4 uStack_78;
    uint local_74;
    uint local_70;
    uint local_6c[16];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 != 0) {
        if (*param_1 == 2) {
            local_94 = *(undefined4 *)(param_1 + 2);
            local_88 = param_4 << 0x18 | (param_4 >> 8 & 0xff) << 0x10 |
                       (param_4 >> 0x10 & 0xff) << 8 | param_4 >> 0x18;
            local_90 = *(undefined4 *)(param_2 + 4);
            local_8c = param_3 << 0x18 | (param_3 >> 8 & 0xff) << 0x10 |
                       (param_3 >> 0x10 & 0xff) << 8 | param_3 >> 0x18;
            cnt = 0x10;
        } else if (*param_1 == 10) {
            local_70 = param_4 << 0x18 | (param_4 >> 8 & 0xff) << 0x10 |
                       (param_4 >> 0x10 & 0xff) << 8 | param_4 >> 0x18;
            local_94 = *(undefined4 *)(param_1 + 4);
            local_90 = *(undefined4 *)(param_1 + 6);
            local_8c = *(uint *)(param_1 + 8);
            local_88 = *(uint *)(param_1 + 10);
            local_74 = param_3 << 0x18 | (param_3 >> 8 & 0xff) << 0x10 |
                       (param_3 >> 0x10 & 0xff) << 8 | param_3 >> 0x18;
            cnt = 0x28;
            local_84 = *(undefined4 *)(param_2 + 8);
            uStack_80 = *(undefined4 *)(param_2 + 0xc);
            uStack_7c = *(undefined4 *)(param_2 + 0x10);
            uStack_78 = *(undefined4 *)(param_2 + 0x14);
        } else {
            cnt = 0;
        }
        ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
        EVP_MD_CTX_set_flags(ctx, 8);
        name = OBJ_nid2sn(crypto_nid);
        type = EVP_get_digestbyname(name);
        EVP_DigestInit_ex(ctx, type, (ENGINE *)0x0);
        EVP_DigestUpdate(ctx, &local_94, cnt);
        EVP_DigestFinal(ctx, (uchar *)local_6c, &local_98);
        EVP_MD_CTX_free(ctx);
        param_2 = local_6c[0] << 0x18 | (local_6c[0] >> 8 & 0xff) << 0x10 |
                  (local_6c[0] >> 0x10 & 0xff) << 8 | local_6c[0] >> 0x18;
        if (param_5 != 0) {
            FUN_000724ac(param_3, crypto_nid, local_6c, local_98, 0);
            FUN_000721bc(param_3, param_5);
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_2);
}

void FUN_00037454(int param_1, int param_2)

{
    uint uVar1;
    uint uVar2;
    EVP_MD_CTX *ctx;
    uint uVar3;
    int iVar4;
    undefined4 uVar5;
    uint *puVar6;
    int iVar7;
    int iVar8;
    uint local_40;
    uint local_34;
    undefined4 local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 == 0) {
        uVar5 = 0x10f;
    } else {
        local_30 = 0;
        local_34 = 0;
        if (sys_leap == '\x03') {
            local_40 = 0;
            iVar4 = *(int *)(param_1 + 0xf0);
            uVar1 = 0;
        } else {
            FUN_0006f724(&local_34);
            local_40 = local_34 << 0x18 | (local_34 >> 8 & 0xff) << 0x10 |
                       (local_34 >> 0x10 & 0xff) << 8 | local_34 >> 0x18;
            iVar4 = *(int *)(param_1 + 0xf0);
            uVar1 = local_34;
        }
        local_34 = uVar1;
        if (iVar4 == 0) {
            uVar5 = FUN_00073c68(0, 100, 4);
            *(undefined4 *)(param_1 + 0xf0) = uVar5;
        }
        do {
            do {
                uVar2 = FUN_00078ae4();
            } while (uVar2 < 0x10000);
            iVar4 = FUN_0007204c();
        } while (iVar4 != 0);
        uVar3 = (uint) * (byte *)(param_1 + 0x5e);
        if (*(byte *)(param_1 + 0x40) <= uVar3) {
            uVar3 = (uint) * (byte *)(param_1 + 0x40);
        }
        iVar4 = 1 << uVar3;
        uVar3 = 1 << sys_automax;
        if ((uint)(iVar4 * 100) <= (uint)(1 << sys_automax)) {
            uVar3 = iVar4 * 100;
        }
        if (*(char *)(param_1 + 0x3f) == '\x05') {
            uVar5 = 0;
        } else {
            uVar5 = *(undefined4 *)(param_1 + 0xa8);
        }
        iVar8 = 0;
        do {
            iVar7 = uVar3 + iVar4;
            *(uint *)(*(int *)(param_1 + 0xf0) + iVar8 * 4) = uVar2;
            uVar3 = iVar7 + iVar4 * -2;
            *(int *)(param_1 + 0xf4) = iVar8;
            uVar2 = FUN_000372c8(param_2 + 0x18, param_1 + 0x10, uVar2, uVar5,
                                 iVar7);
            iVar7 = FUN_00071fd4();
            if ((iVar7 != 0) ||
                ((uVar1 == 0 || uVar2 < 0x10000) || (int)uVar3 < 0))
                break;
            iVar8 = iVar8 + 1;
        } while (iVar8 != 100);
        puVar6 = *(uint **)(param_1 + 0x11c);
        if (puVar6 == (uint *)0x0) {
            puVar6 = (uint *)FUN_00073ba4(0, 8, 0);
            *(uint **)(param_1 + 0x11c) = puVar6;
        }
        uVar3 = *(uint *)(param_1 + 0xf4);
        *puVar6 = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                  (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
        puVar6[1] = uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                    (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18;
        *(uint *)(param_1 + 0x110) = local_40;
        *(undefined4 *)(param_1 + 0x118) = 0x8000000;
        *(undefined4 *)(param_1 + 0x120) = 0;
        *(undefined4 *)(param_1 + 0x114) = hostval._0_4_;
        if (uVar1 == 0) {
            uVar5 = 0x100;
        } else {
            if (*(int *)(param_1 + 0x124) == 0) {
                uVar5 = FUN_00073ba4(0, DAT_000c98e4, 0);
                *(undefined4 *)(param_1 + 0x124) = uVar5;
            }
            ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
            EVP_DigestInit(ctx, DAT_000c98e8);
            EVP_DigestUpdate(ctx, (void *)(param_1 + 0x110), 0xc);
            EVP_DigestUpdate(ctx, *(void **)(param_1 + 0x11c), 8);
            iVar4 = EVP_SignFinal(ctx, *(uchar **)(param_1 + 0x124), &local_34,
                                  DAT_000c98e0);
            if (iVar4 != 0) {
                if (DAT_000c98e4 < local_34) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007ecc0("ntp_crypto.c", 0x18d, 2,
                                 "len <= sign_siglen");
                }
                *(uint *)(param_1 + 0x120) =
                    local_34 << 0x18 | (local_34 >> 8 & 0xff) << 0x10 |
                    (local_34 >> 0x10 & 0xff) << 8 | local_34 >> 0x18;
                *(uint *)(param_1 + 0x44) = *(uint *)(param_1 + 0x44) | 0x8000;
            }
            EVP_MD_CTX_free(ctx);
            uVar5 = 0x100;
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar5);
}

void FUN_00037774(int param_1)

{
    int iVar1;
    uint uVar2;
    undefined *puVar3;
    undefined4 uVar4;
    undefined1 auStack_11c[256];
    int local_1c;

    uVar2 = *(uint *)(param_1 + 0x88);
    local_1c = __stack_chk_guard;
    if ((uVar2 & 0x20) == 0) {
        if ((uVar2 & 0x40) != 0) {
            uVar4 = 0x2080000;
            puVar3 = &DAT_000a4b48;
            goto LAB_000377c4;
        }
        if ((uVar2 & 0x80) != 0) {
            uVar4 = 0x2090000;
            puVar3 = &DAT_000a4b4c;
            goto LAB_000377c4;
        }
    } else {
        uVar4 = 0x2070000;
        puVar3 = &DAT_000a4b44;
    LAB_000377c4:
        FUN_0007c054(auStack_11c, 0x100, "ntpkey_%spar_%s", puVar3,
                     *(undefined4 *)(param_1 + 0x50));
        iVar1 = FUN_00036d98(auStack_11c, 0, param_1 + 0x10);
        *(int *)(param_1 + 0xac) = iVar1;
        if (iVar1 != 0)
            goto LAB_00037800;
    }
    uVar4 = 0x2000000;
    FUN_00074e00(5, "crypto_ident: no identity parameters found for group %s",
                 *(undefined4 *)(param_1 + 0x50));
LAB_00037800:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_0003787c(undefined4 param_1, uint param_2, uint param_3, char *param_4)

{
    uint uVar1;
    uint __n;
    uint *puVar2;
    int iVar3;
    uint local_34[4];

    local_34[1] = 0;
    local_34[0] = 0;
    local_34[2] = __stack_chk_guard;
    if (sys_leap != '\x03') {
        FUN_0006f724(local_34);
    }
    uVar1 = local_34[0];
    if (param_4 == (char *)0x0) {
        iVar3 = 0x18;
        __n = 0;
    } else {
        __n = strlen(param_4);
        if (0xffe6 < __n) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_crypto.c", 0x6bd, 2, "slen < (65535 - (6 * 4))");
        }
        iVar3 = __n + 0x18;
    }
    puVar2 = (uint *)FUN_00073ba4(0, iVar3, 0, 1);
    if (param_2 != 0) {
        if ((param_2 & 0xffff) != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_crypto.c", 0x6c5, 0,
                         "0 == (opcode & ~0xffff0000)");
        }
        param_2 = iVar3 + param_2;
        *puVar2 = param_2 * 0x1000000 | (param_2 >> 8 & 0xff) << 0x10 |
                  (param_2 >> 0x10 & 0xff) << 8 | param_2 >> 0x18;
        puVar2[1] = param_3 << 0x18 | (param_3 >> 8 & 0xff) << 0x10 |
                    (param_3 >> 0x10 & 0xff) << 8 | param_3 >> 0x18;
        puVar2[2] = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                    (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
        if (param_4 == (char *)0x0) {
            puVar2[4] = 0;
        }
        puVar2[3] = hostval._0_4_;
        if (param_4 != (char *)0x0) {
            puVar2[4] = __n << 0x18 | (__n >> 8 & 0xff) << 0x10 |
                        (__n >> 0x10 & 0xff) << 8 | __n >> 0x18;
            memcpy(puVar2 + 5, param_4, __n);
        }
    }
    if (local_34[2] != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(puVar2);
    }
    return;
}

void FUN_000379fc(void)

{
    uint local_1c[4];

    local_1c[1] = 0;
    local_1c[0] = 0;
    local_1c[2] = __stack_chk_guard;
    if (sys_leap == '\x03') {
        hostval._0_4_ = 0;
    } else {
        FUN_0006f724(local_1c);
        hostval._0_4_ = local_1c[0] << 0x18 |
                        (local_1c[0] >> 8 & 0xff) << 0x10 |
                        (local_1c[0] >> 0x10 & 0xff) << 8 | local_1c[0] >> 0x18;
        if (hostval._0_4_ != 0) {
            FUN_00036e50();
        }
    }
    if (local_1c[2] == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00037b34) */

void FUN_00037aa0(void)

{
    if ((((DAT_000c98e8 != 0) && (DAT_000c98e0 != 0)) &&
         (tai_leap._12_4_ != 0)) &&
        (tai_leap._8_4_ == 0xc000000)) {
        FUN_000379fc();
        return;
    }
    return;
}

void FUN_00037b48(undefined4 *param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((void *)param_1[3] != (void *)0x0) {
        free((void *)param_1[3]);
    }
    if ((void *)param_1[5] != (void *)0x0) {
        free((void *)param_1[5]);
    }
    *param_1 = 0;
    iVar2 = __stack_chk_guard;
    param_1[1] = 0;
    param_1[2] = 0;
    param_1[3] = 0;
    param_1[4] = 0;
    param_1[5] = 0;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00037bcc(void *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (*(EVP_PKEY **)((int)param_1 + 8) != (EVP_PKEY *)0x0) {
        EVP_PKEY_free(*(EVP_PKEY **)((int)param_1 + 8));
    }
    if (*(void **)((int)param_1 + 0x30) != (void *)0x0) {
        free(*(void **)((int)param_1 + 0x30));
    }
    if (*(void **)((int)param_1 + 0x34) != (void *)0x0) {
        free(*(void **)((int)param_1 + 0x34));
    }
    if (*(BIGNUM **)((int)param_1 + 0x38) != (BIGNUM *)0x0) {
        BN_free(*(BIGNUM **)((int)param_1 + 0x38));
    }
    FUN_00037b48((int)param_1 + 0x3c);
    if (iVar1 == __stack_chk_guard) {
        free(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00037c64(uchar *param_1, uint param_2, uint param_3)

{
    X509 *x;
    int iVar1;
    EVP_PKEY *pEVar2;
    undefined4 uVar3;
    X509_NAME *pXVar4;
    char *pcVar5;
    int iVar6;
    EVP_MD *pEVar7;
    ASN1_INTEGER *a;
    long lVar8;
    undefined4 *puVar9;
    BIO_METHOD *type;
    BIO *out;
    X509_EXTENSION *ex;
    ASN1_OBJECT *o;
    int iVar10;
    ASN1_OCTET_STRING *pAVar11;
    BIGNUM *pBVar12;
    void *__dest;
    ulong uVar13;
    int iVar14;
    int loc;
    char *__s2;
    uchar *local_13c;
    undefined2 local_138[2];
    undefined1 local_134;
    undefined1 local_133;
    undefined1 local_132;
    undefined1 local_131;
    undefined1 local_130;
    char acStack_12c[256];
    int local_2c;

    local_2c = __stack_chk_guard;
    local_13c = param_1;
    x = d2i_X509((X509 **)0x0, &local_13c, param_2);
    if (x == (X509 *)0x0) {
        uVar13 = ERR_get_error();
        pcVar5 = ERR_error_string(uVar13, (char *)0x0);
        FUN_00074e00(3, "cert_parse: %s", pcVar5);
        iVar6 = 0;
        goto LAB_00037f7c;
    }
    iVar1 = FUN_00073ba4(0, 0x54, 0, 1);
    pEVar2 = X509_get_pubkey(x);
    *(EVP_PKEY **)(iVar1 + 8) = pEVar2;
    if (pEVar2 == (EVP_PKEY *)0x0) {
        uVar13 = ERR_get_error();
        pcVar5 = ERR_error_string(uVar13, (char *)0x0);
        FUN_00074e00(3, "cert_parse: %s", pcVar5);
    } else {
        uVar3 = X509_get_version(x);
        *(undefined4 *)(iVar1 + 0xc) = uVar3;
        pXVar4 = X509_get_subject_name(x);
        X509_NAME_oneline(pXVar4, acStack_12c, 0x100);
        pcVar5 = strstr(acStack_12c, "CN=");
        if (pcVar5 == (char *)0x0) {
            FUN_00074e00(5, "cert_parse: invalid subject %s", acStack_12c);
        } else {
            uVar3 = FUN_00073d08(pcVar5 + 3);
            *(undefined4 *)(iVar1 + 0x30) = uVar3;
            iVar6 = X509_get_signature_nid(x);
            *(int *)(iVar1 + 0x10) = iVar6;
            pcVar5 = OBJ_nid2sn(iVar6);
            pEVar7 = EVP_get_digestbyname(pcVar5);
            *(EVP_MD **)(iVar1 + 0x14) = pEVar7;
            a = X509_get_serialNumber(x);
            lVar8 = ASN1_INTEGER_get(a);
            *(long *)(iVar1 + 0x18) = lVar8;
            pXVar4 = X509_get_issuer_name(x);
            X509_NAME_oneline(pXVar4, acStack_12c, 0x100);
            pcVar5 = strstr(acStack_12c, "CN=");
            if (pcVar5 == (char *)0x0) {
                FUN_00074e00(5, "cert_parse: invalid issuer %s", acStack_12c);
            } else {
                iVar14 = iVar1 + 0x1c;
                uVar3 = FUN_00073d08(pcVar5 + 3);
                *(undefined4 *)(iVar1 + 0x34) = uVar3;
                puVar9 = (undefined4 *)X509_get0_notBefore(x);
                FUN_0003698c(*puVar9, puVar9 + 2, iVar14);
                puVar9 = (undefined4 *)X509_get0_notAfter(x);
                FUN_0003698c(*puVar9, puVar9 + 2, iVar1 + 0x26);
                iVar6 = X509_get_ext_count(x);
                if (0 < iVar6) {
                    loc = 0;
                    do {
                        while (true) {
                            ex = X509_get_ext(x, loc);
                            o = X509_EXTENSION_get_object(ex);
                            iVar10 = OBJ_obj2nid(o);
                            if (iVar10 != 0x52)
                                break;
                            loc = loc + 1;
                            pAVar11 = X509_EXTENSION_get_data(ex);
                            pBVar12 =
                                BN_bin2bn(pAVar11->data + 2,
                                          pAVar11->length + -2, (BIGNUM *)0x0);
                            *(BIGNUM **)(iVar1 + 0x38) = pBVar12;
                            if (iVar6 == loc)
                                goto LAB_00037ec0;
                        }
                        if (iVar10 == 0x7e) {
                            type = BIO_s_mem();
                            out = BIO_new(type);
                            X509V3_EXT_print(out, ex, 0, 0);
                            BIO_gets(out, acStack_12c, 0x100);
                            BIO_free(out);
                            iVar10 = strcmp(acStack_12c, "Trust Root");
                            if (iVar10 == 0) {
                                *(uint *)(iVar1 + 4) = *(uint *)(iVar1 + 4) | 1;
                            } else {
                                iVar10 = strcmp(acStack_12c, "Private");
                                if (iVar10 == 0) {
                                    *(uint *)(iVar1 + 4) =
                                        *(uint *)(iVar1 + 4) | 8;
                                }
                            }
                        }
                        loc = loc + 1;
                    } while (iVar6 != loc);
                }
            LAB_00037ec0:
                pcVar5 = *(char **)(iVar1 + 0x30);
                __s2 = *(char **)(iVar1 + 0x34);
                iVar6 = strcmp(pcVar5, __s2);
                if (iVar6 == 0) {
                    iVar6 = X509_verify(x, *(EVP_PKEY **)(iVar1 + 8));
                    if (0 < iVar6)
                        goto LAB_00037ef8;
                    FUN_00074e00(5, "cert_parse: signature not verified %s",
                                 *(undefined4 *)(iVar1 + 0x30));
                } else {
                    iVar6 = strcmp((char *)hostval._12_4_, __s2);
                    if (iVar6 == 0) {
                        FUN_00074e00(5, "cert_parse: certificate trail loop %s",
                                     pcVar5);
                    } else {
                    LAB_00037ef8:
                        FUN_00076750(local_138, param_3, 0);
                        iVar6 = FUN_000368a4(iVar14, iVar1 + 0x26);
                        if ((iVar6 < 1) &&
                            (iVar6 = FUN_000368a4(iVar14, local_138),
                             -1 < iVar6)) {
                            *(uint *)(iVar1 + 0x40) =
                                param_3 << 0x18 |
                                (param_3 >> 8 & 0xff) << 0x10 |
                                (param_3 >> 0x10 & 0xff) << 8 | param_3 >> 0x18;
                            *(uint *)(iVar1 + 0x44) =
                                param_2 << 0x18 |
                                (param_2 >> 8 & 0xff) << 0x10 |
                                (param_2 >> 0x10 & 0xff) << 8 | param_2 >> 0x18;
                            __dest = (void *)FUN_00073ba4(0, param_2, 0);
                            *(void **)(iVar1 + 0x48) = __dest;
                            memcpy(__dest, param_1, param_2);
                            X509_free(x);
                            iVar6 = iVar1;
                            goto LAB_00037f7c;
                        }
                        FUN_00074e00(5,
                                     "cert_parse: invalid times %s first "
                                     "%u-%02u-%02uT%02u:%02u:%02u last "
                                     "%u-%02u-%02uT%02u:%02u:%02u fstamp "
                                     "%u-%02u-%02uT%02u:%02u:%02u",
                                     *(undefined4 *)(iVar1 + 0x30),
                                     *(undefined2 *)(iVar1 + 0x1c),
                                     *(undefined1 *)(iVar1 + 0x20),
                                     *(undefined1 *)(iVar1 + 0x21),
                                     *(undefined1 *)(iVar1 + 0x22),
                                     *(undefined1 *)(iVar1 + 0x23),
                                     *(undefined1 *)(iVar1 + 0x24),
                                     *(undefined2 *)(iVar1 + 0x26),
                                     *(undefined1 *)(iVar1 + 0x2a),
                                     *(undefined1 *)(iVar1 + 0x2b),
                                     *(undefined1 *)(iVar1 + 0x2c),
                                     *(undefined1 *)(iVar1 + 0x2d),
                                     *(undefined1 *)(iVar1 + 0x2e),
                                     local_138[0], local_134, local_133,
                                     local_132, local_131, local_130);
                    }
                }
            }
        }
    }
    iVar6 = 0;
    FUN_00037bcc(iVar1);
    X509_free(x);
LAB_00037f7c:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar6);
}

void FUN_0003816c(int param_1)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *puVar3;
    int iVar4;
    uint uVar5;
    uint uVar6;
    undefined4 *puVar7;
    char *__s1;
    undefined4 *puVar8;
    undefined4 *puVar9;

    iVar1 = __stack_chk_guard;
    uVar5 = *(uint *)(param_1 + 0x10);
    uVar6 = *(uint *)(param_1 + 0xc);
    puVar3 = (undefined4 *)FUN_00037c64(
        param_1 + 0x14,
        uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
            (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18,
        uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
            (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18);
    puVar9 = cinfo;
    puVar7 = puVar3;
    if (puVar3 != (undefined4 *)0x0) {
        if (cinfo != (undefined4 *)0x0) {
            __s1 = (char *)puVar3[0xc];
            puVar2 = cinfo;
            puVar8 = &cinfo;
            do {
                puVar7 = puVar2;
                iVar4 = strcmp(__s1, (char *)puVar7[0xc]);
                if ((iVar4 == 0) &&
                    (iVar4 = strcmp((char *)puVar3[0xd], (char *)puVar7[0xd]),
                     iVar4 == 0)) {
                    uVar5 = puVar3[0x10];
                    uVar6 = puVar7[0x10];
                    if ((uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                         (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18) <=
                        (uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10 |
                         (uVar6 >> 0x10 & 0xff) << 8 | uVar6 >> 0x18)) {
                        FUN_00037bcc(puVar3);
                        goto LAB_00038210;
                    }
                    *puVar8 = *puVar7;
                    FUN_00037bcc(puVar7);
                    puVar9 = cinfo;
                    break;
                }
                puVar2 = (undefined4 *)*puVar7;
                puVar8 = puVar7;
            } while ((undefined4 *)*puVar7 != (undefined4 *)0x0);
        }
        *puVar3 = puVar9;
        puVar7 = puVar3;
        cinfo = puVar3;
    LAB_00038210:
        puVar7[1] = puVar7[1] | 4;
        FUN_000379fc();
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar7);
}

void FUN_0003828c(int param_1, int param_2)

{
    uint uVar1;
    undefined4 uVar2;
    DSA_SIG *pDVar3;
    EVP_MD *pEVar4;
    void *pvVar5;
    X509 *pXVar6;
    char *pcVar7;
    RSA *rsa;
    size_t __size;
    uint *puVar8;
    BN_CTX *pBVar9;
    BIGNUM *pBVar10;
    BIGNUM *pBVar11;
    BIGNUM *r;
    DSA *r_00;
    ulong uVar12;
    EVP_PKEY *pEVar13;
    uint uVar14;
    uint uVar15;
    char *pcVar16;
    int iVar17;
    uint uVar18;
    int iVar19;
    undefined4 uVar20;
    undefined4 uVar21;
    uint *__src;
    uint uVar22;
    int iVar23;
    uint uVar24;
    uint uVar25;
    uint uVar26;
    int iVar27;
    uint uVar28;
    uint uVar29;
    int local_18c;
    uint local_180;
    uchar *local_14c;
    uint *local_148;
    BIGNUM *local_144;
    BIGNUM *local_140;
    BIGNUM *local_13c;
    BIGNUM *local_138;
    BIGNUM *local_134;
    BIGNUM *local_130;
    undefined1 auStack_12c[256];
    int local_2c;

    iVar27 = *(int *)(param_2 + 0x54);
    uVar1 = iVar27 - 0x30;
    local_2c = __stack_chk_guard;
    uVar15 = *(byte *)(param_2 + 0x58) & 7;
    if (0x18 < (int)uVar1) {
        uVar24 = 0;
        iVar23 = 0x30;
        local_180 = 0;
        do {
            iVar17 = iVar23 + 3;
            if (-1 < iVar23) {
                iVar17 = iVar23;
            }
            uVar25 = *(uint *)(param_2 + 0x58 + (iVar17 >> 2) * 4);
            __src = (uint *)(param_2 + 0x58 + (iVar17 >> 2) * 4);
            uVar18 = uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10;
            uVar22 = (uVar25 >> 0x10 & 0xff) << 8;
            uVar26 = uVar18 | uVar22 | uVar25 >> 0x18;
            uVar22 = uVar22 | uVar25 >> 0x18;
            uVar25 = __src[1] >> 0x18;
            uVar28 = (__src[1] >> 0x10 & 0xff) << 8;
            uVar14 = uVar28 | uVar25;
            if ((uVar18 << 2) >> 0x1a != 2 || uVar22 < 8) {
                uVar18 = uVar18 | 0x40000000;
                sys_badlength = sys_badlength + 1;
            }
            if (uVar1 < uVar22) {
            LAB_00038c50:
                iVar27 = 0x101;
                goto LAB_00038468;
            }
            if (uVar22 < 0x18) {
                if (uVar18 == 0x82010000) {
                LAB_000386a8:
                    if (*(int *)(param_1 + 0x88) == 0) {
                        if (uVar22 < 0x18) {
                            /* WARNING: Subroutine does not return */
                            FUN_0007ecc0("ntp_crypto.c", 0x231, 2,
                                         "len >= (6 * 4)");
                        }
                        if ((uVar24 - 1 < 0x200) && (uVar24 <= uVar22 - 0x18)) {
                            if ((crypto_flags & 0x10) == 0) {
                                if (uVar15 - 1 < 2) {
                                    if ((crypto_flags & 0xf0) == 0) {
                                        if ((local_180 & 0xf0) != 0)
                                            goto LAB_00038f40;
                                    } else if ((local_180 & 0xf0) == 0) {
                                    LAB_00038f40:
                                        uVar1 = *__src;
                                        iVar27 = 0x106;
                                        uVar26 = uVar1 << 0x18 |
                                                 (uVar1 >> 8 & 0xff) << 0x10 |
                                                 (uVar1 >> 0x10 & 0xff) << 8 |
                                                 uVar1 >> 0x18;
                                        goto LAB_00038428;
                                    }
                                }
                            } else {
                                if ((local_180 & 0x10) == 0)
                                    goto LAB_00038f40;
                                local_180 = local_180 | 0x2300;
                            }
                            uVar1 = local_180 >> 0x10;
                            pcVar7 = OBJ_nid2sn(uVar1);
                            pEVar4 = EVP_get_digestbyname(pcVar7);
                            if (pEVar4 != (EVP_MD *)0x0) {
                                local_18c._0_2_ = (undefined2)uVar14;
                                *(undefined2 *)(param_1 + 0x84) =
                                    (undefined2)local_18c;
                                if (uVar15 == 4) {
                                    local_180 = local_180 | 0x1000;
                                }
                                if ((local_180 & 2) == 0) {
                                    local_180 = local_180 | 0x4000;
                                }
                                RAND_bytes((uchar *)(param_1 + 0xa4), 4);
                                *(uint *)(param_1 + 0x88) = local_180;
                                *(EVP_MD **)(param_1 + 0x90) = pEVar4;
                                if (*(void **)(param_1 + 0x94) != (void *)0x0) {
                                    free(*(void **)(param_1 + 0x94));
                                }
                                pvVar5 = (void *)FUN_00073ba4(0, uVar24 + 1, 0);
                                *(void **)(param_1 + 0x94) = pvVar5;
                                memcpy(pvVar5, __src + 5, uVar24);
                                *(undefined1 *)(*(int *)(param_1 + 0x94) +
                                                uVar24) = 0;
                                if (*(void **)(param_1 + 0x98) != (void *)0x0) {
                                    free(*(void **)(param_1 + 0x98));
                                }
                                uVar2 = FUN_00073d08(
                                    *(undefined4 *)(param_1 + 0x94));
                                uVar28 = (uint) * (ushort *)(param_1 + 0x3c);
                                uVar18 = *(uint *)(param_1 + 0x94);
                                *(undefined4 *)(param_1 + 0x98) = uVar2;
                                uVar25 = (uint) * (ushort *)(param_1 + 0x84);
                                pcVar7 = OBJ_nid2ln(uVar1);
                                pcVar16 = "assoc %d %d host %s %s";
                                goto LAB_00038c0c;
                            }
                            uVar1 = *__src;
                            iVar27 = 0x105;
                            uVar26 =
                                uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
                        } else {
                            uVar1 = *__src;
                            iVar27 = 0x101;
                            uVar26 =
                                uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
                        }
                    } else {
                        if (*(ushort *)(param_1 + 0x84) == uVar14) {
                        LAB_000386c4:
                            iVar27 = *(int *)(param_2 + 0x54);
                            goto LAB_000385e4;
                        }
                        uVar1 = *__src;
                        iVar27 = 0x10f;
                        uVar26 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                                 (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
                    }
                } else if (uVar18 < 0x82010001) {
                    if (uVar18 != 0x2060000) {
                        if (uVar18 < 0x2060001) {
                            if ((uVar18 != 0x2020000) && (uVar18 != 0x2030000))
                                goto LAB_0003863c;
                        } else if (((uVar18 != 0x2080000) &&
                                    (uVar18 != 0x2090000)) &&
                                   (uVar18 != 0x2070000))
                            goto LAB_000385d0;
                    }
                    iVar27 = 0x101;
                } else if (uVar18 == 0x82050000) {
                LAB_00038750:
                    iVar27 = FUN_00036630(__src, 0, param_1);
                    if (uVar24 == 0xc && iVar27 == 0x100) {
                        if (sys_leap != '\x03') {
                            uVar1 = __src[5];
                            FUN_0003de9c(
                                uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                                    (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18,
                                *(undefined4 *)(param_2 + 0x48));
                        }
                        tai_leap._0_4_ = __src[2];
                        uVar24 = 0xc;
                        tai_leap._4_4_ = __src[3];
                        FUN_000379fc();
                        uVar1 = __src[5];
                        FUN_000362e8(
                            0xe, param_1, "%d seconds",
                            uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18);
                        *(uint *)(param_1 + 0x88) =
                            *(uint *)(param_1 + 0x88) | 0x4000;
                        uVar1 = __src[3];
                        *(uint *)(param_1 + 300) =
                            *(uint *)(param_1 + 300) & 0xffffff7f;
                        uVar28 = __src[6];
                        uVar18 = __src[7];
                        uVar25 = __src[5];
                        FUN_0007c054(
                            auStack_12c, 0x100,
                            "leap TAI offset %d at %u expire %u fs %u",
                            uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                                (uVar25 >> 0x10 & 0xff) << 8 | uVar25 >> 0x18,
                            uVar28 << 0x18 | (uVar28 >> 8 & 0xff) << 0x10 |
                                (uVar28 >> 0x10 & 0xff) << 8 | uVar28 >> 0x18,
                            uVar18 << 0x18 | (uVar18 >> 8 & 0xff) << 0x10 |
                                (uVar18 >> 0x10 & 0xff) << 8 | uVar18 >> 0x18,
                            uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18);
                        FUN_00052514(param_1 + 0x10, auStack_12c);
                        iVar27 = *(int *)(param_2 + 0x54);
                        goto LAB_000385e4;
                    }
                    if (iVar27 == 0x100)
                        goto LAB_000386c4;
                LAB_00038590:
                    uVar1 = *__src;
                    uVar26 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                             (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
                } else {
                    if (0x82050000 < uVar18) {
                        if (uVar18 != 0x82070000) {
                            if (uVar18 < 0x82070001)
                                goto LAB_000383e8;
                            goto LAB_000384bc;
                        }
                        goto LAB_00038700;
                    }
                    uVar1 = uVar24;
                    if (uVar18 != 0x82030000) {
                        if (uVar18 == 0x82040000)
                            goto LAB_0003884c;
                        if (uVar18 != 0x82020000)
                            goto LAB_000385d0;
                        goto LAB_000385e4;
                    }
                LAB_00038574:
                    iVar27 = FUN_00036630(__src, param_1 + 0xb8, param_1);
                    if (iVar27 != 0x100)
                        goto LAB_00038590;
                    uVar24 = EVP_PKEY_size(DAT_000c98ec);
                    if (uVar24 == uVar1) {
                        rsa = (RSA *)EVP_PKEY_get0_RSA(DAT_000c98ec);
                        __size = RSA_size(rsa);
                        puVar8 = (uint *)malloc(__size);
                        if (puVar8 != (uint *)0x0) {
                            iVar27 =
                                RSA_private_decrypt(uVar1, (uchar *)(__src + 5),
                                                    (uchar *)puVar8, rsa, 4);
                            if (iVar27 != 4) {
                                free(puVar8);
                                uVar1 = *__src;
                                iVar27 = 0x10b;
                                uVar26 = uVar1 << 0x18 |
                                         (uVar1 >> 8 & 0xff) << 0x10 |
                                         (uVar1 >> 0x10 & 0xff) << 8 |
                                         uVar1 >> 0x18;
                                goto LAB_00038428;
                            }
                            uVar1 = *puVar8;
                            free(puVar8);
                            FUN_0004394c(param_1);
                            uVar14 =
                                uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
                            uVar25 = __src[2];
                            uVar18 = __src[3];
                            uVar28 = uVar15 - 1;
                            uVar1 = uVar28;
                            if (uVar28 < 2) {
                                uVar1 = *(uint *)(param_1 + 0xa4);
                            }
                            *(uint *)(param_1 + 0x88) =
                                *(uint *)(param_1 + 0x88) | 0x800;
                            if (uVar28 < 2) {
                                uVar14 = uVar14 ^ uVar1;
                            }
                            *(uint *)(param_1 + 300) =
                                *(uint *)(param_1 + 300) & 0xffffff7f;
                            *(uint *)(param_1 + 0xa8) = uVar14;
                            FUN_0007c054(
                                auStack_12c, 0x100, "cook %x ts %u fs %u",
                                uVar14,
                                uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                                    (uVar25 >> 0x10 & 0xff) << 8 |
                                    uVar25 >> 0x18,
                                uVar18 << 0x18 | (uVar18 >> 8 & 0xff) << 0x10 |
                                    (uVar18 >> 0x10 & 0xff) << 8 |
                                    uVar18 >> 0x18);
                            goto LAB_00038c10;
                        }
                    }
                    uVar1 = *__src;
                    iVar27 = 0x10b;
                    uVar26 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                             (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
                }
            LAB_00038428:
                local_18c = param_1 + 0x10;
                uVar2 = FUN_0007d3c4(iVar27);
                FUN_0007c054(auStack_12c, 0x100, "%04x %d %02x %s", uVar26,
                             uVar28 | uVar25, iVar27, uVar2);
                FUN_00052514(local_18c, auStack_12c);
                goto LAB_00038468;
            }
            uVar24 = __src[4];
            uVar1 = __src[3];
            uVar24 = uVar24 << 0x18 | (uVar24 >> 8 & 0xff) << 0x10 |
                     (uVar24 >> 0x10 & 0xff) << 8 | uVar24 >> 0x18;
            local_180 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                        (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
            if ((uVar24 == 0) || (uVar22 - 0x18 < uVar24))
                goto LAB_00038c50;
            if (uVar18 != 0x82040000) {
                if (0x82040000 < uVar18) {
                    if (uVar18 == 0x82070000) {
                    LAB_00038700:
                        iVar27 = FUN_00036630(__src, 0, param_1);
                        if (iVar27 == 0x100) {
                            iVar27 = *(int *)(param_1 + 0xac);
                            if (iVar27 == 0) {
                                pcVar7 = "crypto_iff: scheme unavailable";
                            } else {
                                uVar1 = __src[3];
                                if ((uVar1 << 0x18 |
                                     (uVar1 >> 8 & 0xff) << 0x10 |
                                     (uVar1 >> 0x10 & 0xff) << 8 |
                                     uVar1 >> 0x18) !=
                                    *(uint *)(iVar27 + 0xc)) {
                                    pcVar7 = "crypto_iff: invalid filestamp %u";
                                    goto LAB_00038528;
                                }
                                iVar27 = EVP_PKEY_get0_DSA(
                                    *(undefined4 *)(iVar27 + 4));
                                if (iVar27 == 0) {
                                    pcVar7 = "crypto_iff: defective key";
                                LAB_000393a0:
                                    FUN_00074e00(5, pcVar7);
                                    uVar1 = *__src;
                                    iVar27 = 0x104;
                                    uVar26 = uVar1 << 0x18 |
                                             (uVar1 >> 8 & 0xff) << 0x10 |
                                             (uVar1 >> 0x10 & 0xff) << 8 |
                                             uVar1 >> 0x18;
                                    goto LAB_00038428;
                                }
                                if (*(int *)(param_1 + 0xb0) == 0) {
                                    pcVar7 = "crypto_iff: missing challenge";
                                } else {
                                    pBVar9 = BN_CTX_new();
                                    pBVar10 = BN_new();
                                    pBVar11 = BN_new();
                                    uVar1 = __src[4];
                                    local_144 = (BIGNUM *)(__src + 5);
                                    pDVar3 = d2i_DSA_SIG(
                                        (DSA_SIG **)0x0, (uchar **)&local_144,
                                        uVar1 << 0x18 |
                                            (uVar1 >> 8 & 0xff) << 0x10 |
                                            (uVar1 >> 0x10 & 0xff) << 8 |
                                            uVar1 >> 0x18);
                                    if (pDVar3 == (DSA_SIG *)0x0) {
                                        iVar27 = 0x10f;
                                        BN_free(pBVar11);
                                        BN_free(pBVar10);
                                        BN_CTX_free(pBVar9);
                                        uVar12 = ERR_get_error();
                                        pcVar7 = ERR_error_string(uVar12,
                                                                  (char *)0x0);
                                        FUN_00074e00(3, "crypto_iff: %s",
                                                     pcVar7);
                                        uVar1 = *__src;
                                        uVar26 = uVar1 << 0x18 |
                                                 (uVar1 >> 8 & 0xff) << 0x10 |
                                                 (uVar1 >> 0x10 & 0xff) << 8 |
                                                 uVar1 >> 0x18;
                                        goto LAB_00038428;
                                    }
                                    DSA_get0_key(iVar27, &local_130, 0);
                                    DSA_get0_pqg(iVar27, &local_140, 0,
                                                 &local_13c);
                                    DSA_SIG_get0(pDVar3, &local_138,
                                                 &local_134);
                                    BN_mod_exp(pBVar11, local_130,
                                               *(BIGNUM **)(param_1 + 0xb0),
                                               local_140, pBVar9);
                                    BN_mod_exp(pBVar10, local_13c, local_138,
                                               local_140, pBVar9);
                                    BN_mod_mul(pBVar11, pBVar11, pBVar10,
                                               local_140, pBVar9);
                                    FUN_00036540(pBVar11, pBVar11);
                                    iVar27 = BN_cmp(pBVar11, local_134);
                                    BN_free(pBVar11);
                                    BN_free(pBVar10);
                                    BN_CTX_free(pBVar9);
                                    BN_free(*(BIGNUM **)(param_1 + 0xb0));
                                    *(undefined4 *)(param_1 + 0xb0) = 0;
                                    DSA_SIG_free(pDVar3);
                                    if (iVar27 == 0) {
                                        uVar1 = __src[3];
                                        *(uint *)(param_1 + 300) =
                                            *(uint *)(param_1 + 300) &
                                            0xffffff7f;
                                        *(uint *)(param_1 + 0x88) =
                                            *(uint *)(param_1 + 0x88) | 0x200;
                                        FUN_0007c054(
                                            auStack_12c, 0x100, "iff %s fs %u",
                                            *(undefined4 *)(param_1 + 0x98),
                                            uVar1 << 0x18 |
                                                (uVar1 >> 8 & 0xff) << 0x10 |
                                                (uVar1 >> 0x10 & 0xff) << 8 |
                                                uVar1 >> 0x18);
                                        goto LAB_00038c10;
                                    }
                                    pcVar7 =
                                        "crypto_iff: identity not verified";
                                }
                            }
                            goto LAB_000393c4;
                        }
                    } else {
                        if (uVar18 < 0x82070001) {
                            if (uVar18 == 0x82050000)
                                goto LAB_00038750;
                        LAB_000383e8:
                            if (uVar18 == 0x82060000) {
                                iVar27 = FUN_00036630(__src, 0, param_1);
                                if (iVar27 == 0x100) {
                                    iVar27 = FUN_0003816c(__src);
                                    if (iVar27 == 0) {
                                        uVar1 = *__src;
                                        iVar27 = 0x10d;
                                        uVar26 = uVar1 << 0x18 |
                                                 (uVar1 >> 8 & 0xff) << 0x10 |
                                                 (uVar1 >> 0x10 & 0xff) << 8 |
                                                 uVar1 >> 0x18;
                                        goto LAB_00038428;
                                    }
                                    uVar20 = *(undefined4 *)(iVar27 + 0x30);
                                    iVar17 = *(int *)(iVar27 + 0x10);
                                    uVar21 = *(undefined4 *)(iVar27 + 0x34);
                                    uVar2 = *(undefined4 *)(iVar27 + 4);
                                    *(uint *)(param_1 + 0x88) =
                                        *(uint *)(param_1 + 0x88) | 0x2000;
                                    *(uint *)(param_1 + 300) =
                                        *(uint *)(param_1 + 300) & 0xffffff7f;
                                    pcVar7 = OBJ_nid2ln(iVar17);
                                    uVar1 = __src[3];
                                    FUN_0007c054(
                                        auStack_12c, 0x100,
                                        "sign %s %s 0x%x %s (%u) fs %u", uVar20,
                                        uVar21, uVar2, pcVar7, iVar17,
                                        uVar1 << 0x18 |
                                            (uVar1 >> 8 & 0xff) << 0x10 |
                                            (uVar1 >> 0x10 & 0xff) << 8 |
                                            uVar1 >> 0x18);
                                LAB_00038e3c:
                                    local_18c = param_1 + 0x10;
                                    FUN_00052514(local_18c, auStack_12c);
                                    goto LAB_000386c4;
                                }
                                goto LAB_0003841c;
                            }
                            goto LAB_000385d0;
                        }
                    LAB_000384bc:
                        if (uVar18 == 0x82080000) {
                            iVar27 = FUN_00036630(__src, 0, param_1);
                            if (iVar27 == 0x100) {
                                iVar27 = *(int *)(param_1 + 0xac);
                                if (iVar27 == 0) {
                                    pcVar7 = "crypto_gq: scheme unavailable";
                                } else {
                                    uVar1 = __src[3];
                                    if ((uVar1 << 0x18 |
                                         (uVar1 >> 8 & 0xff) << 0x10 |
                                         (uVar1 >> 0x10 & 0xff) << 8 |
                                         uVar1 >> 0x18) <
                                        *(uint *)(iVar27 + 0xc)) {
                                        pcVar7 =
                                            "crypto_gq: invalid filestamp %u";
                                    LAB_00038528:
                                        iVar27 = 0x103;
                                        FUN_00074e00(5, pcVar7);
                                        uVar1 = *__src;
                                        uVar26 = uVar1 << 0x18 |
                                                 (uVar1 >> 8 & 0xff) << 0x10 |
                                                 (uVar1 >> 0x10 & 0xff) << 8 |
                                                 uVar1 >> 0x18;
                                        goto LAB_00038428;
                                    }
                                    iVar27 = EVP_PKEY_get0_RSA(
                                        *(undefined4 *)(iVar27 + 4));
                                    if (iVar27 == 0) {
                                        pcVar7 = "crypto_gq: defective key";
                                        goto LAB_000393a0;
                                    }
                                    RSA_get0_key(iVar27, &local_13c, 0,
                                                 &local_138);
                                    if (*(int *)(param_1 + 0xb0) == 0) {
                                        pcVar7 = "crypto_gq: missing challenge";
                                    } else {
                                        pBVar9 = BN_CTX_new();
                                        pBVar10 = BN_new();
                                        pBVar11 = BN_new();
                                        uVar1 = __src[4];
                                        local_140 = (BIGNUM *)(__src + 5);
                                        pDVar3 = d2i_DSA_SIG(
                                            (DSA_SIG **)0x0,
                                            (uchar **)&local_140,
                                            uVar1 << 0x18 |
                                                (uVar1 >> 8 & 0xff) << 0x10 |
                                                (uVar1 >> 0x10 & 0xff) << 8 |
                                                uVar1 >> 0x18);
                                        if (pDVar3 == (DSA_SIG *)0x0) {
                                            iVar27 = 0x10f;
                                            BN_CTX_free(pBVar9);
                                            BN_free(pBVar10);
                                            BN_free(pBVar11);
                                            uVar12 = ERR_get_error();
                                            pcVar7 = ERR_error_string(
                                                uVar12, (char *)0x0);
                                            FUN_00074e00(3, "crypto_gq: %s",
                                                         pcVar7);
                                            uVar1 = *__src;
                                            uVar26 =
                                                uVar1 << 0x18 |
                                                (uVar1 >> 8 & 0xff) << 0x10 |
                                                (uVar1 >> 0x10 & 0xff) << 8 |
                                                uVar1 >> 0x18;
                                            goto LAB_00038428;
                                        }
                                        DSA_SIG_get0(pDVar3, &local_134,
                                                     &local_130);
                                        if (*(BIGNUM **)(param_1 + 0xb4) ==
                                            (BIGNUM *)0x0) {
                                            pcVar7 =
                                                "crypto_gq: missing group key";
                                        } else {
                                            BN_mod_exp(
                                                pBVar11,
                                                *(BIGNUM **)(param_1 + 0xb4),
                                                *(BIGNUM **)(param_1 + 0xb0),
                                                local_13c, pBVar9);
                                            BN_mod_exp(pBVar10, local_134,
                                                       local_138, local_13c,
                                                       pBVar9);
                                            BN_mod_mul(pBVar10, pBVar11,
                                                       pBVar10, local_13c,
                                                       pBVar9);
                                            FUN_00036540(pBVar10, pBVar10);
                                            iVar27 = BN_cmp(pBVar10, local_130);
                                            BN_CTX_free(pBVar9);
                                            BN_free(pBVar10);
                                            BN_free(pBVar11);
                                            BN_free(
                                                *(BIGNUM **)(param_1 + 0xb0));
                                            *(undefined4 *)(param_1 + 0xb0) = 0;
                                            DSA_SIG_free(pDVar3);
                                            if (iVar27 == 0) {
                                                uVar1 = __src[3];
                                                *(uint *)(param_1 + 300) =
                                                    *(uint *)(param_1 + 300) &
                                                    0xffffff7f;
                                                *(uint *)(param_1 + 0x88) =
                                                    *(uint *)(param_1 + 0x88) |
                                                    0x200;
                                                FUN_0007c054(
                                                    auStack_12c, 0x100,
                                                    "gq %s fs %u",
                                                    *(undefined4 *)(param_1 +
                                                                    0x98),
                                                    uVar1 << 0x18 |
                                                        (uVar1 >> 8 & 0xff)
                                                            << 0x10 |
                                                        (uVar1 >> 0x10 & 0xff)
                                                            << 8 |
                                                        uVar1 >> 0x18);
                                                goto LAB_00038e3c;
                                            }
                                            pcVar7 = "crypto_gq: identity not "
                                                     "verified";
                                        }
                                    }
                                }
                            LAB_000393c4:
                                FUN_00074e00(5, pcVar7);
                                uVar1 = *__src;
                                iVar27 = 0x10e;
                                uVar26 = uVar1 << 0x18 |
                                         (uVar1 >> 8 & 0xff) << 0x10 |
                                         (uVar1 >> 0x10 & 0xff) << 8 |
                                         uVar1 >> 0x18;
                                goto LAB_00038428;
                            }
                        } else {
                            if (uVar18 != 0x82090000)
                                goto LAB_000385d0;
                            iVar27 = FUN_00036630(__src, 0, param_1);
                            if (iVar27 == 0x100) {
                                iVar27 = *(int *)(param_1 + 0xac);
                                if (iVar27 == 0) {
                                    pcVar7 = "crypto_mv: scheme unavailable";
                                } else {
                                    uVar1 = __src[3];
                                    if ((uVar1 << 0x18 |
                                         (uVar1 >> 8 & 0xff) << 0x10 |
                                         (uVar1 >> 0x10 & 0xff) << 8 |
                                         uVar1 >> 0x18) !=
                                        *(uint *)(iVar27 + 0xc)) {
                                        pcVar7 =
                                            "crypto_mv: invalid filestamp %u";
                                        goto LAB_00038528;
                                    }
                                    iVar27 = EVP_PKEY_get0_DSA(
                                        *(undefined4 *)(iVar27 + 4));
                                    if (iVar27 == 0) {
                                        pcVar7 = "crypto_mv: defective key";
                                        goto LAB_000393a0;
                                    }
                                    DSA_get0_pqg(iVar27, &local_144, 0);
                                    DSA_get0_key(iVar27, &local_140,
                                                 &local_13c);
                                    if (*(int *)(param_1 + 0xb0) == 0) {
                                        pcVar7 = "crypto_mv: missing challenge";
                                    } else {
                                        pBVar9 = BN_CTX_new();
                                        pBVar10 = BN_new();
                                        pBVar11 = BN_new();
                                        r = BN_new();
                                        uVar1 = __src[4];
                                        local_148 = __src + 5;
                                        r_00 = d2i_DSAparams(
                                            (DSA **)0x0, (uchar **)&local_148,
                                            uVar1 << 0x18 |
                                                (uVar1 >> 8 & 0xff) << 0x10 |
                                                (uVar1 >> 0x10 & 0xff) << 8 |
                                                uVar1 >> 0x18);
                                        if (r_00 == (DSA *)0x0) {
                                            uVar12 = ERR_get_error();
                                            pcVar7 = ERR_error_string(
                                                uVar12, (char *)0x0);
                                            iVar27 = 0x10f;
                                            FUN_00074e00(3, "crypto_mv: %s",
                                                         pcVar7);
                                            uVar1 = *__src;
                                            uVar26 =
                                                uVar1 << 0x18 |
                                                (uVar1 >> 8 & 0xff) << 0x10 |
                                                (uVar1 >> 0x10 & 0xff) << 8 |
                                                uVar1 >> 0x18;
                                            goto LAB_00038428;
                                        }
                                        DSA_get0_pqg(r_00, &local_138,
                                                     &local_134, &local_130);
                                        BN_mod_exp(pBVar11, local_134,
                                                   local_140, local_144,
                                                   pBVar9);
                                        BN_mod_exp(r, local_130, local_13c,
                                                   local_144, pBVar9);
                                        BN_mod_mul(pBVar11, pBVar11, r,
                                                   local_144, pBVar9);
                                        BN_mod_mul(pBVar11, pBVar11, local_138,
                                                   local_144, pBVar9);
                                        iVar27 = BN_cmp(
                                            pBVar11,
                                            *(BIGNUM **)(param_1 + 0xb0));
                                        BN_CTX_free(pBVar9);
                                        BN_free(pBVar10);
                                        BN_free(pBVar11);
                                        BN_free(r);
                                        BN_free(*(BIGNUM **)(param_1 + 0xb0));
                                        *(undefined4 *)(param_1 + 0xb0) = 0;
                                        DSA_free(r_00);
                                        if (iVar27 == 0) {
                                            uVar1 = __src[3];
                                            *(uint *)(param_1 + 300) =
                                                *(uint *)(param_1 + 300) &
                                                0xffffff7f;
                                            *(uint *)(param_1 + 0x88) =
                                                *(uint *)(param_1 + 0x88) |
                                                0x200;
                                            FUN_0007c054(
                                                auStack_12c, 0x100,
                                                "mv %s fs %u",
                                                *(undefined4 *)(param_1 + 0x98),
                                                uVar1 << 0x18 |
                                                    (uVar1 >> 8 & 0xff)
                                                        << 0x10 |
                                                    (uVar1 >> 0x10 & 0xff)
                                                        << 8 |
                                                    uVar1 >> 0x18);
                                            goto LAB_00038e3c;
                                        }
                                        pcVar7 =
                                            "crypto_mv: identity not verified";
                                    }
                                }
                                goto LAB_000393c4;
                            }
                        }
                    }
                LAB_0003841c:
                    uVar1 = *__src;
                    uVar26 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                             (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
                    goto LAB_00038428;
                }
                if (uVar18 == 0x82010000)
                    goto LAB_000386a8;
                if (uVar18 < 0x82010001) {
                LAB_0003863c:
                    if (uVar18 != 0x2010000)
                        goto LAB_000385d0;
                    if ((*(uint *)(param_1 + 0x88) & 0x100) == 0) {
                        if (*(void **)(param_1 + 0xe8) != (void *)0x0) {
                            if (*(ushort *)(param_1 + 0x84) != uVar14)
                                goto LAB_00038f74;
                            free(*(void **)(param_1 + 0xe8));
                        }
                        pvVar5 = (void *)FUN_00073ba4(0, uVar22, 0);
                        pvVar5 = memcpy(pvVar5, __src, uVar22);
                        *(uint *)((int)pvVar5 + 4) =
                            (uint) * (ushort *)(param_1 + 0x3c) << 0x18 |
                            (uint)(*(ushort *)(param_1 + 0x3c) >> 8) << 0x10;
                        *(void **)(param_1 + 0xe8) = pvVar5;
                        goto LAB_000386a8;
                    }
                } else {
                    if (uVar18 == 0x82020000) {
                        iVar27 = FUN_00036630(__src, 0, param_1);
                        if (iVar27 != 0x100)
                            goto LAB_00038590;
                        iVar27 = FUN_0003816c(__src);
                        if (iVar27 == 0) {
                            uVar1 = *__src;
                            iVar27 = 0x10d;
                            uVar26 =
                                uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
                            goto LAB_00038428;
                        }
                        if (*(void **)(param_1 + 0x98) != (void *)0x0) {
                            free(*(void **)(param_1 + 0x98));
                        }
                        uVar2 = FUN_00073d08(*(undefined4 *)(iVar27 + 0x34));
                        iVar19 = *(int *)(param_1 + 0x9c);
                        *(undefined4 *)(param_1 + 0x98) = uVar2;
                        *(int *)(param_1 + 0x9c) = iVar27;
                        iVar17 = strcmp(*(char **)(iVar27 + 0x30),
                                        *(char **)(iVar27 + 0x34));
                        if (iVar17 == 0) {
                            if ((*(uint *)(iVar27 + 4) & 1) != 0) {
                                uVar1 = *(uint *)(param_1 + 0x88);
                                uVar2 = *(undefined4 *)(iVar27 + 0x38);
                                *(uint *)(param_1 + 0x88) = uVar1 | 0x100;
                                *(undefined4 *)(param_1 + 0xb4) = uVar2;
                                if ((*(int *)(param_1 + 0x50) == 0) ||
                                    ((uVar1 & 0xf0) == 0)) {
                                    *(uint *)(param_1 + 0x88) = uVar1 | 0x300;
                                }
                                goto LAB_00038cec;
                            }
                        } else {
                        LAB_00038cec:
                            if (iVar19 != 0) {
                                local_130 = *(BIGNUM **)(iVar19 + 0x48);
                                uVar1 = *(uint *)(iVar19 + 0x44);
                                pXVar6 =
                                    d2i_X509((X509 **)0x0, (uchar **)&local_130,
                                             uVar1 << 0x18 |
                                                 (uVar1 >> 8 & 0xff) << 0x10 |
                                                 (uVar1 >> 0x10 & 0xff) << 8 |
                                                 uVar1 >> 0x18);
                                if (pXVar6 == (X509 *)0x0) {
                                    uVar1 = *__src;
                                    iVar27 = 0x10d;
                                    uVar26 = uVar1 << 0x18 |
                                             (uVar1 >> 8 & 0xff) << 0x10 |
                                             (uVar1 >> 0x10 & 0xff) << 8 |
                                             uVar1 >> 0x18;
                                    *(uint *)(iVar19 + 4) =
                                        *(uint *)(iVar19 + 4) | 0x80;
                                } else {
                                    iVar17 = X509_verify(
                                        pXVar6, *(EVP_PKEY **)(iVar27 + 8));
                                    if (iVar17 < 1) {
                                        X509_free(pXVar6);
                                        uVar1 = *__src;
                                        iVar27 = 0x109;
                                        uVar26 = uVar1 << 0x18 |
                                                 (uVar1 >> 8 & 0xff) << 0x10 |
                                                 (uVar1 >> 0x10 & 0xff) << 8 |
                                                 uVar1 >> 0x18;
                                        *(uint *)(iVar19 + 4) =
                                            *(uint *)(iVar19 + 4) | 0x80;
                                    } else {
                                        X509_free(pXVar6);
                                        iVar17 = FUN_000368a4(iVar19 + 0x1c,
                                                              iVar27 + 0x1c);
                                        if (iVar17 < 0) {
                                            uVar1 = *(uint *)(iVar19 + 4);
                                        } else {
                                            iVar17 = FUN_000368a4(
                                                iVar19 + 0x1c, iVar27 + 0x26);
                                            uVar1 = *(uint *)(iVar19 + 4);
                                            if (iVar17 < 1) {
                                                *(uint *)(iVar19 + 4) =
                                                    uVar1 | 2;
                                                goto LAB_00039458;
                                            }
                                        }
                                        uVar15 = *__src;
                                        *(uint *)(iVar19 + 4) = uVar1 | 0x80;
                                        iVar27 = 0x10a;
                                        uVar26 = uVar15 << 0x18 |
                                                 (uVar15 >> 8 & 0xff) << 0x10 |
                                                 (uVar15 >> 0x10 & 0xff) << 8 |
                                                 uVar15 >> 0x18;
                                    }
                                }
                                goto LAB_00038428;
                            }
                        }
                    LAB_00039458:
                        if (*(int *)(param_1 + 0x8c) == 0) {
                            local_14c = *(uchar **)(iVar27 + 0x48);
                            uVar1 = *(uint *)(iVar27 + 0x44);
                            pXVar6 = d2i_X509((X509 **)0x0, &local_14c,
                                              uVar1 << 0x18 |
                                                  (uVar1 >> 8 & 0xff) << 0x10 |
                                                  (uVar1 >> 0x10 & 0xff) << 8 |
                                                  uVar1 >> 0x18);
                            pEVar13 = X509_get_pubkey(pXVar6);
                            *(EVP_PKEY **)(param_1 + 0x8c) = pEVar13;
                            X509_free(pXVar6);
                        }
                        uVar2 = *(undefined4 *)(iVar27 + 0x30);
                        iVar17 = *(int *)(iVar27 + 0x10);
                        uVar20 = *(undefined4 *)(iVar27 + 0x34);
                        *(uint *)(param_1 + 300) =
                            *(uint *)(param_1 + 300) & 0xffffff7f;
                        uVar21 = *(undefined4 *)(iVar27 + 4);
                        pcVar7 = OBJ_nid2ln(iVar17);
                        uVar1 = __src[3];
                        FUN_0007c054(
                            auStack_12c, 0x100, "cert %s %s 0x%x %s (%u) fs %u",
                            uVar2, uVar20, uVar21, pcVar7, iVar17,
                            uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                                (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18);
                        goto LAB_00038c10;
                    }
                    uVar1 = uVar24;
                    if (uVar18 == 0x82030000)
                        goto LAB_00038574;
                LAB_000385d0:
                    if ((uVar18 & 0xc0000000) == 0) {
                        if (*(int *)(param_1 + 0xe8) == 0) {
                            pvVar5 = (void *)FUN_00073ba4(0, uVar22, 0);
                            pvVar5 = memcpy(pvVar5, __src, uVar22);
                            *(void **)(param_1 + 0xe8) = pvVar5;
                            iVar27 = *(int *)(param_2 + 0x54);
                        }
                        goto LAB_000385e4;
                    }
                }
            LAB_00038f74:
                iVar27 = 0x10f;
                goto LAB_00038428;
            }
        LAB_0003884c:
            iVar27 = FUN_00036630(__src, param_1 + 0xd0, param_1);
            if (iVar27 != 0x100)
                goto LAB_00038590;
            if ((((*(byte *)(param_1 + 0x48) & 0x20) != 0) &&
                 (*(ushort *)(param_1 + 0x84) != uVar14)) ||
                (uVar1 = __src[2], uVar1 == 0))
                goto LAB_000386c4;
            puVar8 = *(uint **)(param_1 + 0xdc);
            if (puVar8 == (uint *)0x0) {
                puVar8 = (uint *)FUN_00073ba4(0, 8, 0, 0);
                uVar1 = __src[2];
                *(uint **)(param_1 + 0xdc) = puVar8;
            }
            uVar25 = __src[5];
            uVar28 = __src[6];
            uVar18 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                     (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
            uVar14 = __src[3];
            uVar29 = *(uint *)(param_1 + 300);
            uVar26 = *(uint *)(param_1 + 0x88);
            uVar25 = uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                     (uVar25 >> 0x10 & 0xff) << 8 | uVar25 >> 0x18;
            uVar28 = uVar28 << 0x18 | (uVar28 >> 8 & 0xff) << 0x10 |
                     (uVar28 >> 0x10 & 0xff) << 8 | uVar28 >> 0x18;
            *(uint *)(param_1 + 0xd0) = uVar1;
            *(uint *)(param_1 + 0xd4) = uVar14;
            *puVar8 = uVar25;
            puVar8[1] = uVar28;
            pcVar7 = (char *)(uVar14 << 0x18 | (uVar14 >> 8 & 0xff) << 0x10 |
                              (uVar14 >> 0x10 & 0xff) << 8 | uVar14 >> 0x18);
            *(uint *)(param_1 + 0xa0) = uVar25;
            *(uint *)(param_1 + 0x88) = uVar26 | 0x1000;
            *(uint *)(param_1 + 300) = uVar29 & 0xffffff7f;
            pcVar16 = "auto seq %d key %x ts %u fs %u";
        LAB_00038c0c:
            FUN_0007c054(auStack_12c, 0x100, pcVar16, uVar28, uVar25, uVar18,
                         pcVar7);
        LAB_00038c10:
            FUN_00052514(param_1 + 0x10, auStack_12c);
            iVar27 = *(int *)(param_2 + 0x54);
        LAB_000385e4:
            iVar23 = (uVar22 + 3 & 0xfffffffc) + iVar23;
            uVar1 = iVar27 - iVar23;
        } while (0x18 < (int)uVar1);
    }
    iVar27 = 0x100;
LAB_00038468:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar27);
    }
    return;
}

void FUN_00039774(BIGNUM *param_1, int param_2, int param_3, int param_4,
                  uint *param_5, undefined1 *param_6)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    undefined4 uVar4;
    BIGNUM *pBVar5;
    BIGNUM *pBVar6;
    BIGNUM *pBVar7;
    DSA *a;
    BIGNUM *r;
    BIGNUM *r_00;
    BIGNUM *r_01;
    int iVar8;
    BIGNUM *pBVar9;
    EVP_MD_CTX *pEVar10;
    int iVar11;
    RSA *rsa;
    BIGNUM *extraout_r0;
    BIGNUM *extraout_r0_00;
    undefined4 uVar12;
    BIGNUM *extraout_r0_01;
    BN_CTX *pBVar13;
    DSA_SIG *pDVar14;
    X509 *x;
    EVP_PKEY *pEVar15;
    X509 *x_00;
    long version;
    ASN1_INTEGER *a_00;
    ASN1_TIME *pAVar16;
    X509_NAME *pXVar17;
    size_t len;
    X509_EXTENSION *ex;
    int iVar18;
    ulong uVar19;
    char *pcVar20;
    int iVar21;
    uint uVar22;
    BIGNUM *pBVar23;
    uint uVar24;
    uint uVar25;
    undefined1 *puVar26;
    int *piVar27;
    int iVar28;
    int *piVar29;
    int *piVar30;
    int *piVar31;
    uint uVar32;
    bool bVar33;
    int *local_294;
    undefined1 *local_288;
    BIGNUM *local_26c;
    BIGNUM *local_268;
    BIGNUM *local_264;
    BIGNUM *local_260;
    BIGNUM *local_25c;
    BIGNUM *local_258;
    BIGNUM *local_254;
    undefined4 local_250;
    BIGNUM *local_248;
    uint local_244;
    uint local_240;
    BIGNUM *local_23c;
    uint local_238;
    uchar *local_234;
    char acStack_230[516];
    int local_2c;

    iVar11 = param_4 + 3;
    if (-1 < param_4) {
        iVar11 = param_4;
    }
    iVar11 = iVar11 >> 2;
    iVar21 = param_2 + iVar11 * 4;
    uVar24 = *param_5;
    local_288 = param_6;
    local_2c = __stack_chk_guard;
    uVar25 = uVar24 >> 8 & 0xff;
    uVar22 = uVar24 << 0x18 | uVar25 << 0x10;
    uVar1 = (uVar24 >> 0x10 & 0xff) << 8;
    uVar32 = uVar22 | uVar1 | uVar24 >> 0x18;
    if (param_1 == (BIGNUM *)0x0) {
        local_294 = (int *)(param_3 + 4);
    } else {
        local_294 = &param_1->flags;
        if (-1 < (int)uVar32) {
            param_1[6].dmax = uVar24;
        }
    }
    uVar3 = param_5[1];
    local_244 = 0;
    uVar2 = (uVar3 >> 0x10 & 0xff) << 8;
    local_248 = (BIGNUM *)0x0;
    *(uint *)(param_2 + iVar11 * 4) = uVar25 << 8 | 0x8000000 | uVar24 & 0xff;
    *(uint *)(param_2 + iVar11 * 4 + 4) = uVar3;
    if (sys_leap != '\x03') {
        FUN_0006f724(&local_248);
    }
    pBVar23 = local_248;
    if (uVar22 == 0x82010000) {
    LAB_0003ac6c:
        uVar4 = FUN_0003637c(iVar21, hostval, param_4);
        *(uint *)(iVar21 + 0xc) =
            crypto_flags << 0x18 | (crypto_flags >> 8 & 0xff) << 0x10 |
            (crypto_flags >> 0x10 & 0xff) << 8 | crypto_flags >> 0x18;
        goto LAB_0003a138;
    }
    if (uVar22 < 0x82010001) {
        if (uVar22 == 0x2060000) {
            FUN_00076750(&local_254, local_248, 0);
            iVar8 = cert_host;
            iVar28 = FUN_000368a4(&local_254, cert_host + 0x1c);
            if ((-1 < iVar28) &&
                (iVar28 = FUN_000368a4(&local_254, iVar8 + 0x26), iVar28 < 1)) {
                uVar4 = FUN_0003637c(iVar21, iVar8 + 0x3c, param_4);
                goto LAB_0003a138;
            }
            uVar4 = 0x10a;
            goto LAB_0003a338;
        }
        if (uVar22 < 0x2060001) {
            if (uVar22 == 0x2020000) {
                local_248 = (BIGNUM *)param_5[2];
                local_244 = param_5[3];
                local_23c = (BIGNUM *)(param_5 + 5);
                local_240 = param_5[4];
                local_234 = (uchar *)0x0;
                local_238 = 0;
                uVar4 = FUN_0003637c(iVar21, &local_248, param_4);
                goto LAB_0003a138;
            }
            if (uVar22 != 0x2030000) {
                if (uVar22 == 0x2010000)
                    goto LAB_0003ac6c;
                goto LAB_00039c0c;
            }
            iVar11 = 0x8c4;
            goto LAB_0003a124;
        }
        if (uVar22 == 0x2080000) {
            if (param_1 != (BIGNUM *)0x0) {
                if (param_1[8].neg == 0) {
                LAB_0003af20:
                    uVar4 = 0x10e;
                } else {
                    iVar8 =
                        EVP_PKEY_get0_RSA(*(undefined4 *)(param_1[8].neg + 4));
                    if (iVar8 != 0) {
                        if ((BIGNUM *)param_1[8].flags != (BIGNUM *)0x0) {
                            BN_free((BIGNUM *)param_1[8].flags);
                        }
                        pBVar23 = BN_new();
                        param_1[8].flags = (int)pBVar23;
                        RSA_get0_key(iVar8, &local_258, 0);
                        iVar11 = BN_num_bits(local_258);
                        iVar8 = iVar11 + 7;
                        if (iVar8 < 0) {
                            iVar8 = iVar11 + 0xe;
                        }
                        local_25c = (BIGNUM *)(iVar8 >> 3);
                        BN_rand((BIGNUM *)param_1[8].flags, (int)local_25c << 3,
                                -1, 1);
                        pBVar5 = (BIGNUM *)BN_CTX_new();
                        BN_div((BIGNUM *)0x0, (BIGNUM *)param_1[8].flags,
                               (BIGNUM *)param_1[8].flags, local_258,
                               (BN_CTX *)pBVar5);
                        BN_CTX_free((BN_CTX *)pBVar5);
                        local_248 = (BIGNUM *)0x0;
                        local_250 = 0;
                        bVar33 = sys_leap == '\x03';
                        local_254 = (BIGNUM *)0x0;
                        pBVar23 = extraout_r0;
                        if (bVar33) {
                            pBVar23 = (BIGNUM *)0x0;
                        }
                        local_244 = 0;
                        local_240 = 0;
                        if (bVar33) {
                            pBVar5 = pBVar23;
                        }
                        local_23c = (BIGNUM *)0x0;
                        local_238 = 0;
                        local_234 = (uchar *)0x0;
                        if (!bVar33) {
                            FUN_0006f724(&local_254);
                            pBVar23 =
                                (BIGNUM *)((int)local_254 << 0x18 |
                                           ((uint)local_254 >> 8 & 0xff)
                                               << 0x10 |
                                           ((uint)local_254 >> 0x10 & 0xff)
                                               << 8 |
                                           (uint)local_254 >> 0x18);
                            pBVar5 = local_254;
                        }
                        uVar25 = *(uint *)(param_1[8].neg + 0xc);
                        local_240 = (int)local_25c << 0x18 |
                                    ((uint)local_25c >> 8 & 0xff) << 0x10 |
                                    ((uint)local_25c >> 0x10 & 0xff) << 8 |
                                    (uint)local_25c >> 0x18;
                        local_244 =
                            uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                            (uVar25 >> 0x10 & 0xff) << 8 | uVar25 >> 0x18;
                        local_248 = pBVar23;
                        local_23c = (BIGNUM *)FUN_00073ba4(0, local_25c, 0);
                        BN_bn2bin((BIGNUM *)param_1[8].flags,
                                  (uchar *)local_23c);
                        if (pBVar5 != (BIGNUM *)0x0) {
                            local_234 =
                                (uchar *)FUN_00073ba4(0, DAT_000c98e4, 0);
                            pEVar10 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                            EVP_DigestInit(pEVar10, DAT_000c98e8);
                            EVP_DigestUpdate(pEVar10, &local_248, 0xc);
                            EVP_DigestUpdate(pEVar10, local_23c,
                                             (size_t)local_25c);
                            iVar11 =
                                EVP_SignFinal(pEVar10, local_234,
                                              (uint *)&local_25c, DAT_000c98e0);
                            if (iVar11 != 0) {
                                pBVar23 = local_25c;
                                if (DAT_000c98e4 < local_25c) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007ecc0("ntp_crypto.c", 0x9fa, 2,
                                                 "len <= sign_siglen");
                                }
                            LAB_0003a9d4:
                                local_238 =
                                    (int)pBVar23 << 0x18 |
                                    ((uint)pBVar23 >> 8 & 0xff) << 0x10 |
                                    ((uint)pBVar23 >> 0x10 & 0xff) << 8 |
                                    (uint)pBVar23 >> 0x18;
                            }
                        LAB_0003a9dc:
                            EVP_MD_CTX_free(pEVar10);
                        }
                    LAB_0003ac3c:
                        uVar4 = FUN_0003637c(iVar21, &local_248, param_4);
                        FUN_00037b48(&local_248);
                        goto LAB_0003a138;
                    }
                    uVar4 = 0x104;
                    FUN_00074e00(5, "crypto_alice2: defective key");
                }
                goto LAB_0003a338;
            }
        } else if (uVar22 == 0x2090000) {
            if (param_1 != (BIGNUM *)0x0) {
                if (param_1[8].neg == 0)
                    goto LAB_0003af20;
                iVar8 = EVP_PKEY_get0_DSA(*(undefined4 *)(param_1[8].neg + 4));
                if (iVar8 != 0) {
                    DSA_get0_pqg(iVar8, &local_258, 0);
                    if ((BIGNUM *)param_1[8].flags != (BIGNUM *)0x0) {
                        BN_free((BIGNUM *)param_1[8].flags);
                    }
                    pBVar23 = BN_new();
                    param_1[8].flags = (int)pBVar23;
                    iVar11 = BN_num_bits(local_258);
                    iVar8 = iVar11 + 7;
                    if (iVar8 < 0) {
                        iVar8 = iVar11 + 0xe;
                    }
                    local_25c = (BIGNUM *)(iVar8 >> 3);
                    BN_rand((BIGNUM *)param_1[8].flags, (int)local_25c << 3, -1,
                            1);
                    pBVar5 = (BIGNUM *)BN_CTX_new();
                    BN_div((BIGNUM *)0x0, (BIGNUM *)param_1[8].flags,
                           (BIGNUM *)param_1[8].flags, local_258,
                           (BN_CTX *)pBVar5);
                    BN_CTX_free((BN_CTX *)pBVar5);
                    local_248 = (BIGNUM *)0x0;
                    local_250 = 0;
                    bVar33 = sys_leap == '\x03';
                    local_254 = (BIGNUM *)0x0;
                    pBVar23 = extraout_r0_01;
                    if (bVar33) {
                        pBVar23 = (BIGNUM *)0x0;
                    }
                    local_244 = 0;
                    local_240 = 0;
                    if (bVar33) {
                        pBVar5 = pBVar23;
                    }
                    local_23c = (BIGNUM *)0x0;
                    local_238 = 0;
                    local_234 = (uchar *)0x0;
                    if (!bVar33) {
                        FUN_0006f724(&local_254);
                        pBVar23 =
                            (BIGNUM *)((int)local_254 << 0x18 |
                                       ((uint)local_254 >> 8 & 0xff) << 0x10 |
                                       ((uint)local_254 >> 0x10 & 0xff) << 8 |
                                       (uint)local_254 >> 0x18);
                        pBVar5 = local_254;
                    }
                    uVar25 = *(uint *)(param_1[8].neg + 0xc);
                    local_240 = (int)local_25c << 0x18 |
                                ((uint)local_25c >> 8 & 0xff) << 0x10 |
                                ((uint)local_25c >> 0x10 & 0xff) << 8 |
                                (uint)local_25c >> 0x18;
                    local_244 = uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                                (uVar25 >> 0x10 & 0xff) << 8 | uVar25 >> 0x18;
                    local_248 = pBVar23;
                    local_23c = (BIGNUM *)FUN_00073ba4(0, local_25c, 0);
                    BN_bn2bin((BIGNUM *)param_1[8].flags, (uchar *)local_23c);
                    if (pBVar5 != (BIGNUM *)0x0) {
                        local_234 = (uchar *)FUN_00073ba4(0, DAT_000c98e4, 0);
                        pEVar10 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                        EVP_DigestInit(pEVar10, DAT_000c98e8);
                        EVP_DigestUpdate(pEVar10, &local_248, 0xc);
                        EVP_DigestUpdate(pEVar10, local_23c, (size_t)local_25c);
                        iVar11 =
                            EVP_SignFinal(pEVar10, local_234,
                                          (uint *)&local_25c, DAT_000c98e0);
                        if (iVar11 != 0) {
                            pBVar23 = local_25c;
                            if (DAT_000c98e4 < local_25c) {
                                /* WARNING: Subroutine does not return */
                                FUN_0007ecc0("ntp_crypto.c", 0xb52, 2,
                                             "len <= sign_siglen");
                            }
                            goto LAB_0003a9d4;
                        }
                        goto LAB_0003a9dc;
                    }
                    goto LAB_0003ac3c;
                }
                uVar4 = 0x104;
                FUN_00074e00(5, "crypto_alice3: defective key");
                goto LAB_0003a338;
            }
        } else {
            if (uVar22 != 0x2070000)
                goto LAB_00039c0c;
            if (param_1 != (BIGNUM *)0x0) {
                if (param_1[8].neg == 0) {
                    uVar4 = 0x10e;
                    FUN_00074e00(5, "crypto_alice: scheme unavailable");
                } else {
                    iVar8 =
                        EVP_PKEY_get0_DSA(*(undefined4 *)(param_1[8].neg + 4));
                    if (iVar8 != 0) {
                        if ((BIGNUM *)param_1[8].flags != (BIGNUM *)0x0) {
                            BN_free((BIGNUM *)param_1[8].flags);
                        }
                        pBVar23 = BN_new();
                        param_1[8].flags = (int)pBVar23;
                        DSA_get0_pqg(iVar8, 0, &local_258);
                        iVar11 = BN_num_bits(local_258);
                        iVar8 = iVar11 + 7;
                        if (iVar8 < 0) {
                            iVar8 = iVar11 + 0xe;
                        }
                        local_25c = (BIGNUM *)(iVar8 >> 3);
                        BN_rand((BIGNUM *)param_1[8].flags, (int)local_25c << 3,
                                -1, 1);
                        pBVar5 = (BIGNUM *)BN_CTX_new();
                        BN_div((BIGNUM *)0x0, (BIGNUM *)param_1[8].flags,
                               (BIGNUM *)param_1[8].flags, local_258,
                               (BN_CTX *)pBVar5);
                        BN_CTX_free((BN_CTX *)pBVar5);
                        local_248 = (BIGNUM *)0x0;
                        local_250 = 0;
                        bVar33 = sys_leap == '\x03';
                        local_254 = (BIGNUM *)0x0;
                        pBVar23 = extraout_r0_00;
                        if (bVar33) {
                            pBVar23 = (BIGNUM *)0x0;
                        }
                        local_244 = 0;
                        local_240 = 0;
                        if (bVar33) {
                            pBVar5 = pBVar23;
                        }
                        local_23c = (BIGNUM *)0x0;
                        local_238 = 0;
                        local_234 = (uchar *)0x0;
                        if (!bVar33) {
                            FUN_0006f724(&local_254);
                            pBVar23 =
                                (BIGNUM *)((int)local_254 << 0x18 |
                                           ((uint)local_254 >> 8 & 0xff)
                                               << 0x10 |
                                           ((uint)local_254 >> 0x10 & 0xff)
                                               << 8 |
                                           (uint)local_254 >> 0x18);
                            pBVar5 = local_254;
                        }
                        uVar25 = *(uint *)(param_1[8].neg + 0xc);
                        local_240 = (int)local_25c << 0x18 |
                                    ((uint)local_25c >> 8 & 0xff) << 0x10 |
                                    ((uint)local_25c >> 0x10 & 0xff) << 8 |
                                    (uint)local_25c >> 0x18;
                        local_244 =
                            uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                            (uVar25 >> 0x10 & 0xff) << 8 | uVar25 >> 0x18;
                        local_248 = pBVar23;
                        local_23c = (BIGNUM *)FUN_00073ba4(0, local_25c, 0);
                        BN_bn2bin((BIGNUM *)param_1[8].flags,
                                  (uchar *)local_23c);
                        if (pBVar5 != (BIGNUM *)0x0) {
                            local_234 =
                                (uchar *)FUN_00073ba4(0, DAT_000c98e4, 0);
                            pEVar10 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                            EVP_DigestInit(pEVar10, DAT_000c98e8);
                            EVP_DigestUpdate(pEVar10, &local_248, 0xc);
                            EVP_DigestUpdate(pEVar10, local_23c,
                                             (size_t)local_25c);
                            iVar11 =
                                EVP_SignFinal(pEVar10, local_234,
                                              (uint *)&local_25c, DAT_000c98e0);
                            if (iVar11 != 0) {
                                pBVar23 = local_25c;
                                if (DAT_000c98e4 < local_25c) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007ecc0("ntp_crypto.c", 0x8b0, 2,
                                                 "len <= sign_siglen");
                                }
                                goto LAB_0003a9d4;
                            }
                            goto LAB_0003a9dc;
                        }
                        goto LAB_0003ac3c;
                    }
                    uVar4 = 0x104;
                    FUN_00074e00(5, "crypto_alice: defective key");
                }
                goto LAB_0003a338;
            }
        }
    } else {
        if (uVar22 == 0x82050000) {
            iVar11 = 0xa08;
        LAB_0003a124:
            uVar4 = FUN_0003637c(
                iVar21, *(undefined4 *)((int)&__DT_PLTGOT + iVar11), param_4);
            goto LAB_0003a138;
        }
        if (uVar22 < 0x82050001) {
            if (uVar22 == 0x82030000) {
                uVar25 = param_5[4];
                pBVar23 =
                    (BIGNUM *)(uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                               (uVar25 >> 0x10 & 0xff) << 8 | uVar25 >> 0x18);
                if (((undefined1 *)((int)&pBVar23[-1].flags + 3U) <
                     (undefined1 *)0xffe6) &&
                    (puVar26 = (undefined1 *)(uVar1 | uVar24 >> 0x18),
                     &pBVar23[1].top <= puVar26)) {
                    local_25c = (BIGNUM *)(param_5 + 5);
                    if (param_1 != (BIGNUM *)0x0) {
                        puVar26 = (undefined1 *)param_1[8].top;
                    }
                    if (param_1 != (BIGNUM *)0x0) {
                        local_288 = puVar26;
                    }
                    local_258 = pBVar23;
                    pEVar15 =
                        d2i_PublicKey(6, (EVP_PKEY **)0x0, (uchar **)&local_25c,
                                      (long)pBVar23);
                    if (pEVar15 == (EVP_PKEY *)0x0) {
                        uVar19 = ERR_get_error();
                        uVar4 = 0x104;
                        pcVar20 = ERR_error_string(uVar19, (char *)0x0);
                        FUN_00074e00(3, "crypto_encrypt: %s", pcVar20);
                    } else {
                        pBVar23 = (BIGNUM *)0x0;
                        local_248 = (BIGNUM *)0x0;
                        local_250 = 0;
                        local_254 = (BIGNUM *)0x0;
                        local_244 = 0;
                        if (sys_leap == '\x03') {
                            param_1 = (BIGNUM *)0x0;
                        }
                        local_240 = 0;
                        local_23c = (BIGNUM *)0x0;
                        local_238 = 0;
                        local_234 = (uchar *)0x0;
                        if (sys_leap != '\x03') {
                            FUN_0006f724(&local_254);
                            pBVar23 =
                                (BIGNUM *)((int)local_254 << 0x18 |
                                           ((uint)local_254 >> 8 & 0xff)
                                               << 0x10 |
                                           ((uint)local_254 >> 0x10 & 0xff)
                                               << 8 |
                                           (uint)local_254 >> 0x18);
                            param_1 = local_254;
                        }
                        local_244 = hostval._0_4_;
                        local_248 = pBVar23;
                        local_258 = (BIGNUM *)EVP_PKEY_size(pEVar15);
                        local_240 = (int)local_258 << 0x18 |
                                    ((uint)local_258 >> 8 & 0xff) << 0x10 |
                                    ((uint)local_258 >> 0x10 & 0xff) << 8 |
                                    (uint)local_258 >> 0x18;
                        pBVar23 = (BIGNUM *)FUN_00073ba4(0, local_258, 0);
                        local_254 =
                            (BIGNUM *)((int)local_288 << 0x18 |
                                       ((uint)local_288 >> 8 & 0xff) << 0x10 |
                                       ((uint)local_288 >> 0x10 & 0xff) << 8 |
                                       (uint)local_288 >> 0x18);
                        local_23c = pBVar23;
                        rsa = (RSA *)EVP_PKEY_get0_RSA(pEVar15);
                        iVar8 = RSA_public_encrypt(4, (uchar *)&local_254,
                                                   (uchar *)pBVar23, rsa, 4);
                        if (0 < iVar8) {
                            EVP_PKEY_free(pEVar15);
                            if (param_1 != (BIGNUM *)0x0) {
                                local_234 =
                                    (uchar *)FUN_00073ba4(0, DAT_000c98e4, 0);
                                pEVar10 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                                EVP_DigestInit(pEVar10, DAT_000c98e8);
                                EVP_DigestUpdate(pEVar10, &local_248, 0xc);
                                EVP_DigestUpdate(pEVar10, local_23c,
                                                 (size_t)local_258);
                                iVar11 = EVP_SignFinal(pEVar10, local_234,
                                                       (uint *)&local_258,
                                                       DAT_000c98e0);
                                if (iVar11 != 0) {
                                    pBVar23 = local_258;
                                    if (DAT_000c98e4 < local_258) {
                                        /* WARNING: Subroutine does not return
                                         */
                                        FUN_0007ecc0("ntp_crypto.c", 0x65f, 2,
                                                     "vallen <= sign_siglen");
                                    }
                                    goto LAB_0003a9d4;
                                }
                                goto LAB_0003a9dc;
                            }
                            goto LAB_0003ac3c;
                        }
                        uVar19 = ERR_get_error();
                        uVar4 = 0x10b;
                        pcVar20 = ERR_error_string(uVar19, (char *)0x0);
                        FUN_00074e00(3, "crypto_encrypt: %s", pcVar20);
                        free(local_23c);
                        EVP_PKEY_free(pEVar15);
                    }
                    goto LAB_0003a338;
                }
            } else {
                if (uVar22 == 0x82040000) {
                    if ((param_1 != (BIGNUM *)0x0) ||
                        (param_1 =
                             (BIGNUM *)FUN_00041c78(uVar2 | uVar3 >> 0x18),
                         param_1 != (BIGNUM *)0x0)) {
                        param_1[3].dmax = param_1[3].dmax & 0xffff7fff;
                        uVar4 =
                            FUN_0003637c(iVar21, &param_1[0xd].neg, param_4);
                        goto LAB_0003a138;
                    }
                LAB_00039c14:
                    uVar4 = 0x10f;
                    goto LAB_0003a338;
                }
                if (uVar22 != 0x82020000)
                    goto LAB_00039c0c;
                uVar25 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
                if (0x13 < uVar25) {
                    uVar22 = param_5[4];
                    uVar22 = uVar22 << 0x18 | (uVar22 >> 8 & 0xff) << 0x10 |
                             (uVar22 >> 0x10 & 0xff) << 8 | uVar22 >> 0x18;
                    if ((uVar22 <= uVar25 - 0x14) && (uVar22 - 1 < 0x200)) {
                        __memcpy_chk(acStack_230, param_5 + 5, uVar22, 0x201);
                        acStack_230[uVar22] = '\0';
                        if (cinfo != (int *)0x0) {
                            piVar31 = (int *)0x0;
                            piVar27 = cinfo;
                            piVar29 = (int *)0x0;
                            do {
                                uVar25 = piVar27[1];
                                piVar30 = piVar29;
                                if (((((uVar25 & 0x88) == 0) &&
                                      (iVar11 = strcmp(acStack_230,
                                                       (char *)piVar27[0xc]),
                                       iVar11 == 0)) &&
                                     (iVar11 = strcmp(acStack_230,
                                                      (char *)piVar27[0xd]),
                                      piVar30 = piVar27, iVar11 == 0)) &&
                                    (piVar30 = piVar29, (uVar25 & 1) != 0)) {
                                    piVar31 = piVar27;
                                }
                                piVar27 = (int *)*piVar27;
                                piVar29 = piVar30;
                            } while (piVar27 != (int *)0x0);
                            if (((piVar31 != (int *)0x0) ||
                                 (piVar31 = piVar30, piVar30 != (int *)0x0)) &&
                                (pBVar23 != (BIGNUM *)0x0)) {
                                uVar4 = FUN_0003637c(iVar21, piVar31 + 0xf,
                                                     param_4);
                                goto LAB_0003a138;
                            }
                        }
                        goto LAB_0003a394;
                    }
                }
            }
            goto LAB_0003a334;
        }
        if (uVar22 == 0x82070000) {
            if (iffkey_info != 0) {
                uVar4 = EVP_PKEY_get0_DSA(*(undefined4 *)(iffkey_info + 4));
                DSA_get0_pqg(uVar4, &local_264, &local_260, &local_25c);
                DSA_get0_key(uVar4, 0, &local_258);
                uVar25 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
                if (0x13 < uVar25) {
                    uVar22 = param_5[4];
                    pBVar23 = (BIGNUM *)(uVar22 << 0x18 |
                                         (uVar22 >> 8 & 0xff) << 0x10 |
                                         (uVar22 >> 0x10 & 0xff) << 8 |
                                         uVar22 >> 0x18);
                    if ((pBVar23 <= (BIGNUM *)(uVar25 - 0x14)) &&
                        (local_268 = pBVar23,
                         (undefined1 *)((int)&pBVar23[-1].flags + 3U) <
                             (undefined1 *)0xffe7)) {
                        pBVar23 = BN_bin2bn((uchar *)(param_5 + 5),
                                            (int)pBVar23, (BIGNUM *)0x0);
                        if (pBVar23 == (BIGNUM *)0x0) {
                            uVar19 = ERR_get_error();
                            uVar4 = 0x10f;
                            pcVar20 = ERR_error_string(uVar19, (char *)0x0);
                            FUN_00074e00(3, "crypto_bob: %s", pcVar20);
                        } else {
                            pBVar13 = BN_CTX_new();
                            pBVar5 = BN_new();
                            pBVar6 = BN_new();
                            pDVar14 = DSA_SIG_new();
                            BN_rand(pBVar5, (int)local_268 << 3, -1, 1);
                            BN_mod_mul(pBVar6, local_258, pBVar23, local_260,
                                       pBVar13);
                            BN_add(pBVar6, pBVar6, pBVar5);
                            BN_div((BIGNUM *)0x0, pBVar6, pBVar6, local_260,
                                   pBVar13);
                            BN_mod_exp(pBVar5, local_25c, pBVar5, local_264,
                                       pBVar13);
                            FUN_00036540(pBVar5, pBVar5);
                            DSA_SIG_set0(pDVar14, pBVar6, pBVar5);
                            BN_CTX_free(pBVar13);
                            BN_free(pBVar23);
                            local_268 =
                                (BIGNUM *)i2d_DSA_SIG(pDVar14, (uchar **)0x0);
                            if (local_268 == (BIGNUM *)0x0) {
                                uVar19 = ERR_get_error();
                                uVar4 = 0x10f;
                                pcVar20 = ERR_error_string(uVar19, (char *)0x0);
                                FUN_00074e00(3, "crypto_bob: %s", pcVar20);
                                DSA_SIG_free(pDVar14);
                            } else {
                                if (local_268 < (BIGNUM *)0xffe8) {
                                    pBVar23 = (BIGNUM *)0x0;
                                    local_248 = (BIGNUM *)0x0;
                                    local_250 = 0;
                                    local_254 = (BIGNUM *)0x0;
                                    local_244 = 0;
                                    local_240 = 0;
                                    local_23c = (BIGNUM *)0x0;
                                    local_238 = 0;
                                    local_234 = (uchar *)0x0;
                                    if (sys_leap != '\x03') {
                                        FUN_0006f724(&local_254);
                                        pBVar23 =
                                            (BIGNUM *)((int)local_254 << 0x18 |
                                                       ((uint)local_254 >> 8 &
                                                        0xff)
                                                           << 0x10 |
                                                       ((uint)local_254 >>
                                                            0x10 &
                                                        0xff)
                                                           << 8 |
                                                       (uint)local_254 >> 0x18);
                                    }
                                    pBVar5 = local_254;
                                    local_240 =
                                        (int)local_268 << 0x18 |
                                        ((uint)local_268 >> 8 & 0xff) << 0x10 |
                                        ((uint)local_268 >> 0x10 & 0xff) << 8 |
                                        (uint)local_268 >> 0x18;
                                    uVar25 = *(uint *)(iffkey_info + 0xc);
                                    local_244 = uVar25 << 0x18 |
                                                (uVar25 >> 8 & 0xff) << 0x10 |
                                                (uVar25 >> 0x10 & 0xff) << 8 |
                                                uVar25 >> 0x18;
                                    local_248 = pBVar23;
                                    local_254 =
                                        (BIGNUM *)FUN_00073ba4(0, local_268, 0);
                                    local_23c = local_254;
                                    i2d_DSA_SIG(pDVar14, (uchar **)&local_254);
                                    DSA_SIG_free(pDVar14);
                                    if (pBVar5 != (BIGNUM *)0x0) {
                                        local_234 = (uchar *)FUN_00073ba4(
                                            0, DAT_000c98e4, 0);
                                        pEVar10 =
                                            (EVP_MD_CTX *)EVP_MD_CTX_new();
                                        EVP_DigestInit(pEVar10, DAT_000c98e8);
                                        EVP_DigestUpdate(pEVar10, &local_248,
                                                         0xc);
                                        EVP_DigestUpdate(pEVar10, local_23c,
                                                         (size_t)local_268);
                                        iVar11 = EVP_SignFinal(
                                            pEVar10, local_234,
                                            (uint *)&local_268, DAT_000c98e0);
                                        if (iVar11 != 0) {
                                            pBVar23 = local_268;
                                            if (DAT_000c98e4 < local_268) {
                                                /* WARNING: Subroutine does not
                                                 * return */
                                                FUN_0007ecc0(
                                                    "ntp_crypto.c", 0x921, 2,
                                                    "len <= sign_siglen");
                                            }
                                            goto LAB_0003a9d4;
                                        }
                                        goto LAB_0003a9dc;
                                    }
                                    goto LAB_0003ac3c;
                                }
                                uVar4 = 0x101;
                                FUN_00074e00(
                                    3, "crypto_bob: signature is too big: %u",
                                    local_268);
                                DSA_SIG_free(pDVar14);
                            }
                        }
                        goto LAB_0003a338;
                    }
                }
                goto LAB_0003a334;
            }
            uVar4 = 0x10e;
            FUN_00074e00(5, "crypto_bob: scheme unavailable");
        } else if (uVar22 < 0x82070001) {
            if (uVar22 != 0x82060000) {
            LAB_00039c0c:
                if (-1 < (int)uVar32)
                    goto LAB_0003a394;
                goto LAB_00039c14;
            }
            local_244 = 0;
            local_248 = (BIGNUM *)0x0;
            if (sys_leap != '\x03') {
                FUN_0006f724(&local_248);
                pBVar23 = local_248;
                if (local_248 != (BIGNUM *)0x0) {
                    uVar25 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
                    if (0x13 < uVar25) {
                        uVar22 = param_5[4];
                        pBVar5 = (BIGNUM *)(uVar22 << 0x18 |
                                            (uVar22 >> 8 & 0xff) << 0x10 |
                                            (uVar22 >> 0x10 & 0xff) << 8 |
                                            uVar22 >> 0x18);
                        if ((pBVar5 <= (BIGNUM *)(uVar25 - 0x14)) &&
                            (local_260 = pBVar5,
                             (undefined1 *)((int)&pBVar5[-1].flags + 3U) <
                                 (undefined1 *)0xffe7)) {
                            local_25c = (BIGNUM *)(param_5 + 5);
                            x = d2i_X509((X509 **)0x0, (uchar **)&local_25c,
                                         (long)pBVar5);
                            if (x == (X509 *)0x0) {
                                uVar19 = ERR_get_error();
                                uVar4 = 0x10d;
                                pcVar20 = ERR_error_string(uVar19, (char *)0x0);
                                FUN_00074e00(3, "cert_sign: %s", pcVar20);
                            } else {
                                pEVar15 = X509_get_pubkey(x);
                                if (pEVar15 == (EVP_PKEY *)0x0) {
                                    uVar19 = ERR_get_error();
                                    uVar4 = 0x104;
                                    pcVar20 =
                                        ERR_error_string(uVar19, (char *)0x0);
                                    FUN_00074e00(3, "cert_sign: %s", pcVar20);
                                    X509_free(x);
                                } else {
                                    x_00 = X509_new();
                                    version = X509_get_version(x);
                                    X509_set_version(x_00, version);
                                    a_00 = ASN1_INTEGER_new();
                                    ASN1_INTEGER_set(a_00, (long)pBVar23);
                                    X509_set_serialNumber(x_00, a_00);
                                    pAVar16 =
                                        (ASN1_TIME *)X509_getm_notBefore(x_00);
                                    X509_gmtime_adj(pAVar16, 0);
                                    pAVar16 =
                                        (ASN1_TIME *)X509_getm_notAfter(x_00);
                                    X509_gmtime_adj(pAVar16, 0x1e13380);
                                    pXVar17 = X509_get_issuer_name(x_00);
                                    uVar4 = hostval._12_4_;
                                    len = strlen((char *)hostval._12_4_);
                                    X509_NAME_add_entry_by_txt(
                                        pXVar17, "commonName", 0x1001,
                                        (uchar *)uVar4, len, -1, 0);
                                    pXVar17 = X509_get_subject_name(x);
                                    X509_set_subject_name(x_00, pXVar17);
                                    X509_set_pubkey(x_00, pEVar15);
                                    iVar8 = X509_get_ext_count(x);
                                    if (0 < iVar8) {
                                        iVar28 = 0;
                                        do {
                                            ex = X509_get_ext(x, iVar28);
                                            iVar18 = X509_add_ext(x_00, ex, -1);
                                            if (iVar18 == 0) {
                                                /* WARNING: Subroutine does not
                                                 * return */
                                                FUN_0007ecc0("ntp_crypto.c",
                                                             0xc92, 2,
                                                             "X509_add_ext("
                                                             "cert, ext, -1)");
                                            }
                                            iVar28 = iVar28 + 1;
                                        } while (iVar8 != iVar28);
                                    }
                                    X509_free(x);
                                    FUN_00076750(&local_254, pBVar23, 0);
                                    iVar8 = cert_host;
                                    iVar28 = FUN_000368a4(&local_254,
                                                          cert_host + 0x1c);
                                    if ((iVar28 < 0) ||
                                        (iVar8 = FUN_000368a4(&local_254,
                                                              iVar8 + 0x26),
                                         0 < iVar8)) {
                                        uVar4 = 0x10a;
                                        X509_free(x_00);
                                    } else {
                                        X509_sign(x_00, DAT_000c98e0,
                                                  DAT_000c98e8);
                                        iVar8 = X509_verify(x_00, DAT_000c98e0);
                                        if (0 < iVar8) {
                                            local_260 = (BIGNUM *)i2d_X509(
                                                x_00, (uchar **)0x0);
                                            local_240 =
                                                (int)local_260 << 0x18 |
                                                ((uint)local_260 >> 8 & 0xff)
                                                    << 0x10 |
                                                ((uint)local_260 >> 0x10 & 0xff)
                                                    << 8 |
                                                (uint)local_260 >> 0x18;
                                            local_244 = param_5[3];
                                            local_248 =
                                                (BIGNUM *)((int)pBVar23
                                                               << 0x18 |
                                                           ((uint)pBVar23 >> 8 &
                                                            0xff)
                                                               << 0x10 |
                                                           ((uint)pBVar23 >>
                                                                0x10 &
                                                            0xff)
                                                               << 8 |
                                                           (uint)pBVar23 >>
                                                               0x18);
                                            local_23c = (BIGNUM *)0x0;
                                            local_238 = 0;
                                            local_234 = (uchar *)0x0;
                                            local_258 = (BIGNUM *)FUN_00073ba4(
                                                0, local_260, 0, 0);
                                            local_23c = local_258;
                                            i2d_X509(x_00,
                                                     (uchar **)&local_258);
                                            local_238 = 0;
                                            local_234 = (uchar *)FUN_00073ba4(
                                                0, DAT_000c98e4, 0, 0);
                                            pEVar10 =
                                                (EVP_MD_CTX *)EVP_MD_CTX_new();
                                            EVP_DigestInit(pEVar10,
                                                           DAT_000c98e8);
                                            EVP_DigestUpdate(pEVar10,
                                                             &local_248, 0xc);
                                            EVP_DigestUpdate(pEVar10, local_23c,
                                                             (size_t)local_260);
                                            iVar11 = EVP_SignFinal(
                                                pEVar10, local_234,
                                                (uint *)&local_260,
                                                DAT_000c98e0);
                                            if (iVar11 != 0) {
                                                if (DAT_000c98e4 < local_260) {
                                                    /* WARNING: Subroutine does
                                                     * not return */
                                                    FUN_0007ecc0(
                                                        "ntp_crypto.c", 0xcbd,
                                                        2,
                                                        "len <= sign_siglen");
                                                }
                                                local_238 =
                                                    (int)local_260 << 0x18 |
                                                    ((uint)local_260 >> 8 &
                                                     0xff)
                                                        << 0x10 |
                                                    ((uint)local_260 >> 0x10 &
                                                     0xff)
                                                        << 8 |
                                                    (uint)local_260 >> 0x18;
                                            }
                                            EVP_MD_CTX_free(pEVar10);
                                            X509_free(x_00);
                                            uVar4 = FUN_0003637c(
                                                iVar21, &local_248, param_4);
                                            FUN_00037b48(&local_248);
                                            goto LAB_0003a138;
                                        }
                                        uVar19 = ERR_get_error();
                                        uVar4 = 0x109;
                                        pcVar20 = ERR_error_string(uVar19,
                                                                   (char *)0x0);
                                        FUN_00074e00(3, "cert_sign: %s",
                                                     pcVar20);
                                        X509_free(x_00);
                                    }
                                }
                            }
                            goto LAB_0003a338;
                        }
                    }
                    goto LAB_0003a334;
                }
            }
            uVar4 = 0x102;
        } else {
            if (uVar22 == 0x82080000) {
                if (gqkey_info == 0) {
                    uVar4 = 0x10e;
                    FUN_00074e00(5, "crypto_bob2: scheme unavailable");
                    goto LAB_0003a338;
                }
                uVar4 = EVP_PKEY_get0_RSA(*(undefined4 *)(gqkey_info + 4));
                RSA_get0_key(uVar4, &local_260, &local_25c, &local_258);
                uVar25 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
                if (0x13 < uVar25) {
                    uVar22 = param_5[4];
                    pBVar23 = (BIGNUM *)(uVar22 << 0x18 |
                                         (uVar22 >> 8 & 0xff) << 0x10 |
                                         (uVar22 >> 0x10 & 0xff) << 8 |
                                         uVar22 >> 0x18);
                    if ((pBVar23 <= (BIGNUM *)(uVar25 - 0x14)) &&
                        (local_264 = pBVar23,
                         (undefined1 *)((int)&pBVar23[-1].flags + 3U) <
                             (undefined1 *)0xffe7)) {
                        pBVar23 = BN_bin2bn((uchar *)(param_5 + 5),
                                            (int)pBVar23, (BIGNUM *)0x0);
                        if (pBVar23 == (BIGNUM *)0x0) {
                            uVar19 = ERR_get_error();
                            uVar4 = 0x10f;
                            pcVar20 = ERR_error_string(uVar19, (char *)0x0);
                            FUN_00074e00(3, "crypto_bob2: %s", pcVar20);
                        } else {
                            pBVar13 = BN_CTX_new();
                            pBVar5 = BN_new();
                            pBVar6 = BN_new();
                            pBVar7 = BN_new();
                            pDVar14 = DSA_SIG_new();
                            BN_rand(pBVar5, (int)local_264 << 3, -1, 1);
                            BN_div((BIGNUM *)0x0, pBVar5, pBVar5, local_260,
                                   pBVar13);
                            BN_mod_exp(pBVar7, local_25c, pBVar23, local_260,
                                       pBVar13);
                            BN_mod_mul(pBVar7, pBVar5, pBVar7, local_260,
                                       pBVar13);
                            BN_mod_exp(pBVar6, pBVar5, local_258, local_260,
                                       pBVar13);
                            FUN_00036540(pBVar6, pBVar6);
                            DSA_SIG_set0(pDVar14, pBVar7, pBVar6);
                            BN_CTX_free(pBVar13);
                            BN_free(pBVar23);
                            BN_free(pBVar5);
                            local_264 =
                                (BIGNUM *)i2d_DSA_SIG(pDVar14, (uchar **)0x0);
                            if (0 < (int)local_264) {
                                pBVar23 = (BIGNUM *)0x0;
                                local_248 = (BIGNUM *)0x0;
                                local_250 = 0;
                                local_254 = (BIGNUM *)0x0;
                                local_244 = 0;
                                local_240 = 0;
                                local_23c = (BIGNUM *)0x0;
                                local_238 = 0;
                                local_234 = (uchar *)0x0;
                                if (sys_leap != '\x03') {
                                    FUN_0006f724(&local_254);
                                    pBVar23 =
                                        (BIGNUM *)((int)local_254 << 0x18 |
                                                   ((uint)local_254 >> 8 & 0xff)
                                                       << 0x10 |
                                                   ((uint)local_254 >> 0x10 &
                                                    0xff)
                                                       << 8 |
                                                   (uint)local_254 >> 0x18);
                                }
                                pBVar5 = local_254;
                                local_240 =
                                    (int)local_264 << 0x18 |
                                    ((uint)local_264 >> 8 & 0xff) << 0x10 |
                                    ((uint)local_264 >> 0x10 & 0xff) << 8 |
                                    (uint)local_264 >> 0x18;
                                uVar25 = *(uint *)(gqkey_info + 0xc);
                                local_244 = uVar25 << 0x18 |
                                            (uVar25 >> 8 & 0xff) << 0x10 |
                                            (uVar25 >> 0x10 & 0xff) << 8 |
                                            uVar25 >> 0x18;
                                local_248 = pBVar23;
                                local_254 =
                                    (BIGNUM *)FUN_00073ba4(0, local_264, 0);
                                local_23c = local_254;
                                i2d_DSA_SIG(pDVar14, (uchar **)&local_254);
                                DSA_SIG_free(pDVar14);
                                if (pBVar5 != (BIGNUM *)0x0) {
                                    local_234 = (uchar *)FUN_00073ba4(
                                        0, DAT_000c98e4, 0);
                                    pEVar10 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                                    EVP_DigestInit(pEVar10, DAT_000c98e8);
                                    EVP_DigestUpdate(pEVar10, &local_248, 0xc);
                                    EVP_DigestUpdate(pEVar10, local_23c,
                                                     (size_t)local_264);
                                    iVar11 = EVP_SignFinal(pEVar10, local_234,
                                                           (uint *)&local_264,
                                                           DAT_000c98e0);
                                    if (iVar11 != 0) {
                                        pBVar23 = local_264;
                                        if (DAT_000c98e4 < local_264) {
                                            /* WARNING: Subroutine does not
                                             * return */
                                            FUN_0007ecc0("ntp_crypto.c", 0xa63,
                                                         2,
                                                         "len <= sign_siglen");
                                        }
                                        goto LAB_0003a9d4;
                                    }
                                    goto LAB_0003a9dc;
                                }
                                goto LAB_0003ac3c;
                            }
                            uVar19 = ERR_get_error();
                            uVar4 = 0x10f;
                            pcVar20 = ERR_error_string(uVar19, (char *)0x0);
                            FUN_00074e00(3, "crypto_bob2: %s", pcVar20);
                            DSA_SIG_free(pDVar14);
                        }
                        goto LAB_0003a338;
                    }
                }
            } else {
                if (uVar22 != 0x82090000)
                    goto LAB_00039c0c;
                if (mvkey_info == 0) {
                    FUN_00074e00(5, "crypto_bob3: scheme unavailable");
                    goto LAB_0003af20;
                }
                uVar4 = EVP_PKEY_get0_DSA(*(undefined4 *)(mvkey_info + 4));
                DSA_get0_pqg(uVar4, &local_268, &local_264, &local_260);
                DSA_get0_key(uVar4, &local_25c, &local_258);
                uVar25 = (*param_5 >> 0x10 & 0xff) << 8 | *param_5 >> 0x18;
                if (0x13 < uVar25) {
                    uVar22 = param_5[4];
                    pBVar23 = (BIGNUM *)(uVar22 << 0x18 |
                                         (uVar22 >> 8 & 0xff) << 0x10 |
                                         (uVar22 >> 0x10 & 0xff) << 8 |
                                         uVar22 >> 0x18);
                    if ((pBVar23 <= (BIGNUM *)(uVar25 - 0x14)) &&
                        (local_26c = pBVar23,
                         (undefined1 *)((int)&pBVar23[-1].flags + 3U) <
                             (undefined1 *)0xffe7)) {
                        pBVar23 = BN_bin2bn((uchar *)(param_5 + 5),
                                            (int)pBVar23, (BIGNUM *)0x0);
                        if (pBVar23 == (BIGNUM *)0x0) {
                            uVar19 = ERR_get_error();
                            uVar4 = 0x10f;
                            pcVar20 = ERR_error_string(uVar19, (char *)0x0);
                            FUN_00074e00(3, "crypto_bob3: %s", pcVar20);
                        } else {
                            pBVar5 = (BIGNUM *)BN_CTX_new();
                            pBVar6 = BN_new();
                            pBVar7 = BN_new();
                            a = DSA_new();
                            r = BN_new();
                            r_00 = BN_new();
                            r_01 = BN_new();
                            do {
                                iVar8 = BN_num_bits(local_264);
                                BN_rand(pBVar6, iVar8, 0, 0);
                                BN_div((BIGNUM *)0x0, pBVar6, pBVar6, local_264,
                                       (BN_CTX *)pBVar5);
                                BN_gcd(pBVar7, pBVar6, local_264,
                                       (BN_CTX *)pBVar5);
                                iVar8 = BN_is_one(pBVar7);
                            } while (iVar8 == 0);
                            BN_mod_exp(pBVar7, local_260, pBVar6, local_268,
                                       (BN_CTX *)pBVar5);
                            BN_mod_mul(r, pBVar7, pBVar23, local_268,
                                       (BN_CTX *)pBVar5);
                            BN_mod_exp(r_00, local_258, pBVar6, local_268,
                                       (BN_CTX *)pBVar5);
                            BN_mod_exp(r_01, local_25c, pBVar6, local_268,
                                       (BN_CTX *)pBVar5);
                            pBVar9 = BN_dup(local_25c);
                            DSA_set0_key(a, pBVar9, 0);
                            DSA_set0_pqg(a, r, r_00, r_01);
                            BN_CTX_free((BN_CTX *)pBVar5);
                            BN_free(pBVar6);
                            BN_free(pBVar23);
                            BN_free(pBVar7);
                            pBVar23 = (BIGNUM *)0x0;
                            local_248 = (BIGNUM *)0x0;
                            local_250 = 0;
                            local_254 = (BIGNUM *)0x0;
                            local_244 = 0;
                            if (sys_leap == '\x03') {
                                pBVar5 = (BIGNUM *)0x0;
                            }
                            local_240 = 0;
                            local_23c = (BIGNUM *)0x0;
                            local_238 = 0;
                            local_234 = (uchar *)0x0;
                            if (sys_leap != '\x03') {
                                FUN_0006f724(&local_254);
                                pBVar23 =
                                    (BIGNUM *)((int)local_254 << 0x18 |
                                               ((uint)local_254 >> 8 & 0xff)
                                                   << 0x10 |
                                               ((uint)local_254 >> 0x10 & 0xff)
                                                   << 8 |
                                               (uint)local_254 >> 0x18);
                                pBVar5 = local_254;
                            }
                            uVar25 = *(uint *)(mvkey_info + 0xc);
                            local_244 =
                                uVar25 << 0x18 | (uVar25 >> 8 & 0xff) << 0x10 |
                                (uVar25 >> 0x10 & 0xff) << 8 | uVar25 >> 0x18;
                            local_248 = pBVar23;
                            local_26c =
                                (BIGNUM *)i2d_DSAparams(a, (uchar **)0x0);
                            if (local_26c != (BIGNUM *)0x0) {
                                local_240 =
                                    (int)local_26c << 0x18 |
                                    ((uint)local_26c >> 8 & 0xff) << 0x10 |
                                    ((uint)local_26c >> 0x10 & 0xff) << 8 |
                                    (uint)local_26c >> 0x18;
                                local_254 =
                                    (BIGNUM *)FUN_00073ba4(0, local_26c, 0);
                                local_23c = local_254;
                                i2d_DSAparams(a, (uchar **)&local_254);
                                DSA_free(a);
                                if (pBVar5 != (BIGNUM *)0x0) {
                                    local_234 = (uchar *)FUN_00073ba4(
                                        0, DAT_000c98e4, 0);
                                    pEVar10 = (EVP_MD_CTX *)EVP_MD_CTX_new();
                                    EVP_DigestInit(pEVar10, DAT_000c98e8);
                                    EVP_DigestUpdate(pEVar10, &local_248, 0xc);
                                    EVP_DigestUpdate(pEVar10, local_23c,
                                                     (size_t)local_26c);
                                    iVar11 = EVP_SignFinal(pEVar10, local_234,
                                                           (uint *)&local_26c,
                                                           DAT_000c98e0);
                                    if (iVar11 != 0) {
                                        pBVar23 = local_26c;
                                        if (DAT_000c98e4 < local_26c) {
                                            /* WARNING: Subroutine does not
                                             * return */
                                            FUN_0007ecc0("ntp_crypto.c", 0xbc3,
                                                         2,
                                                         "len <= sign_siglen");
                                        }
                                        goto LAB_0003a9d4;
                                    }
                                    goto LAB_0003a9dc;
                                }
                                goto LAB_0003ac3c;
                            }
                            uVar19 = ERR_get_error();
                            uVar4 = 0x10f;
                            pcVar20 = ERR_error_string(uVar19, (char *)0x0);
                            FUN_00074e00(3, "crypto_bob3: %s", pcVar20);
                            DSA_free(a);
                        }
                        goto LAB_0003a338;
                    }
                }
            }
        LAB_0003a334:
            uVar4 = 0x101;
        }
    LAB_0003a338:
        *(uint *)(param_2 + iVar11 * 4) =
            *(uint *)(param_2 + iVar11 * 4) | 0x40;
        uVar12 = FUN_0007d3c4(uVar4);
        FUN_0007c054(acStack_230, 0x100, "%04x %d %02x %s", uVar32 | 0x40000000,
                     uVar2 | uVar3 >> 0x18, uVar4, uVar12);
        FUN_00052514(local_294, acStack_230);
        if (-1 < (int)(uVar32 | 0x40000000)) {
            uVar4 = 0;
            goto LAB_0003a138;
        }
    }
LAB_0003a394:
    uVar4 = 8;
LAB_0003a138:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_0003b408(void)

{
    int iVar1;
    int iVar2;
    FILE *__stream;
    char *pcVar3;
    size_t sVar4;
    ulong e;
    uint uVar5;
    uchar *local_54c;
    undefined4 local_548;
    long local_544;
    char *local_540;
    char *local_53c;
    uchar *local_538;
    undefined1 auStack_534[8];
    char local_52c[256];
    char acStack_42c[256];
    char acStack_32c[256];
    char acStack_22c[2];
    undefined1 auStack_22a[254];
    undefined1 auStack_12c[256];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((crypto_flags & 1) != 0) {
        FUN_00074e00(5, "crypto_setup: spurious crypto command");
    LAB_0003b9dc:
        if (local_2c != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        return;
    }
    FUN_0007c714();
    iVar1 = RAND_status();
    if (iVar1 == 0) {
        if (DAT_000c98f0 == (char *)0x0) {
            pcVar3 = local_52c;
            RAND_file_name(pcVar3, 0x100);
        } else {
            pcVar3 = DAT_000c98f0;
            if (*DAT_000c98f0 != '/') {
                pcVar3 = local_52c;
                FUN_0007c054(pcVar3, 0x100, "%s/%s", keysdir, DAT_000c98f0);
            }
        }
        iVar1 = RAND_load_file(pcVar3, -1);
        if (iVar1 == 0) {
            FUN_00074e00(3, "crypto_setup: random seed file %s missing",
                         pcVar3);
            /* WARNING: Subroutine does not return */
            exit(-1);
        }
        FUN_0006f724(auStack_534);
        RAND_seed(auStack_534, 8);
        RAND_write_file(pcVar3);
    }
    gethostname(acStack_42c, 0x100);
    if (DAT_000c98f4 != 0) {
        FUN_0007d4dc(acStack_42c, DAT_000c98f4, 0x100);
    }
    if (DAT_000c98f8 == 0) {
        DAT_000c98f8 = FUN_00073d08(acStack_42c);
    }
    hostval._0_4_ = 0;
    hostval._4_4_ = 0;
    hostval._8_4_ = 0;
    hostval._12_4_ = 0;
    hostval._16_4_ = 0;
    hostval._20_4_ = 0;
    pubkey._0_4_ = 0;
    pubkey._4_4_ = 0;
    pubkey._8_4_ = 0;
    pubkey._12_4_ = 0;
    pubkey._16_4_ = 0;
    pubkey._20_4_ = 0;
    tai_leap._0_4_ = 0;
    tai_leap._4_4_ = 0;
    tai_leap._8_4_ = 0;
    tai_leap._12_4_ = 0;
    tai_leap._16_4_ = 0;
    tai_leap._20_4_ = 0;
    FUN_0007c054(local_52c, 0x100, "ntpkey_host_%s", acStack_42c);
    iVar1 = FUN_00036d98(local_52c, DAT_000c98f8, 0);
    if (iVar1 == 0) {
        FUN_00074e00(3, "crypto_setup: host key file %s not found or corrupt",
                     local_52c);
        /* WARNING: Subroutine does not return */
        exit(-1);
    }
    iVar2 = EVP_PKEY_base_id(*(EVP_PKEY **)(iVar1 + 4));
    if (iVar2 != 6) {
        FUN_00074e00(3, "crypto_setup: host key is not RSA key type");
        /* WARNING: Subroutine does not return */
        exit(-1);
    }
    DAT_000c98e0 = *(EVP_PKEY **)(iVar1 + 4);
    uVar5 = *(uint *)(iVar1 + 0xc);
    hostval._4_4_ = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
    DAT_000c98ec = DAT_000c98e0;
    uVar5 = i2d_PublicKey(DAT_000c98e0, (uchar **)0x0);
    pubkey._12_4_ = FUN_00073ba4(0, uVar5, 0, 0);
    i2d_PublicKey(DAT_000c98ec, &local_54c);
    pubkey._4_4_ = hostval._4_4_;
    pubkey._8_4_ = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                   (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
    FUN_0007c054(local_52c, 0x100, "ntpkey_sign_%s", acStack_42c);
    iVar1 = FUN_00036d98(local_52c, DAT_000c98f8, 0);
    if (iVar1 != 0) {
        DAT_000c98e0 = *(EVP_PKEY **)(iVar1 + 4);
    }
    FUN_0007c054(local_52c, 0x100, "ntpkey_cert_%s", acStack_42c);
    if (local_52c[0] == '/') {
        FUN_0007d4dc(acStack_32c, local_52c, 0x100);
    } else {
        FUN_0007c054(acStack_32c, 0x100, "%s/%s", keysdir, local_52c);
    }
    __stream = fopen64(acStack_32c, "r");
    if (__stream != (FILE *)0x0) {
        pcVar3 = fgets(acStack_22c, 0x100, __stream);
        if (pcVar3 == (char *)0x0) {
            pcVar3 = "crypto_cert: empty file %s";
        } else {
            pcVar3 = strrchr(pcVar3, 0x2e);
            if (pcVar3 != (char *)0x0) {
                iVar1 = sscanf(pcVar3 + 1, "%u", &local_548);
                if (iVar1 == 1) {
                    iVar1 = PEM_read(__stream, &local_540, &local_53c,
                                     &local_538, &local_544);
                    if (iVar1 == 0) {
                        e = ERR_get_error();
                        pcVar3 = ERR_error_string(e, (char *)0x0);
                        FUN_00074e00(3, "crypto_cert: %s", pcVar3);
                        fclose(__stream);
                    } else {
                        fclose(__stream);
                        free(local_53c);
                        pcVar3 = local_540;
                        iVar1 = strcmp(local_540, "CERTIFICATE");
                        if (iVar1 == 0) {
                            free(pcVar3);
                            iVar1 =
                                FUN_00037c64(local_538, local_544, local_548);
                            free(local_538);
                            if (iVar1 != 0) {
                                pcVar3 = strrchr(acStack_22c, 10);
                                if (pcVar3 != (char *)0x0) {
                                    *pcVar3 = '\0';
                                }
                                FUN_0007c054(auStack_12c, 0x100,
                                             "%s 0x%x len %lu", auStack_22a,
                                             *(undefined4 *)(iVar1 + 4),
                                             local_544);
                                FUN_00052514(0, auStack_12c);
                                DAT_000c98e8 = *(undefined4 *)(iVar1 + 0x14);
                                cert_host = iVar1;
                                cinfo = iVar1;
                                DAT_000c98e4 = EVP_PKEY_size(DAT_000c98e0);
                                if ((*(uint *)(cinfo + 4) & 8) != 0) {
                                    crypto_flags = crypto_flags | 0x10;
                                }
                                pcVar3 = *(char **)(cinfo + 0x30);
                                iVar1 =
                                    strcmp(pcVar3, *(char **)(cinfo + 0x34));
                                if (iVar1 != 0) {
                                    FUN_00074e00(3,
                                                 "crypto_setup: certificate %s "
                                                 "is not self-signed",
                                                 local_52c);
                                    /* WARNING: Subroutine does not return */
                                    exit(-1);
                                }
                                pcVar3 = (char *)FUN_00073d08(pcVar3);
                                hostval._12_4_ = pcVar3;
                                sVar4 = strlen(*(char **)(cinfo + 0x30));
                                hostval._8_4_ = sVar4 << 0x18 |
                                                (sVar4 >> 8 & 0xff) << 0x10 |
                                                (sVar4 >> 0x10 & 0xff) << 8 |
                                                sVar4 >> 0x18;
                                sys_hostname = pcVar3;
                                pcVar3 = strchr(pcVar3, 0x40);
                                if (pcVar3 != (char *)0x0) {
                                    sys_groupname = FUN_00073d08(pcVar3 + 1);
                                }
                                if (DAT_000c98fc != 0) {
                                    FUN_0007d4dc(acStack_42c, DAT_000c98fc,
                                                 0x100);
                                }
                                FUN_0007c054(local_52c, 0x100,
                                             "ntpkey_iffkey_%s", acStack_42c);
                                iffkey_info =
                                    FUN_00036d98(local_52c, DAT_000c98f8, 0);
                                if (iffkey_info != 0) {
                                    crypto_flags = crypto_flags | 0x20;
                                }
                                FUN_0007c054(local_52c, 0x100,
                                             "ntpkey_gqkey_%s", acStack_42c);
                                gqkey_info =
                                    FUN_00036d98(local_52c, DAT_000c98f8, 0);
                                if (gqkey_info != 0) {
                                    crypto_flags = crypto_flags | 0x40;
                                }
                                FUN_0007c054(local_52c, 0x100,
                                             "ntpkey_mvkey_%s", acStack_42c);
                                mvkey_info =
                                    FUN_00036d98(local_52c, DAT_000c98f8, 0);
                                if (mvkey_info != 0) {
                                    crypto_flags = crypto_flags | 0x80;
                                }
                                uVar5 = crypto_flags |
                                        *(int *)(cinfo + 0x10) << 0x10 | 1;
                                crypto_flags = uVar5;
                                pcVar3 = OBJ_nid2ln(*(int *)(cinfo + 0x10));
                                FUN_0007c054(auStack_12c, 0x100,
                                             "setup 0x%x host %s %s", uVar5,
                                             acStack_42c, pcVar3);
                                FUN_00052514(0, auStack_12c);
                                goto LAB_0003b9dc;
                            }
                        } else {
                            FUN_00074e00(5, "crypto_cert: wrong PEM type %s",
                                         pcVar3);
                            free(local_540);
                            free(local_538);
                        }
                    }
                } else {
                    FUN_00074e00(3, "crypto_cert: invalid filestamp %s",
                                 acStack_32c);
                    fclose(__stream);
                }
                goto LAB_0003baa0;
            }
            pcVar3 = "crypto_cert: no filestamp %s";
        }
        FUN_00074e00(3, pcVar3, acStack_32c);
        fclose(__stream);
    }
LAB_0003baa0:
    cinfo = 0;
    FUN_00074e00(3, "crypto_setup: certificate file %s not found or corrupt",
                 local_52c);
    /* WARNING: Subroutine does not return */
    exit(-1);
}

void FUN_0003bca8(undefined4 param_1, char *param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = crypto_nid;
    switch (param_1) {
    case 1:
        if (DAT_000c98f4 != (void *)0x0) {
            free(DAT_000c98f4);
        }
        DAT_000c98f4 = (void *)FUN_00073d08(param_2);
        iVar2 = crypto_nid;
        break;
    case 2:
        if (DAT_000c98fc != (void *)0x0) {
            free(DAT_000c98fc);
        }
        DAT_000c98fc = (void *)FUN_00073d08(param_2);
        iVar2 = crypto_nid;
        break;
    case 3:
        break;
    case 4:
        if (DAT_000c98f0 != (void *)0x0) {
            free(DAT_000c98f0);
        }
        DAT_000c98f0 = (void *)FUN_00073d08(param_2);
        iVar2 = crypto_nid;
        break;
    case 5:
        break;
    case 6:
        break;
    case 7:
        break;
    case 8:
        if (DAT_000c98f8 != (void *)0x0) {
            free(DAT_000c98f8);
        }
        DAT_000c98f8 = (void *)FUN_00073d08(param_2);
        iVar2 = crypto_nid;
        break;
    case 9:
        iVar2 = OBJ_sn2nid(param_2);
        if (iVar2 == 0) {
            if (iVar1 == __stack_chk_guard) {
                FUN_00074e00(3, "crypto_config: invalid digest name %s",
                             param_2);
                return;
            }
            goto LAB_0003be20;
        }
    }
    crypto_nid = iVar2;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_0003be20:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003be54(int *param_1, uint param_2)

{
    byte bVar1;
    size_t sVar2;
    size_t sVar3;
    char *__filename;
    char *__filename_00;
    __pid_t _Var4;
    FILE *pFVar5;
    int *piVar6;
    char cVar7;
    int iVar8;
    char *pcVar9;
    int iVar10;
    int iVar11;
    int iVar12;
    time_t local_b0;
    undefined2 local_ac;
    undefined1 local_aa;
    undefined1 local_a9;
    undefined1 local_a8;
    undefined1 local_a7;
    undefined1 local_a6;
    short local_a4[2];
    undefined4 local_a0;
    undefined1 local_9c;
    stat64 sStack_98;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (-1 < *(char *)((int)param_1 + 0x15)) {
        if ((FILE *)*param_1 != (FILE *)0x0) {
            fclose((FILE *)*param_1);
            *param_1 = 0;
        }
        goto LAB_0003be9c;
    }
    switch ((char)param_1[5]) {
    case '\x01':
        iVar10 = param_1[3];
        _Var4 = getpid();
        iVar10 = iVar10 - _Var4;
        if (iVar10 != 0) {
            iVar10 = 1;
        }
        if (*param_1 == 0) {
            iVar10 = 1;
        }
        if (iVar10 == 0)
            goto LAB_0003be9c;
        goto LAB_0003bf58;
    case '\x02':
        break;
    case '\x03':
        break;
    case '\x04':
        break;
    case '\x05':
        break;
    case '\x06':
        if ((current_time < (uint)param_1[3]) ||
            ((uint)param_1[4] <= current_time))
            goto LAB_0003bf58;
        goto LAB_0003bf24;
    default:
        iVar10 = *param_1;
        goto joined_r0x0003c138;
    }
    if (((uint)param_1[3] <= param_2) && (param_2 < (uint)param_1[4])) {
    LAB_0003bf24:
        iVar10 = *param_1;
    joined_r0x0003c138:
        if (iVar10 != 0)
            goto LAB_0003be9c;
    }
LAB_0003bf58:
    local_b0 = time((time_t *)0x0);
    sVar2 = strlen((char *)param_1[1]);
    sVar3 = strlen((char *)param_1[2]);
    iVar12 = sVar2 + sVar3 + 0x41;
    __filename = (char *)FUN_00073ba4(0, iVar12, 0);
    iVar11 = sVar2 + sVar3 + 0x40;
    __filename_00 = (char *)FUN_00073ba4(0, iVar12, 0);
    FUN_0007c054(__filename, iVar12, "%s%s", param_1[1], param_1[2]);
    iVar10 = FUN_0007d4dc(__filename_00, __filename, iVar12);
    __filename_00[iVar11] = '\0';
    iVar8 = iVar12 - iVar10;
    bVar1 = *(byte *)(param_1 + 5);
    pcVar9 = __filename_00 + iVar10;
    if (bVar1 == 4) {
        FUN_00076750(local_a4, param_2, &local_b0);
        FUN_0007c054(pcVar9, iVar8, "%c%04d%02d", 0x2e, local_a4[0],
                     local_a0 & 0xff);
        local_9c = 0;
        local_a0._0_2_ = CONCAT11(1, (undefined1)local_a0);
        local_a0 = (uint)(ushort)local_a0;
        iVar10 = FUN_00076830(local_a4);
        param_1[3] = iVar10;
        local_a0 = CONCAT31(local_a0._1_3_, (char)local_a0 + '\x01');
        iVar10 = FUN_00076830(local_a4);
        param_1[4] = iVar10;
        cVar7 = __filename_00[iVar11];
        goto LAB_0003c060;
    }
    if (bVar1 < 5) {
        if (bVar1 == 2) {
            FUN_00076750(local_a4, param_2, &local_b0);
            FUN_0007c054(pcVar9, iVar8, "%c%04d%02d%02d", 0x2e, local_a4[0],
                         local_a0 & 0xff, local_a0 >> 8 & 0xff);
            local_a0 = (uint)(ushort)local_a0;
            local_9c = 0;
            iVar10 = FUN_00076830(local_a4);
            param_1[3] = iVar10;
            param_1[4] = (int)("drift_comp" + iVar10 + 6);
            cVar7 = __filename_00[iVar11];
        LAB_0003c060:
            if (cVar7 != '\0')
                goto LAB_0003c264;
        } else {
            if (2 < bVar1) {
                FUN_00076cc4(&local_ac, param_2, &local_b0);
                FUN_0007c054(pcVar9, iVar8, "%c%04dw%02d", 0x2e, local_ac,
                             local_aa);
                local_a9 = 1;
                local_a6 = 0;
                local_a7 = 0;
                local_a8 = 0;
                iVar10 = FUN_00076dc4(&local_ac);
                param_1[3] = iVar10;
                param_1[4] = iVar10 + 0x93a80;
                cVar7 = __filename_00[iVar11];
                goto LAB_0003c060;
            }
            if (bVar1 == 1) {
                _Var4 = getpid();
                param_1[3] = _Var4;
                param_1[4] = 0;
                FUN_0007c054(pcVar9, iVar8, "%c#%ld", 0x2e, _Var4);
                cVar7 = __filename_00[iVar11];
                goto LAB_0003c060;
            }
        LAB_0003c238:
            FUN_00074e00(3,
                         "unsupported file generations type %d for \"%s\" - "
                         "reverting to FILEGEN_NONE",
                         bVar1, __filename);
            *(undefined1 *)(param_1 + 5) = 0xff;
            if (__filename_00[iVar11] == '\0')
                goto LAB_0003c0e4;
        LAB_0003c264:
            __filename_00[iVar11] = '\0';
            FUN_00074e00(3, "logfile name truncated: \"%s\"", __filename_00);
        }
        if ((char)param_1[5] != -1) {
            iVar10 = __xstat64(3, __filename, &sStack_98);
            if (iVar10 == 0) {
                if ((sStack_98.st_mode & 0xf000) == 0x8000) {
                    if (sStack_98.st_nlink < 2) {
                        pcVar9 = (char *)FUN_00073ba4(0, iVar12, 0, 0);
                        _Var4 = getpid();
                        iVar10 = DAT_000c9924;
                        DAT_000c9924 = DAT_000c9924 + 1;
                        FUN_0007c054(pcVar9, iVar12, "%s%c%dC%lu", __filename,
                                     0x2e, _Var4, iVar10);
                        iVar10 = rename(__filename, pcVar9);
                        if (iVar10 != 0) {
                            FUN_00074e00(3, "couldn\'t save %s: %m",
                                         __filename);
                        }
                        free(pcVar9);
                    } else {
                        iVar10 = unlink(__filename);
                        if (iVar10 != 0) {
                            FUN_00074e00(3, "couldn\'t unlink %s: %m",
                                         __filename);
                        }
                    }
                } else {
                    FUN_00074e00(
                        3, "expected regular file for %s (found mode 0%lo)",
                        __filename);
                }
            } else {
                piVar6 = __errno_location();
                if (*piVar6 != 2) {
                    FUN_00074e00(3, "stat(%s) failed: %m", __filename);
                }
            }
        }
    } else {
        if (bVar1 == 6) {
            iVar10 = (current_time / 0x15180) * 0x15180;
            param_1[3] = iVar10;
            param_1[4] = (int)("drift_comp" + iVar10 + 6);
            FUN_0007c054(pcVar9, iVar8, "%ca%08ld", 0x2e, iVar10);
            cVar7 = __filename_00[iVar11];
            goto LAB_0003c060;
        }
        if (bVar1 < 6) {
            FUN_00076750(local_a4, param_2, &local_b0);
            FUN_0007c054(pcVar9, iVar8, "%c%04d", 0x2e, local_a4[0]);
            local_9c = 0;
            local_a0 = 0x101;
            iVar10 = FUN_00076830(local_a4);
            param_1[3] = iVar10;
            local_a4[0] = local_a4[0] + 1;
            iVar10 = FUN_00076830(local_a4);
            param_1[4] = iVar10;
            cVar7 = __filename_00[iVar11];
            goto LAB_0003c060;
        }
        if (bVar1 != 0xff)
            goto LAB_0003c238;
    }
LAB_0003c0e4:
    pFVar5 = fopen64(__filename_00, "a");
    if (pFVar5 == (FILE *)0x0) {
        piVar6 = __errno_location();
        if (*piVar6 != 2) {
            FUN_00074e00(3, "can\'t open %s: %m", __filename_00);
        }
    } else {
        if ((FILE *)*param_1 != (FILE *)0x0) {
            fclose((FILE *)*param_1);
        }
        *param_1 = (int)pFVar5;
        if ((((*(byte *)((int)param_1 + 0x15) & 1) != 0) &&
             (iVar10 = link(__filename_00, __filename), iVar10 != 0)) &&
            (piVar6 = __errno_location(), *piVar6 != 0x11)) {
            FUN_00074e00(3, "can\'t link(%s, %s): %m", __filename_00,
                         __filename);
        }
    }
    free(__filename);
    free(__filename_00);
LAB_0003be9c:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003c570(undefined4 *param_1, char *param_2, char *param_3,
                  uint param_4, uint param_5)

{
    int iVar1;
    char *__s;
    FILE *__stream;
    undefined4 uVar2;
    char *pcVar3;
    undefined4 local_34[2];
    int local_2c;

    pcVar3 = (char *)param_1[1];
    local_2c = __stack_chk_guard;
    iVar1 = strcmp(param_2, pcVar3);
    if (((((iVar1 != 0) ||
           (iVar1 = strcmp(param_3, (char *)param_1[2]), iVar1 != 0)) ||
          (*(byte *)(param_1 + 5) != param_4)) ||
         (*(byte *)((int)param_1 + 0x15) != param_5)) &&
        (__s = param_3, param_3 != (char *)0x0 && *param_2 != '\0')) {
        do {
            if (((*__s == '.') && (__s[1] == '.')) &&
                (__s[2] == '/' || __s[2] == '\0'))
                goto LAB_0003c5f0;
            __s = strchr(__s, 0x2f);
        } while (__s != (char *)0x0);
        __stream = (FILE *)*param_1;
        if (__stream != (FILE *)0x0) {
            fclose(__stream);
            pcVar3 = (char *)param_1[1];
            *param_1 = 0;
        }
        iVar1 = strcmp(pcVar3, param_2);
        if (iVar1 != 0) {
            free(pcVar3);
            uVar2 = FUN_00073d08(param_2);
            param_1[1] = uVar2;
        }
        pcVar3 = (char *)param_1[2];
        iVar1 = strcmp(pcVar3, param_3);
        if (iVar1 != 0) {
            free(pcVar3);
            uVar2 = FUN_00073d08(param_3);
            param_1[2] = uVar2;
        }
        *(char *)(param_1 + 5) = (char)param_4;
        *(char *)((int)param_1 + 0x15) = (char)param_5;
        if (__stream != (FILE *)0x0) {
            FUN_0006f724(local_34);
            FUN_0003be54(param_1, local_34[0]);
        }
    }
LAB_0003c5f0:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0003c718(char *param_1)

{
    int iVar1;
    int iVar2;
    char *__s2;
    undefined4 *puVar3;

    iVar1 = __stack_chk_guard;
    puVar3 = DAT_000c9928;
    if (DAT_000c9928 != (undefined4 *)0x0) {
        __s2 = (char *)*DAT_000c9928;
        while (
            (param_1 != __s2 && (iVar2 = strcmp(param_1, __s2), iVar2 != 0))) {
            puVar3 = (undefined4 *)puVar3[2];
            if (puVar3 == (undefined4 *)0x0)
                goto LAB_0003c78c;
            __s2 = (char *)*puVar3;
        }
        puVar3 = (undefined4 *)puVar3[1];
    }
LAB_0003c78c:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar3);
}

void FUN_0003c7bc(undefined4 param_1, char *param_2, undefined4 *param_3)

{
    int iVar1;
    undefined4 uVar2;
    char *__s1;
    int iVar3;
    undefined4 *puVar4;
    int *piVar5;
    undefined4 *puVar6;

    iVar1 = __stack_chk_guard;
    *param_3 = 0;
    uVar2 = FUN_00073d08();
    param_3[1] = uVar2;
    uVar2 = FUN_00073d08(param_2);
    param_3[2] = uVar2;
    param_3[3] = 0;
    param_3[4] = 0;
    puVar6 = DAT_000c9928;
    *(undefined2 *)(param_3 + 5) = 0x102;
    if (puVar6 == (undefined4 *)0x0) {
        piVar5 = (int *)&DAT_000c9928;
    LAB_0003c880:
        iVar3 = FUN_00073ba4(0, 0xc, 0);
        *piVar5 = iVar3;
        *(undefined4 *)(iVar3 + 8) = 0;
        puVar6 = (undefined4 *)*piVar5;
        uVar2 = FUN_00073d08(param_2);
        iVar3 = *piVar5;
        *puVar6 = uVar2;
        *(undefined4 **)(iVar3 + 4) = param_3;
    } else {
        __s1 = (char *)*puVar6;
        while (
            (param_2 != __s1 && (iVar3 = strcmp(__s1, param_2), iVar3 != 0))) {
            puVar4 = (undefined4 *)puVar6[2];
            if (puVar4 == (undefined4 *)0x0) {
                piVar5 = puVar6 + 2;
                goto LAB_0003c880;
            }
            __s1 = (char *)*puVar4;
            puVar6 = puVar4;
        }
        puVar6[1] = param_3;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003c8d8(void)

{
    int *piVar1;
    int iVar2;
    int iVar3;
    int iVar4;

    iVar2 = __stack_chk_guard;
    iVar3 = DAT_000c9928;
    if (DAT_000c9928 != 0) {
        do {
            iVar4 = *(int *)(iVar3 + 4);
            FUN_0003c570(iVar4, statsdir, *(undefined4 *)(iVar4 + 8),
                         *(undefined1 *)(iVar4 + 0x14),
                         *(undefined1 *)(iVar4 + 0x15));
            piVar1 = (int *)(iVar3 + 8);
            iVar3 = *piVar1;
        } while (*piVar1 != 0);
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0003c9c0) */

void FUN_0003c96c(int param_1)

{
    undefined4 uVar1;
    undefined4 uVar2;

    *(undefined4 *)(param_1 + 0x40) = 0xffffffff;
    *(undefined4 *)(param_1 + 0x44) = 0xffffffff;
    uVar1 = *(undefined4 *)(param_1 + 0x40);
    uVar2 = *(undefined4 *)(param_1 + 0x44);
    *(undefined4 *)(param_1 + 0x38) = uVar1;
    *(undefined4 *)(param_1 + 0x3c) = uVar2;
    *(undefined4 *)(param_1 + 0x30) = uVar1;
    *(undefined4 *)(param_1 + 0x34) = uVar2;
    *(undefined4 *)(param_1 + 0x28) = uVar1;
    *(undefined4 *)(param_1 + 0x2c) = uVar2;
    return;
}

void FUN_0003c9cc(byte *param_1)

{
    byte bVar1;
    int iVar2;
    ushort **ppuVar3;

    iVar2 = __stack_chk_guard;
    ppuVar3 = __ctype_b_loc();
    do {
        bVar1 = *param_1;
        param_1 = param_1 + 1;
    } while (((*ppuVar3)[bVar1] & 0x2000) != 0);
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003ca3c(byte *param_1, byte *param_2)

{
    int iVar1;
    uint uVar2;
    ushort **ppuVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    if (param_2 == param_1) {
        uVar2 = 1;
    } else {
        uVar4 = (uint)*param_2;
        uVar2 = uVar4 - 0x23;
        if (uVar2 != 0) {
            uVar2 = 1;
        }
        if (uVar4 == 0) {
            uVar2 = 0;
        }
        if (uVar2 != 0) {
            ppuVar3 = __ctype_b_loc();
            uVar2 = (((*ppuVar3)[uVar4] ^ 0x2000) << 0x12) >> 0x1f;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0003cac4(int param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 uVar2;
    uint uVar3;
    undefined4 uVar4;
    size_t __n;
    short sVar5;
    undefined4 uVar6;
    short sVar7;

    iVar1 = __stack_chk_guard;
    uVar3 = (uint) * (ushort *)(param_1 + 0x20);
    if (uVar3 == 0) {
        sVar5 = *(short *)(param_2 + 3);
        sVar7 = 1;
        if (sVar5 < 0) {
            sVar5 = sVar5 + 1;
        } else {
            sVar5 = sVar5 + -1;
        }
        *(short *)(param_1 + 0x22) = sVar5;
        __n = 0;
    } else if (uVar3 < 10) {
        sVar7 = *(ushort *)(param_1 + 0x20) + 1;
        __n = uVar3 << 4;
    } else {
        sVar7 = 10;
        __n = 0x90;
        *(undefined2 *)(param_1 + 0x20) = 9;
        *(undefined2 *)(param_1 + 0x22) = *(undefined2 *)(param_1 + 0xec);
    }
    memmove((void *)(param_1 + 0x60), (undefined4 *)(param_1 + 0x50), __n);
    uVar2 = param_2[1];
    uVar4 = param_2[2];
    uVar6 = param_2[3];
    *(undefined4 *)(param_1 + 0x50) = *param_2;
    *(undefined4 *)(param_1 + 0x54) = uVar2;
    *(undefined4 *)(param_1 + 0x58) = uVar4;
    *(undefined4 *)(param_1 + 0x5c) = uVar6;
    *(short *)(param_1 + 0x20) = sVar7;
    FUN_0003c96c(param_1);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(1);
    }
    return;
}

void FUN_0003cb8c(int param_1, undefined4 param_2)

{
    undefined2 uVar1;
    short sVar2;
    int iVar3;
    uint uVar4;
    undefined4 uVar5;
    undefined4 uVar6;
    uint uVar7;
    uint uVar8;
    int iVar9;
    undefined4 local_28;
    undefined4 uStack_24;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (*(short *)(param_1 + 0x20) == 0) {
        *(undefined4 *)(param_1 + 0x40) = 0;
        *(undefined4 *)(param_1 + 0x44) = 0;
        *(undefined2 *)(param_1 + 0x24) = *(undefined2 *)(param_1 + 0x22);
    } else {
        iVar9 = param_1 + 0x50;
        uVar8 = 0;
        do {
            iVar3 = FUN_0007daf4(param_2, iVar9);
            if (-1 < iVar3) {
                uVar4 = uVar8 - 1;
                if ((int)uVar8 < (int)(uint) * (ushort *)(param_1 + 0x20)) {
                    iVar9 = param_1 + uVar8 * 0x10;
                    uVar6 = *(undefined4 *)(iVar9 + 0x54);
                    uVar1 = *(undefined2 *)(iVar9 + 0x5c);
                    *(undefined4 *)(param_1 + 0x40) =
                        *(undefined4 *)(iVar9 + 0x50);
                    *(undefined4 *)(param_1 + 0x44) = uVar6;
                    *(undefined2 *)(param_1 + 0x24) = uVar1;
                    goto joined_r0x0003ccb4;
                }
                break;
            }
            uVar7 = uVar8 + 1;
            iVar9 = iVar9 + 0x10;
            uVar4 = uVar8;
            uVar8 = uVar7;
        } while (*(ushort *)(param_1 + 0x20) != uVar7);
        *(undefined4 *)(param_1 + 0x40) = 0;
        *(undefined4 *)(param_1 + 0x44) = 0;
        *(undefined2 *)(param_1 + 0x24) = *(undefined2 *)(param_1 + 0x22);
    joined_r0x0003ccb4:
        iVar9 = DAT_000c9930;
        if (uVar4 != 0xffffffff) {
            iVar3 = param_1 + uVar4 * 0x10;
            sVar2 = *(short *)(iVar3 + 0x5c);
            *(short *)(param_1 + 0x26) = sVar2;
            *(undefined1 *)(param_1 + 0x48) = *(undefined1 *)(iVar3 + 0x5e);
            uVar6 = *(undefined4 *)(iVar3 + 0x50);
            uVar5 = *(undefined4 *)(iVar3 + 0x54);
            *(undefined4 *)(param_1 + 0x30) = uVar6;
            *(undefined4 *)(param_1 + 0x34) = uVar5;
            if (iVar9 == 0) {
                FUN_0007dc24(&local_28, param_1 + 0x30,
                             (int)sVar2 - (int)*(short *)(param_1 + 0x24));
                *(undefined4 *)(param_1 + 0x28) = local_28;
                *(undefined4 *)(param_1 + 0x2c) = uStack_24;
            } else {
                *(undefined4 *)(param_1 + 0x28) = uVar6;
                *(undefined4 *)(param_1 + 0x2c) = uVar5;
            }
            FUN_0007dd38(&local_28, param_1 + 0x30,
                         *(undefined4 *)(param_1 + uVar4 * 0x10 + 0x58));
            *(undefined4 *)(param_1 + 0x38) = local_28;
            *(undefined4 *)(param_1 + 0x3c) = uStack_24;
            goto LAB_0003cc7c;
        }
    }
    *(undefined4 *)(param_1 + 0x30) = 0xffffffff;
    *(undefined4 *)(param_1 + 0x34) = 0xffffffff;
    *(undefined1 *)(param_1 + 0x48) = 0;
    *(undefined4 *)(param_1 + 0x38) = *(undefined4 *)(param_1 + 0x30);
    *(undefined4 *)(param_1 + 0x3c) = *(undefined4 *)(param_1 + 0x34);
    *(undefined4 *)(param_1 + 0x28) = *(undefined4 *)(param_1 + 0x30);
    *(undefined4 *)(param_1 + 0x2c) = *(undefined4 *)(param_1 + 0x34);
    *(undefined2 *)(param_1 + 0x26) = *(undefined2 *)(param_1 + 0x24);
LAB_0003cc7c:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003cd30(int param_1)

{
    int iVar1;
    uint uVar2;
    undefined1 *__s;
    undefined2 local_28[2];
    undefined1 local_24;
    undefined1 local_23;
    undefined1 local_22;
    undefined1 local_21;
    undefined1 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar2 = lib_nextbuf + 1 & 0xf;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar2;
    if ((*(int *)(param_1 + 4) < 0) ||
        (iVar1 = FUN_000766d8(local_28, param_1), iVar1 < 0)) {
        FUN_0007c054(__s, 0x80, "%s", "9999-12-31T23:59:59Z");
    } else {
        FUN_0007c054(__s, 0x80, "%04d-%02d-%02dT%02d:%02d:%02dZ", local_28[0],
                     local_24, local_23, local_22, local_21, local_20);
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_0003ce3c(undefined4 param_1, byte *param_2)

{
    ushort **ppuVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    undefined1 local_44[32];
    int local_24;

    local_24 = __stack_chk_guard;
    uVar4 = 0;
    do {
        uVar2 = (uint)*param_2;
        uVar3 = uVar4;
        if (uVar2 == 0x23 || uVar2 == 0) {
        LAB_0003cecc:
            if (uVar4 != 0) {
                FUN_000882a0(param_1, local_44, uVar4);
            }
            if (local_24 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        while (true) {
            param_2 = param_2 + 1;
            ppuVar1 = __ctype_b_loc();
            uVar4 = uVar3;
            if (((*ppuVar1)[uVar2] & 0x800) == 0)
                break;
            uVar4 = uVar3 + 1 & 0x1f;
            local_44[uVar3] = (char)uVar2;
            if (uVar4 != 0)
                break;
            FUN_000882a0(param_1, local_44, 0x20);
            uVar2 = (uint)*param_2;
            uVar3 = uVar4;
            if (uVar2 == 0x23 || uVar2 == 0)
                goto LAB_0003cecc;
        }
    } while (true);
}

void FUN_0003cf08(undefined4 *param_1, int param_2, undefined4 param_3)

{
    undefined2 uVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    undefined4 uVar5;
    uint uVar6;
    uint uVar7;
    int iVar8;

    iVar2 = __stack_chk_guard;
    if (*(short *)(param_2 + 0x20) == 0) {
        *param_1 = 0;
        param_1[1] = 0;
        *(undefined2 *)(param_1 + 4) = *(undefined2 *)(param_2 + 0x22);
    } else {
        iVar8 = param_2 + 0x50;
        uVar7 = 0;
        do {
            iVar3 = FUN_0007daf4(param_3, iVar8);
            if (-1 < iVar3) {
                uVar4 = uVar7 - 1;
                if ((int)uVar7 < (int)(uint) * (ushort *)(param_2 + 0x20)) {
                    iVar8 = param_2 + uVar7 * 0x10;
                    uVar5 = *(undefined4 *)(iVar8 + 0x54);
                    uVar1 = *(undefined2 *)(iVar8 + 0x5c);
                    *param_1 = *(undefined4 *)(iVar8 + 0x50);
                    param_1[1] = uVar5;
                    *(undefined2 *)(param_1 + 4) = uVar1;
                    goto joined_r0x0003cfe0;
                }
                break;
            }
            uVar6 = uVar7 + 1;
            iVar8 = iVar8 + 0x10;
            uVar4 = uVar7;
            uVar7 = uVar6;
        } while (*(ushort *)(param_2 + 0x20) != uVar6);
        *param_1 = 0;
        param_1[1] = 0;
        *(undefined2 *)(param_1 + 4) = *(undefined2 *)(param_2 + 0x22);
    joined_r0x0003cfe0:
        if (uVar4 != 0xffffffff) {
            param_2 = param_2 + uVar4 * 0x10;
            uVar5 = *(undefined4 *)(param_2 + 0x54);
            param_1[2] = *(undefined4 *)(param_2 + 0x50);
            param_1[3] = uVar5;
            goto LAB_0003cfac;
        }
    }
    param_1[2] = 0xffffffff;
    param_1[3] = 0xffffffff;
LAB_0003cfac:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003d014(code *param_1, undefined4 param_2, byte *param_3)

{
    bool bVar1;
    int iVar2;
    int iVar3;
    ushort **ppuVar4;
    byte *pbVar5;
    byte *pbVar6;
    int iVar7;

    iVar2 = __stack_chk_guard;
    iVar7 = 0x32;
    pbVar6 = param_3;
    while (iVar3 = (*param_1)(param_2), iVar3 != -1) {
        if (iVar3 == 10) {
            bVar1 = true;
            goto LAB_0003d074;
        }
        if (iVar7 != 1) {
            iVar7 = iVar7 + -1;
            *pbVar6 = (byte)iVar3;
            pbVar6 = pbVar6 + 1;
        }
    }
    bVar1 = false;
LAB_0003d074:
    if (param_3 != pbVar6) {
        ppuVar4 = __ctype_b_loc();
        do {
            pbVar5 = pbVar6 + -1;
            if (((*ppuVar4)[*pbVar5] & 0x2000) == 0) {
                if (pbVar6 != param_3) {
                    bVar1 = true;
                }
                break;
            }
            pbVar6 = pbVar5;
        } while (param_3 != pbVar5);
    }
    *pbVar6 = 0;
    if (!bVar1) {
        param_3 = (byte *)0x0;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_3);
}

void FUN_0003d0f4(int param_1)

{
    int iVar1;
    undefined *puVar2;
    undefined *__dest;

    iVar1 = __stack_chk_guard;
    __dest = &DAT_000c9938;
    if (DAT_000c9b18 == &DAT_000c9938) {
        __dest = &DAT_000c9a28;
    } else if (DAT_000c9b18 != &DAT_000c9a28) {
        FUN_0003c96c(&DAT_000c9938);
        FUN_0003c96c(&DAT_000c9a28);
        DAT_000c9b18 = &DAT_000c9938;
        __dest = &DAT_000c9a28;
    }
    puVar2 = DAT_000c9b18;
    if (param_1 != 0) {
        memcpy(__dest, DAT_000c9b18, 0xf0);
        puVar2 = __dest;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar2);
}

/* WARNING: Removing unreachable block (ram,0x0003d210) */

void FUN_0003d1a4(undefined *param_1)

{
    if (param_1 == &DAT_000c9938 || param_1 == &DAT_000c9a28) {
        DAT_000c9b18 = param_1;
    }
    return;
}

void FUN_0003d220(int param_1)

{
    uint uVar1;
    int iVar2;
    uint uVar3;
    bool bVar4;

    iVar2 = __stack_chk_guard;
    uVar1 = DAT_000c9930;
    if (((-1 < param_1) &&
         (uVar3 = (uint)(param_1 != 0), bVar4 = uVar3 != DAT_000c9930,
          DAT_000c9930 = uVar3, bVar4)) &&
        (DAT_000c9b18 == &DAT_000c9a28 || DAT_000c9b18 == &DAT_000c9938)) {
        FUN_0003c96c();
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar1);
    }
    return;
}

void FUN_0003d2b0(undefined4 *param_1)

{
    int iVar1;

    param_1[1] = 0;
    param_1[2] = 0;
    iVar1 = __stack_chk_guard;
    *param_1 = 0;
    memset(param_1 + 4, 0, 0x40);
    if (iVar1 == __stack_chk_guard) {
        FUN_0003c96c(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003d320(undefined4 *param_1, undefined4 param_2, undefined4 param_3,
                  int param_4)

{
    undefined2 uVar1;
    char cVar2;
    int iVar3;
    ushort **ppuVar4;
    char *pcVar5;
    long lVar6;
    undefined4 uVar7;
    int *piVar8;
    uint uVar9;
    int local_a8;
    undefined4 uStack_a4;
    char *local_9c;
    int local_98;
    undefined4 uStack_94;
    int local_90;
    undefined4 local_8c;
    short local_88[6];
    undefined1 auStack_7c[4];
    char local_78;
    char local_77;
    short local_76;
    char local_74;
    int local_70;
    undefined4 uStack_6c;
    int local_68;
    undefined2 local_64;
    char local_62;
    byte local_60;
    char local_5f;
    undefined1 auStack_5e[50];
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_0003d2b0(param_1, param_2, &__DT_PLTGOT);
    if (param_4 != 0) {
        iVar3 = FUN_0007568c(local_88);
        if (iVar3 != 0) {
            local_88[0] = local_88[0] + -10;
            FUN_000767b4(&local_a8, local_88);
            local_90 = local_a8;
            local_8c = uStack_a4;
            goto LAB_0003d384;
        }
    }
    local_8c = 0;
    local_90 = 0;
LAB_0003d384:
LAB_0003d390:
    do {
        while (true) {
            iVar3 = FUN_0003d014(param_2, param_3, &local_60);
            if (iVar3 == 0) {
                uVar7 = 1;
                goto LAB_0003d4d4;
            }
            uVar9 = (uint)local_60;
            if (uVar9 == 0x23)
                break;
            ppuVar4 = __ctype_b_loc();
            if (((*ppuVar4)[uVar9] & 0x800) != 0) {
                FUN_0007d854(&local_a8, &local_60, &local_9c, 10);
                pcVar5 = local_9c;
                local_98 = local_a8;
                uStack_94 = uStack_a4;
                iVar3 = FUN_0003ca3c(&local_60, local_9c);
                if (iVar3 != 0)
                    goto LAB_0003d4bc;
                pcVar5 = (char *)FUN_0003c9cc(pcVar5);
                lVar6 = strtol(pcVar5, &local_9c, 10);
                iVar3 = FUN_0003ca3c(pcVar5, local_9c);
                if ((iVar3 != 0) || (0xffff < lVar6 + 0x8000U))
                    goto LAB_0003d4bc;
                iVar3 = FUN_0007daf4(&local_98, &local_90);
                uVar1 = (undefined2)lVar6;
                if (-1 < iVar3) {
                    if (*(short *)(param_1 + 8) == 0) {
                    LAB_0003d570:
                        FUN_000766d8(auStack_7c, &local_98);
                        cVar2 = local_74;
                        if (((local_77 == '\x01') && (local_76 == 0)) &&
                            (local_74 == '\0')) {
                            local_78 = local_78 + -1;
                            FUN_000767b4(&local_a8, auStack_7c);
                            local_62 = cVar2;
                            local_68 = local_98 - local_a8;
                            local_70 = local_98;
                            uStack_6c = uStack_94;
                            local_64 = uVar1;
                            iVar3 = FUN_0003cac4(param_1, &local_70);
                            if (iVar3 != 0)
                                goto LAB_0003d45c;
                        } else {
                            piVar8 = __errno_location();
                            *piVar8 = 0x16;
                        }
                    } else {
                        iVar3 = FUN_0007daf4(&local_98, param_1 + 0x14);
                        if (iVar3 == 0) {
                            if (lVar6 == *(short *)(param_1 + 0x17))
                                goto LAB_0003d45c;
                        } else if (-1 < iVar3)
                            goto LAB_0003d570;
                        piVar8 = __errno_location();
                        *piVar8 = 0x22;
                    }
                    FUN_0003d2b0(param_1);
                    uVar7 = 0;
                    goto LAB_0003d4d4;
                }
                *(undefined2 *)((int)param_1 + 0x22) = uVar1;
            LAB_0003d45c:
                *(undefined2 *)(param_1 + 2) = uVar1;
                param_1[1] = local_98;
            }
        }
        if (local_5f == '@') {
            uVar7 = FUN_0003c9cc(auStack_5e);
            FUN_0007d854(&local_a8, uVar7, &local_9c, 10);
            param_1[6] = local_a8;
            param_1[7] = uStack_a4;
            iVar3 = FUN_0003ca3c(uVar7, local_9c);
            if (iVar3 != 0)
                goto LAB_0003d4bc;
            *param_1 = param_1[6];
            goto LAB_0003d390;
        }
        if (local_5f == '$') {
            uVar7 = FUN_0003c9cc(auStack_5e);
            FUN_0007d854(&local_a8, uVar7, &local_9c, 10);
            param_1[4] = local_a8;
            param_1[5] = uStack_a4;
            iVar3 = FUN_0003ca3c(uVar7, local_9c);
            if (iVar3 != 0) {
            LAB_0003d4bc:
                piVar8 = __errno_location();
                *piVar8 = 0x54;
                FUN_0003d2b0(param_1);
                uVar7 = 0;
            LAB_0003d4d4:
                if (local_2c != __stack_chk_guard) {
                    /* WARNING: Subroutine does not return */
                    __stack_chk_fail(uVar7);
                }
                return;
            }
        }
    } while (true);
}

void FUN_0003d7d0(undefined4 *param_1, uint param_2)

{
    short sVar1;
    short sVar2;
    bool bVar3;
    int iVar4;
    int iVar5;
    undefined4 uVar6;
    uint uVar7;
    undefined1 uVar8;
    undefined4 uVar9;
    uint uVar10;
    undefined4 uVar11;
    undefined4 uVar12;
    bool bVar13;
    bool bVar14;
    uint local_50;
    undefined4 uStack_4c;
    uint local_48;
    undefined4 uStack_44;
    uint local_40;
    undefined4 local_3c;
    uint local_38;
    undefined4 uStack_34;
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_000758e8(&local_50);
    local_48 = local_50;
    uStack_44 = uStack_4c;
    iVar4 = FUN_0003d0f4(0);
    memset(param_1, 0, 0x20);
    iVar5 = FUN_0007daf4(&local_48, iVar4 + 0x40);
    if (-1 < iVar5) {
        iVar5 = FUN_0007daf4(&local_48, iVar4 + 0x28);
        if (iVar5 < 0) {
            bVar13 = false;
            goto LAB_0003d860;
        }
        FUN_0007dc24(&local_50, iVar4 + 0x28, 3);
        local_40 = local_50;
        local_3c = uStack_4c;
        iVar5 = FUN_0007daf4(&local_48, &local_40);
        if (iVar5 < 0) {
            local_40 = *(uint *)(iVar4 + 0x30);
            local_3c = *(undefined4 *)(iVar4 + 0x34);
            *(short *)(param_1 + 6) =
                (short)local_40 - (short)*(undefined4 *)(iVar4 + 0x28);
            FUN_0007dc24(&local_50, &local_48);
            local_38 = local_50;
            uStack_34 = uStack_4c;
            FUN_0003cb8c(iVar4);
            iVar5 = FUN_0007daf4(iVar4 + 0x40, &local_40);
            if (iVar5 != 0) {
                *(undefined2 *)(param_1 + 6) = 0;
            } else {
                local_48 = local_38;
                uStack_44 = uStack_34;
                param_2 = local_38;
            }
            bVar13 = iVar5 == 0;
            goto LAB_0003d860;
        }
    }
    FUN_0003cb8c(iVar4, &local_48);
    bVar13 = false;
LAB_0003d860:
    uVar6 = *(undefined4 *)(iVar4 + 0x30);
    uVar9 = *(undefined4 *)(iVar4 + 0x34);
    uVar11 = *(undefined4 *)(iVar4 + 0x40);
    uVar12 = *(undefined4 *)(iVar4 + 0x44);
    *(undefined2 *)(param_1 + 5) = *(undefined2 *)(iVar4 + 0x24);
    param_1[2] = uVar6;
    param_1[3] = uVar9;
    *param_1 = uVar11;
    param_1[1] = uVar12;
    iVar5 = FUN_0007daf4(&local_48, iVar4 + 0x38);
    if (-1 < iVar5) {
        uVar10 = *(uint *)(iVar4 + 0x28);
        sVar1 = *(short *)(iVar4 + 0x24);
        sVar2 = *(short *)(iVar4 + 0x26);
        uVar7 = uVar10 - 0x15180;
        param_1[4] = uVar10 - param_2;
        bVar14 = param_2 < uVar10;
        *(short *)((int)param_1 + 0x16) = sVar2 - sVar1;
        if (uVar10 < uVar7) {
            bVar3 = uVar7 <= param_2 || bVar14;
        } else {
            bVar3 = uVar7 <= param_2 && bVar14;
        }
        if (!bVar3) {
            uVar10 = 1;
        }
        *(undefined1 *)((int)param_1 + 0x1b) = *(undefined1 *)(iVar4 + 0x48);
        if (!bVar3) {
            *(char *)((int)param_1 + 0x1a) = (char)uVar10;
        } else {
            uVar7 = uVar10 - 10;
            if (uVar10 < uVar7) {
                bVar14 = bVar14 || uVar7 <= param_2;
            } else {
                bVar14 = uVar7 <= param_2 && bVar14;
            }
            if (!bVar14) {
                uVar10 = 2;
            }
            uVar8 = (undefined1)uVar10;
            if (bVar14) {
                uVar8 = 3;
            }
            *(undefined1 *)((int)param_1 + 0x1a) = uVar8;
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(bVar13);
    }
    return;
}

uint FUN_0003da78(undefined4 *param_1)

{
    short sVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    undefined4 uVar6;
    undefined4 uVar7;

    iVar3 = __stack_chk_guard;
    memset(param_1, 0, 0x20);
    iVar4 = FUN_0003d0f4(0);
    sVar2 = *(short *)(iVar4 + 0x24);
    uVar6 = *(undefined4 *)(iVar4 + 0x40);
    uVar7 = *(undefined4 *)(iVar4 + 0x44);
    sVar1 = *(short *)(iVar4 + 0x26);
    *(short *)(param_1 + 5) = sVar2;
    *param_1 = uVar6;
    param_1[1] = uVar7;
    uVar6 = *(undefined4 *)(iVar4 + 0x30);
    uVar7 = *(undefined4 *)(iVar4 + 0x34);
    *(short *)((int)param_1 + 0x16) = sVar1 - sVar2;
    param_1[2] = uVar6;
    param_1[3] = uVar7;
    *(undefined1 *)((int)param_1 + 0x1b) = *(undefined1 *)(iVar4 + 0x48);
    uVar5 = FUN_0007daf4(iVar4 + 0x30, iVar4 + 0x38);
    if (iVar3 == __stack_chk_guard) {
        return ~uVar5 >> 0x1f;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003db18(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_0003d0f4(0);
    if (iVar1 == __stack_chk_guard) {
        FUN_0003c96c();
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003db68(undefined4 *param_1)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    undefined4 uVar4;
    undefined4 uVar5;

    iVar1 = __stack_chk_guard;
    puVar3 = (undefined4 *)FUN_0003d0f4(0);
    uVar5 = puVar3[1];
    uVar4 = puVar3[2];
    *param_1 = *puVar3;
    iVar2 = __stack_chk_guard;
    param_1[1] = uVar5;
    param_1[2] = uVar4;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

uint FUN_0003dbd0(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    uint uVar2;
    undefined4 local_30;
    undefined4 uStack_2c;
    undefined4 local_28;
    undefined4 uStack_24;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = FUN_0003d0f4(0);
    FUN_000758e8(&local_30, param_1, param_2);
    local_28 = local_30;
    uStack_24 = uStack_2c;
    uVar2 = FUN_0007daf4(&local_28, iVar1 + 0x18);
    if (local_1c == __stack_chk_guard) {
        return ~uVar2 >> 0x1f;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003dc54(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined4 local_38;
    undefined4 uStack_34;
    undefined4 local_2c[2];
    int local_24;

    local_24 = __stack_chk_guard;
    iVar1 = FUN_0003d0f4(0);
    FUN_000758e8(&local_40, param_1, param_2);
    local_38 = local_40;
    uStack_34 = uStack_3c;
    FUN_0007dbc0(&local_40, iVar1 + 0x18, &local_38);
    local_38 = local_40;
    uStack_34 = uStack_3c;
    FUN_0007598c(local_2c, &local_38);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_2c[0]);
}

void FUN_0003dcf4(int param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    short sVar4;
    bool bVar5;
    int local_58;
    uint local_54;
    int local_50;
    uint uStack_4c;
    undefined1 auStack_44[4];
    char local_40;
    char local_3f;
    char local_3e;
    undefined1 local_3d;
    undefined1 local_3c;
    int local_38;
    uint local_34;
    int local_30;
    short local_2c;
    undefined1 local_2a;
    int local_24;

    local_24 = __stack_chk_guard;
    iVar1 = FUN_0003d0f4(1);
    FUN_000758e8(&local_58, param_2, param_3);
    local_50 = local_58;
    uStack_4c = local_54;
    iVar2 = FUN_0007daf4(&local_50, iVar1 + 0x18);
    if ((iVar2 < 0) ||
        ((*(short *)(iVar1 + 0x20) != 0 &&
          (iVar2 = FUN_0007daf4(&local_50, iVar1 + 0x50), iVar2 < 1)))) {
        piVar3 = __errno_location();
        iVar2 = 0;
        *piVar3 = 0x22;
    } else {
        FUN_000766d8(auStack_44, &local_50);
        if ((local_3f == '\x01') && (local_3e == '\0')) {
            piVar3 = __errno_location();
            *piVar3 = 0x16;
            iVar2 = 0;
        } else {
            local_3f = '\x01';
            local_3e = '\0';
            local_3d = 0;
            local_3c = 0;
            FUN_000767b4(&local_58, auStack_44);
            iVar2 = local_58;
            local_40 = local_40 + '\x01';
            FUN_000767b4(&local_58, auStack_44);
            bVar5 = *(short *)(iVar1 + 0x20) != 0;
            local_34 = local_54;
            if (bVar5) {
                local_54 = (uint) * (ushort *)(iVar1 + 0x5c);
            }
            local_2c = (short)local_54;
            local_30 = local_58 - iVar2;
            if (!bVar5) {
                local_2c = *(short *)(iVar1 + 0x22);
            }
            local_38 = local_58;
            sVar4 = -1;
            if (param_1 != 0) {
                sVar4 = 1;
            }
            local_2c = local_2c + sVar4;
            local_2a = 1;
            iVar2 = FUN_0003cac4(iVar1, &local_38);
            if ((iVar2 != 0) && (iVar2 = FUN_0003d1a4(iVar1), iVar2 != 0)) {
                iVar2 = 1;
            }
        }
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

void FUN_0003de9c(int param_1, undefined4 param_2, undefined4 param_3)

{
    char *pcVar1;
    short sVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;
    uint uVar6;
    uint uVar7;
    undefined4 local_50;
    undefined4 uStack_4c;
    undefined4 local_48;
    undefined4 uStack_44;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined4 local_38;
    undefined4 uStack_34;
    short local_30;
    int local_24;

    local_24 = __stack_chk_guard;
    iVar3 = FUN_0003d0f4(0);
    if (*(short *)(iVar3 + 0x22) == 0 && 9 < param_1) {
        if (*(ushort *)(iVar3 + 0x20) == 0) {
        LAB_0003df4c:
            FUN_000758e8(&local_50, param_2, param_3);
            local_48 = local_50;
            uStack_44 = uStack_4c;
            FUN_0003cf08(&local_40, iVar3, &local_48);
            FUN_0007dc24(&local_50, &local_40, 0x14);
            local_40 = local_50;
            uStack_3c = uStack_4c;
            iVar5 = FUN_0007daf4(&local_48, &local_40);
            if (-1 < iVar5) {
                FUN_0007dc24(&local_50, &local_38, 0xffffffec);
                local_38 = local_50;
                uStack_34 = uStack_4c;
                iVar5 = FUN_0007daf4(&local_48, &local_38);
                if (iVar5 < 1) {
                    uVar7 = (uint) * (ushort *)(iVar3 + 0x20);
                    uVar6 = (param_1 - local_30 & 0xffffU) +
                            (uint) * (ushort *)(iVar3 + 0x24);
                    sVar2 = (short)(param_1 - local_30);
                    *(short *)(iVar3 + 0x24) = (short)uVar6;
                    *(short *)(iVar3 + 0x22) = sVar2 + *(short *)(iVar3 + 0x22);
                    if (uVar7 != 0) {
                        uVar6 = 0;
                    }
                    *(short *)(iVar3 + 0x26) = sVar2 + *(short *)(iVar3 + 0x26);
                    if (uVar7 != 0) {
                        do {
                            uVar6 = uVar6 + 1;
                            *(short *)(iVar3 + 0x5c) =
                                sVar2 + *(short *)(iVar3 + 0x5c);
                            iVar3 = iVar3 + 0x10;
                        } while (uVar6 != uVar7);
                    }
                    uVar4 = 1;
                    goto LAB_0003def4;
                }
            }
        } else if (*(char *)(iVar3 + 0x5e) != '\0') {
            uVar7 = 0;
            iVar5 = iVar3;
            do {
                uVar7 = uVar7 + 1;
                if (uVar7 == *(ushort *)(iVar3 + 0x20))
                    goto LAB_0003df4c;
                pcVar1 = (char *)(iVar5 + 0x6e);
                iVar5 = iVar5 + 0x10;
            } while (*pcVar1 != '\0');
        }
    }
    uVar4 = 0;
LAB_0003def4:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar4);
    }
    return;
}

void FUN_0003e04c(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    ushort **ppuVar2;
    undefined4 uVar3;
    uint *puVar4;
    undefined1 *puVar5;
    uint uVar6;
    int iVar7;
    int local_e8;
    int local_e4;
    int local_e0;
    int local_dc;
    int local_d8;
    int local_d4;
    uint local_d0;
    undefined1 auStack_cc[4];
    undefined1 auStack_c8[4];
    undefined1 auStack_c4[4];
    undefined1 auStack_c0[4];
    undefined1 auStack_bc[92];
    byte local_60[2];
    byte abStack_5e[50];
    int local_2c;

    iVar7 = -1;
    local_2c = __stack_chk_guard;
    FUN_0008819c(auStack_bc);
    while (iVar1 = FUN_0003d014(param_1, param_2, local_60), iVar1 != 0) {
        iVar1 = strncmp((char *)local_60, "#h", 2);
        if (iVar1 == 0) {
            local_e4 = iVar1;
            local_e0 = iVar1;
            local_dc = iVar1;
            local_d8 = iVar1;
            local_d4 = iVar1;
            iVar1 = sscanf((char *)abStack_5e, " %lx %lx %lx %lx %lx%n",
                           &local_d0, auStack_cc, auStack_c8, auStack_c4,
                           auStack_c0, &local_e8);
            iVar7 = 0;
            if ((iVar1 == 5) && (abStack_5e[local_e8] < 0x21)) {
                iVar7 = 0;
                puVar4 = &local_d0;
                do {
                    uVar6 = *puVar4;
                    puVar5 = (undefined1 *)((int)&local_e0 + iVar7);
                    do {
                        puVar5 = puVar5 + -1;
                        *puVar5 = (char)uVar6;
                        uVar6 = uVar6 >> 8;
                    } while (puVar5 != (undefined1 *)((int)&local_e4 + iVar7));
                    iVar7 = iVar7 + 4;
                    *puVar4 = uVar6;
                    puVar4 = puVar4 + 1;
                } while (iVar7 != 0x14);
                iVar7 = 1;
            }
        } else {
            iVar1 = strncmp((char *)local_60, "#@", 2);
            if ((iVar1 == 0) ||
                (iVar1 = strncmp((char *)local_60, "#$", 2), iVar1 == 0)) {
                FUN_0003ce3c(auStack_bc, abStack_5e);
            } else {
                ppuVar2 = __ctype_b_loc();
                if (((*ppuVar2)[local_60[0]] & 0x800) != 0) {
                    FUN_0003ce3c(auStack_bc, local_60);
                }
            }
        }
    }
    FUN_000883e8(auStack_bc, &local_d0);
    FUN_00088250(auStack_bc);
    if (iVar7 == -1) {
        uVar3 = 0;
    } else if (iVar7 == 0) {
        uVar3 = 0xfffffffe;
    } else {
        iVar7 = memcmp(&local_e4, &local_d0, 0x14);
        if (iVar7 == 0) {
            uVar3 = 1;
        } else {
            uVar3 = 0xffffffff;
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0003e298(FILE *param_1, char *param_2, int param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    undefined4 uVar5;
    undefined4 uVar6;

    iVar1 = __stack_chk_guard;
    if (param_2 == (char *)0x0) {
        param_2 = "<unknown>";
    }
    iVar2 = FUN_0003e04c(getc, param_1);
    if (param_3 == 0) {
    LAB_0003e328:
        if (-1 < iVar2)
            goto LAB_0003e330;
        goto LAB_0003e390;
    }
    switch (iVar2) {
    case 0:
        FUN_00074e00(3, "%s (\'%s\'): no hash signature", "leapsecond file",
                     param_2);
        goto LAB_0003e330;
    case 1:
        FUN_00074e00(5, "%s (\'%s\'): good hash signature", "leapsecond file",
                     param_2);
    LAB_0003e330:
        rewind(param_1);
        iVar2 = FUN_0003d0f4(1);
        iVar3 = FUN_0003d320(iVar2, getc, param_1, 1);
        if (iVar3 != 0) {
            if (*(short *)(iVar2 + 0x20) == 0) {
                uVar5 = FUN_0003cd30(iVar2 + 0x18);
                uVar5 = FUN_00074e00(5,
                                     "%s (\'%s\'): loaded, expire=%s ofs=%d "
                                     "(no entries after build date)",
                                     "leapsecond file", param_2, uVar5,
                                     (int)*(short *)(iVar2 + 0x22));
            } else {
                uVar5 = FUN_0003cd30(iVar2 + 0x18);
                uVar6 = FUN_0003cd30(iVar2 + 0x50);
                uVar5 = FUN_00074e00(
                    5, "%s (\'%s\'): loaded, expire=%s last=%s ofs=%d",
                    "leapsecond file", param_2, uVar5, uVar6,
                    (int)*(short *)(iVar2 + 0x5c));
            }
            if (iVar1 == __stack_chk_guard) {
                FUN_0003d1a4(iVar2);
                return;
            }
            goto LAB_0003e514;
        }
        piVar4 = __errno_location();
        if (*piVar4 == 0x16) {
            FUN_00074e00(3, "%s (\'%s\'): bad transition time",
                         "leapsecond file", param_2);
        } else if (*piVar4 == 0x22) {
            FUN_00074e00(3, "%s (\'%s\'): times not ascending",
                         "leapsecond file", param_2);
        } else {
            FUN_00074e00(3, "%s (\'%s\'): parsing error", "leapsecond file",
                         param_2);
        }
        break;
    case -2:
        FUN_00074e00(3, "%s (\'%s\'): malformed hash signature",
                     "leapsecond file", param_2);
        break;
    case -1:
        FUN_00074e00(3, "%s (\'%s\'): signature mismatch", "leapsecond file",
                     param_2);
        break;
    default:
        FUN_00074e00(3, "%s (\'%s\'): unknown error code %d", "leapsecond file",
                     param_2, iVar2);
        goto LAB_0003e328;
    }
LAB_0003e390:
    uVar5 = 0;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_0003e514:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar5);
}

void FUN_0003e578(char *param_1, void *param_2, int param_3, int param_4)

{
    int iVar1;
    FILE *__stream;
    undefined4 uVar2;
    stat64 sStack_90;
    int local_24;

    local_24 = __stack_chk_guard;
    if ((param_1 != (char *)0x0) && (*param_1 != '\0')) {
        iVar1 = __xstat64(3, param_1, &sStack_90);
        if (iVar1 == 0) {
            if (param_2 != (void *)0x0) {
                if (((param_3 == 0) && (*(int *)((int)param_2 + 0x50) ==
                                        sStack_90.st_mtim.tv_sec)) &&
                    (*(int *)((int)param_2 + 0x58) == sStack_90.st_ctim.tv_sec))
                    goto LAB_0003e5b8;
                memcpy(param_2, &sStack_90, 0x68);
            }
            __stream = fopen64(param_1, "r");
            if (__stream != (FILE *)0x0) {
                uVar2 = FUN_0003e298(__stream, param_1, param_4);
                fclose(__stream);
                goto LAB_0003e5bc;
            }
            if (param_4 != 0) {
                FUN_00074e00(3, "%s (\'%s\'): open failed: %m",
                             "leapsecond file", param_1);
                uVar2 = 0;
                goto LAB_0003e5bc;
            }
        } else if (param_4 != 0) {
            FUN_00074e00(3, "%s (\'%s\'): stat failed: %m", "leapsecond file",
                         param_1);
        }
    }
LAB_0003e5b8:
    uVar2 = 0;
LAB_0003e5bc:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0003e750(int param_1)

{
    int iVar1;
    undefined8 in_d0;

    iVar1 = __stack_chk_guard;
    if (state != param_1) {
        FUN_00035ee0(param_1, 0);
    }
    state = param_1;
    last_offset = in_d0;
    DAT_000c9b28 = current_time;
    if (iVar1 == __stack_chk_guard) {
        DAT_000c9b20 = in_d0;
        return;
    }
    DAT_000c9b20 = in_d0;
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003e800(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    undefined1 auStack_61c[256];
    undefined1 auStack_51c[256];
    undefined1 auStack_41c[1024];
    int local_1c;

    local_1c = __stack_chk_guard;
    FUN_0007c054(auStack_61c, 0x100, &DAT_000a587c, param_2);
    FUN_0007c054(auStack_51c, 0x100, &DAT_000a587c, param_3);
    FUN_0007c054(auStack_41c, 0x400, "%s status: %s -> %s", param_1,
                 auStack_61c, auStack_51c);
    FUN_00035ee0(0xd, 0, auStack_41c);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003e914(void)

{
    bool bVar1;
    int iVar2;
    byte *pbVar3;
    ushort **ppuVar4;
    uint uVar5;
    byte *pbVar6;

    iVar2 = __stack_chk_guard;
    pbVar6 = DAT_000c9cb8;
    pbVar3 = DAT_000c9cb8;
    if (DAT_000c9cb8 == (byte *)0x0) {
        pbVar6 = &DAT_000c9e8c;
        strncpy((char *)&DAT_000c9e8c, "ntp_loopfilter.c", 0x1000);
        uVar5 = (uint)DAT_000c9e8c;
        DAT_000c9cb8 = &DAT_000c9e8c;
        pbVar3 = DAT_000c9cb8;
        if (uVar5 != 0) {
            ppuVar4 = __ctype_b_loc();
            bVar1 = false;
            do {
                if (((*ppuVar4)[uVar5] & 8) != 0) {
                    pbVar3 = pbVar6;
                    if (!bVar1) {
                        pbVar6 = &DAT_000c9e8c;
                        pbVar3 = DAT_000c9cb8;
                    }
                    break;
                }
                pbVar6 = pbVar6 + 1;
                uVar5 = (uint)*pbVar6;
                bVar1 = true;
                pbVar3 = pbVar6;
            } while (uVar5 != 0);
        }
    }
    DAT_000c9cb8 = pbVar3;
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pbVar6);
    }
    return;
}

void FUN_0003ea24(undefined4 param_1, undefined4 param_2, int param_3,
                  int param_4, int param_5, undefined4 param_6)

{
    int *piVar1;
    undefined4 uVar2;
    undefined *puVar3;
    undefined4 *local_430;
    undefined4 local_42c;
    undefined1 auStack_428[1020];
    int local_2c[2];

    local_2c[0] = __stack_chk_guard;
    local_42c = 0;
    memset(auStack_428, 0, 0x3fc);
    local_430 = &local_42c;
    switch (param_2) {
    case 0:
        break;
    case 1:
        FUN_00074e00(6, "kernel reports leap second insertion scheduled");
        break;
    case 2:
        FUN_00074e00(6, "kernel reports leap second deletion scheduled");
        break;
    case 3:
        FUN_00074e00(6, "kernel reports leap second in progress");
        break;
    case 4:
        FUN_00074e00(6, "kernel reports leap second has occurred");
        break;
    case 5:
        if ((DAT_000c9cd0 & 0x40) != 0) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a7f7c;
            } else {
                puVar3 = &DAT_000a58ac;
            }
            FUN_0007ec04(&local_430, local_2c, "%sClock Unsynchronized",
                         puVar3);
        }
        if ((DAT_000c9cd0 & 0x1000) != 0) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a7f7c;
            } else {
                puVar3 = &DAT_000a58ac;
            }
            FUN_0007ec04(&local_430, local_2c, "%sClock Error", puVar3);
        }
        if ((DAT_000c9cd0 & 0x102) == 2) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a7f7c;
            } else {
                puVar3 = &DAT_000a58ac;
            }
            FUN_0007ec04(&local_430, local_2c,
                         "%sPPS Frequency Sync wanted but no PPS", puVar3);
        }
        if ((DAT_000c9cd0 & 0x104) == 4) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a7f7c;
            } else {
                puVar3 = &DAT_000a58ac;
            }
            FUN_0007ec04(&local_430, local_2c,
                         "%sPPS Time Sync wanted but no PPS signal", puVar3);
        }
        if ((DAT_000c9cd0 & 0x204) == 0x204) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a7f7c;
            } else {
                puVar3 = &DAT_000a58ac;
            }
            FUN_0007ec04(&local_430, local_2c,
                         "%sPPS Time Sync wanted but PPS Jitter exceeded",
                         puVar3);
        }
        if ((~DAT_000c9cd0 & 0x402) == 0) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a7f7c;
            } else {
                puVar3 = &DAT_000a58ac;
            }
            FUN_0007ec04(&local_430, local_2c,
                         "%sPPS Frequency Sync wanted but PPS Wander exceeded",
                         puVar3);
        }
        if ((~DAT_000c9cd0 & 0x802) == 0) {
            if ((char)local_42c == '\0') {
                puVar3 = &DAT_000a7f7c;
            } else {
                puVar3 = &DAT_000a58ac;
            }
            FUN_0007ec04(
                &local_430, local_2c,
                "%sPPS Frequency Sync wanted but Calibration error detected",
                puVar3);
        }
        if ((param_4 != 0) && ((DAT_000c9cd0 & 0x100) == 0)) {
            FUN_00035ee0(0xd, 0, "no PPS signal");
        }
        FUN_00074e00(6, "kernel reports TIME_ERROR: %#x: %s", DAT_000c9cd0,
                     &local_42c);
        break;
    case 0xffffffff:
        if (param_3 == 0xe) {
            uVar2 = FUN_0003e914();
            FUN_00074e00(3,
                         "%s: %s line %d: invalid struct timex pointer: 0x%lx",
                         param_1, uVar2, param_6, &DAT_000c9cbc);
        } else if (param_3 == 0x16) {
            uVar2 = FUN_0003e914();
            FUN_00074e00(3,
                         "%s: %s line %d: invalid struct timex \"constant\" "
                         "element value: %ld",
                         param_1, uVar2, param_6, DAT_000c9cd4);
        } else if (param_3 == 1) {
            piVar1 = __errno_location();
            if (param_5 != 0) {
                *piVar1 = 1;
                FUN_00074e00(3, "%s: ntp_adjtime(TAI) failed: %m", param_1);
            }
            *piVar1 = 1;
            uVar2 = FUN_0003e914();
            FUN_00074e00(3, "%s: %s line %d: ntp_adjtime: %m", param_1, uVar2,
                         param_6);
        } else {
            uVar2 = FUN_0003e914();
            FUN_00074e00(5,
                         "%s: %s line %d: unhandled errno value %d after "
                         "failed ntp_adjtime call",
                         param_1, uVar2, param_6, param_3);
        }
        break;
    default:
        uVar2 = FUN_0003e914();
        FUN_00074e00(5,
                     "%s: %s line %d: unhandled return value %d from "
                     "ntp_adjtime() in %s at line %d",
                     param_1, uVar2, param_6, param_2,
                     "ntp_adjtime_error_handler", 0x1af);
    }
    if (local_2c[0] != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0003ef84(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    pll_control = 1;
    memset(&DAT_000c9cc0, 0, 0x7c);
    DAT_000c9cbc = 0x3d;
    DAT_000c9cd0 = 0x41;
    DAT_000c9cc8 = 16000000;
    DAT_000c9ccc = 16000000;
    DAT_000c9dc0 = 0;
    DAT_000c9cd4 = (uint)sys_poll;
    DAT_000c9d3c = &DAT_0003e8c0;
    iVar2 =
        sigaction(0x1f, (sigaction *)&DAT_000c9d3c, (sigaction *)&DAT_000c9dc8);
    if (iVar2 == 0) {
        iVar2 = __sigsetjmp(&DAT_000c9b30, 1);
        if ((iVar2 == 0) && (iVar2 = adjtimex(&DAT_000c9cbc), iVar2 != 0)) {
            piVar3 = __errno_location();
            FUN_0003ea24("start_kern_loop", iVar2, *piVar3, 0, 0, 0x467);
        }
        iVar2 = sigaction(0x1f, (sigaction *)&DAT_000c9dc8, (sigaction *)0x0);
        if (iVar2 == 0) {
            pll_status = DAT_000c9cd0;
            if (pll_control != 0) {
                if (DAT_000c9e54 == 0) {
                    DAT_000c9e54 = 1;
                    FUN_0009c1a8(&DAT_0003f368);
                }
                if ((pll_status & 0x8000) != 0) {
                    ext_enable = 1;
                }
                FUN_00035ee0(0xd, 0, "kernel time sync enabled");
            }
        } else {
            FUN_00074e00(3, "sigaction() restore SIGSYS: %m");
            pll_control = 0;
            pll_status = DAT_000c9cd0;
        }
    } else {
        FUN_00074e00(3, "sigaction() trap SIGSYS: %m");
        pll_control = 0;
        pll_status = DAT_000c9cd0;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0003f1ec(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    char *pcVar4;
    double in_d0;

    iVar1 = __stack_chk_guard;
    drift_comp = in_d0;
    if (pll_control == 0) {
        pcVar4 = "ntpd";
    } else {
        memset(&DAT_000c9cc0, 0, 0x7c);
        DAT_000c9cbc = 2;
        if (kern_enable == 0) {
            pcVar4 = "ntpd";
        } else {
            pcVar4 = "kernel";
            DAT_000c9cc4 = (undefined4)(longlong)(in_d0 * 65536000000.0);
        }
        iVar2 = adjtimex(&DAT_000c9cbc);
        if (iVar2 != 0) {
            piVar3 = __errno_location();
            FUN_0003ea24("set_freq", iVar2, *piVar3, 0, 0, 0x43e);
        }
    }
    FUN_000362e8(2, 0, "%s %.3f PPM", pcVar4, drift_comp * 1000000.0);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0003f40c(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    sys_poll = ntp_minpoll;
    clock_jitter = ldexp(1.0, (int)sys_precision);
    freq_cnt = (undefined4)(longlong)clock_minstep;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x0003fab4 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_0003f4bc(int param_1)

{
    bool bVar1;
    byte bVar2;
    int iVar3;
    int *piVar4;
    uint uVar5;
    uint uVar6;
    double *pdVar7;
    undefined4 uVar8;
    uint uVar9;
    undefined4 uVar10;
    double in_d0;
    double dVar11;
    double dVar12;
    double dVar13;
    double dVar14;
    double dVar15;
    double dVar16;
    undefined1 auStack_ac[80];
    int local_5c;

    local_5c = __stack_chk_guard;
    if (ntp_enable == 0) {
        FUN_00051e10(sys_poll);
        uVar8 = 0;
        goto LAB_0003fb3c;
    }
    if (((clock_panic < ABS(in_d0)) && (0.0 < clock_panic)) &&
        (allow_panic == 0)) {
        FUN_0007c054(auStack_ac, 0x50,
                     "%+.0f s; set clock manually within %.0f s.");
        uVar8 = 0xffffffff;
        FUN_00035ee0(7, 0, auStack_ac);
        goto LAB_0003fb3c;
    }
    allow_panic = 0;
    if (mode_ntpdate != 0) {
        if (((clock_max_fwd < in_d0) && (0.0 < clock_max_fwd)) ||
            ((clock_max_back < -in_d0 && (0.0 < clock_max_back)))) {
            FUN_0006ff34();
            FUN_00074e00(5, "ntpd: time set %+.6f s");
            __printf_chk(1, "ntpd: time set %+.6fs\n");
        } else {
            FUN_0006fca8();
            FUN_00074e00(5, "ntpd: time slew %+.6f s");
            __printf_chk(1, "ntpd: time slew %+.6fs\n");
        }
        FUN_00051e10(sys_poll);
        /* WARNING: Subroutine does not return */
        exit(0);
    }
    if (DAT_000c9e58 != 0) {
        dVar13 = *(double *)(param_1 + 0x268);
        pdVar7 = (double *)(DAT_000c9e58 + DAT_000c9e5c * 8);
        bVar1 = dVar13 < *pdVar7;
        if (bVar1) {
            *pdVar7 = dVar13;
        }
        if (bVar1) {
            dVar13 = *(double *)(param_1 + 0x268);
        }
        if (dVar13 < DAT_000c9e60) {
            DAT_000c9e60 = dVar13;
        }
        if (0.0 < in_d0) {
            dVar13 = -((dVar13 - DAT_000c9e60) * 0.5);
        } else {
            dVar13 = (dVar13 - DAT_000c9e60) * 0.5;
        }
        in_d0 = in_d0 + dVar13;
    }
    dVar13 = drift_comp;
    iVar3 = DAT_000c9b28;
    uVar6 = (uint) * (byte *)(param_1 + 0x41);
    uVar9 = (uint)sys_poll;
    bVar2 = *(byte *)(param_1 + 0x41);
    if (uVar6 <= uVar9) {
        uVar6 = uVar9;
        bVar2 = sys_poll;
    }
    sys_poll = bVar2;
    if (*(byte *)(param_1 + 0x42) < uVar6) {
        sys_poll = *(byte *)(param_1 + 0x42);
    }
    dVar15 = (double)(uint)(current_time - DAT_000c9b28);
    uVar10 = SUB84(in_d0, 0);
    uVar8 = 0;
    if (((clock_max_fwd < in_d0) && (0.0 < clock_max_fwd)) ||
        ((clock_max_back < -in_d0 && (0.0 < clock_max_back)))) {
        if (force_step_once != 0) {
        LAB_0003faec:
            force_step_once = 0;
            FUN_00074e00(5, "Doing intital time step");
        }
        if (state == (undefined8 *)0x4) {
            if (dVar15 < clock_minstep)
                goto LAB_0003fb3c;
            FUN_0003f1ec(
                SUB84(in_d0 / (double)(uint)(current_time - DAT_000c9b28), 0));
            dVar13 = drift_comp;
        LAB_0003fbe8:
            if (dVar15 < clock_minstep)
                goto LAB_0003fb3c;
        } else {
            if (state == (undefined8 *)0x5) {
                FUN_0007c054(auStack_ac, 0x50, "%+.6f s");
                FUN_00035ee0(3, 0, auStack_ac);
                state = (undefined8 *)0x3;
                goto LAB_0003fb3c;
            }
            if (state == (undefined8 *)0x3)
                goto LAB_0003fbe8;
        }
        FUN_0007c054(auStack_ac, 0x50, "%+.6f s");
        FUN_00035ee0(0xc, 0, auStack_ac);
        FUN_0006ff34(uVar10);
        FUN_00050c14();
        tc_counter = 0;
        clock_jitter = ldexp(1.0, (int)sys_precision);
        if (state == (undefined8 *)0x1) {
            uVar8 = 2;
            FUN_0003e750(0, 4);
            goto LAB_0003fb3c;
        }
        uVar8 = 2;
        FUN_0003e750(0, 5);
    } else {
        if (force_step_once != 0)
            goto LAB_0003faec;
        dVar14 = in_d0 - last_offset;
        dVar16 = clock_jitter * clock_jitter;
        dVar11 = ldexp(1.0, (int)sys_precision);
        if (ABS(dVar14) <= dVar11) {
            dVar11 = ldexp(1.0, (int)sys_precision);
            dVar14 = ABS(in_d0 - last_offset);
        } else {
            dVar14 = ABS(in_d0 - last_offset);
            dVar11 = dVar14;
        }
        dVar12 = ldexp(1.0, (int)sys_precision);
        if (dVar14 <= dVar12) {
            dVar14 = ldexp(1.0, (int)sys_precision);
        } else {
            dVar14 = ABS(in_d0 - last_offset);
        }
        dVar16 = dVar16 + (dVar11 * dVar14 - dVar16) * 0.125;
        dVar11 = SQRT(dVar16);
        if (dVar16 < 0.0) {
            sqrt(dVar16);
        }
        clock_jitter = dVar11;
        if (state == (undefined8 *)0x1) {
            FUN_0006fca8(uVar10);
            FUN_0003e750(uVar10, 4);
            uVar8 = 1;
        } else {
            if (state == (undefined8 *)0x4) {
                if (dVar15 < clock_minstep)
                    goto LAB_0003fb3c;
                FUN_0003f1ec(
                    SUB84(in_d0 / (double)(uint)(current_time - iVar3), 0));
                dVar13 = drift_comp;
            }
            dVar11 = DAT_000c9b20;
            if (freq_cnt == 0) {
                uVar6 = (uint)allan_xpt;
                if (uVar6 <= sys_poll) {
                    dVar14 = ldexp(1.0, (uint)sys_poll);
                    dVar16 = dVar15;
                    if (dVar15 < dVar14) {
                        dVar16 = ldexp(1.0, (uint)sys_poll);
                    }
                    uVar6 = (uint)allan_xpt;
                    dVar13 = dVar13 + (in_d0 - dVar11) / (dVar16 * 0.25);
                }
                dVar11 = ldexp(1.0, uVar6);
                if (dVar11 < dVar15) {
                    dVar15 = ldexp(1.0, (uint)allan_xpt);
                }
                dVar11 = ldexp(1.0, (uint)sys_poll);
                dVar13 =
                    dVar13 + (in_d0 * dVar15) / (dVar11 * 64.0 * dVar11 * 64.0);
            }
            FUN_0003e750(uVar10, 5);
            uVar8 = 1;
            if (ABS(in_d0) < 0.0005) {
                freq_cnt = 0;
            }
        }
    }
    if (((pll_control != 0) && (kern_enable != 0)) && (freq_cnt == 0)) {
        memset(&DAT_000c9cbc, 0, 0x80);
        if (ext_enable == 0) {
            dVar13 = -0.5;
            if (0.0 <= DAT_000c9b20) {
                dVar13 = 0.5;
            }
            DAT_000c9cbc = 0x203d;
            DAT_000c9cd4 = (uint)sys_poll;
            DAT_000c9cc0 =
                (undefined4)(longlong)(dVar13 + DAT_000c9b20 * 1000000000.0);
            DAT_000c9ccc = (uint)(0.0 < clock_jitter * 1000000.0) *
                           (int)(longlong)(clock_jitter * 1000000.0);
            DAT_000c9cd0 = 1;
            dVar13 = (sys_rootdisp + sys_rootdelay * 0.5) * 1000000.0;
            DAT_000c9cc8 = (uint)(0.0 < dVar13) * (int)(longlong)dVar13;
            if (hardpps_enable == 0) {
                if ((pll_status & 4) != 0) {
                    FUN_0003e800("PPS disabled");
                }
            } else {
                DAT_000c9cd0 = 7;
                if ((pll_status & 4) == 0) {
                    FUN_0003e800("PPS enabled");
                }
            }
            if (sys_leap == '\x01') {
                DAT_000c9cd0 = DAT_000c9cd0 | 0x10;
            } else if (sys_leap == '\x02') {
                DAT_000c9cd0 = DAT_000c9cd0 | 0x20;
            }
        } else {
            DAT_000c9cbc = 0x10;
        }
        iVar3 = adjtimex(&DAT_000c9cbc);
        if ((iVar3 < 0) || (kernel_status != iVar3)) {
            kernel_status = iVar3;
            piVar4 = __errno_location();
            FUN_0003ea24("local_clock", iVar3, *piVar4, hardpps_enable);
        }
        pll_status = DAT_000c9cd0;
        dVar13 = (double)(longlong)DAT_000c9cc4 / 65536000000.0;
        if ((DAT_000c9cd0 & 4) != 0) {
            clock_jitter = (double)(longlong)DAT_000c9cf0 / 1000000000.0;
        }
        if (DAT_000c9e68 != sys_tai) {
            DAT_000c9cbc = 0x80;
            DAT_000c9cd4 = sys_tai;
            DAT_000c9e68 = sys_tai;
            iVar3 = adjtimex(&DAT_000c9cbc);
            if (iVar3 != 0) {
                piVar4 = __errno_location();
                FUN_0003ea24("local_clock", iVar3, *piVar4, 0);
            }
        }
    }
    if (0.0005 < ABS(dVar13)) {
        FUN_00074e00(5, "frequency error %.0f PPM exceeds tolerance %.0f PPM",
                     SUB84(dVar13 * 1000000.0, 0),
                     (int)((ulonglong)(dVar13 * 1000000.0) >> 0x20));
    }
    dVar15 = dVar13 - drift_comp;
    if (0.0005 < dVar13) {
        drift_comp = 0.0005;
    }
    if ((dVar13 <= 0.0005) && (drift_comp = dVar13, dVar13 < -0.0005)) {
        drift_comp = -0.0005;
    }
    dVar13 = clock_stability * clock_stability +
             (dVar15 * dVar15 - clock_stability * clock_stability) * 0.125;
    if (dVar13 < 0.0) {
        sqrt(dVar13);
    }
    uVar6 = (uint)sys_poll;
    if (freq_cnt < 1) {
        if (ABS(DAT_000c9b20) < clock_jitter * 4.0) {
            tc_counter = tc_counter + uVar6;
            if ((0x1e < tc_counter) &&
                (tc_counter = 0x1e, uVar6 < *(byte *)(param_1 + 0x42))) {
                uVar5 = uVar6 + 1;
                goto LAB_0003fedc;
            }
        } else {
            tc_counter = tc_counter + uVar6 * -2;
            if ((tc_counter + 0x1e < 0 != SCARRY4(tc_counter, 0x1e)) &&
                (tc_counter = -0x1e, *(byte *)(param_1 + 0x41) < uVar6)) {
                uVar5 = uVar6 - 1;
            LAB_0003fedc:
                uVar6 = uVar5 & 0xff;
                tc_counter = 0;
                sys_poll = (byte)uVar5;
            }
        }
    } else {
        tc_counter = 0;
    }
    clock_stability = SQRT(dVar13);
    if (uVar9 != uVar6) {
        FUN_00044264(param_1, uVar6);
        uVar6 = (uint)sys_poll;
    }
    FUN_00051e10(SUB84(DAT_000c9b20, 0), (int)((ulonglong)DAT_000c9b20 >> 0x20),
                 SUB84(drift_comp, 0), (int)((ulonglong)drift_comp >> 0x20),
                 SUB84(clock_jitter, 0), (int)((ulonglong)clock_jitter >> 0x20),
                 SUB84(clock_stability, 0), uVar6);
LAB_0003fb3c:
    if (local_5c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar8);
    }
    return;
}

void FUN_000401e4(void)

{
    double dVar1;
    int iVar2;
    double dVar3;
    double dVar4;
    double dVar5;

    iVar2 = __stack_chk_guard;
    dVar1 = DAT_000c9b20;
    sys_rootdisp = sys_rootdisp + clock_phi;
    if ((ntp_enable == 0) || (mode_ntpdate != 0))
        goto LAB_00040300;
    if (state == 5) {
        if (0 < freq_cnt) {
            freq_cnt = freq_cnt + -1;
            dVar5 = DAT_000c9b20 * 0.03125;
            goto LAB_00040280;
        }
        if ((pll_control == 0) || (kern_enable == 0)) {
            dVar5 = ldexp(1.0, (uint)sys_poll);
            dVar5 = dVar1 / (dVar5 * 16.0);
            goto LAB_00040280;
        }
        dVar5 = 0.0;
    } else {
        dVar5 = 0.0;
    LAB_00040280:
        dVar4 = drift_comp;
        if ((pll_control != 0) && (kern_enable != 0)) {
            dVar4 = 0.0;
        }
        dVar3 = 0.0005;
        if ((0.0005 < dVar5 + dVar4) ||
            (dVar3 = -0.0005, dVar5 + dVar4 < -0.0005)) {
            dVar5 = dVar3 - dVar4;
        }
    }
    DAT_000c9b20 = dVar1 - dVar5;
    enable_panic_check = 0;
    FUN_0006fca8();
    enable_panic_check = 1;
LAB_00040300:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00040520(void)

{
    bool bVar1;
    int iVar2;
    int iVar3;
    int extraout_r1;
    double *pdVar4;
    double *pdVar5;
    double dVar6;
    double dVar7;

    iVar3 = __stack_chk_guard;
    iVar2 = DAT_000c9e70;
    pdVar5 = DAT_000c9e58;
    if (DAT_000c9e58 != (double *)0x0) {
        FUN_0009bb9c(DAT_000c9e5c + 1, DAT_000c9e70);
        dVar6 = 1000000000.0;
        DAT_000c9e5c = extraout_r1;
        pdVar5[extraout_r1] = 1000000000.0;
        DAT_000c9e60 = 1000000000.0;
        if (0 < iVar2) {
            pdVar4 = pdVar5 + iVar2;
            bVar1 = false;
            do {
                dVar7 = *pdVar5;
                pdVar5 = pdVar5 + 1;
                if (dVar7 < dVar6) {
                    bVar1 = true;
                    dVar6 = dVar7;
                }
            } while (pdVar5 != pdVar4);
            if (bVar1) {
                DAT_000c9e60 = dVar6;
            }
        }
    }
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00040454) */
/* WARNING: Removing unreachable block (ram,0x000404d0) */

void FUN_000405f8(undefined4 param_1)

{
    int iVar1;
    undefined4 *puVar2;
    int iVar4;
    undefined4 *puVar5;
    double in_d0;
    double dVar6;
    double dVar7;
    undefined4 *puVar3;

    iVar1 = __stack_chk_guard;
    switch (param_1) {
    case 1:
        if (mode_ntpdate == 0) {
            FUN_0003ef84();
            dVar7 = 0.0005;
            dVar6 = DAT_000c9e78 / 1000000.0;
            if ((dVar6 <= 0.0005) && (dVar7 = dVar6, dVar6 < -0.0005)) {
                dVar7 = -0.0005;
            }
            FUN_0003f1ec(SUB84(dVar7, 0));
            if (freq_set == 0) {
                FUN_0003e750(0, 1);
            } else {
                DAT_000c9b20._0_4_ = 0;
                DAT_000c9b20._4_4_ = 0;
                state = 2;
                last_offset._0_4_ = 0;
                last_offset._4_4_ = 0;
                DAT_000c9b28 = current_time;
            }
            DAT_000c9e6c = 1;
        }
        break;
    case 2:
        break;
    case 3:
        clock_max_back = in_d0;
    joined_r0x00040830:
        clock_max_fwd = in_d0;
        if ((in_d0 != 0.0) && (in_d0 <= 0.5))
            break;
        goto LAB_00040784;
    case 4:
        clock_max_back = in_d0;
        if ((in_d0 != 0.0) && (((in_d0 <= 0.5 && (clock_max_fwd != 0.0)) &&
                                (clock_max_fwd <= 0.5))))
            break;
        goto LAB_00040784;
    case 5:
        clock_max_fwd = in_d0;
        if ((clock_max_back != 0.0) && (clock_max_back <= 0.5))
            goto joined_r0x00040830;
    LAB_00040784:
        if (kern_enable != 0) {
            iVar4 = pll_control;
            if (pll_control != 0) {
                iVar4 = 1;
            }
            if (kern_enable == 0) {
                iVar4 = 0;
            }
            if (iVar4 != 0) {
                FUN_00035ee0(0xd, 0, "kernel time sync disabled");
            }
            kern_enable = 0;
            if ((pll_control != 0) && (DAT_000c9e6c != 0)) {
                if (iVar1 == __stack_chk_guard) {
                    FUN_0003f1ec((int)drift_comp);
                    return;
                }
                goto LAB_00040500;
            }
        }
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    LAB_00040500:
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    case 6:
        clock_panic = in_d0;
        break;
    case 7:
        clock_phi = in_d0 / 1000000.0;
        break;
    case 8:
        clock_minstep = in_d0;
        if (in_d0 < 300.0) {
            clock_minstep = 300.0;
        }
        break;
    case 9:
    default:
    code_r0x0004097c:
        FUN_00074e00(5, "loop_config: unsupported option %d", param_1);
        return;
    case 10:
        allan_xpt = (0.0 < in_d0) * (char)(longlong)in_d0;
        break;
    case 0xb:
        if (in_d0 < 900.0) {
            DAT_000c9e70 = 1;
        } else {
            DAT_000c9e70 = (int)(longlong)(in_d0 / 900.0);
        }
        DAT_000c9e58 = (undefined4 *)FUN_00073c68(0, DAT_000c9e70, 8);
        if (0 < DAT_000c9e70) {
            puVar5 = DAT_000c9e58 + DAT_000c9e70 * 2;
            puVar2 = DAT_000c9e58;
            do {
                puVar3 = puVar2 + 2;
                *puVar2 = 0;
                puVar2[1] = 0x41cdcd65;
                puVar2 = puVar3;
            } while (puVar5 != puVar3);
        }
        DAT_000c9e60._0_4_ = 0;
        DAT_000c9e60._4_4_ = 0x41cdcd65;
        break;
    case 0xc:
        freq_set = freq_set + 1;
        DAT_000c9e78 = in_d0;
        break;
    case 0xd:
        clock_codec = in_d0 / 1000000.0;
        break;
    case 0xe:
        goto code_r0x0004097c;
    case 0xf:
        FUN_000486b0();
        return;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00040a38(void)

{
    undefined4 *puVar1;
    int iVar2;
    int iVar3;
    undefined4 *puVar4;
    int iVar5;

    iVar2 = __stack_chk_guard;
    iVar5 = mru_incalloc;
    if (DAT_000cae90 == 0) {
        iVar5 = mru_initalloc;
    }
    if (iVar5 != 0) {
        iVar3 = FUN_00073c68(0, iVar5, 0x48);
        puVar4 = (undefined4 *)(iVar3 + iVar5 * 0x48);
        mru_alloc = mru_alloc + iVar5;
        do {
            puVar1 = DAT_000cae94;
            puVar4 = (undefined4 *)memset(puVar4 + -0x12, 0, 0x48);
            iVar5 = iVar5 + -1;
            *puVar4 = puVar1;
            DAT_000cae94 = puVar4;
        } while (iVar5 != 0);
        DAT_000cae90 = DAT_000cae90 + 1;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00040b44(int *param_1)

{
    int iVar1;
    uint uVar2;
    int *piVar3;
    int *piVar4;
    int *piVar5;

    iVar1 = __stack_chk_guard;
    mru_entries = mru_entries + -1;
    uVar2 = FUN_0007c568(param_1 + 0xb);
    uVar2 = uVar2 & ~(-1 << mon_hash_bits);
    piVar4 = *(int **)(mon_hash + uVar2 * 4);
    piVar3 = (int *)(mon_hash + uVar2 * 4);
    if (param_1 == piVar4) {
    LAB_00040bf4:
        *piVar3 = *param_1;
        piVar4 = param_1;
    } else if (piVar4 == (int *)0x0) {
        piVar4 = (int *)0x0;
    } else {
        piVar3 = piVar4;
        piVar5 = (int *)*piVar4;
        if ((int *)*piVar4 == (int *)0x0) {
            piVar4 = (int *)0x0;
        } else {
            do {
                if (param_1 == piVar5)
                    goto LAB_00040bf4;
                piVar4 = (int *)*piVar5;
                piVar3 = piVar5;
                piVar5 = piVar4;
            } while (piVar4 != (int *)0x0);
        }
    }
    if (piVar4 != param_1) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_monitor.c", 0x88, 1, "punlinked == mon");
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00040cc0) */

void FUN_00040c68(void)

{
    mon_enabled = 0;
    mon_mru_list._8_4_ = mon_mru_list;
    mon_mru_list._4_4_ = mon_mru_list;
    return;
}

void FUN_00040cd4(uint param_1)

{
    int iVar1;
    uint uVar2;
    int iVar3;
    uint uVar4;
    uint uVar5;

    iVar1 = __stack_chk_guard;
    if (param_1 != 0) {
        if (mon_enabled == 0) {
            if (DAT_000cae90 == 0) {
                FUN_00040a38();
            }
            uVar4 = (mru_maxdepth >> 3) + 1 >> 1;
            if (uVar4 == 0) {
                iVar3 = 0x40;
                mon_hash_bits = 4;
            } else {
                uVar2 = 1;
                do {
                    uVar5 = uVar2;
                    uVar4 = uVar4 >> 1;
                    uVar2 = uVar5 + 1 & 0xff;
                } while (uVar4 != 0);
                if (uVar5 < 4) {
                    uVar5 = 4;
                }
                if (0xf < uVar5) {
                    uVar5 = 0x10;
                }
                mon_hash_bits = (undefined1)uVar5;
                iVar3 = 4 << uVar5;
            }
            mon_hash = FUN_00073ba4(mon_hash, iVar3, 0, 1);
            mon_enabled = param_1;
        } else {
            mon_enabled = mon_enabled | param_1;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00040dfc(uint param_1)

{
    undefined4 *puVar1;
    int iVar2;
    undefined4 *puVar3;
    undefined4 *puVar4;

    iVar2 = __stack_chk_guard;
    if (((mon_enabled == 0) || ((param_1 & mon_enabled) == 0)) ||
        (mon_enabled = mon_enabled & ~param_1, mon_enabled != 0)) {
        return;
    }
    mon_enabled = 0;
    puVar4 = (undefined4 *)mon_mru_list._8_4_;
    if ((undefined1 *)mon_mru_list._8_4_ != mon_mru_list) {
        do {
            puVar3 = puVar4;
            puVar1 = DAT_000cae94;
            puVar4 = (undefined4 *)puVar3[2];
            memset(puVar3 + 1, 0, 0x44);
            *puVar3 = puVar1;
            DAT_000cae94 = puVar3;
        } while (puVar4 != (undefined4 *)mon_mru_list);
    }
    mon_mru_list._8_4_ = mon_mru_list;
    mon_mru_list._4_4_ = mon_mru_list;
    mru_entries = 0;
    if (iVar2 == __stack_chk_guard) {
        memset(mon_hash, 0, 4 << mon_hash_bits);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00040f28(int param_1)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    undefined4 *puVar4;

    iVar1 = __stack_chk_guard;
    puVar3 = (undefined4 *)mon_mru_list._8_4_;
    if ((undefined1 *)mon_mru_list._8_4_ != mon_mru_list) {
        do {
            while (puVar4 = (undefined4 *)puVar3[2], puVar3[3] != param_1) {
                puVar3 = puVar4;
                if (puVar4 == (undefined4 *)mon_mru_list)
                    goto LAB_00040fc8;
            }
            iVar2 = puVar3[1];
            *(undefined4 **)(iVar2 + 8) = puVar4;
            *(int *)(puVar3[2] + 4) = iVar2;
            FUN_00040b44(puVar3);
            memset(puVar3 + 1, 0, 0x44);
            *puVar3 = DAT_000cae94;
            DAT_000cae94 = puVar3;
            puVar3 = puVar4;
        } while (puVar4 != (undefined4 *)mon_mru_list);
    }
LAB_00040fc8:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00040ff4(int param_1, uint param_2)

{
    short sVar1;
    undefined2 uVar2;
    undefined4 uVar3;
    int iVar4;
    uint uVar5;
    int iVar6;
    int iVar7;
    uint uVar8;
    int iVar9;
    undefined1 uVar10;
    int *piVar11;
    uint uVar12;
    int iVar13;
    byte local_4c;
    int *local_38;

    iVar4 = __stack_chk_guard;
    if (param_1 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_monitor.c", 0x148, 0, "rbufp != ((void *)0)");
    }
    if (mon_enabled == 0) {
    LAB_00041038:
        param_2 = param_2 & 0xf7bf;
        goto LAB_00041040;
    }
    uVar5 = FUN_0007c568((int *)(param_1 + 4));
    iVar9 = mon_hash;
    local_4c = *(byte *)(param_1 + 0x58) & 7;
    uVar8 = ((uint) * (byte *)(param_1 + 0x58) << 0x1a) >> 0x1d;
    uVar5 = uVar5 & ~(-1 << mon_hash_bits);
    piVar11 = *(int **)(mon_hash + uVar5 * 4);
    iVar7 = uVar5 * 4;
    if (piVar11 != (int *)0x0) {
        sVar1 = *(short *)(param_1 + 4);
    LAB_000410d4:
        do {
            if ((short)piVar11[0xb] == sVar1) {
                if (sVar1 == 2) {
                    if (piVar11[0xc] != *(int *)(param_1 + 8)) {
                        piVar11 = (int *)*piVar11;
                        if (piVar11 == (int *)0x0)
                            break;
                        goto LAB_000410d4;
                    }
                } else {
                    iVar6 =
                        memcmp(piVar11 + 0xd, (void *)(param_1 + 0xc), 0x10);
                    if ((iVar6 != 0) ||
                        (piVar11[0x11] != *(int *)(param_1 + 0x1c)))
                        goto LAB_000410c8;
                }
                iVar6 = *(int *)(param_1 + 0x48);
                uVar2 = *(undefined2 *)(param_1 + 6);
                iVar9 = piVar11[6];
                iVar7 = *(int *)(param_1 + 0x4c);
                iVar13 = piVar11[1];
                uVar5 = *(uint *)(param_1 + 0x4c);
                uVar12 = piVar11[7];
                piVar11[6] = *(int *)(param_1 + 0x48);
                piVar11[7] = iVar7;
                piVar11[9] = piVar11[9] + 1;
                *(byte *)((int)piVar11 + 0x2a) = local_4c | (byte)(uVar8 << 3);
                *(undefined2 *)((int)piVar11 + 0x2e) = uVar2;
                iVar9 = (iVar6 - iVar9) + (-(uint)(uVar5 < uVar12) -
                                           ((int)(uVar5 - uVar12) >> 0x1f));
                *(int *)(iVar13 + 8) = piVar11[2];
                iVar7 = piVar11[8];
                *(int *)(piVar11[2] + 4) = iVar13;
                uVar3 = mon_mru_list._8_4_;
                uVar5 = iVar7 - iVar9;
                uVar5 = uVar5 & ~((int)uVar5 >> 0x1f);
                piVar11[1] = (int)mon_mru_list;
                piVar11[2] = uVar3;
                *(int **)(mon_mru_list._8_4_ + 4) = piVar11;
                mon_mru_list._8_4_ = piVar11;
                piVar11[8] = uVar5;
                iVar7 = 8 << ntp_minpoll;
                iVar6 = uVar5 + (1 << ntp_minpoll);
                if (iVar6 < iVar7 && ntp_minpkt <= iVar9 + 1) {
                    piVar11[8] = iVar6 + -2;
                    param_2 = param_2 & 0xf7bf;
                } else if ((int)uVar5 < iVar7) {
                    piVar11[8] = (1 << ntp_minpoll) + iVar7;
                } else {
                    param_2 = param_2 & 0xf7ff;
                }
                *(short *)(piVar11 + 10) = (short)param_2;
                goto LAB_00041040;
            }
        LAB_000410c8:
            piVar11 = (int *)*piVar11;
        } while (piVar11 != (int *)0x0);
    }
    local_38 = (int *)mon_mru_list._4_4_;
    if (mru_entries < mru_mindepth) {
        if ((DAT_000cae94 == (int *)0x0) &&
            (FUN_00040a38(), DAT_000cae94 == (int *)0x0))
            goto LAB_000414c0;
        piVar11 = (int *)(mon_hash + iVar7);
        local_38 = DAT_000cae94;
        DAT_000cae94 = (int *)*DAT_000cae94;
    } else {
        iVar6 = mon_mru_list._4_4_ + -0x11830c;
        if (iVar6 != 0) {
            iVar6 = 1;
        }
        if (mon_mru_list._4_4_ == 0) {
            iVar6 = 0;
        }
        if (iVar6 == 0) {
            iVar6 = 0;
            local_38 = (int *)0x0;
        LAB_000413dc:
            if (DAT_000cae94 == (int *)0x0) {
                if (mru_maxdepth <= mru_alloc) {
                    iVar9 = FUN_00078ae4();
                    if ((double)(longlong)iVar6 / (double)(longlong)mon_age <
                        (double)(longlong)iVar9 * 1.1641532182693481e-10)
                        goto LAB_00041038;
                    iVar9 = local_38[1];
                    *(int *)(iVar9 + 8) = local_38[2];
                    *(int *)(local_38[2] + 4) = iVar9;
                    FUN_00040b44(local_38);
                    goto LAB_00041490;
                }
                FUN_00040a38();
                iVar9 = mon_hash;
                if (DAT_000cae94 == (int *)0x0) {
                LAB_000414c0:
                    /* WARNING: Subroutine does not return */
                    FUN_0007ecc0("ntp_monitor.c", 0x1d7, 2,
                                 "mon != ((void *)0)");
                }
            }
            piVar11 = (int *)(iVar9 + iVar7);
            local_38 = DAT_000cae94;
            DAT_000cae94 = (int *)*DAT_000cae94;
        } else {
            iVar6 = (*(int *)(param_1 + 0x48) -
                     *(int *)(mon_mru_list._4_4_ + 0x18)) +
                    (-(uint)(*(uint *)(param_1 + 0x4c) <
                             *(uint *)(mon_mru_list._4_4_ + 0x1c)) -
                     ((int)(*(uint *)(param_1 + 0x4c) -
                            *(uint *)(mon_mru_list._4_4_ + 0x1c)) >>
                      0x1f));
            if (iVar6 <= mru_maxage)
                goto LAB_000413dc;
            iVar9 = *(int *)(mon_mru_list._4_4_ + 4);
            *(undefined4 *)(iVar9 + 8) =
                *(undefined4 *)(mon_mru_list._4_4_ + 8);
            *(int *)(*(int *)((int)local_38 + 8) + 4) = iVar9;
            FUN_00040b44(local_38);
        LAB_00041490:
            memset(local_38, 0, 0x48);
            piVar11 = (int *)(mon_hash + iVar7);
        }
    }
    param_2 = param_2 & 0xf7bf;
    uVar5 = mru_entries + 1;
    local_4c = local_4c | (byte)(uVar8 << 3);
    iVar7 = *(int *)(param_1 + 0x48);
    iVar9 = *(int *)(param_1 + 0x4c);
    mru_entries = uVar5;
    local_38[6] = iVar7;
    local_38[7] = iVar9;
    local_38[4] = iVar7;
    local_38[5] = iVar9;
    *(short *)(local_38 + 10) = (short)param_2;
    if (uVar5 <= mru_peakentries) {
        uVar5 = mru_peakentries;
    }
    local_38[9] = 1;
    local_38[8] = 0;
    iVar7 = *(int *)(param_1 + 8);
    iVar9 = *(int *)(param_1 + 0xc);
    iVar6 = *(int *)(param_1 + 0x10);
    mru_peakentries = uVar5;
    local_38[0xb] = *(int *)(param_1 + 4);
    local_38[0xc] = iVar7;
    local_38[0xd] = iVar9;
    local_38[0xe] = iVar6;
    iVar7 = *(int *)(param_1 + 0x14);
    iVar9 = *(int *)(param_1 + 0x18);
    local_38[0x11] = *(int *)(param_1 + 0x1c);
    local_38[0xf] = iVar7;
    local_38[0x10] = iVar9;
    *(byte *)((int)local_38 + 0x2a) = local_4c;
    iVar7 = *(int *)(param_1 + 0x3c);
    uVar5 = *(uint *)(iVar7 + 0x90);
    local_38[3] = iVar7;
    if (((uVar5 & 0x40) == 0) ||
        (*(int *)(param_1 + 0x40) != *(int *)(iVar7 + 0xc))) {
        if (*(int *)(iVar7 + 0x10) == *(int *)(param_1 + 0x40)) {
            uVar10 = 4;
        } else {
            uVar10 = 1;
        }
    } else {
        uVar10 = 2;
    }
    *(undefined1 *)((int)local_38 + 0x2b) = uVar10;
    *local_38 = *piVar11;
    *piVar11 = (int)local_38;
    uVar3 = mon_mru_list._8_4_;
    local_38[1] = (int)mon_mru_list;
    local_38[2] = uVar3;
    *(int **)(mon_mru_list._8_4_ + 4) = local_38;
    mon_mru_list._8_4_ = local_38;
LAB_00041040:
    if (iVar4 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_2);
    }
    return;
}

void FUN_00041634(undefined4 *param_1, int param_2)

{
    undefined4 *puVar1;
    int iVar2;
    uint uVar3;
    undefined4 uVar4;
    undefined4 *puVar5;
    undefined4 *puVar6;
    int *piVar7;
    undefined4 *puVar8;
    int iVar9;
    bool bVar10;

    iVar2 = __stack_chk_guard;
    if (param_2 != 0) {
        puVar8 = param_1 + 4;
        uVar3 = FUN_0007c568(puVar8);
        uVar3 = uVar3 & 0x7f;
        iVar9 = *(int *)(peer_hash_count + uVar3 * 4);
        *(int *)(peer_hash_count + uVar3 * 4) = iVar9 + -1;
        puVar5 = *(undefined4 **)(peer_hash + uVar3 * 4);
        if (param_1 == puVar5) {
            piVar7 = (int *)(peer_hash + uVar3 * 4);
        LAB_00041750:
            *piVar7 = *(int *)(*piVar7 + 4);
        } else {
            if (puVar5 != (undefined4 *)0x0) {
                for (puVar6 = (undefined4 *)puVar5[1];
                     puVar6 != (undefined4 *)0x0;
                     puVar6 = (undefined4 *)puVar6[1]) {
                    if (puVar6 == param_1) {
                        piVar7 = puVar5 + 1;
                        goto LAB_00041750;
                    }
                    puVar5 = puVar6;
                }
            }
            *(int *)(peer_hash_count + uVar3 * 4) = iVar9;
            uVar4 = FUN_0007c2e8(puVar8);
            FUN_00074e00(3, "peer %s not in address table!", uVar4);
        }
        uVar3 = *(ushort *)(param_1 + 0xf) & 0x7f;
        iVar9 = *(int *)(assoc_hash_count + uVar3 * 4);
        *(int *)(assoc_hash_count + uVar3 * 4) = iVar9 + -1;
        puVar5 = *(undefined4 **)(assoc_hash + uVar3 * 4);
        if (param_1 == puVar5) {
            piVar7 = (int *)(assoc_hash + uVar3 * 4);
        LAB_000417e8:
            *piVar7 = *(int *)(*piVar7 + 8);
        } else {
            if (puVar5 != (undefined4 *)0x0) {
                for (puVar6 = (undefined4 *)puVar5[2];
                     puVar6 != (undefined4 *)0x0;
                     puVar6 = (undefined4 *)puVar6[2]) {
                    if (param_1 == puVar6) {
                        piVar7 = puVar5 + 2;
                        goto LAB_000417e8;
                    }
                    puVar5 = puVar6;
                }
            }
            *(int *)(assoc_hash_count + uVar3 * 4) = iVar9;
            uVar4 = FUN_0007c2e8(puVar8);
            FUN_00074e00(3, "peer %s not in association ID table!", uVar4);
        }
        puVar5 = &peer_list;
        puVar6 = peer_list;
        if (param_1 == peer_list) {
        LAB_00041868:
            *puVar5 = *puVar6;
        } else {
            if (peer_list != (undefined4 *)0x0) {
                puVar6 = (undefined4 *)*peer_list;
                puVar5 = peer_list;
                while (puVar1 = puVar6, puVar1 != (undefined4 *)0x0) {
                    if (param_1 == puVar1) {
                        puVar6 = (undefined4 *)*puVar5;
                        goto LAB_00041868;
                    }
                    puVar5 = puVar1;
                    puVar6 = (undefined4 *)*puVar1;
                }
            }
            uVar4 = FUN_0007c2e8(puVar8);
            FUN_00074e00(3, "%s not in peer list!", uVar4);
        }
    }
    if ((void *)param_1[0xb] != (void *)0x0) {
        free((void *)param_1[0xb]);
    }
    if ((void *)param_1[0x14] != (void *)0x0) {
        free((void *)param_1[0x14]);
    }
    if ((void *)param_1[0xc] != (void *)0x0) {
        free((void *)param_1[0xc]);
    }
    memset(param_1, 0, 0x308);
    bVar10 = iVar2 == __stack_chk_guard;
    puVar5 = param_1;
    *param_1 = DAT_000cae98;
    DAT_000cae98 = puVar5;
    peer_free_count = peer_free_count + 1;
    if (bVar10) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0004194c) */

void FUN_000418d8(void)

{
    return;
}

void FUN_00041958(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    DAT_000cbdc8 = &DAT_000cc0d0;
    DAT_000cbac0 = &DAT_000cbdc8;
    DAT_000cb7b8 = &DAT_000cbac0;
    DAT_000cb4b0 = &DAT_000cb7b8;
    DAT_000cb1a8 = &DAT_000cb4b0;
    DAT_000caea0 = &DAT_000cb1a8;
    DAT_000cc0d0 = &DAT_000cc3d8;
    DAT_000cc3d8 = DAT_000cae98;
    DAT_000cae98 = &DAT_000caea0;
    total_peer_structs = 8;
    peer_free_count = 8;
    do {
        DAT_000cae9c = FUN_00078ae4();
    } while (DAT_000cae9c == 0);
    DAT_000cae9e = DAT_000cae9c;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00041a44(short *param_1, char *param_2, undefined4 *param_3,
                  uint param_4, byte param_5, int *param_6)

{
    short sVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    int *piVar5;

    iVar2 = __stack_chk_guard;
    if (param_2 == (char *)0x0) {
        if (param_3 == (undefined4 *)0x0) {
            uVar4 = FUN_0007c568();
            piVar5 = *(int **)(peer_hash + (uVar4 & 0x7f) * 4);
        } else {
            piVar5 = (int *)param_3[1];
        }
        if (piVar5 != (int *)0x0) {
            do {
                if ((param_6 != (int *)0x0) &&
                    (*(short *)((int)piVar5 + 0x10) == *param_1)) {
                    if (*(short *)((int)piVar5 + 0x10) == 2) {
                        if (*(int *)(param_1 + 2) ==
                            *(int *)((int)piVar5 + 0x14)) {
                            *param_6 = *param_6 + 1;
                        }
                    } else {
                        iVar3 = memcmp(param_1 + 4,
                                       (void *)((int)piVar5 + 0x18), 0x10);
                        if ((iVar3 == 0) && (*(int *)(param_1 + 0xc) ==
                                             *(int *)((int)piVar5 + 0x28))) {
                            *param_6 = *param_6 + 1;
                        }
                    }
                }
                if ((((param_4 == 0xffffffff) ||
                      (param_4 == *(byte *)((int)piVar5 + 0x3f))) ||
                     (((*(byte *)((int)piVar5 + 0x48) & 0x20) != 0 &&
                       ((param_5 & 0x20) != 0)))) &&
                    ((param_1[1] == *(short *)((int)piVar5 + 0x12) &&
                      (*(short *)((int)piVar5 + 0x10) == *param_1)))) {
                    if (*(short *)((int)piVar5 + 0x10) == 2) {
                        if (*(int *)(param_1 + 2) ==
                            *(int *)((int)piVar5 + 0x14))
                            goto LAB_00041aec;
                    } else {
                        iVar3 = memcmp(param_1 + 4,
                                       (void *)((int)piVar5 + 0x18), 0x10);
                        if ((iVar3 == 0) && (*(int *)(param_1 + 0xc) ==
                                             *(int *)((int)piVar5 + 0x28)))
                            goto LAB_00041aec;
                    }
                }
                piVar5 = *(int **)((int)piVar5 + 4);
            } while (piVar5 != (int *)0x0);
        }
    } else {
        sVar1 = *param_1;
        piVar5 = peer_list;
        if (param_3 != (undefined4 *)0x0) {
            piVar5 = (int *)*param_3;
        }
        for (; piVar5 != (int *)0x0; piVar5 = (int *)*piVar5) {
            if (((((char *)piVar5[0xb] != (char *)0x0) &&
                  ((param_4 == 0xffffffff ||
                    (param_4 == *(byte *)((int)piVar5 + 0x3f))))) &&
                 ((sVar1 == 0 || (*(short *)(piVar5 + 4) == 0 ||
                                  sVar1 == *(short *)(piVar5 + 4))))) &&
                (iVar3 = strcasecmp((char *)piVar5[0xb], param_2), iVar3 == 0))
                goto LAB_00041aec;
        }
    }
    piVar5 = (int *)0x0;
LAB_00041aec:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar5);
}

/* WARNING: Removing unreachable block (ram,0x00041cfc) */

void FUN_00041c78(uint param_1)

{
    int iVar1;

    assocpeer_calls = assocpeer_calls + 1;
    for (iVar1 = *(int *)(assoc_hash + (param_1 & 0x7f) * 4);
         (iVar1 != 0 && (*(ushort *)(iVar1 + 0x3c) != param_1));
         iVar1 = *(int *)(iVar1 + 8)) {
    }
    return;
}

void FUN_00041d10(void)

{
    int iVar1;
    int *piVar2;

    iVar1 = __stack_chk_guard;
    piVar2 = peer_list;
    if (peer_list != (int *)0x0) {
        do {
            while ((*(byte *)(piVar2 + 0x12) & 0x1e) != 0) {
                piVar2 = (int *)*piVar2;
                if (piVar2 == (int *)0x0)
                    goto LAB_00041d80;
            }
            FUN_00046214(piVar2, &DAT_000a5e50);
            piVar2 = (int *)*piVar2;
        } while (piVar2 != (int *)0x0);
    }
LAB_00041d80:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00041dac(int param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    iVar5 = 100;
    iVar2 = FUN_000418d8(*(undefined1 *)(param_1 + 0x128),
                         *(undefined4 *)(param_1 + 300));
    for (piVar4 = (int *)peer_list; piVar4 != (int *)0x0;
         piVar4 = (int *)*piVar4) {
        if (((piVar4[0x11] & 2U) != 0) &&
            (iVar3 = FUN_000418d8(*(undefined1 *)(piVar4 + 0x4a), piVar4[0x4b]),
             iVar3 <= iVar5)) {
            iVar5 = iVar3;
        }
    }
    if (iVar2 != iVar5) {
        iVar5 = 0;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
}

void FUN_00041e54(int param_1, int param_2)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    int iVar5;
    int iVar6;
    undefined4 *puVar7;

    iVar1 = __stack_chk_guard;
    if ((param_1 == 0) || (iVar6 = *(int *)(param_1 + 0x38), iVar6 == param_2))
        goto LAB_00041f60;
    if (param_2 == 0) {
        if (iVar6 == 0)
            goto LAB_00041f60;
    LAB_00041ea8:
        iVar5 = *(int *)(iVar6 + 0xb8);
        *(int *)(iVar6 + 0xbc) = *(int *)(iVar6 + 0xbc) + -1;
        if (param_1 == iVar5) {
            puVar7 = (undefined4 *)(iVar6 + 0xb8);
            iVar6 = param_1;
        LAB_00041efc:
            *puVar7 = *(undefined4 *)(iVar6 + 0xc);
        } else if (iVar5 != 0) {
            for (iVar6 = *(int *)(iVar5 + 0xc); iVar6 != 0;
                 iVar6 = *(int *)(iVar6 + 0xc)) {
                if (iVar6 == param_1) {
                    puVar7 = (undefined4 *)(iVar5 + 0xc);
                    iVar6 = *(int *)(iVar5 + 0xc);
                    goto LAB_00041efc;
                }
                iVar5 = iVar6;
            }
        }
        uVar2 = FUN_0007c2e8(param_1 + 0x10);
        uVar3 = FUN_00028fb4(*(undefined4 *)(param_1 + 0x38));
        uVar4 = FUN_00028fb4(param_2);
        FUN_00074e00(6, "%s local addr %s -> %s", uVar2, uVar3, uVar4);
        *(int *)(param_1 + 0x38) = param_2;
        if (param_2 == 0)
            goto LAB_00041f60;
    } else {
        if ((((*(uint *)(param_1 + 0x44) & 0x10) != 0) &&
             ((*(uint *)(param_2 + 0x90) & 0x100) != 0)) &&
            (*(char *)(param_1 + 0x3f) == '\x03'))
            goto LAB_00041f60;
        if (iVar6 != 0)
            goto LAB_00041ea8;
        *(int *)(param_1 + 0x38) = param_2;
    }
    iVar6 = *(int *)(param_2 + 0xbc);
    *(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(param_2 + 0xb8);
    *(int *)(param_2 + 0xbc) = iVar6 + 1;
    *(int *)(param_2 + 0xb8) = param_1;
LAB_00041f60:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00041fc4(int param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_000362e8(0x82, param_1, "assoc %u", *(undefined2 *)(param_1 + 0x3c));
    FUN_00050824(param_1 + 0x10, 1, 0);
    FUN_00041e54(param_1, 0);
    peer_demobilizations = peer_demobilizations + 1;
    peer_associations = peer_associations + -1;
    if ((*(uint *)(param_1 + 0x44) & 2) != 0) {
        peer_preempt = peer_preempt + -1;
    }
    if ((*(uint *)(param_1 + 0x44) & 8) != 0) {
        FUN_00049640(param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        FUN_00041634(param_1, 1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000420b4(void)

{
    int iVar1;
    undefined4 uVar2;
    byte bVar3;
    int *piVar4;
    int *piVar5;
    int iVar6;

    iVar1 = __stack_chk_guard;
    piVar4 = peer_list;
    if (peer_list != (int *)0x0) {
        do {
            if ((piVar4[0xe] == 0) ||
                ((*(byte *)((int)piVar4 + 0x12a) & 3) == 0)) {
                piVar5 = piVar4 + 4;
                uVar2 = FUN_00028c28(piVar4, piVar5, 0);
                iVar6 = piVar4[0xe];
                FUN_00041e54(piVar4, uVar2);
                if (piVar4[0xe] != 0) {
                    bVar3 = *(byte *)(piVar4 + 0x12);
                    if (((iVar6 != piVar4[0xe]) && ((bVar3 & 0x10) == 0)) &&
                        ((char)piVar4[0x17] != '\x05')) {
                        FUN_00046214(piVar4, &DAT_000a5e7c);
                        bVar3 = *(byte *)(piVar4 + 0x12);
                    }
                    if ((bVar3 & 4) != 0) {
                        FUN_00026020(piVar4[0xe], piVar5);
                        bVar3 = *(byte *)(piVar4 + 0x12);
                    }
                    if ((bVar3 & 2) != 0) {
                        FUN_000260c4(piVar4[0xe], piVar5);
                    }
                }
            }
            piVar4 = (int *)*piVar4;
        } while (piVar4 != (int *)0x0);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000421d4(int *param_1, int param_2, int param_3, int param_4,
                  undefined1 param_5, undefined1 param_6, byte param_7,
                  byte param_8, uint param_9, byte param_10, int param_11,
                  uint param_12, int param_13)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    byte bVar4;
    short sVar5;
    int iVar6;
    uint uVar7;
    uint uVar8;
    int *piVar9;
    int *piVar10;
    int local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    local_30 = 0;
    uVar8 = (uint)param_10;
    if (crypto_flags == 0) {
        if (param_12 < 0x10000) {
            if ((param_9 & 0x800) != 0) {
                FUN_00074e00(3, "Autokey not configured");
                piVar9 = (int *)0x0;
                goto LAB_0004235c;
            }
            goto LAB_00042278;
        }
    } else {
    LAB_00042278:
        if ((param_2 != 0) && ((param_10 & 8) == 0)) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_peer.c", 0x321, 2,
                         "((void *)0) == hostname || (0x08 & cast_flags)");
        }
        if (param_3 == 0) {
            iVar1 =
                FUN_00041a44(param_1, param_2, 0, param_5, uVar8, &local_30);
            if (iVar1 == 0)
                goto LAB_000423a4;
        } else {
            iVar1 =
                FUN_00041a44(param_1, param_2, 0, param_5, uVar8, &local_30);
            if (iVar1 == 0) {
            LAB_000423a4:
                if ((param_4 < 0) || (local_30 < param_4)) {
                    if (peer_free_count == 0) {
                        piVar9 = (int *)FUN_00073c68(0, 4, 0x308);
                        piVar9[0x246] = (int)DAT_000cae98;
                        piVar9[0x184] = (int)(piVar9 + 0x246);
                        piVar9[0xc2] = (int)(piVar9 + 0x184);
                        *piVar9 = (int)(piVar9 + 0xc2);
                        peer_free_count = peer_free_count + 4;
                        total_peer_structs = total_peer_structs + 4;
                    } else {
                        piVar9 = DAT_000cae98;
                        if (DAT_000cae98 == (int *)0x0) {
                            /* WARNING: Subroutine does not return */
                            FUN_0007ecc0("ntp_peer.c", 0x36e, 2,
                                         "peer != ((void *)0)");
                        }
                    }
                    DAT_000cae98 = (int *)*piVar9;
                    peer_free_count = peer_free_count + -1;
                    peer_associations = peer_associations + 1;
                    if ((param_9 & 2) != 0) {
                        peer_preempt = peer_preempt + 1;
                    }
                    piVar10 = piVar9 + 4;
                    sVar5 = DAT_000cae9c + 1;
                    *(short *)(piVar9 + 0xf) = DAT_000cae9c;
                    if (sVar5 == 0) {
                        sVar5 = 1;
                    }
                    iVar1 = param_1[1];
                    iVar6 = param_1[2];
                    iVar2 = param_1[3];
                    DAT_000cae9c = sVar5;
                    *piVar10 = *param_1;
                    piVar9[5] = iVar1;
                    piVar9[6] = iVar6;
                    piVar9[7] = iVar2;
                    iVar1 = param_1[5];
                    iVar6 = param_1[6];
                    piVar9[8] = param_1[4];
                    piVar9[9] = iVar1;
                    piVar9[10] = iVar6;
                    if (param_2 != 0) {
                        iVar1 = FUN_00073d08(param_2);
                        piVar9[0xb] = iVar1;
                    }
                    *(undefined1 *)((int)piVar9 + 0x3f) = param_5;
                    *(byte *)(piVar9 + 0x12) = param_10;
                    *(undefined1 *)((int)piVar9 + 0x3e) = param_6;
                    piVar9[0x11] = param_9;
                    uVar3 = FUN_00028c28(piVar9, param_1, param_3);
                    FUN_00041e54(piVar9, uVar3);
                    if (param_7 == 0) {
                        param_7 = 6;
                        *(undefined1 *)((int)piVar9 + 0x41) = 6;
                    } else {
                        if (0x10 < param_7) {
                            param_7 = 0x11;
                        }
                        *(byte *)((int)piVar9 + 0x41) = param_7;
                    }
                    if (param_8 == 0) {
                        bVar4 = 10;
                        *(undefined1 *)((int)piVar9 + 0x42) = 10;
                    } else {
                        bVar4 = param_8;
                        if (param_8 < 3) {
                            bVar4 = 3;
                        }
                        *(byte *)((int)piVar9 + 0x42) = bVar4;
                    }
                    if (bVar4 < param_7) {
                        *(byte *)((int)piVar9 + 0x41) = bVar4;
                    }
                    uVar8 = (uVar8 << 0x1d) >> 0x1f;
                    if (piVar9[0xe] == 0) {
                        uVar8 = 0;
                    }
                    if (uVar8 != 0) {
                        FUN_00026020(piVar9[0xe], param_1);
                    }
                    if (((param_10 & 2) != 0) && (piVar9[0xe] != 0)) {
                        FUN_000260c4(piVar9[0xe], param_1);
                    }
                    if (0xffff < param_12) {
                        piVar9[0x11] = piVar9[0x11] | 0x800;
                    }
                    piVar9[0x13] = param_11;
                    piVar9[0x1f] = param_12;
                    if (param_13 != 0) {
                        iVar1 = FUN_00073d08();
                        piVar9[0x14] = iVar1;
                    }
                    *(undefined1 *)(piVar9 + 0x10) =
                        *(undefined1 *)((int)piVar9 + 0x41);
                    *(undefined1 *)((int)piVar9 + 0x5f) = sys_precision;
                    if ((param_10 & 0x10) == 0) {
                        if ((param_10 & 8) == 0) {
                            if ((param_10 & 2) == 0) {
                                if ((param_10 & 4) == 0) {
                                    FUN_00046214(piVar9, &DAT_000a5ef8);
                                } else {
                                    FUN_00046214(piVar9, &DAT_000a5ef0);
                                }
                            } else {
                                FUN_00046214(piVar9, &DAT_000a5ee8);
                            }
                        } else {
                            FUN_00046214(piVar9, &DAT_000a5ee0);
                        }
                    } else {
                        FUN_00046214(piVar9, &DAT_000a5ed8);
                    }
                    iVar1 = current_time;
                    if (mode_ntpdate != 0) {
                        peer_ntpdate = peer_ntpdate + 1;
                    }
                    piVar9[0xb5] = current_time;
                    piVar9[0xb8] = iVar1;
                    piVar9[0xb7] = iVar1;
                    if (((short)piVar9[4] == 2) &&
                        ((short)piVar9[5] == 0x7f7f)) {
                        if (param_8 == 0) {
                            *(undefined1 *)((int)piVar9 + 0x42) =
                                *(undefined1 *)((int)piVar9 + 0x41);
                        }
                        iVar1 = FUN_000496d4(piVar9);
                        if (iVar1 == 0) {
                            FUN_00041e54(piVar9, 0);
                            FUN_00041634(piVar9, 0);
                            piVar9 = (int *)0x0;
                            goto LAB_0004235c;
                        }
                    }
                    uVar8 = FUN_0007c568(piVar10);
                    uVar8 = uVar8 & 0x7f;
                    piVar9[1] = *(int *)(peer_hash + uVar8 * 4);
                    *(int **)(peer_hash + uVar8 * 4) = piVar9;
                    uVar7 = *(ushort *)(piVar9 + 0xf) & 0x7f;
                    *(int *)(peer_hash_count + uVar8 * 4) =
                        *(int *)(peer_hash_count + uVar8 * 4) + 1;
                    piVar9[2] = *(int *)(assoc_hash + uVar7 * 4);
                    *(int **)(assoc_hash + uVar7 * 4) = piVar9;
                    *(int *)(assoc_hash_count + uVar7 * 4) =
                        *(int *)(assoc_hash_count + uVar7 * 4) + 1;
                    *piVar9 = (int)peer_list;
                    peer_list = piVar9;
                    FUN_00050824(piVar10, 0);
                    FUN_000362e8(0x81, piVar9, "assoc %d", (short)piVar9[0xf]);
                    goto LAB_0004235c;
                }
            } else {
                iVar6 = *(int *)(iVar1 + 0x38);
                if (param_3 != iVar6) {
                    do {
                        if (((param_10 & 0x20) != 0) &&
                            ((*(byte *)(iVar1 + 0x48) & 0x20) != 0))
                            break;
                        iVar2 = any6_interface;
                        if ((short)*param_1 == 2) {
                            iVar2 = any_interface;
                        }
                        if ((iVar2 == param_3) &&
                            (iVar2 = FUN_000278f8(param_1), iVar6 == iVar2))
                            break;
                        iVar1 = FUN_00041a44(param_1, param_2, iVar1, param_5,
                                             uVar8, &local_30);
                        if (iVar1 == 0)
                            goto LAB_000423a4;
                        iVar6 = *(int *)(iVar1 + 0x38);
                    } while (iVar6 != param_3);
                }
            }
        }
    }
    piVar9 = (int *)0x0;
LAB_0004235c:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar9);
    }
    return;
}

void FUN_00042898(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_000421d4();
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00042af4) */

void FUN_00042a70(void)

{
    findpeer_calls = 0;
    assocpeer_calls = 0;
    peer_allocations = 0;
    peer_demobilizations = 0;
    peer_timereset = current_time;
    return;
}

void FUN_00042b18(int param_1)

{
    undefined4 uVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    if (param_1 != 0) {
        *(undefined4 *)(param_1 + 0x2e4) = 0;
        *(undefined4 *)(param_1 + 0x2e8) = 0;
        uVar1 = current_time;
        *(undefined4 *)(param_1 + 0x2ec) = 0;
        *(undefined4 *)(param_1 + 0x2f0) = 0;
        *(undefined4 *)(param_1 + 0x2d4) = uVar1;
        *(undefined4 *)(param_1 + 0x2f8) = 0;
        *(undefined4 *)(param_1 + 0x2fc) = 0;
        *(undefined4 *)(param_1 + 0x300) = 0;
        *(undefined4 *)(param_1 + 0x304) = 0;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00042b9c(void)

{
    int iVar1;
    int *piVar2;

    iVar1 = __stack_chk_guard;
    for (piVar2 = (int *)peer_list; piVar2 != (int *)0x0;
         piVar2 = (int *)*piVar2) {
        FUN_00042b18(piVar2);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00042c90) */

void FUN_00042c0c(int param_1)

{
    uint uVar1;
    uint uVar2;
    undefined4 *puVar3;

    puVar3 = &peer_list;
    do {
        do {
            puVar3 = (undefined4 *)*puVar3;
            if (puVar3 == (undefined4 *)0x0) {
                return;
            }
        } while ((*(byte *)(puVar3 + 0x12) & 0x18) == 0);
        uVar2 = *(uint *)(param_1 + 0x70);
        uVar1 = *(uint *)(param_1 + 0x74);
    } while ((puVar3[0x92] != (uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                               (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18)) ||
             (puVar3[0x93] != (uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                               (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18)));
    return;
}

void FUN_00042ca0(int param_1, int param_2, int *param_3)

{
    byte bVar1;
    int iVar2;
    uint uVar3;
    int iVar4;
    uint uVar5;
    int iVar6;

    iVar2 = __stack_chk_guard;
    findpeer_calls = findpeer_calls + 1;
    uVar3 = FUN_0007c568(param_1 + 4);
    iVar6 = *(int *)(peer_hash + (uVar3 & 0x7f) * 4);
    if (iVar6 != 0) {
        do {
            bVar1 = *(byte *)(iVar6 + 0x3f);
            if ((((bVar1 == 6) ||
                  (*(int *)(iVar6 + 0x38) == *(int *)(param_1 + 0x3c))) &&
                 (*(short *)(param_1 + 6) == *(short *)(iVar6 + 0x12))) &&
                (*(short *)(iVar6 + 0x10) == *(short *)(param_1 + 4))) {
                if (*(short *)(iVar6 + 0x10) == 2) {
                    iVar4 = *(int *)(param_1 + 8) - *(int *)(iVar6 + 0x14);
                    if (iVar4 != 0) {
                        iVar4 = 1;
                    }
                } else {
                    iVar4 = memcmp((void *)(param_1 + 0xc),
                                   (void *)(iVar6 + 0x18), 0x10);
                    if (iVar4 != 0)
                        goto LAB_00042d24;
                    iVar4 = *(int *)(param_1 + 0x1c) - *(int *)(iVar6 + 0x28);
                    if (iVar4 != 0) {
                        iVar4 = 1;
                    }
                }
                if (iVar4 == 0) {
                    iVar4 = *(int *)(AM + ((uint)bVar1 * 7 + param_2) * 4);
                    *param_3 = iVar4;
                    if (iVar4 == 1 && param_2 == 4) {
                        uVar5 = *(uint *)(param_1 + 0x70);
                        uVar3 = *(uint *)(param_1 + 0x74);
                        if ((*(uint *)(iVar6 + 0x248) ==
                             (uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                              (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18)) &&
                            (*(uint *)(iVar6 + 0x24c) ==
                             (uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                              (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18)))
                            goto LAB_00042dc0;
                        iVar4 = FUN_00042c0c(param_1);
                        if (iVar4 != 0) {
                            iVar6 = 0;
                            *param_3 = -1;
                            goto LAB_00042dc0;
                        }
                        iVar4 = *param_3;
                    }
                    if (iVar4 == -1) {
                        iVar6 = 0;
                        goto LAB_00042dc0;
                    }
                    if (iVar4 != 0)
                        goto LAB_00042dc0;
                }
            }
        LAB_00042d24:
            iVar6 = *(int *)(iVar6 + 4);
        } while (iVar6 != 0);
    }
    iVar6 = 0;
    *param_3 = *(int *)(AM + param_2 * 4);
LAB_00042dc0:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar6);
    }
    return;
}

void FUN_00042e6c(void)

{
    int iVar1;
    int iVar2;
    short sVar3;

    iVar1 = __stack_chk_guard;
    sVar3 = DAT_000cae9e;
    if (DAT_000cae9e != DAT_000cae9c) {
        do {
            if ((sVar3 != 0) && (iVar2 = FUN_00041c78(sVar3), iVar2 != 0)) {
                FUN_00041fc4();
            }
            sVar3 = sVar3 + 1;
        } while (DAT_000cae9c != sVar3);
    }
    iVar2 = FUN_00041c78();
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_00041fc4();
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00042fcc) */

undefined4 FUN_00042f28(int param_1)

{
    double dVar1;
    double dVar2;

    dVar2 =
        *(double *)(param_1 + 0x278) +
        (*(double *)(param_1 + 0x268) + *(double *)(param_1 + 0x60)) * 0.5 +
        (double)(uint)(current_time - *(int *)(param_1 + 0x2c0)) * clock_phi +
        *(double *)(param_1 + 0x68) + *(double *)(param_1 + 0x270);
    dVar1 = sys_mindisp;
    if (sys_mindisp <= dVar2) {
        dVar1 = dVar2;
    }
    return SUB84(dVar1, 0);
}

void FUN_00042fe4(int param_1)

{
    byte bVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    uint uVar5;
    bool bVar6;
    undefined4 uVar7;
    undefined4 extraout_s1;
    double dVar8;

    iVar2 = __stack_chk_guard;
    if ((*(char *)(param_1 + 0x5b) == '\x03') ||
        ((int)(uint) * (byte *)(param_1 + 0x5d) < sys_floor)) {
        uVar4 = *(uint *)(param_1 + 0x44);
        uVar5 = 0x200;
    } else {
        uVar4 = *(uint *)(param_1 + 0x44);
        if ((int)(uint) * (byte *)(param_1 + 0x5d) < sys_ceiling) {
            uVar5 = 0;
        } else {
            uVar5 = 0x200;
        }
    }
    if ((uVar4 & 8) == 0) {
        uVar7 = FUN_00042f28(param_1);
        dVar8 = ldexp(1.0, (uint) * (byte *)(param_1 + 0x40));
        bVar1 = *(byte *)(param_1 + 0x5d);
        if (sys_maxdist + dVar8 * clock_phi <=
            (double)CONCAT44(extraout_s1, uVar7)) {
            uVar5 = uVar5 | 0x400;
        }
    } else {
        bVar1 = *(byte *)(param_1 + 0x5d);
    }
    if (1 < bVar1) {
        iVar3 = *(int *)(param_1 + 0x38);
        if ((iVar3 == 0) || ((*(uint *)(iVar3 + 0x90) & 0x100) != 0)) {
            iVar3 = FUN_000278f8(param_1 + 0x10);
            if ((iVar3 != 0) &&
                (*(int *)(param_1 + 0x70) == *(int *)(iVar3 + 0x98))) {
                uVar5 = uVar5 | 0x800;
            }
        } else if (*(int *)(param_1 + 0x70) == *(int *)(iVar3 + 0x98)) {
            uVar5 = uVar5 | 0x800;
        }
    }
    if ((*(char *)(param_1 + 0x12a) == '\0') ||
        ((*(uint *)(param_1 + 0x44) & 0x200) != 0)) {
        uVar5 = uVar5 | 0x1000;
    }
    bVar6 = iVar2 == __stack_chk_guard;
    *(uint *)(param_1 + 300) = *(uint *)(param_1 + 300) & 0xffffe1ff | uVar5;
    if (bVar6) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar5);
}

void pool_name_resolved(int param_1, undefined4 param_2, undefined2 param_3,
                        undefined4 param_4, undefined4 param_5,
                        undefined4 param_6, undefined4 param_7)

{
    undefined4 uVar1;
    void *pvVar2;
    int iVar3;
    undefined4 uVar4;
    char *pcVar5;
    int iVar6;
    undefined4 unaff_r7;
    uint uVar7;
    ushort auStack_898[2];
    uint uStack_894;
    uint uStack_890;
    undefined4 uStack_88c;
    undefined4 uStack_888;
    byte bStack_874;
    char cStack_873;
    undefined1 uStack_872;
    undefined1 uStack_871;
    uint uStack_870;
    uint uStack_86c;
    undefined4 uStack_868;
    uint uStack_864;
    uint uStack_860;
    uint uStack_84c;
    uint uStack_848;
    int iStack_2c;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_1 == 0) {
        iVar3 = FUN_00041c78(param_3);
        if (iVar3 == 0) {
            if (local_1c == __stack_chk_guard) {
                FUN_00074e00(3, "Could not find assoc %u for pool DNS %s",
                             param_3, param_4);
                return;
            }
        } else {
            uVar4 = FUN_00078ebc(param_7);
            iVar6 = __stack_chk_guard;
            *(undefined4 *)(iVar3 + 0x30) = uVar4;
            *(undefined4 *)(iVar3 + 0x34) = uVar4;
            if (local_1c == iVar6) {
                iVar6 = *(int *)(iVar3 + 0x34);
                if (iVar6 != 0) {
                    unaff_r7 = 0;
                }
                iStack_2c = __stack_chk_guard;
                if (iVar6 != 0) {
                    do {
                        uVar4 = *(undefined4 *)(iVar6 + 0x14);
                        *(undefined4 *)(iVar3 + 0x34) =
                            *(undefined4 *)(iVar6 + 0x1c);
                        iVar6 =
                            FUN_00041a44(uVar4, 0, 0, 3, unaff_r7, unaff_r7);
                        if (iVar6 == 0) {
                            FUN_00050054(uVar4, auStack_898);
                            if ((auStack_898[0] & 0x7f) != 0) {
                                FUN_00050824(uVar4, 0, current_time + 9);
                            }
                            uVar1 = FUN_000278f8(uVar4);
                            memset(&bStack_874, 0, 0x848);
                            uStack_872 = *(undefined1 *)(iVar3 + 0x40);
                            bStack_874 = (*(byte *)(iVar3 + 0x3e) & 7) << 3 |
                                         sys_leap << 6 | 3;
                            cStack_873 = sys_stratum;
                            if (sys_stratum == '\x10') {
                                cStack_873 = '\0';
                            }
                            uStack_871 = sys_precision;
                            uStack_868 = sys_refid;
                            uVar7 = (uint)(longlong)(sys_rootdelay * 65536.0);
                            uStack_870 =
                                uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                                (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
                            uVar7 = (uint)(0.0 < sys_rootdisp * 65536.0) *
                                    (int)(longlong)(sys_rootdisp * 65536.0);
                            uStack_86c = uVar7 * 0x1000000 |
                                         (uVar7 >> 8 & 0xff) << 0x10 |
                                         (uVar7 >> 0x10 & 0xff) << 8 |
                                         uVar7 >> 0x18;
                            uStack_864 =
                                (uint)sys_reftime << 0x18 |
                                ((uint)sys_reftime >> 8 & 0xff) << 0x10 |
                                ((uint)sys_reftime >> 0x10 & 0xff) << 8 |
                                (uint)sys_reftime >> 0x18;
                            uStack_860 =
                                sys_reftime._4_4_ << 0x18 |
                                (sys_reftime._4_4_ >> 8 & 0xff) << 0x10 |
                                (sys_reftime._4_4_ >> 0x10 & 0xff) << 8 |
                                sys_reftime._4_4_ >> 0x18;
                            FUN_0006f724(&uStack_894);
                            uStack_84c = uStack_894 << 0x18 |
                                         (uStack_894 >> 8 & 0xff) << 0x10 |
                                         (uStack_894 >> 0x10 & 0xff) << 8 |
                                         uStack_894 >> 0x18;
                            uStack_848 = uStack_890 << 0x18 |
                                         (uStack_890 >> 8 & 0xff) << 0x10 |
                                         (uStack_890 >> 0x10 & 0xff) << 8 |
                                         uStack_890 >> 0x18;
                            *(uint *)(iVar3 + 0x248) = uStack_894;
                            *(uint *)(iVar3 + 0x24c) = uStack_890;
                            uVar7 = *(uint *)(iVar3 + 0x4c);
                            if (sys_ttlmax <= *(uint *)(iVar3 + 0x4c)) {
                                uVar7 = sys_ttlmax;
                            }
                            FUN_00026a68(uVar4, uVar1,
                                         *(undefined1 *)((int)&sys_ttl + uVar7),
                                         &bStack_874, 0x30);
                            *(int *)(iVar3 + 0x2e4) =
                                *(int *)(iVar3 + 0x2e4) + 1;
                            *(int *)(iVar3 + 0x2c8) =
                                *(int *)(iVar3 + 0x2c8) +
                                (1 << *(sbyte *)(iVar3 + 0x41)) + -2;
                            uVar4 = FUN_0007c2e8(uVar4);
                            FUN_00074e00(6, "Soliciting pool server %s", uVar4);
                            break;
                        }
                        iVar6 = *(int *)(iVar3 + 0x34);
                    } while (iVar6 != 0);
                } else {
                    if (*(void **)(iVar3 + 0x30) != (void *)0x0) {
                        free(*(void **)(iVar3 + 0x30));
                        *(undefined4 *)(iVar3 + 0x30) = 0;
                    }
                    pvVar2 = memset(&uStack_894, 0, 0x20);
                    uStack_890 = (uint) * (ushort *)(iVar3 + 0x10);
                    uStack_888 = 0x11;
                    uStack_88c = 2;
                    iVar6 = FUN_00078520(
                        *(undefined4 *)(iVar3 + 0x2c), &DAT_0009ce60, pvVar2, 0,
                        pool_name_resolved, *(undefined2 *)(iVar3 + 0x3c));
                    if (iVar6 != 0) {
                        FUN_00074e00(3, "unable to start pool DNS %s: %m",
                                     *(undefined4 *)(iVar3 + 0x2c));
                    }
                }
                if (iStack_2c == __stack_chk_guard) {
                    return;
                }
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
        }
    } else {
        pcVar5 = gai_strerror(param_1);
        if (local_1c == __stack_chk_guard) {
            FUN_00074e00(3, "error resolving pool %s: %s (%d)", param_4,
                         pcVar5);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00043614) */

void FUN_000435a4(int param_1)

{
    xmt_leap = (undefined1)param_1;
    sys_leap = xmt_leap;
    if ((param_1 != 3) && (leap_sec_in_progress != 0)) {
        xmt_leap = 3;
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x000436e0) */

void FUN_0004362c(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x000437d8) */

void FUN_000436ec(void)

{
    return;
}

void FUN_000437e4(undefined4 param_1)

{
    int iVar1;
    char *__s;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    switch (param_1) {
    case 0:
        __s = "AM_NOMATCH";
        break;
    case 1:
        __s = "AM_PROCPKT";
        break;
    case 2:
        __s = "AM_BCST";
        break;
    case 3:
        __s = "AM_FXMIT";
        break;
    case 4:
        __s = "AM_MANYCAST";
        break;
    case 5:
        __s = "AM_NEWPASS";
        break;
    case 6:
        __s = "AM_NEWBCL";
        break;
    case 7:
        __s = "AM_POSSBCL";
        break;
    case 0xffffffff:
        __s = "AM_ERR";
        break;
    default:
        __s = lib_stringbuf + lib_nextbuf * 0x80;
        uVar2 = lib_nextbuf + 1;
        memset(__s, 0, 0x80);
        lib_nextbuf = uVar2 & 0xf;
        FUN_0007c054(__s, 0x80, "AM_#%d", param_1);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_0004394c(int param_1)

{
    int iVar1;
    void *__ptr;
    int iVar2;

    iVar1 = __stack_chk_guard;
    __ptr = *(void **)(param_1 + 0xf0);
    if (__ptr != (void *)0x0) {
        if (-1 < *(int *)(param_1 + 0xf4)) {
            iVar2 = 0;
            do {
                FUN_000721bc(*(undefined4 *)((int)__ptr + iVar2 * 4), 0);
                iVar2 = iVar2 + 1;
                __ptr = *(void **)(param_1 + 0xf0);
            } while (iVar2 <= *(int *)(param_1 + 0xf4));
        }
        free(__ptr);
        *(undefined4 *)(param_1 + 0xf0) = 0;
    }
    FUN_00037b48(param_1 + 0x110);
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(param_1 + 0xf4) = 0;
    *(uint *)(param_1 + 0x44) = *(uint *)(param_1 + 0x44) & 0xffff7fff;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000439f8(int param_1)

{
    undefined1 uVar1;
    uint uVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    int *piVar5;
    int iVar6;
    uint uVar7;
    uint uVar8;
    uint *puVar9;
    double dVar10;
    uint local_884;
    uint local_880;
    int local_87c;
    uint local_878;
    byte local_874;
    char local_873;
    undefined1 local_872;
    undefined1 local_871;
    uint local_870;
    uint local_86c;
    undefined4 local_868;
    uint local_864;
    uint local_860;
    uint local_85c;
    uint uStack_858;
    uint local_854;
    uint local_850;
    uint local_84c;
    uint local_848;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (*(int *)(param_1 + 0x38) == 0)
        goto LAB_00043c9c;
    uVar2 = *(uint *)(param_1 + 0x230);
    local_874 = *(byte *)(param_1 + 0x3f) & 7 | sys_leap << 6 |
                (*(byte *)(param_1 + 0x3e) & 7) << 3;
    local_872 = *(undefined1 *)(param_1 + 0x40);
    local_85c = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
    local_873 = sys_stratum;
    if (sys_stratum == '\x10') {
        local_873 = '\0';
    }
    local_871 = sys_precision;
    uVar2 = *(uint *)(param_1 + 0x234);
    local_868 = sys_refid;
    uStack_858 = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                 (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
    uVar2 = *(uint *)(param_1 + 0x240);
    local_854 = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
    uVar2 = (uint)(longlong)(sys_rootdelay * 65536.0);
    local_870 = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
    uVar2 = (uint)(0.0 < sys_rootdisp * 65536.0) *
            (int)(longlong)(sys_rootdisp * 65536.0);
    local_86c = uVar2 * 0x1000000 | (uVar2 >> 8 & 0xff) << 0x10 |
                (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
    local_860 =
        sys_reftime._4_4_ << 0x18 | (sys_reftime._4_4_ >> 8 & 0xff) << 0x10 |
        (sys_reftime._4_4_ >> 0x10 & 0xff) << 8 | sys_reftime._4_4_ >> 0x18;
    local_864 =
        (uint)sys_reftime << 0x18 | ((uint)sys_reftime >> 8 & 0xff) << 0x10 |
        ((uint)sys_reftime >> 0x10 & 0xff) << 8 | (uint)sys_reftime >> 0x18;
    uVar2 = *(uint *)(param_1 + 0x244);
    local_850 = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
    if ((*(uint *)(param_1 + 0x44) & 0x800) == 0) {
        if (*(int *)(param_1 + 0x7c) != 0)
            goto LAB_00043b3c;
        FUN_0006f724(&local_884);
        iVar6 = *(int *)(param_1 + 0x13c);
        if (iVar6 == 0) {
            local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                        (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
            local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                        (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
            *(uint *)(param_1 + 0x248) = local_884;
            *(uint *)(param_1 + 0x24c) = local_880;
        } else if (*(char *)(param_1 + 0x3f) == '\x05') {
            local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                        (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
            local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                        (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
            if (iVar6 < 1) {
                uVar2 = *(uint *)(param_1 + 0x248);
                uVar8 = *(uint *)(param_1 + 0x24c);
            } else {
                uVar2 = *(uint *)(param_1 + 0x250);
                uVar8 = *(uint *)(param_1 + 0x254);
            }
            local_85c = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                        (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
            uStack_858 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                         (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
        } else {
            if (iVar6 < 1) {
                uVar2 = *(uint *)(param_1 + 0x248);
                uVar8 = *(uint *)(param_1 + 0x24c);
            } else {
                uVar2 = *(uint *)(param_1 + 0x250);
                uVar8 = *(uint *)(param_1 + 0x254);
            }
            local_84c = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                        (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
            local_848 = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                        (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
        }
        *(undefined4 *)(param_1 + 0x298) = 0x30;
        uVar2 = 0x30;
        uVar8 = *(uint *)(param_1 + 0x4c);
        if (sys_ttlmax <= *(uint *)(param_1 + 0x4c)) {
            uVar8 = sys_ttlmax;
        }
        uVar3 = *(undefined4 *)(param_1 + 0x38);
        uVar1 = *(undefined1 *)((int)&sys_ttl + uVar8);
        goto LAB_00043bf4;
    }
    while (true) {
        if (*(int *)(param_1 + 0xf4) == 0) {
            FUN_00037454(param_1, *(undefined4 *)(param_1 + 0x38));
            iVar6 = *(int *)(param_1 + 0xf4);
        } else {
            iVar6 = *(int *)(param_1 + 0xf4) + -1;
            *(int *)(param_1 + 0xf4) = iVar6;
        }
        uVar3 = *(undefined4 *)(*(int *)(param_1 + 0xf0) + iVar6 * 4);
        iVar6 = FUN_000722e0(uVar3);
        if (iVar6 != 0)
            break;
        FUN_0004394c(param_1);
    }
    *(undefined4 *)(param_1 + 0x7c) = uVar3;
    switch (*(undefined1 *)(param_1 + 0x3f)) {
    case 1:
        goto LAB_00043ee8;
    case 2:
    LAB_00043ee8:
        uVar2 = *(uint *)(param_1 + 0x88);
        if (uVar2 == 0) {
        LAB_00044130:
            uVar4 = 0x2010000;
        LAB_0004413c:
            piVar5 = (int *)FUN_0003787c(param_1, uVar4,
                                         *(undefined2 *)(param_1 + 0x3c),
                                         hostval._12_4_);
        } else if ((uVar2 & 0x100) == 0) {
        LAB_00044190:
            piVar5 = (int *)FUN_0003787c(param_1, 0x2020000,
                                         *(undefined2 *)(param_1 + 0x3c),
                                         *(undefined4 *)(param_1 + 0x98));
        } else if ((uVar2 & 0x200) == 0) {
        LAB_000441b0:
            uVar4 = FUN_00037774(param_1);
            piVar5 = (int *)FUN_0003787c(param_1, uVar4,
                                         *(undefined2 *)(param_1 + 0x3c), 0);
        } else if (((sys_leap == '\x03') ||
                    (*(char *)(param_1 + 0x5b) == '\x03')) ||
                   ((uVar2 & 0x800) != 0)) {
            if ((uVar2 & 0x1000) != 0) {
                if ((*(uint *)(param_1 + 0x44) & 0x8000) == 0) {
                    if (sys_leap != '\x03') {
                    LAB_00043eb8:
                        if ((uVar2 & 0x2000) == 0)
                            goto LAB_00043f48;
                        if ((uVar2 & 0x4000) == 0) {
                            piVar5 = (int *)FUN_0003787c(
                                param_1, 0x2050000,
                                *(undefined2 *)(param_1 + 0x3c), 0);
                            goto LAB_00043de8;
                        }
                    }
                } else {
                    if ((uVar2 & 0x2000) != 0) {
                        piVar5 = (int *)FUN_0003787c(
                            param_1, 0x82040000,
                            *(undefined2 *)(param_1 + 0x84), 0);
                        goto LAB_00043de8;
                    }
                    if (sys_leap != '\x03') {
                    LAB_00043f48:
                        uVar4 = 0x2060000;
                        goto LAB_0004413c;
                    }
                }
                goto switchD_00043d40_default;
            }
            piVar5 = (int *)FUN_0003787c(param_1, 0x2040000,
                                         *(undefined2 *)(param_1 + 0x3c));
        } else {
        LAB_000441d4:
            piVar5 = (int *)FUN_0003787c(param_1, 0x2030000,
                                         *(undefined2 *)(param_1 + 0x3c), 0);
        }
    LAB_00043de8:
        puVar9 = *(uint **)(param_1 + 0xe8);
        if (puVar9 != (uint *)0x0) {
            *puVar9 = *puVar9 | 0x80;
            iVar6 = FUN_00039774(param_1, &local_874, 0, 0x30, puVar9, 0);
            uVar2 = iVar6 + 0x30;
            free(*(void **)(param_1 + 0xe8));
            *(undefined4 *)(param_1 + 0xe8) = 0;
            if (piVar5 != (int *)0x0) {
                if (*piVar5 != 0) {
                LAB_000440e0:
                    iVar6 =
                        FUN_00039774(param_1, &local_874, 0, uVar2, piVar5, 0);
                    uVar2 = uVar2 + iVar6;
                }
                free(piVar5);
            }
            goto LAB_00043e54;
        }
        if (piVar5 == (int *)0x0)
            goto LAB_00043b3c;
        if (*piVar5 != 0) {
            uVar2 = 0x30;
            goto LAB_000440e0;
        }
        uVar2 = 0x30;
        free(piVar5);
        break;
    case 3:
        uVar2 = *(uint *)(param_1 + 0x88);
        if (uVar2 == 0)
            goto LAB_00044130;
        if ((uVar2 & 0x100) == 0)
            goto LAB_00044190;
        if ((uVar2 & 0x200) == 0)
            goto LAB_000441b0;
        if ((uVar2 & 0x800) == 0)
            goto LAB_000441d4;
        if ((uVar2 & 0x1000) == 0) {
            piVar5 = (int *)FUN_0003787c(param_1, 0x2040000,
                                         *(undefined2 *)(param_1 + 0x84));
            goto LAB_00043de8;
        }
        if (sys_leap == '\x03')
            goto switchD_00043d40_default;
        goto LAB_00043eb8;
    case 4:
    default:
    switchD_00043d40_default:
        puVar9 = *(uint **)(param_1 + 0xe8);
        if (puVar9 == (uint *)0x0) {
        LAB_00043b3c:
            uVar2 = 0x30;
        } else {
            *puVar9 = *puVar9 | 0x80;
            iVar6 = FUN_00039774(param_1, &local_874, 0, 0x30, puVar9, 0);
            uVar2 = iVar6 + 0x30;
            free(*(void **)(param_1 + 0xe8));
            *(undefined4 *)(param_1 + 0xe8) = 0;
        LAB_00043e54:
            if (0x30 < uVar2) {
                FUN_000372c8(*(int *)(param_1 + 0x38) + 0x18, param_1 + 0x10,
                             uVar3, 0, 2);
            }
        }
        break;
    case 5:
        if ((*(uint *)(param_1 + 0x44) & 0x8000) == 0) {
            uVar4 = 0x82010000;
        } else {
            uVar4 = 0x82040000;
        }
        piVar5 = (int *)FUN_0003787c(param_1, uVar4,
                                     *(undefined2 *)(param_1 + 0x3c), 0);
        goto LAB_00043de8;
    }
    FUN_0006f724(&local_884);
    iVar6 = *(int *)(param_1 + 0x13c);
    if (iVar6 == 0) {
        local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                    (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
        local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                    (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
        *(uint *)(param_1 + 0x248) = local_884;
        *(uint *)(param_1 + 0x24c) = local_880;
    } else if (*(char *)(param_1 + 0x3f) == '\x05') {
        local_84c = local_884 << 0x18 | (local_884 >> 8 & 0xff) << 0x10 |
                    (local_884 >> 0x10 & 0xff) << 8 | local_884 >> 0x18;
        local_848 = local_880 << 0x18 | (local_880 >> 8 & 0xff) << 0x10 |
                    (local_880 >> 0x10 & 0xff) << 8 | local_880 >> 0x18;
        if (iVar6 < 1) {
            uVar8 = *(uint *)(param_1 + 0x248);
            uVar7 = *(uint *)(param_1 + 0x24c);
        } else {
            uVar8 = *(uint *)(param_1 + 0x250);
            uVar7 = *(uint *)(param_1 + 0x254);
        }
        local_85c = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                    (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
        uStack_858 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                     (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
    } else {
        if (iVar6 < 1) {
            uVar8 = *(uint *)(param_1 + 0x248);
            uVar7 = *(uint *)(param_1 + 0x24c);
        } else {
            uVar8 = *(uint *)(param_1 + 0x250);
            uVar7 = *(uint *)(param_1 + 0x254);
        }
        local_84c = uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10 |
                    (uVar8 >> 0x10 & 0xff) << 8 | uVar8 >> 0x18;
        local_848 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                    (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18;
    }
    uVar8 = *(uint *)(param_1 + 0x7c);
    iVar6 = FUN_0007278c(uVar8, &local_874, uVar2);
    if (iVar6 == 0) {
        FUN_00035ee0(0x8c, param_1, "no key");
        *(uint *)(param_1 + 300) = *(uint *)(param_1 + 300) | 0x10;
        *(int *)(param_1 + 0x2f0) = *(int *)(param_1 + 0x2f0) + 1;
    } else {
        uVar2 = uVar2 + iVar6;
        if (0xffff < uVar8) {
            FUN_000721bc(uVar8, 0);
        }
        if (0x848 < uVar2) {
            FUN_00074e00(3, "peer_xmit: buffer overflow %zu", uVar2);
            /* WARNING: Subroutine does not return */
            exit(-1);
        }
        *(uint *)(param_1 + 0x298) = uVar2;
        uVar3 = *(undefined4 *)(param_1 + 0x38);
        uVar8 = *(uint *)(param_1 + 0x4c);
        if (sys_ttlmax <= *(uint *)(param_1 + 0x4c)) {
            uVar8 = sys_ttlmax;
        }
        uVar1 = *(undefined1 *)((int)&sys_ttl + uVar8);
    LAB_00043bf4:
        FUN_00026a68(param_1 + 0x10, uVar3, uVar1, &local_874, uVar2);
        *(int *)(param_1 + 0x2e4) = *(int *)(param_1 + 0x2e4) + 1;
        *(int *)(param_1 + 0x2c8) =
            *(int *)(param_1 + 0x2c8) + (1 << *(sbyte *)(param_1 + 0x41)) + -2;
        FUN_0006f724(&local_87c);
        iVar6 = *(int *)(param_1 + 0x13c);
        if (iVar6 != 0) {
            if (iVar6 < 1) {
                piVar5 = (int *)(param_1 + 0x250);
            } else {
                piVar5 = (int *)(param_1 + 0x248);
            }
            *piVar5 = local_87c;
            piVar5[1] = local_878;
            *(int *)(param_1 + 0x13c) = -iVar6;
        }
        local_87c = local_87c - local_884;
        if (local_878 < local_880) {
            local_87c = local_87c + -1;
        }
        local_878 = local_878 - local_880;
        if (local_87c < 0) {
            dVar10 = (double)FUN_0009bec4(
                -local_878, -(local_87c + (uint)(local_878 != 0)));
            dVar10 = ldexp(dVar10, -0x20);
            dVar10 = -dVar10;
        } else {
            dVar10 = (double)FUN_0009bec4(local_878, local_87c);
            dVar10 = ldexp(dVar10, -0x20);
        }
        *(double *)(param_1 + 0x280) = dVar10;
    }
LAB_00043c9c:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00044264(int param_1, uint param_2)

{
    int iVar1;
    uint uVar2;
    int iVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;
    int iVar7;

    iVar1 = __stack_chk_guard;
    uVar2 = (uint) * (byte *)(param_1 + 0x41);
    if (*(byte *)(param_1 + 0x42) < param_2) {
        param_2 = (uint) * (byte *)(param_1 + 0x42);
    }
    uVar4 = uVar2;
    if ((int)uVar2 < (int)param_2) {
        uVar4 = param_2;
    }
    if (((*(uint *)(param_1 + 0x44) & 0x800) != 0) &&
        (*(byte *)(param_1 + 0x40) != uVar4)) {
        FUN_0004394c();
        uVar2 = (uint) * (byte *)(param_1 + 0x41);
    }
    *(char *)(param_1 + 0x40) = (char)uVar4;
    iVar7 = *(int *)(param_1 + 0x2c8);
    iVar3 = iVar7 - (7 << uVar2);
    if (iVar3 < ntp_minpkt) {
        iVar3 = ntp_minpkt;
    }
    uVar6 = current_time + iVar3;
    if (*(int *)(param_1 + 0x134) < 1) {
        if (*(int *)(param_1 + 0xe8) == 0) {
            uVar5 = uVar2;
            if ((*(int *)(param_1 + 0x138) < 1) &&
                (uVar5 = uVar4, *(byte *)(param_1 + 0x5e) < uVar4)) {
                uVar5 = (uint) * (byte *)(param_1 + 0x5e);
            }
            if ((*(uint *)(param_1 + 0x44) & 8) == 0) {
                uVar4 = FUN_00078ae4();
                iVar7 = *(int *)(param_1 + 0x2c8);
                uVar2 = (uint) * (byte *)(param_1 + 0x41);
                uVar4 = ((uVar4 & 0xff | 0x1000) << (uVar5 & 0xff)) >> 0xc;
            } else {
                uVar4 = 1 << (uVar5 & 0xff);
            }
            uVar4 = uVar4 + *(int *)(param_1 + 0x2cc);
            if (uVar4 < uVar6) {
                uVar4 = uVar6;
            }
            *(uint *)(param_1 + 0x2d0) = uVar4;
            if (1 << uVar2 < iVar7) {
                *(uint *)(param_1 + 0x2d0) = uVar4 + ntp_minpkt;
            }
            goto LAB_0004431c;
        }
        if ((current_time < *(uint *)(param_1 + 0x2d0)) &&
            (ntp_minpkt + *(uint *)(param_1 + 0x2d0) == uVar6))
            goto LAB_0004431c;
    } else {
        if (current_time < *(uint *)(param_1 + 0x2d0))
            goto LAB_0004431c;
        if ((*(uint *)(param_1 + 0x44) & 8) != 0) {
            *(uint *)(param_1 + 0x2d0) = current_time + 1;
            goto LAB_0004431c;
        }
    }
    *(uint *)(param_1 + 0x2d0) = uVar6;
LAB_0004431c:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000443fc(void)

{
    byte bVar1;
    bool bVar2;
    bool bVar3;
    int iVar4;
    uint uVar5;
    int iVar6;
    byte bVar7;
    int iVar8;
    double *pdVar9;
    int *piVar10;
    uint uVar11;
    double *pdVar12;
    int iVar13;
    int iVar14;
    int *piVar15;
    int iVar16;
    int iVar17;
    int iVar18;
    int *piVar19;
    int *piVar20;
    int iVar21;
    bool bVar22;
    undefined4 uVar23;
    undefined4 extraout_s1;
    undefined8 uVar24;
    double dVar25;
    double dVar26;
    double dVar27;
    double dVar28;
    double dVar29;
    int local_9c;
    int *local_90;
    int *local_84;
    int *local_78;
    undefined4 local_6c[2];
    int local_64;

    iVar6 = sys_peer;
    local_64 = __stack_chk_guard;
    sys_survivors = 0;
    if (peer_list == (int *)0x0) {
        iVar8 = 0x48;
        DAT_000cc6e0 = 0x20;
    } else {
        iVar8 = 1;
        piVar10 = peer_list;
        do {
            piVar10 = (int *)*piVar10;
            iVar8 = iVar8 + 1;
        } while (piVar10 != (int *)0x0);
        DAT_000cc6e0 = iVar8 * 0x20;
        iVar8 = iVar8 * 0x48;
    }
    DAT_000cc6e4 = DAT_000cc6e0;
    DAT_000cc6e8 = FUN_00073ba4(DAT_000cc6e8, iVar8, 0);
    if (DAT_000cc6e0 == 0) {
        uVar11 = 8;
    } else {
        uVar11 = DAT_000cc6e0 + 7U & 0xfffffff8;
    }
    piVar10 = (int *)(DAT_000cc6e8 + uVar11);
    if (DAT_000cc6e4 == 0) {
        uVar11 = 8;
    } else {
        uVar11 = DAT_000cc6e4 + 7U & 0xfffffff8;
    }
    DAT_000cc6f0 = (int *)((int)piVar10 + uVar11);
    DAT_000cc6ec = piVar10;
    if (peer_list == (int *)0x0) {
        piVar10[4] = 0;
        piVar10[5] = 0;
        iVar8 = sys_mindisp._4_4_;
        piVar10[2] = (int)sys_mindisp;
        piVar10[3] = iVar8;
        iVar8 = 0;
        iVar14 = 0;
    } else {
        dVar29 = 8589934590.0;
        iVar14 = 0;
        iVar18 = 0;
        local_78 = (int *)0x0;
        local_90 = (int *)0x0;
        local_84 = (int *)0x0;
        piVar10 = peer_list;
        do {
            *(undefined1 *)((int)piVar10 + 0x129) = 0;
            iVar8 = FUN_00042fe4(piVar10);
            if (iVar8 == 0) {
                if (*(byte *)((int)piVar10 + 0x5d) == sys_orphan) {
                    if (piVar10[0xe] == 0) {
                        uVar11 = 0xffffffff;
                    } else {
                        uVar11 = *(uint *)(piVar10[0xe] + 0x98);
                        uVar11 = uVar11 << 0x18 | (uVar11 >> 8 & 0xff) << 0x10 |
                                 (uVar11 >> 0x10 & 0xff) << 8 | uVar11 >> 0x18;
                    }
                    uVar5 = FUN_0007083c(piVar10 + 4);
                    uVar5 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                            (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                    if ((uVar5 < uVar11) &&
                        (dVar25 = (double)uVar5, dVar25 < dVar29)) {
                        dVar29 = dVar25;
                        local_84 = piVar10;
                    }
                } else if ((int)(uint) * (byte *)((int)piVar10 + 0x5d) <=
                           (int)sys_orphan) {
                    if ((piVar10[0x11] & 0x20U) == 0) {
                        if ((char)piVar10[0x16] == '\x01') {
                            if (local_78 == (int *)0x0 &&
                                orphwait < current_time) {
                                local_78 = piVar10;
                            }
                        } else {
                            if ((char)piVar10[0x16] != '\x12')
                                goto LAB_0004457c;
                            if (local_90 == (int *)0x0 &&
                                orphwait < current_time) {
                                local_90 = piVar10;
                            }
                        }
                    } else {
                    LAB_0004457c:
                        *(undefined1 *)((int)piVar10 + 0x129) = 1;
                        uVar23 = FUN_00042f28(piVar10);
                        piVar19 = DAT_000cc6ec;
                        iVar4 = DAT_000cc6e8;
                        dVar25 = (double)CONCAT44(extraout_s1, uVar23);
                        dVar27 = *(double *)(piVar10 + 0x98);
                        iVar8 = iVar14 * 0x10;
                        iVar14 = iVar14 + 2;
                        uVar24 = *(undefined8 *)(piVar10 + 0x9c);
                        pdVar9 = (double *)(DAT_000cc6e8 + iVar8);
                        DAT_000cc6ec[iVar18 * 8] = (int)piVar10;
                        pdVar12 = (double *)(iVar4 + iVar8 + 0x10);
                        *(undefined8 *)(piVar19 + iVar18 * 8 + 4) = uVar24;
                        *(double *)(piVar19 + iVar18 * 8 + 2) = dVar25;
                        *pdVar9 = dVar27 - dVar25;
                        *(undefined4 *)(pdVar9 + 1) = 0xffffffff;
                        *pdVar12 = dVar25 + dVar27;
                        *(undefined4 *)(pdVar12 + 1) = 1;
                        iVar18 = iVar18 + 1;
                    }
                }
            }
            piVar20 = DAT_000cc6f0;
            piVar19 = DAT_000cc6ec;
            piVar10 = (int *)*piVar10;
        } while (piVar10 != (int *)0x0);
        if (iVar14 != 0) {
            piVar15 = DAT_000cc6f0 + -1;
            iVar8 = 0;
            piVar10 = piVar15;
            do {
                piVar10 = piVar10 + 1;
                *piVar10 = iVar8;
                iVar4 = DAT_000cc6e8;
                iVar8 = iVar8 + 1;
            } while (iVar14 != iVar8);
            iVar8 = 0;
            do {
                do {
                    piVar15 = piVar15 + 1;
                    iVar21 = iVar8 + 1;
                    dVar29 = *(double *)(iVar4 + *piVar15 * 0x10);
                    piVar10 = piVar15;
                    iVar16 = iVar8;
                    iVar13 = iVar21;
                    if (iVar14 <= iVar21)
                        goto LAB_000446a4;
                    do {
                        dVar25 = *(double *)(iVar4 + piVar10[1] * 0x10);
                        if (dVar25 < dVar29) {
                            iVar16 = iVar13;
                        }
                        iVar13 = iVar13 + 1;
                        if (dVar25 < dVar29) {
                            dVar29 = dVar25;
                        }
                        piVar10 = piVar10 + 1;
                    } while (iVar14 != iVar13);
                    bVar22 = iVar16 == iVar8;
                    iVar8 = iVar21;
                } while (bVar22);
                iVar13 = piVar20[iVar16];
                piVar20[iVar16] = *piVar15;
                *piVar15 = iVar13;
            } while (iVar21 < iVar14);
        }
    LAB_000446a4:
        iVar8 = 0;
        if (iVar18 != 0) {
            iVar16 = iVar14 + -1;
            dVar25 = 1000000000.0;
            dVar29 = -1000000000.0;
            iVar4 = iVar18;
            do {
                if (iVar14 != 0) {
                    pdVar9 = (double *)(DAT_000cc6e8 + *DAT_000cc6f0 * 0x10);
                    iVar21 = *(int *)(pdVar9 + 1);
                    dVar25 = *pdVar9;
                    iVar13 = -iVar21;
                    if (iVar4 != iVar13 &&
                        iVar4 + iVar21 < 0 == SBORROW4(iVar4, iVar13)) {
                        iVar21 = 0;
                        piVar10 = DAT_000cc6f0;
                        do {
                            iVar21 = iVar21 + 1;
                            if (iVar14 == iVar21)
                                break;
                            piVar10 = piVar10 + 1;
                            pdVar9 = (double *)(DAT_000cc6e8 + *piVar10 * 0x10);
                            dVar25 = *pdVar9;
                            iVar13 = iVar13 - *(int *)(pdVar9 + 1);
                        } while (iVar13 < iVar4);
                    }
                }
                if (iVar16 != -1) {
                    pdVar9 =
                        (double *)(DAT_000cc6e8 + DAT_000cc6f0[iVar16] * 0x10);
                    iVar21 = *(int *)(pdVar9 + 1);
                    dVar29 = *pdVar9;
                    iVar13 = iVar16;
                    piVar10 = DAT_000cc6f0 + iVar14 + 0x3fffffff;
                    while ((iVar21 < iVar4 && (bVar22 = iVar13 != 0,
                                               iVar13 = iVar13 + -1, bVar22))) {
                        piVar10 = piVar10 + -1;
                        pdVar9 = (double *)(DAT_000cc6e8 + *piVar10 * 0x10);
                        dVar29 = *pdVar9;
                        iVar21 = iVar21 + *(int *)(pdVar9 + 1);
                    }
                }
            } while ((dVar29 <= dVar25) &&
                     (iVar4 = iVar4 + -1,
                      (iVar18 - 1U) - (iVar18 - 1U >> 1) != iVar4));
            iVar14 = 0;
            iVar4 = 0;
            pdVar9 = (double *)(piVar19 + 2);
            do {
                while (true) {
                    iVar16 = *(int *)(pdVar9 + -1);
                    uVar11 = *(uint *)(iVar16 + 0x44);
                    if (dVar29 <= dVar25)
                        break;
                    if ((*(double *)(iVar16 + 0x260) + *pdVar9 < dVar25) ||
                        (dVar29 < *(double *)(iVar16 + 0x260) - *pdVar9))
                        break;
                LAB_00044848:
                    if ((uVar11 & 0x80) == 0) {
                    LAB_00044860:
                        if (iVar14 != iVar4) {
                            piVar10 = piVar19 + iVar14 * 8;
                            iVar16 = *(int *)((int)pdVar9 + -4);
                            iVar13 = *(int *)pdVar9;
                            iVar21 = *(int *)((int)pdVar9 + 4);
                            *piVar10 = *(int *)(pdVar9 + -1);
                            piVar10[1] = iVar16;
                            piVar10[2] = iVar13;
                            piVar10[3] = iVar21;
                            iVar16 = *(int *)((int)pdVar9 + 0xc);
                            iVar13 = *(int *)(pdVar9 + 2);
                            iVar21 = *(int *)((int)pdVar9 + 0x14);
                            piVar10[4] = *(int *)(pdVar9 + 1);
                            piVar10[5] = iVar16;
                            piVar10[6] = iVar13;
                            piVar10[7] = iVar21;
                        }
                        iVar14 = iVar14 + 1;
                    } else {
                        if (iVar8 == 0) {
                            iVar8 = iVar16;
                        }
                        if ((uVar11 & 0x10000) != 0)
                            goto LAB_00044860;
                    }
                    iVar4 = iVar4 + 1;
                    pdVar9 = pdVar9 + 4;
                    if (iVar18 == iVar4)
                        goto LAB_000448c0;
                }
                if ((uVar11 & 0x400) != 0)
                    goto LAB_00044848;
                iVar4 = iVar4 + 1;
                pdVar9 = pdVar9 + 4;
            } while (iVar18 != iVar4);
        LAB_000448c0:
            if (iVar14 != 0) {
                iVar18 = 0;
                do {
                    iVar4 = iVar18 * 8;
                    iVar18 = iVar18 + 1;
                    *(undefined1 *)(piVar19[iVar4] + 0x129) = 3;
                } while (iVar14 != iVar18);
                goto LAB_00044908;
            }
        }
        piVar19[4] = 0;
        piVar19[5] = 0;
        iVar18 = sys_mindisp._4_4_;
        iVar14 = (int)sys_mindisp;
        if (local_90 != (int *)0x0) {
            *piVar19 = (int)local_90;
        }
        piVar19[2] = iVar14;
        piVar19[3] = iVar18;
        if (local_90 == (int *)0x0) {
            if ((local_78 == (int *)0x0) &&
                (local_78 = local_84, local_84 == (int *)0x0)) {
                iVar14 = 0;
                goto LAB_00044908;
            }
            *piVar19 = (int)local_78;
            local_90 = local_78;
        }
        iVar14 = 1;
        *(undefined1 *)((int)local_90 + 0x129) = 3;
    }
LAB_00044908:
    iVar16 = iVar14 + -1;
    iVar18 = iVar14 << 5;
    iVar4 = iVar14;
    if (iVar14 == 0)
        goto LAB_00044ab8;
LAB_0004493c:
    piVar10 = DAT_000cc6ec;
    iVar4 = 0;
    dVar25 = 1000000000.0;
    iVar13 = 0;
    piVar19 = DAT_000cc6ec;
    dVar27 = -1000000000.0;
    dVar29 = 0.0;
    do {
        piVar19[6] = 0;
        piVar19[7] = 0;
        if (*(double *)(piVar19 + 4) < dVar25) {
            dVar25 = *(double *)(piVar19 + 4);
        }
        dVar26 = 0.0;
        if (iVar14 != 1) {
            iVar21 = 0;
            dVar26 = 0.0;
            do {
                iVar17 = iVar21 * 8;
                iVar21 = iVar21 + 1;
                dVar28 = *(double *)(piVar10[iVar17] + 0x260) -
                         *(double *)(*piVar19 + 0x260);
                dVar26 = dVar26 + dVar28 * dVar28;
            } while (iVar14 != iVar21);
            dVar26 = dVar26 / (double)(longlong)iVar16;
            if (dVar26 < 0.0) {
                sqrt(dVar26);
            }
            *(double *)(piVar19 + 6) = SQRT(dVar26);
            dVar26 = SQRT(dVar26);
        }
        pdVar9 = (double *)(piVar19 + 2);
        piVar19 = piVar19 + 8;
        dVar28 = dVar26 * *pdVar9;
        if (dVar27 < dVar28) {
            iVar4 = iVar13;
        }
        iVar13 = iVar13 + 1;
        if (dVar27 < dVar28) {
            dVar27 = dVar28;
            dVar29 = dVar26;
        }
    } while (iVar14 != iVar13);
    dVar27 = ldexp(1.0, (int)sys_precision);
    if (dVar29 <= dVar27)
        goto LAB_00044acc;
    do {
        piVar10 = DAT_000cc6ec;
        iVar13 = sys_minclock;
        if (sys_minclock < 1) {
            iVar13 = 1;
        }
        if (iVar14 <= iVar13) {
            DAT_000cc6f4 = 0;
            DAT_000cc6f8 = 0;
            if (iVar14 != 0) {
            LAB_00044ba8:
                DAT_000cc6f8 = 0;
                DAT_000cc6f4 = 0;
                bVar22 = false;
                iVar18 = 0;
                iVar4 = 0;
                local_9c = 0;
                dVar25 = 1000000000.0;
                dVar29 = (double)CONCAT44(sys_mindisp._4_4_, (int)sys_mindisp);
                iVar13 = 0;
                iVar16 = 0;
                bVar3 = false;
                do {
                    iVar21 = *piVar10;
                    *(undefined4 *)(iVar21 + 0x2c4) = 0;
                    *(undefined1 *)(iVar21 + 0x129) = 4;
                    piVar19 = DAT_000cc6ec;
                    uVar11 = *(uint *)(iVar21 + 0x44);
                    iVar17 = iVar16;
                    bVar2 = bVar3;
                    if (*(char *)(iVar21 + 0x5b) == '\x01') {
                        iVar17 = iVar14;
                        bVar2 = true;
                        if (((uVar11 & 8) == 0) &&
                            (iVar17 = iVar16, bVar2 = bVar3, iVar16 < iVar14)) {
                            iVar17 = iVar16 + 1;
                            bVar2 = true;
                        }
                    } else if (*(char *)(iVar21 + 0x5b) == '\x02') {
                        if ((uVar11 & 8) == 0) {
                            if (local_9c < iVar14) {
                                bVar22 = true;
                                local_9c = local_9c + 1;
                            }
                        } else {
                            bVar22 = true;
                            local_9c = iVar14;
                        }
                    }
                    pdVar9 = (double *)(piVar10 + 6);
                    if ((uVar11 & 0x20) != 0) {
                        iVar18 = iVar21;
                    }
                    pdVar12 = (double *)(piVar10 + 2);
                    piVar10 = piVar10 + 8;
                    dVar27 = (double)*(byte *)(iVar21 + 0x5d) * dVar29 +
                             *pdVar9 * *pdVar12;
                    if (dVar27 < dVar25) {
                        iVar21 = iVar13;
                    }
                    iVar13 = iVar13 + 1;
                    if (dVar27 < dVar25) {
                        dVar25 = dVar27;
                        iVar4 = iVar21;
                    }
                    iVar16 = iVar17;
                    bVar3 = bVar2;
                } while (iVar14 != iVar13);
                sys_survivors = iVar14 + sys_survivors;
                if (bVar2) {
                    DAT_000cc6f4 = iVar17;
                }
                if (bVar22) {
                    DAT_000cc6f8 = local_9c;
                }
                if (sys_minsane <= iVar14) {
                    iVar16 = DAT_000cc6ec[iVar4 * 8];
                    iVar14 = iVar16;
                    if (iVar6 == iVar16 || iVar6 == 0) {
                        DAT_000cc700 = 0.0;
                        dVar29 = DAT_000cc700;
                        if (iVar16 == 0) {
                            if ((iVar8 != 0) && (ABS(sys_offset) < 0.4)) {
                                if (iVar18 == 0 &&
                                    *(char *)(iVar8 + 0x58) == '\x16')
                                    goto LAB_0004540c;
                                goto LAB_00044d68;
                            }
                            goto LAB_00044f78;
                        }
                    } else {
                        dVar25 = ABS(*(double *)(iVar16 + 0x260) -
                                     *(double *)(iVar6 + 0x260));
                        if ((double)CONCAT44(sys_mindisp._4_4_,
                                             (int)sys_mindisp) <= dVar25) {
                            DAT_000cc700 = 0.0;
                            dVar29 = DAT_000cc700;
                        } else {
                            iVar14 = iVar6;
                            dVar29 = (double)CONCAT44(sys_mindisp._4_4_,
                                                      (int)sys_mindisp);
                            if ((DAT_000cc700 != 0.0) &&
                                (dVar29 = DAT_000cc700 * 0.5,
                                 DAT_000cc700 * 0.5 <= dVar25)) {
                                DAT_000cc700 = 0.0;
                                iVar14 = iVar16;
                                dVar29 = DAT_000cc700;
                            }
                        }
                    }
                    DAT_000cc700 = dVar29;
                    if (iVar18 == 0) {
                        *(undefined1 *)(iVar14 + 0x129) = 6;
                        dVar27 = 0.0;
                        dVar29 = dVar27;
                        dVar25 = dVar27;
                        if (0 < sys_survivors) {
                            piVar10 = piVar19;
                            do {
                                piVar20 = piVar10 + 8;
                                dVar26 = 1.0 / *(double *)(piVar10 + 2);
                                dVar28 = *(double *)(*piVar10 + 0x260) -
                                         *(double *)(iVar16 + 0x260);
                                dVar29 = dVar29 + dVar26;
                                dVar27 = dVar27 +
                                         dVar26 * *(double *)(*piVar10 + 0x260);
                                dVar25 = dVar25 + dVar28 * dVar28 * dVar26;
                                piVar10 = piVar20;
                            } while (piVar19 + sys_survivors * 8 != piVar20);
                        }
                        sys_offset = dVar27 / dVar29;
                        dVar29 = dVar25 / dVar29 +
                                 *(double *)(piVar19 + iVar4 * 8 + 6) *
                                     *(double *)(piVar19 + iVar4 * 8 + 6);
                        dVar25 = SQRT(dVar29);
                        if (dVar29 < 0.0) {
                            sqrt(dVar29);
                        }
                        sys_jitter = dVar25;
                        if (((iVar8 != 0) && (ABS(sys_offset) < 0.4)) &&
                            (*(char *)(iVar8 + 0x58) != '\x16'))
                            goto LAB_00044d68;
                    } else {
                        sys_offset = *(double *)(iVar18 + 0x260);
                        *(undefined1 *)(iVar18 + 0x129) = 6;
                        DAT_000cc700 = 0.0;
                        iVar14 = iVar18;
                        sys_jitter = *(double *)(iVar18 + 0x270);
                        if ((iVar8 != 0) && (ABS(sys_offset) < 0.4)) {
                        LAB_00044d68:
                            sys_offset = *(double *)(iVar8 + 0x260);
                            *(undefined1 *)(iVar8 + 0x129) = 7;
                            DAT_000cc700 = 0.0;
                            iVar14 = iVar8;
                            sys_jitter = *(double *)(iVar8 + 0x270);
                        }
                    }
                    if (sys_epoch < *(uint *)(iVar14 + 0x130)) {
                        piVar10 = peer_list;
                        uVar11 = *(uint *)(iVar14 + 0x130);
                        if (iVar6 != iVar14) {
                            FUN_00035ee0(0x8a, iVar14, 0);
                            piVar10 = peer_list;
                            uVar11 = *(uint *)(iVar14 + 0x130);
                        }
                        for (; sys_epoch = uVar11, piVar10 != (int *)0x0;
                             piVar10 = (int *)*piVar10) {
                            *(undefined1 *)(piVar10 + 0x4a) =
                                *(undefined1 *)((int)piVar10 + 0x129);
                            uVar11 = sys_epoch;
                        }
                        if (sys_poll < *(byte *)(iVar14 + 0x41)) {
                            sys_poll = *(byte *)(iVar14 + 0x41);
                        }
                        if (*(byte *)(iVar14 + 0x42) < sys_poll) {
                            sys_poll = *(byte *)(iVar14 + 0x42);
                        }
                        sys_peer = iVar14;
                        FUN_00044264(iVar14, sys_poll);
                        bVar1 = *(byte *)(iVar14 + 0x5d);
                        bVar7 = bVar1;
                        if (0xe < bVar1) {
                            bVar7 = 0xf;
                        }
                        sys_stratum = bVar7 + 1;
                        if ((bVar1 & 0xef) == 0) {
                            sys_refid = *(undefined4 *)(iVar14 + 0x70);
                        } else {
                            sys_refid = FUN_0007083c(iVar14 + 0x10);
                        }
                        sys_reftime._0_4_ = *(undefined4 *)(iVar14 + 0x240);
                        sys_reftime._4_4_ = *(undefined4 *)(iVar14 + 0x244);
                        sys_rootdisp =
                            *(double *)(iVar14 + 0x68) +
                            *(double *)(iVar14 + 0x278) + sys_jitter +
                            (double)(current_time - *(int *)(iVar14 + 0x2c0)) *
                                clock_phi +
                            ABS(sys_offset);
                        if (sys_rootdisp <=
                            (double)CONCAT44(sys_mindisp._4_4_,
                                             (int)sys_mindisp)) {
                            sys_rootdisp = (double)CONCAT44(sys_mindisp._4_4_,
                                                            (int)sys_mindisp);
                        }
                        sys_rootdelay = *(double *)(iVar14 + 0x268) +
                                        *(double *)(iVar14 + 0x60);
                        iVar6 = FUN_0003f4bc(iVar14);
                        if (iVar6 == 1) {
                            if (sys_leap == '\x03') {
                                FUN_000435a4(0);
                                if (crypto_flags != 0) {
                                    FUN_000379fc();
                                }
                                if (waitsync_fd_to_close != -1) {
                                    close(waitsync_fd_to_close);
                                    waitsync_fd_to_close = -1;
                                }
                            }
                            if (leapsec == 0) {
                                if (DAT_000cc6f8 < DAT_000cc6f4) {
                                    if (DAT_000cc6f4 <= sys_survivors / 2)
                                        goto LAB_00044f2c;
                                    FUN_0006f724(local_6c);
                                    FUN_0003dcf4(1, local_6c[0], 0);
                                }
                                if ((DAT_000cc6f4 < DAT_000cc6f8) &&
                                    (sys_survivors / 2 < DAT_000cc6f8)) {
                                    FUN_0006f724(local_6c);
                                    FUN_0003dcf4(0, local_6c[0]);
                                }
                            }
                        } else if (iVar6 == 2) {
                            FUN_00041d10();
                            FUN_000435a4(3);
                            sys_refid = 0x50455453;
                            sys_rootdelay = 0.0;
                            sys_rootdisp = 0.0;
                            sys_stratum = '\x10';
                            sys_reftime._4_4_ = 0;
                            sys_reftime._0_4_ = 0;
                            sys_jitter = ldexp(1.0, (int)sys_precision);
                            FUN_0003db18();
                        } else if (iVar6 == -1) {
                            /* WARNING: Subroutine does not return */
                            exit(-1);
                        }
                    }
                LAB_00044f2c:
                    if (local_64 != __stack_chk_guard) {
                        /* WARNING: Subroutine does not return */
                        __stack_chk_fail();
                    }
                    return;
                }
                if (iVar8 != 0) {
                LAB_00044d30:
                    if (ABS(sys_offset) < 0.4) {
                        if (iVar18 == 0 && *(char *)(iVar8 + 0x58) == '\x16') {
                        LAB_0004540c:
                            if (sys_minsane != 0)
                                goto LAB_00044f78;
                        }
                        goto LAB_00044d68;
                    }
                }
            LAB_00044f78:
                if (iVar6 != 0) {
                    if (0 < sys_orphwait) {
                        orphwait = current_time + sys_orphwait;
                    }
                    FUN_00035ee0(8, 0);
                }
                sys_peer = 0;
                for (piVar10 = peer_list; piVar10 != (int *)0x0;
                     piVar10 = (int *)*piVar10) {
                    *(undefined1 *)(piVar10 + 0x4a) =
                        *(undefined1 *)((int)piVar10 + 0x129);
                }
                goto LAB_00044f2c;
            }
            if (iVar8 == 0)
                goto LAB_00044f78;
            iVar18 = 0;
            goto LAB_00044d30;
        }
        if (dVar29 <= dVar25)
            goto LAB_00044ba8;
        piVar19 = DAT_000cc6ec + iVar4 * 8;
        if ((*(uint *)(DAT_000cc6ec[iVar4 * 8] + 0x44) & 0x420) != 0)
            goto LAB_00044ba8;
        if (sys_maxclock < iVar14) {
            *(undefined1 *)(DAT_000cc6ec[iVar4 * 8] + 0x129) = 5;
        }
        if (iVar4 + 1 < iVar14) {
            do {
                piVar20 = piVar19 + 8;
                *piVar19 = piVar19[8];
                piVar19[1] = piVar19[9];
                piVar19[2] = piVar19[10];
                piVar19[3] = piVar19[0xb];
                piVar19[4] = piVar19[0xc];
                piVar19[5] = piVar19[0xd];
                piVar19[6] = piVar19[0xe];
                piVar19[7] = piVar19[0xf];
                piVar19 = piVar20;
            } while ((int *)((int)piVar10 + iVar18 + -0x20) != piVar20);
        }
        iVar14 = iVar14 + -1;
        iVar16 = iVar16 + -1;
        iVar18 = iVar18 + -0x20;
        iVar4 = iVar14;
        if (iVar14 != 0)
            goto LAB_0004493c;
    LAB_00044ab8:
        dVar25 = 1000000000.0;
        ldexp(1.0, (int)sys_precision);
        iVar14 = iVar4;
    LAB_00044acc:
        dVar29 = ldexp(1.0, (int)sys_precision);
    } while (true);
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x000458cc */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_00045528(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    double *pdVar3;
    double *pdVar4;
    int **ppiVar5;
    uint uVar6;
    undefined1 *puVar7;
    undefined1 *puVar8;
    int iVar9;
    uint uVar10;
    int *piVar11;
    int iVar12;
    double *pdVar13;
    int *piVar14;
    bool bVar15;
    uint uVar16;
    undefined8 in_d0;
    undefined8 in_d1;
    undefined8 in_d2;
    double dVar17;
    double extraout_d7;
    double dVar18;
    double dVar19;
    double dVar20;
    int *local_fc;
    int *local_f8[8];
    double local_d8[7];
    undefined8 local_a0;
    undefined1 auStack_94[80];
    int local_44;

    local_44 = __stack_chk_guard;
    iVar12 = 7;
    iVar9 = *(int *)(param_1 + 0x140);
    local_fc = &__stack_chk_guard;
    pdVar13 = local_d8;
    iVar1 = param_1 + iVar9 * 8;
    uVar10 = iVar9 + 1;
    *(undefined8 *)(iVar1 + 0x188) = in_d0;
    *(undefined8 *)(iVar1 + 0x148) = in_d1;
    *(undefined8 *)(iVar1 + 0x1c8) = in_d2;
    iVar1 = current_time;
    piVar11 = (int *)(uVar10 & 7);
    if ((int)uVar10 < 1) {
        piVar11 = (int *)-(-uVar10 & 7);
    }
    uVar10 = current_time - *(int *)(param_1 + 0x2c0);
    *(int *)(param_1 + (iVar9 + 0x82) * 4) = current_time;
    *(int **)(param_1 + 0x140) = piVar11;
    dVar18 = clock_phi;
    *(int *)(param_1 + 0x2c0) = iVar1;
    pdVar3 = pdVar13;
    do {
        iVar1 = param_1 + (int)piVar11 * 8;
        dVar17 = *(double *)(iVar1 + 0x1c8);
        if (iVar12 != 0) {
            dVar17 = dVar17 + (double)uVar10 * dVar18;
        }
        if (iVar12 != 0) {
            *(double *)(iVar1 + 0x1c8) = dVar17;
        }
        if (16.0 <= dVar17) {
            *(undefined8 *)(iVar1 + 0x1c8) = 0x4030000000000000;
            pdVar3[7] = 16.0;
        } else {
            uVar6 = *(int *)(param_1 + 0x2c0) -
                    *(int *)(param_1 + ((int)piVar11 + 0x82U) * 4);
            dVar17 = ldexp(1.0, (uint)allan_xpt);
            uVar16 = (uint)(0.0 < dVar17) * (int)(longlong)dVar17;
            dVar17 = extraout_d7;
            if (uVar16 < uVar6) {
                dVar17 = *(double *)(iVar1 + 0x148);
            }
            if (uVar16 < uVar6) {
                dVar17 = dVar17 + *(double *)(iVar1 + 0x1c8);
            } else {
                uVar2 = *(undefined4 *)(iVar1 + 0x14c);
                *(undefined4 *)(pdVar3 + 7) = *(undefined4 *)(iVar1 + 0x148);
                *(undefined4 *)((int)pdVar3 + 0x3c) = uVar2;
            }
            if (uVar16 < uVar6) {
                pdVar3[7] = dVar17;
            }
        }
        dVar17 = sys_maxdist;
        uVar6 = (int)piVar11 + 1;
        local_f8[iVar12] = piVar11;
        iVar12 = iVar12 + -1;
        piVar11 = (int *)(uVar6 & 7);
        if ((int)uVar6 < 1) {
            piVar11 = (int *)-(-uVar6 & 7);
        }
        pdVar3 = pdVar3 + -1;
    } while (iVar12 != -1);
    if (freq_cnt == 0) {
        iVar1 = 1;
        pdVar3 = pdVar13;
        ppiVar5 = local_f8;
        do {
            iVar9 = 0;
            pdVar4 = pdVar13;
            do {
                dVar18 = *pdVar4;
                if (pdVar3[1] < dVar18) {
                    piVar14 = local_f8[iVar9];
                    piVar11 = ppiVar5[1];
                    *pdVar4 = pdVar3[1];
                    pdVar3[1] = dVar18;
                    local_f8[iVar9] = piVar11;
                    ppiVar5[1] = piVar14;
                }
                iVar9 = iVar9 + 1;
                pdVar4 = pdVar4 + 1;
            } while (iVar9 != iVar1);
            iVar1 = iVar1 + 1;
            pdVar3 = pdVar3 + 1;
            ppiVar5 = ppiVar5 + 1;
        } while (iVar1 != 8);
    }
    ppiVar5 = &local_fc;
    iVar1 = 0;
    puVar7 = (undefined1 *)(param_1 + 0x228);
    do {
        dVar18 = *pdVar13;
        pdVar13 = pdVar13 + 1;
        ppiVar5 = ppiVar5 + 1;
        puVar8 = puVar7 + 1;
        *puVar7 = (char)*ppiVar5;
        if ((dVar18 < 16.0) && ((iVar1 < 2 || (dVar18 < dVar17)))) {
            iVar1 = iVar1 + 1;
        }
        puVar7 = puVar8;
    } while ((undefined1 *)(param_1 + 0x230) != puVar8);
    iVar9 = 7;
    dVar18 = 0.0;
    *(undefined8 *)(param_1 + 0x270) = 0;
    *(undefined8 *)(param_1 + 0x278) = 0;
    do {
        iVar12 = param_1 + (int)local_f8[iVar9] * 8;
        dVar18 = (dVar18 + *(double *)(iVar12 + 0x1c8)) * 0.5;
        if (iVar9 < iVar1) {
            dVar17 = *(double *)(iVar12 + 0x188) -
                     *(double *)(param_1 + ((int)local_f8[0] + 0x31) * 8);
            *(double *)(param_1 + 0x270) =
                *(double *)(param_1 + 0x270) + dVar17 * dVar17;
        }
        bVar15 = iVar9 != 0;
        iVar9 = iVar9 + -1;
    } while (bVar15);
    *(double *)(param_1 + 0x278) = dVar18;
    if (iVar1 != 0) {
        bVar15 = iVar1 != 1;
        dVar17 = *(double *)(param_1 + 0x270);
        if (bVar15) {
            iVar1 = iVar1 + -1;
        }
        iVar9 = param_1 + (int)local_f8[0] * 8;
        dVar19 = *(double *)(param_1 + 0x260);
        if (bVar15) {
            dVar18 = (double)(longlong)iVar1;
        }
        dVar20 = *(double *)(iVar9 + 0x188);
        if (bVar15) {
            dVar17 = dVar17 / dVar18;
        }
        *(double *)(param_1 + 0x260) = dVar20;
        uVar2 = *(undefined4 *)(iVar9 + 0x14c);
        *(undefined4 *)(param_1 + 0x268) = *(undefined4 *)(iVar9 + 0x148);
        *(undefined4 *)(param_1 + 0x26c) = uVar2;
        if (bVar15) {
            *(double *)(param_1 + 0x270) = dVar17;
        }
        if (dVar17 < 0.0) {
            sqrt(dVar17);
        }
        dVar18 = ldexp(1.0, (int)sys_precision);
        if (dVar18 < SQRT(dVar17)) {
            dVar17 = *(double *)(param_1 + 0x270);
            dVar18 = SQRT(dVar17);
            if (dVar17 < 0.0) {
                sqrt(dVar17);
            }
        } else {
            dVar18 = ldexp(1.0, (int)sys_precision);
        }
        dVar17 = sys_maxdist;
        iVar1 = param_1 + (int)local_f8[0] * 4;
        *(double *)(param_1 + 0x270) = dVar18;
        uVar6 = *(uint *)(param_1 + 0x130);
        uVar10 = *(uint *)(iVar1 + 0x208);
        if (((*(double *)(param_1 + 0x278) < dVar17) &&
             (*(double *)(iVar9 + 0x1c8) < dVar17)) &&
            (dVar18 * 3.0 < ABS(dVar19 - dVar20))) {
            dVar18 = ldexp(1.0, (uint) * (byte *)(param_1 + 0x40));
            if ((double)(uVar10 - uVar6) < dVar18 + dVar18) {
                FUN_0007c054(auStack_94, 0x50, "%.6f s");
                FUN_00035ee0(0x8d, param_1, auStack_94);
                goto LAB_0004586c;
            }
            uVar10 = *(uint *)(iVar1 + 0x208);
            uVar6 = *(uint *)(param_1 + 0x130);
        }
        if (uVar10 <= uVar6)
            goto LAB_0004586c;
        *(uint *)(param_1 + 0x130) = uVar10;
        uVar2 = FUN_00033504(param_1);
        FUN_00051cdc(
            (int)*(undefined8 *)(param_1 + 0x260),
            (int)((ulonglong) * (undefined8 *)(param_1 + 0x260) >> 0x20),
            (int)*(undefined8 *)(param_1 + 0x268),
            (int)((ulonglong) * (undefined8 *)(param_1 + 0x268) >> 0x20),
            (int)*(undefined8 *)(param_1 + 0x278),
            (int)((ulonglong) * (undefined8 *)(param_1 + 0x278) >> 0x20),
            (int)*(undefined8 *)(param_1 + 0x270), param_1 + 0x10, uVar2);
        if ((*(int *)(param_1 + 0x134) != 0) && (sys_leap != '\x03'))
            goto LAB_0004586c;
    }
    FUN_000443fc();
LAB_0004586c:
    if (local_44 == *local_fc) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00045b60 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_000459b0(int param_1, byte *param_2)

{
    byte bVar1;
    byte bVar2;
    uint uVar3;
    int iVar4;
    uint extraout_r1;
    int iVar5;
    char *pcVar6;
    uint uVar7;
    undefined4 uVar8;
    uint uVar9;
    uint uVar10;
    uint uVar11;
    uint uVar12;
    undefined8 in_d0;
    double dVar13;
    double dVar14;
    undefined4 in_s3;
    double dVar15;
    double dVar16;
    uint local_15c;
    uint local_158;
    uint local_154;
    uint local_150;
    uint local_14c;
    uint local_148;
    undefined1 auStack_144[256];
    int local_44;

    uVar7 = *(uint *)(param_2 + 8);
    uVar3 = *(uint *)(param_2 + 4);
    bVar1 = *param_2;
    uVar9 = *(uint *)(param_2 + 0x1c);
    uVar11 = *(uint *)(param_2 + 0x20);
    uVar10 = *(uint *)(param_2 + 0x18);
    local_148 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 |
                (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
    local_15c = uVar11 << 0x18 | (uVar11 >> 8 & 0xff) << 0x10 |
                (uVar11 >> 0x10 & 0xff) << 8 | uVar11 >> 0x18;
    local_14c = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    uVar11 = (uint)param_2[1];
    bVar2 = bVar1 >> 6;
    uVar9 = *(uint *)(param_2 + 0x24);
    uVar10 = *(uint *)(param_2 + 0x2c);
    local_158 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 |
                (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
    local_150 = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    uVar9 = *(uint *)(param_2 + 0x28);
    if (uVar11 == 0) {
        uVar11 = 0x10;
    }
    uVar10 = *(uint *)(param_2 + 0x10);
    local_154 = uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 |
                (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18;
    uVar12 = *(uint *)(param_2 + 0x14);
    local_44 = __stack_chk_guard;
    dVar16 = (double)(uVar3 << 0x18 | (uVar3 >> 8 & 0xff) << 0x10 |
                      (uVar3 >> 0x10 & 0xff) << 8 | uVar3 >> 0x18) *
             1.52587890625e-05;
    dVar15 = (double)(uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                      (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18) *
             1.52587890625e-05;
    uVar9 = *(uint *)(param_1 + 300);
    if (((bVar2 == 3) || ((int)uVar11 < sys_floor)) ||
        (sys_ceiling <= (int)uVar11)) {
        uVar9 = uVar9 | 0x20;
        *(uint *)(param_1 + 300) = uVar9;
    }
    if (16.0 <= dVar15 + dVar16 * 0.5) {
        uVar9 = uVar9 | 0x40;
        *(uint *)(param_1 + 300) = uVar9;
    }
    if ((uVar9 & 0x1ff) != 0) {
        *(int *)(param_1 + 0x300) = *(int *)(param_1 + 0x300) + 1;
        FUN_00044264(param_1, *(undefined1 *)(param_1 + 0x40));
        goto LAB_00045d04;
    }
    iVar4 = *(int *)(param_1 + 0x38);
    if (iVar4 != 0) {
        iVar4 = iVar4 + 0x18;
    }
    *(int *)(param_1 + 0x2ec) = *(int *)(param_1 + 0x2ec) + 1;
    sys_processed = sys_processed + 1;
    FUN_000520f0(SUB84(dVar16, 0), (int)((ulonglong)in_d0 >> 0x20),
                 SUB84(dVar15, 0), param_1 + 0x10, iVar4, &local_14c,
                 &local_15c);
    *(byte *)(param_1 + 0x5c) = bVar1 & 7;
    if (0xf < uVar11) {
        uVar11 = 0x10;
    }
    *(byte *)(param_1 + 0x5b) = bVar2;
    *(char *)(param_1 + 0x5d) = (char)uVar11;
    bVar1 = param_2[3];
    *(double *)(param_1 + 0x60) = dVar16;
    *(byte *)(param_1 + 0x5f) = bVar1;
    uVar8 = *(undefined4 *)(param_2 + 0xc);
    *(double *)(param_1 + 0x68) = dVar15;
    *(undefined4 *)(param_1 + 0x70) = uVar8;
    *(uint *)(param_1 + 0x74) = uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                                (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    uVar9 = extraout_r1;
    if (*(int *)(param_1 + 0x138) < 1) {
        uVar9 = (uint) * (byte *)(param_1 + 0x40);
    }
    *(uint *)(param_1 + 0x78) = uVar12 << 0x18 | (uVar12 >> 8 & 0xff) << 0x10 |
                                (uVar12 >> 0x10 & 0xff) << 8 | uVar12 >> 0x18;
    if (0 < *(int *)(param_1 + 0x138)) {
        *(undefined4 *)(param_1 + 0x138) = 0;
        uVar9 = (uint) * (byte *)(param_1 + 0x40);
        if (*(char *)(param_1 + 0x12a) == '\0') {
            *(undefined4 *)(param_1 + 0x134) = 5;
        } else {
            iVar4 = 1 << (uVar9 - *(byte *)(param_1 + 0x41) & 0xff);
            if (7 < iVar4) {
                iVar4 = 8;
            }
            *(int *)(param_1 + 0x134) = iVar4 + -1;
            if (iVar4 + -1 < 1)
                goto LAB_00045bf0;
        }
        *(int *)(param_1 + 0x2d0) = current_time;
    }
LAB_00045bf0:
    FUN_00044264(param_1, uVar9);
    bVar1 = *(byte *)(param_1 + 0x12a);
    if (bVar1 == 0) {
        FUN_00035ee0(0x84, param_1);
        bVar1 = *(byte *)(param_1 + 0x12a);
        *(int *)(param_1 + 0x2e0) = current_time;
    }
    *(byte *)(param_1 + 0x12a) = bVar1 | 1;
    if (*(int *)(param_1 + 0x13c) == 0) {
        if (*(char *)(param_1 + 0x5c) == '\x05') {
            if ((*(uint *)(param_1 + 0x44) & 0x2000) != 0) {
                iVar4 = local_148 - *(uint *)(param_1 + 0x24c);
                iVar5 = local_14c - *(int *)(param_1 + 0x248);
                if (local_148 < *(uint *)(param_1 + 0x24c)) {
                    iVar5 = iVar5 + -1;
                }
                if (iVar5 < 0) {
                    dVar15 = (double)FUN_0009bec4(
                        -iVar4, -(iVar5 + (uint)(iVar4 != 0)));
                    dVar15 = ldexp(dVar15, -0x20);
                    dVar15 = -dVar15;
                } else {
                    dVar15 = (double)FUN_0009bec4(iVar4, iVar5);
                    dVar15 = ldexp(dVar15, -0x20);
                }
                iVar4 = local_14c - *(int *)(param_1 + 0x250);
                if (local_148 < *(uint *)(param_1 + 0x254)) {
                    iVar4 = iVar4 + -1;
                }
                iVar5 = local_148 - *(uint *)(param_1 + 0x254);
                if (iVar4 < 0) {
                    dVar16 = (double)FUN_0009bec4(
                        -iVar5, -(iVar4 + (uint)(iVar5 != 0)));
                    dVar16 = ldexp(dVar16, -0x20);
                    dVar16 = -dVar16;
                } else {
                    dVar16 = (double)FUN_0009bec4(iVar5, iVar4);
                    dVar16 = ldexp(dVar16, -0x20);
                }
                *(uint *)(param_1 + 0x248) = local_154;
                *(uint *)(param_1 + 0x24c) = local_150;
                *(undefined4 *)(param_1 + 0x250) =
                    *(undefined4 *)(param_1 + 0x240);
                *(undefined4 *)(param_1 + 0x254) =
                    *(undefined4 *)(param_1 + 0x244);
                if ((0.0 <= dVar15) && (dVar15 <= 1.0)) {
                    *(double *)(param_1 + 0x280) = dVar15;
                    goto LAB_00046124;
                }
                if ((*(uint *)(param_1 + 0x44) & 0x10) == 0) {
                    pcVar6 = "offset %.6f delay %.6f";
                    goto LAB_00045cec;
                }
            LAB_00046168:
                FUN_00041fc4(param_1);
                goto LAB_00045d04;
            }
            iVar5 = local_150 - *(uint *)(param_1 + 0x244);
            iVar4 = local_154 - *(int *)(param_1 + 0x240);
            if (local_150 < *(uint *)(param_1 + 0x244)) {
                iVar4 = iVar4 + -1;
            }
            if (iVar4 < 0) {
                dVar15 =
                    (double)FUN_0009bec4(-iVar5, -(iVar4 + (uint)(iVar5 != 0)));
                dVar16 = ldexp(dVar15, -0x20);
                dVar16 = -dVar16;
            } else {
                dVar15 = (double)FUN_0009bec4(iVar5, iVar4);
                dVar16 = ldexp(dVar15, -0x20);
            }
        LAB_00046124:
            if ((*(uint *)(param_1 + 0x44) & 0x10) == 0) {
                dVar15 = *(double *)(param_1 + 0x268);
            } else {
                *(uint *)(param_1 + 0x44) =
                    *(uint *)(param_1 + 0x44) & 0xffffffef;
                dVar15 = ABS(*(double *)(param_1 + 0x260) - dVar16);
                dVar15 = dVar15 + dVar15;
                *(double *)(param_1 + 0x268) = dVar15;
                if (ABS(sys_bdelay) < dVar15)
                    goto LAB_00046168;
            }
            dVar16 = dVar16 + dVar15 * 0.5;
            *(int *)(param_1 + 0x2d0) =
                current_time + -2 + (1 << (uint) * (byte *)(param_1 + 0x5e));
        } else {
            iVar4 = local_150 - *(uint *)(param_1 + 0x244);
            iVar5 = local_154 - *(int *)(param_1 + 0x240);
            if (local_150 < *(uint *)(param_1 + 0x244)) {
                iVar5 = iVar5 + -1;
            }
            if (iVar5 < 0) {
                dVar15 =
                    (double)FUN_0009bec4(-iVar4, -(iVar5 + (uint)(iVar4 != 0)));
                dVar15 = ldexp(dVar15, -0x20);
                dVar15 = -dVar15;
            } else {
                dVar15 = (double)FUN_0009bec4(iVar4, iVar5);
                dVar15 = ldexp(dVar15, -0x20);
            }
            iVar4 = local_15c - local_14c;
            if (local_158 < local_148) {
                iVar4 = iVar4 + -1;
            }
            iVar5 = local_158 - local_148;
            if (iVar4 < 0) {
                dVar16 =
                    (double)FUN_0009bec4(-iVar5, -(iVar4 + (uint)(iVar5 != 0)));
                dVar13 = ldexp(dVar16, -0x20);
                dVar13 = -dVar13;
            } else {
                dVar16 = (double)FUN_0009bec4(iVar5, iVar4);
                dVar13 = ldexp(dVar16, -0x20);
            }
            dVar16 = (dVar15 + dVar13) * 0.5;
            dVar15 = ABS(dVar13 - dVar15);
        }
    } else {
        iVar4 = local_154 - *(int *)(param_1 + 0x240);
        if (local_150 < *(uint *)(param_1 + 0x244)) {
            iVar4 = iVar4 + -1;
        }
        iVar5 = local_150 - *(uint *)(param_1 + 0x244);
        if (iVar4 < 0) {
            dVar15 =
                (double)FUN_0009bec4(-iVar5, -(iVar4 + (uint)(iVar5 != 0)));
            dVar16 = ldexp(dVar15, -0x20);
            dVar16 = -dVar16;
        } else {
            dVar15 = (double)FUN_0009bec4(iVar5, iVar4);
            dVar16 = ldexp(dVar15, -0x20);
        }
        if (*(int *)(param_1 + 0x13c) < 1) {
            iVar4 = *(int *)(param_1 + 0x248);
            uVar9 = *(uint *)(param_1 + 0x24c);
        } else {
            iVar4 = *(int *)(param_1 + 0x250);
            uVar9 = *(uint *)(param_1 + 0x254);
        }
        iVar4 = local_15c - iVar4;
        if (local_158 < uVar9) {
            iVar4 = iVar4 + -1;
        }
        iVar5 = local_158 - uVar9;
        if (iVar4 < 0) {
            dVar15 =
                (double)FUN_0009bec4(-iVar5, -(iVar4 + (uint)(iVar5 != 0)));
            dVar13 = ldexp(dVar15, -0x20);
            dVar13 = -dVar13;
        } else {
            dVar15 = (double)FUN_0009bec4(iVar5, iVar4);
            dVar13 = ldexp(dVar15, -0x20);
        }
        dVar15 = dVar13 - dVar16;
        if ((dVar15 < 0.0) || (1.0 < dVar15)) {
            pcVar6 = "t21 %.6f t34 %.6f";
        LAB_00045cec:
            FUN_0007c054(auStack_144, 0x100, pcVar6);
            FUN_00035ee0(0x8f, param_1, auStack_144);
            goto LAB_00045d04;
        }
        dVar16 = (dVar16 + dVar13) * 0.5;
    }
    dVar13 = ldexp(1.0, (int)sys_precision);
    if (dVar15 <= dVar13) {
        dVar15 = ldexp(1.0, (int)sys_precision);
    }
    dVar13 = ldexp(1.0, (int)sys_precision);
    dVar14 = ldexp(1.0, (int)*(char *)(param_1 + 0x5f));
    dVar16 = dVar16 + *(double *)(param_1 + 0x288);
    FUN_00045528(SUB84(dVar16, 0), (int)((ulonglong)dVar16 >> 0x20),
                 SUB84(dVar15, 0), in_s3,
                 SUB84(dVar13 + dVar14 + dVar15 * clock_phi, 0), param_1);
    if (((((*(uint *)(param_1 + 0x44) & 0x10) != 0) &&
          (*(char *)(param_1 + 0x3f) == '\x03')) &&
         (uVar9 = FUN_00042fe4(param_1), (uVar9 & 0x400) == 0)) &&
        (((*(uint *)(param_1 + 0x44) & 0x800) == 0 ||
          ((~*(uint *)(param_1 + 0x88) & 0x7f00) == 0)))) {
        *(undefined1 *)(param_1 + 0x3f) = 6;
    }
LAB_00045d04:
    if (local_44 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00046214(int param_1, undefined4 *param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    uint uVar5;
    undefined4 uVar6;
    undefined1 *puVar7;
    int extraout_r1;
    undefined4 *puVar8;
    int iVar9;
    double dVar10;

    iVar1 = __stack_chk_guard;
    uVar3 = *(undefined4 *)(param_1 + 600);
    uVar6 = *(undefined4 *)(param_1 + 0x25c);
    FUN_0004394c(param_1);
    if (*(BIGNUM **)(param_1 + 0xb0) != (BIGNUM *)0x0) {
        BN_free(*(BIGNUM **)(param_1 + 0xb0));
    }
    FUN_00037b48(param_1 + 0xb8);
    FUN_00037b48(param_1 + 0xd0);
    FUN_00037b48(param_1 + 0xf8);
    FUN_00037b48(param_1 + 0x110);
    if (*(void **)(param_1 + 0xe8) != (void *)0x0) {
        free(*(void **)(param_1 + 0xe8));
    }
    if (*(void **)(param_1 + 0x94) != (void *)0x0) {
        free(*(void **)(param_1 + 0x94));
    }
    if (*(void **)(param_1 + 0x98) != (void *)0x0) {
        free(*(void **)(param_1 + 0x98));
    }
    memset((void *)(param_1 + 0x80), 0, 0x240);
    *(undefined1 *)(param_1 + 0x40) = *(undefined1 *)(param_1 + 0x41);
    *(undefined4 *)(param_1 + 0x278) = 0;
    *(undefined4 *)(param_1 + 0x27c) = 0x40300000;
    *(undefined1 *)(param_1 + 0x5e) = *(undefined1 *)(param_1 + 0x42);
    uVar4 = FUN_00042fe4(param_1);
    *(undefined4 *)(param_1 + 300) = uVar4;
    dVar10 = ldexp(1.0, (int)sys_precision);
    *(double *)(param_1 + 0x270) = dVar10;
    if (*(char *)(param_1 + 0x3f) == '\x06') {
        *(undefined4 *)(param_1 + 600) = uVar3;
        *(undefined4 *)(param_1 + 0x25c) = uVar6;
    }
    uVar5 = *(uint *)(param_1 + 0x44);
    if ((uVar5 & 0x1000) != 0) {
        *(undefined4 *)(param_1 + 0x13c) = 1;
    }
    iVar9 = 0;
    puVar7 = (undefined1 *)(param_1 + 0x228);
    puVar8 = (undefined4 *)(param_1 + 0x1c8);
    do {
        *puVar7 = (char)iVar9;
        iVar9 = iVar9 + 1;
        *puVar8 = 0;
        puVar8[1] = 0x40300000;
        puVar7 = puVar7 + 1;
        puVar8 = puVar8 + 2;
    } while (iVar9 != 8);
    if ((uVar5 & 8) == 0) {
        *(undefined1 *)(param_1 + 0x5b) = 3;
        *(undefined1 *)(param_1 + 0x5d) = 0x10;
        *(undefined4 *)(param_1 + 0x70) = *param_2;
    } else {
        iVar9 = *(int *)(param_1 + 0x54);
        *(undefined4 *)(iVar9 + 0xdc) = 0;
        *(undefined4 *)(iVar9 + 0xd8) = 0;
    }
    iVar9 = current_time;
    *(int *)(param_1 + 0x2cc) = current_time;
    *(int *)(param_1 + 0x2c0) = iVar9;
    *(int *)(param_1 + 0x2d0) = iVar9;
    if (initializing == 0) {
        if (*(char *)(param_1 + 0x3f) == '\x02') {
            *(int *)(param_1 + 0x2d0) = ntp_minpkt + iVar9;
        } else {
            uVar3 = FUN_00078ae4();
            FUN_0009bb9c(uVar3, *(undefined1 *)(param_1 + 0x41));
            iVar9 = current_time;
            *(int *)(param_1 + 0x2d0) = *(int *)(param_1 + 0x2d0) + extraout_r1;
        }
    } else {
        *(int *)(param_1 + 0x2d0) = peer_associations + iVar9;
    }
    iVar2 = __stack_chk_guard;
    *(int *)(param_1 + 0xec) = iVar9 + 0x80000;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00046448(int param_1)

{
    char cVar1;
    byte bVar2;
    char cVar3;
    char cVar4;
    undefined4 uVar5;
    void *pvVar6;
    uint uVar7;
    int iVar8;
    int iVar9;
    undefined4 uVar10;
    char cVar11;
    undefined4 unaff_r7;
    ushort local_898[2];
    uint local_894;
    uint local_890;
    undefined4 local_88c;
    undefined4 local_888;
    byte local_874;
    char local_873;
    undefined1 local_872;
    undefined1 local_871;
    uint local_870;
    uint local_86c;
    undefined4 local_868;
    uint local_864;
    uint uStack_860;
    uint local_84c;
    uint local_848;
    int local_2c;
    int local_24;

    cVar11 = *(char *)(param_1 + 0x40);
    local_24 = __stack_chk_guard;
    if ((*(uint *)(param_1 + 0x2d8) < *(uint *)(param_1 + 0x2cc)) &&
        (*(char *)(param_1 + 0x12a) == '\0')) {
        *(undefined1 *)(param_1 + 0x5e) = *(undefined1 *)(param_1 + 0x42);
    }
    bVar2 = *(byte *)(param_1 + 0x48);
    if ((bVar2 & 6) == 0) {
        if ((bVar2 & 0x10) == 0) {
            if ((bVar2 & 8) == 0) {
                if (*(int *)(param_1 + 0x134) == 0) {
                    cVar3 = *(char *)(param_1 + 0x12a);
                    cVar1 = cVar3 << 1;
                    iVar8 = *(int *)(param_1 + 0x2c4) + 1;
                    *(int *)(param_1 + 0x2c4) = iVar8;
                    iVar9 = current_time;
                    *(char *)(param_1 + 0x12a) = cVar1;
                    *(int *)(param_1 + 0x2cc) = iVar9;
                    cVar4 = sys_poll;
                    if (cVar1 != '\0') {
                        uVar7 = *(uint *)(param_1 + 0x44) & 0x40;
                        cVar11 = cVar4;
                        if ((*(uint *)(param_1 + 0x44) & 2) == 0) {
                            *(undefined4 *)(param_1 + 0x2c4) = 0;
                            if (uVar7 == 0)
                                goto LAB_00046514;
                        LAB_000466e8:
                            if (*(int *)(param_1 + 0x138) == 0) {
                                iVar9 = FUN_00042fe4(param_1);
                                goto joined_r0x00046870;
                            }
                            goto LAB_000466f4;
                        }
                        if (uVar7 != 0)
                            goto LAB_000466e8;
                    LAB_000466f8:
                        if (9 < iVar8) {
                        LAB_00046700:
                            cVar11 = cVar11 + '\x01';
                            if (((*(uint *)(param_1 + 0x44) & 3) == 0) ||
                                ((((*(uint *)(param_1 + 0x44) & 2) != 0 &&
                                   (sys_maxclock < peer_associations)) &&
                                  (iVar9 = FUN_00041dac(param_1),
                                   iVar9 != 0)))) {
                                FUN_00035ee0(0x85, param_1, "timeout");
                                FUN_00046214(param_1, "TIME");
                                if (local_24 == __stack_chk_guard) {
                                    FUN_00041fc4(param_1);
                                    return;
                                }
                                goto LAB_000468a0;
                            }
                        }
                        goto LAB_00046514;
                    }
                    FUN_00045528(0, param_1);
                    if (cVar3 != '\0') {
                        FUN_00042fe4(param_1);
                        FUN_00035ee0(0x83, param_1, 0);
                    }
                    if ((*(uint *)(param_1 + 0x44) & 0x100) == 0) {
                    LAB_000466f4:
                        iVar8 = *(int *)(param_1 + 0x2c4);
                        goto LAB_000466f8;
                    }
                    iVar9 = *(int *)(param_1 + 0x138);
                joined_r0x00046870:
                    if (iVar9 != 0)
                        goto LAB_000466f4;
                    *(undefined4 *)(param_1 + 0x138) = 3;
                    if (9 < *(int *)(param_1 + 0x2c4))
                        goto LAB_00046700;
                    iVar9 = *(int *)(param_1 + 0x138);
                LAB_00046520:
                    *(int *)(param_1 + 0x138) = iVar9 + -1;
                } else {
                    iVar9 = *(int *)(param_1 + 0x134) + -1;
                    *(int *)(param_1 + 0x134) = iVar9;
                    if (((iVar9 == 0) && (mode_ntpdate != 0)) &&
                        (peer_ntpdate = peer_ntpdate + -1, peer_ntpdate == 0)) {
                        FUN_00074e00(5, "ntpd: no servers found");
                        if (msyslog_term == 0) {
                            puts("ntpd: no servers found");
                        }
                        /* WARNING: Subroutine does not return */
                        exit(0);
                    }
                LAB_00046514:
                    iVar9 = *(int *)(param_1 + 0x138);
                    if (0 < iVar9)
                        goto LAB_00046520;
                }
                FUN_00044264(param_1, cVar11);
                if (*(char *)(param_1 + 0x3f) != '\x06')
                    goto LAB_00046540;
            } else {
                *(int *)(param_1 + 0x2cc) = current_time;
                FUN_00044264(param_1, cVar11);
                if ((peer_associations == sys_maxclock * 2 ||
                     peer_associations + sys_maxclock * -2 < 0 !=
                         SBORROW4(peer_associations, sys_maxclock * 2)) &&
                    ((peer_associations < sys_maxclock ||
                      (sys_survivors < sys_minclock)))) {
                    if (local_24 == __stack_chk_guard) {
                        iVar9 = *(int *)(param_1 + 0x34);
                        if (iVar9 != 0) {
                            unaff_r7 = 0;
                        }
                        local_2c = __stack_chk_guard;
                        if (iVar9 != 0) {
                            do {
                                uVar10 = *(undefined4 *)(iVar9 + 0x14);
                                *(undefined4 *)(param_1 + 0x34) =
                                    *(undefined4 *)(iVar9 + 0x1c);
                                iVar9 = FUN_00041a44(uVar10, 0, 0, 3, unaff_r7,
                                                     unaff_r7);
                                if (iVar9 == 0) {
                                    FUN_00050054(uVar10, local_898);
                                    if ((local_898[0] & 0x7f) != 0) {
                                        FUN_00050824(uVar10, 0,
                                                     current_time + 9);
                                    }
                                    uVar5 = FUN_000278f8(uVar10);
                                    memset(&local_874, 0, 0x848);
                                    local_872 = *(undefined1 *)(param_1 + 0x40);
                                    local_874 = (*(byte *)(param_1 + 0x3e) & 7)
                                                    << 3 |
                                                sys_leap << 6 | 3;
                                    local_873 = sys_stratum;
                                    if (sys_stratum == '\x10') {
                                        local_873 = '\0';
                                    }
                                    local_871 = sys_precision;
                                    local_868 = sys_refid;
                                    uVar7 = (uint)(longlong)(sys_rootdelay *
                                                             65536.0);
                                    local_870 = uVar7 << 0x18 |
                                                (uVar7 >> 8 & 0xff) << 0x10 |
                                                (uVar7 >> 0x10 & 0xff) << 8 |
                                                uVar7 >> 0x18;
                                    uVar7 =
                                        (uint)(0.0 < sys_rootdisp * 65536.0) *
                                        (int)(longlong)(sys_rootdisp * 65536.0);
                                    local_86c = uVar7 * 0x1000000 |
                                                (uVar7 >> 8 & 0xff) << 0x10 |
                                                (uVar7 >> 0x10 & 0xff) << 8 |
                                                uVar7 >> 0x18;
                                    local_864 =
                                        (uint)sys_reftime << 0x18 |
                                        ((uint)sys_reftime >> 8 & 0xff)
                                            << 0x10 |
                                        ((uint)sys_reftime >> 0x10 & 0xff)
                                            << 8 |
                                        (uint)sys_reftime >> 0x18;
                                    uStack_860 =
                                        sys_reftime._4_4_ << 0x18 |
                                        (sys_reftime._4_4_ >> 8 & 0xff)
                                            << 0x10 |
                                        (sys_reftime._4_4_ >> 0x10 & 0xff)
                                            << 8 |
                                        sys_reftime._4_4_ >> 0x18;
                                    FUN_0006f724(&local_894);
                                    local_84c =
                                        local_894 << 0x18 |
                                        (local_894 >> 8 & 0xff) << 0x10 |
                                        (local_894 >> 0x10 & 0xff) << 8 |
                                        local_894 >> 0x18;
                                    local_848 =
                                        local_890 << 0x18 |
                                        (local_890 >> 8 & 0xff) << 0x10 |
                                        (local_890 >> 0x10 & 0xff) << 8 |
                                        local_890 >> 0x18;
                                    *(uint *)(param_1 + 0x248) = local_894;
                                    *(uint *)(param_1 + 0x24c) = local_890;
                                    uVar7 = *(uint *)(param_1 + 0x4c);
                                    if (sys_ttlmax <=
                                        *(uint *)(param_1 + 0x4c)) {
                                        uVar7 = sys_ttlmax;
                                    }
                                    FUN_00026a68(
                                        uVar10, uVar5,
                                        *(undefined1 *)((int)&sys_ttl + uVar7),
                                        &local_874, 0x30);
                                    *(int *)(param_1 + 0x2e4) =
                                        *(int *)(param_1 + 0x2e4) + 1;
                                    *(int *)(param_1 + 0x2c8) =
                                        *(int *)(param_1 + 0x2c8) +
                                        (1 << *(sbyte *)(param_1 + 0x41)) + -2;
                                    uVar10 = FUN_0007c2e8(uVar10);
                                    FUN_00074e00(6, "Soliciting pool server %s",
                                                 uVar10);
                                    break;
                                }
                                iVar9 = *(int *)(param_1 + 0x34);
                            } while (iVar9 != 0);
                        } else {
                            if (*(void **)(param_1 + 0x30) != (void *)0x0) {
                                free(*(void **)(param_1 + 0x30));
                                *(undefined4 *)(param_1 + 0x30) = 0;
                            }
                            pvVar6 = memset(&local_894, 0, 0x20);
                            local_890 = (uint) * (ushort *)(param_1 + 0x10);
                            local_888 = 0x11;
                            local_88c = 2;
                            iVar9 = FUN_00078520(
                                *(undefined4 *)(param_1 + 0x2c), &DAT_0009ce60,
                                pvVar6, 0, pool_name_resolved,
                                *(undefined2 *)(param_1 + 0x3c));
                            if (iVar9 != 0) {
                                FUN_00074e00(3,
                                             "unable to start pool DNS %s: %m",
                                             *(undefined4 *)(param_1 + 0x2c));
                            }
                        }
                        if (local_2c != __stack_chk_guard) {
                            /* WARNING: Subroutine does not return */
                            __stack_chk_fail();
                        }
                        return;
                    }
                    goto LAB_000468a0;
                }
            }
        } else {
            *(int *)(param_1 + 0x2cc) = current_time;
            FUN_00044264(param_1, cVar11);
            iVar9 = *(int *)(param_1 + 0x2c4);
            if (sys_beacon < iVar9) {
                *(uint *)(param_1 + 0x2c4) = bVar2 & 6;
                *(uint *)(param_1 + 0x4c) = bVar2 & 6;
                FUN_000439f8(param_1);
                iVar9 = *(int *)(param_1 + 0x2c4);
            } else if ((sys_survivors < sys_minclock) ||
                       (peer_associations < sys_maxclock)) {
                if (*(uint *)(param_1 + 0x4c) < sys_ttlmax) {
                    *(uint *)(param_1 + 0x4c) = *(uint *)(param_1 + 0x4c) + 1;
                }
                FUN_000439f8(param_1);
                *(int *)(param_1 + 0x2c4) = *(int *)(param_1 + 0x2c4) + 1;
                goto LAB_00046604;
            }
            *(int *)(param_1 + 0x2c4) = iVar9 + 1;
        }
    LAB_00046604:
        if (local_24 == __stack_chk_guard) {
            return;
        }
    } else {
        *(int *)(param_1 + 0x2cc) = current_time;
        FUN_00044264(param_1, cVar11);
        if (sys_leap == '\x03')
            goto LAB_00046604;
    LAB_00046540:
        if (local_24 == __stack_chk_guard) {
            FUN_000439f8(param_1);
            return;
        }
    }
LAB_000468a0:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00048678 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void receive(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    undefined4 uVar4;
    uint uVar5;
    int iVar6;
    int iVar7;
    byte bVar8;
    uint uVar9;
    int iVar10;
    uint uVar11;
    uint uVar12;
    uint uVar13;
    uint *puVar14;
    uint uVar15;
    uint uVar16;
    int iVar17;
    bool bVar18;
    double dVar19;
    uint local_190;
    uint local_188;
    uint local_184;
    int local_17c;
    uint local_178;
    int local_174;
    char *local_16c;
    uint local_168;
    uint local_158;
    ushort local_150;
    short local_14e;
    int local_14c;
    uint local_148;
    uint local_144;
    uint local_140;
    uint local_13c;
    uint local_138;
    uint local_134;
    char acStack_130[260];
    int local_2c;

    local_14c = 0;
    local_2c = __stack_chk_guard;
    sys_received = sys_received + 1;
    if (*(short *)(param_1 + 6) == 0)
        goto LAB_0004693c;
    iVar17 = param_1 + 4;
    FUN_00050054(iVar17, &local_150);
    uVar15 = (uint) * (byte *)(param_1 + 0x59);
    uVar12 = (uint)local_150;
    if (uVar15 == 0) {
        uVar15 = 0x10;
    }
    if ((local_150 & 1) == 0) {
        bVar8 = *(byte *)(param_1 + 0x58);
        local_190 = bVar8 & 7;
        if (local_190 == 7) {
            if ((ntp_mode7 != 0) && ((local_150 & 0x80) == 0)) {
                FUN_0004f4e4(param_1, ((uVar12 ^ 0x100) << 0x17) >> 0x1f);
                goto LAB_00046950;
            }
        } else if (local_190 == 6) {
            if ((local_150 & 0x80) == 0) {
                FUN_00033110(param_1, uVar12);
                goto LAB_00046950;
            }
        } else if (((local_150 & 2) == 0) &&
                   (((local_150 & 0x2000) == 0 ||
                     (iVar6 = FUN_00078ae4(),
                      0.1 <= (double)(longlong)iVar6 / 2147483647.0)))) {
            uVar9 = ((uint)bVar8 << 0x1a) >> 0x1d;
            if (uVar9 == 4) {
                sys_newversion = sys_newversion + 1;
                if ((bVar8 & 7) != 0)
                    goto LAB_00046a2c;
            } else {
                uVar5 = uVar9;
                if (uVar9 != 0) {
                    uVar5 = 1;
                }
                if ((uVar5 & (uVar12 ^ 8) >> 3) != 0) {
                    sys_oldversion = sys_oldversion + 1;
                    if ((bVar8 & 7) == 0) {
                        if (uVar9 != 1)
                            goto LAB_0004693c;
                        local_190 = 3;
                    }
                LAB_00046a2c:
                    iVar10 = *(int *)(param_1 + 0x54);
                    iVar6 = param_1 + 0x58;
                    local_184 = iVar10 - 0x30;
                    if ((int)local_184 < 1) {
                        uVar9 = 0x30;
                        local_16c = (char *)0x0;
                        local_158 = 0;
                    LAB_00046d08:
                        if (local_184 != 0)
                            goto LAB_0004693c;
                        if ((local_150 & 4) != 0)
                            goto LAB_00046c30;
                        local_188 = local_184;
                        local_178 = 1;
                    } else {
                        uVar9 = local_184 & 3;
                        if (uVar9 != 0) {
                            uVar9 = 1;
                        }
                        if ((int)local_184 < 4) {
                            uVar9 = uVar9 | 1;
                        }
                        if (uVar9 != 0)
                            goto LAB_0004693c;
                        local_16c = (char *)0x0;
                        if ((int)local_184 < 0x19) {
                            uVar5 = 0x30;
                            local_158 = 0;
                            uVar9 = uVar5;
                        } else {
                            uVar9 = 0x30;
                            do {
                                uVar5 = uVar9 + 3;
                                if (-1 < (int)uVar9) {
                                    uVar5 = uVar9;
                                }
                                uVar11 = *(uint *)(param_1 + 0x58 +
                                                   ((int)uVar5 >> 2) * 4);
                                iVar3 = param_1 + 0x58 + ((int)uVar5 >> 2) * 4;
                                uVar5 = (uVar11 >> 8 & 0xff) << 0x10;
                                local_158 = uVar11 << 0x18 | uVar5;
                                uVar13 = uVar11 >> 0x18 & 3;
                                uVar16 = (uVar11 >> 0x10 & 0xff) << 8 |
                                         uVar11 >> 0x18;
                                if (uVar13 != 0) {
                                    uVar13 = 1;
                                }
                                if (uVar16 < 4) {
                                    uVar13 = uVar13 | 1;
                                }
                                if ((uVar13 != 0) || (uVar9 = uVar16 + uVar9,
                                                      iVar10 < (int)uVar9))
                                    goto LAB_0004693c;
                                if (((uVar11 << 0x18 & 0x3fff0000 | uVar5) ==
                                     0x2010000) &&
                                    (sys_groupname != 0)) {
                                    uVar5 = *(uint *)(iVar3 + 0x10);
                                    uVar5 = uVar5 << 0x18 |
                                            (uVar5 >> 8 & 0xff) << 0x10 |
                                            (uVar5 >> 0x10 & 0xff) << 8 |
                                            uVar5 >> 0x18;
                                    if ((0x100 < uVar5) ||
                                        (uVar16 - 0x14 < uVar5))
                                        goto LAB_0004693c;
                                    __memcpy_chk(acStack_130, iVar3 + 0x14,
                                                 uVar5, 0x101);
                                    acStack_130[uVar5] = '\0';
                                    local_16c = strchr(acStack_130, 0x40);
                                    if (local_16c == (char *)0x0)
                                        goto switchD_00046f7c_default;
                                    local_16c = local_16c + 1;
                                }
                                local_184 = local_184 - uVar16;
                                if ((int)local_184 < 1)
                                    goto LAB_00046d08;
                                uVar5 = local_184 & 3;
                                if (uVar5 != 0) {
                                    uVar5 = 1;
                                }
                                if ((int)local_184 < 4) {
                                    uVar5 = uVar5 | 1;
                                }
                                if (uVar5 != 0)
                                    goto LAB_0004693c;
                            } while (0x18 < (int)local_184);
                            uVar5 = uVar9 + 3;
                            if (-1 < (int)uVar9) {
                                uVar5 = uVar9;
                            }
                            uVar5 = uVar5 & 0xfffffffc;
                        }
                        uVar5 = *(uint *)(iVar6 + uVar5);
                        local_188 = uVar5 << 0x18 |
                                    (uVar5 >> 8 & 0xff) << 0x10 |
                                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                        local_178 = (uint)(local_184 == 0);
                    }
                    uVar12 = FUN_00040ff4(param_1, uVar12);
                    if ((uVar12 & 0x40) != 0) {
                        sys_limitrejected = sys_limitrejected + 1;
                        if (((uVar12 & 0x800) != 0) && (1 < local_190 - 4)) {
                            if (local_190 == 3) {
                                uVar4 = 4;
                            } else {
                                uVar4 = 1;
                            }
                            FUN_0001c170(param_1, uVar4, local_188, uVar12);
                        }
                        goto LAB_00046950;
                    }
                    iVar3 = FUN_00042ca0(param_1, local_190, &local_14c);
                    uVar13 = *(uint *)(param_1 + 0x70);
                    uVar5 = *(uint *)(param_1 + 0x7c);
                    uVar16 = *(uint *)(param_1 + 0x74);
                    local_148 = uVar13 << 0x18 | (uVar13 >> 8 & 0xff) << 0x10 |
                                (uVar13 >> 0x10 & 0xff) << 8 | uVar13 >> 0x18;
                    uVar11 = *(uint *)(param_1 + 0x78);
                    local_13c = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                                (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                    uVar5 = *(uint *)(param_1 + 0x80);
                    local_144 = uVar16 << 0x18 | (uVar16 >> 8 & 0xff) << 0x10 |
                                (uVar16 >> 0x10 & 0xff) << 8 | uVar16 >> 0x18;
                    uVar13 = *(uint *)(param_1 + 0x84);
                    local_140 = uVar11 << 0x18 | (uVar11 >> 8 & 0xff) << 0x10 |
                                (uVar11 >> 0x10 & 0xff) << 8 | uVar11 >> 0x18;
                    local_138 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                                (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                    local_134 = uVar13 << 0x18 | (uVar13 >> 8 & 0xff) << 0x10 |
                                (uVar13 >> 0x10 & 0xff) << 8 | uVar13 >> 0x18;
                    local_174 = *(int *)(param_1 + 0x3c) + 0x18;
                    uVar4 = FUN_00074648(local_190);
                    FUN_000437e4(local_14c);
                    iVar10 = FUN_000436ec(iVar3, param_1, local_190);
                    if (iVar10 == 1) {
                        FUN_00035ee0(0x8c, iVar3, "Invalid_NAK");
                        if (iVar3 != 0) {
                            *(int *)(iVar3 + 0x2f4) =
                                *(int *)(iVar3 + 0x2f4) + 1;
                        }
                        uVar12 = current_time;
                        uVar4 = FUN_0007c2e8(local_174);
                        FUN_0007c2e8(iVar17);
                        FUN_00074e00(3, "Invalid-NAK error at %ld %s<-%s",
                                     uVar12, uVar4);
                        goto LAB_00046950;
                    }
                    if (local_178 == 0) {
                        if (iVar10 == 2) {
                            local_168 = local_178;
                            uVar9 = 3;
                            goto LAB_00046f20;
                        }
                        if (crypto_flags == 0 || 0xffff >= local_188) {
                            local_168 = local_178;
                        LAB_00046ee4:
                            iVar1 = FUN_00072854(local_188, iVar6, uVar9,
                                                 local_184);
                            if (iVar1 == 0) {
                                uVar9 = 2;
                            } else {
                                uVar9 = 1;
                            }
                            if (crypto_flags != 0 && 0xffff < local_188) {
                                FUN_000721bc(local_188, 0);
                            }
                            goto LAB_00046f20;
                        }
                        if (0x13 < (int)local_184) {
                            if (local_190 == 5) {
                                iVar7 = *(int *)(param_1 + 0x3c);
                                iVar1 = any_interface;
                                if (*(short *)(param_1 + 4) != 2) {
                                    iVar1 = any6_interface;
                                }
                                if (iVar7 == iVar1)
                                    goto LAB_00046c30;
                                if (*(short *)(iVar7 + 0x50) == 2) {
                                    uVar5 = *(uint *)(iVar7 + 0x54);
                                    if (uVar5 != 0) {
                                        uVar5 = 1;
                                    }
                                } else {
                                    if (*(int *)(iVar7 + 0x58) == 0) {
                                        if (*(int *)(iVar7 + 0x5c) == 0) {
                                            uVar5 = 0;
                                            if (*(int *)(iVar7 + 0x60) == 0) {
                                                uVar5 =
                                                    (uint)(*(int *)(iVar7 +
                                                                    100) == 0);
                                            }
                                        } else {
                                            uVar5 = 0;
                                        }
                                    } else {
                                        uVar5 = 0;
                                    }
                                    uVar5 = uVar5 ^ 1;
                                }
                                if (uVar5 == 0) {
                                    local_178 = 0;
                                } else {
                                    local_174 = iVar7 + 0x50;
                                    local_178 = 0;
                                }
                            } else {
                                if (iVar3 == 0) {
                                    local_178 = FUN_000372c8(iVar17, local_174,
                                                             0, sys_private);
                                } else {
                                    local_178 = *(uint *)(iVar3 + 0xa8);
                                }
                                bVar18 = local_178 != 0;
                                uVar5 = local_178;
                                if (bVar18) {
                                    uVar5 = uVar9 - 0x30;
                                }
                                if ((bVar18 && uVar9 != 0x30) &&
                                    (int)uVar5 < 0 ==
                                        (bVar18 && SBORROW4(uVar9, 0x30))) {
                                    FUN_000372c8(iVar17, local_174, local_188,
                                                 0);
                                }
                            }
                            local_168 = FUN_000372c8(iVar17, local_174,
                                                     local_188, local_178);
                            goto LAB_00046ee4;
                        }
                        goto LAB_00047498;
                    }
                    uVar9 = 0;
                    local_178 = 0;
                    local_168 = 0;
                LAB_00046f20:
                    iVar1 = local_14c;
                    if (((iVar3 == 0) || (*(uint *)(iVar3 + 0x7c) == 0)) ||
                        ((*(uint *)(iVar3 + 0x7c) == local_188 &&
                          (uVar9 == 1 || local_184 == 0)))) {
                        uVar5 = uVar12 & 0xe7ff;
                        bVar8 = bVar8 >> 6;
                        switch (local_14c) {
                        case 1:
                            iVar7 = FUN_0001c534(local_16c,
                                                 *(undefined4 *)(iVar3 + 0x50));
                            if (iVar7 == 0) {
                                if (local_190 == 5) {
                                    uVar13 = (uint) * (byte *)(param_1 + 0x5a);
                                    if (uVar13 != *(byte *)(iVar3 + 0x5e)) {
                                        uVar2 = FUN_0007c2e8(iVar17);
                                        FUN_00074e00(
                                            6,
                                            "receive: broadcast poll from %s "
                                            "changed from %u to %u",
                                            uVar2,
                                            *(undefined1 *)(iVar3 + 0x5e));
                                        uVar13 =
                                            (uint) * (byte *)(param_1 + 0x5a);
                                    }
                                    if ((uVar13 < *(byte *)(iVar3 + 0x41)) ||
                                        (local_17c = 0,
                                         *(byte *)(iVar3 + 0x42) < uVar13)) {
                                        local_17c = iVar1;
                                        uVar2 = FUN_0007c2e8(iVar17);
                                        FUN_00074e00(6,
                                                     "receive: broadcast poll "
                                                     "of %u from %s is "
                                                     "out-of-range (%d to %d)!",
                                                     uVar13, uVar2);
                                        uVar13 =
                                            (uint) * (byte *)(param_1 + 0x5a);
                                    }
                                    uVar13 = 1 << uVar13;
                                    if ((*(uint *)(iVar3 + 0x44) & 0x10) != 0) {
                                        uVar13 = uVar13 - 3;
                                    }
                                    if (current_time - *(int *)(iVar3 + 0x2dc) <
                                        uVar13) {
                                        local_17c = local_17c + 1;
                                        uVar2 = FUN_0007c2e8(iVar17);
                                        FUN_00074e00(
                                            6,
                                            "receive: broadcast packet from %s "
                                            "arrived after %lu, not %lu "
                                            "seconds!",
                                            uVar2,
                                            current_time -
                                                *(int *)(iVar3 + 0x2dc));
                                    }
                                    if (sys_bcpollbstep == 0) {
                                        uVar13 = 0;
                                    } else {
                                        uVar13 =
                                            ((uint)sys_bcpollbstep
                                             << *(sbyte *)(param_1 + 0x5a)) +
                                            2;
                                    }
                                    if (*(int *)(iVar3 + 600) == 0 &&
                                        *(uint *)(iVar3 + 0x25c) == 0) {
                                    LAB_000483b8:
                                        if (local_17c == 0)
                                            goto LAB_00047478;
                                    } else {
                                        iVar1 =
                                            local_138 - *(int *)(iVar3 + 600);
                                        if (local_134 <
                                            *(uint *)(iVar3 + 0x25c)) {
                                            iVar1 = iVar1 + -1;
                                        }
                                        if ((-1 < iVar1) ||
                                            (uVar13 <=
                                             current_time -
                                                 *(int *)(iVar3 + 0x2dc)))
                                            goto LAB_000483b8;
                                        uVar4 = FUN_0007c2e8(iVar17);
                                        FUN_00074e00(
                                            6,
                                            "receive: broadcast packet from %s "
                                            "contains non-monotonic timestamp: "
                                            "%#010x.%08x -> %#010x.%08x",
                                            uVar4,
                                            *(undefined4 *)(iVar3 + 600));
                                    }
                                    *(uint *)(iVar3 + 0x2d8) = current_time;
                                    sys_declined = sys_declined + 1;
                                    goto LAB_00046950;
                                }
                            LAB_00047478:
                                uVar13 = *(uint *)(iVar3 + 0x44);
                                if (uVar9 != 3) {
                                    if ((uVar13 & 0x800) == 0) {
                                        if (0xffff < local_188)
                                            goto LAB_00047498;
                                    } else if (local_188 < 0x10000) {
                                    LAB_00047498:
                                        sys_badauth = sys_badauth + 1;
                                        goto LAB_00046950;
                                    }
                                }
                                bVar18 = (uVar13 & 0x4000) != 0;
                                if (bVar18) {
                                    *(uint *)(iVar3 + 0x44) =
                                        uVar13 & 0xffffbfff;
                                }
                                uVar13 = *(uint *)(iVar3 + 300) & 0xfffffe00;
                                *(uint *)(iVar3 + 300) = uVar13;
                                if (bVar18) {
                                    *(uint *)(iVar3 + 300) = uVar13 | 4;
                                }
                                *(int *)(iVar3 + 0x2e8) =
                                    *(int *)(iVar3 + 0x2e8) + 1;
                                iVar1 = FUN_0004362c(
                                    bVar8, uVar15, local_190,
                                    *(undefined4 *)(param_1 + 100));
                                uVar11 = local_144;
                                uVar13 = local_148;
                                if (local_138 == 0 && local_134 == 0) {
                                    *(uint *)(iVar3 + 300) =
                                        *(uint *)(iVar3 + 300) | 4;
                                    if (iVar1 != 0) {
                                        *(int *)(iVar3 + 0x2f8) =
                                            *(int *)(iVar3 + 0x2f8) + 1;
                                        uVar4 = FUN_0007c2e8(iVar3 + 0x10);
                                        FUN_00074e00(
                                            6,
                                            "receive: Unexpected zero transmit "
                                            "timestamp in KoD from %s",
                                            uVar4);
                                        goto LAB_00046950;
                                    }
                                } else {
                                    if ((local_138 ==
                                         *(uint *)(iVar3 + 0x238)) &&
                                        (local_134 ==
                                         *(uint *)(iVar3 + 0x23c))) {
                                        *(uint *)(iVar3 + 300) =
                                            *(uint *)(iVar3 + 300) | 1;
                                        *(int *)(iVar3 + 0x2fc) =
                                            *(int *)(iVar3 + 0x2fc) + 1;
                                        goto LAB_00046950;
                                    }
                                    if (local_190 == 5) {
                                        if (0xf < uVar15) {
                                            uVar4 = FUN_0007c2e8(iVar3 + 0x10);
                                            FUN_00074e00(
                                                6,
                                                "receive: Unexpected stratum "
                                                "(%d) in broadcast from %s",
                                                uVar15, uVar4);
                                            goto LAB_00046950;
                                        }
                                    } else if (iVar1 == 0) {
                                        if (*(int *)(iVar3 + 0x13c) == 0) {
                                            if (local_148 == 0 &&
                                                local_144 == 0) {
                                                *(int *)(iVar3 + 0x2f8) =
                                                    *(int *)(iVar3 + 0x2f8) + 1;
                                                *(uint *)(iVar3 + 300) =
                                                    *(uint *)(iVar3 + 300) | 2;
                                                FUN_0007c2e8(iVar3 + 0x10);
                                                FUN_00074e00(
                                                    6,
                                                    "receive: %s 0 origin "
                                                    "timestamp from %s@%s xmt "
                                                    "%#010x.%08x",
                                                    &DAT_000a63b8, uVar4);
                                            } else if ((*(uint *)(iVar3 +
                                                                  0x248) ==
                                                        local_148) &&
                                                       (*(uint *)(iVar3 +
                                                                  0x24c) ==
                                                        local_144)) {
                                                *(undefined4 *)(iVar3 + 0x24c) =
                                                    0;
                                                *(undefined4 *)(iVar3 + 0x248) =
                                                    0;
                                            } else {
                                                uVar15 =
                                                    *(uint *)(param_1 + 0x70);
                                                uVar13 =
                                                    *(uint *)(param_1 + 0x74);
                                                *(int *)(iVar3 + 0x2f8) =
                                                    *(int *)(iVar3 + 0x2f8) + 1;
                                                *(uint *)(iVar3 + 300) =
                                                    *(uint *)(iVar3 + 300) | 2;
                                                FUN_0007c2e8(iVar3 + 0x10);
                                                FUN_00074e00(
                                                    6,
                                                    "receive: Unexpected "
                                                    "origin timestamp "
                                                    "%#010x.%08x does not "
                                                    "match aorg %#010x.%08x "
                                                    "from %s@%s xmt "
                                                    "%#010x.%08x",
                                                    uVar15 << 0x18 |
                                                        (uVar15 >> 8 & 0xff)
                                                            << 0x10 |
                                                        (uVar15 >> 0x10 & 0xff)
                                                            << 8 |
                                                        uVar15 >> 0x18,
                                                    uVar13 << 0x18 |
                                                        (uVar13 >> 8 & 0xff)
                                                            << 0x10 |
                                                        (uVar13 >> 0x10 & 0xff)
                                                            << 8 |
                                                        uVar13 >> 0x18);
                                                if ((*(uint *)(iVar3 + 0x240) !=
                                                         0 ||
                                                     *(uint *)(iVar3 + 0x244) !=
                                                         0) &&
                                                    ((*(uint *)(iVar3 +
                                                                0x240) ==
                                                          local_148 &&
                                                      (*(uint *)(iVar3 +
                                                                 0x244) ==
                                                       local_144)))) {
                                                    if (dynamic_interleave ==
                                                        0) {
                                                        uVar2 = FUN_0007c2e8(
                                                            iVar3 + 0x10);
                                                        FUN_00074e00(
                                                            6,
                                                            "receive: Dynamic "
                                                            "interleave from "
                                                            "%s@%s denied",
                                                            uVar4, uVar2);
                                                    } else {
                                                        *(undefined4 *)(iVar3 +
                                                                        0x13c) =
                                                            1;
                                                        FUN_00035ee0(0x8e,
                                                                     iVar3, 0);
                                                    }
                                                }
                                            }
                                        } else {
                                            if ((local_148 != 0 ||
                                                 local_144 != 0) &&
                                                (local_140 != 0 ||
                                                 local_13c != 0)) {
                                                if (*(uint *)(iVar3 + 0x240) !=
                                                        0 ||
                                                    *(uint *)(iVar3 + 0x244) !=
                                                        0) {
                                                    if (*(uint *)(iVar3 +
                                                                  0x240) !=
                                                            local_148 ||
                                                        *(uint *)(iVar3 +
                                                                  0x244) !=
                                                            local_144) {
                                                        *(int *)(iVar3 +
                                                                 0x2f8) =
                                                            *(int *)(iVar3 +
                                                                     0x2f8) +
                                                            1;
                                                        *(uint *)(iVar3 +
                                                                  0x44) =
                                                            *(uint *)(iVar3 +
                                                                      0x44) |
                                                            0x4000;
                                                        *(uint *)(iVar3 + 300) =
                                                            *(uint *)(iVar3 +
                                                                      300) |
                                                            2;
                                                    }
                                                    goto LAB_00047524;
                                                }
                                            }
                                            *(uint *)(iVar3 + 300) =
                                                *(uint *)(iVar3 + 300) | 4;
                                        }
                                    } else {
                                        if ((local_148 == 0 &&
                                             local_144 == 0) ||
                                            (local_140 == 0 &&
                                             local_13c == 0)) {
                                            *(int *)(iVar3 + 0x2f8) =
                                                *(int *)(iVar3 + 0x2f8) + 1;
                                            uVar4 = FUN_0007c2e8(iVar3 + 0x10);
                                            FUN_00074e00(
                                                6,
                                                "receive: KoD packet from %s "
                                                "has a zero org or rec "
                                                "timestamp.  Ignoring.",
                                                uVar4);
                                            goto LAB_00046950;
                                        }
                                        if (local_134 != local_13c ||
                                            (local_138 != local_140 ||
                                             (local_138 != local_148 ||
                                              local_134 != local_144))) {
                                            *(int *)(iVar3 + 0x2f8) =
                                                *(int *)(iVar3 + 0x2f8) + 1;
                                            uVar4 = FUN_0007c2e8(iVar3 + 0x10);
                                            FUN_00074e00(
                                                6,
                                                "receive: KoD packet from %s "
                                                "has inconsistent xmt/org/rec "
                                                "timestamps.  Ignoring.",
                                                uVar4);
                                            goto LAB_00046950;
                                        }
                                        if (*(int *)(iVar3 + 0x13c) == 0) {
                                            if ((*(uint *)(iVar3 + 0x248) !=
                                                 local_148) ||
                                                (*(uint *)(iVar3 + 0x24c) !=
                                                 local_144)) {
                                                *(int *)(iVar3 + 0x2f8) =
                                                    *(int *)(iVar3 + 0x2f8) + 1;
                                                FUN_0007c2e8(iVar3 + 0x10);
                                                FUN_00074e00(
                                                    6,
                                                    "receive: flip 0 KoD "
                                                    "origin timestamp "
                                                    "%#010x.%08x from %s does "
                                                    "not match %#010x.%08x - "
                                                    "ignoring.",
                                                    uVar13, uVar11);
                                                goto LAB_00046950;
                                            }
                                        } else if ((*(int *)(iVar3 + 0x13c) ==
                                                    1) &&
                                                   ((*(uint *)(iVar3 + 0x250) !=
                                                         local_148 ||
                                                     (*(uint *)(iVar3 +
                                                                0x254) !=
                                                      local_144)))) {
                                            *(int *)(iVar3 + 0x2f8) =
                                                *(int *)(iVar3 + 0x2f8) + 1;
                                            FUN_0007c2e8(iVar3 + 0x10);
                                            FUN_00074e00(
                                                6,
                                                "receive: flip 1 KoD origin "
                                                "timestamp %#010x.%08x from %s "
                                                "does not match interleave "
                                                "%#010x.%08x - ignoring.",
                                                uVar13, uVar11);
                                            goto LAB_00046950;
                                        }
                                    }
                                }
                            LAB_00047524:
                                if (iVar10 == 2) {
                                    FUN_00035ee0(0x8c, iVar3, "crypto_NAK");
                                    *(uint *)(iVar3 + 300) =
                                        *(uint *)(iVar3 + 300) | 0x10;
                                    *(int *)(iVar3 + 0x2f0) =
                                        *(int *)(iVar3 + 0x2f0) + 1;
                                    iVar17 = unpeer_crypto_nak_early;
                                    if ((*(uint *)(iVar3 + 0x44) & 2) == 0) {
                                        if (*(int *)(iVar3 + 0x88) != 0) {
                                            FUN_00046214(iVar3, &DAT_000a64a4);
                                        }
                                        goto LAB_00046950;
                                    }
                                } else {
                                    if ((local_184 == 0 &&
                                         *(int *)(iVar3 + 0x7c) == 0) &&
                                        ((uVar12 & 4) == 0)) {
                                        uVar12 = (uint)(1 < uVar9);
                                    } else {
                                        uVar12 = uVar9 - 1;
                                        if (uVar12 != 0) {
                                            uVar12 = 1;
                                        }
                                    }
                                    if (uVar12 == 0) {
                                        if (local_190 == 5) {
                                            if (uVar9 < 2) {
                                                uVar12 =
                                                    *(uint *)(iVar3 + 0x44) &
                                                    0x2000;
                                                if (local_148 == 0 &&
                                                    local_144 == 0) {
                                                    if (uVar12 != 0) {
                                                        uVar4 = FUN_0007c2e8(
                                                            iVar3 + 0x10);
                                                        FUN_00074e00(
                                                            6,
                                                            "receive: "
                                                            "Broadcast server "
                                                            "at %s is no "
                                                            "longer in "
                                                            "interleave mode",
                                                            uVar4);
                                                        *(uint *)(iVar3 +
                                                                  0x44) =
                                                            *(uint *)(iVar3 +
                                                                      0x44) &
                                                            0xffffdfff;
                                                    }
                                                } else if (uVar12 == 0) {
                                                    uVar4 = FUN_0007c2e8(iVar3 +
                                                                         0x10);
                                                    FUN_00074e00(
                                                        6,
                                                        "receive: Broadcast "
                                                        "server at %s is in "
                                                        "interleave mode",
                                                        uVar4);
                                                    *(uint *)(iVar3 + 0x44) =
                                                        *(uint *)(iVar3 +
                                                                  0x44) |
                                                        0x2000;
                                                    *(uint *)(iVar3 + 0x248) =
                                                        local_138;
                                                    *(uint *)(iVar3 + 0x24c) =
                                                        local_134;
                                                    uVar4 = *(
                                                        undefined4 *)(param_1 +
                                                                      0x4c);
                                                    *(undefined4 *)(iVar3 +
                                                                    0x250) =
                                                        *(undefined4
                                                              *)(param_1 +
                                                                 0x48);
                                                    *(undefined4 *)(iVar3 +
                                                                    0x254) =
                                                        uVar4;
                                                    FUN_00035ee0(0x8e, iVar3,
                                                                 0);
                                                    goto LAB_00046950;
                                                }
                                            } else {
                                                uVar4 =
                                                    FUN_0007c2e8(iVar3 + 0x10);
                                                FUN_00074e00(
                                                    6,
                                                    "receive: Bad broadcast "
                                                    "auth (%d) from %s",
                                                    uVar9, uVar4);
                                            }
                                            *(uint *)(iVar3 + 600) = local_138;
                                            *(uint *)(iVar3 + 0x25c) =
                                                local_134;
                                            if (*(int *)(iVar3 + 0x13c) == 0)
                                                goto LAB_00047640;
                                        } else if (*(int *)(iVar3 + 0x13c) ==
                                                   0) {
                                            *(uint *)(iVar3 + 0x230) =
                                                local_138;
                                            *(uint *)(iVar3 + 0x234) =
                                                local_134;
                                        LAB_00047640:
                                            uVar4 =
                                                *(undefined4 *)(param_1 + 0x4c);
                                            *(undefined4 *)(iVar3 + 0x240) =
                                                *(undefined4 *)(param_1 + 0x48);
                                            *(undefined4 *)(iVar3 + 0x244) =
                                                uVar4;
                                        }
                                        *(uint *)(iVar3 + 0x238) = local_138;
                                        *(uint *)(iVar3 + 0x23c) = local_134;
                                        bVar8 = *(byte *)(param_1 + 0x5a);
                                        if (*(byte *)(param_1 + 0x5a) <
                                            *(byte *)(iVar3 + 0x41)) {
                                            bVar8 = *(byte *)(iVar3 + 0x41);
                                        }
                                        *(byte *)(iVar3 + 0x5e) = bVar8;
                                        uVar12 = current_time;
                                        if (iVar1 == 1) {
                                            *(int *)(iVar3 + 0x304) =
                                                *(int *)(iVar3 + 0x304) + 1;
                                            FUN_00035ee0(0x87, iVar3, 0);
                                            bVar8 = *(byte *)(iVar3 + 0x41);
                                            if (bVar8 <
                                                *(byte *)(param_1 + 0x5a)) {
                                                bVar8 = *(byte *)(iVar3 + 0x5e);
                                                *(byte *)(iVar3 + 0x41) = bVar8;
                                            }
                                            *(undefined4 *)(iVar3 + 0x138) = 0;
                                            *(int *)(iVar3 + 0x2c8) =
                                                9 << (uint)bVar8;
                                            *(undefined4 *)(iVar3 + 0x134) = 0;
                                            FUN_00044264(iVar3);
                                            goto LAB_00046950;
                                        }
                                        if (iVar1 != 0) {
                                            *(int *)(iVar3 + 0x304) =
                                                *(int *)(iVar3 + 0x304) + 1;
                                            goto LAB_00046950;
                                        }
                                        if ((local_190 == 3) ||
                                            (local_188 == 0 || uVar9 != 1)) {
                                            uVar15 = *(uint *)(iVar3 + 0x44);
                                            *(uint *)(iVar3 + 0x2dc) =
                                                current_time;
                                            *(uint *)(iVar3 + 0x2d8) = uVar12;
                                            if (uVar9 == 1)
                                                goto LAB_00047814;
                                            uVar15 = uVar15 & 0xfffffffb;
                                            *(uint *)(iVar3 + 0x44) = uVar15;
                                        } else {
                                            if ((local_188 < 0x10000) &&
                                                (iVar10 = FUN_000723a4(
                                                     local_188, iVar3 + 0x10),
                                                 iVar10 == 0)) {
                                                FUN_00035ee0(0x8c, iVar3,
                                                             "authIP");
                                                *(int *)(iVar3 + 0x2f0) =
                                                    *(int *)(iVar3 + 0x2f0) + 1;
                                                goto LAB_00046950;
                                            }
                                            uVar12 = current_time;
                                            uVar15 = *(uint *)(iVar3 + 0x44);
                                            *(uint *)(iVar3 + 0x2dc) =
                                                current_time;
                                            *(uint *)(iVar3 + 0x2d8) = uVar12;
                                        LAB_00047814:
                                            uVar15 = uVar15 | 4;
                                            *(uint *)(iVar3 + 0x44) = uVar15;
                                        }
                                        if ((uVar15 & 0x800) != 0) {
                                            puVar14 = *(uint **)(iVar3 + 0xdc);
                                            if ((puVar14 != (uint *)0x0) &&
                                                (0 < (int)puVar14[1])) {
                                                puVar14[1] = puVar14[1] - 1;
                                            }
                                            *(uint *)(iVar3 + 300) =
                                                *(uint *)(iVar3 + 300) | 0x80;
                                            iVar10 =
                                                FUN_0003828c(iVar3, param_1);
                                            if (iVar10 != 0x100) {
                                                if (iVar10 != 0x10f)
                                                    goto LAB_00046950;
                                                FUN_00035ee0(0x85, iVar3,
                                                             "crypto error");
                                                FUN_00046214(iVar3,
                                                             &DAT_000a65b0);
                                                *(uint *)(iVar3 + 300) =
                                                    *(uint *)(iVar3 + 300) |
                                                    0x100;
                                                iVar17 = unpeer_crypto_early;
                                                if ((*(uint *)(iVar3 + 0x44) &
                                                     2) == 0)
                                                    goto LAB_00046950;
                                                goto joined_r0x000478b8;
                                            }
                                            *(undefined4 *)(iVar3 + 0x2c4) = 0;
                                            if (local_190 == 4) {
                                                if (*(uint *)(iVar3 + 0x7c) ==
                                                    local_188) {
                                                    *(uint *)(iVar3 + 300) =
                                                        *(uint *)(iVar3 + 300) &
                                                        0xffffff7f;
                                                }
                                            } else if ((*(uint *)(iVar3 + 300) &
                                                        0x80) == 0) {
                                                *(uint *)(iVar3 + 0xa0) =
                                                    local_188;
                                            } else if (puVar14 != (uint *)0x0) {
                                                iVar10 = 0;
                                                for (;
                                                     (uVar12 = puVar14[1],
                                                     *(uint *)(iVar3 + 0xa0) !=
                                                              local_168 &&
                                                          (*puVar14 !=
                                                           local_168));
                                                     local_168 = FUN_000372c8(
                                                         iVar17, local_174,
                                                         local_168,
                                                         local_178)) {
                                                    if ((int)uVar12 < iVar10) {
                                                        uVar15 =
                                                            *(uint *)(iVar3 +
                                                                      300);
                                                        *(uint *)(iVar3 +
                                                                  0x88) =
                                                            *(uint *)(iVar3 +
                                                                      0x88) &
                                                            0xffffefff;
                                                        goto LAB_00048440;
                                                    }
                                                    iVar10 = iVar10 + 1;
                                                }
                                                uVar15 =
                                                    *(uint *)(iVar3 + 300) &
                                                    0xffffff7f;
                                                *(uint *)(iVar3 + 0xa0) =
                                                    local_188;
                                                *(uint *)(iVar3 + 300) = uVar15;
                                                puVar14[1] = uVar12 - iVar10;
                                            LAB_00048440:
                                                if ((uVar15 & 0x80) != 0) {
                                                    FUN_00035ee0(0x8c, iVar3,
                                                                 "keylist");
                                                }
                                            }
                                            if ((*(uint *)(iVar3 + 0x88) &
                                                 0x400) == 0) {
                                                *(uint *)(iVar3 + 300) =
                                                    *(uint *)(iVar3 + 300) |
                                                    0x80;
                                            }
                                            if (*(uint *)(iVar3 + 0xec) <
                                                current_time) {
                                                FUN_00035ee0(0x85, iVar3,
                                                             "crypto refresh");
                                                FUN_00046214(iVar3, "TIME");
                                                goto LAB_00046950;
                                            }
                                        }
                                        FUN_000459b0(
                                            iVar3, iVar6,
                                            *(undefined4 *)(param_1 + 0x54));
                                        uVar12 = current_time;
                                        if (*(int *)(iVar3 + 0x13c) != 0) {
                                            *(uint *)(iVar3 + 0x230) =
                                                local_140;
                                            *(uint *)(iVar3 + 0x234) =
                                                local_13c;
                                            uVar4 =
                                                *(undefined4 *)(param_1 + 0x4c);
                                            iVar17 = *(int *)(iVar3 + 0x2d0);
                                            *(undefined4 *)(iVar3 + 0x240) =
                                                *(undefined4 *)(param_1 + 0x48);
                                            *(undefined4 *)(iVar3 + 0x244) =
                                                uVar4;
                                            uVar15 =
                                                (uint) * (byte *)(iVar3 + 0x5e);
                                            if (*(byte *)(iVar3 + 0x40) <=
                                                uVar15) {
                                                uVar15 = (uint) *
                                                         (byte *)(iVar3 + 0x40);
                                            }
                                            if (iVar17 - uVar12 <
                                                (uint)(1 << uVar15) >> 1) {
                                                iVar17 = iVar17 + 1;
                                            } else {
                                                iVar17 = iVar17 + -1;
                                            }
                                            *(int *)(iVar3 + 0x2d0) = iVar17;
                                        }
                                        goto LAB_00046950;
                                    }
                                    if ((*(uint *)(iVar3 + 300) & 0x1ff) != 0) {
                                        uVar4 = FUN_0007c2e8(iVar3 + 0x10);
                                        FUN_00074e00(
                                            6,
                                            "receive: Bad auth in packet with "
                                            "bad timestamps from %s denied - "
                                            "spoof?",
                                            uVar4);
                                        goto LAB_00046950;
                                    }
                                    FUN_00035ee0(0x8c, iVar3, "digest");
                                    *(uint *)(iVar3 + 300) =
                                        *(uint *)(iVar3 + 300) | 0x10;
                                    *(int *)(iVar3 + 0x2f0) =
                                        *(int *)(iVar3 + 0x2f0) + 1;
                                    if ((local_184 != 0) &&
                                        (local_190 - 1 < 2)) {
                                        FUN_0001c170(param_1, 1, 0, uVar5);
                                    }
                                    iVar17 = unpeer_digest_early;
                                    if ((*(uint *)(iVar3 + 0x44) & 2) == 0) {
                                        if ((peer_clear_digest_early != 0) &&
                                            (*(int *)(iVar3 + 0x88) != 0)) {
                                            FUN_00046214(iVar3, &DAT_000a64a4);
                                        }
                                        goto LAB_00046950;
                                    }
                                }
                            joined_r0x000478b8:
                                if (iVar17 != 0) {
                                    FUN_00041fc4(iVar3);
                                }
                                goto LAB_00046950;
                            }
                            break;
                        case 2:
                            break;
                        case 3:
                            iVar6 = *(int *)(param_1 + 0x3c);
                            if ((*(uint *)(iVar6 + 0x90) & 0x40) == 0) {
                                uVar13 = *(uint *)(param_1 + 0x5c);
                                uVar15 = *(uint *)(param_1 + 0x60);
                                dVar19 = (double)(uVar13 << 0x18 |
                                                  (uVar13 >> 8 & 0xff) << 0x10 |
                                                  (uVar13 >> 0x10 & 0xff) << 8 |
                                                  uVar13 >> 0x18) *
                                         1.52587890625e-05;
                                FUN_000520f0(
                                    SUB84(dVar19, 0),
                                    (int)((ulonglong)dVar19 >> 0x20),
                                    SUB84(
                                        (double)(uVar15 << 0x18 |
                                                 (uVar15 >> 8 & 0xff) << 0x10 |
                                                 (uVar15 >> 0x10 & 0xff) << 8 |
                                                 uVar15 >> 0x18) *
                                            1.52587890625e-05,
                                        0),
                                    iVar17, iVar6 + 0x18, &local_148,
                                    &local_140);
                                if ((uVar12 & 4) == 0) {
                                    bVar18 = uVar9 < 2;
                                } else {
                                    bVar18 = uVar9 == 1;
                                }
                                if (bVar18) {
                                LAB_0004867c:
                                    FUN_0001c170(param_1, 4, local_188, uVar5);
                                    goto LAB_00046950;
                                }
                                if (uVar9 == 2) {
                                    FUN_0001c170(param_1, 4, 0, uVar5);
                                    goto LAB_00047498;
                                }
                            } else if (sys_manycastserver != 0) {
                                iVar10 = FUN_0001c534(local_16c, 0);
                                if (((iVar10 == 0) && (sys_leap != '\x03')) &&
                                    ((sys_stratum < uVar15 &&
                                      (((sys_cohort != 0 ||
                                         ((uint)sys_stratum != uVar15 + 1)) &&
                                        (*(int *)(iVar6 + 0x98) !=
                                         *(int *)(param_1 + 100))))))) {
                                    if ((uVar12 & 4) == 0) {
                                        bVar18 = uVar9 < 2;
                                    } else {
                                        bVar18 = uVar9 == 1;
                                    }
                                    if (!bVar18)
                                        goto LAB_00046950;
                                    uVar15 = *(uint *)(param_1 + 0x60);
                                    uVar12 = *(uint *)(param_1 + 0x5c);
                                    dVar19 =
                                        (double)(uVar12 << 0x18 |
                                                 (uVar12 >> 8 & 0xff) << 0x10 |
                                                 (uVar12 >> 0x10 & 0xff) << 8 |
                                                 uVar12 >> 0x18) *
                                        1.52587890625e-05;
                                    FUN_000520f0(
                                        SUB84(dVar19, 0),
                                        (int)((ulonglong)dVar19 >> 0x20),
                                        SUB84((double)(uVar15 << 0x18 |
                                                       (uVar15 >> 8 & 0xff)
                                                           << 0x10 |
                                                       (uVar15 >> 0x10 & 0xff)
                                                           << 8 |
                                                       uVar15 >> 0x18) *
                                                  1.52587890625e-05,
                                              0),
                                        iVar17, iVar6 + 0x18, &local_148,
                                        &local_140);
                                    goto LAB_0004867c;
                                }
                                break;
                            }
                            goto LAB_00046c30;
                        case 4:
                            iVar6 = FUN_0001c534(local_16c, 0);
                            if (iVar6 == 0) {
                                iVar6 = FUN_00042c0c(param_1);
                                if (iVar6 != 0) {
                                    if ((((*(byte *)(iVar6 + 0x48) & 8) == 0) &&
                                         (sys_authenticate != 0)) ||
                                        ((uVar12 & 0x14) != 0)) {
                                        uVar9 = uVar9 - 1;
                                        if (uVar9 != 0) {
                                            uVar9 = 1;
                                        }
                                    } else {
                                        uVar9 = (uint)(1 < uVar9);
                                    }
                                    if (uVar9 == 0) {
                                        if (((bVar8 != 3) &&
                                             (sys_floor <= (int)uVar15)) &&
                                            (((int)uVar15 < sys_ceiling &&
                                              (iVar17 = FUN_000421d4(
                                                   iVar17, 0,
                                                   *(undefined4 *)(param_1 +
                                                                   0x3c),
                                                   (int)local_14e),
                                               iVar17 != 0)))) {
                                            if ((*(byte *)(iVar6 + 0x48) & 8) !=
                                                0) {
                                                *(uint *)(iVar6 + 0x2d0) =
                                                    current_time + 1;
                                            }
                                            goto LAB_00046950;
                                        }
                                        break;
                                    }
                                }
                                goto LAB_00046c30;
                            }
                            break;
                        case 5:
                            iVar3 = FUN_0001c534(local_16c, sys_ident);
                            if (iVar3 == 0) {
                                if ((uVar12 & 0x14) == 0 &&
                                    sys_authenticate == 0) {
                                    uVar13 = (uint)(1 < uVar9);
                                } else {
                                    uVar13 = uVar9 - 1;
                                    if (uVar13 != 0) {
                                        uVar13 = 1;
                                    }
                                }
                                if (uVar13 == 0) {
                                    if (((uVar12 & 0x20) == 0) &&
                                        (((bVar8 == 3 ||
                                           ((sys_floor <= (int)uVar15 &&
                                             ((int)uVar15 < sys_ceiling)))) &&
                                          (iVar3 = FUN_000421d4(
                                               iVar17, 0,
                                               *(undefined4 *)(param_1 + 0x3c),
                                               (int)local_14e),
                                           iVar3 != 0))))
                                        goto LAB_00047478;
                                } else {
                                    if ((uVar12 & 4) == 0) {
                                        bVar18 = uVar9 < 2;
                                    } else {
                                        bVar18 = uVar9 == 1;
                                    }
                                    if (bVar18) {
                                        FUN_0001c170(param_1, 2, local_188,
                                                     uVar5);
                                        goto LAB_00046950;
                                    }
                                    if (uVar9 == 2) {
                                        FUN_0001c170(param_1, 2, 0, uVar5);
                                        goto LAB_00046c30;
                                    }
                                }
                            }
                            break;
                        case 6:
                            iVar3 = FUN_0001c534(local_16c, sys_ident);
                            if (iVar3 == 0) {
                                if (sys_bclient != 0) {
                                    if ((uVar12 & 0x14) == 0 &&
                                        sys_authenticate == 0) {
                                        uVar13 = (uint)(1 < uVar9);
                                    } else {
                                        uVar13 = uVar9 - 1;
                                        if (uVar13 != 0) {
                                            uVar13 = 1;
                                        }
                                    }
                                    if (uVar13 == 0) {
                                        if (((bVar8 != 3) &&
                                             (sys_floor <= (int)uVar15)) &&
                                            ((int)uVar15 < sys_ceiling)) {
                                            if ((crypto_flags == 0 ||
                                                 local_188 < 0x10000) ||
                                                (local_158 == 0x82010000)) {
                                                iVar3 =
                                                    *(int *)(param_1 + 0x3c);
                                                if ((*(uint *)(iVar3 + 0x90) &
                                                     0x40) != 0) {
                                                    iVar3 = 0;
                                                }
                                                if (sys_bdelay <= 0.0) {
                                                    iVar17 = FUN_000421d4(
                                                        iVar17, 0, iVar3,
                                                        (int)local_14e);
                                                    if (iVar17 != 0) {
                                                        *(uint *)(iVar17 +
                                                                  600) =
                                                            local_138;
                                                        *(uint *)(iVar17 +
                                                                  0x25c) =
                                                            local_134;
                                                        if (0xffff <
                                                            local_188) {
                                                            FUN_0003828c(
                                                                iVar17,
                                                                param_1);
                                                        }
                                                        goto LAB_00046950;
                                                    }
                                                } else if (
                                                    (crypto_flags == 0 ||
                                                     local_188 < 0x10000) &&
                                                    (iVar3 = FUN_000421d4(
                                                         iVar17, 0, iVar3,
                                                         (int)local_14e),
                                                     iVar3 != 0)) {
                                                    *(double *)(iVar3 + 0x268) =
                                                        sys_bdelay;
                                                    *(uint *)(iVar3 + 600) =
                                                        local_138;
                                                    *(uint *)(iVar3 + 0x25c) =
                                                        local_134;
                                                    goto LAB_00047478;
                                                }
                                                goto LAB_00046c30;
                                            }
                                        }
                                        break;
                                    }
                                }
                                goto LAB_00046c30;
                            }
                        }
                    switchD_00046f7c_default:
                        sys_declined = sys_declined + 1;
                        goto LAB_00046950;
                    }
                    goto LAB_00046c30;
                }
            }
        LAB_0004693c:
            sys_badlength = sys_badlength + 1;
            goto LAB_00046950;
        }
    }
LAB_00046c30:
    sys_restricted = sys_restricted + 1;
LAB_00046950:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000486b0(void)

{
    int iVar1;
    double in_d0;
    double dVar2;

    iVar1 = __stack_chk_guard;
    if (1.0 < in_d0) {
        FUN_00074e00(3, "unsupported tick %.3f > 1s ignored");
        return;
    }
    if (measured_tick == in_d0 || measured_tick < in_d0) {
        if (measured_tick < in_d0) {
            trunc_os_clock = 1;
            FUN_00074e00(5,
                         "proto: truncating system clock to multiples of %.9f");
        }
        sys_precision = '\0';
        dVar2 = in_d0;
        if (in_d0 <= 1.0) {
            do {
                dVar2 = dVar2 + dVar2;
                sys_precision = sys_precision + -1;
            } while (dVar2 <= 1.0);
        }
        sys_tick = in_d0;
        if (1.0 - dVar2 * 0.5 < dVar2 - 1.0) {
            sys_precision = sys_precision + '\x01';
        }
    } else {
        FUN_00074e00(3,
                     "proto: tick %.3f less than measured tick %.3f, ignored");
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00048810(undefined4 param_1, int param_2, short *param_3)

{
    undefined4 *puVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    int iVar4;
    int iVar5;
    int iVar6;
    int *piVar7;
    undefined4 *puVar8;
    uint uVar9;
    undefined4 uVar10;
    short sVar11;
    uint uVar12;
    undefined4 uVar13;
    undefined4 *puVar14;
    double in_d0;
    undefined4 local_48;
    undefined4 local_44;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined4 uStack_38;
    undefined4 uStack_34;
    undefined4 local_30;
    int local_2c;
    int *local_28;

    iVar5 = __stack_chk_guard;
    switch (param_1) {
    case 1:
        if (param_2 != 0) {
            sys_bclient = param_2;
            FUN_0002621c();
            return;
        }
        sys_bclient = 0;
        piVar7 = ep_list;
        if (ep_list != (int *)0x0) {
            do {
                uVar9 = piVar7[0x24];
                if (((uVar9 & 0x80) == 0) && ((uVar9 & 0x20) != 0)) {
                    if (piVar7[4] != -1) {
                        uVar2 = FUN_0007c2e8(piVar7 + 0x14);
                        local_28 = piVar7 + 0x1b;
                        FUN_00074e00(6,
                                     "stop listening for broadcasts to %s on "
                                     "interface #%d %s",
                                     uVar2, piVar7[5]);
                        FUN_00025954(piVar7[4]);
                        uVar9 = piVar7[0x24];
                        piVar7[4] = -1;
                    }
                    piVar7[0x24] = uVar9 & 0xffffffdf;
                }
                piVar7 = (int *)*piVar7;
            } while (piVar7 != (int *)0x0);
        }
        broadcast_client_enabled = 0;
        if (iVar5 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        return;
    case 2:
    default:
    code_r0x00048b98:
        FUN_00074e00(5, "proto: unsupported option %d", param_1);
        return;
    case 3:
        sys_authenticate = param_2;
        break;
    case 4:
        sys_bdelay = in_d0;
        if (in_d0 == 0.0) {
            sys_bdelay = -0.05;
        }
        break;
    case 5:
        goto code_r0x00048b98;
    case 6:
        if (param_3 != (short *)0x0) {
            FUN_000264f4(param_3);
        }
        sys_bclient = 1;
        break;
    case 7:
        if (param_3 != (short *)0x0) {
            sVar11 = *param_3;
            local_2c = __stack_chk_guard;
            if (sVar11 == 2) {
                iVar5 = (*(uint *)(param_3 + 2) & 0xf0) - 0xe0;
            } else {
                iVar5 = *(byte *)(param_3 + 4) - 0xff;
            }
            if (iVar5 == 0) {
            LAB_00026814:
                iVar5 = FUN_00025184(param_3);
                if (iVar5 != 0) {
                    while (true) {
                        local_48 = 0;
                        local_44 = 0;
                        iVar4 = FUN_00023dc8(param_3);
                        if (iVar4 == 0)
                            break;
                        if (sVar11 == 2) {
                            local_48 = *(undefined4 *)(param_3 + 2);
                            local_44 = *(undefined4 *)(iVar5 + 0x1c);
                            iVar4 = setsockopt(*(int *)(iVar5 + 0xc), 0, 0x24,
                                               &local_48, 8);
                            if (iVar4 != 0) {
                                uVar10 = *(undefined4 *)(iVar5 + 0xc);
                                uVar2 = FUN_0007c2e8(iVar5 + 0x18);
                                uVar12 = *(uint *)(iVar5 + 0x1c);
                                uVar9 = *(uint *)(param_3 + 2);
                                uVar3 = FUN_0007c2e8(param_3);
                                FUN_00074e00(
                                    3,
                                    "setsockopt IP_DROP_MEMBERSHIP failed: %m "
                                    "on socket %d, addr %s for %x / %x (%s)",
                                    uVar10, uVar2,
                                    uVar9 << 0x18 |
                                        (uVar9 >> 8 & 0xff) << 0x10 |
                                        (uVar9 >> 0x10 & 0xff) << 8 |
                                        uVar9 >> 0x18,
                                    uVar12 << 0x18 |
                                        (uVar12 >> 8 & 0xff) << 0x10 |
                                        (uVar12 >> 0x10 & 0xff) << 8 |
                                        uVar12 >> 0x18,
                                    uVar3);
                                sVar11 = *param_3;
                                break;
                            }
                        } else if (sVar11 == 10) {
                            local_40 = *(undefined4 *)(param_3 + 4);
                            uStack_3c = *(undefined4 *)(param_3 + 6);
                            uStack_38 = *(undefined4 *)(param_3 + 8);
                            uStack_34 = *(undefined4 *)(param_3 + 10);
                            local_30 = *(undefined4 *)(iVar5 + 0xb0);
                            iVar4 = setsockopt(*(int *)(iVar5 + 0xc), 0x29,
                                               0x15, &local_40, 0x14);
                            if (iVar4 != 0) {
                                uVar13 = *(undefined4 *)(iVar5 + 0xc);
                                uVar2 = FUN_0007c2e8(iVar5 + 0x18);
                                uVar10 = *(undefined4 *)(iVar5 + 0xb0);
                                uVar3 = FUN_0007c2e8(param_3);
                                FUN_00074e00(
                                    3,
                                    "setsockopt IPV6_LEAVE_GROUP failure: %m "
                                    "on socket %d, addr %s for %d (%s)",
                                    uVar13, uVar2, uVar10, uVar3);
                                sVar11 = *param_3;
                                break;
                            }
                        }
                        iVar4 = *(int *)(iVar5 + 0x9c) + -1;
                        *(int *)(iVar5 + 0x9c) = iVar4;
                        if (iVar4 == 0) {
                            *(uint *)(iVar5 + 0x90) =
                                *(uint *)(iVar5 + 0x90) & 0xffffffbf;
                        }
                        iVar5 = FUN_00025184(param_3);
                        sVar11 = *param_3;
                        if (iVar5 == 0)
                            goto LAB_000268c0;
                    }
                    goto LAB_00026814;
                }
            LAB_000268c0:
                puVar1 = remoteaddr_list;
                puVar14 = &remoteaddr_list;
                do {
                    puVar8 = puVar1;
                    if (*(short *)(puVar8 + 1) == sVar11) {
                        if (sVar11 == 2) {
                            iVar5 = *(int *)(param_3 + 2) - puVar8[2];
                            if (iVar5 != 0) {
                                iVar5 = 1;
                            }
                        } else {
                            iVar5 = memcmp(param_3 + 4, puVar8 + 3, 0x10);
                            if (iVar5 != 0)
                                goto LAB_000268d4;
                            iVar5 = *(int *)(param_3 + 0xc) - puVar8[7];
                            if (iVar5 != 0) {
                                iVar5 = 1;
                            }
                        }
                        if (iVar5 == 0) {
                            puVar1 = (undefined4 *)*puVar14;
                            *puVar14 = *puVar1;
                            free(puVar1);
                            break;
                        }
                    }
                LAB_000268d4:
                    puVar1 = (undefined4 *)*puVar8;
                    puVar14 = puVar8;
                } while ((undefined4 *)*puVar8 != (undefined4 *)0x0);
            } else {
                uVar2 = FUN_0007c2e8();
                FUN_00074e00(3, "invalid multicast address %s", uVar2);
            }
            if (local_2c != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            return;
        }
        break;
    case 8:
        ntp_enable = param_2;
        break;
    case 9:
        if (kern_enable != param_2) {
            iVar4 = pll_control;
            if (pll_control != 0) {
                iVar4 = 1;
            }
            iVar6 = iVar4;
            if (kern_enable == 0) {
                iVar6 = 0;
            }
            if (param_2 != 0) {
                iVar6 = 0;
            }
            if (iVar6 == 0) {
                if (param_2 == 0) {
                    iVar4 = 0;
                }
                kern_enable = param_2;
                if (iVar4 != 0) {
                    FUN_0003ef84();
                }
            } else {
                FUN_00035ee0(0xd, 0, "kernel time sync disabled");
                kern_enable = 0;
            }
            if ((pll_control != 0) && (DAT_000c9e6c != 0)) {
                if (iVar5 == __stack_chk_guard) {
                    FUN_0003f1ec((int)drift_comp);
                    return;
                }
                goto LAB_00040500;
            }
        }
        if (iVar5 == __stack_chk_guard) {
            return;
        }
    LAB_00040500:
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    case 10:
        if (param_2 != 0) {
            FUN_00040cd4(1);
            return;
        }
        FUN_00040dfc(1);
        if (mon_enabled != 0) {
            if (iVar5 == __stack_chk_guard) {
                FUN_00074e00(4, "restrict: \'monitor\' cannot be disabled "
                                "while \'limited\' is enabled");
                return;
            }
            goto LAB_00048be8;
        }
        break;
    case 0xb:
        stats_control = param_2;
        break;
    case 0xc:
        hardpps_enable = param_2;
        break;
    case 0xd:
        cal_enable = param_2;
        break;
    case 0xe:
        sys_minclock = (undefined4)(longlong)in_d0;
        break;
    case 0xf:
        sys_maxclock = (undefined4)(longlong)in_d0;
        break;
    case 0x10:
        sys_minsane = (undefined4)(longlong)in_d0;
        break;
    case 0x11:
        sys_floor = (undefined4)(longlong)in_d0;
        break;
    case 0x12:
        sys_ceiling = (undefined4)(longlong)in_d0;
        break;
    case 0x13:
        sys_cohort = (undefined4)(longlong)in_d0;
        break;
    case 0x14:
        break;
    case 0x15:
        sys_mindisp = in_d0;
        break;
    case 0x16:
        sys_maxdist = in_d0;
        break;
    case 0x17:
        goto code_r0x00048b98;
    case 0x18:
        goto code_r0x00048b98;
    case 0x19:
        sys_beacon = (undefined4)(longlong)in_d0;
        break;
    case 0x1a:
        sys_orphan = (undefined4)(longlong)in_d0;
        break;
    case 0x1b:
        orphwait = (int)(longlong)in_d0 + (orphwait - sys_orphwait);
        sys_orphwait = (int)(longlong)in_d0;
        break;
    case 0x1c:
        ntp_mode7 = param_2;
        break;
    case 0x1d:
        unpeer_crypto_early = param_2;
        break;
    case 0x1e:
        unpeer_crypto_nak_early = param_2;
        break;
    case 0x1f:
        unpeer_digest_early = param_2;
        break;
    case 0x20:
        peer_clear_digest_early = param_2;
        break;
    case 0x21:
        sys_bcpollbstep = (0.0 < in_d0) * (char)(longlong)in_d0;
    }
    if (iVar5 == __stack_chk_guard) {
        return;
    }
LAB_00048be8:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00048d54) */

void FUN_00048c70(void)

{
    sys_stattime = current_time;
    sys_received = 0;
    sys_processed = 0;
    sys_newversion = 0;
    sys_oldversion = 0;
    sys_declined = 0;
    sys_restricted = 0;
    sys_badlength = 0;
    sys_badauth = 0;
    sys_limitrejected = 0;
    sys_kodsent = 0;
    sys_lamport = 0;
    sys_tsrounding = 0;
    return;
}

void FUN_00048d98(void)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    uint uVar6;
    bool bVar7;
    bool bVar8;
    double dVar9;
    double dVar10;
    int local_58;
    int local_4c;
    uint local_48;
    int local_44;
    uint local_40;
    int local_3c;

    iVar3 = 0;
    iVar4 = 0;
    local_58 = 0;
    iVar5 = 0;
    dVar10 = 1.0;
    local_3c = __stack_chk_guard;
    FUN_000435a4(3);
    sys_stratum = 0x10;
    sys_refid = 0x54494e49;
    sys_peer = 0;
    sys_rootdelay = 0;
    sys_rootdisp = 0;
    sys_reftime._4_4_ = 0;
    sys_reftime._0_4_ = 0;
    sys_jitter = 0;
    FUN_0006f600(0);
    trunc_os_clock = 0;
    FUN_0006f724(&local_44);
    do {
        FUN_0006f724(&local_4c);
        iVar2 = local_4c - local_44;
        local_44 = local_4c;
        if (local_48 < local_40) {
            iVar2 = iVar2 + -1;
        }
        uVar6 = local_48 - local_40;
        local_40 = local_48;
        if (iVar2 + 0x80000000U < 0x80000001) {
            if (iVar2 == 0 && 0x55 < uVar6) {
                if (iVar4 < iVar5) {
                    iVar4 = iVar5;
                }
                goto LAB_00048f14;
            }
            iVar5 = iVar5 + 1;
            local_40 = local_48;
        } else {
            if (iVar4 < iVar5) {
                iVar4 = iVar5;
            }
            if (iVar2 < 0) {
                dVar9 =
                    (double)FUN_0009bec4(-uVar6, -(iVar2 + (uint)(uVar6 != 0)));
                dVar9 = ldexp(dVar9, -0x20);
                dVar9 = -dVar9;
            } else {
            LAB_00048f14:
                dVar9 = (double)FUN_0009bec4(uVar6, iVar2);
                dVar9 = ldexp(dVar9, -0x20);
            }
            iVar3 = iVar3 + 1;
            iVar5 = 0;
            if (dVar9 < dVar10) {
                dVar10 = dVar9;
            }
        }
        iVar1 = local_58 + 1;
        bVar8 = SBORROW4(iVar1, 49999999);
        iVar2 = local_58 + -0x2faf07e;
        bVar7 = iVar1 == 49999999;
        if (iVar1 < 50000000) {
            bVar8 = SBORROW4(iVar3, 0xb);
            iVar2 = iVar3 + -0xb;
            bVar7 = iVar3 == 0xb;
        }
        local_58 = iVar1;
        if (!bVar7 && iVar2 < 0 == bVar8) {
            if (iVar3 < 0xc) {
                FUN_00074e00(3, "Fatal error: precision could not be measured "
                                "(MINSTEP too large?)");
                /* WARNING: Subroutine does not return */
                exit(1);
            }
            dVar9 = dVar10;
            if (iVar4 != 0) {
                dVar9 = dVar10 / (double)(longlong)iVar4;
            }
            FUN_0006f600(SUB84(dVar9, 0));
            measured_tick = dVar10;
            FUN_000486b0(SUB84(dVar10, 0));
            iVar4 = (int)sys_precision;
            FUN_00074e00(6, "proto: precision = %.3f usec (%d)",
                         SUB84(sys_tick * 1000000.0, 0),
                         (int)((ulonglong)(sys_tick * 1000000.0) >> 0x20),
                         iVar4);
            if (sys_fuzz < sys_tick) {
                FUN_00074e00(5, "proto: fuzz beneath %.3f usec",
                             SUB84(sys_fuzz * 1000000.0, 0),
                             (int)((ulonglong)(sys_fuzz * 1000000.0) >> 0x20),
                             iVar4);
            }
            FUN_0006f724(&local_44);
            sys_survivors = 0;
            sys_manycastserver = 0;
            sys_bclient = 0;
            sys_bdelay._0_4_ = 0x9999999a;
            sys_bdelay._4_4_ = 0xbfa99999;
            sys_authenticate = 1;
            sys_stattime = current_time;
            orphwait = sys_orphwait + current_time;
            FUN_00048c70();
            sys_ttl._3_1_ = 0x60;
            sys_ttl._4_1_ = 0x80;
            sys_ttl._5_1_ = 0xa0;
            sys_ttl._0_1_ = 0;
            sys_ttl._1_1_ = 0x20;
            sys_ttl._2_1_ = 0x40;
            sys_ttl._7_1_ = 0xe0;
            sys_ttl._6_1_ = 0xc0;
            sys_ttlmax = 7;
            hardpps_enable = 0;
            stats_control = 1;
            if (local_3c != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            return;
        }
    } while (true);
}

/* WARNING: Removing unreachable block (ram,0x0004923c) */

void FUN_000491e0(void)

{
    return;
}

void FUN_00049248(size_t param_1)

{
    size_t sVar1;
    uint uVar2;
    int iVar3;
    undefined4 uVar4;
    double *pdVar5;
    undefined8 *puVar6;
    int iVar7;
    uint uVar8;
    size_t __nmemb;
    double *pdVar9;
    size_t sVar10;
    int iVar11;
    uint uVar12;
    bool bVar13;
    double in_d4;
    double extraout_d4;
    double dVar14;
    double dVar15;
    double dVar16;
    undefined8 local_220;
    int local_3c;

    iVar7 = *(int *)(param_1 + 0xdc);
    pdVar9 = (double *)&local_220;
    iVar11 = *(int *)(param_1 + 0xd8);
    if (iVar11 == iVar7) {
        param_1 = 0;
    }
    local_3c = __stack_chk_guard;
    __nmemb = param_1;
    if (iVar11 != iVar7) {
        __nmemb = 0;
        puVar6 = &local_220;
        do {
            __nmemb = __nmemb + 1;
            iVar7 = (iVar7 + 1) % 0x3c;
            iVar3 = param_1 + iVar7 * 8;
            uVar4 = *(undefined4 *)(iVar3 + 0x10c);
            *(undefined4 *)puVar6 = *(undefined4 *)(iVar3 + 0x108);
            *(undefined4 *)((int)puVar6 + 4) = uVar4;
            puVar6 = (undefined8 *)((int)puVar6 + 8);
        } while (iVar7 != iVar11);
        *(int *)(param_1 + 0xdc) = iVar7;
        if (__nmemb != 1) {
            qsort(&local_220, __nmemb, 8, FUN_000491e0);
            in_d4 = extraout_d4;
        }
        uVar2 = 0;
        uVar12 = __nmemb - (__nmemb * 4) / 10;
        sVar10 = __nmemb;
        do {
            pdVar5 = (double *)(&local_220 + sVar10);
            sVar1 = sVar10;
            do {
                sVar10 = sVar1;
                if (sVar10 - uVar2 <= uVar12) {
                    dVar15 = 0.0;
                    *(undefined8 *)(param_1 + 0xf0) = 0;
                    *(undefined8 *)(param_1 + 0x100) = 0;
                    dVar14 = dVar15;
                    if (uVar2 < sVar10) {
                        dVar14 = (double)(&local_220)[uVar2] + 0.0;
                        *(double *)(param_1 + 0xf0) = dVar14;
                        uVar8 = uVar2;
                        pdVar9 = (double *)(&local_220 + uVar2 + 1);
                        while (uVar8 = uVar8 + 1, sVar10 != uVar8) {
                            dVar16 = *pdVar9;
                            pdVar5 = pdVar9 + 1;
                            bVar13 = uVar2 < uVar8;
                            if (bVar13) {
                                in_d4 = pdVar9[-1];
                            }
                            dVar14 = dVar14 + dVar16;
                            if (bVar13) {
                                dVar16 = dVar16 - in_d4;
                            }
                            *(double *)(param_1 + 0xf0) = dVar14;
                            if (bVar13) {
                                dVar15 = dVar15 + dVar16 * dVar16;
                            }
                            pdVar9 = pdVar5;
                            if (bVar13) {
                                *(double *)(param_1 + 0x100) = dVar15;
                            }
                        }
                    }
                    dVar16 = (double)uVar12;
                    dVar15 = dVar15 / dVar16;
                    *(double *)(param_1 + 0xf0) = dVar14 / dVar16;
                    if (dVar15 < 0.0) {
                        sqrt(dVar15);
                    }
                    dVar14 = ldexp(1.0, (int)sys_precision);
                    if (dVar14 < SQRT(dVar15)) {
                        dVar16 = *(double *)(param_1 + 0x100) / dVar16;
                        dVar14 = SQRT(dVar16);
                        if (dVar16 < 0.0) {
                            sqrt(dVar16);
                        }
                    } else {
                        dVar14 = ldexp(1.0, (int)sys_precision);
                    }
                    *(double *)(param_1 + 0x100) = dVar14;
                    goto LAB_00049414;
                }
                pdVar5 = pdVar5 + -1;
                sVar1 = sVar10 - 1;
            } while (
                (double)(&local_220)[uVar2 * 2 + (sVar10 - uVar2) >> 1] -
                    *pdVar9 <=
                *pdVar5 -
                    (double)(&local_220)[uVar2 * 2 + (sVar10 - uVar2) >> 1]);
            uVar2 = uVar2 + 1;
            pdVar9 = pdVar9 + 1;
        } while (true);
    }
LAB_00049414:
    if (local_3c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__nmemb);
}

void FUN_000494a0(uint param_1, uint param_2)

{
    uint uVar1;
    int iVar2;
    uint uVar3;
    bool bVar4;

    uVar3 = __stack_chk_guard;
    iVar2 = *(int *)(param_1 + 0x54);
    if (iVar2 == 0)
        goto LAB_000494f8;
    switch (param_2) {
    case 1:
        *(int *)(iVar2 + 0x30c) = *(int *)(iVar2 + 0x30c) + 1;
        goto LAB_00049570;
    case 2:
        *(int *)(iVar2 + 0x310) = *(int *)(iVar2 + 0x310) + 1;
        if (*(byte *)(iVar2 + 0x2a) < 0xf) {
            *(byte *)(iVar2 + 0x2a) = *(byte *)(iVar2 + 0x2a) + 1;
        }
        goto LAB_00049524;
    case 3:
        break;
    case 4:
        break;
    case 5:
        goto LAB_00049510;
    case 6:
    LAB_00049510:
        *(int *)(iVar2 + 0x314) = *(int *)(iVar2 + 0x314) + 1;
    }
    if (param_2 != 0) {
    LAB_00049570:
        if (*(byte *)(iVar2 + 0x2a) < 0xf) {
            *(byte *)(iVar2 + 0x2a) = *(byte *)(iVar2 + 0x2a) + 1;
        }
    }
LAB_00049524:
    if (*(byte *)(iVar2 + 0x29) == param_2) {
    LAB_000494f8:
        uVar1 = param_1;
        if (uVar3 == __stack_chk_guard) {
            return;
        }
    } else {
        *(char *)(iVar2 + 0x29) = (char)param_2;
        uVar1 = FUN_0007d480(param_2);
        bVar4 = uVar3 == __stack_chk_guard;
        param_2 = uVar3;
        uVar3 = uVar1;
        if (bVar4) {
            FUN_00035ee0(0x8b, param_1);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1, param_2, uVar3);
}

void FUN_000495b0(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    if (num_refclock_conf != 0) {
        iVar2 = 0;
        piVar3 = (int *)refclock_conf;
        do {
            if (*(code **)(*piVar3 + 0x10) != (code *)0x0) {
                (**(code **)(*piVar3 + 0x10))();
            }
            iVar2 = iVar2 + 1;
            piVar3 = piVar3 + 1;
        } while (iVar2 < (int)(uint)num_refclock_conf);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00049640(int param_1)

{
    int iVar1;
    void *__ptr;

    iVar1 = __stack_chk_guard;
    __ptr = *(void **)(param_1 + 0x54);
    if (__ptr != (void *)0x0) {
        if (*(code **)(*(int *)(refclock_conf +
                                (uint) * (byte *)(param_1 + 0x58) * 4) +
                       4) != (code *)0x0) {
            (**(code **)(*(int *)(refclock_conf +
                                  (uint) * (byte *)(param_1 + 0x58) * 4) +
                         4))(*(undefined1 *)(param_1 + 0x59), param_1);
            __ptr = *(void **)(param_1 + 0x54);
        }
        free(__ptr);
        *(undefined4 *)(param_1 + 0x54) = 0;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000496d4(int param_1)

{
    uint uVar1;
    undefined1 uVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;
    int iVar6;
    undefined4 uVar7;
    uint uVar8;
    int *piVar9;

    iVar3 = __stack_chk_guard;
    if (*(short *)(param_1 + 0x10) == 2) {
        uVar8 = *(uint *)(param_1 + 0x14);
        uVar1 = uVar8 >> 0x10 & 0xff;
        if ((uVar8 << 0x18 | (uVar8 >> 8 & 0xff) << 0x10) == 0x7f7f0000) {
            if ((uVar1 < num_refclock_conf) &&
                (piVar9 = *(int **)(refclock_conf + uVar1 * 4), *piVar9 != 0)) {
                iVar5 = FUN_00073ba4(0, 0x318, 0, 1);
                *(undefined1 *)(param_1 + 0x5b) = 3;
                *(undefined1 *)(param_1 + 0x5d) = 0;
                uVar2 = (undefined1)(uVar8 >> 0x10);
                *(undefined1 *)(param_1 + 0x58) = uVar2;
                *(char *)(param_1 + 0x59) = (char)(uVar8 >> 0x18);
                *(uint *)(param_1 + 0x44) = *(uint *)(param_1 + 0x44) | 8;
                *(undefined1 *)(param_1 + 0x5e) =
                    *(undefined1 *)(param_1 + 0x42);
                *(int *)(param_1 + 0x54) = iVar5;
                *(undefined1 *)(iVar5 + 0x2b) = uVar2;
                *(int **)(iVar5 + 4) = piVar9;
                *(undefined4 *)(iVar5 + 0x1c) = 0xffffffff;
                *(undefined4 *)(iVar5 + 0x304) = current_time;
                if (*(char *)(param_1 + 0x3f) == '\x01') {
                    *(undefined1 *)(param_1 + 0x5c) = 2;
                } else {
                    *(undefined1 *)(param_1 + 0x5c) = 4;
                }
                iVar6 = (*(code *)*piVar9)(uVar8 >> 0x18, param_1);
                if (iVar6 == 0) {
                    FUN_00049640(param_1);
                    uVar7 = 0;
                } else {
                    uVar7 = 1;
                    *(undefined4 *)(param_1 + 0x70) =
                        *(undefined4 *)(iVar5 + 0x2fc);
                }
            } else {
                uVar7 = 0;
                FUN_00074e00(3, "refclock_newpeer: clock type %d invalid\n",
                             uVar1);
            }
            goto LAB_00049744;
        }
    }
    uVar7 = 0;
    uVar4 = FUN_0007c2e8(param_1 + 0x10);
    FUN_00074e00(3, "refclock_newpeer: clock address %s invalid", uVar4);
LAB_00049744:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar7);
    }
    return;
}

void FUN_0004987c(int param_1)

{
    int iVar1;
    code *pcVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = *(int *)(param_1 + 0x54);
    pcVar2 = *(code **)(*(int *)(iVar3 + 4) + 0x18);
    if (pcVar2 != (code *)0x0) {
        (*pcVar2)(*(undefined1 *)(param_1 + 0x59), param_1);
    }
    if ((*(code **)(iVar3 + 0x34) == (code *)0x0) ||
        (current_time < *(uint *)(iVar3 + 0x30))) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        /* WARNING: Could not recover jumptable at 0x00049900. Too many branches
         */
        /* WARNING: Treating indirect jump as call */
        (**(code **)(iVar3 + 0x34))(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0004992c(int param_1)

{
    byte bVar1;
    byte bVar2;
    undefined1 uVar3;
    byte bVar4;
    int iVar5;

    bVar2 = *(byte *)(param_1 + 0x58);
    uVar3 = *(undefined1 *)(param_1 + 0x59);
    *(int *)(param_1 + 0x2e4) = *(int *)(param_1 + 0x2e4) + 1;
    iVar5 = __stack_chk_guard;
    FUN_0006f724(param_1 + 0x238);
    if (*(int *)(param_1 + 0x134) == 0) {
        bVar4 = *(byte *)(param_1 + 0x12a);
        bVar1 = bVar4 << 1;
        *(byte *)(param_1 + 0x12a) = bVar1;
        if ((bVar1 & 0xe) == 0) {
            FUN_00045528(0, param_1);
            *(undefined4 *)(param_1 + 0x2cc) = current_time;
            if (*(char *)(param_1 + 0x12a) == '\0') {
                if ((bVar4 & 0xfe) != 0) {
                    FUN_00035ee0(0x83, param_1);
                    *(undefined4 *)(param_1 + 0x2e0) = current_time;
                }
                goto LAB_000499b8;
            }
        } else {
            *(undefined4 *)(param_1 + 0x2cc) = current_time;
        }
        if ((*(uint *)(param_1 + 0x44) & 0x40) != 0) {
            *(undefined4 *)(param_1 + 0x134) = 5;
        }
    } else {
        *(int *)(param_1 + 0x134) = *(int *)(param_1 + 0x134) + -1;
    }
LAB_000499b8:
    if (*(code **)(*(int *)(refclock_conf + (uint)bVar2 * 4) + 8) !=
        (code *)0x0) {
        (**(code **)(*(int *)(refclock_conf + (uint)bVar2 * 4) + 8))(uVar3,
                                                                     param_1);
    }
    if (iVar5 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    FUN_00044264(param_1, *(undefined1 *)(param_1 + 0x40));
    return;
}

void FUN_00049a70(int param_1, int param_2, uint param_3, int param_4,
                  uint param_5)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    double in_d0;
    double dVar5;

    iVar1 = __stack_chk_guard;
    param_2 = param_2 - param_4;
    if (param_3 < param_5) {
        param_2 = param_2 + -1;
    }
    iVar4 = param_3 - param_5;
    *(int *)(param_1 + 0xe8) = param_4;
    *(uint *)(param_1 + 0xec) = param_5;
    if (param_2 < 0) {
        dVar5 = (double)FUN_0009bec4(-iVar4, -(param_2 + (uint)(iVar4 != 0)));
        dVar5 = ldexp(dVar5, -0x20);
        dVar5 = -dVar5;
    } else {
        dVar5 = (double)FUN_0009bec4(iVar4, param_2);
        dVar5 = ldexp(dVar5, -0x20);
    }
    iVar4 = -0x77777777;
    iVar2 = *(int *)(param_1 + 0xdc);
    iVar3 = (*(int *)(param_1 + 0xd8) + 1) % 0x3c;
    *(int *)(param_1 + 0xd8) = iVar3;
    *(double *)(param_1 + iVar3 * 8 + 0x108) = dVar5 + in_d0;
    if (iVar3 == iVar2) {
        iVar4 = (iVar3 + 1) * -0x77777777;
        *(int *)(param_1 + 0xdc) = (iVar3 + 1) % 0x3c;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar4);
}

void FUN_00049bc8(int param_1)

{
    int iVar1;
    double dVar2;
    longlong lVar3;
    undefined8 uVar4;
    int local_34;
    undefined4 local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar1 = FUN_000733d8(
        *(undefined4 *)(param_1 + 0xc0), *(undefined4 *)(param_1 + 0xc4),
        *(undefined4 *)(param_1 + 200), *(undefined4 *)(param_1 + 0xcc), 0,
        *(undefined4 *)(param_1 + 0xe8), param_1 + 0xd4, &local_34);
    if (iVar1 != 0) {
        local_30 = 0;
        dVar2 = (double)(longlong) * (int *)(param_1 + 0xd0) / 1000000000.0;
        if (dVar2 < 0.0) {
            dVar2 = ldexp(-dVar2, 0x20);
            uVar4 =
                FUN_0009c010(SUB84(dVar2, 0), (int)((ulonglong)dVar2 >> 0x20));
            lVar3 = CONCAT44(
                -((int)((ulonglong)uVar4 >> 0x20) + (uint)((int)uVar4 != 0)),
                -(int)uVar4);
        } else {
            dVar2 = ldexp(dVar2, 0x20);
            lVar3 =
                FUN_0009c010(SUB84(dVar2, 0), (int)((ulonglong)dVar2 >> 0x20));
        }
        lVar3 = lVar3 + CONCAT44(local_34, local_30);
        local_30 = (undefined4)lVar3;
        local_34 = (int)((ulonglong)lVar3 >> 0x20);
        FUN_00049a70(param_1, local_34, local_30,
                     *(undefined4 *)(param_1 + 0xe8),
                     *(undefined4 *)(param_1 + 0xec));
        iVar1 = 1;
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

/* WARNING: Removing unreachable block (ram,0x00049d38) */

void FUN_00049cf8(int param_1)

{
    FUN_00049bc8((int)*(undefined8 *)(param_1 + 0x2e8));
    return;
}

/* WARNING: Heritage AFTER dead removal. Example location: s1 : 0x00049e14 */
/* WARNING: Restarted to delay deadcode elimination for space: register */

void FUN_00049d44(int param_1)

{
    char cVar1;
    int iVar2;
    int iVar3;
    undefined4 uVar4;
    byte bVar5;
    int iVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    bool bVar9;
    undefined4 in_s3;
    double dVar10;

    iVar2 = __stack_chk_guard;
    iVar6 = *(int *)(param_1 + 0x54);
    cVar1 = *(char *)(iVar6 + 0x28);
    *(char *)(param_1 + 0x5b) = cVar1;
    if (cVar1 != '\x03') {
        bVar5 = *(byte *)(param_1 + 0x12a);
        *(int *)(param_1 + 0x2e8) = *(int *)(param_1 + 0x2e8) + 1;
        *(undefined4 *)(param_1 + 0x2dc) = current_time;
        if (bVar5 == 0) {
            FUN_00035ee0(0x84, param_1);
            bVar5 = *(byte *)(param_1 + 0x12a);
            *(undefined4 *)(param_1 + 0x2e0) = current_time;
        }
        *(byte *)(param_1 + 0x12a) = bVar5 | 1;
        uVar4 = *(undefined4 *)(iVar6 + 0xe4);
        uVar7 = *(undefined4 *)(iVar6 + 0xf8);
        uVar8 = *(undefined4 *)(iVar6 + 0xfc);
        *(undefined4 *)(param_1 + 0x74) = *(undefined4 *)(iVar6 + 0xe0);
        *(undefined4 *)(param_1 + 0x78) = uVar4;
        uVar4 = *(undefined4 *)(iVar6 + 0xec);
        *(undefined4 *)(param_1 + 0x248) = *(undefined4 *)(iVar6 + 0xe8);
        *(undefined4 *)(param_1 + 0x24c) = uVar4;
        *(undefined4 *)(param_1 + 0x68) = uVar7;
        *(undefined4 *)(param_1 + 0x6c) = uVar8;
        FUN_0006f724(param_1 + 0x240);
        iVar3 = FUN_00049248(iVar6);
        if ((((iVar3 != 0) &&
              (FUN_00045528(
                   (int)*(undefined8 *)(iVar6 + 0xf0),
                   (int)((ulonglong) * (undefined8 *)(iVar6 + 0xf0) >> 0x20), 0,
                   in_s3, (int)*(undefined8 *)(iVar6 + 0x100), param_1),
               cal_enable != 0)) &&
             (dVar10 = ABS(last_offset), dVar10 < sys_mindisp)) &&
            ((sys_peer != 0 && (*(char *)(sys_peer + 0x58) == '\x16')))) {
            bVar9 = *(char *)(param_1 + 0x58) != '\x16';
            if (bVar9) {
                dVar10 = *(double *)(iVar6 + 0x2e8);
            }
            if (bVar9) {
                dVar10 = dVar10 - *(double *)(iVar6 + 0xf0) * 0.1;
            }
            if (bVar9) {
                *(double *)(iVar6 + 0x2e8) = dVar10;
            }
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00049ee4(int param_1, undefined1 *param_2, int param_3,
                  undefined4 *param_4)

{
    byte bVar1;
    int iVar2;
    undefined4 uVar3;
    int iVar4;
    byte *pbVar5;
    byte *pbVar6;
    undefined1 *puVar7;

    iVar2 = __stack_chk_guard;
    if (param_3 < 1) {
        iVar4 = 0;
    } else {
        iVar4 = *(int *)(param_1 + 0x54);
        pbVar6 = (byte *)(param_1 + 0x58);
        puVar7 = param_2;
        while (pbVar6 != (byte *)(param_1 + 0x58) + iVar4 &&
               puVar7 != param_2 + param_3 + -1) {
            pbVar5 = pbVar6 + 1;
            bVar1 = *pbVar6;
            pbVar6 = pbVar5;
            if ((bVar1 & 0x7f) - 0x20 < 0x5f) {
                *puVar7 = (char)(bVar1 & 0x7f);
                puVar7 = puVar7 + 1;
            }
        }
        iVar4 = (int)puVar7 - (int)param_2;
        if (iVar4 != 0) {
            *puVar7 = 0;
        }
        uVar3 = *(undefined4 *)(param_1 + 0x4c);
        *param_4 = *(undefined4 *)(param_1 + 0x48);
        param_4[1] = uVar3;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar4);
}

void FUN_00049f94(int param_1, void *param_2, int param_3, undefined4 *param_4)

{
    int iVar1;
    undefined4 uVar2;
    size_t __n;

    iVar1 = __stack_chk_guard;
    if (param_3 < 1) {
        __n = 0;
    } else {
        __n = param_3 - 1U;
        if ((int)*(size_t *)(param_1 + 0x54) <= (int)(param_3 - 1U)) {
            __n = *(size_t *)(param_1 + 0x54);
        }
        memcpy(param_2, (void *)(param_1 + 0x58), __n);
        *(undefined1 *)((int)param_2 + __n) = 0;
        uVar2 = *(undefined4 *)(param_1 + 0x4c);
        *param_4 = *(undefined4 *)(param_1 + 0x48);
        param_4[1] = uVar2;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__n);
    }
    return;
}

void FUN_0004a02c(int param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    if ((*(code **)(param_1 + 8) == (code *)0x0) ||
        (iVar2 = (**(code **)(param_1 + 8))(param_2), iVar2 != 0)) {
        FUN_0007a044(param_2);
        uVar3 = 0;
    } else {
        FUN_00079fa8(param_2);
        uVar3 = 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0004a0ac(int param_1, speed_t param_2, uint param_3)

{
    int iVar1;
    undefined4 uVar2;
    int *piVar3;
    cc_t *pcVar4;
    uint local_5c;
    termios local_58;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = tcgetattr(param_1, &local_58);
    if (iVar1 < 0) {
        piVar3 = __errno_location();
        iVar1 = *piVar3;
        FUN_00074e00(3, "refclock_setup fd %d tcgetattr: %m", param_1);
        *piVar3 = iVar1;
        uVar2 = 0;
    } else {
        if (param_2 != 0) {
            local_5c = 0;
            local_58.c_iflag = 0x105;
            local_58.c_oflag = 0;
            if ((param_3 & 0x100) == 0) {
                local_58.c_cflag = 0x8b0;
            } else {
                local_58.c_cflag = 0xba0;
            }
            cfsetispeed(&local_58, param_2);
            cfsetospeed(&local_58, param_2);
            pcVar4 = &local_58.c_line;
            do {
                pcVar4 = pcVar4 + 1;
                *pcVar4 = '\0';
            } while (pcVar4 != local_58.c_cc + 0x1f);
            iVar1 = ioctl(param_1, 0x5415, &local_5c);
            if (iVar1 < 0) {
                FUN_00074e00(3, "refclock_setup fd %d TIOCMGET: %m", param_1);
            }
            if (((local_5c & 0x100) != 0) && ((param_3 & 0x80) != 0)) {
                local_58.c_cflag = local_58.c_cflag & 0xfffff7ff;
            }
        }
        if ((param_3 & 0x20) == 0) {
            local_58.c_lflag = 2;
        } else {
            local_58.c_lflag = 0;
            local_58.c_iflag = 0;
            local_58.c_cc[6] = '\x01';
        }
        if ((param_3 & 0x40) != 0) {
            local_58.c_lflag = local_58.c_lflag | 8;
        }
        iVar1 = tcsetattr(param_1, 0, &local_58);
        if (iVar1 < 0) {
            piVar3 = __errno_location();
            iVar1 = *piVar3;
            FUN_00074e00(3, "refclock_setup fd %d TCSANOW: %m", param_1);
            *piVar3 = iVar1;
            uVar2 = 0;
        } else {
            iVar1 = tcflush(param_1, 2);
            if (iVar1 < 0) {
                FUN_00074e00(3, "refclock_setup fd %d tcflush(): %m", param_1);
                uVar2 = 1;
            } else {
                uVar2 = 1;
            }
        }
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0004a298(char *param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    ssize_t sVar4;
    undefined1 auStack_a4[128];
    int local_24;

    local_24 = __stack_chk_guard;
    iVar1 = open64(param_1, 0x902, 0x1ff);
    if (iVar1 == 0) {
        iVar1 = dup(0);
        piVar3 = __errno_location();
        iVar2 = *piVar3;
        close(0);
        *piVar3 = iVar2;
    }
    if (iVar1 < 0) {
        piVar3 = __errno_location();
        iVar1 = *piVar3;
        iVar2 = -1;
        FUN_00074e00(3, "refclock_open %s: %m", param_1);
        *piVar3 = iVar1;
    } else {
        iVar2 = FUN_0004a0ac(iVar1, param_2, param_3);
        if (iVar2 == 0) {
            iVar2 = -1;
            close(iVar1);
        } else {
            piVar3 = __errno_location();
            do {
                do {
                    sVar4 = read(iVar1, auStack_a4, 0x80);
                } while (0 < sVar4);
                iVar2 = iVar1;
            } while (*piVar3 == 4);
        }
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

void FUN_0004a3b4(short *param_1, int param_2, undefined1 *param_3)

{
    byte bVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    uint uVar5;
    undefined4 uVar6;
    int iVar7;
    int iVar8;
    uint uVar9;
    undefined4 uVar10;
    undefined4 uVar11;
    bool bVar12;
    double dVar13;

    iVar3 = __stack_chk_guard;
    if (*param_1 == 2) {
        uVar9 = *(uint *)(param_1 + 2);
        if (((uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10) == 0x7f7f0000) &&
            (uVar4 = FUN_00041a44(param_1, 0, 0, 0xffffffff, 0, 0),
             uVar4 != 0)) {
            iVar7 = *(int *)(uVar4 + 0x54);
            if (iVar7 == 0) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_refclock.c", 0x41c, 2,
                             "peer->procptr != ((void *)0)");
            }
            if (param_2 != 0) {
                bVar1 = *(byte *)(param_2 + 2);
                if ((bVar1 & 1) != 0) {
                    uVar10 = *(undefined4 *)(param_2 + 0x2c);
                    *(undefined4 *)(iVar7 + 0x2e8) =
                        *(undefined4 *)(param_2 + 0x28);
                    *(undefined4 *)(iVar7 + 0x2ec) = uVar10;
                }
                if ((bVar1 & 2) != 0) {
                    uVar10 = *(undefined4 *)(param_2 + 0x34);
                    *(undefined4 *)(iVar7 + 0x2f0) =
                        *(undefined4 *)(param_2 + 0x30);
                    *(undefined4 *)(iVar7 + 0x2f4) = uVar10;
                }
                bVar12 = (bVar1 & 4) != 0;
                uVar5 = uVar4;
                if (bVar12) {
                    uVar5 = (uint) * (byte *)(param_2 + 0x38);
                }
                if (bVar12) {
                    *(char *)(iVar7 + 0x2f8) = (char)uVar5;
                    *(char *)(uVar4 + 0x5d) = (char)uVar5;
                }
                if ((bVar1 & 8) != 0) {
                    uVar10 = *(undefined4 *)(param_2 + 0x3c);
                    *(undefined4 *)(iVar7 + 0x2fc) = uVar10;
                    *(undefined4 *)(uVar4 + 0x70) = uVar10;
                }
                if ((bVar1 & 0x10) != 0) {
                    *(byte *)(iVar7 + 0x300) = *(byte *)(iVar7 + 0x300) & 0xfe |
                                               *(byte *)(param_2 + 1) & 1;
                }
                if ((bVar1 & 0x20) != 0) {
                    *(byte *)(iVar7 + 0x300) = *(byte *)(iVar7 + 0x300) & 0xfd |
                                               *(byte *)(param_2 + 1) & 2;
                }
                if ((bVar1 & 0x40) != 0) {
                    *(byte *)(iVar7 + 0x300) = *(byte *)(iVar7 + 0x300) & 0xfb |
                                               *(byte *)(param_2 + 1) & 4;
                }
                if ((bVar1 & 0x80) != 0) {
                    *(byte *)(iVar7 + 0x300) = *(byte *)(iVar7 + 0x300) & 0xf7 |
                                               *(byte *)(param_2 + 1) & 8;
                }
            }
            if (param_3 != (undefined1 *)0x0) {
                bVar1 = *(byte *)(iVar7 + 0x2f8);
                uVar10 = *(undefined4 *)(iVar7 + 0x2fc);
                param_3[2] = 0xc;
                dVar13 = *(double *)(iVar7 + 0x2e8);
                *(uint *)(param_3 + 0x38) = (uint)bVar1;
                *(undefined4 *)(param_3 + 0x3c) = uVar10;
                *(double *)(param_3 + 0x28) = dVar13;
                if (dVar13 != 0.0) {
                    uVar10 = 0xd;
                }
                if (dVar13 != 0.0) {
                    param_3[2] = (char)uVar10;
                }
                dVar13 = *(double *)(iVar7 + 0x2f0);
                *(double *)(param_3 + 0x30) = dVar13;
                if (dVar13 != 0.0) {
                    param_3[2] = param_3[2] | 2;
                }
                bVar1 = *(byte *)(iVar7 + 0x300);
                param_3[1] = bVar1;
                if ((bVar1 & 1) != 0) {
                    param_3[2] = param_3[2] | 0x10;
                }
                if ((bVar1 & 2) != 0) {
                    param_3[2] = param_3[2] | 0x20;
                }
                if ((bVar1 & 4) != 0) {
                    param_3[2] = param_3[2] | 0x40;
                }
                bVar12 = (bVar1 & 8) != 0;
                if (bVar12) {
                    bVar1 = param_3[2];
                }
                if (bVar12) {
                    param_3[2] =
                        ~((byte) ~(byte)(((uint)bVar1 << 0x19) >> 0x18) >> 1);
                }
                iVar2 = current_time;
                iVar8 = *(int *)(iVar7 + 0x304);
                uVar11 = *(undefined4 *)(iVar7 + 0x30c);
                *(undefined4 *)(param_3 + 0xc) = *(undefined4 *)(iVar7 + 0x308);
                uVar10 = *(undefined4 *)(iVar7 + 0x310);
                *(int *)(param_3 + 0x1c) = iVar2 - iVar8;
                uVar6 = *(undefined4 *)(iVar7 + 0x314);
                *(undefined4 *)(param_3 + 0x10) = uVar11;
                *(undefined4 *)(param_3 + 0x14) = uVar10;
                *(undefined4 *)(param_3 + 0x18) = uVar6;
                param_3[0x41] = *(undefined1 *)(iVar7 + 0x2a);
                param_3[0x40] = *(undefined1 *)(iVar7 + 0x29);
                *param_3 = *(undefined1 *)(iVar7 + 0x2b);
                uVar10 = *(undefined4 *)(iVar7 + 0x2c);
                uVar6 = *(undefined4 *)(iVar7 + 0xb8);
                *(int *)(param_3 + 8) = iVar7 + 0x38;
                *(undefined4 *)(param_3 + 0x20) = uVar10;
                *(short *)(param_3 + 4) = (short)uVar6;
            }
            if (*(code **)(*(int *)(refclock_conf +
                                    (uVar9 >> 0x10 & 0xff) * 4) +
                           0xc) != (code *)0x0) {
                if (iVar3 == __stack_chk_guard) {
                    /* WARNING: Could not emulate address calculation at
                     * 0x0004a628 */
                    /* WARNING: Treating indirect jump as call */
                    (**(code **)(*(int *)(refclock_conf +
                                          (uVar9 >> 0x10 & 0xff) * 4) +
                                 0xc))(uVar9 >> 0x18, param_2, param_3);
                    return;
                }
                goto LAB_0004a660;
            }
        }
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
LAB_0004a660:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0004a698(short *param_1, undefined1 *param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    uint uVar5;
    uint uVar6;
    int iVar7;
    double *pdVar8;
    undefined4 uVar9;
    undefined1 *puVar10;
    double dVar11;
    undefined8 uVar12;

    iVar1 = __stack_chk_guard;
    if (*param_1 == 2) {
        uVar6 = *(uint *)(param_1 + 2);
        if ((uVar6 << 0x18 | (uVar6 >> 8 & 0xff) << 0x10) == 0x7f7f0000) {
            iVar2 = FUN_00041a44(param_1, 0, 0, 0xffffffff, 0, 0);
            if ((iVar2 != 0) && (iVar7 = *(int *)(iVar2 + 0x54), iVar7 != 0)) {
                *param_2 = 8;
                uVar4 = *(undefined4 *)(iVar7 + 0xbc);
                uVar3 = *(undefined4 *)(iVar7 + 0xc0);
                *(undefined2 *)(param_2 + 2) = 0x3f;
                *(undefined4 *)(param_2 + 8) = uVar4;
                *(undefined4 *)(param_2 + 0xc) = uVar3;
                uVar3 = *(undefined4 *)(iVar7 + 0xcc);
                uVar9 = *(undefined4 *)(iVar7 + 0xc4);
                *(undefined4 *)(param_2 + 0x14) = *(undefined4 *)(iVar7 + 200);
                *(undefined4 *)(param_2 + 0x18) = uVar3;
                uVar3 = *(undefined4 *)(iVar7 + 0xd4);
                uVar4 = *(undefined4 *)(iVar7 + 0xd8);
                *(undefined4 *)(param_2 + 0x10) = uVar9;
                uVar9 = *(undefined4 *)(iVar7 + 0xd0);
                *(undefined4 *)(param_2 + 0x20) = uVar3;
                *(undefined4 *)(param_2 + 0x24) = uVar4;
                uVar3 = *(undefined4 *)(iVar7 + 0xe0);
                uVar4 = *(undefined4 *)(iVar7 + 0xe4);
                *(undefined4 *)(param_2 + 0x1c) = uVar9;
                *(undefined4 *)(param_2 + 4) = 0xfffffffc;
                *(undefined4 *)(param_2 + 0x48) = uVar3;
                *(undefined4 *)(param_2 + 0x4c) = uVar4;
                uVar3 = *(undefined4 *)(iVar7 + 0xec);
                *(undefined4 *)(param_2 + 0x50) = *(undefined4 *)(iVar7 + 0xe8);
                *(undefined4 *)(param_2 + 0x54) = uVar3;
                if (2 < (byte)param_2[1]) {
                    pdVar8 = (double *)(iVar7 + 0x108);
                    uVar5 = 2;
                    puVar10 = param_2;
                    do {
                        dVar11 = *pdVar8;
                        pdVar8 = pdVar8 + 1;
                        if (0.0 <= dVar11) {
                            dVar11 = ldexp(dVar11, 0x20);
                            uVar12 =
                                FUN_0009c010(SUB84(dVar11, 0),
                                             (int)((ulonglong)dVar11 >> 0x20));
                        } else {
                            dVar11 = ldexp(-dVar11, 0x20);
                            uVar12 =
                                FUN_0009c010(SUB84(dVar11, 0),
                                             (int)((ulonglong)dVar11 >> 0x20));
                            uVar12 =
                                CONCAT44(-((int)((ulonglong)uVar12 >> 0x20) +
                                           (uint)((int)uVar12 != 0)),
                                         -(int)uVar12);
                        }
                        *(int *)(puVar10 + 0x5c) = (int)uVar12;
                        uVar5 = uVar5 + 1;
                        *(int *)(puVar10 + 0x58) =
                            (int)((ulonglong)uVar12 >> 0x20);
                        puVar10 = puVar10 + 8;
                    } while (uVar5 < (byte)param_2[1]);
                }
                if (*(code **)(*(int *)(refclock_conf +
                                        (uVar6 >> 0x10 & 0xff) * 4) +
                               0x14) != (code *)0x0) {
                    if (iVar1 == __stack_chk_guard) {
                        /* WARNING: Could not emulate address calculation at
                         * 0x0004a818 */
                        /* WARNING: Treating indirect jump as call */
                        (**(code **)(*(int *)(refclock_conf +
                                              (uVar6 >> 0x10 & 0xff) * 4) +
                                     0x14))(uVar6 >> 0x18, param_2, iVar2);
                        return;
                    }
                    goto LAB_0004a84c;
                }
            }
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_0004a84c:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0004a8f0) */

void FUN_0004a860(void)

{
    authkeylookups = 0;
    authkeynotfound = 0;
    authencryptions = 0;
    authdecryptions = 0;
    authkeyuncached = 0;
    auth_timereset = current_time;
    return;
}

void FUN_0004a918(void)

{
    int iVar1;
    undefined *puVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = DAT_000cc91c;
    if (DAT_000cc918 != 0) {
        DAT_000cc928 = (ushort)((DAT_000cc910 & 0xff) << 8) |
                       (ushort)(DAT_000cc910 >> 8) & 0xff;
        if (DAT_000cc920 == 0) {
            DAT_000cc924 = 0xd7;
        } else {
            DAT_000cc924 = (byte)(DAT_000cc920 << 3) | 199;
        }
        DAT_000cc925 = (byte)DAT_000ccb20 & 0x7f;
        FUN_00026a68(DAT_000ccb28, DAT_000ccb24, 0xffffffff, &DAT_000cc924,
                     DAT_000cc914 + 8);
        iVar3 = DAT_000cc91c;
        numresppkts = numresppkts + 1;
        __memcpy_chk(&DAT_000cc92c, &DAT_000cc71c, DAT_000cc91c, 500);
        DAT_000cc914 = 0;
        DAT_000cc918 = 0;
        DAT_000ccb20 = DAT_000ccb20 + 1;
    }
    DAT_000cc914 = DAT_000cc914 + iVar3;
    puVar2 = &DAT_000cc71c;
    if (DAT_000cc914 + iVar3 < 0x1f5) {
        puVar2 = &DAT_000cc92c + DAT_000cc914;
    } else if (DAT_000ccb20 == 0x7f) {
        puVar2 = (undefined *)0x0;
    } else {
        DAT_000cc918 = 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar2);
}

void FUN_0004ad58(undefined4 param_1, undefined4 param_2, undefined1 param_3,
                  undefined1 param_4, int param_5)

{
    int iVar1;
    int iVar2;
    bool bVar3;

    iVar1 = __stack_chk_guard;
    DAT_000cc928 = (ushort)((uint)(param_5 << 0xc) >> 8) & 0xff;
    iVar2 = __stack_chk_guard;
    if (DAT_000cc920 != 0) {
        iVar2 = -0x79;
    }
    if (DAT_000cc920 != 0) {
        DAT_000cc924 = (byte)iVar2 | (byte)(DAT_000cc920 << 3);
    } else {
        DAT_000cc924 = 0x97;
    }
    DAT_000cc925 = 0;
    DAT_000cc92a = 0;
    DAT_000cc926 = param_3;
    DAT_000cc927 = param_4;
    FUN_00026a68(param_1, param_2, 0xffffffff, &DAT_000cc924, 8);
    bVar3 = iVar1 == __stack_chk_guard;
    *(int *)(errorcounter + param_5 * 4) =
        *(int *)(errorcounter + param_5 * 4) + 1;
    if (bVar3) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0004b02c(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if ((DAT_000ccb20 == 0) && (DAT_000cc910 == 0)) {
        FUN_0004ad58(DAT_000ccb28, DAT_000ccb24, DAT_000cc926, DAT_000cc927, 4);
    } else {
        DAT_000cc925 = (byte)DAT_000ccb20 & 0x7f;
        DAT_000cc928 = (ushort)((DAT_000cc910 & 0xff) << 8) |
                       (ushort)(DAT_000cc910 >> 8) & 0xff;
        if (DAT_000cc920 == 0) {
            DAT_000cc924 = 0x97;
        } else {
            DAT_000cc924 = (byte)(DAT_000cc920 << 3) | 0x87;
        }
        FUN_00026a68(DAT_000ccb28, DAT_000ccb24, 0xffffffff, &DAT_000cc924,
                     DAT_000cc914 + 8);
        numresppkts = numresppkts + 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0004f478) */

void FUN_0004f3e4(void)

{
    numrequests = 0;
    numresppkts = 0;
    auth_timereset = 0;
    info_auth_keyid = 0;
    errorcounter._0_4_ = 0;
    errorcounter._4_4_ = 0;
    errorcounter._8_4_ = 0;
    errorcounter._12_4_ = 0;
    errorcounter._16_4_ = 0;
    errorcounter._20_4_ = 0;
    errorcounter._24_4_ = 0;
    errorcounter._28_4_ = 0;
    return;
}

void FUN_0004f4e4(int param_1, int param_2)

{
    byte bVar1;
    undefined1 uVar2;
    int iVar3;
    undefined4 uVar4;
    uint uVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    uint uVar9;
    uint uVar10;
    uint uVar11;
    int iVar12;
    undefined4 uVar13;
    undefined *puVar14;
    uint uVar15;
    int iVar16;
    int iVar17;
    uint uVar18;
    bool bVar19;
    double dVar20;
    undefined *local_3c;
    int local_38;

    iVar3 = __stack_chk_guard;
    bVar1 = *(byte *)(param_1 + 0x58);
    iVar12 = param_1 + 4;
    if ((char)bVar1 < '\0') {
        uVar13 = 1;
    LAB_0004f528:
        if (((ntp_syslogmask & 2) != 0) && (DAT_000ccb30 <= current_time)) {
            uVar4 = FUN_0007c2e8(iVar12);
            FUN_00074e00(3, "process_private: drop test %d failed, pkt from %s",
                         uVar13, uVar4);
            DAT_000ccb30 = current_time + 0x3c;
        }
    } else {
        if ((bVar1 & 0x40) != 0) {
            uVar13 = 2;
            goto LAB_0004f528;
        }
        uVar10 = ((uint)bVar1 << 0x1a) >> 0x1d;
        if (4 < uVar10) {
            uVar13 = 3;
            goto LAB_0004f528;
        }
        if (uVar10 == 0) {
            uVar13 = 4;
            goto LAB_0004f528;
        }
        if ((*(byte *)(param_1 + 0x59) & 0x7f) != 0) {
            uVar13 = 5;
            goto LAB_0004f528;
        }
        uVar9 = (*(ushort *)(param_1 + 0x5c) & 0xff) << 8;
        uVar5 = uVar9 | *(ushort *)(param_1 + 0x5c) >> 8;
        if (uVar9 >> 0xc != 0) {
            uVar13 = 6;
            goto LAB_0004f528;
        }
        uVar9 = (*(ushort *)(param_1 + 0x5e) & 0xff) << 8;
        uVar15 = uVar9 | *(ushort *)(param_1 + 0x5e) >> 8;
        if (uVar9 >> 0xc != 0) {
            uVar13 = 7;
            goto LAB_0004f528;
        }
        uVar9 = *(uint *)(param_1 + 0x54);
        if ((int)uVar9 < 8) {
            uVar13 = 8;
            goto LAB_0004f528;
        }
        uVar18 = (uint) * (byte *)(param_1 + 0x5a);
        uVar13 = *(undefined4 *)(param_1 + 0x3c);
        uVar11 = (uint) * (byte *)(param_1 + 0x5b);
        DAT_000cc920 = uVar10;
        if (uVar18 == 0) {
        LAB_0004f624:
            uVar4 = 2;
        LAB_0004f628:
            FUN_0004ad58(iVar12, uVar13, uVar18, uVar11, uVar4);
        } else {
            if (1 < uVar18 - 2) {
                uVar4 = 1;
                goto LAB_0004f628;
            }
            if (uVar11 != 0) {
                uVar10 = 1;
                puVar14 = &DAT_000c44f0;
                while (local_3c = puVar14 + 0xc, uVar10 != 0xffffffff) {
                    if (uVar10 == uVar11) {
                        iVar16 = (int)(short)uVar15;
                        local_38 = (int)*(short *)(puVar14 + 0x10);
                        if ((iVar16 == local_38) ||
                            (*(short *)(puVar14 + 0x12) == iVar16))
                            goto LAB_0004f6ec;
                        goto LAB_0004f6cc;
                    }
                    uVar10 = (uint) * (short *)(puVar14 + 0x18);
                    puVar14 = local_3c;
                }
                goto LAB_0004f624;
            }
            if (uVar15 != 0) {
                local_3c = &DAT_000c44f0;
                local_38 = 0;
            LAB_0004f6cc:
                if ((short)uVar15 == 0x10 &&
                    *(short *)(param_1 + 0x5a) == 0xa03) {
                    iVar16 = 0x10;
                LAB_0004f6ec:
                    if ((local_38 == 0) ||
                        (uVar10 = uVar5 * iVar16,
                         uVar10 < uVar9 - 8 || uVar10 - (uVar9 - 8) == 0))
                        goto LAB_0004f708;
                }
            LAB_0004f6e0:
                uVar4 = 3;
                goto LAB_0004f628;
            }
            local_3c = &DAT_000c44f0;
        LAB_0004f708:
            DAT_000ccb2c = (uint)(uVar18 == 3);
            iVar16 = param_1 + 0x58;
            if ((*(short *)(local_3c + 2) == 0) || (sys_authenticate == 0)) {
            LAB_0004f734:
                if (iVar3 == __stack_chk_guard) {
                    /* WARNING: Could not recover jumptable at 0x0004f760. Too
                     * many branches */
                    /* WARNING: Treating indirect jump as call */
                    (**(code **)(local_3c + 8))(iVar12, uVar13, iVar16);
                    return;
                }
                goto LAB_0004f76c;
            }
            iVar6 = uVar5 * uVar15;
            if (uVar9 < iVar6 + 0x24U)
                goto LAB_0004f6e0;
            uVar10 = iVar6 + 0x13U & 0xfffffffc;
            if (uVar10 + 0x18 < uVar9) {
                iVar6 = 0x14;
            } else {
                iVar6 = uVar9 - uVar10;
            }
            iVar7 = (uVar9 - iVar6) + -8;
            iVar17 = iVar16 + iVar7;
            if ((((*(byte *)(param_1 + 0x59) & 0x80) == 0) ||
                 (info_auth_keyid == 0)) ||
                (uVar10 = *(uint *)(iVar17 + 8),
                 info_auth_keyid !=
                     (uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                      (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18))) {
                uVar4 = 7;
                goto LAB_0004f628;
            }
            if (uVar9 < 0xd9) {
                if (param_2 == 0) {
                    sys_restricted = sys_restricted + 1;
                } else {
                    iVar8 = FUN_0007204c();
                    if (iVar8 != 0) {
                        uVar5 = *(uint *)(iVar17 + 4);
                        uVar10 = *(uint *)(iVar16 + iVar7);
                        uVar5 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                                (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
                        iVar7 =
                            (uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
                             (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18) -
                            *(int *)(param_1 + 0x48);
                        if (uVar5 < *(uint *)(param_1 + 0x4c)) {
                            iVar7 = iVar7 + -1;
                        }
                        iVar17 = uVar5 - *(uint *)(param_1 + 0x4c);
                        if (iVar7 < 0) {
                            bVar19 = iVar17 != 0;
                            iVar17 = -iVar17;
                            iVar7 = -(iVar7 + (uint)bVar19);
                        }
                        dVar20 = (double)FUN_0009bec4(iVar17, iVar7);
                        dVar20 = ldexp(dVar20, -0x20);
                        if ((dVar20 <= 10.0) &&
                            (iVar6 = FUN_00072854(info_auth_keyid, iVar16,
                                                  uVar9 - iVar6, iVar6),
                             iVar6 != 0))
                            goto LAB_0004f734;
                        uVar2 = *(undefined1 *)(param_1 + 0x5b);
                        uVar4 = 7;
                        goto LAB_0004f8a8;
                    }
                    uVar11 = (uint) * (byte *)(param_1 + 0x5b);
                }
                FUN_0004ad58(iVar12, uVar13, *(undefined1 *)(param_1 + 0x5a),
                             uVar11, 7);
            } else {
                FUN_00074e00(3, "process_private: bad pkt length %zu");
                uVar2 = *(undefined1 *)(param_1 + 0x5b);
                uVar4 = 3;
            LAB_0004f8a8:
                FUN_0004ad58(iVar12, uVar13, *(undefined1 *)(param_1 + 0x5a),
                             uVar2, uVar4);
            }
        }
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
LAB_0004f76c:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0004f994(undefined4 *param_1, int param_2)

{
    uint uVar1;
    uint uVar2;
    uint local_84;
    uint local_80;
    char acStack_7c[48];
    char acStack_4c[48];
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_2 == 0) {
        uVar2 = param_1[5];
        uVar1 = param_1[6];
        local_84 = uVar2 << 0x18 | (uVar2 >> 8 & 0xff) << 0x10 |
                   (uVar2 >> 0x10 & 0xff) << 8 | uVar2 >> 0x18;
        local_80 = uVar1 << 0x18 | (uVar1 >> 8 & 0xff) << 0x10 |
                   (uVar1 >> 0x10 & 0xff) << 8 | uVar1 >> 0x18;
        inet_ntop(2, &local_84, acStack_7c, 0x2e);
        inet_ntop(2, &local_80, acStack_4c, 0x2e);
    } else {
        inet_ntop(10, param_1 + 5, acStack_7c, 0x2e);
        inet_ntop(10, param_1 + 9, acStack_4c, 0x2e);
    }
    FUN_00074d28("restrict node at %p: %s/%s count %d, rflags %05x, mflags "
                 "%05x, ippeerlimit %d, expire %lu, next %p\n",
                 param_1, acStack_7c, acStack_4c, param_1[1],
                 *(undefined2 *)(param_1 + 2),
                 *(undefined2 *)((int)param_1 + 10),
                 (int)*(short *)(param_1 + 3), param_1[4], *param_1);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0004faa4(undefined4 *param_1, int param_2)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *puVar3;
    undefined4 *puVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    DAT_000ccb3c = DAT_000ccb3c + -1;
    if (((*(ushort *)(param_1 + 2) & 0x40) != 0) &&
        (DAT_000ccb40 = DAT_000ccb40 + -1, DAT_000ccb40 == 0)) {
        FUN_00040dfc(2);
    }
    if (param_2 == 0) {
        puVar3 = &restrictlist4;
    } else {
        puVar3 = &restrictlist6;
    }
    puVar2 = (undefined4 *)*puVar3;
    puVar4 = param_1;
    if (param_1 == puVar2) {
    LAB_0004fb50:
        *puVar3 = *puVar4;
        if (param_1 == puVar4) {
            if (param_2 == 0) {
                *param_1 = 0;
                param_1[1] = 0;
                param_1[2] = 0;
                puVar3 = &DAT_000ccb38;
                param_1[3] = 0;
                param_1[4] = 0;
                param_1[5] = 0;
                param_1[6] = 0;
            } else {
                memset(param_1, 0, 0x34);
                puVar3 = &DAT_000ccb34;
            }
            bVar5 = iVar1 == __stack_chk_guard;
            *param_1 = *puVar3;
            *puVar3 = param_1;
            if (bVar5) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
    } else if (puVar2 != (undefined4 *)0x0) {
        puVar3 = puVar2;
        for (puVar4 = (undefined4 *)*puVar2; puVar4 != (undefined4 *)0x0;
             puVar4 = (undefined4 *)*puVar4) {
            if (puVar4 == param_1)
                goto LAB_0004fb50;
            puVar3 = puVar4;
        }
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("ntp_restrict.c", 0x132, 2, "unlinked == res");
}

void FUN_0004fc3c(uint param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    int *piVar3;
    int *piVar4;

    iVar1 = __stack_chk_guard;
    piVar3 = restrictlist4;
    if (restrictlist4 != (int *)0x0) {
        do {
            piVar4 = (int *)*piVar3;
            if ((piVar3[4] != 0) && ((uint)piVar3[4] <= current_time)) {
                FUN_0004faa4(piVar3, 0);
            }
            if (piVar3[5] == (piVar3[6] & param_1)) {
                uVar2 =
                    ((*(ushort *)((int)piVar3 + 10) ^ 0x2000) << 0x12) >> 0x1f;
                if (param_2 == 0x7b) {
                    uVar2 = 1;
                }
                if (uVar2 != 0)
                    goto LAB_0004fcd4;
            }
            piVar3 = piVar4;
        } while (piVar4 != (int *)0x0);
    }
    piVar3 = (int *)0x0;
LAB_0004fcd4:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(piVar3);
    }
    return;
}

void FUN_0004fd1c(int param_1, int param_2)

{
    byte *pbVar1;
    int iVar2;
    byte *pbVar3;
    uint uVar4;
    int *piVar5;
    int *piVar6;
    byte *pbVar7;
    bool bVar8;
    byte bStack_3d;
    byte local_3c[16];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (restrictlist6 == (int *)0x0) {
    LAB_0004fe1c:
        piVar5 = (int *)0x0;
    LAB_0004fe20:
        if (local_2c != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(piVar5);
        }
        return;
    }
    if (restrictlist6 != (int *)*restrictlist6) {
        piVar5 = restrictlist6;
        piVar6 = (int *)*restrictlist6;
        do {
            if ((piVar5[4] != 0) && ((uint)piVar5[4] <= current_time)) {
                FUN_0004faa4(piVar5, 1);
            }
            pbVar7 = (byte *)((int)piVar5 + 0x23);
            pbVar1 = &bStack_3d;
            pbVar3 = (byte *)(param_1 + -1);
            do {
                pbVar3 = pbVar3 + 1;
                pbVar7 = pbVar7 + 1;
                pbVar1 = pbVar1 + 1;
                *pbVar1 = *pbVar3 & *pbVar7;
            } while (pbVar3 != (byte *)(param_1 + 0xf));
            iVar2 = memcmp(local_3c, piVar5 + 5, 0x10);
            if (iVar2 == 0) {
                uVar4 =
                    ((*(ushort *)((int)piVar5 + 10) ^ 0x2000) << 0x12) >> 0x1f;
                if (param_2 == 0x7b) {
                    uVar4 = 1;
                }
                if (uVar4 != 0)
                    goto LAB_0004fe20;
            }
            if (piVar6 == (int *)0x0)
                goto LAB_0004fe1c;
            bVar8 = piVar6 != (int *)*piVar6;
            piVar5 = piVar6;
            piVar6 = (int *)*piVar6;
        } while (bVar8);
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("ntp_restrict.c", 0x17d, 2, "next != res");
}

void FUN_0004fe78(void)

{
    int iVar1;
    undefined4 *puVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    puVar2 = &DAT_000ccb44;
    FUN_00074d28("dump_restrict: restrict_def4: %p\n");
    do {
        FUN_0004f994(puVar2, 0);
        puVar2 = (undefined4 *)*puVar2;
    } while (puVar2 != (undefined4 *)0x0);
    puVar2 = &DAT_000ccb78;
    FUN_00074d28("dump_restrict: restrict_def6: %p\n");
    do {
        FUN_0004f994(puVar2, 1);
        puVar2 = (undefined4 *)*puVar2;
    } while (puVar2 != (undefined4 *)0x0);
    FUN_00074d28("dump_restrict: restrictlist4: %p\n", &restrictlist4);
    for (piVar3 = (int *)restrictlist4; piVar3 != (int *)0x0;
         piVar3 = (int *)*piVar3) {
        FUN_0004f994(piVar3, 0);
    }
    FUN_00074d28("dump_restrict: restrictlist6: %p\n", &restrictlist6);
    for (piVar3 = (int *)restrictlist6; piVar3 != (int *)0x0;
         piVar3 = (int *)*piVar3) {
        FUN_0004f994(piVar3, 1);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0005003c) */

void FUN_0004ffbc(void)

{
    DAT_000ccb50 = 0xffff;
    DAT_000ccb84 = 0xffff;
    DAT_000ccb44 = restrictlist4;
    restrictlist4 = &DAT_000ccb44;
    DAT_000ccb78 = restrictlist6;
    DAT_000ccb3c = 2;
    restrictlist6 = &DAT_000ccb78;
    return;
}

void FUN_00050054(short *param_1, undefined2 *param_2)

{
    short sVar1;
    undefined2 uVar2;
    int iVar3;
    uint uVar4;
    undefined4 *puVar5;

    iVar3 = __stack_chk_guard;
    if (param_2 == (undefined2 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_restrict.c", 0x1ff, 0, "((void *)0) != r4a");
    }
    sVar1 = *param_1;
    *param_2 = 1;
    param_2[1] = 0;
    DAT_000ccbac = DAT_000ccbac + 1;
    if (sVar1 == 2) {
        uVar4 = *(uint *)(param_1 + 2);
        if ((uVar4 << 0x18 & 0xf0000000) == 0xe0000000) {
            param_2[1] = 2;
            goto LAB_000500b8;
        }
        puVar5 = (undefined4 *)FUN_0004fc3c(
            uVar4 << 0x18 | (uVar4 >> 8 & 0xff) << 0x10 |
                (uVar4 >> 0x10 & 0xff) << 8 | uVar4 >> 0x18,
            param_1[1] << 8 | (ushort)param_1[1] >> 8);
        if (puVar5 == (undefined4 *)0x0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_restrict.c", 0x217, 2, "match != ((void *)0)");
        }
        sVar1 = *param_1;
        puVar5[1] = puVar5[1] + 1;
        if (puVar5 == &DAT_000ccb44) {
            DAT_000ccbb0 = DAT_000ccbb0 + 1;
        } else {
            DAT_000ccbb4 = DAT_000ccbb4 + 1;
        }
        uVar2 = *(undefined2 *)(puVar5 + 3);
        *param_2 = *(undefined2 *)(puVar5 + 2);
        param_2[1] = uVar2;
    }
    if ((sVar1 == 10) && ((char)param_1[4] != -1)) {
        puVar5 = (undefined4 *)FUN_0004fd1c(
            param_1 + 4, param_1[1] << 8 | (ushort)param_1[1] >> 8);
        if (puVar5 == (undefined4 *)0x0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_restrict.c", 0x234, 2, "match != ((void *)0)");
        }
        puVar5[1] = puVar5[1] + 1;
        if (puVar5 == &DAT_000ccb78) {
            DAT_000ccbb0 = DAT_000ccbb0 + 1;
        } else {
            DAT_000ccbb4 = DAT_000ccbb4 + 1;
        }
        uVar2 = *(undefined2 *)(puVar5 + 3);
        *param_2 = *(undefined2 *)(puVar5 + 2);
        param_2[1] = uVar2;
    }
LAB_000500b8:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING (jumptable): Heritage AFTER dead removal. Revisit: 0xffffffac */
/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_00050238(uint param_1, short *param_2, int param_3, undefined2 param_4,
                  ushort param_5, ushort param_6, undefined4 param_7)

{
    byte *pbVar1;
    undefined4 **ppuVar2;
    int iVar3;
    undefined4 uVar4;
    uint uVar5;
    undefined4 uVar6;
    undefined4 *puVar7;
    undefined4 *puVar8;
    uint uVar9;
    undefined4 uVar10;
    ushort uVar11;
    undefined4 uVar12;
    undefined4 *puVar13;
    undefined4 **ppuVar14;
    undefined4 **ppuVar15;
    size_t __n;
    byte *pbVar16;
    byte *pbVar17;
    undefined4 *puVar18;
    undefined4 *puVar19;
    int local_68;
    undefined4 local_60;
    undefined4 uStack_5c;
    undefined4 local_58;
    undefined4 local_54;
    undefined4 local_50;
    uint local_4c;
    uint local_48;
    undefined4 local_3c;
    undefined4 uStack_38;
    undefined4 uStack_34;
    undefined4 uStack_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 == (short *)0x0) {
        if (param_3 != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_restrict.c", 0x26b, 0, "((void *)0) == resmask");
        }
        if (param_1 != 1) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_restrict.c", 0x26c, 0, "RESTRICT_FLAGS == op");
        }
        DAT_000ccbb8 = param_6;
        DAT_000ccbba = param_5;
        DAT_000ccbc0 = 1;
        DAT_000ccbbc = param_4;
    } else {
        puVar8 = &local_60;
        memset(puVar8, 0, 0x34);
        if (*param_2 == 2) {
            uVar9 = *(uint *)(param_2 + 2);
            uVar5 = *(uint *)(param_3 + 4);
            __n = 8;
            local_68 = 0;
            local_48 = uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                       (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18;
            local_4c = (uVar9 << 0x18 | (uVar9 >> 8 & 0xff) << 0x10 |
                        (uVar9 >> 0x10 & 0xff) << 8 | uVar9 >> 0x18) &
                       local_48;
            puVar13 = restrictlist4;
        } else {
            if (*param_2 != 10) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("ntp_restrict.c", 0x292, 0, "0");
            }
            pbVar17 = (byte *)((int)param_2 + 7);
            pbVar16 = (byte *)((int)&local_50 + 3);
            local_3c = *(undefined4 *)(param_3 + 8);
            uStack_38 = *(undefined4 *)(param_3 + 0xc);
            uStack_34 = *(undefined4 *)(param_3 + 0x10);
            uStack_30 = *(undefined4 *)(param_3 + 0x14);
            do {
                pbVar17 = pbVar17 + 1;
                pbVar1 = pbVar16 + 0x11;
                pbVar16 = pbVar16 + 1;
                *pbVar16 = *pbVar17 & *pbVar1;
            } while (pbVar17 != (byte *)((int)param_2 + 0x17));
            __n = 0x20;
            local_68 = 1;
            puVar13 = restrictlist6;
        }
        local_50 = param_7;
        local_58 = CONCAT22(param_5, param_6);
        local_54 = CONCAT22((short)((uint)local_54 >> 0x10), param_4);
        if (puVar13 != (undefined4 *)0x0) {
            do {
                uVar11 = *(ushort *)((int)puVar13 + 10);
                if ((param_5 == uVar11) &&
                    (iVar3 = memcmp(puVar13 + 5, &local_4c, __n), iVar3 == 0)) {
                    switch (param_1) {
                    case 1:
                        uVar11 = *(ushort *)(puVar13 + 2);
                        if (((param_6 & 0x40) != 0) && ((uVar11 & 0x40) == 0)) {
                            if (DAT_000ccb40 == 0) {
                                FUN_00040cd4(2);
                                uVar11 = *(ushort *)(puVar13 + 2);
                            }
                            DAT_000ccb40 = DAT_000ccb40 + 1;
                        }
                        *(ushort *)(puVar13 + 2) = param_6 | uVar11;
                        goto LAB_0005045c;
                    case 2:
                        uVar11 = *(ushort *)(puVar13 + 2);
                        if ((((uVar11 & 0x40) != 0) &&
                             ((param_6 & 0x40) != 0)) &&
                            (DAT_000ccb40 = DAT_000ccb40 + -1,
                             DAT_000ccb40 == 0)) {
                            FUN_00040dfc(2);
                            uVar11 = *(ushort *)(puVar13 + 2);
                        }
                        *(ushort *)(puVar13 + 2) = uVar11 & ~param_6;
                        goto LAB_000503d0;
                    case 3:
                        break;
                    case 4:
                        break;
                    default:
                        goto switchD_00050348_default;
                    }
                    if (((param_1 != 4) && ((uVar11 & 0x1000) != 0)) ||
                        (puVar13 == &DAT_000ccb44 || puVar13 == &DAT_000ccb78))
                        goto LAB_000503d0;
                    if (local_2c == __stack_chk_guard) {
                        FUN_0004faa4(puVar13, local_68);
                        return;
                    }
                    goto LAB_00050774;
                }
                puVar13 = (undefined4 *)*puVar13;
            } while (puVar13 != (undefined4 *)0x0);
        }
        if (param_1 == 1) {
            if (local_68 == 0) {
                if (DAT_000ccb38 == (undefined4 *)0x0) {
                    puVar13 = (undefined4 *)FUN_00073c68(0, 0x24, 0x1c, 0);
                    puVar8 = DAT_000ccb38;
                    puVar7 = puVar13 + 0xf5;
                    do {
                        DAT_000ccb38 = puVar7;
                        *DAT_000ccb38 = puVar8;
                        puVar8 = DAT_000ccb38;
                        puVar7 = DAT_000ccb38 + -7;
                    } while (puVar13 != DAT_000ccb38 + -7);
                } else {
                    puVar13 = DAT_000ccb38;
                    DAT_000ccb38 = (undefined4 *)*DAT_000ccb38;
                }
                *puVar13 = local_60;
                puVar13[1] = uStack_5c;
                puVar13[2] = local_58;
                puVar13[3] = local_54;
                puVar13[4] = local_50;
                puVar13[5] = local_4c;
                puVar13[6] = local_48;
                ppuVar15 = &restrictlist4;
            } else {
                if (DAT_000ccb34 == (undefined4 *)0x0) {
                    puVar13 = (undefined4 *)FUN_00073c68(0, 0x13, 0x34, 0);
                    puVar7 = DAT_000ccb34;
                    puVar18 = puVar13 + 0xea;
                    do {
                        DAT_000ccb34 = puVar18;
                        *DAT_000ccb34 = puVar7;
                        puVar7 = DAT_000ccb34;
                        puVar18 = DAT_000ccb34 + -0xd;
                    } while (puVar13 != DAT_000ccb34 + -0xd);
                } else {
                    puVar13 = DAT_000ccb34;
                    DAT_000ccb34 = (undefined4 *)*DAT_000ccb34;
                }
                puVar7 = puVar13;
                do {
                    puVar18 = puVar7 + 4;
                    uVar4 = *puVar8;
                    uVar6 = puVar8[1];
                    uVar10 = puVar8[2];
                    uVar12 = puVar8[3];
                    puVar19 = puVar8 + 4;
                    puVar8 = puVar8 + 4;
                    *puVar7 = uVar4;
                    puVar7[1] = uVar6;
                    puVar7[2] = uVar10;
                    puVar7[3] = uVar12;
                    puVar7 = puVar18;
                } while (puVar19 != &uStack_30);
                *puVar18 = *puVar8;
                ppuVar15 = &restrictlist6;
            }
            ppuVar2 = (undefined4 **)*ppuVar15;
            do {
                ppuVar14 = ppuVar2;
                if (ppuVar14 == (undefined4 **)0x0) {
                LAB_00050594:
                    *puVar13 = ppuVar14;
                    *ppuVar15 = puVar13;
                    goto LAB_0005059c;
                }
                if (local_68 == 0) {
                    if ((undefined4 *)puVar13[5] <= ppuVar14[5]) {
                        if (ppuVar14[5] <= (undefined4 *)puVar13[5]) {
                            if (ppuVar14[6] < (undefined4 *)puVar13[6])
                                goto LAB_00050594;
                            if (ppuVar14[6] <= (undefined4 *)puVar13[6])
                                goto LAB_00050670;
                        }
                        goto LAB_00050680;
                    }
                    goto LAB_00050594;
                }
                iVar3 = memcmp(puVar13 + 5, ppuVar14 + 5, 0x10);
                if (0 < iVar3)
                    goto LAB_00050594;
                if (iVar3 == 0) {
                    iVar3 = memcmp(puVar13 + 9, ppuVar14 + 9, 0x10);
                    if (0 < iVar3)
                        goto LAB_00050594;
                    if (iVar3 == 0) {
                    LAB_00050670:
                        if (*(ushort *)((int)ppuVar14 + 10) <
                            *(ushort *)((int)puVar13 + 10))
                            goto LAB_00050594;
                    }
                }
            LAB_00050680:
                ppuVar2 = (undefined4 **)*ppuVar14;
                ppuVar15 = ppuVar14;
            } while ((undefined4 **)*ppuVar14 != (undefined4 **)0x0);
            *puVar13 = 0;
            *ppuVar14 = puVar13;
        LAB_0005059c:
            DAT_000ccb3c = DAT_000ccb3c + 1;
            if ((param_6 & 0x40) != 0) {
                if (DAT_000ccb40 == 0) {
                    FUN_00040cd4(2);
                }
                DAT_000ccb40 = DAT_000ccb40 + 1;
            }
        LAB_0005045c:
            *(undefined2 *)(puVar13 + 3) = (undefined2)local_54;
        } else if ((param_1 == 0) || (4 < param_1)) {
        switchD_00050348_default:
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_restrict.c", 0x2de, 2, "0");
        }
    }
LAB_000503d0:
    if (local_2c == __stack_chk_guard) {
        return;
    }
LAB_00050774:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00050824(short *param_1, int param_2, int param_3)

{
    short sVar1;
    uint uVar2;
    bool bVar3;
    bool bVar4;
    int iVar5;
    int iVar6;
    uint uVar7;
    short local_38[14];
    int local_1c;

    local_1c = __stack_chk_guard;
    if (DAT_000ccbc0 == 0)
        goto LAB_0005089c;
    sVar1 = *param_1;
    if (sVar1 == 2) {
        uVar7 = *(uint *)(param_1 + 2);
        if (uVar7 == 0)
            goto LAB_0005089c;
        uVar2 = uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10;
        if (((uVar7 << 0x18 & 0xf0000000) == 0xe0000000) ||
            (uVar2 == 0x7f7f0000))
            goto LAB_0005089c;
        local_38[4] = 0;
        local_38[1] = 0;
        local_38[5] = 0;
        local_38[6] = 0;
        local_38[7] = 0;
        local_38[8] = 0;
        local_38[9] = 0;
        local_38[10] = 0;
        local_38[0xb] = 0;
        local_38[0xc] = 0;
        local_38[0xd] = 0;
        local_38[2] = 0xffff;
        local_38[3] = 0xffff;
        if (param_2 != 0)
            goto LAB_00050a0c;
        local_38[0] = sVar1;
        iVar5 =
            FUN_0004fc3c(uVar2 | (uVar7 >> 0x10 & 0xff) << 8 | uVar7 >> 0x18,
                         param_1[1] << 8 | (ushort)param_1[1] >> 8);
        if (iVar5 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_restrict.c", 0x30d, 2, "res != ((void *)0)");
        }
        bVar3 = *(uint *)(iVar5 + 0x18) ==
                (CONCAT22(local_38[3], local_38[2]) << 0x18 |
                 (uint)((ushort)local_38[2] >> 8) << 0x10 |
                 ((ushort)local_38[3] & 0xff) << 8 |
                 (uint)((ushort)local_38[3] >> 8));
    } else {
        if (((((*(int *)(param_1 + 4) == 0) && (*(int *)(param_1 + 6) == 0)) &&
              (*(int *)(param_1 + 8) == 0)) &&
             (*(int *)(param_1 + 10) == 0)) ||
            ((char)param_1[4] == -1))
            goto LAB_0005089c;
        if (sVar1 != 10) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0(
                "ntp_restrict.c", 0x2f8, 0,
                "2 == ((addr)->sa.sa_family) || 10 == ((addr)->sa.sa_family)");
        }
        local_38[3] = 0;
        local_38[0xc] = 0;
        local_38[1] = 0;
        local_38[2] = 0;
        local_38[0xd] = 0;
        local_38[6] = 0xffff;
        local_38[7] = 0xffff;
        local_38[4] = 0xffff;
        local_38[5] = 0xffff;
        local_38[8] = 0xffff;
        local_38[9] = 0xffff;
        local_38[10] = 0xffff;
        local_38[0xb] = 0xffff;
        if (param_2 != 0) {
        LAB_00050a0c:
            local_38[0xd] = 0;
            local_38[0xc] = 0;
            local_38[1] = 0;
            local_38[0] = sVar1;
            FUN_00050238(3, param_1, local_38, 0xfffffffe, 0, 0, 0);
            goto LAB_0005089c;
        }
        local_38[0] = sVar1;
        iVar5 = FUN_0004fd1c(param_1 + 4,
                             param_1[1] << 8 | (ushort)param_1[1] >> 8);
        if (iVar5 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_restrict.c", 0x312, 2, "res != ((void *)0)");
        }
        iVar6 = memcmp((void *)(iVar5 + 0x24), local_38 + 4, 0x10);
        bVar3 = iVar6 == 0;
    }
    bVar4 = bVar3;
    if (param_3 != 0) {
        bVar4 = false;
    }
    if (bVar4) {
        if (*(int *)(iVar5 + 0x10) == 0)
            goto LAB_0005089c;
        FUN_0004faa4(iVar5, *param_1 == 10);
    } else if (bVar3)
        goto LAB_0005089c;
    FUN_00050238(1, param_1, local_38, (int)DAT_000ccbbc, DAT_000ccbba,
                 DAT_000ccbb8, param_3);
LAB_0005089c:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00050c14(void)

{
    int iVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    itimer._0_4_ = 0;
    itimer._4_4_ = 0;
    itimer._8_4_ = 0;
    itimer._12_4_ = 0;
    getitimer(ITIMER_REAL, (itimerval *)itimer);
    iVar1 = __stack_chk_guard;
    if ((uint)itimer._8_4_ < 2) {
        if ((int)itimer._12_4_ < 0) {
            itimer._12_4_ = 0;
            if (itimer._8_4_ == 0) {
                itimer._8_4_ = 1;
            }
        } else if ((itimer._8_4_ == 0) && (itimer._12_4_ == 0)) {
            itimer._8_4_ = 1;
        }
    } else {
        itimer._8_4_ = 1;
        if ((int)itimer._12_4_ < 0) {
            itimer._12_4_ = 0;
        }
    }
    itimer._0_4_ = 1;
    itimer._4_4_ = 0;
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    iVar2 = setitimer(ITIMER_REAL, (itimerval *)itimer, (itimerval *)0x0);
    if (iVar2 == -1) {
        FUN_00074e00(3, "interval timer %s failed, %m", "setitimer");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00050cf0(void)

{
    int iVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    alarm_flag = 0;
    alarm_overflow = 0;
    DAT_000ccbc8 = 0xe10;
    DAT_000ccbc4 = 1;
    DAT_000ccbcc = "comp";
    DAT_000ccbd0 = 0;
    DAT_000ccbd4 = 0;
    current_time = 0;
    timer_overflows = 0;
    timer_xmtcalls = 0;
    timer_timereset = 0;
    FUN_0007d6f0(0xe, &DAT_00050aec);
    iVar1 = __stack_chk_guard;
    itimer._8_4_ = 1;
    itimer._0_4_ = 1;
    itimer._12_4_ = 0;
    itimer._4_4_ = 0;
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    iVar2 = setitimer(ITIMER_REAL, (itimerval *)itimer, (itimerval *)0x0);
    if (iVar2 != -1) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    FUN_00074e00(3, "interval timer %s failed, %m", "setitimer");
    /* WARNING: Subroutine does not return */
    exit(1);
}

/* WARNING: Removing unreachable block (ram,0x00050e68) */

void FUN_00050dfc(int param_1)

{
    if (param_1 == 0) {
        DAT_000ccbd8 = 0;
    } else {
        DAT_000ccbd8 = current_time + param_1;
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00050ec4) */

void FUN_00050e80(undefined4 param_1)

{
    DAT_000ccbd4 = param_1;
    return;
}

void FUN_00050ed4(void)

{
    uint *puVar1;
    char cVar2;
    int *piVar3;
    int iVar4;
    undefined4 uVar5;
    uint uVar6;
    int iVar7;
    char *pcVar8;
    int *piVar9;
    uint uVar10;
    bool bVar11;
    double dVar12;
    time_t tStack_5c;
    undefined4 local_58[2];
    undefined1 auStack_50[16];
    uint local_40;
    short local_3c;
    short local_3a;
    short local_38;
    byte local_36;
    char local_35;
    int local_2c;

    local_2c = __stack_chk_guard;
    current_time = (char *)((int)current_time + 1);
    piVar3 = peer_list;
    if (current_time < DAT_000ccbc4) {
    joined_r0x00050f2c:
        if (piVar3 != (int *)0x0) {
            do {
                piVar9 = (int *)*piVar3;
                if (0 < piVar3[0xb2]) {
                    piVar3[0xb2] = piVar3[0xb2] + -1;
                }
                if ((char *)piVar3[0xb4] <= current_time) {
                    if ((piVar3[0x11] & 8U) == 0)
                        goto code_r0x00050f70;
                    FUN_0004992c();
                }
                piVar3 = piVar9;
                if (piVar9 == (int *)0x0)
                    break;
            } while (true);
        }
        goto LAB_00050f7c;
    }
    DAT_000ccbc4 = DAT_000ccbc4 + 1;
    FUN_000401e4();
    piVar9 = peer_list;
    if (peer_list != (int *)0x0) {
        do {
            puVar1 = (uint *)(piVar9 + 0x11);
            piVar9 = (int *)*piVar9;
            if ((*puVar1 & 8) != 0) {
                FUN_0004987c();
            }
            piVar3 = peer_list;
        } while (piVar9 != (int *)0x0);
        goto joined_r0x00050f2c;
    }
LAB_00050f7c:
    if ((((int)sys_orphan < 0x10) && (sys_peer == 0)) &&
        (orphwait < current_time)) {
        if ((sys_leap == '\x03') && (FUN_000435a4(), crypto_flags != 0)) {
            FUN_000379fc();
        }
        sys_stratum = (undefined1)sys_orphan;
        if ((sys_orphan & 0xff) < 2) {
            sys_refid = 0x504f4f4c;
        } else {
            sys_refid = 0x100007f;
        }
        sys_offset._0_4_ = 0;
        sys_offset._4_4_ = 0;
        sys_rootdelay._0_4_ = 0;
        sys_rootdelay._4_4_ = 0;
        sys_rootdisp._0_4_ = 0;
        sys_rootdisp._4_4_ = 0;
    }
    FUN_0006f724(local_58);
    time(&tStack_5c);
    uVar5 = local_58[0];
    cVar2 = sys_leap;
    if ((leapsec == 0) && (((uint)current_time & 7) != 0)) {
        if (sys_leap == '\x03')
            goto LAB_000510b8;
    } else {
        iVar4 = pll_control;
        if ((pll_control != 0) && (iVar4 = kern_enable, kern_enable != 0)) {
            iVar4 = 1;
        }
        FUN_0003d220(iVar4);
        if (cVar2 == '\x03') {
            FUN_0003db18();
            memset(auStack_50, 0, 0x20);
            if (leapsec != 0) {
                iVar4 = 0;
            LAB_00051308:
                uVar10 = 0;
                FUN_00035ee0(10, 0);
                goto LAB_0005131c;
            }
            uVar6 = 0;
            iVar4 = 0;
        LAB_00051048:
            leapdif = 0;
        } else {
            iVar4 = FUN_0003d7d0(auStack_50, uVar5, &tStack_5c);
            if (iVar4 != 0) {
                dVar12 = (double)(longlong)(int)local_38;
                if (dVar12 < 0.0) {
                    if (clock_max_back <= 0.0) {
                        pcVar8 =
                            "Positive leap second, no step correction. System "
                            "clock will be inaccurate for a long time.";
                    } else if (clock_max_back < -dVar12) {
                        FUN_0006ff34();
                        pcVar8 = "Positive leap second, stepped backward.";
                    } else {
                        pcVar8 =
                            "Positive leap second, no step correction. System "
                            "clock will be inaccurate for a long time.";
                    }
                LAB_00051228:
                    FUN_00074e00(5, "%s", pcVar8);
                } else if (dVar12 != 0.0 && dVar12 >= 0.0) {
                    if (clock_max_fwd <= 0.0) {
                        pcVar8 =
                            "Negative leap second, no step correction. System "
                            "clock will be inaccurate for a long time.";
                    } else if (clock_max_fwd < dVar12) {
                        FUN_0006ff34();
                        pcVar8 = "Negative leap second, stepped forward.";
                    } else {
                        pcVar8 =
                            "Negative leap second, no step correction. System "
                            "clock will be inaccurate for a long time.";
                    }
                    goto LAB_00051228;
                }
                iVar4 = 1;
                FUN_00035ee0(0xb, 0);
                leapsec = 0;
                uVar6 = (uint)(local_40 < 3);
                sys_tai = (int)local_3c;
                if (local_3a == 0) {
                    uVar6 = 0;
                }
                goto LAB_00051048;
            }
            iVar7 = (int)local_3c;
            uVar10 = (uint)local_36;
            iVar4 = sys_tai - iVar7;
            if (iVar4 != 0) {
                iVar4 = 1;
            }
            sys_tai = iVar7;
            if (leapsec == 0) {
                if (1 < uVar10 - 1) {
                    uVar6 = (uint)(local_40 < 3);
                    if (local_3a == 0) {
                        uVar6 = 0;
                    }
                    goto LAB_00051048;
                }
                if (local_35 == '\0') {
                    FUN_00035ee0(9, 0, 0);
                } else {
                    FUN_00035ee0(0x89, sys_peer);
                }
            LAB_0005131c:
                leapdif = (int)local_3a;
                uVar6 = (uint)(local_40 < 3);
                if (leapdif == 0) {
                    uVar6 = 0;
                }
                leapsec = uVar10;
                if (uVar10 == 0)
                    goto LAB_00051048;
            } else {
                if (leapsec < uVar10)
                    goto LAB_0005131c;
                if (uVar10 < leapsec) {
                    if (uVar10 == 0)
                        goto LAB_00051308;
                    goto LAB_0005131c;
                }
                leapdif = (int)local_3a;
                uVar6 = (uint)(local_40 < 3);
                if (leapdif == 0) {
                    uVar6 = 0;
                }
            }
        }
        bVar11 = leap_sec_in_progress != uVar6;
        leap_sec_in_progress = uVar6;
        if (bVar11) {
            FUN_000435a4(sys_leap);
        }
        if (iVar4 != 0) {
            FUN_00037aa0();
        }
        if (sys_leap == '\x03')
            goto LAB_000510b8;
        if ((1 < leapsec) && (leapdif != 0)) {
            if (leapdif < 1) {
                uVar5 = 2;
            } else {
                uVar5 = 1;
            }
            FUN_000435a4(uVar5);
            goto LAB_000510b8;
        }
    }
    FUN_000435a4(0);
LAB_000510b8:
    if (DAT_000ccbd0 <= current_time) {
        DAT_000ccbd0 = DAT_000ccbd0 + 900;
        FUN_00040520();
    }
    if (DAT_000ccbdc <= current_time) {
        DAT_000ccbdc = DAT_000ccbdc + (1 << (uint)sys_automax);
        FUN_000726d0();
    }
    if ((DAT_000ccbe0 != (char *)0x0) && (DAT_000ccbe0 <= current_time)) {
        DAT_000ccbe0 = DAT_000ccbe0 + (1 << sys_revoke);
        RAND_bytes((uchar *)&sys_private, 4);
    }
    if ((interface_interval != 0) && (DAT_000ccbd4 <= current_time)) {
        FUN_00050e80(current_time + interface_interval);
        FUN_00028908(0);
    }
    if ((DAT_000ccbd8 != (char *)0x0) && (DAT_000ccbd8 <= current_time)) {
        FUN_00079654();
    }
    if (DAT_000ccbc8 <= current_time) {
        DAT_000ccbc8 = DAT_000ccbc8 + 0xe10;
        FUN_000519e0();
        bVar11 = DAT_000ccbcc <= current_time;
        if (bVar11) {
            DAT_000ccbcc = "drift_comp" + (int)(DAT_000ccbcc + 6);
        }
        FUN_00052670(bVar11, local_58[0], &tStack_5c);
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
code_r0x00050f70:
    FUN_00046448();
    piVar3 = piVar9;
    goto joined_r0x00050f2c;
}

/* WARNING: Removing unreachable block (ram,0x000516b4) */

void FUN_00051648(void)

{
    timer_overflows = 0;
    timer_xmtcalls = 0;
    timer_timereset = current_time;
    return;
}

void ntpd_time_stepped(void)

{
    int iVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    iVar1 = mon_enabled;
    if (mon_enabled == 0) {
        return;
    }
    FUN_00040dfc(0);
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    FUN_00040cd4(iVar1);
    return;
}

void FUN_00051754(int param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    char *pcVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_0003dc54(param_2, param_3);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            FUN_00074e00(4, "%s (\'%s\'): will expire in less than one day",
                         "leapsecond file", DAT_000ccbe8);
            return;
        }
    } else {
        if (param_1 != 0 && iVar2 < 0x1c) {
            if (iVar2 < 0) {
                if (iVar2 == -1) {
                    pcVar3 = "";
                } else {
                    pcVar3 = "s";
                }
                FUN_00074e00(3, "%s (\'%s\'): expired less than %d day%s ago",
                             "leapsecond file", DAT_000ccbe8, -iVar2, pcVar3);
            } else {
                FUN_00074e00(4, "%s (\'%s\'): will expire in less than %d days",
                             "leapsecond file", DAT_000ccbe8, iVar2 + 1);
            }
        }
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000518a8(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_0003c7bc(statsdir, "peerstats", &DAT_000ccbec);
    FUN_0003c7bc(statsdir, "loopstats", &DAT_000ccc04);
    FUN_0003c7bc(statsdir, "clockstats", &DAT_000ccc1c);
    FUN_0003c7bc(statsdir, "rawstats", &DAT_000ccc34);
    FUN_0003c7bc(statsdir, "sysstats", &DAT_000ccc4c);
    FUN_0003c7bc(statsdir, "protostats", &DAT_000ccc64);
    FUN_0003c7bc(statsdir, "cryptostats", &DAT_000ccc7c);
    FUN_0003c7bc(statsdir, "timingstats", &DAT_000ccc94);
    step_callback = ntpd_time_stepped;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_000519e0(void)

{
    uint uVar1;
    char *pcVar2;
    FILE *pFVar3;
    int iVar4;
    undefined4 uVar5;
    double dVar6;
    uint local_24;
    undefined4 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0006f724(&local_24);
        FUN_0003be54(&DAT_000ccc4c, local_24);
        pFVar3 = DAT_000ccc4c;
        uVar1 = local_24 / 0x15180;
        local_24 = local_24 % 0x15180;
        if (DAT_000ccc4c != (FILE *)0x0) {
            uVar5 = FUN_00073804(local_24, local_20, 0, 3, 0);
            __fprintf_chk(
                pFVar3, 1,
                "%lu %s %lu %lu %lu %lu %lu %lu %lu %lu %lu %lu %lu\n",
                uVar1 + 0x3aac, uVar5, current_time - sys_stattime,
                sys_received, sys_processed, sys_newversion, sys_oldversion,
                sys_restricted, sys_badlength, sys_badauth, sys_declined,
                sys_limitrejected, sys_kodsent);
            fflush(DAT_000ccc4c);
            FUN_00048c70();
        }
    }
    if (stats_drift_file != (char *)0x0) {
        if (DAT_000cccb0 <= ABS(_DAT_000cccb8 - drift_comp)) {
            DAT_000cccb0 = (double)CONCAT44(wander_threshold._4_4_,
                                            (undefined4)wander_threshold);
            _DAT_000cccb8 = drift_comp;
            pFVar3 = fopen64(DAT_000cccc0, "w");
            if (pFVar3 == (FILE *)0x0) {
                FUN_00074e00(3, "frequency file %s: %m", DAT_000cccc0);
            } else {
                dVar6 = drift_comp * 1000000.0;
                __fprintf_chk(pFVar3, 1, "%.3f\n");
                fclose(pFVar3);
                pcVar2 = DAT_000cccc0;
                iVar4 = rename(DAT_000cccc0, stats_drift_file);
                if (iVar4 != 0) {
                    FUN_00074e00(
                        4, "Unable to rename temp drift file %s to %s, %m",
                        pcVar2, stats_drift_file, dVar6);
                }
            }
        } else {
            DAT_000cccb0 = DAT_000cccb0 * 0.5;
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00051cdc(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    uint local_4c;
    undefined4 local_48;
    int local_44;

    local_44 = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0006f724(&local_4c);
        FUN_0003be54(&DAT_000ccbec, local_4c);
        pFVar2 = DAT_000ccbec;
        uVar1 = local_4c / 0x15180;
        local_4c = local_4c % 0x15180;
        if (DAT_000ccbec != (FILE *)0x0) {
            uVar3 = FUN_00073804(local_4c, local_48, 0, 3, 0);
            uVar4 = FUN_0007c2e8(param_1);
            __fprintf_chk(pFVar2, 1, "%lu %s %s %x %.9f %.9f %.9f %.9f\n",
                          uVar1 + 0x3aac, uVar3, uVar4, param_2);
            fflush(DAT_000ccbec);
        }
    }
    if (local_44 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00051e10(void)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    uint local_44;
    undefined4 local_40;
    int local_3c;

    local_3c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0006f724(&local_44);
        FUN_0003be54(&DAT_000ccc04, local_44);
        pFVar2 = DAT_000ccc04;
        uVar1 = local_44 / 0x15180;
        local_44 = local_44 % 0x15180;
        if (DAT_000ccc04 != (FILE *)0x0) {
            uVar3 = FUN_00073804(local_44, local_40, 0, 3, 0);
            __fprintf_chk(pFVar2, 1, "%lu %s %.9f %.3f %.9f %.6f %d\n",
                          uVar1 + 0x3aac, uVar3);
            fflush(DAT_000ccc04);
        }
    }
    if (local_3c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00051f44(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    uint local_2c;
    undefined4 local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0006f724(&local_2c);
        FUN_0003be54(&DAT_000ccc1c, local_2c);
        pFVar2 = DAT_000ccc1c;
        uVar1 = local_2c / 0x15180;
        local_2c = local_2c % 0x15180;
        if (DAT_000ccc1c != (FILE *)0x0) {
            uVar3 = FUN_00073804(local_2c, local_28, 0, 3, 0);
            uVar4 = FUN_0007c2e8(param_1);
            __fprintf_chk(pFVar2, 1, "%lu %s %s %s\n", uVar1 + 0x3aac, uVar3,
                          uVar4, param_2);
            fflush(DAT_000ccc1c);
        }
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052050(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    undefined4 uVar1;
    undefined1 auStack_22c[512];
    int local_2c;
    undefined4 uStack_8;
    undefined4 uStack_4;

    local_2c = __stack_chk_guard;
    uStack_8 = param_3;
    uStack_4 = param_4;
    uVar1 = FUN_00074bbc(auStack_22c, 0x200, param_2, &uStack_8, &uStack_8);
    if (stats_control != 0) {
        FUN_00051f44(param_1, auStack_22c);
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1);
}

void FUN_000520f0(int param_1, int param_2, undefined4 *param_3,
                  undefined4 *param_4, undefined4 *param_5, undefined4 *param_6,
                  undefined4 param_7, undefined4 param_8, undefined4 param_9,
                  undefined4 param_10, undefined4 param_11, undefined4 param_12,
                  undefined4 param_13, int param_14, int param_15)

{
    FILE *pFVar1;
    uint uVar2;
    undefined4 uVar3;
    undefined *puVar4;
    undefined4 uVar5;
    undefined4 uVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    undefined1 *puVar9;
    undefined1 *puVar10;
    undefined *local_4c;
    uint local_44;
    undefined4 local_40;
    int local_3c;

    local_3c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0006f724(&local_44);
        FUN_0003be54(&DAT_000ccc34, local_44);
        uVar2 = local_44;
        pFVar1 = DAT_000ccc34;
        local_44 = local_44 % 0x15180;
        if (DAT_000ccc34 != (FILE *)0x0) {
            uVar3 = FUN_00073804(local_44, local_40, 0, 3, 0);
            if (param_1 == 0) {
                local_4c = &DAT_000a6e88;
            } else {
                local_4c = (undefined *)FUN_0007c2e8(param_1);
            }
            if (param_2 == 0) {
                puVar4 = &DAT_000a6e88;
            } else {
                puVar4 = (undefined *)FUN_0007c2e8(param_2);
            }
            uVar5 = FUN_00073804(*param_3, param_3[1], 0, 9, 0);
            uVar6 = FUN_00073804(*param_4, param_4[1], 0, 9, 0);
            uVar7 = FUN_00073804(*param_5, param_5[1], 0, 9, 0);
            uVar8 = FUN_00073804(*param_6, param_6[1], 0, 9, 0);
            FUN_000797a8(param_13, param_10);
            __fprintf_chk(
                pFVar1, 1,
                "%lu %s %s %s %s %s %s %s %d %d %d %d %d %d %.6f %.6f %s",
                uVar2 / 0x15180 + 0x3aac, uVar3, local_4c, puVar4, uVar5, uVar6,
                uVar7, uVar8, param_7, param_8, param_9, param_10, param_11,
                param_12);
            if (0 < param_14) {
                puVar9 = (undefined1 *)(param_15 + -1);
                puVar10 = puVar9 + param_14;
                __fprintf_chk(DAT_000ccc34, 1, &DAT_000a6ec4, param_14, uVar3,
                              local_4c, puVar4, uVar5, uVar6, uVar7, uVar8,
                              param_7, param_8, param_9, param_10, param_11,
                              param_12);
                do {
                    puVar9 = puVar9 + 1;
                    __fprintf_chk(DAT_000ccc34, 1, &DAT_000a6ecc, *puVar9,
                                  uVar3, local_4c, puVar4, uVar5, uVar6, uVar7,
                                  uVar8, param_7, param_8, param_9, param_10,
                                  param_11, param_12);
                } while (puVar9 != puVar10);
            }
            fputc(10, DAT_000ccc34);
            fflush(DAT_000ccc34);
        }
    }
    if (local_3c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005241c(undefined4 param_1)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    uint local_24;
    undefined4 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0006f724(&local_24);
        FUN_0003be54(&DAT_000ccc64, local_24);
        pFVar2 = DAT_000ccc64;
        uVar1 = local_24 / 0x15180;
        local_24 = local_24 % 0x15180;
        if (DAT_000ccc64 != (FILE *)0x0) {
            uVar3 = FUN_00073804(local_24, local_20, 0, 3, 0);
            __fprintf_chk(pFVar2, 1, "%lu %s %s\n", uVar1 + 0x3aac, uVar3,
                          param_1);
            fflush(DAT_000ccc64);
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052514(int param_1, undefined4 param_2)

{
    uint uVar1;
    FILE *pFVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    int iVar5;
    uint local_2c;
    undefined4 local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    if (stats_control != 0) {
        FUN_0006f724(&local_2c);
        FUN_0003be54(&DAT_000ccc7c, local_2c);
        pFVar2 = DAT_000ccc7c;
        uVar1 = local_2c / 0x15180;
        local_2c = local_2c % 0x15180;
        if (DAT_000ccc7c != (FILE *)0x0) {
            iVar5 = uVar1 + 0x3aac;
            if (param_1 == 0) {
                uVar3 = FUN_00073804(local_2c, local_28, 0, 3, 0);
                __fprintf_chk(pFVar2, 1, "%lu %s 0.0.0.0 %s\n", iVar5, uVar3,
                              param_2);
            } else {
                uVar3 = FUN_00073804(local_2c, local_28, 0, 3, 0);
                uVar4 = FUN_0007c2e8(param_1);
                __fprintf_chk(pFVar2, 1, "%lu %s %s %s\n", iVar5, uVar3, uVar4,
                              param_2);
            }
            fflush(DAT_000ccc7c);
        }
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052670(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((DAT_000ccbe8 == (char *)0x0) || (*DAT_000ccbe8 == '\0')) {
    LAB_000526b4:
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else {
        iVar2 = FUN_0003e578(DAT_000ccbe8, &DAT_000cccc8, DAT_000cccc4 == 0,
                             param_1);
        if (iVar2 == 0) {
            if (DAT_000cccc4 == 0)
                goto LAB_000526b4;
        } else {
            DAT_000cccc4 = 1;
        }
        if (iVar1 == __stack_chk_guard) {
            FUN_00051754(param_1, param_2, param_3);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052744(char *param_1)

{
    byte bVar1;
    size_t sVar2;
    char *__filename;
    FILE *__stream;
    char *pcVar3;
    uint uVar4;
    int iVar5;
    EVP_MD *pEVar6;
    int *piVar7;
    char *pcVar8;
    char *pcVar9;
    ushort **ppuVar10;
    __int32_t **pp_Var11;
    undefined4 uVar12;
    byte *pbVar13;
    undefined1 *extraout_r2;
    undefined1 *puVar14;
    uint uVar15;
    undefined1 *puVar16;
    uint uVar17;
    int *piVar18;
    byte *pbVar19;
    __int32_t *p_Var20;
    uint uVar21;
    bool bVar22;
    int local_290;
    char *local_270;
    uint local_26c;
    short local_268[14];
    undefined1 local_24c[32];
    char acStack_22c[512];
    int local_2c;
    undefined1 auStack_28[12];
    int local_1c;

    local_1c = __stack_chk_guard;
    sVar2 = strlen(param_1);
    if (sVar2 == 0) {
        if (local_1c == __stack_chk_guard) {
            return;
        }
    } else {
        DAT_000ccd30 = (void *)FUN_00073ba4(DAT_000ccd30, sVar2 + 1, 0);
        __filename = (char *)memcpy(DAT_000ccd30, param_1, sVar2 + 1);
        if (local_1c == __stack_chk_guard) {
            local_2c = __stack_chk_guard;
            __stream = fopen64(__filename, "r");
            if (__stream == (FILE *)0x0) {
                FUN_00074e00(3, "authreadkeys: file \'%s\': %m", __filename);
                uVar12 = 0;
            LAB_00072f88:
                if (local_2c == __stack_chk_guard) {
                    return;
                }
                /* WARNING: Subroutine does not return */
                __stack_chk_fail(uVar12);
            }
            if (ssl_init_done == 0) {
                FUN_0007c6b8();
            }
            local_26c = 0;
            piVar18 = (int *)0x0;
        LAB_00072bc0:
            do {
                while (true) {
                    while (true) {
                        while (true) {
                            do {
                                local_270 = fgets(acStack_22c, 0x200, __stream);
                                if ((local_270 == (char *)0x0) ||
                                    (0xf < local_26c)) {
                                    fclose(__stream);
                                    if (local_26c == 0) {
                                        FUN_000725f8();
                                        while (piVar18 != (int *)0x0) {
                                            piVar7 = (int *)*piVar18;
                                            FUN_000724ac(
                                                piVar18[2],
                                                *(undefined2 *)(piVar18 + 3),
                                                piVar18 + 4,
                                                *(undefined2 *)((int)piVar18 +
                                                                0xe),
                                                piVar18[1]);
                                            piVar18[1] = 0;
                                            FUN_00072ab4(piVar18);
                                            piVar18 = piVar7;
                                        }
                                        uVar12 = 1;
                                    } else {
                                        if (local_26c < 0x10) {
                                            pcVar3 = "";
                                        } else {
                                            pcVar3 = " (emergency break)";
                                        }
                                        FUN_00074e00(
                                            3,
                                            "authreadkeys: rejecting file "
                                            "\'%s\' after %u error(s)%s",
                                            __filename, local_26c, pcVar3);
                                        while (piVar18 != (int *)0x0) {
                                            piVar18 = (int *)*piVar18;
                                            FUN_00072ab4();
                                        }
                                        uVar12 = 0;
                                    }
                                    goto LAB_00072f88;
                                }
                                pcVar3 = (char *)FUN_0007291c(&local_270);
                            } while (pcVar3 == (char *)0x0);
                            uVar4 = strtol(pcVar3, (char **)0x0, 10);
                            if (uVar4 != 0)
                                break;
                            FUN_00072a30(&local_26c,
                                         "authreadkeys: cannot change key %s",
                                         pcVar3);
                        }
                        if (uVar4 < 0x10000)
                            break;
                        FUN_00072a30(
                            &local_26c,
                            "authreadkeys: key %s > %d reserved for Autokey",
                            pcVar3, 0xffff);
                    }
                    iVar5 = FUN_0007291c(&local_270);
                    if (iVar5 != 0)
                        break;
                    FUN_00072a30(&local_26c,
                                 "authreadkeys: no key type for key %d", uVar4);
                }
                local_290 = FUN_0007c910(iVar5, 0);
                if (local_290 == 0) {
                    FUN_00072a30(0, "authreadkeys: invalid type for key %d",
                                 uVar4);
                    pcVar3 = (char *)FUN_0007291c(&local_270);
                    if (pcVar3 == (char *)0x0)
                        goto LAB_00072fc4;
                LAB_00072c6c:
                    sVar2 = strlen(pcVar3);
                    if (sVar2 < 0x15) {
                        piVar7 = (int *)FUN_00073ba4(0, sVar2 + 0x14, 0);
                        piVar7[2] = uVar4;
                        *(short *)((int)piVar7 + 0xe) = (short)sVar2;
                        *(undefined2 *)(piVar7 + 3) = (undefined2)local_290;
                        piVar7[1] = 0;
                        memcpy(piVar7 + 4, pcVar3, sVar2);
                    } else {
                        pbVar19 = (byte *)(pcVar3 + -1);
                        if (0x3f < sVar2) {
                            sVar2 = 0x40;
                        }
                        uVar17 = 0;
                        pp_Var11 = __ctype_tolower_loc();
                        p_Var20 = *pp_Var11;
                        do {
                            pbVar19 = pbVar19 + 1;
                            pcVar3 =
                                strchr("0123456789abcdef", p_Var20[*pbVar19]);
                            if (pcVar3 == (char *)0x0) {
                                if (uVar17 < sVar2) {
                                    FUN_00072a30(&local_26c,
                                                 "authreadkeys: invalid hex "
                                                 "digit for key %d",
                                                 uVar4);
                                    goto LAB_00072bc0;
                                }
                                break;
                            }
                            bVar22 = (uVar17 & 1) != 0;
                            puVar16 = (undefined1 *)(uVar17 >> 1);
                            puVar14 = extraout_r2;
                            if (bVar22) {
                                puVar14 = auStack_28;
                                puVar16 = puVar14 + (int)puVar16;
                            }
                            if (bVar22) {
                                puVar14 =
                                    (undefined1 *)(uint)(byte)puVar16[-0x224];
                            }
                            if (!bVar22) {
                                puVar14 = auStack_28;
                            }
                            uVar17 = uVar17 + 1;
                            if (bVar22) {
                                bVar1 =
                                    (byte)(pcVar3 + -0xaaca0) | (byte)puVar14;
                            } else {
                                bVar1 =
                                    (byte)(((uint)(pcVar3 + -0xaaca0) & 0xff)
                                           << 4);
                                puVar16 = puVar14 + (int)puVar16;
                            }
                            puVar16[-0x224] = bVar1;
                        } while (sVar2 != uVar17);
                        uVar17 = sVar2 >> 1;
                        piVar7 = (int *)FUN_00073ba4(0, uVar17 + 0x14, 0);
                        piVar7[2] = uVar4;
                        *(short *)((int)piVar7 + 0xe) = (short)uVar17;
                        *(undefined2 *)(piVar7 + 3) = (undefined2)local_290;
                        piVar7[1] = 0;
                        memcpy(piVar7 + 4, local_24c, uVar17);
                    }
                    pcVar3 = (char *)FUN_0007291c(&local_270);
                    while (pcVar3 != (char *)0x0) {
                        pcVar8 = strchr(pcVar3, 0x2c);
                        if (pcVar8 != (char *)0x0) {
                            *pcVar8 = '\0';
                        }
                        pcVar9 = strchr(pcVar3, 0x2f);
                        if (pcVar9 == (char *)0x0) {
                            iVar5 = FUN_00074054(pcVar3, 0, local_268);
                            if (iVar5 != 0) {
                                uVar17 = 0xffffffff;
                                goto LAB_00072df0;
                            }
                        LAB_00072e24:
                            FUN_00072a30(&local_26c,
                                         "authreadkeys: invalid IP address "
                                         "<%s> for key %d",
                                         pcVar3, uVar4);
                        } else {
                            uVar21 = (uint)(byte)pcVar9[1];
                            uVar17 = 0;
                            *pcVar9 = '\0';
                            pbVar19 = (byte *)(pcVar9 + 1);
                            if (uVar21 == 0) {
                                iVar5 = FUN_00074054(pcVar3, 0, local_268);
                                if (iVar5 != 0) {
                                    uVar17 = 0;
                                    goto LAB_00072df0;
                                }
                                goto LAB_00072e24;
                            }
                            ppuVar10 = __ctype_b_loc();
                            pbVar13 = pbVar19;
                            do {
                                uVar15 =
                                    (((*ppuVar10)[uVar21] ^ 0x800) << 0x14) >>
                                    0x1f;
                                if (1000 < uVar17) {
                                    uVar15 = 1;
                                }
                                if (uVar15 != 0) {
                                    FUN_00072a30(
                                        &local_26c,
                                        "authreadkeys: Invalid character in "
                                        "subnet specification for <%s/%s> in "
                                        "key %d",
                                        pbVar13, pbVar19, uVar4);
                                    goto LAB_00072d70;
                                }
                                iVar5 = uVar21 - 0x30;
                                pbVar13 = pbVar13 + 1;
                                uVar21 = (uint)*pbVar13;
                                uVar17 = iVar5 + uVar17 * 10;
                            } while (uVar21 != 0);
                            iVar5 = FUN_00074054(pcVar3, 0, local_268);
                            if (iVar5 == 0)
                                goto LAB_00072e24;
                            if (uVar17 != 0xffffffff) {
                                if (local_268[0] == 2) {
                                    if (0x20 < uVar17)
                                        goto LAB_00072fe4;
                                } else if (local_268[0] == 10 &&
                                           0x80 < uVar17) {
                                LAB_00072fe4:
                                    FUN_00072a30(
                                        0,
                                        "authreadkeys: excessive subnet mask "
                                        "<%s/%s> for key %d",
                                        pcVar3, pbVar19, uVar4);
                                }
                            }
                        LAB_00072df0:
                            iVar5 = FUN_00071680(piVar7[1], local_268, uVar17);
                            piVar7[1] = iVar5;
                        }
                    LAB_00072d70:
                        if (pcVar8 == (char *)0x0)
                            break;
                        pcVar3 = pcVar8 + 1;
                    }
                    if (local_290 == 0) {
                        FUN_00072ab4(piVar7);
                    } else {
                        *piVar7 = (int)piVar18;
                        piVar18 = piVar7;
                    }
                    goto LAB_00072bc0;
                }
                if (local_290 != 0x37e) {
                    pcVar3 = OBJ_nid2sn(local_290);
                    pEVar6 = EVP_get_digestbyname(pcVar3);
                    if (pEVar6 == (EVP_MD *)0x0) {
                        FUN_00072a30(0, "authreadkeys: no algorithm for key %d",
                                     uVar4);
                        local_290 = 0;
                    }
                }
                pcVar3 = (char *)FUN_0007291c(&local_270);
                if (pcVar3 != (char *)0x0)
                    goto LAB_00072c6c;
            LAB_00072fc4:
                FUN_00072a30(&local_26c, "authreadkeys: no key for key %d",
                             uVar4);
            } while (true);
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00052858(undefined4 param_1)

{
    int iVar1;
    uint uVar2;
    undefined1 *__s;
    undefined2 local_28[2];
    undefined1 local_24;
    undefined1 local_23;
    undefined1 local_22;
    undefined1 local_21;
    int local_1c;

    local_1c = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar2 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar2 & 0xf;
    iVar1 = FUN_00076750(local_28, param_1, 0);
    if (iVar1 < 0) {
        FUN_0007c054(__s, 0x80, "ntpcal_ntp_to_date: %ld: range error",
                     param_1);
    } else {
        FUN_0007c054(__s, 0x80, "%04d%02d%02d%02d%02d", local_28[0], local_24,
                     local_23, local_22, local_21);
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_0005294c(undefined4 param_1, char *param_2)

{
    size_t sVar1;
    void *pvVar2;
    int iVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    FILE *pFVar6;
    __pid_t _Var7;
    char *pcVar8;
    time_t tStack_4c;
    undefined4 local_48[2];
    undefined4 local_40;
    undefined4 uStack_3c;
    short local_38;
    char local_34[4];
    undefined2 local_30;
    int local_2c;

    local_34[0] = '.';
    local_34[1] = 'T';
    local_34[2] = 'E';
    local_34[3] = 'M';
    local_2c = __stack_chk_guard;
    local_30 = 0x50;
    switch (param_1) {
    case 1:
        if ((param_2 != (char *)0x0) && (sVar1 = strlen(param_2), sVar1 != 0)) {
            stats_drift_file =
                (char *)FUN_00073ba4(stats_drift_file, sVar1 + 1, 0);
            pvVar2 = (void *)FUN_00073ba4(DAT_000cccc0, sVar1 + 6, 0);
            DAT_000cccc0 = pvVar2;
            memcpy(stats_drift_file, param_2, sVar1 + 1);
            memcpy(pvVar2, param_2, sVar1);
            *(char(*)[4])((int)pvVar2 + sVar1) = local_34;
            *(undefined2 *)((int)pvVar2 + sVar1 + 4) = local_30;
            pFVar6 = fopen64(stats_drift_file, "r");
            if (pFVar6 != (FILE *)0x0) {
                iVar3 = fscanf(pFVar6, "%lf", &local_40);
                if (iVar3 == 1) {
                    fclose(pFVar6);
                    FUN_000405f8(local_40, 0xc);
                    _DAT_000cccb8 = (undefined4)drift_comp;
                    DAT_000cccbc = drift_comp._4_4_;
                } else {
                    FUN_00074e00(3, "format error frequency file %s",
                                 stats_drift_file);
                    fclose(pFVar6);
                }
            }
        }
        break;
    case 2:
        sVar1 = strlen(param_2);
        if (sVar1 < 0xff) {
            if ((sVar1 == 0) || (param_2[sVar1 - 1] == '/')) {
                FUN_0007c054(statsdir, 0x100, "%s", param_2);
            } else {
                FUN_0007c054(statsdir, 0x100, &DAT_0009d0e4, param_2, 0x2f);
            }
            FUN_0003c8d8();
        } else {
            FUN_00074e00(3, "statsdir too long (>%d, sigh)", 0xfe);
        }
        break;
    case 3:
        pFVar6 = fopen64(param_2, "w");
        if (pFVar6 == (FILE *)0x0) {
            FUN_00074e00(3, "pid file %s: %m", param_2);
        } else {
            _Var7 = getpid();
            __fprintf_chk(pFVar6, 1, "%d", _Var7);
            fclose(pFVar6);
        }
        break;
    case 4:
        if ((param_2 != (char *)0x0) && (sVar1 = strlen(param_2), sVar1 != 0)) {
            pvVar2 = (void *)FUN_00073ba4(DAT_000ccbe8, sVar1 + 1, 0);
            DAT_000ccbe8 = pvVar2;
            memcpy(pvVar2, param_2, sVar1 + 1);
            iVar3 = FUN_0003e578(pvVar2, &DAT_000cccc8, 1);
            if (iVar3 != 0) {
                FUN_0006f724(local_48);
                time(&tStack_4c);
                FUN_0003db68(&local_40);
                uVar4 = FUN_00052858(uStack_3c);
                iVar3 = FUN_0003dbd0(local_48[0], 0);
                if (iVar3 == 0) {
                    pcVar8 = "expires";
                } else {
                    pcVar8 = "expired";
                }
                uVar5 = FUN_00052858(local_40);
                FUN_000362e8(0xe, 0, "%d leap %s %s %s", (int)local_38, uVar4,
                             pcVar8, uVar5);
                DAT_000cccc4 = 1;
                FUN_00051754(1, local_48[0], &tStack_4c);
            }
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00053a3c(int param_1)

{
    char cVar1;
    int iVar2;
    int iVar3;
    size_t sVar4;
    undefined4 uVar5;
    ssize_t sVar6;
    int *piVar7;
    undefined4 uVar8;
    char *pcVar9;
    uint uVar10;
    int iVar11;
    undefined4 *puVar12;
    int iVar13;
    int iVar14;
    int iVar15;
    int iVar16;
    int iVar17;
    int iVar18;
    bool bVar19;

    iVar2 = __stack_chk_guard;
    iVar13 = *(int *)(param_1 + 4);
    puVar12 = *(undefined4 **)(iVar13 + 0x54);
    piVar7 = (int *)*puVar12;
    if (*piVar7 == 0) {
        *piVar7 = 1;
    LAB_00053c78:
        if (iVar2 == __stack_chk_guard) {
            return;
        }
        goto LAB_00053d88;
    }
    if (*(int *)(param_1 + 0x54) < 0x18) {
    LAB_00053ca8:
        FUN_000494a0(iVar13);
        return;
    }
    pcVar9 = (char *)(param_1 + 0x58);
    cVar1 = *(char *)(param_1 + 0x58);
    while (cVar1 != '\x10') {
        pcVar9 = pcVar9 + 1;
        cVar1 = *pcVar9;
    }
    uVar10 =
        (short)(ushort)((byte)pcVar9[2] >> 4) * 10 + ((byte)pcVar9[2] & 0xf);
    puVar12[0x2f] = uVar10;
    if (uVar10 == 0x5e) {
        FUN_000494a0(iVar13, 2);
        sVar6 = write(puVar12[7], &DAT_000c6df0, 0x1a);
        if (sVar6 != 0x1a) {
            if (iVar2 == __stack_chk_guard)
                goto LAB_00053ca8;
            goto LAB_00053d88;
        }
        goto LAB_00053c78;
    }
    iVar3 = piVar7[2];
    if (uVar10 < 99) {
        uVar10 = uVar10 + 100;
    }
    iVar11 = uVar10 + 0x76c;
    puVar12[0x2f] = iVar11;
    iVar14 = (short)((byte)pcVar9[3] & 0xf) * 100 +
             (uint)((byte)pcVar9[4] >> 4) * 10 + ((byte)pcVar9[4] & 0xf);
    puVar12[0x30] = iVar14;
    if (iVar3 < 0xb) {
        puVar12[0x31] = (short)(ushort)((byte)pcVar9[5] >> 4) * 10 +
                        ((byte)pcVar9[5] & 0xf);
    LAB_00053b30:
        iVar18 = (short)(ushort)((byte)pcVar9[5] >> 4) * 10 +
                 ((byte)pcVar9[5] & 0xf);
        puVar12[0x31] = iVar18;
        iVar17 = (short)(ushort)((byte)pcVar9[6] >> 4) * 10 +
                 ((byte)pcVar9[6] & 0xf);
        puVar12[0x32] = iVar17;
        iVar15 = (short)(ushort)((byte)pcVar9[7] >> 4) * 10 +
                 ((byte)pcVar9[7] & 0xf);
        puVar12[0x33] = iVar15;
        iVar16 = ((short)(ushort)((byte)pcVar9[8] >> 4) * 10 +
                  ((byte)pcVar9[8] & 0xf)) *
                 1000000;
        puVar12[0x34] = iVar16;
        puVar12[0x34] = (uint)((byte)pcVar9[9] >> 4) * 1000 + iVar16;
        if (iVar18 == 10)
            goto LAB_00053d30;
    } else {
        iVar17 = (short)(ushort)((byte)pcVar9[6] >> 4) * 10 +
                 ((byte)pcVar9[6] & 0xf);
        puVar12[0x31] = iVar17;
        if (iVar17 != 10)
            goto LAB_00053b30;
        iVar17 = (short)(ushort)((byte)pcVar9[7] >> 4) * 10 +
                 ((byte)pcVar9[7] & 0xf);
        puVar12[0x32] = iVar17;
        puVar12[0x33] = (short)(ushort)((byte)pcVar9[8] >> 4) * 10 +
                        ((byte)pcVar9[8] & 0xf);
        iVar14 = ((short)(ushort)((byte)pcVar9[9] >> 4) * 10 +
                  ((byte)pcVar9[9] & 0xf)) *
                 1000000;
        puVar12[0x34] = iVar14;
        puVar12[0x34] = (uint)((byte)pcVar9[10] >> 4) * 1000 + iVar14;
    LAB_00053d30:
        iVar11 = puVar12[0x2f];
        if (iVar17 == 10) {
            iVar14 = puVar12[0x30];
            iVar15 = puVar12[0x33];
            piVar7[2] = iVar3 + 1;
        } else {
            iVar14 = puVar12[0x30];
            iVar15 = puVar12[0x33];
        }
        iVar18 = 10;
    }
    FUN_0007c054(puVar12 + 0xe, 0x80, "%d %d %d %d %d", iVar11, iVar14, iVar18,
                 iVar17, iVar15);
    sVar4 = strlen((char *)(puVar12 + 0xe));
    puVar12[0x2e] = sVar4;
    uVar5 = *(undefined4 *)(param_1 + 0x48);
    uVar8 = *(undefined4 *)(param_1 + 0x4c);
    puVar12[0x3e] = 0x88e368f1;
    puVar12[0x3f] = 0x3ee4f8b5;
    puVar12[0x3a] = uVar5;
    puVar12[0x3b] = uVar8;
    iVar3 = FUN_00049cf8(puVar12);
    if (iVar3 == 0) {
        FUN_000494a0(iVar13, 6);
    }
    bVar19 = iVar2 == __stack_chk_guard;
    puVar12[0x38] = puVar12[0x3a];
    puVar12[0x39] = puVar12[0x3b];
    if (bVar19) {
        FUN_00049d44(iVar13);
        return;
    }
LAB_00053d88:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00053f08(byte *param_1, undefined4 *param_2)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    byte bVar4;
    byte bVar5;
    byte bVar6;
    int iVar7;
    ushort **ppuVar8;
    byte *pbVar9;
    int *piVar10;
    uint uVar11;
    uint uVar12;
    uint uVar13;
    uint uVar14;
    uint uVar15;
    bool bVar16;
    bool bVar17;
    bool bVar18;
    byte *local_3c;

    iVar7 = __stack_chk_guard;
    if (*param_1 == 0x2d) {
        local_3c = param_1 + 1;
        bVar6 = 1;
        uVar14 = 0;
        uVar15 = 0x80000000;
    } else {
        local_3c = param_1;
        if (*param_1 == 0x2b) {
            local_3c = param_1 + 1;
        }
        bVar6 = 0;
        uVar14 = 0xffffffff;
        uVar15 = 0x7fffffff;
    }
    bVar18 = false;
    bVar5 = 0;
    ppuVar8 = __ctype_b_loc();
    uVar12 = 0;
    uVar13 = 0;
    pbVar9 = local_3c;
    while (true) {
        if (((*ppuVar8)[*pbVar9] & 0x800) == 0)
            break;
        uVar11 = *pbVar9 - 0x30;
        uVar1 = uVar12 >> 0x1e;
        bVar17 = 0xccccccb < uVar13;
        bVar16 = uVar13 == 0xccccccc;
        if (bVar16) {
            bVar17 = 0xcccccccb < uVar12;
        }
        if (bVar17 && (!bVar16 || uVar12 != 0xcccccccc)) {
            bVar5 = 1;
        }
        if (!bVar17 || bVar16 && uVar12 == 0xcccccccc) {
            bVar5 = 0;
        }
        bVar17 = CARRY4(uVar12 * 4, uVar12);
        uVar3 = uVar12 * 5;
        uVar2 = uVar12 * 10;
        uVar12 = uVar2 + uVar11;
        uVar13 = ((uVar13 << 2 | uVar1) + uVar13 + (uint)bVar17) * 2 +
                 (uint)CARRY4(uVar3, uVar3) + ((int)uVar11 >> 0x1f) +
                 (uint)CARRY4(uVar2, uVar11);
        bVar17 = uVar13 <= uVar15;
        if (uVar15 == uVar13) {
            bVar17 = uVar12 <= uVar14;
        }
        bVar4 = bVar5;
        if (!bVar17) {
            bVar4 = 1;
        }
        bVar18 = (bool)(bVar18 | bVar4);
        pbVar9 = pbVar9 + 1;
    }
    if (local_3c == pbVar9) {
        piVar10 = __errno_location();
        *piVar10 = 0x16;
        pbVar9 = param_1;
    }
    if (bVar18) {
        piVar10 = __errno_location();
        *piVar10 = 0x22;
        uVar12 = uVar14;
        uVar13 = uVar15;
    }
    *param_2 = pbVar9;
    if ((bool)((uVar12 != 0 || uVar13 != 0) & bVar6)) {
        bVar18 = uVar12 != 0;
        uVar12 = -uVar12;
        uVar13 = -(uVar13 + bVar18);
    }
    if (iVar7 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar12, uVar13);
    }
    return;
}

void FUN_000540b0(void)

{
    int iVar1;
    undefined4 uVar2;
    uint uVar3;
    int iVar4;
    int in_r3;
    uint uVar5;
    int iVar6;
    int *piVar7;
    bool bVar8;
    double dVar9;
    undefined8 uVar10;

    iVar1 = __stack_chk_guard;
    piVar7 = *(int **)(in_r3 + 0x54);
    iVar6 = *piVar7;
    dVar9 = *(double *)(piVar7 + 0xba);
    if (*(int *)(iVar6 + 8) == in_r3) {
        if (dVar9 < 0.0) {
            dVar9 = ldexp(-dVar9, 0x20);
            uVar10 =
                FUN_0009c010(SUB84(dVar9, 0), (int)((ulonglong)dVar9 >> 0x20));
            uVar10 = CONCAT44(
                -((int)((ulonglong)uVar10 >> 0x20) + (uint)((int)uVar10 != 0)),
                -(int)uVar10);
        } else {
            dVar9 = ldexp(dVar9, 0x20);
            uVar10 =
                FUN_0009c010(SUB84(dVar9, 0), (int)((ulonglong)dVar9 >> 0x20));
        }
        *(int *)(iVar6 + 0x78) = (int)uVar10;
        *(int *)(iVar6 + 0x74) = (int)((ulonglong)uVar10 >> 0x20);
        if ((*(byte *)(piVar7 + 0xc0) & 1) == 0) {
            *(uint *)(in_r3 + 0x44) = *(uint *)(in_r3 + 0x44) & 0xffffff7f;
        }
    } else {
        if (dVar9 < 0.0) {
            dVar9 = ldexp(-dVar9, 0x20);
            uVar10 =
                FUN_0009c010(SUB84(dVar9, 0), (int)((ulonglong)dVar9 >> 0x20));
            uVar10 = CONCAT44(
                -((int)((ulonglong)uVar10 >> 0x20) + (uint)((int)uVar10 != 0)),
                -(int)uVar10);
        } else {
            dVar9 = ldexp(dVar9, 0x20);
            uVar10 =
                FUN_0009c010(SUB84(dVar9, 0), (int)((ulonglong)dVar9 >> 0x20));
        }
        dVar9 = *(double *)(piVar7 + 0xbc);
        *(int *)(iVar6 + 0x70) = (int)uVar10;
        *(int *)(iVar6 + 0x6c) = (int)((ulonglong)uVar10 >> 0x20);
        if (dVar9 < 0.0) {
            dVar9 = ldexp(-dVar9, 0x20);
            uVar10 =
                FUN_0009c010(SUB84(dVar9, 0), (int)((ulonglong)dVar9 >> 0x20));
            uVar10 = CONCAT44(
                -((int)((ulonglong)uVar10 >> 0x20) + (uint)((int)uVar10 != 0)),
                -(int)uVar10);
        } else {
            dVar9 = ldexp(dVar9, 0x20);
            uVar10 =
                FUN_0009c010(SUB84(dVar9, 0), (int)((ulonglong)dVar9 >> 0x20));
        }
        uVar2 = (undefined4)uVar10;
        uVar5 = *(uint *)(in_r3 + 0x4c);
        *(int *)(iVar6 + 0x7c) = (int)((ulonglong)uVar10 >> 0x20);
        *(undefined4 *)(iVar6 + 0x80) = uVar2;
        if (((*(uint *)(iVar6 + 0x10) ^ uVar5) & 3) != 0) {
            bVar8 = (*(uint *)(iVar6 + 0x10) & 3) == 2;
            uVar5 = uVar5 & 3;
            if (bVar8) {
                uVar2 = 0;
            }
            iVar4 = **(int **)(in_r3 + 0x54);
            if (bVar8) {
                *(undefined4 *)(iVar4 + 0x48) = uVar2;
                *(byte *)(iVar4 + 0x84) = *(byte *)(iVar4 + 0x84) & 0xef;
            }
            uVar3 = *(byte *)(iVar4 + 0x84) & 0xf9;
            *(char *)(iVar4 + 0x84) = (char)uVar3;
            if (uVar5 == 2) {
                uVar3 = 0x1e;
            }
            *(uint *)(iVar6 + 0x10) = uVar5;
            if (uVar5 == 2) {
                *(uint *)(iVar4 + 0x48) = uVar3;
                *(byte *)(iVar4 + 0x84) = *(byte *)(iVar4 + 0x84) & 0xef;
            }
            *(byte *)(iVar4 + 0x84) = *(byte *)(iVar4 + 0x84) & 0xf9;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005426c(undefined4 param_1, int param_2)

{
    int iVar1;
    undefined4 *puVar2;
    int iVar3;
    undefined4 uVar4;
    undefined4 *puVar5;
    undefined4 *puVar6;
    undefined4 *puVar7;
    undefined4 *__ptr;
    undefined4 *puVar8;
    bool bVar9;

    iVar1 = __stack_chk_guard;
    puVar8 = *(undefined4 **)(param_2 + 0x54);
    __ptr = (undefined4 *)*puVar8;
    if (__ptr != (undefined4 *)0x0) {
        if (__ptr[2] != param_2) {
            if (puVar8[7] == -1) {
                iVar3 = __ptr[0x22];
            } else {
                FUN_00028e64(puVar8 + 2);
                iVar3 = __ptr[0x22];
                puVar8[7] = 0xffffffff;
            }
            if (iVar3 != -1) {
                close(iVar3);
            }
        }
        iVar3 = __ptr[1];
        __ptr[1] = iVar3 + -1;
        if (iVar3 + -1 == 0) {
            puVar2 = &DAT_000ccd5c;
            puVar7 = DAT_000ccd5c;
            while (puVar5 = puVar2, puVar7 != (undefined4 *)0x0) {
                puVar6 = (undefined4 *)*puVar7;
                bVar9 = __ptr == puVar7;
                puVar2 = puVar7;
                puVar7 = puVar6;
                if (bVar9) {
                    *puVar5 = puVar6;
                    puVar2 = puVar5;
                }
            }
            free((void *)__ptr[5]);
            free((void *)__ptr[6]);
            free(__ptr);
        }
        *puVar8 = 0;
        if ((ntp_syslogmask & 0x100) != 0) {
            uVar4 = FUN_0007a3fc(param_2 + 0x10);
            if (iVar1 == __stack_chk_guard) {
                FUN_00074e00(5, "%s: shutdown", uVar4);
                return;
            }
            goto LAB_000543ac;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_000543ac:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000543c4(undefined4 param_1, int param_2, undefined4 param_3,
                  undefined4 param_4, undefined4 param_5)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    *(undefined4 *)(param_2 + 0xe0) = param_3;
    *(undefined4 *)(param_2 + 0xe4) = param_4;
    if (*(int *)(param_2 + 0xd8) == *(int *)(param_2 + 0xdc)) {
        FUN_000494a0(param_1, 0);
    }
    if (iVar1 == __stack_chk_guard) {
        FUN_00049a70((int)*(undefined8 *)(param_2 + 0x2e8), param_2, param_3,
                     param_4, param_5);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00054468(int param_1, char *param_2)

{
    int iVar1;
    int iVar2;
    size_t __n;

    iVar1 = __stack_chk_guard;
    if (param_2 == (char *)0x0) {
        __n = 0;
    } else {
        __n = strlen(param_2);
        if (0x7e < __n) {
            __n = 0x7f;
        }
        memcpy((void *)(param_1 + 0x38), param_2, __n);
    }
    iVar2 = __stack_chk_guard;
    *(size_t *)(param_1 + 0xb8) = __n;
    *(undefined1 *)(param_1 + __n + 0x38) = 0;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000544f8(int param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    iVar2 = param_2 + 1;
    iVar4 = param_1 + param_2 * 0x14;
    iVar5 = *(int *)(param_1 + 4);
    iVar3 = *(int *)(iVar4 + 8);
    iVar4 = *(int *)(iVar4 + 0x14);
    if (iVar3 == 1) {
        iVar4 = iVar4 << 1;
    } else if (iVar3 != 2)
        goto LAB_00054544;
    for (; iVar4 != 0; iVar4 = iVar4 + -1) {
        if ((-1 < iVar2) && (iVar2 < iVar5)) {
            iVar2 = FUN_000544f8(param_1);
        }
    }
LAB_00054544:
    if ((-1 < iVar2) && (iVar2 <= iVar5)) {
        iVar5 = iVar2;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
}

void FUN_000545b0(int *param_1, undefined4 param_2, byte *param_3, int param_4)

{
    ushort **ppuVar1;
    byte *pbVar2;
    int iVar3;
    byte *pbVar4;
    byte *pbVar5;
    byte *pbVar6;
    byte *pbVar7;
    byte bVar8;
    uint uVar9;
    byte abStack_34[8];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (1 < debug) {
        iVar3 = *param_1;
        pbVar5 = &DAT_000ccd60;
        pbVar6 = param_3;
    LAB_00054634:
        if (param_3 + param_4 != pbVar6 && pbVar5 != &DAT_000cd55f) {
            pbVar7 = pbVar6 + 1;
            bVar8 = *pbVar6;
            uVar9 = (uint)bVar8;
            pbVar6 = pbVar7;
            if (uVar9 == 0x5c) {
                pbVar2 = &UNK_000a7128;
                pbVar4 = (byte *)(0x174686 - (int)pbVar5);
                bVar8 = 0x5c;
                pbVar7 = pbVar5;
                do {
                    pbVar5 = pbVar7 + 1;
                    *pbVar7 = bVar8;
                    if (pbVar2 == pbVar4) {
                        pbVar5 = &DAT_000cd55f;
                        break;
                    }
                    pbVar2 = pbVar2 + 1;
                    bVar8 = *pbVar2;
                    pbVar7 = pbVar5;
                } while (bVar8 != 0);
            } else {
                ppuVar1 = __ctype_b_loc();
                if (((*ppuVar1)[uVar9] & 0x4000) == 0) {
                    FUN_0007c054(abStack_34, 6, "\\%03o", uVar9);
                    pbVar7 = abStack_34;
                    pbVar2 = pbVar5;
                    do {
                        pbVar5 = pbVar2;
                        if (*pbVar7 == 0)
                            break;
                        pbVar5 = pbVar2 + 1;
                        *pbVar2 = *pbVar7;
                        pbVar7 = pbVar7 + 1;
                        pbVar2 = pbVar5;
                    } while (pbVar5 != &DAT_000cd55f);
                } else {
                    *pbVar5 = bVar8;
                    pbVar5 = pbVar5 + 1;
                }
            }
            goto LAB_00054634;
        }
        *pbVar5 = 0;
        FUN_00074d28("%s[%s]: \'%s\'\n", *(undefined4 *)(iVar3 + 0x14), param_2,
                     &DAT_000ccd60);
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005475c(int *param_1)

{
    int iVar1;
    char *pcVar2;
    int *piVar3;
    uint uVar4;
    int iVar5;
    int local_28;
    pollfd local_24;
    int local_1c;

    iVar5 = *param_1;
    local_24.fd = *(int *)(iVar5 + 0x88);
    local_1c = __stack_chk_guard;
    local_24.events = 4;
    iVar1 = poll(&local_24, 1, 0);
    if ((iVar1 != 1) || ((local_24.revents & 4U) == 0))
        goto LAB_000547b0;
    *(undefined4 *)(iVar5 + 0x90) = 10;
    local_24.fd = 4;
    local_28 = 0;
    iVar1 = getsockopt(*(int *)(iVar5 + 0x88), 1, 4, &local_28,
                       (socklen_t *)&local_24);
    if (iVar1 == -1) {
        if (local_28 == 0) {
            piVar3 = __errno_location();
            local_28 = *piVar3;
        }
    LAB_00054814:
        pcVar2 = strerror(local_28);
        if (((*(byte *)(param_1 + 0xc0) & 4) != 0) ||
            (*(int *)(iVar5 + 0xb4) == 0xe10 || *(int *)(iVar5 + 0xb4) == 0)) {
            *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
            FUN_00074e00(3,
                         "%s: async connect to GPSD failed, fd=%d, ec=%d(%s)",
                         *(undefined4 *)(iVar5 + 0x14),
                         *(undefined4 *)(iVar5 + 0x88), local_28, pcVar2);
        }
    } else {
        if (local_28 != 0)
            goto LAB_00054814;
        param_1[7] = *(int *)(iVar5 + 0x88);
        *(undefined4 *)(iVar5 + 0x88) = 0xffffffff;
        iVar1 = FUN_00028df0(param_1 + 2);
        if (iVar1 != 0)
            goto LAB_000547b0;
        if (((*(byte *)(param_1 + 0xc0) & 4) != 0) ||
            (*(int *)(iVar5 + 0xb4) == 0xe10 || *(int *)(iVar5 + 0xb4) == 0)) {
            *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
            FUN_00074e00(3, "%s: failed to register with I/O engine",
                         *(undefined4 *)(iVar5 + 0x14));
        }
    }
    if (*(int *)(iVar5 + 0x88) != -1) {
        close(*(int *)(iVar5 + 0x88));
    }
    *(undefined4 *)(iVar5 + 0x88) = 0xffffffff;
    uVar4 = *(int *)(iVar5 + 0x94) + 5;
    *(int *)(iVar5 + 0x90) = *(int *)(iVar5 + 0x94);
    if (0x77 < uVar4) {
        uVar4 = 0x78;
    }
    *(uint *)(iVar5 + 0x94) = uVar4;
LAB_000547b0:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00054920(undefined4 param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    int __type;
    int __protocol;
    int iVar3;
    uint uVar4;
    int iVar5;
    int *piVar6;
    undefined4 local_20;
    int local_1c;

    piVar6 = *(int **)(param_2 + 0x54);
    iVar5 = *piVar6;
    local_1c = __stack_chk_guard;
    if (*(int *)(iVar5 + 8) == param_2) {
        iVar3 = *(int *)(iVar5 + 0x4c);
        if (iVar3 < 1) {
            iVar3 = 1;
        }
        *(int *)(iVar5 + 0x4c) = iVar3 + -1;
        if (iVar3 + -1 == 0) {
            if (piVar6[0x36] != piVar6[0x37]) {
                FUN_000494a0(param_2, 1);
                piVar6[0x36] = piVar6[0x37];
            }
            *(uint *)(param_2 + 0x44) = *(uint *)(param_2 + 0x44) & 0xffffff7f;
        }
        goto LAB_000549a8;
    }
    if (*(int *)(iVar5 + 0xb4) != 0) {
        *(int *)(iVar5 + 0xb4) = *(int *)(iVar5 + 0xb4) + -1;
    }
    if (*(int *)(iVar5 + 0x90) != 0) {
        iVar3 = *(int *)(iVar5 + 0x90) + -1;
        *(int *)(iVar5 + 0x90) = iVar3;
        if (iVar3 == 0)
            goto LAB_000549c0;
        if (iVar3 == 4) {
            if (piVar6[7] != -1) {
                FUN_000545b0(piVar6, &DAT_000a71ac, "?VERSION;\r\n", 0xb);
                write(piVar6[7], "?VERSION;\r\n", 0xb);
                goto LAB_000549a8;
            }
        } else if (piVar6[7] != -1)
            goto LAB_000549a8;
        if (*(int *)(iVar5 + 0x88) == -1)
            goto LAB_000549a8;
    LAB_000549a0:
        FUN_0005475c(piVar6);
        goto LAB_000549a8;
    }
LAB_000549c0:
    if (piVar6[7] != -1) {
        if (((*(byte *)(piVar6 + 0xc0) & 4) != 0) ||
            (*(int *)(iVar5 + 0xb4) == 0 || *(int *)(iVar5 + 0xb4) == 0xe10)) {
            *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
            FUN_00074e00(6, "%s: closing socket to GPSD, fd=%d",
                         *(undefined4 *)(iVar5 + 0x14), piVar6[7]);
        }
        FUN_00028e64(piVar6 + 2);
        iVar3 = *(int *)(iVar5 + 0x94);
        piVar6[7] = -1;
        uVar4 = iVar3 + 5;
        *(int *)(iVar5 + 0x90) = iVar3;
        if (0x77 < uVar4) {
            uVar4 = 0x78;
        }
        *(uint *)(iVar5 + 0x94) = uVar4;
        *(byte *)(iVar5 + 0x84) = *(byte *)(iVar5 + 0x84) & 0x99;
        goto LAB_000549a8;
    }
    if (*(int *)(iVar5 + 0x88) != -1)
        goto LAB_000549a0;
    if (DAT_000cd560 == 0)
        goto LAB_000549a8;
    iVar3 = *(int *)(iVar5 + 0x8c);
    if (*(int *)(iVar5 + 0x8c) == 0) {
        iVar3 = DAT_000cd560;
    }
    __protocol = *(int *)(iVar3 + 0xc);
    __type = *(int *)(iVar3 + 8);
    iVar1 = *(int *)(iVar3 + 4);
    *(undefined4 *)(iVar5 + 0x8c) = *(undefined4 *)(iVar3 + 0x1c);
    iVar1 = socket(iVar1, __type, __protocol);
    *(int *)(iVar5 + 0x88) = iVar1;
    if (iVar1 == -1) {
        if (((*(byte *)(piVar6 + 0xc0) & 4) != 0) ||
            (*(int *)(iVar5 + 0xb4) == 0xe10 || *(int *)(iVar5 + 0xb4) == 0)) {
            *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
            FUN_00074e00(3, "%s: cannot create GPSD socket: %m",
                         *(undefined4 *)(iVar5 + 0x14));
            goto LAB_00054a54;
        }
        iVar3 = piVar6[7];
        if (iVar3 != -1)
            goto LAB_00054a60;
    } else {
        iVar1 = fcntl(iVar1, 4, 0x800, 1);
        if (iVar1 == -1) {
            if (((*(byte *)(piVar6 + 0xc0) & 4) != 0) ||
                (*(int *)(iVar5 + 0xb4) == 0xe10 ||
                 *(int *)(iVar5 + 0xb4) == 0)) {
                *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
                FUN_00074e00(3,
                             "%s: cannot set GPSD socket to non-blocking: %m",
                             *(undefined4 *)(iVar5 + 0x14));
            }
        } else {
            local_20 = 1;
            iVar1 = setsockopt(*(int *)(iVar5 + 0x88), 6, 1, &local_20, 4);
            if ((iVar1 == -1) && (((*(byte *)(piVar6 + 0xc0) & 4) != 0 ||
                                   (*(int *)(iVar5 + 0xb4) == 0 ||
                                    *(int *)(iVar5 + 0xb4) == 0xe10)))) {
                *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
                FUN_00074e00(6, "%s: cannot disable TCP nagle: %m",
                             *(undefined4 *)(iVar5 + 0x14));
            }
            iVar3 =
                connect(*(int *)(iVar5 + 0x88), *(sockaddr **)(iVar3 + 0x14),
                        *(socklen_t *)(iVar3 + 0x10));
            if (iVar3 == -1) {
                piVar2 = __errno_location();
                if (*piVar2 == 0x73)
                    goto LAB_000549a8;
                if (((*(byte *)(piVar6 + 0xc0) & 4) != 0) ||
                    (*(int *)(iVar5 + 0xb4) == 0 ||
                     *(int *)(iVar5 + 0xb4) == 0xe10)) {
                    *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
                    FUN_00074e00(3, "%s: cannot connect GPSD socket: %m",
                                 *(undefined4 *)(iVar5 + 0x14));
                }
            } else {
                piVar6[7] = *(int *)(iVar5 + 0x88);
                *(undefined4 *)(iVar5 + 0x88) = 0xffffffff;
                iVar3 = FUN_00028df0(piVar6 + 2);
                if (iVar3 != 0)
                    goto LAB_000549a8;
                if (((*(byte *)(piVar6 + 0xc0) & 4) != 0) ||
                    (*(int *)(iVar5 + 0xb4) == 0xe10 ||
                     *(int *)(iVar5 + 0xb4) == 0)) {
                    *(undefined4 *)(iVar5 + 0xb4) = 0xe10;
                    FUN_00074e00(3, "%s: failed to register with I/O engine",
                                 *(undefined4 *)(iVar5 + 0x14));
                }
            }
        }
    LAB_00054a54:
        iVar3 = piVar6[7];
        if (iVar3 != -1) {
        LAB_00054a60:
            close(iVar3);
        }
        if (*(int *)(iVar5 + 0x88) != -1) {
            close(*(int *)(iVar5 + 0x88));
        }
    }
    iVar3 = *(int *)(iVar5 + 0x94);
    piVar6[7] = -1;
    *(undefined4 *)(iVar5 + 0x88) = 0xffffffff;
    uVar4 = iVar3 + 5;
    *(int *)(iVar5 + 0x90) = iVar3;
    if (0x77 < uVar4) {
        uVar4 = 0x78;
    }
    *(uint *)(iVar5 + 0x94) = uVar4;
LAB_000549a8:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00054e70(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    int iVar4;
    int *piVar5;
    int iVar6;

    iVar1 = __stack_chk_guard;
    piVar5 = *(int **)(param_2 + 0x54);
    iVar4 = *piVar5;
    iVar6 = *(int *)(iVar4 + 8);
    piVar5[0xc2] = piVar5[0xc2] + 1;
    iVar2 = __stack_chk_guard;
    if (iVar6 == param_2) {
        if (piVar5[0x37] == piVar5[0x36]) {
            *(undefined1 *)(iVar6 + 0x5f) = 0xec;
            *(uint *)(iVar6 + 0x44) = *(uint *)(iVar6 + 0x44) & 0xffffff7f;
            if (iVar1 == iVar2) {
                FUN_000494a0(iVar6, 1);
                return;
            }
        } else {
            piVar5[0x38] = piVar5[0x3a];
            piVar5[0x39] = piVar5[0x3b];
            FUN_000494a0(iVar6, 0);
            if (iVar1 == __stack_chk_guard) {
                FUN_00049d44(iVar6);
                return;
            }
        }
    } else {
        if (piVar5[0x37] == piVar5[0x36]) {
            *(undefined1 *)(param_2 + 0x5f) = 0xf7;
            if (piVar5[7] == -1) {
                FUN_000494a0(param_2, 3);
            } else {
                if (*(int *)(iVar4 + 0x9c) == 0) {
                    uVar3 = 1;
                } else {
                    uVar3 = 2;
                }
                FUN_000494a0(param_2, uVar3);
            }
        } else {
            piVar5[0x38] = piVar5[0x3a];
            piVar5[0x39] = piVar5[0x3b];
            FUN_000494a0(param_2, 0);
            FUN_00049d44(param_2);
        }
        if ((*(byte *)(piVar5 + 0xc0) & 8) != 0) {
            FUN_00052050(
                param_2 + 0x10, "%u %u %u %u %u %u %u",
                *(undefined4 *)(iVar4 + 0x98), *(undefined4 *)(iVar4 + 0x9c),
                *(undefined4 *)(iVar4 + 0xa0), *(undefined4 *)(iVar4 + 0xa4),
                *(undefined4 *)(iVar4 + 0xa8), *(undefined4 *)(iVar4 + 0xac),
                *(undefined4 *)(iVar4 + 0xb0));
        }
        iVar2 = __stack_chk_guard;
        *(undefined4 *)(iVar4 + 0x9c) = 0;
        *(undefined4 *)(iVar4 + 0x98) = 0;
        *(undefined4 *)(iVar4 + 0xa0) = 0;
        *(undefined4 *)(iVar4 + 0xa4) = 0;
        *(undefined4 *)(iVar4 + 0xa8) = 0;
        *(undefined4 *)(iVar4 + 0xac) = 0;
        *(undefined4 *)(iVar4 + 0xb0) = 0;
        if (iVar1 == iVar2) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00055034(undefined4 *param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    void *pvVar2;
    uint uVar3;
    size_t __size;
    undefined4 uStack_8;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    __size = 0x20;
    pvVar2 = (void *)0x0;
    uStack_8 = param_3;
    uStack_4 = param_4;
    while (true) {
        __size = __size * 2;
        free(pvVar2);
        pvVar2 = malloc(__size);
        *param_1 = pvVar2;
        if (pvVar2 == (void *)0x0)
            break;
        uVar3 =
            FUN_0007b6f8(pvVar2, __size, &DAT_000a72a0, &uStack_8, &uStack_8);
        if (uVar3 < __size)
            goto LAB_000550b4;
        pvVar2 = (void *)*param_1;
    }
    uVar3 = 0xffffffff;
LAB_000550b4:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_000550e4(uint param_1, int param_2)

{
    char *pcVar1;
    undefined4 *__ptr;
    void *__ptr_00;
    undefined4 uVar2;
    undefined4 extraout_r1;
    undefined1 uVar3;
    uint uVar4;
    int iVar5;
    undefined4 *puVar6;
    undefined4 *puVar7;
    int iVar8;
    char *pcVar9;
    undefined4 *puVar10;
    undefined *puVar11;
    uint uVar12;
    stat64 sStack_98;
    int local_2c;

    puVar7 = *(undefined4 **)(param_2 + 0x54);
    local_2c = __stack_chk_guard;
    if (DAT_000cd574 == 0) {
        iVar5 = DAT_000cd560;
        if (DAT_000cd560 != 0) {
            iVar5 = 1;
        }
    } else {
        if (DAT_000cd574 < 1) {
            if (DAT_000cd560 == 0)
                goto LAB_00055464;
        } else {
            iVar5 = 0;
            puVar11 = &DAT_000a7274;
            pcVar9 = "localhost";
            while (true) {
                iVar8 = (&DAT_000cd564)[iVar5];
                iVar5 = iVar5 + 1;
                pcVar1 = gai_strerror(iVar8);
                FUN_00074e00(
                    4, "GPSD_JSON: failed to resolve \'%s:%s\', rc=%d (%s)",
                    pcVar9, puVar11, iVar8, pcVar1);
                if (DAT_000cd574 <= iVar5)
                    break;
                pcVar9 = *(char **)(&UNK_000c46c4 + iVar5 * 8);
                puVar11 = *(undefined **)(&UNK_000c46c8 + iVar5 * 8);
            }
            if (DAT_000cd560 == 0) {
            LAB_00055464:
                FUN_00074e00(
                    3, "%s",
                    "GPSD_JSON: failed to get socket address, giving up.");
            } else {
                FUN_00074e00(4,
                             "GPSD_JSON: using \'%s:%s\' instead of \'%s:%s\'",
                             *(undefined4 *)(&UNK_000c46c4 + iVar5 * 8),
                             *(undefined4 *)(&UNK_000c46c8 + iVar5 * 8),
                             "localhost", &DAT_000a7274);
            }
        }
        iVar5 = DAT_000cd560;
        if (DAT_000cd560 != 0) {
            iVar5 = 1;
        }
        DAT_000cd574 = 0;
    }
    if (iVar5 == 0)
        goto LAB_000553ac;
    uVar12 = param_1 & 0x7f;
    puVar10 = &DAT_000ccd5c;
    if (DAT_000ccd5c == (undefined4 *)0x0) {
    LAB_00055210:
        __ptr = (undefined4 *)FUN_00073ba4(0, 0x225c, 0, 1);
        iVar8 = __ptr[1];
        *puVar10 = __ptr;
        __ptr[1] = iVar8 + 1;
        FUN_0007a3fc(param_2 + 0x10);
        uVar2 = FUN_00073d08();
        __ptr[0x25] = 10;
        __ptr[5] = uVar2;
        iVar8 = DAT_000cd560;
        __ptr[3] = uVar12;
        __ptr[0x22] = 0xffffffff;
        __ptr[0x23] = iVar8;
        iVar8 = FUN_00055034(__ptr + 6, &DAT_000a72a0, "/dev/gps", uVar12);
        if (iVar8 == -1) {
            FUN_00074e00(3, "%s: clock device name too long", __ptr[5]);
        } else {
            iVar8 = __xstat64(3, (char *)__ptr[6], &sStack_98);
            if ((iVar8 != -1) && ((sStack_98.st_mode & 0xf000) == 0x2000))
                goto LAB_000552e0;
            FUN_00074e00(3, "%s: \'%s\' is not a character device", __ptr[5],
                         __ptr[6]);
        }
    } else {
        uVar4 = DAT_000ccd5c[3];
        __ptr = DAT_000ccd5c;
        while (uVar12 != uVar4) {
            puVar6 = (undefined4 *)*__ptr;
            puVar10 = __ptr;
            if (puVar6 == (undefined4 *)0x0)
                goto LAB_00055210;
            __ptr = puVar6;
            uVar4 = puVar6[3];
        }
        __ptr[1] = __ptr[1] + 1;
    LAB_000552e0:
        uVar2 = 0xffffffff;
        *puVar7 = __ptr;
        puVar7[5] = param_2;
        puVar7[3] = FUN_000560c4;
        puVar7[6] = 0;
        *(undefined1 *)(puVar7 + 0xe) = 0;
        puVar7[0x2e] = 0;
        if ((int)param_1 < 0x80) {
            uVar3 = 0xf7;
        } else {
            uVar3 = 0xec;
        }
        puVar7[0xbf] = 0x44535047;
        puVar7[7] = 0xffffffff;
        puVar7[0xb] = "GPSD JSON client clock";
        *(undefined1 *)(param_2 + 0x5f) = uVar3;
        if (__ptr[0x23] != 0) {
            if ((ntp_syslogmask & 0x100) != 0) {
                uVar2 = FUN_0007a3fc(param_2 + 0x10);
                FUN_00074e00(5, "%s: startup, device is \'%s\'", uVar2,
                             __ptr[6]);
                uVar2 = extraout_r1;
            }
            uVar12 = *(uint *)(param_2 + 0x4c) & 3;
            __ptr[4] = uVar12;
            if (uVar12 == 3) {
                __ptr[4] = 0;
                if (0x7f < (int)param_1)
                    goto LAB_0005548c;
                iVar8 = **(int **)(param_2 + 0x54);
            } else {
                if (0x7f < (int)param_1) {
                LAB_0005548c:
                    __ptr[2] = param_2;
                    goto LAB_000553ac;
                }
                if (uVar12 == 2) {
                    uVar2 = 0x1e;
                }
                iVar8 = **(int **)(param_2 + 0x54);
                if (uVar12 == 2) {
                    *(undefined4 *)(iVar8 + 0x48) = uVar2;
                    *(byte *)(iVar8 + 0x84) = *(byte *)(iVar8 + 0x84) & 0xef;
                }
            }
            *(byte *)(iVar8 + 0x84) = *(byte *)(iVar8 + 0x84) & 0xf9;
            goto LAB_000553ac;
        }
        FUN_00074e00(3, "%s: no GPSD socket address, giving up", __ptr[5]);
    }
    iVar5 = __ptr[1];
    __ptr[1] = iVar5 + -1;
    if (iVar5 + -1 == 0) {
        __ptr_00 = (void *)__ptr[6];
        *puVar10 = *__ptr;
        free(__ptr_00);
        free(__ptr);
    }
    iVar5 = 0;
    *puVar7 = 0;
LAB_000553ac:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar5);
}

void FUN_00055590(int *param_1, char *param_2, int param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    iVar3 = param_1[1];
    if ((((0 < iVar3) && (param_1[2] == 1)) &&
         (iVar4 = param_1[5], iVar4 != 0)) &&
        (2 < iVar3)) {
        iVar5 = 2;
        iVar2 = 1;
        do {
            if (param_1[iVar2 * 5 + 2] == 3) {
                iVar2 = strcmp(param_2,
                               (char *)(*param_1 + param_1[iVar2 * 5 + 3]));
                if (iVar2 == 0) {
                    if (param_1[iVar5 * 5 + 2] != param_3) {
                        iVar5 = -1;
                    }
                    goto LAB_00055654;
                }
                iVar2 = FUN_000544f8(param_1, iVar5);
            LAB_00055648:
                if (iVar2 < 0)
                    break;
            } else if (iVar2 < iVar3) {
                iVar2 = FUN_000544f8(param_1, iVar2);
                if (iVar2 < 0)
                    break;
                if (iVar2 < iVar3) {
                    iVar2 = FUN_000544f8(param_1, iVar2);
                    goto LAB_00055648;
                }
            }
            iVar4 = iVar4 + -1;
            if ((iVar4 == 0) || (iVar5 = iVar2 + 1, iVar3 <= iVar5))
                break;
        } while (true);
    }
    iVar5 = -1;
LAB_00055654:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
}

void FUN_000556c0(int *param_1, undefined4 param_2)

{
    int iVar1;
    int *piVar2;
    char *pcVar3;
    undefined8 uVar4;
    char *local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    iVar1 = FUN_00055590(param_1, param_2, 0);
    if (iVar1 != -1) {
        pcVar3 = (char *)(*param_1 + param_1[iVar1 * 5 + 3]);
        if (pcVar3 != (char *)0x0) {
            uVar4 = FUN_00053f08(pcVar3, &local_18);
            if ((pcVar3 == local_18) || (*local_18 != '\0')) {
                uVar4 = 0;
            }
            goto LAB_00055758;
        }
    }
    piVar2 = __errno_location();
    uVar4 = 0;
    *piVar2 = 0x16;
LAB_00055758:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail((int)uVar4, (int)((ulonglong)uVar4 >> 0x20));
}

void FUN_00055784(int *param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4, int param_5)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    int iVar4;
    int iVar5;
    int iVar6;
    undefined4 uVar7;

    iVar2 = __stack_chk_guard;
    uVar7 = 0;
    piVar3 = __errno_location();
    *piVar3 = 0;
    iVar4 = FUN_000556c0(param_2, param_3);
    iVar5 = FUN_000556c0(param_2, param_4);
    if (*piVar3 == 0) {
        iVar5 = iVar5 * param_5;
        if (iVar5 < 0) {
            do {
                iVar6 = iVar5 + 1000000000;
                iVar4 = iVar4 + -1;
                iVar5 = iVar6;
            } while (iVar6 < 0);
        } else {
            iVar6 = iVar5;
            if (999999999 < iVar5) {
                iVar6 = iVar5 + -1000000000;
                iVar1 = iVar5 + -1999999999;
                if (iVar6 < 1000000000) {
                    iVar4 = iVar4 + 1;
                } else {
                    iVar5 = iVar5 + -0x77360000;
                }
                if (iVar6 != 999999999 &&
                    iVar1 < 0 == SBORROW4(iVar6, 999999999)) {
                    iVar4 = iVar4 + 2;
                    iVar6 = iVar5 + 0x6c00;
                }
            }
        }
        uVar7 = 1;
        *param_1 = iVar4 + -0x7c558180;
        iVar4 = FUN_0009bfd0(500000000, iVar6, 1000000000, 0);
        param_1[1] = iVar4;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar7);
}

void FUN_000558b8(int *param_1, undefined4 param_2)

{
    char cVar1;
    int iVar2;
    int iVar3;

    iVar2 = __stack_chk_guard;
    iVar3 = FUN_00055590(param_1, param_2, 0);
    if (iVar3 != -1) {
        if (*param_1 + param_1[iVar3 * 5 + 3] == 0) {
            iVar3 = -1;
        } else {
            cVar1 = *(char *)(*param_1 + param_1[iVar3 * 5 + 3]);
            if (cVar1 == 'f') {
                iVar3 = 0;
            } else if (cVar1 == 't') {
                iVar3 = 1;
            } else {
                iVar3 = -1;
            }
        }
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_0005594c(int *param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    char *pcVar2;
    undefined8 uVar3;
    char *local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = FUN_00055590(param_1, param_2, 0);
    if (iVar1 != -1) {
        pcVar2 = (char *)(*param_1 + param_1[iVar1 * 5 + 3]);
        if (pcVar2 != (char *)0x0) {
            uVar3 = FUN_00053f08(pcVar2, &local_20);
            if ((pcVar2 != local_20) && (*local_20 == '\0'))
                goto LAB_000559d0;
        }
    }
    uVar3 = CONCAT44(param_4, param_3);
LAB_000559d0:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail((int)uVar3, (int)((ulonglong)uVar3 >> 0x20));
}

void FUN_000559f4(uint *param_1, int param_2, uint param_3, int param_4,
                  uint param_5)

{
    char cVar1;
    byte bVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    uint uVar6;
    uint uVar7;
    undefined4 uVar8;
    byte *pbVar9;
    int iVar10;
    uint uVar11;
    uint uVar12;
    int *piVar13;
    uint uVar14;
    uint uVar15;
    bool bVar16;
    bool bVar17;

    iVar3 = __stack_chk_guard;
    uVar15 = *param_1;
    iVar5 = 0;
    if ((uVar15 < param_3) &&
        (uVar12 = (uint) * (byte *)(param_2 + uVar15), uVar12 != 0)) {
        iVar5 = 0;
    LAB_00055a84:
        if (uVar12 == 0x2c) {
            uVar14 = *param_1;
            if ((param_4 != 0) &&
                (1 < *(int *)(param_4 + param_1[2] * 0x14) - 1U)) {
                param_1[2] = *(uint *)(param_4 + param_1[2] * 0x14 + 0x10);
            }
            goto LAB_00055a68;
        }
        if (0x2c < uVar12) {
            if (uVar12 == 0x5d) {
            LAB_00055d8c:
                if (param_4 == 0)
                    goto LAB_00055d14;
                if (uVar12 == 0x7d) {
                    iVar4 = 1;
                } else {
                    iVar4 = 2;
                }
                if (param_1[1] != 0) {
                    piVar13 = (int *)(param_4 + param_1[1] * 0x14 + -0x14);
                    while (true) {
                        if ((piVar13[1] != -1) && (piVar13[2] == -1)) {
                            if (*piVar13 != iVar4)
                                goto LAB_00056048;
                            piVar13[2] = uVar15 + 1;
                            uVar14 = *param_1;
                            param_1[2] = piVar13[4];
                            goto LAB_00055a68;
                        }
                        if (piVar13[4] == -1)
                            break;
                        piVar13 = (int *)(param_4 + piVar13[4] * 0x14);
                    }
                    uVar15 = *param_1;
                    goto LAB_00055d18;
                }
            LAB_00056048:
                iVar5 = -2;
            } else {
                if (uVar12 < 0x5e) {
                    if (uVar12 == 0x3a) {
                        uVar14 = *param_1;
                        param_1[2] = param_1[1] - 1;
                        goto LAB_00055a68;
                    }
                    if (uVar12 != 0x5b)
                        goto LAB_00055dfc;
                } else if (uVar12 != 0x7b) {
                    if (uVar12 != 0x7d)
                        goto LAB_00055dfc;
                    goto LAB_00055d8c;
                }
                iVar5 = iVar5 + 1;
                if (param_4 == 0)
                    goto LAB_00055d14;
                uVar6 = param_1[1];
                if (uVar6 < param_5) {
                    uVar14 = param_1[2];
                    iVar4 = param_4 + uVar6 * 0x14;
                    param_1[1] = uVar6 + 1;
                    *(undefined4 *)(iVar4 + 8) = 0xffffffff;
                    *(undefined4 *)(iVar4 + 4) = 0xffffffff;
                    *(undefined4 *)(iVar4 + 0xc) = 0;
                    *(undefined4 *)(iVar4 + 0x10) = 0xffffffff;
                    if (uVar14 != 0xffffffff) {
                        iVar10 = param_4 + uVar14 * 0x14;
                        *(int *)(iVar10 + 0xc) = *(int *)(iVar10 + 0xc) + 1;
                        *(uint *)(iVar4 + 0x10) = uVar14;
                    }
                    uVar14 = *param_1;
                    if (uVar12 == 0x7b) {
                        uVar8 = 1;
                    } else {
                        uVar8 = 2;
                    }
                    *(undefined4 *)(param_4 + uVar6 * 0x14) = uVar8;
                    *(uint *)(iVar4 + 4) = uVar15;
                    param_1[2] = uVar6;
                    goto LAB_00055a68;
                }
                iVar5 = -1;
            }
            goto LAB_00055ce8;
        }
        if (uVar12 == 0xd)
            goto LAB_00055d14;
        if (uVar12 < 0xe) {
            if (1 < uVar12 - 9)
                goto LAB_00055dfc;
            goto LAB_00055d14;
        }
        if (uVar12 == 0x20)
            goto LAB_00055d14;
        if (uVar12 != 0x22) {
        LAB_00055dfc:
            uVar12 = *param_1;
            if (uVar12 < param_3) {
                pbVar9 = (byte *)(param_2 + uVar12);
                bVar2 = *(byte *)(param_2 + uVar12);
                while (
                    (uVar14 = (uint)bVar2, uVar14 != 0 && (uVar14 != 0x20))) {
                    if (uVar14 < 0x21) {
                        if ((8 < uVar14) && ((uVar14 < 0xb || (uVar14 == 0xd))))
                            break;
                    } else {
                        if (uVar14 == 0x3a)
                            break;
                        if (uVar14 < 0x3b) {
                            if (uVar14 == 0x2c)
                                break;
                        } else if ((uVar14 == 0x5d) || (uVar14 == 0x7d))
                            break;
                    }
                    if (0x5e < uVar14 - 0x20)
                        goto switchD_00055b20_default;
                    uVar12 = uVar12 + 1;
                    *param_1 = uVar12;
                    if (param_3 == uVar12)
                        break;
                    pbVar9 = pbVar9 + 1;
                    bVar2 = *pbVar9;
                }
            }
            if (param_4 != 0) {
                uVar6 = param_1[1];
                if (uVar6 < param_5) {
                    uVar7 = param_1[2];
                    iVar4 = param_4 + uVar6 * 0x14;
                    bVar16 = uVar7 != 0xffffffff;
                    param_1[1] = uVar6 + 1;
                    *(undefined4 *)(iVar4 + 0xc) = 0;
                    uVar14 = uVar12 - 1;
                    *(undefined4 *)(param_4 + uVar6 * 0x14) = 0;
                    iVar5 = iVar5 + 1;
                    *(uint *)(iVar4 + 4) = uVar15;
                    if (bVar16) {
                        uVar15 = uVar7 * 5;
                    }
                    *(uint *)(iVar4 + 8) = uVar12;
                    if (bVar16) {
                        uVar15 = param_4 + uVar15 * 4;
                    }
                    *(uint *)(iVar4 + 0x10) = uVar7;
                    *param_1 = uVar14;
                    if (bVar16) {
                        *(int *)(uVar15 + 0xc) = *(int *)(uVar15 + 0xc) + 1;
                    }
                    goto LAB_00055a68;
                }
                goto LAB_00056058;
            }
            uVar14 = uVar12 - 1;
            iVar5 = iVar5 + 1;
            goto LAB_00055a68;
        }
        uVar12 = uVar15 + 1;
        *param_1 = uVar12;
        if (param_3 <= uVar12) {
        LAB_00055cd4:
            *param_1 = uVar15;
            iVar5 = -3;
            goto LAB_00055ce8;
        }
        cVar1 = *(char *)(param_2 + uVar12);
        uVar14 = uVar12;
    joined_r0x00055ac8:
        if (cVar1 == '\0')
            goto LAB_00055cd4;
        if (cVar1 == '\"')
            goto LAB_00055d08;
        if ((cVar1 != '\\') || (uVar6 = uVar14 + 1, param_3 <= uVar6)) {
            uVar6 = *param_1;
            goto LAB_00055ad4;
        }
        *param_1 = uVar6;
        pbVar9 = (byte *)(param_2 + uVar6);
        switch (*(undefined1 *)(param_2 + uVar6)) {
        case 0x22:
            break;
        case 0x23:
            goto switchD_00055b20_default;
        case 0x24:
            goto switchD_00055b20_default;
        case 0x25:
            goto switchD_00055b20_default;
        case 0x26:
            goto switchD_00055b20_default;
        case 0x27:
            goto switchD_00055b20_default;
        case 0x28:
            goto switchD_00055b20_default;
        case 0x29:
            goto switchD_00055b20_default;
        case 0x2a:
            goto switchD_00055b20_default;
        case 0x2b:
            goto switchD_00055b20_default;
        case 0x2c:
            goto switchD_00055b20_default;
        case 0x2d:
            goto switchD_00055b20_default;
        case 0x2e:
            goto switchD_00055b20_default;
        case 0x2f:
            break;
        case 0x30:
            goto switchD_00055b20_default;
        case 0x31:
            goto switchD_00055b20_default;
        case 0x32:
            goto switchD_00055b20_default;
        case 0x33:
            goto switchD_00055b20_default;
        case 0x34:
            goto switchD_00055b20_default;
        case 0x35:
            goto switchD_00055b20_default;
        case 0x36:
            goto switchD_00055b20_default;
        case 0x37:
            goto switchD_00055b20_default;
        case 0x38:
            goto switchD_00055b20_default;
        case 0x39:
            goto switchD_00055b20_default;
        case 0x3a:
            goto switchD_00055b20_default;
        case 0x3b:
            goto switchD_00055b20_default;
        case 0x3c:
            goto switchD_00055b20_default;
        case 0x3d:
            goto switchD_00055b20_default;
        case 0x3e:
            goto switchD_00055b20_default;
        case 0x3f:
            goto switchD_00055b20_default;
        case 0x40:
            goto switchD_00055b20_default;
        case 0x41:
            goto switchD_00055b20_default;
        case 0x42:
            goto switchD_00055b20_default;
        case 0x43:
            goto switchD_00055b20_default;
        case 0x44:
            goto switchD_00055b20_default;
        case 0x45:
            goto switchD_00055b20_default;
        case 0x46:
            goto switchD_00055b20_default;
        case 0x47:
            goto switchD_00055b20_default;
        case 0x48:
            goto switchD_00055b20_default;
        case 0x49:
            goto switchD_00055b20_default;
        case 0x4a:
            goto switchD_00055b20_default;
        case 0x4b:
            goto switchD_00055b20_default;
        case 0x4c:
            goto switchD_00055b20_default;
        case 0x4d:
            goto switchD_00055b20_default;
        case 0x4e:
            goto switchD_00055b20_default;
        case 0x4f:
            goto switchD_00055b20_default;
        case 0x50:
            goto switchD_00055b20_default;
        case 0x51:
            goto switchD_00055b20_default;
        case 0x52:
            goto switchD_00055b20_default;
        case 0x53:
            goto switchD_00055b20_default;
        case 0x54:
            goto switchD_00055b20_default;
        case 0x55:
            goto switchD_00055b20_default;
        case 0x56:
            goto switchD_00055b20_default;
        case 0x57:
            goto switchD_00055b20_default;
        case 0x58:
            goto switchD_00055b20_default;
        case 0x59:
            goto switchD_00055b20_default;
        case 0x5a:
            goto switchD_00055b20_default;
        case 0x5b:
            goto switchD_00055b20_default;
        case 0x5c:
            break;
        case 0x5d:
            goto switchD_00055b20_default;
        case 0x5e:
            goto switchD_00055b20_default;
        case 0x5f:
            goto switchD_00055b20_default;
        case 0x60:
            goto switchD_00055b20_default;
        case 0x61:
            goto switchD_00055b20_default;
        case 0x62:
            break;
        case 99:
            goto switchD_00055b20_default;
        case 100:
            goto switchD_00055b20_default;
        case 0x65:
            goto switchD_00055b20_default;
        case 0x66:
            break;
        case 0x67:
            goto switchD_00055b20_default;
        case 0x68:
            goto switchD_00055b20_default;
        case 0x69:
            goto switchD_00055b20_default;
        case 0x6a:
            goto switchD_00055b20_default;
        case 0x6b:
            goto switchD_00055b20_default;
        case 0x6c:
            goto switchD_00055b20_default;
        case 0x6d:
            goto switchD_00055b20_default;
        case 0x6e:
            break;
        case 0x6f:
            goto switchD_00055b20_default;
        case 0x70:
            goto switchD_00055b20_default;
        case 0x71:
            goto switchD_00055b20_default;
        case 0x72:
            break;
        case 0x73:
        switchD_00055b20_default:
            iVar5 = -2;
            *param_1 = uVar15;
            goto LAB_00055ce8;
        case 0x74:
            break;
        case 0x75:
            uVar6 = uVar14 + 2;
            *param_1 = uVar6;
            do {
                if (param_3 == uVar6)
                    break;
                pbVar9 = pbVar9 + 1;
                uVar7 = (uint)*pbVar9;
                if (uVar7 == 0)
                    break;
                uVar11 = (uVar7 & 0xffffffdf) - 0x41;
                bVar17 = 4 < uVar11;
                bVar16 = uVar11 == 5;
                if (5 < uVar11) {
                    bVar17 = 8 < uVar7 - 0x30;
                    bVar16 = uVar7 - 0x30 == 9;
                }
                if (bVar17 && !bVar16)
                    goto switchD_00055b20_default;
                uVar6 = uVar6 + 1;
                *param_1 = uVar6;
            } while (uVar6 != uVar14 + 6);
            *param_1 = uVar6;
            if (uVar6 < param_3)
                goto LAB_00055ae4;
            goto LAB_00055cd4;
        default:
            goto switchD_00055b20_default;
        }
    LAB_00055ad4:
        uVar6 = uVar6 + 1;
        *param_1 = uVar6;
        if (param_3 <= uVar6)
            goto LAB_00055cd4;
    LAB_00055ae4:
        cVar1 = *(char *)(param_2 + uVar6);
        uVar14 = uVar6;
        goto joined_r0x00055ac8;
    }
LAB_00055d2c:
    if (param_4 != 0) {
        iVar4 = param_1[1] - 1;
        if (-1 < iVar4) {
            param_4 = param_4 + param_1[1] * 0x14;
            do {
                if ((*(int *)(param_4 + -0x10) != -1) &&
                    (*(int *)(param_4 + -0xc) == -1)) {
                    iVar5 = -3;
                    break;
                }
                iVar4 = iVar4 + -1;
                param_4 = param_4 + -0x14;
            } while (iVar4 != -1);
        }
    }
LAB_00055ce8:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
LAB_00055d08:
    if (param_4 == 0) {
        iVar5 = iVar5 + 1;
    } else {
        uVar6 = param_1[1];
        if (param_5 <= uVar6) {
        LAB_00056058:
            *param_1 = uVar15;
            iVar5 = -1;
            goto LAB_00055ce8;
        }
        uVar15 = param_1[2];
        param_1[1] = uVar6 + 1;
        iVar4 = param_4 + uVar6 * 0x14;
        *(undefined4 *)(iVar4 + 0xc) = 0;
        iVar5 = iVar5 + 1;
        *(undefined4 *)(param_4 + uVar6 * 0x14) = 3;
        *(uint *)(iVar4 + 4) = uVar12;
        *(uint *)(iVar4 + 8) = uVar14;
        *(uint *)(iVar4 + 0x10) = uVar15;
        if (uVar15 != 0xffffffff) {
            uVar14 = *param_1;
            iVar4 = param_4 + uVar15 * 0x14;
            *(int *)(iVar4 + 0xc) = *(int *)(iVar4 + 0xc) + 1;
        LAB_00055a68:
            uVar15 = uVar14 + 1;
            *param_1 = uVar15;
            goto joined_r0x00055a74;
        }
    }
LAB_00055d14:
    uVar15 = *param_1;
LAB_00055d18:
    uVar15 = uVar15 + 1;
    *param_1 = uVar15;
joined_r0x00055a74:
    if ((param_3 <= uVar15) ||
        (uVar12 = (uint) * (byte *)(param_2 + uVar15), uVar12 == 0))
        goto LAB_00055d2c;
    goto LAB_00055a84;
}

void FUN_00056070(undefined4 *param_1)

{
    int iVar1;

    param_1[1] = 0;
    param_1[2] = 0xffffffff;
    iVar1 = __stack_chk_guard;
    *param_1 = 0;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000560c4(int param_1)

{
    int iVar1;
    ushort uVar2;
    int iVar3;
    int iVar4;
    int *piVar5;
    size_t __n;
    size_t sVar6;
    byte *pbVar7;
    uint uVar8;
    int iVar9;
    int iVar10;
    ushort **ppuVar11;
    char cVar12;
    undefined4 uVar13;
    byte bVar14;
    byte *pbVar15;
    byte *pbVar16;
    int *piVar17;
    int iVar18;
    int *piVar19;
    char *extraout_r3;
    int iVar20;
    byte *pbVar21;
    byte bVar22;
    undefined *puVar23;
    undefined *puVar24;
    int iVar25;
    undefined4 uVar26;
    byte *pbVar27;
    byte *pbVar28;
    char *pcVar29;
    int iVar30;
    byte *pbVar31;
    uint uVar32;
    int iVar33;
    bool bVar34;
    double dVar35;
    double dVar36;
    double dVar37;
    char *pcVar38;
    int local_90;
    char *local_74;
    char *local_70;
    tm local_68;
    int local_3c;

    pbVar27 = (byte *)(param_1 + 0x58);
    iVar3 = *(int *)(param_1 + 4);
    iVar33 = **(int **)(iVar3 + 0x54);
    local_3c = __stack_chk_guard;
    pbVar21 = (byte *)(iVar33 + 0x1c1c);
    FUN_000545b0(*(int **)(iVar3 + 0x54), &DAT_000a7408, pbVar27,
                 *(undefined4 *)(param_1 + 0x54));
    pbVar31 = pbVar27 + *(int *)(param_1 + 0x54);
    pbVar15 = pbVar21 + *(int *)(iVar33 + 0x1c18);
    pbVar16 = pbVar15;
    if (pbVar27 != pbVar31) {
        dVar37 = 0.00141421356;
    LAB_00056194:
        do {
            pbVar28 = pbVar27 + 1;
            bVar14 = *pbVar27;
            pbVar27 = pbVar28;
            if (bVar14 != 10) {
                if (pbVar15 + 0x63f != pbVar16) {
                    bVar34 = bVar14 == 0x20;
                    if (bVar14 < 0x21) {
                        bVar34 = pbVar21 == pbVar16;
                    }
                    if (!bVar34) {
                        *pbVar16 = bVar14;
                        pbVar16 = pbVar16 + 1;
                    }
                }
                goto LAB_0005618c;
            }
            if ((pbVar21 != pbVar16) && (pbVar16[-1] < 0x21)) {
                pbVar7 = pbVar16 + -1;
                do {
                    pbVar16 = pbVar7;
                    if (pbVar16 == pbVar21)
                        break;
                    pbVar7 = pbVar16 + -1;
                } while (pbVar16[-1] < 0x21);
            }
            iVar25 = 0;
            *pbVar16 = 0;
            piVar17 = *(int **)(iVar3 + 0x54);
            *(int *)(iVar33 + 0x1c18) = (int)pbVar16 - (int)pbVar21;
            iVar20 = *piVar17;
            uVar13 = *(undefined4 *)(iVar20 + 0x1c18);
            FUN_00056070(&local_68);
            pcVar38 = (char *)0x15e;
            iVar4 = FUN_000559f4(&local_68, iVar20 + 0x1c1c, uVar13,
                                 iVar20 + 0xc0, 0x15e);
            pbVar16 = pbVar21;
            if (0 < iVar4) {
                *(int *)(iVar20 + 0xb8) = iVar20 + 0x1c1c;
                *(int *)(iVar20 + 0xbc) = iVar4;
                iVar4 = iVar20;
                if (*(int *)(iVar20 + 0xc0) == 1) {
                    do {
                        iVar25 = iVar25 + 1;
                        if (*(int *)(iVar4 + 0xc4) < *(int *)(iVar4 + 200)) {
                            *(undefined1 *)(*(int *)(iVar20 + 0xb8) +
                                            *(int *)(iVar4 + 200)) = 0;
                        }
                        iVar4 = iVar4 + 0x14;
                    } while (iVar25 < *(int *)(iVar20 + 0xbc));
                    iVar25 = iVar20 + 0xb8;
                    iVar4 = FUN_00055590(iVar25, "class", 3);
                    if (iVar4 != -1) {
                        iVar18 = *(int *)(iVar20 + 0xb8);
                        iVar4 = *(int *)(iVar20 + iVar4 * 0x14 + 0xc4);
                        pcVar29 = (char *)(iVar18 + iVar4);
                        if (pcVar29 != (char *)0x0) {
                            cVar12 = *(char *)(iVar18 + iVar4);
                            if (cVar12 != 'T') {
                                if ((((cVar12 != 'P') || (pcVar29[1] != 'P')) ||
                                     (pcVar29[2] != 'S')) ||
                                    (pcVar29[3] != '\0'))
                                    goto LAB_000566b0;
                                piVar19 = *(int **)(iVar3 + 0x54);
                                iVar4 = *piVar19;
                                *(int *)(iVar4 + 0xac) =
                                    *(int *)(iVar4 + 0xac) + 1;
                                if ((*(byte *)(iVar4 + 0x84) & 1) != 0)
                                    goto LAB_000565d8;
                                uVar13 = *(undefined4 *)(param_1 + 0x4c);
                                *(undefined4 *)(iVar4 + 0x20) =
                                    *(undefined4 *)(param_1 + 0x48);
                                *(undefined4 *)(iVar4 + 0x24) = uVar13;
                                if ((*(byte *)(iVar4 + 0x84) & 0x80) == 0) {
                                    pcVar38 = (char *)0x3e8;
                                    iVar18 = FUN_00055784(iVar4 + 0x40, iVar25,
                                                          "clock_sec",
                                                          "clock_musec", 1000);
                                    if (iVar18 != 0) {
                                        pcVar38 = (char *)0x3e8;
                                        iVar18 = FUN_00055784(
                                            iVar4 + 0x38, iVar25, "real_sec",
                                            "real_musec", 1000);
                                    joined_r0x00056d1c:
                                        if (iVar18 != 0) {
                                            local_90 = iVar4 + 0x38;
                                            iVar18 = FUN_0005594c(
                                                iVar25, "precision",
                                                (int)*(short *)(iVar4 + 0x68),
                                                (int)*(short *)(iVar4 + 0x68) >>
                                                    0x1f);
                                            iVar25 = -0x20;
                                            if (-0x21 < iVar18) {
                                                iVar25 = iVar18;
                                            }
                                            *(ushort *)(iVar4 + 0x6a) =
                                                (ushort)iVar25 &
                                                (ushort)(iVar25 >> 0x1f);
                                            iVar25 = *(int *)(iVar4 + 0x40) -
                                                     *(int *)(iVar4 + 0x6c);
                                            *(int *)(iVar4 + 0x30) =
                                                *(int *)(iVar4 + 0x40);
                                            *(undefined4 *)(iVar4 + 0x34) =
                                                *(undefined4 *)(iVar4 + 0x44);
                                            if (*(uint *)(iVar4 + 0x34) <
                                                *(uint *)(iVar4 + 0x70)) {
                                                iVar25 = iVar25 + -1;
                                            }
                                            iVar18 = *(uint *)(iVar4 + 0x34) -
                                                     *(uint *)(iVar4 + 0x70);
                                            *(int *)(iVar4 + 0x30) = iVar25;
                                            iVar9 = *(int *)(iVar4 + 0x40) -
                                                    *(int *)(iVar4 + 0x74);
                                            *(int *)(iVar4 + 0x34) = iVar18;
                                            iVar30 = *(int *)(iVar4 + 0x34);
                                            iVar10 = *(int *)(iVar4 + 8);
                                            if (*(uint *)(iVar4 + 0x44) <
                                                *(uint *)(iVar4 + 0x78)) {
                                                iVar9 = iVar9 + -1;
                                            }
                                            *(int *)(iVar4 + 0x40) = iVar9;
                                            *(int *)(iVar4 + 0x44) =
                                                *(int *)(iVar4 + 0x44) -
                                                *(int *)(iVar4 + 0x78);
                                            piVar19[0x3a] =
                                                *(int *)(iVar4 + 0x30);
                                            piVar19[0x3b] = iVar30;
                                            *(int *)(iVar4 + 0x28) =
                                                iVar25 - (iVar18 >> 0x1f);
                                            *(undefined4 *)(iVar4 + 0x2c) = 0;
                                            if (iVar10 != 0) {
                                                uVar26 =
                                                    *(undefined4 *)(iVar10 +
                                                                    0x54);
                                                uVar13 = FUN_00079ca0(local_90);
                                                FUN_00054468(uVar26, uVar13);
                                            }
                                            *(byte *)(iVar4 + 0x84) =
                                                *(byte *)(iVar4 + 0x84) & 0xfb |
                                                (byte)(((int)((*(byte
                                                                     *)(piVar19 +
                                                                        0xc0) ^
                                                               2)
                                                              << 0x1e) >>
                                                            0x1f &
                                                        1U)
                                                       << 2) |
                                                8;
                                            goto LAB_000565d8;
                                        }
                                    }
                                } else {
                                    pcVar38 = (char *)0x1;
                                    iVar18 = FUN_00055784(iVar4 + 0x40, iVar25,
                                                          "clock_sec",
                                                          "clock_nsec", 1);
                                    if (iVar18 != 0) {
                                        pcVar38 = (char *)0x1;
                                        iVar18 = FUN_00055784(
                                            iVar4 + 0x38, iVar25, "real_sec",
                                            "real_nsec", 1);
                                        goto joined_r0x00056d1c;
                                    }
                                }
                                goto LAB_000565cc;
                            }
                            if (((pcVar29[1] == 'P') && (pcVar29[2] == 'V')) &&
                                (pcVar29[3] == '\0')) {
                                piVar19 = *(int **)(iVar3 + 0x54);
                                iVar30 = *piVar19;
                                iVar4 = FUN_0005594c(iVar25, "mode", 0, 0);
                                iVar18 = FUN_00055590(iVar25, "time", 3);
                                if (iVar18 == -1) {
                                    bVar14 = *(byte *)(iVar30 + 0x85);
                                    pcVar29 = extraout_r3;
                                } else {
                                    bVar14 = *(byte *)(iVar30 + 0x85);
                                    pcVar29 = (char *)(*(int *)(iVar20 + 0xb8) +
                                                       *(int *)(iVar20 +
                                                                iVar18 * 0x14 +
                                                                0xc4));
                                    if (1 < iVar4 && pcVar29 != (char *)0x0) {
                                        *(byte *)(iVar30 + 0x84) =
                                            *(byte *)(iVar30 + 0x84) & 0xfe;
                                        if ((bVar14 & 1) == 0) {
                                            *(int *)(iVar30 + 0xa4) =
                                                *(int *)(iVar30 + 0xa4) + 1;
                                            FUN_00054468(piVar19, pcVar29);
                                            pbVar7 = (byte *)strptime(
                                                pcVar29, "%Y-%m-%dT%H:%M:%S",
                                                &local_68);
                                            if (pbVar7 != (byte *)0x0) {
                                                uVar8 = (uint)*pbVar7;
                                                if (uVar8 == 0x2e) {
                                                    ppuVar11 = __ctype_b_loc();
                                                    uVar32 = 100000000;
                                                    iVar4 = 0;
                                                    while (true) {
                                                        pbVar7 = pbVar7 + 1;
                                                        uVar8 = (uint)*pbVar7;
                                                        if (((*ppuVar11)
                                                                 [uVar8] &
                                                             0x800) == 0)
                                                            break;
                                                        iVar4 =
                                                            uVar32 *
                                                                (uVar8 - 0x30) +
                                                            iVar4;
                                                        uVar32 = uVar32 / 10;
                                                    }
                                                } else {
                                                    iVar4 = 0;
                                                }
                                                if ((uVar8 == 0x5a) &&
                                                    (pbVar7[1] == 0)) {
                                                    iVar9 =
                                                        FUN_000763c0(&local_68);
                                                    iVar18 =
                                                        FUN_00076604(&local_68);
                                                    iVar18 =
                                                        (iVar9 + -0xa955c) *
                                                            0x15180 +
                                                        iVar18;
                                                    if (iVar4 < 0) {
                                                        do {
                                                            iVar9 = iVar4 +
                                                                    1000000000;
                                                            iVar10 =
                                                                iVar18 + -1;
                                                            iVar4 = iVar9;
                                                            iVar18 = iVar10;
                                                        } while (iVar9 < 0);
                                                    } else {
                                                        iVar9 = iVar4;
                                                        iVar10 = iVar18;
                                                        if (999999999 < iVar4) {
                                                            iVar10 = iVar18 + 1;
                                                            iVar9 = iVar4 +
                                                                    -1000000000;
                                                            iVar1 = iVar4 +
                                                                    -1999999999;
                                                            if (999999999 <
                                                                iVar9) {
                                                                iVar18 =
                                                                    iVar18 + 2;
                                                                iVar4 =
                                                                    iVar4 +
                                                                    -0x77360000;
                                                            }
                                                            if (iVar9 !=
                                                                    999999999 &&
                                                                iVar1 < 0 ==
                                                                    SBORROW4(
                                                                        iVar9,
                                                                        999999999)) {
                                                                iVar9 = iVar4 +
                                                                        0x6c00;
                                                                iVar10 = iVar18;
                                                            }
                                                        }
                                                    }
                                                    *(int *)(iVar30 + 0x58) =
                                                        iVar10;
                                                    uVar13 = FUN_0009bfd0(
                                                        500000000, iVar9,
                                                        1000000000, 0);
                                                    *(undefined4 *)(iVar30 +
                                                                    0x5c) =
                                                        uVar13;
                                                    uVar13 = *(
                                                        undefined4 *)(param_1 +
                                                                      0x4c);
                                                    *(undefined4 *)(iVar30 +
                                                                    0x50) =
                                                        *(undefined4
                                                              *)(param_1 +
                                                                 0x48);
                                                    *(undefined4 *)(iVar30 +
                                                                    0x54) =
                                                        uVar13;
                                                    uVar13 = *(
                                                        undefined4 *)(param_1 +
                                                                      0x4c);
                                                    *(undefined4 *)(iVar30 +
                                                                    0x60) =
                                                        *(undefined4
                                                              *)(param_1 +
                                                                 0x48);
                                                    *(undefined4 *)(iVar30 +
                                                                    100) =
                                                        uVar13;
                                                    iVar4 =
                                                        *(int *)(iVar30 +
                                                                 0x60) -
                                                        *(int *)(iVar30 + 0x7c);
                                                    if (*(uint *)(iVar30 +
                                                                  100) <
                                                        *(uint *)(iVar30 +
                                                                  0x80)) {
                                                        iVar4 = iVar4 + -1;
                                                    }
                                                    *(uint *)(iVar30 + 100) =
                                                        *(uint *)(iVar30 +
                                                                  100) -
                                                        *(uint *)(iVar30 +
                                                                  0x80);
                                                    *(int *)(iVar30 + 0x60) =
                                                        iVar4;
                                                    *(byte *)(iVar30 + 0x84) =
                                                        *(byte *)(iVar30 +
                                                                  0x84) |
                                                        2;
                                                    goto LAB_000563d4;
                                                }
                                            }
                                            *(int *)(iVar30 + 0x9c) =
                                                *(int *)(iVar30 + 0x9c) + 1;
                                            *(byte *)(iVar30 + 0x84) =
                                                *(byte *)(iVar30 + 0x84) & 0xfd;
                                        }
                                    LAB_000563d4:
                                        iVar4 = FUN_00055590(iVar25, "ept", 0);
                                        dVar36 = dVar37;
                                        if ((((iVar4 != -1) &&
                                              (pcVar29 =
                                                   (char *)(*(int *)(iVar20 +
                                                                     0xb8) +
                                                            *(int *)(iVar20 +
                                                                     iVar4 *
                                                                         0x14 +
                                                                     0xc4)),
                                               pcVar29 != (char *)0x0)) &&
                                             (dVar35 = strtod(
                                                  pcVar29, (char **)&local_68),
                                              pcVar29 !=
                                                  (char *)local_68.tm_sec)) &&
                                            (*(char *)local_68.tm_sec ==
                                             '\0')) {
                                            dVar36 = ABS(dVar35) * 0.70710678;
                                        }
                                        dVar36 =
                                            frexp(dVar36, &local_68.tm_sec);
                                        if (dVar36 < 0.25) {
                                            local_68.tm_sec = -0x80000000;
                                        }
                                        if (2.0 < dVar36) {
                                            uVar2 = 0;
                                        } else {
                                            pcVar29 = (char *)local_68.tm_sec;
                                            if (local_68.tm_sec < -0x20) {
                                                pcVar29 = (char *)0xffffffe0;
                                            }
                                            uVar2 =
                                                (ushort)pcVar29 &
                                                (ushort)((int)pcVar29 >> 0x1f);
                                        }
                                        *(ushort *)(iVar30 + 0x68) = uVar2;
                                        goto LAB_000565d8;
                                    }
                                }
                                bVar34 = (bVar14 & 1) == 0;
                                if (bVar34) {
                                    pcVar29 = *(char **)(iVar30 + 0xa4);
                                }
                                if (bVar34) {
                                    pcVar29 = pcVar29 + 1;
                                }
                                *(int *)(iVar30 + 0xa0) =
                                    *(int *)(iVar30 + 0xa0) + 1;
                                if (bVar34) {
                                    *(char **)(iVar30 + 0xa4) = pcVar29;
                                }
                                *(byte *)(iVar30 + 0x84) =
                                    *(byte *)(iVar30 + 0x84) & 0xf9 | 1;
                            } else {
                            LAB_000566b0:
                                iVar4 = strcmp("TOFF", pcVar29);
                                if (iVar4 == 0) {
                                    piVar19 = *(int **)(iVar3 + 0x54);
                                    iVar4 = *piVar19;
                                    uVar8 = *(byte *)(iVar4 + 0x84) & 1;
                                    *(byte *)(iVar4 + 0x85) =
                                        *(byte *)(iVar4 + 0x85) | 1;
                                    *(int *)(iVar4 + 0xa4) =
                                        *(int *)(iVar4 + 0xa4) + 1;
                                    if ((*(byte *)(iVar4 + 0x84) & 1) == 0) {
                                        pcVar38 = (char *)0x1;
                                        iVar18 = FUN_00055784(
                                            iVar4 + 0x60, iVar25, "clock_sec",
                                            "clock_nsec", 1);
                                        if (iVar18 != 0) {
                                            pcVar38 = (char *)0x1;
                                            iVar25 = FUN_00055784(
                                                iVar4 + 0x58, iVar25,
                                                "real_sec", "real_nsec", 1);
                                            if (iVar25 != 0) {
                                                if (*(uint *)(iVar4 + 100) <
                                                    *(uint *)(iVar4 + 0x80)) {
                                                    uVar8 = 1;
                                                }
                                                *(uint *)(iVar4 + 100) =
                                                    *(uint *)(iVar4 + 100) -
                                                    *(uint *)(iVar4 + 0x80);
                                                *(uint *)(iVar4 + 0x60) =
                                                    (*(int *)(iVar4 + 0x60) -
                                                     *(int *)(iVar4 + 0x7c)) -
                                                    uVar8;
                                                uVar13 =
                                                    *(undefined4 *)(param_1 +
                                                                    0x4c);
                                                *(undefined4 *)(iVar4 + 0x50) =
                                                    *(undefined4 *)(param_1 +
                                                                    0x48);
                                                *(undefined4 *)(iVar4 + 0x54) =
                                                    uVar13;
                                                *(byte *)(iVar4 + 0x84) =
                                                    *(byte *)(iVar4 + 0x84) | 2;
                                                uVar13 =
                                                    FUN_00079ca0(iVar4 + 0x58);
                                                FUN_00054468(piVar19, uVar13);
                                                goto LAB_000565d8;
                                            }
                                        }
                                    LAB_000565cc:
                                        *(int *)(iVar4 + 0x9c) =
                                            *(int *)(iVar4 + 0x9c) + 1;
                                    }
                                } else {
                                    iVar4 = strcmp("VERSION", pcVar29);
                                    if (iVar4 == 0) {
                                        piVar19 = *(int **)(iVar3 + 0x54);
                                        iVar4 = FUN_00055590(iVar25,
                                                             &DAT_000a7484, 3);
                                        iVar30 = *piVar19;
                                        if (iVar4 == -1) {
                                            local_74 = "(unknown)";
                                        } else {
                                            local_74 =
                                                (char *)(iVar18 +
                                                         *(int *)(iVar20 +
                                                                  iVar4 * 0x14 +
                                                                  0xc4));
                                        }
                                        iVar4 =
                                            FUN_00055590(iVar25, "release", 3);
                                        if (iVar4 == -1) {
                                            local_70 = "(unknown)";
                                        } else {
                                            local_70 =
                                                (char *)(iVar18 +
                                                         *(int *)(iVar20 +
                                                                  iVar4 * 0x14 +
                                                                  0xc4));
                                        }
                                        piVar5 = __errno_location();
                                        *piVar5 = 0;
                                        uVar2 =
                                            FUN_000556c0(iVar25, "proto_major");
                                        uVar8 =
                                            FUN_000556c0(iVar25, "proto_minor");
                                        if (*piVar5 == 0) {
                                            if ((*(byte *)(iVar30 + 0x84) &
                                                 0x20) == 0) {
                                                FUN_00074e00(
                                                    6,
                                                    "%s: GPSD revision=%s "
                                                    "release=%s protocol=%u.%u",
                                                    *(undefined4 *)(iVar30 +
                                                                    0x14),
                                                    local_74, local_70, uVar2,
                                                    uVar8 & 0xffff);
                                                pcVar38 = local_70;
                                            }
                                            puVar23 =
                                                (undefined *)(uVar8 & 0xffff |
                                                              (uint)uVar2
                                                                  << 0x10);
                                            bVar14 = *(byte *)(iVar30 + 0x84);
                                            *(undefined **)(iVar30 + 0x1c) =
                                                puVar23;
                                            if (puVar23 < &UNK_00030009) {
                                                cVar12 = '\0';
                                            } else {
                                                cVar12 = -1;
                                            }
                                            *(byte *)(iVar30 + 0x84) =
                                                bVar14 & 0x7f | 0x20 |
                                                cVar12 << 7;
                                            puVar24 = puVar23;
                                            if (puVar23 < &UNK_0003000a) {
                                                puVar24 = (undefined *)0x0;
                                            }
                                            bVar22 = (byte)puVar24;
                                            if (&UNK_00030009 < puVar23) {
                                                bVar22 = 0xff;
                                            }
                                            *(byte *)(iVar30 + 0x85) =
                                                *(byte *)(iVar30 + 0x85) &
                                                    0xfe |
                                                bVar22 & 1;
                                            if ((bVar14 & 0x40) == 0) {
                                                pcVar29 =
                                                    (char *)(iVar30 + 0x1c1c);
                                                if ((*(byte *)(iVar30 + 0x85) &
                                                     1) == 0) {
                                                    pcVar38 = "";
                                                } else {
                                                    pcVar38 = ",\"pps\":true";
                                                }
                                                FUN_0007c054(
                                                    pcVar29, 0x640,
                                                    "?WATCH={\"device\":\"%s\","
                                                    "\"enable\":true,\"json\":"
                                                    "true%s};\r\n",
                                                    *(undefined4 *)(iVar30 +
                                                                    0x18),
                                                    pcVar38);
                                                __n = strlen(pcVar29);
                                                FUN_000545b0(
                                                    *(undefined4 *)(iVar3 +
                                                                    0x54),
                                                    &DAT_000a71ac, pcVar29,
                                                    __n);
                                                sVar6 = write(piVar19[7],
                                                              pcVar29, __n);
                                                if ((__n != sVar6) &&
                                                    (((*(byte *)(piVar19 +
                                                                 0xc0) &
                                                       4) != 0 ||
                                                      (*(int *)(iVar30 +
                                                                0xb4) == 0 ||
                                                       *(int *)(iVar30 +
                                                                0xb4) ==
                                                           0xe10)))) {
                                                    *(undefined4 *)(iVar30 +
                                                                    0xb4) =
                                                        0xe10;
                                                    FUN_00074e00(
                                                        3,
                                                        "%s: failed to write "
                                                        "watch request (%m)",
                                                        *(undefined4 *)(iVar30 +
                                                                        0x14));
                                                }
                                            }
                                        } else if (((*(byte *)(piVar19 + 0xc0) &
                                                     4) != 0) ||
                                                   (*(int *)(iVar30 + 0xb4) ==
                                                        0 ||
                                                    *(int *)(iVar30 + 0xb4) ==
                                                        0xe10)) {
                                            *(undefined4 *)(iVar30 + 0xb4) =
                                                0xe10;
                                            FUN_00074e00(
                                                6,
                                                "%s: could not evaluate "
                                                "version data",
                                                *(undefined4 *)(iVar30 + 0x14));
                                        }
                                    } else {
                                        iVar4 = strcmp("WATCH", pcVar29);
                                        if (iVar4 != 0)
                                            goto LAB_0005618c;
                                        iVar4 =
                                            FUN_00055590(iVar25, "device", 3);
                                        if ((iVar4 != -1) &&
                                            (pcVar29 =
                                                 (char *)(iVar18 +
                                                          *(int *)(iVar20 +
                                                                   iVar4 *
                                                                       0x14 +
                                                                   0xc4)),
                                             pcVar29 != (char *)0x0)) {
                                            iVar18 = **(int **)(iVar3 + 0x54);
                                            iVar4 = strcmp(
                                                pcVar29,
                                                *(char **)(iVar18 + 0x18));
                                            if (iVar4 == 0) {
                                                iVar4 = FUN_000558b8(iVar25,
                                                                     "enable");
                                                if ((iVar4 < 1) ||
                                                    (iVar4 = FUN_000558b8(
                                                         iVar25, &DAT_000a7564),
                                                     iVar4 < 1)) {
                                                    *(byte *)(iVar18 + 0x84) =
                                                        *(byte *)(iVar18 +
                                                                  0x84) &
                                                        0xbf;
                                                } else {
                                                    *(byte *)(iVar18 + 0x84) =
                                                        *(byte *)(iVar18 +
                                                                  0x84) |
                                                        0x40;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        LAB_000565d8:
                            iVar4 = *(int *)(iVar20 + 8);
                            bVar14 = *(byte *)(iVar20 + 0x84);
                            *(int *)(iVar20 + 0x98) =
                                *(int *)(iVar20 + 0x98) + 1;
                            if ((iVar4 != 0) && ((bVar14 & 8) != 0)) {
                                iVar18 = *(int *)(iVar4 + 0x54);
                                pcVar38 = *(char **)(iVar20 + 0x40);
                                FUN_000543c4(iVar4, iVar18,
                                             *(undefined4 *)(iVar20 + 0x38),
                                             *(undefined4 *)(iVar20 + 0x3c),
                                             pcVar38,
                                             *(undefined4 *)(iVar20 + 0x44));
                                *(char *)(iVar4 + 0x5f) =
                                    (char)*(undefined2 *)(iVar20 + 0x6a);
                                iVar25 = *(int *)(iVar20 + 0x4c);
                                if (7 < iVar25) {
                                    iVar25 = 8;
                                }
                                *(int *)(iVar20 + 0x4c) = iVar25 + 2;
                                if ((iVar25 + 2 == 10) &&
                                    ((*(byte *)(iVar18 + 0x300) & 1) != 0)) {
                                    *(uint *)(iVar4 + 0x44) =
                                        *(uint *)(iVar4 + 0x44) | 0x80;
                                }
                                bVar14 = *(byte *)(iVar20 + 0x84) & 0xf7;
                                *(byte *)(iVar20 + 0x84) = bVar14;
                                *(int *)(iVar20 + 0xb0) =
                                    *(int *)(iVar20 + 0xb0) + 1;
                            }
                            iVar4 = *(int *)(iVar20 + 0x10);
                            if ((bVar14 & 6) == 6) {
                                iVar25 = *(int *)(iVar20 + 0x50) -
                                         *(int *)(iVar20 + 0x20);
                                if (*(uint *)(iVar20 + 0x54) <
                                    *(uint *)(iVar20 + 0x24)) {
                                    iVar25 = iVar25 + -1;
                                }
                                if (iVar25 < 1) {
                                    if (iVar25 != 0) {
                                        *(byte *)(iVar20 + 0x84) =
                                            *(byte *)(iVar20 + 0x84) & 0xfd;
                                        goto LAB_000569c8;
                                    }
                                    if (iVar4 != 1)
                                        goto LAB_00056614;
                                } else {
                                    *(byte *)(iVar20 + 0x84) =
                                        *(byte *)(iVar20 + 0x84) & 0xfb;
                                LAB_000569c8:
                                    bVar14 = *(byte *)(iVar20 + 0x84);
                                    if (iVar4 != 1)
                                        goto LAB_00056614;
                                LAB_00056654:
                                    if ((bVar14 & 6) != 6)
                                        goto LAB_0005618c;
                                }
                                FUN_000543c4(iVar3, piVar17,
                                             *(undefined4 *)(iVar20 + 0x58),
                                             *(undefined4 *)(iVar20 + 0x5c),
                                             *(undefined4 *)(iVar20 + 0x30),
                                             *(undefined4 *)(iVar20 + 0x34));
                                *(char *)(iVar3 + 0x5f) =
                                    (char)*(undefined2 *)(iVar20 + 0x6a);
                                *(byte *)(iVar20 + 0x84) =
                                    *(byte *)(iVar20 + 0x84) & 0xf9;
                                *(int *)(iVar20 + 0xa8) =
                                    *(int *)(iVar20 + 0xa8) + 1;
                            } else {
                                if (iVar4 == 1)
                                    goto LAB_0005618c;
                            LAB_00056614:
                                if (iVar4 == 2) {
                                    if ((bVar14 & 2) == 0)
                                        goto LAB_0005618c;
                                    iVar4 = *(int *)(iVar20 + 0x48);
                                    bVar22 = bVar14 & 0x10;
                                    if ((bVar14 & 4) == 0) {
                                        if (iVar4 < 1) {
                                            iVar4 = 1;
                                        }
                                        *(int *)(iVar20 + 0x48) = iVar4 + -1;
                                        if (iVar4 + -1 == 0) {
                                            if (bVar22 == 0) {
                                                bVar14 =
                                                    *(byte *)(iVar20 + 0x84) |
                                                    0x10;
                                                *(byte *)(iVar20 + 0x84) =
                                                    bVar14;
                                                FUN_00074e00(
                                                    4,
                                                    "%s: use TPV alone from "
                                                    "now",
                                                    *(undefined4 *)(iVar20 +
                                                                    0x14),
                                                    bVar14, pcVar38);
                                                goto LAB_00056938;
                                            }
                                            goto LAB_0005694c;
                                        }
                                    } else {
                                        if (0x38 < iVar4) {
                                            iVar4 = 0x39;
                                        }
                                        *(int *)(iVar20 + 0x48) = iVar4 + 3;
                                        if (iVar4 + 3 == 0x3c) {
                                            if (bVar22 == 0)
                                                goto LAB_00056654;
                                            bVar14 =
                                                *(byte *)(iVar20 + 0x84) & 0xef;
                                            *(byte *)(iVar20 + 0x84) = bVar14;
                                            FUN_00074e00(
                                                6,
                                                "%s: expect valid PPS from now",
                                                *(undefined4 *)(iVar20 + 0x14),
                                                bVar14, pcVar38);
                                        LAB_00056938:
                                            bVar14 = *(byte *)(iVar20 + 0x84);
                                            if ((bVar14 & 0x10) == 0)
                                                goto LAB_00056654;
                                            goto LAB_00056944;
                                        }
                                    }
                                    if (bVar22 == 0)
                                        goto LAB_00056654;
                                } else {
                                LAB_00056944:
                                    if ((bVar14 & 2) == 0)
                                        goto LAB_0005618c;
                                }
                            LAB_0005694c:
                                FUN_000543c4(iVar3, piVar17,
                                             *(undefined4 *)(iVar20 + 0x58),
                                             *(undefined4 *)(iVar20 + 0x5c),
                                             *(undefined4 *)(iVar20 + 0x60),
                                             *(undefined4 *)(iVar20 + 100));
                                *(char *)(iVar3 + 0x5f) =
                                    (char)*(undefined2 *)(iVar20 + 0x68);
                                *(byte *)(iVar20 + 0x84) =
                                    *(byte *)(iVar20 + 0x84) & 0xfd;
                                *(int *)(iVar20 + 0xa8) =
                                    *(int *)(iVar20 + 0xa8) + 1;
                            }
                        LAB_0005618c:
                            if (pbVar31 == pbVar28)
                                break;
                            goto LAB_00056194;
                        }
                    }
                }
            }
            *(int *)(iVar20 + 0x9c) = *(int *)(iVar20 + 0x9c) + 1;
        } while (pbVar31 != pbVar28);
    }
    iVar3 = __stack_chk_guard;
    *(int *)(iVar33 + 0x1c18) = (int)pbVar16 - (int)pbVar21;
    *(undefined4 *)(iVar33 + 0x90) = 10;
    if (local_3c != iVar3) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00057600(int param_1)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    int iVar5;
    int *__s;
    uint local_34;
    undefined1 auStack_30[4];
    int local_2c;
    int local_28;
    int local_24;

    iVar5 = *(int *)(param_1 + 4);
    piVar4 = *(int **)(iVar5 + 0x54);
    local_24 = __stack_chk_guard;
    if (*(int *)(*piVar4 + 0x14) != 0) {
        __s = piVar4 + 0xe;
        *(undefined4 *)(*piVar4 + 0x14) = 0;
        uVar1 = FUN_00049ee4(param_1, __s, 0x80, piVar4 + 0x3a);
        piVar4[0x2e] = uVar1 & 0xffff;
        if ((uVar1 & 0xffff) != 0) {
            iVar2 = sscanf((char *)__s, "%1x%1x%2d%2d%2d%2d%2d%2d", &local_34,
                           auStack_30, piVar4 + 0x31, piVar4 + 0x32,
                           piVar4 + 0x33, &local_2c, &local_28, piVar4 + 0x2f);
            if (((((iVar2 == 8) && ((uint)piVar4[0x31] < 0x18)) &&
                  ((uint)piVar4[0x32] < 0x3c)) &&
                 (((uint)piVar4[0x33] < 0x3d && (local_2c - 1U < 0x1f)))) &&
                ((local_28 - 1U < 0xc && ((uint)piVar4[0x2f] < 100)))) {
                iVar3 = FUN_0007ec68();
                iVar2 = piVar4[0x2f];
                piVar4[0x30] = iVar3;
                *(undefined1 *)(piVar4 + 10) = 0;
                if (iVar2 < 0x62) {
                    iVar2 = iVar2 + 100;
                    piVar4[0x2f] = iVar2;
                }
                piVar4[0x2f] = iVar2 + 0x76c;
                if (((local_34 & 0xc) == 0) ||
                    (((local_34 & 0xc) == 4 &&
                      ((*(byte *)(piVar4 + 0xc0) & 1) == 0)))) {
                    FUN_000494a0(iVar5, 6);
                    *(undefined1 *)(piVar4 + 10) = 3;
                } else {
                    iVar2 = FUN_00049cf8(piVar4);
                    if (iVar2 == 0) {
                        FUN_000494a0(iVar5, 6);
                    } else {
                        piVar4[0x38] = piVar4[0x3a];
                        piVar4[0x39] = piVar4[0x3b];
                        FUN_00049d44(iVar5);
                        FUN_00051f44(iVar5 + 0x10, __s);
                    }
                }
            } else {
                FUN_000494a0(iVar5, 2);
            }
        }
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

undefined4 FUN_00057b98(undefined2 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    undefined2 *puVar3;
    undefined4 *puVar4;

    iVar1 = __stack_chk_guard;
    puVar3 = (undefined2 *)FUN_00073ba4(0, 4, 0, 1);
    fd = open64("/dev/hopf6039", 2);
    puVar4 = *(undefined4 **)(param_2 + 0x54);
    puVar4[7] = 0xffffffff;
    puVar4[5] = param_2;
    puVar4[3] = 0;
    puVar4[6] = 0;
    *puVar4 = puVar3;
    FUN_0006f724(puVar4 + 0x3a);
    puVar4[0xbf] = 0x66706f68;
    *(undefined1 *)(param_2 + 0x5f) = 0xf6;
    puVar4[0xb] = "hopf Elektronik PCI radio board";
    *(undefined1 *)(puVar3 + 1) = 0;
    iVar2 = __stack_chk_guard;
    *puVar3 = param_1;
    if (iVar1 == iVar2) {
        return 1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00057c84(undefined4 param_1, int param_2)

{
    int iVar1;
    ssize_t sVar2;
    int iVar3;
    undefined4 *puVar4;
    bool bVar5;

    iVar1 = __stack_chk_guard;
    puVar4 = *(undefined4 **)(param_2 + 0x54);
    iVar3 = *(int *)*puVar4;
    if (iVar3 == 0) {
        FUN_000494a0(param_2, 1);
    } else {
        *(int *)*puVar4 = iVar3 + -1;
    }
    sVar2 = write(puVar4[7], ":PTIME:TCODE?\r", 0xe);
    if (sVar2 == 0xe) {
        bVar5 = iVar1 == __stack_chk_guard;
        puVar4[0xc2] = puVar4[0xc2] + 1;
        if (bVar5) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_000494a0(param_2, 3);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00058698(int param_1, int param_2)

{
    char cVar1;
    size_t sVar2;
    uint uVar3;
    char *__s;
    undefined4 *puVar4;
    int iVar5;
    char *__s_00;
    int iVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    undefined4 uVar9;
    bool bVar10;
    undefined8 uVar11;
    undefined4 *puVar12;
    int iStack_78;
    int iStack_70;
    int local_5c;
    undefined1 auStack_58[4];
    undefined1 auStack_54[8];
    int local_4c;

    puVar4 = *(undefined4 **)(param_1 + 0x54);
    __s = (char *)*puVar4;
    iVar6 = *(int *)(__s + 0xc98);
    iVar5 = *(int *)(__s + 0xc90);
    local_5c = 0;
    local_4c = __stack_chk_guard;
    *(int *)(__s + 0xc98) = iVar6 >> 1;
    if (param_2 == 1) {
        *(uint *)(__s + 0xc98) = iVar6 >> 1 | 0x200;
    } else if ((param_2 == 2) && (*(int *)(__s + 0xc84) == 2)) {
        bVar10 = iVar5 != 1;
        uVar3 = 2;
        if (bVar10) {
            uVar3 = *(uint *)(__s + 0x300);
        }
        iVar5 = 1;
        if (bVar10) {
            *(uint *)(__s + 0x300) = uVar3 | 8;
        }
        *(undefined4 *)(__s + 0x28) = *(undefined4 *)(__s + 0x38);
        *(undefined4 *)(__s + 0x2c) = *(undefined4 *)(__s + 0x3c);
        __s[0xc84] = '\x02';
        __s[0xc85] = '\0';
        __s[0xc86] = '\0';
        __s[0xc87] = '\0';
        goto LAB_00058768;
    }
    *(int *)(__s + 0xc84) = param_2;
    if (iVar5 % 10 != 0)
        goto LAB_00058768;
    uVar3 = *(uint *)(__s + 0xc98);
    iVar6 = *(int *)(__s + 0xc94);
    if (iVar5 == 10) {
        if (iVar6 < 2)
            goto LAB_00058768;
        uVar3 = (int)uVar3 >> 1;
    LAB_00058734:
        cVar1 = "0123456789abcdef"[(uVar3 << 0x17) >> 0x1c];
        __s[iVar6 + -1] = "0123456789abcdef"[uVar3 & 0xf];
        *(int *)(__s + 0xc94) = iVar6 + -2;
        __s[iVar6 + -2] = cVar1;
    } else if (1 < iVar6)
        goto LAB_00058734;
    if (iVar5 != 0)
        goto LAB_00058768;
    __s[0xc94] = '\x14';
    __s[0xc95] = '\0';
    __s[0xc96] = '\0';
    __s[0xc97] = '\0';
    puVar12 = puVar4 + 0x33;
    iVar5 = sscanf(__s, "%6s%2d%1d%2s%3d%2d%2d%2d", auStack_54, puVar4 + 0x2f,
                   &local_5c, auStack_58, puVar4 + 0x30, puVar4 + 0x31,
                   puVar4 + 0x32, puVar12);
    if (iVar5 == 8) {
        *(undefined1 *)(puVar4 + 10) = 0;
    } else {
        *(undefined1 *)(puVar4 + 10) = 3;
    }
    iStack_78 = puVar4[0x30];
    uVar3 = *(uint *)(__s + 0x300);
    iVar5 = (*(int *)(__s + 0xc88) + *(int *)(__s + 0xc58)) % 0x3c;
    iStack_70 = puVar4[0x2f];
    *(int *)(__s + 0xc88) = iVar5;
    if ((iStack_78 == 0) || ((iStack_70 != 0 && (local_5c == 0)))) {
        iVar6 = puVar4[0x33];
        uVar3 = uVar3 | 0x80;
        *(uint *)(__s + 0x300) = uVar3;
        if (iVar5 != iVar6)
            goto LAB_000588e0;
        *(int *)(__s + 0xc88) = iVar6;
    } else {
        iVar6 = puVar4[0x33];
        if (iVar5 == iVar6) {
            *(int *)(__s + 0xc88) = iVar6;
            if ((uVar3 == 0) && (*(int *)(__s + 0xc6c) == 10)) {
                puVar4[0x38] = puVar4[0x3a];
                puVar4[0x39] = puVar4[0x3b];
                uVar7 = *(undefined4 *)(__s + 0x2c);
                puVar4[0x3a] = *(undefined4 *)(__s + 0x28);
                puVar4[0x3b] = uVar7;
                iVar5 = FUN_00049cf8(puVar4);
                if (iVar5 == 0) {
                    FUN_000494a0(param_1, 6);
                }
                iStack_78 = puVar4[0x30];
                uVar3 = *(uint *)(__s + 0x300);
                iVar6 = puVar4[0x33];
                iStack_70 = puVar4[0x2f];
            }
        } else {
        LAB_000588e0:
            uVar3 = uVar3 | 0x20;
            *(int *)(__s + 0xc88) = iVar6;
            *(uint *)(__s + 0x300) = uVar3;
        }
    }
    uVar11 = *(undefined8 *)(__s + 3000);
    __s_00 = (char *)(puVar4 + 0xe);
    uVar7 = puVar4[0x31];
    uVar9 = puVar4[0x32];
    uVar8 = *(undefined4 *)(__s + 0xb14);
    FUN_00073804(puVar4[0x3a], puVar4[0x3b], 0, 6, 0);
    FUN_0007c054(
        __s_00, 0x80,
        "%02x %02d %03d %02d:%02d:%02d %4.0f %3d %6.3f %2d %6.2f %6.1f %s",
        uVar3, iStack_70, iStack_78, uVar7, uVar9, iVar6, puVar12, uVar11,
        uVar8);
    sVar2 = strlen(__s_00);
    puVar4[0x2e] = sVar2;
    __s[0x300] = '\0';
    __s[0x301] = '\0';
    __s[0x302] = '\0';
    __s[0x303] = '\0';
    if ((*(byte *)(puVar4 + 0xc0) & 8) != 0) {
        FUN_00051f44(param_1 + 0x10, __s_00);
    }
    iVar5 = *(int *)(__s + 0xc90);
LAB_00058768:
    bVar10 = local_4c == __stack_chk_guard;
    *(int *)(__s + 0xc90) = (iVar5 + 1) % 100;
    if (bVar10) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000587f4(undefined4 param_1, int param_2, undefined4 param_3,
                  int param_4)

{
    char cVar1;
    size_t sVar2;
    undefined4 uVar3;
    uint uVar4;
    int iVar5;
    int iVar6;
    char *unaff_r4;
    int unaff_r5;
    int *unaff_r6;
    int unaff_r7;
    int unaff_r8;
    char *__s;
    uint in_r12;
    int iVar7;
    int in_stack_0000006c;
    int in_stack_0000007c;

    *(uint *)(unaff_r4 + 0xc98) = in_r12 | 0x200;
    *(undefined4 *)(unaff_r4 + 0xc84) = param_3;
    if (unaff_r8 + ((param_2 >> 2) - param_4) * -10 != 0)
        goto LAB_00058768;
    uVar4 = *(uint *)(unaff_r4 + 0xc98);
    iVar5 = *(int *)(unaff_r4 + 0xc94);
    if (unaff_r8 == 10) {
        if (iVar5 < 2)
            goto LAB_00058768;
        uVar4 = (int)uVar4 >> 1;
    LAB_00058734:
        cVar1 = "0123456789abcdef"[(uVar4 << 0x17) >> 0x1c];
        unaff_r4[iVar5 + -1] = "0123456789abcdef"[uVar4 & 0xf];
        *(int *)(unaff_r4 + 0xc94) = iVar5 + -2;
        unaff_r4[iVar5 + -2] = cVar1;
    } else if (1 < iVar5)
        goto LAB_00058734;
    if (unaff_r8 != 0)
        goto LAB_00058768;
    unaff_r4[0xc94] = '\x14';
    unaff_r4[0xc95] = '\0';
    unaff_r4[0xc96] = '\0';
    unaff_r4[0xc97] = '\0';
    iVar5 = sscanf(unaff_r4, "%6s%2d%1d%2s%3d%2d%2d%2d", &stack0x00000074,
                   unaff_r5 + 0xbc);
    if (iVar5 == 8) {
        *(undefined1 *)(unaff_r5 + 0x28) = 0;
    } else {
        *(undefined1 *)(unaff_r5 + 0x28) = 3;
    }
    iVar7 = *(int *)(unaff_r5 + 0xc0);
    uVar4 = *(uint *)(unaff_r4 + 0x300);
    iVar6 = (*(int *)(unaff_r4 + 0xc88) + *(int *)(unaff_r4 + 0xc58)) % 0x3c;
    iVar5 = *(int *)(unaff_r5 + 0xbc);
    *(int *)(unaff_r4 + 0xc88) = iVar6;
    if ((iVar7 == 0) || ((iVar5 != 0 && (in_stack_0000006c == 0)))) {
        iVar5 = *(int *)(unaff_r5 + 0xcc);
        uVar4 = uVar4 | 0x80;
        *(uint *)(unaff_r4 + 0x300) = uVar4;
        if (iVar6 != iVar5)
            goto LAB_000588e0;
        *(int *)(unaff_r4 + 0xc88) = iVar5;
    } else {
        iVar5 = *(int *)(unaff_r5 + 0xcc);
        if (iVar6 == iVar5) {
            *(int *)(unaff_r4 + 0xc88) = iVar5;
            if ((uVar4 == 0) && (*(int *)(unaff_r4 + 0xc6c) == 10)) {
                *(undefined4 *)(unaff_r5 + 0xe0) =
                    *(undefined4 *)(unaff_r5 + 0xe8);
                *(undefined4 *)(unaff_r5 + 0xe4) =
                    *(undefined4 *)(unaff_r5 + 0xec);
                uVar3 = *(undefined4 *)(unaff_r4 + 0x2c);
                *(undefined4 *)(unaff_r5 + 0xe8) =
                    *(undefined4 *)(unaff_r4 + 0x28);
                *(undefined4 *)(unaff_r5 + 0xec) = uVar3;
                iVar5 = FUN_00049cf8();
                if (iVar5 == 0) {
                    FUN_000494a0();
                }
                uVar4 = *(uint *)(unaff_r4 + 0x300);
            }
        } else {
        LAB_000588e0:
            uVar4 = uVar4 | 0x20;
            *(int *)(unaff_r4 + 0xc88) = iVar5;
            *(uint *)(unaff_r4 + 0x300) = uVar4;
        }
    }
    __s = (char *)(unaff_r5 + 0x38);
    FUN_00073804(*(undefined4 *)(unaff_r5 + 0xe8),
                 *(undefined4 *)(unaff_r5 + 0xec), 0, 6);
    FUN_0007c054(
        __s, 0x80,
        "%02x %02d %03d %02d:%02d:%02d %4.0f %3d %6.3f %2d %6.2f %6.1f %s",
        uVar4);
    sVar2 = strlen(__s);
    *(size_t *)(unaff_r5 + 0xb8) = sVar2;
    unaff_r4[0x300] = '\0';
    unaff_r4[0x301] = '\0';
    unaff_r4[0x302] = '\0';
    unaff_r4[0x303] = '\0';
    if ((*(byte *)(unaff_r5 + 0x300) & 8) != 0) {
        FUN_00051f44(unaff_r7 + 0x10, __s);
    }
    unaff_r8 = *(int *)(unaff_r4 + 0xc90);
LAB_00058768:
    iVar5 = *unaff_r6;
    *(int *)(unaff_r4 + 0xc90) = (unaff_r8 + 1) % 100;
    if (in_stack_0000007c == iVar5) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000592d0(int param_1)

{
    byte bVar1;
    int iVar2;
    uint uVar3;
    int extraout_r1;
    int iVar4;
    int iVar5;
    uint uVar6;
    uint uVar7;
    int iVar8;
    int iVar9;
    int iVar10;
    bool bVar11;
    double in_d0;
    double dVar12;
    double dVar13;
    double dVar14;
    double dVar15;
    double dVar16;
    double dVar17;
    double dVar18;
    double dVar19;
    double dVar20;
    double dVar21;
    undefined8 uVar22;

    iVar8 = **(int **)(param_1 + 0x54);
    dVar17 = *(double *)(iVar8 + 0xb58);
    *(double *)(iVar8 + 0xb60) = dVar17;
    dVar16 = *(double *)(iVar8 + 0xb50);
    *(double *)(iVar8 + 0xb58) = dVar16;
    dVar15 = *(double *)(iVar8 + 0xb48);
    *(double *)(iVar8 + 0xb50) = dVar15;
    dVar14 = *(double *)(iVar8 + 0xb40);
    *(double *)(iVar8 + 0xb48) = dVar14;
    dVar13 = *(double *)(iVar8 + 0xb38);
    *(double *)(iVar8 + 0xb40) = dVar13;
    dVar12 = *(double *)(iVar8 + 0xb30);
    *(double *)(iVar8 + 0xb38) = dVar12;
    dVar20 = *(double *)(iVar8 + 0xb28);
    *(double *)(iVar8 + 0xb30) = dVar20;
    dVar21 = *(double *)(iVar8 + 0xb20);
    *(double *)(iVar8 + 0xb28) = dVar21;
    iVar2 = __stack_chk_guard;
    dVar18 =
        in_d0 - (dVar16 * -3.87518 + dVar17 * 0.6505491 + dVar15 * 11.5118 +
                 dVar14 * -21.41264 + dVar13 * 27.12837 + dVar12 * -23.84486 +
                 dVar20 * 14.27663 + dVar21 * -5.352734);
    *(double *)(iVar8 + 0xb20) = dVar18;
    dVar19 = *(double *)(iVar8 + 0xb80);
    dVar12 = dVar21 * -0.02055878 + dVar18 * 0.004952157 + dVar20 * 0.04401413 +
             dVar12 * -0.06558851 + dVar13 * 0.07462108 + dVar14 * -0.06558851 +
             dVar15 * 0.04401413 + dVar16 * -0.02055878 + dVar17 * 0.004952157;
    *(double *)(iVar8 + 0x2f0) = *(double *)(iVar8 + 0x2f0) + dVar12 * dVar12;
    *(double *)(iVar8 + 0xb88) = dVar19;
    dVar16 = *(double *)(iVar8 + 0xb78);
    *(double *)(iVar8 + 0xb80) = dVar16;
    dVar15 = *(double *)(iVar8 + 0xb70);
    *(double *)(iVar8 + 0xb78) = dVar15;
    dVar14 = *(double *)(iVar8 + 0xb68);
    iVar9 = *(int *)(iVar8 + 0xc58);
    *(double *)(iVar8 + 0xb70) = dVar14;
    dVar13 = in_d0 - (dVar16 * -3.589893 + dVar19 * 0.8694604 +
                      dVar15 * 5.570154 + dVar14 * -3.849667);
    *(double *)(iVar8 + 0xb68) = dVar13;
    dVar13 = dVar14 * -0.01174951 + dVar13 * 0.003215696 + dVar15 * 0.01712074 +
             dVar16 * -0.01174951 + dVar19 * 0.003215696;
    *(double *)(iVar8 + 0x2f8) = *(double *)(iVar8 + 0x2f8) + dVar13 * dVar13;
    FUN_0009bb9c(*(int *)(iVar8 + 0xc74) + 1, iVar9);
    *(int *)(iVar8 + 0xc74) = extraout_r1;
    iVar8 = __stack_chk_guard;
    if (extraout_r1 != 0) {
        if (iVar2 == __stack_chk_guard) {
            return;
        }
    LAB_000594d8:
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    if (iVar9 != 1) {
        dVar12 = dVar13;
    }
    if (iVar2 != __stack_chk_guard)
        goto LAB_000594d8;
    iVar9 = **(int **)(param_1 + 0x54);
    iVar10 = *(int *)(iVar9 + 0xc6c);
    uVar7 = (*(int *)(iVar9 + 0xc5c) + 1) % 0x50;
    iVar2 = iVar9 + uVar7 * 8;
    *(uint *)(iVar9 + 0xc5c) = uVar7;
    dVar13 = *(double *)(iVar2 + 0x40);
    uVar3 = uVar7 & 7;
    if ((int)uVar7 < 1) {
        uVar3 = -(-uVar7 & 7);
    }
    iVar4 = iVar9 + uVar3 * 8;
    iVar5 = iVar4 + 0xc10;
    dVar13 = (dVar12 - dVar13) / (double)(longlong)(iVar10 * 5) + dVar13;
    *(double *)(iVar2 + 0x40) = dVar13;
    *(double *)(iVar4 + 0xbc8) = dVar12;
    *(double *)(iVar4 + 0xc08) = dVar13;
    dVar12 = *(double *)(iVar9 + 0xc48);
    if (0.0 < dVar12) {
        if (dVar13 <= 0.0) {
            iVar5 = uVar3 - 4;
        }
        if (dVar13 <= 0.0) {
            dVar12 = (double)FixedToFP(
                CONCAT44((int)((ulonglong)dVar12 >> 0x20), iVar5), 0x20, 0x40,
                3, 0, 0);
            dVar12 = *(double *)(iVar9 + 0x2d0) + dVar12;
        }
        if (dVar13 <= 0.0) {
            *(double *)(iVar9 + 0x2d0) = dVar12;
        }
    }
    *(double *)(iVar9 + 0xc48) = dVar13;
    if (uVar7 == 0) {
        dVar12 = *(double *)(iVar9 + 0xbb0);
        dVar13 = *(double *)(iVar9 + 0xba8);
        *(double *)(iVar9 + 3000) = dVar12;
        *(double *)(iVar9 + 0xbc0) = dVar13;
        uVar3 = *(uint *)(iVar9 + 0x300);
        if (dVar12 < 100.0) {
            uVar3 = uVar3 | 1;
        }
        *(undefined4 *)(iVar9 + 0xbb0) = 0;
        *(undefined4 *)(iVar9 + 0xbb4) = 0xc12e8480;
        *(undefined4 *)(iVar9 + 0xba8) = 0;
        *(undefined4 *)(iVar9 + 0xbac) = 0x412e8480;
        if (dVar12 < 100.0) {
            *(uint *)(iVar9 + 0x300) = uVar3;
        }
        if (dVar12 <= 0.0) {
            *(undefined4 *)(iVar9 + 0x2e8) = 0;
            *(undefined4 *)(iVar9 + 0x2ec) = 0;
        LAB_00059040:
            uVar3 = uVar3 | 4;
            *(uint *)(iVar9 + 0x300) = uVar3;
        } else {
            dVar12 = (dVar12 - dVar13) / dVar12;
            *(double *)(iVar9 + 0x2e8) = dVar12;
            if (dVar12 < 0.5)
                goto LAB_00059040;
        }
        if ((uVar3 & 0xf) == 0) {
            dVar13 = (double)(longlong) * (int *)(iVar9 + 0xc6c);
            dVar12 = dVar13 * 4.0 * dVar13;
        } else {
            dVar12 = 16.0;
            dVar13 = 2.0;
            *(undefined4 *)(iVar9 + 0xc6c) = 2;
            *(undefined4 *)(iVar9 + 0xc70) = 0;
        }
        dVar14 = *(double *)(iVar9 + 0x2d0);
        *(undefined4 *)(iVar9 + 0x2d0) = 0;
        *(undefined4 *)(iVar9 + 0x2d4) = 0;
        dVar14 = ((double)(longlong) * (int *)(iVar9 + 0xc58) * dVar14) / 80.0;
        *(double *)(iVar9 + 0x2d8) = dVar14;
        dVar12 = dVar14 / dVar12 + *(double *)(iVar9 + 0x2c8);
        *(double *)(iVar9 + 0x2c0) =
            *(double *)(iVar9 + 0x2c0) + dVar14 / dVar13;
        if (dVar12 <= 2.0) {
            if (dVar12 < -2.0) {
                uVar3 = uVar3 | 2;
            } else {
                *(double *)(iVar9 + 0x2c8) = dVar12;
            }
            if (dVar12 < -2.0) {
                *(undefined8 *)(iVar9 + 0x2c8) = 0xc000000000000000;
                *(uint *)(iVar9 + 0x300) = uVar3;
            }
        } else {
            *(undefined8 *)(iVar9 + 0x2c8) = 0x4000000000000000;
            *(uint *)(iVar9 + 0x300) = uVar3 | 2;
        }
        goto switchD_00058fcc_default;
    }
    if (uVar3 != 7)
        goto switchD_00058fcc_default;
    dVar12 = (*(double *)(iVar9 + 0xc18) - *(double *)(iVar9 + 0xc38)) * 0.5;
    uVar3 = *(int *)(iVar9 + 0xc7c) << 1;
    if (*(double *)(iVar9 + 0xbb0) < dVar12) {
        *(double *)(iVar9 + 0xbb0) = dVar12;
    }
    if (dVar12 < *(double *)(iVar9 + 0xba8)) {
        *(double *)(iVar9 + 0xba8) = dVar12;
    }
    *(uint *)(iVar9 + 0xc7c) = uVar3;
    uVar6 = (*(int *)(iVar9 + 0xc78) + 1) % 10;
    dVar13 = (*(double *)(iVar9 + 3000) + *(double *)(iVar9 + 0xbc0)) * 0.5;
    *(uint *)(iVar9 + 0xc78) = uVar6;
    if (dVar13 <= dVar12) {
        uVar3 = uVar3 | 1;
    }
    if (dVar13 <= dVar12) {
        *(uint *)(iVar9 + 0xc7c) = uVar3;
    }
    if ((uVar3 & 0x303c0f03) == 0x300c0300) {
        bVar11 = uVar6 != 0;
        if (bVar11) {
            uVar6 = *(uint *)(iVar9 + 0x300);
        }
        if (bVar11) {
            uVar6 = uVar6 | 8;
        }
        if (bVar11) {
            *(uint *)(iVar9 + 0x300) = uVar6;
        }
        uVar6 = 0;
        *(undefined4 *)(iVar9 + 0xc78) = 0;
        uVar3 = *(int *)(iVar9 + 0xc80) << 1;
        *(uint *)(iVar9 + 0xc80) = uVar3;
        dVar12 =
            (*(double *)(iVar9 + 0xbd8) - *(double *)(iVar9 + 0xbf8)) * 0.5;
        if (*(double *)(iVar9 + 0xba0) <= dVar12)
            goto LAB_00058fc0;
    LAB_000590dc:
        iVar2 = *(int *)(iVar9 + 0xc68) - uVar7;
        dVar13 = -*(double *)(iVar9 + 0x2d8);
        *(double *)(iVar9 + 0x2e0) = dVar13;
        if (iVar2 + 1U < 3) {
            iVar4 = *(int *)(iVar9 + 0xc70) + 1;
            *(int *)(iVar9 + 0xc70) = iVar4;
            if (iVar4 != iVar10 * 0x14 &&
                iVar4 + iVar10 * -0x14 < 0 == SBORROW4(iVar4, iVar10 * 0x14)) {
                iVar4 = iVar10 + 1;
                if (10 < iVar4) {
                    iVar2 = 10;
                }
                if (iVar4 == 10 || iVar10 + -9 < 0 != SBORROW4(iVar4, 10)) {
                    *(int *)(iVar9 + 0xc6c) = iVar4;
                } else {
                    *(int *)(iVar9 + 0xc6c) = iVar2;
                }
                goto LAB_00059128;
            }
            dVar13 = dVar13 - (double)(longlong)iVar2;
            *(double *)(iVar9 + 0x2e0) = dVar13;
        } else {
        LAB_00059128:
            *(uint *)(iVar9 + 0xc68) = uVar7;
            *(undefined4 *)(iVar9 + 0xc70) = 0;
        }
        *(undefined4 *)(iVar9 + 0x38) = *(undefined4 *)(iVar9 + 0x30);
        *(undefined4 *)(iVar9 + 0x3c) = *(undefined4 *)(iVar9 + 0x34);
        dVar13 = *(double *)(iVar9 + 0xc50) + (double)(longlong) *
                                                  (int *)(iVar9 + 0xc58) *
                                                  (dVar13 / 8000.0);
        if (dVar13 < 0.0) {
            dVar13 = ldexp(-dVar13, 0x20);
            uVar22 = FUN_0009c010(SUB84(dVar13, 0),
                                  (int)((ulonglong)dVar13 >> 0x20));
            uVar22 = CONCAT44(
                -((int)((ulonglong)uVar22 >> 0x20) + (uint)((int)uVar22 != 0)),
                -(int)uVar22);
        } else {
            dVar13 = ldexp(dVar13, 0x20);
            uVar22 = FUN_0009c010(SUB84(dVar13, 0),
                                  (int)((ulonglong)dVar13 >> 0x20));
        }
        bVar1 = *(byte *)(iVar9 + 0xc80);
        *(undefined4 *)(iVar9 + 0x30) = *(undefined4 *)(iVar9 + 0x18);
        *(undefined4 *)(iVar9 + 0x34) = *(undefined4 *)(iVar9 + 0x1c);
        iVar2 = *(int *)(iVar9 + 0x30) - (int)((ulonglong)uVar22 >> 0x20);
        if (*(uint *)(iVar9 + 0x34) < (uint)uVar22) {
            iVar2 = iVar2 + -1;
        }
        *(int *)(iVar9 + 0x30) = iVar2;
        *(uint *)(iVar9 + 0x34) = *(uint *)(iVar9 + 0x34) - (uint)uVar22;
        if (bVar1 == 0xe0) {
        LAB_000592a4:
            FUN_00058698(param_1, 1);
        } else if (bVar1 < 0xe1) {
            if (bVar1 != 0x80) {
                if (bVar1 == 0xc0)
                    goto LAB_000592a4;
                if (bVar1 != 0)
                    goto LAB_000591d8;
            }
            FUN_00058698(param_1, 0);
        } else if (bVar1 == 0xf8) {
        LAB_00059278:
            FUN_00058698(param_1, 2);
        } else {
            if (bVar1 < 0xf9) {
                if (bVar1 == 0xf0)
                    goto LAB_000592a4;
            } else if ((bVar1 == 0xfc) || (bVar1 == 0xfe))
                goto LAB_00059278;
        LAB_000591d8:
            FUN_00058698(param_1, 0);
            *(uint *)(iVar9 + 0x300) = *(uint *)(iVar9 + 0x300) | 0x10;
        }
        dVar13 = *(double *)(iVar9 + 0xb90);
        if (dVar13 <= dVar12) {
            dVar12 = dVar13;
        }
        *(double *)(iVar9 + 0xba0) =
            (dVar12 + *(double *)(iVar9 + 0xb98)) * 0.5;
        *(undefined4 *)(iVar9 + 0xb90) = 0;
        *(undefined4 *)(iVar9 + 0xb94) = 0x412e8480;
        *(undefined4 *)(iVar9 + 0xb98) = 0;
        *(undefined4 *)(iVar9 + 0xb9c) = 0xc12e8480;
        goto switchD_00058fcc_default;
    }
    uVar3 = *(int *)(iVar9 + 0xc80) << 1;
    dVar12 = (*(double *)(iVar9 + 0xbd8) - *(double *)(iVar9 + 0xbf8)) * 0.5;
    *(uint *)(iVar9 + 0xc80) = uVar3;
    if (*(double *)(iVar9 + 0xba0) <= dVar12) {
    LAB_00058fc0:
        *(uint *)(iVar9 + 0xc80) = uVar3 | 1;
    }
    switch (uVar6) {
    case 0:
        goto LAB_000590dc;
    case 1:
        goto LAB_0005905c;
    case 2:
        if (dVar12 <= *(double *)(iVar9 + 0xb98))
            break;
    LAB_0005905c:
        *(double *)(iVar9 + 0xb98) = dVar12;
        break;
    case 3:
        break;
    case 4:
        break;
    case 5:
        break;
    case 6:
        break;
    case 7:
        break;
    case 8:
        break;
    case 9:
        *(double *)(iVar9 + 0xb90) = dVar12;
    }
switchD_00058fcc_default:
    if (iVar8 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000598e8(undefined4 param_1, undefined4 param_2, int param_3)

{
    short sVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    short *psVar5;

    iVar3 = __stack_chk_guard;
    psVar5 = (short *)(param_3 + 500);
    iVar4 = (*(code *)(&PTR_LAB_000c46e4)[*(short *)(param_3 + 0x1f6) * 5 +
                                          (int)*psVar5])();
    if (iVar4 == 1) {
        *(undefined2 *)(param_3 + 0x1f0) = 0;
        iVar4 = (*(short *)(param_3 + 0x1f6) * 5 + (int)*psVar5) * 2;
        sVar1 = *(short *)(&DAT_000a795c + iVar4);
        sVar2 = *(short *)(&DAT_000a79cc + iVar4);
        if ((int)*psVar5 != (int)sVar2) {
            *(undefined1 *)(param_3 + 0xf) = 0;
            *(undefined2 *)(param_3 + 0x1f2) = 0;
            *(undefined2 *)(param_3 + 0x1f8) = 0;
            *(undefined4 *)(param_3 + 0x38) = 0;
            *(undefined4 *)(param_3 + 0x1e8) = 0;
            *(undefined1 *)(param_3 + 0x1ec) = 0;
            *(undefined2 *)(param_3 + 0x196) = 0;
            if (sVar2 == 0) {
                *(undefined2 *)(param_3 + 0xc) = 3;
            }
        }
        *psVar5 = sVar2;
        if (sVar1 != 0) {
            *(short *)(param_3 + 0x1f6) = sVar1;
            FUN_000598e8(param_1, param_2, param_3);
        }
    }
    iVar4 = __stack_chk_guard;
    *(undefined2 *)(param_3 + 0x1f6) = 0;
    if (iVar3 != iVar4) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00059b10(undefined4 param_1, undefined4 param_2, int param_3)

{
    short sVar1;
    short sVar2;
    int iVar3;
    int iVar4;
    short *psVar5;

    iVar3 = __stack_chk_guard;
    psVar5 = (short *)(param_3 + 0x200);
    iVar4 = (*(code *)(&PTR_LAB_000c47c0)[*(short *)(param_3 + 0x202) * 5 +
                                          (int)*psVar5])();
    if (iVar4 == 1) {
        iVar4 = (*(short *)(param_3 + 0x202) * 5 + (int)*psVar5) * 2;
        sVar1 = *(short *)(&DAT_000a7adc + iVar4);
        sVar2 = *(short *)(&DAT_000a7a3c + iVar4);
        if ((int)*psVar5 != (int)sVar1) {
            *(undefined2 *)(param_3 + 0x1fa) = 0;
            *(undefined2 *)(param_3 + 0x1fe) = 0;
            *(undefined2 *)(param_3 + 0x204) = 0;
        }
        *psVar5 = sVar1;
        if (sVar2 != 0) {
            *(short *)(param_3 + 0x202) = sVar2;
            FUN_00059b10(param_1, param_2, param_3);
        }
    }
    iVar4 = __stack_chk_guard;
    *(undefined2 *)(param_3 + 0x202) = 0;
    if (iVar3 == iVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00059de0(undefined4 param_1, int param_2)

{
    short sVar1;
    int iVar2;
    int iVar3;
    short sVar4;
    char *pcVar5;
    undefined4 *puVar6;
    int iVar7;
    int iVar8;
    int *piVar9;

    iVar2 = __stack_chk_guard;
    puVar6 = *(undefined4 **)(param_2 + 0x54);
    pcVar5 = (char *)*puVar6;
    if ((pcVar5[0xe] == '\0') && (*pcVar5 == 'd')) {
        iVar3 = *(short *)(pcVar5 + 500) * 2;
        sVar1 = *(short *)(&DAT_000a7b7c + iVar3);
        if ((sVar1 != 0) &&
            (sVar4 = *(short *)(pcVar5 + 0x1f0) + 1,
             *(short *)(pcVar5 + 0x1f0) = sVar4, sVar1 <= sVar4)) {
            pcVar5[0x1f6] = '\t';
            pcVar5[0x1f7] = '\0';
            FUN_000598e8(param_2, puVar6, pcVar5);
            iVar3 = (int)*(short *)(pcVar5 + 500) << 1;
        }
        sVar1 = *(short *)(&DAT_000a7b88 + iVar3);
        if ((sVar1 != 0) && (sVar4 = *(short *)(pcVar5 + 0x1f2),
                             *(short *)(pcVar5 + 0x1f2) = sVar4 + 1,
                             sVar1 <= (short)(sVar4 + 1))) {
            pcVar5[0x1f6] = '\n';
            pcVar5[0x1f7] = '\0';
            FUN_000598e8(param_2, puVar6, pcVar5);
        }
        iVar8 = (int)*(short *)(pcVar5 + 0x200);
        iVar3 = iVar8 * 2;
        if ((*(short *)(&DAT_000a7b94 + iVar3) != 0) ||
            (*(short *)(&DAT_000a7ba0 + iVar3) != 0)) {
            piVar9 = *(int **)(param_2 + 0x54);
            iVar7 = *piVar9;
            iVar3 = *(short *)(iVar7 + 0x200) * 2;
            sVar1 = *(short *)(&DAT_000a7b94 + iVar3);
            if ((sVar1 != 0) &&
                (sVar4 = *(short *)(iVar7 + 0x1fc) + 1,
                 *(short *)(iVar7 + 0x1fc) = sVar4, sVar1 <= sVar4)) {
                *(undefined2 *)(iVar7 + 0x202) = 0xe;
                FUN_00059b10(param_2, piVar9, iVar7);
                iVar3 = (int)*(short *)(iVar7 + 0x200) << 1;
            }
            sVar1 = *(short *)(&DAT_000a7ba0 + iVar3);
            if ((sVar1 != 0) &&
                (sVar4 = *(short *)(iVar7 + 0x1fe) + 1,
                 *(short *)(iVar7 + 0x1fe) = sVar4, sVar1 <= sVar4)) {
                *(undefined2 *)(iVar7 + 0x202) = 0xf;
                FUN_00059b10(param_2, piVar9, iVar7);
            }
            iVar3 = __stack_chk_guard;
            iVar7 = (int)*(short *)(pcVar5 + 0x200);
            if (iVar8 != iVar7) {
                if (iVar7 == 0) {
                    pcVar5[0x1f6] = '\x03';
                    pcVar5[0x1f7] = '\0';
                } else {
                    if (iVar7 != 3)
                        goto LAB_00059e20;
                    pcVar5[0x1f6] = '\x02';
                    pcVar5[0x1f7] = '\0';
                }
                if (iVar2 == iVar3) {
                    FUN_000598e8(param_2, puVar6, pcVar5);
                    return;
                }
                goto LAB_0005a064;
            }
        }
    }
LAB_00059e20:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
LAB_0005a064:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005a084(int param_1, undefined4 param_2, byte *param_3)

{
    size_t sVar1;
    ushort **ppuVar2;
    size_t sVar3;
    uint uVar4;
    uint uVar5;
    undefined4 *puVar6;
    byte *pbVar7;
    byte *pbVar8;
    char *__s;
    undefined4 auStack_114[33];
    undefined4 local_90;
    byte local_8c[95];
    byte local_2d;
    int local_2c;

    local_2c = __stack_chk_guard;
    switch (param_2) {
    case 2:
        puVar6 = (undefined4 *)&UNK_000a7bd4;
        break;
    case 3:
        puVar6 = (undefined4 *)&UNK_000a7bdc;
        break;
    case 4:
        puVar6 = (undefined4 *)&UNK_000a7be4;
        break;
    case 5:
        puVar6 = (undefined4 *)&UNK_000a7bec;
        break;
    case 6:
        puVar6 = (undefined4 *)&UNK_000a7bf4;
        break;
    case 7:
        puVar6 = (undefined4 *)&UNK_000a7bfc;
        break;
    case 8:
        puVar6 = (undefined4 *)&UNK_000a7c04;
        break;
    default:
        puVar6 = &DAT_000a7bcc;
    }
    sVar1 = strlen((char *)param_3);
    local_90 = *puVar6;
    local_8c[0] = (byte)puVar6[1];
    memcpy(auStack_114, &PTR_s_<NUL> _000c6ed0, 0x84);
    if (sVar1 == 0) {
        pbVar7 = local_8c;
    } else {
        ppuVar2 = __ctype_b_loc();
        uVar5 = 0;
        pbVar7 = param_3;
        do {
            pbVar8 = pbVar7 + 1;
            uVar4 = (uint)*pbVar7;
            if (((*ppuVar2)[uVar4] & 0x4000) == 0) {
                if (uVar4 < 0x21) {
                    __s = (char *)auStack_114[uVar4];
                    sVar3 = strlen(__s);
                    if (0x5f < uVar5 + 1 + sVar3) {
                    LAB_0005a28c:
                        pbVar7 = local_8c + uVar5;
                        goto LAB_0005a250;
                    }
                    uVar4 = uVar5 + sVar3;
                    FUN_0007d4dc(local_8c + uVar5, __s, 0x60 - uVar5);
                } else {
                    if (0x5f < uVar5 + 6)
                        goto LAB_0005a28c;
                    uVar4 = uVar5 + 5;
                    FUN_0007c054(local_8c + uVar5, 0x60 - uVar5, "<x%X>");
                }
            } else {
                uVar4 = uVar5 + 1;
                if (uVar4 == 0x60) {
                    pbVar7 = &local_2d;
                    goto LAB_0005a250;
                }
                local_8c[uVar5] = *pbVar7;
            }
            uVar5 = uVar4;
            pbVar7 = pbVar8;
        } while (uVar4 < 0x60 && (uint)((int)pbVar8 - (int)param_3) < sVar1);
        if (uVar4 < 0x60) {
            pbVar7 = local_8c + uVar4;
        } else {
            pbVar7 = &local_2d;
        }
    }
LAB_0005a250:
    *pbVar7 = 0;
    FUN_00051f44(param_1 + 0x10, &local_90);
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005a2e0(undefined4 param_1, int param_2)

{
    int iVar1;
    ssize_t sVar2;

    iVar1 = __stack_chk_guard;
    sVar2 = write(*(int *)(param_2 + 0x1c), "ATH0\r\n", 6);
    if (sVar2 != 6) {
        FUN_000494a0(param_1, 3);
    }
    FUN_0005a084(param_1, 2, "ATH0\r\n");
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(1);
}

void FUN_0005a3bc(undefined4 param_1, int param_2)

{
    int iVar1;
    ssize_t sVar2;

    iVar1 = __stack_chk_guard;
    sVar2 = write(*(int *)(param_2 + 0x1c), &DAT_000a7c1c, 3);
    if (sVar2 != 3) {
        FUN_000494a0(param_1, 3);
    }
    FUN_0005a084(param_1, 2, &DAT_000a7c1c);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(0);
}

void FUN_0005a9a4(undefined4 param_1, int param_2)

{
    undefined4 uVar1;
    int iVar2;
    undefined *puVar3;
    undefined1 auStack_58[60];
    int local_1c;

    local_1c = __stack_chk_guard;
    gettimeofday(
        (timeval *)(param_2 + (*(short *)(param_2 + 0x196) + 0x38) * 8),
        (__timezone_ptr_t)0x0);
    param_2 = param_2 + *(short *)(param_2 + 0x196) * 8;
    puVar3 =
        (undefined *)(*(int *)(param_2 + 0x1c4) - *(int *)(param_2 + 0x19c));
    *(undefined **)(param_2 + 0x1c4) = puVar3;
    iVar2 = *(int *)(param_2 + 0x1c0) - *(int *)(param_2 + 0x198);
    *(int *)(param_2 + 0x1c0) = iVar2;
    if ((int)puVar3 < 0) {
        iVar2 = iVar2 + -1;
        puVar3 = &DAT_000f4240 + (int)puVar3;
        *(undefined **)(param_2 + 0x1c4) = puVar3;
        *(int *)(param_2 + 0x1c0) = iVar2;
    }
    iVar2 = iVar2 * 1000 + (int)puVar3 / 1000;
    FUN_0007c054(auStack_58, 0x3c, "* Loopback delay : %d.%03d mSec.", iVar2,
                 (int)puVar3 % 1000);
    if (iVar2 < 0x2bd) {
        uVar1 = 4;
    } else {
        uVar1 = 6;
    }
    FUN_0005a084(param_1, uVar1, auStack_58);
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005aab4(int param_1, int param_2, int param_3)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;
    undefined4 uVar6;
    int iVar7;
    undefined4 uVar8;
    undefined4 uVar9;
    char *pcVar10;
    undefined4 uVar11;
    undefined1 auStack_74[80];
    int local_24;

    uVar2 = *(undefined4 *)(param_3 + 0x18);
    uVar4 = *(undefined4 *)(param_3 + 0x20);
    *(undefined4 *)(param_2 + 0xbc) = uVar2;
    local_24 = __stack_chk_guard;
    iVar1 = FUN_0007ec68(uVar2, *(undefined4 *)(param_3 + 0x1c), uVar4);
    iVar3 = *(int *)(param_3 + 0x30);
    iVar5 = *(int *)(param_3 + 0x24);
    uVar4 = *(undefined4 *)(param_3 + 0x28);
    *(int *)(param_2 + 0xc0) = iVar1;
    uVar2 = *(undefined4 *)(param_3 + 0x2c);
    *(undefined4 *)(param_2 + 200) = uVar4;
    iVar7 = iVar5 + -9;
    if (iVar7 >= 0) {
        *(int *)(param_2 + 0xc4) = iVar7;
    }
    *(undefined4 *)(param_2 + 0xcc) = uVar2;
    *(int *)(param_2 + 0xd0) = iVar3 * 1000000;
    if (iVar7 < 0) {
        *(int *)(param_2 + 0xc0) = iVar1 + -1;
        *(int *)(param_2 + 0xc4) = iVar5 + 0xf;
        if (iVar1 + -1 < 1) {
            iVar1 = *(int *)(param_2 + 0xbc) + -1;
            *(int *)(param_2 + 0xbc) = iVar1;
            uVar2 = FUN_0007ec68(iVar1, 0xc, 0x1f);
            *(undefined4 *)(param_2 + 0xc0) = uVar2;
        }
    }
    iVar1 = FUN_00049cf8(param_2);
    if (iVar1 == 0) {
        FUN_000494a0(param_1, 6);
    } else {
        *(undefined4 *)(param_2 + 0xe0) = *(undefined4 *)(param_2 + 0xe8);
        *(undefined4 *)(param_2 + 0xe4) = *(undefined4 *)(param_2 + 0xec);
        FUN_00049d44(param_1);
        uVar4 = *(undefined4 *)(param_2 + 0xbc);
        iVar1 = *(int *)(param_2 + 0xd0) / 1000000;
        uVar8 = *(undefined4 *)(param_2 + 0xcc);
        uVar11 = *(undefined4 *)(param_2 + 200);
        uVar2 = *(undefined4 *)(param_2 + 0xc4);
        uVar9 = *(undefined4 *)(param_2 + 0xc0);
        FUN_0007c054(
            auStack_74, 0x50,
            "%04d/%02d/%02d %02d:%02d:%02d.%03d JST   ( %04d/%03d "
            "%02d:%02d:%02d.%03d UTC )",
            *(undefined4 *)(param_3 + 0x18), *(undefined4 *)(param_3 + 0x1c),
            *(undefined4 *)(param_3 + 0x20), *(undefined4 *)(param_3 + 0x24),
            *(undefined4 *)(param_3 + 0x28), *(undefined4 *)(param_3 + 0x2c),
            *(undefined4 *)(param_3 + 0x30), uVar4, uVar9, uVar2, uVar11, uVar8,
            iVar1);
        FUN_0005a084(param_1, 5, auStack_74);
        switch (*(undefined1 *)(param_1 + 0x128)) {
        case 0:
            uVar6 = 0x20;
            pcVar10 = "Reject";
            break;
        case 1:
            uVar6 = 0x78;
            pcVar10 = "FalseTick";
            break;
        case 2:
            uVar6 = 0x2e;
            pcVar10 = "Excess";
            break;
        case 3:
            uVar6 = 0x2d;
            pcVar10 = "Outlier";
            break;
        case 4:
            uVar6 = 0x2b;
            pcVar10 = "Candidate";
            break;
        case 5:
            uVar6 = 0x23;
            pcVar10 = "Selected";
            break;
        case 6:
            uVar6 = 0x2a;
            pcVar10 = "Sys.Peer";
            break;
        case 7:
            uVar6 = 0x6f;
            pcVar10 = "PPS.Peer";
            break;
        default:
            uVar6 = 0x20;
            pcVar10 = "";
        }
        FUN_0007c054(
            auStack_74, 0x50,
            "status %d [%c] %s : offset %3.3f mSec. : jitter %3.3f mSec.",
            *(undefined1 *)(param_1 + 0x128), uVar6, pcVar10,
            *(double *)(param_1 + 0x260) * 1000.0,
            *(double *)(param_1 + 0x270) * 1000.0, uVar4, uVar9, uVar2, uVar11,
            uVar8, iVar1);
        FUN_0005a084(param_1, 4, auStack_74);
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005b744(undefined4 param_1, int param_2)

{
    byte bVar1;
    int *piVar2;
    size_t sVar3;
    ssize_t sVar4;
    short sVar5;
    int iVar6;
    int iVar7;
    byte *pbVar8;
    char *__buf;
    undefined4 *puVar9;
    size_t __n;
    char local_5c[4];
    undefined1 local_58;
    undefined1 local_57;
    undefined1 local_56;
    undefined1 local_55;
    undefined1 local_54;
    undefined1 local_53;
    undefined1 local_52;
    undefined1 local_51;
    undefined1 local_50;
    undefined1 auStack_4c[40];
    int local_24;

    puVar9 = *(undefined4 **)(param_2 + 0x54);
    pbVar8 = (byte *)*puVar9;
    local_24 = __stack_chk_guard;
    if (pbVar8[10] != 0) {
        FUN_0005a084(param_2, 7,
                     "Ignore polling because of error during initializing");
        goto LAB_0005b94c;
    }
    iVar6 = puVar9[0xc2];
    if ((iVar6 != 0) && (*(int *)(pbVar8 + 0x14) == 0)) {
        FUN_000494a0(param_2, 1);
        iVar6 = puVar9[0xc2];
    }
    puVar9[0xc2] = iVar6 + 1;
    bVar1 = *(byte *)(param_2 + 0x12a);
    local_51 = 0;
    if ((bVar1 & 0x80) == 0) {
        local_58 = 0x30;
    } else {
        local_58 = 0x31;
    }
    if ((bVar1 & 0x40) == 0) {
        local_57 = 0x30;
    } else {
        local_57 = 0x31;
    }
    if ((bVar1 & 0x20) == 0) {
        local_56 = 0x30;
    } else {
        local_56 = 0x31;
    }
    if ((bVar1 & 0x10) == 0) {
        local_55 = 0x30;
    } else {
        local_55 = 0x31;
    }
    if ((bVar1 & 8) == 0) {
        local_54 = 0x30;
    } else {
        local_54 = 0x31;
    }
    if ((bVar1 & 4) == 0) {
        local_53 = 0x30;
    } else {
        local_53 = 0x31;
    }
    if ((bVar1 & 2) == 0) {
        local_52 = 0x30;
    } else {
        local_52 = 0x31;
    }
    local_50 = 0;
    FUN_0007c054(auStack_4c, 0x28, "polls=%ld reach=%s", iVar6 + 1, &local_58);
    FUN_0005a084(param_2, 5, auStack_4c);
    bVar1 = *pbVar8;
    pbVar8[0x10] = 0;
    pbVar8[0x11] = 0;
    pbVar8[0x12] = 0;
    pbVar8[0x13] = 0;
    pbVar8[0x14] = 0;
    pbVar8[0x15] = 0;
    pbVar8[0x16] = 0;
    pbVar8[0x17] = 0;
    pbVar8[0xf] = 0;
    pbVar8[0xb8] = 0;
    pbVar8[0xb9] = 0;
    pbVar8[0xba] = 0;
    pbVar8[0xbb] = 0;
    pbVar8[0xc] = 1;
    pbVar8[0xd] = 0;
    if (bVar1 == 4) {
    LAB_0005ba28:
        *(undefined1 *)(**(int **)(param_2 + 0x54) + 0xf) = 0;
    } else {
        if (bVar1 < 5) {
            if (bVar1 == 2) {
                piVar2 = *(int **)(param_2 + 0x54);
                iVar7 = *piVar2;
                *(undefined1 *)(iVar7 + 0xf) = 0;
                *(undefined4 *)(iVar7 + 0xb8) = 0;
                iVar6 = piVar2[7];
                *(undefined4 *)(iVar7 + 0x128) = 0;
                *(undefined4 *)(iVar7 + 400) = 0;
                *(short *)(iVar7 + 0x10) = *(short *)(iVar7 + 0x10) + 1;
                sVar4 = write(iVar6, &DAT_000a7f78, 4);
                if (sVar4 != 4) {
                    FUN_000494a0(param_2, 3);
                }
                FUN_0005a084(param_2, 2, &DAT_000a7f78);
                goto LAB_0005b94c;
            }
            if (bVar1 < 3) {
                if (bVar1 != 1)
                    goto LAB_0005b94c;
                piVar2 = *(int **)(param_2 + 0x54);
                iVar6 = *piVar2;
                *(undefined1 *)(iVar6 + 0xf) = 0;
                *(undefined4 *)(iVar6 + 0x38) = 0;
                if ((*(byte *)(piVar2 + 0xc0) & 1) == 0) {
                    __n = 6;
                    sVar5 = 3;
                    *(undefined4 *)(iVar6 + 0x14) = 2;
                    __buf = "time\r\n";
                } else {
                    sVar5 = *(short *)(iVar6 + 0x10) + 1;
                    __n = *(size_t *)(&DAT_000c4a20 + sVar5 * 0x14);
                    __buf = *(char **)(&DAT_000c4a1c + sVar5 * 0x14);
                }
                *(short *)(iVar6 + 0x10) = sVar5;
                goto LAB_0005b9a4;
            }
            piVar2 = *(int **)(param_2 + 0x54);
            iVar6 = *piVar2;
            sVar5 = *(short *)(iVar6 + 2);
            *(undefined1 *)(iVar6 + 0xf) = 0;
            if (sVar5 == 1) {
                local_5c[0] = 'T';
            } else if ((0 < sVar5) && (sVar5 < 4)) {
                local_5c[0] = 'C';
            }
            __buf = local_5c;
            local_5c[1] = 0;
            sVar4 = write(piVar2[7], __buf, 1);
            if (sVar4 != 1)
                goto LAB_0005b9b8;
        } else {
            if (bVar1 == 6)
                goto LAB_0005ba28;
            if (5 < bVar1) {
                if (bVar1 == 100) {
                    iVar6 = **(int **)(param_2 + 0x54);
                    if (*(short *)(iVar6 + 500) == 0) {
                        *(undefined4 *)(iVar6 + 0xb8) = 0;
                        *(undefined4 *)(iVar6 + 0x128) = 0;
                        *(undefined4 *)(iVar6 + 400) = 0;
                    }
                    *(undefined2 *)(iVar6 + 0x1f6) = 1;
                    FUN_000598e8(param_2);
                }
                goto LAB_0005b94c;
            }
            piVar2 = *(int **)(param_2 + 0x54);
            iVar6 = *piVar2;
            *(undefined4 *)(iVar6 + 0x38) = 0;
            if ((*(byte *)(piVar2 + 0xc0) & 1) == 0) {
                __n = 6;
                sVar5 = 2;
                *(undefined4 *)(iVar6 + 0x14) = 1;
                __buf = "time\r\n";
            } else {
                sVar5 = *(short *)(iVar6 + 0x10) + 1;
                __n = *(size_t *)(&DAT_000c4aac + sVar5 * 0x10);
                __buf = *(char **)(&DAT_000c4aa8 + sVar5 * 0x10);
            }
            *(short *)(iVar6 + 0x10) = sVar5;
        LAB_0005b9a4:
            sVar3 = write(piVar2[7], __buf, __n);
            if (sVar3 != __n) {
            LAB_0005b9b8:
                FUN_000494a0(param_2, 3);
            }
        }
        FUN_0005a084(param_2, 2, __buf);
    }
LAB_0005b94c:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0005bc28(int param_1, undefined1 *param_2)

{
    byte bVar1;
    uint uVar2;
    undefined4 uVar3;
    byte *pbVar4;
    ushort **ppuVar5;
    uint uVar6;
    int iVar7;
    int iVar8;
    byte *pbVar9;
    int local_88;
    byte local_80[4];
    undefined1 auStack_7c[80];
    int local_2c;

    iVar7 = 1;
    local_2c = __stack_chk_guard;
    FUN_0005a084(param_1, 1, "Refclock: Telephone JJY");
    *param_2 = 100;
    *(undefined4 *)(param_2 + 4) = 0xb;
    param_2[0xc0] = 1;
    param_2[0x194] = 1;
    *(undefined2 *)(param_2 + 8) = 0x20;
    *(undefined **)(param_2 + 0xbc) = &DAT_000c6f54;
    *(undefined4 *)(param_2 + 500) = 0;
    uVar3 = sys_phone._0_4_;
    if (sys_phone._0_4_ == 0) {
        FUN_00074e00(3, "refclock_jjy.c : jjy_start_telephone : phone in the "
                        "ntpd.conf must be specified.");
        param_2[10] = 1;
    } else if (sys_phone._4_4_ == 0) {
        pbVar4 = (byte *)strlen((char *)sys_phone._0_4_);
        pbVar9 = (byte *)(uVar3 + -1);
        iVar8 = 0;
        iVar7 = 0;
        local_88 = 0;
        uVar2 = 0;
        do {
            while (true) {
                while (true) {
                    if (pbVar4 <= pbVar9 + (1 - uVar3)) {
                        local_80[uVar2] = 0;
                        if ((iVar7 == 1) &&
                            ((local_88 != 1 || (*(char *)uVar3 != '0')))) {
                            FUN_00074e00(
                                3, "refclock_jjy.c : jjy_start_telephone : "
                                   "Getting an outside line should be \'0,\'.");
                            param_2[10] = 1;
                        } else if ((iVar8 - local_88) - 6U < 5) {
                            pbVar9 = local_80 + local_88;
                            iVar7 = strncmp((char *)pbVar9, "00", 2);
                            if (((((iVar7 == 0) ||
                                   (iVar7 = strncmp((char *)pbVar9, "10", 2),
                                    iVar7 == 0)) ||
                                  (iVar7 = strncmp((char *)pbVar9, "11", 2),
                                   iVar7 == 0)) ||
                                 ((iVar7 = strncmp((char *)pbVar9, "12", 2),
                                   iVar7 == 0 || (iVar7 = strncmp(
                                                      (char *)pbVar9, "171", 3),
                                                  iVar7 == 0)))) ||
                                ((iVar7 = strncmp((char *)pbVar9, "177", 3),
                                  iVar7 == 0 || ((local_80[0] == 0x30 &&
                                                  (local_80[2] == '0')))))) {
                                iVar7 = 1;
                                FUN_00074e00(
                                    3,
                                    "refclock_jjy.c : jjy_start_telephone : "
                                    "phone=%s : First 2 or 3 digits are not "
                                    "allowed.",
                                    uVar3);
                                param_2[10] = 1;
                            } else {
                                FUN_0007c054(auStack_7c, 0x50, "phone=%s",
                                             uVar3);
                                FUN_0005a084(param_1, 1, auStack_7c);
                                bVar1 = *(byte *)(param_1 + 0x41);
                                if (bVar1 < 8) {
                                    *(undefined1 *)(param_1 + 0x41) = 8;
                                    iVar7 = 0;
                                    if (*(byte *)(param_1 + 0x5e) < 8) {
                                        *(undefined1 *)(param_1 + 0x5e) = 8;
                                    }
                                    if (*(byte *)(param_1 + 0x42) < 8) {
                                        *(undefined1 *)(param_1 + 0x42) = 8;
                                    }
                                    FUN_0007c054(auStack_7c, 0x50,
                                                 "minpoll=%d -> %d", bVar1, 8);
                                    FUN_0005a084(param_1, 1, auStack_7c);
                                } else {
                                    iVar7 = 0;
                                }
                            }
                        } else {
                            iVar7 = 1;
                            FUN_00074e00(3,
                                         "refclock_jjy.c : jjy_start_telephone "
                                         ": phone=%s : Number of digits should "
                                         "be 6 to 10.",
                                         uVar3);
                            param_2[10] = 1;
                        }
                        goto LAB_0005bed4;
                    }
                    ppuVar5 = __ctype_b_loc();
                    pbVar9 = pbVar9 + 1;
                    uVar6 = (uint)*pbVar9;
                    if (((*ppuVar5)[uVar6] & 0x800) == 0)
                        break;
                    iVar8 = iVar8 + 1;
                    if (uVar2 < 3) {
                        local_80[uVar2] = *pbVar9;
                        uVar2 = uVar2 + 1;
                    }
                }
                if (uVar6 != 0x2c)
                    break;
                if (iVar7 == 1) {
                    FUN_00074e00(
                        3, "refclock_jjy.c : jjy_start_telephone : phone in "
                           "the ntpd.conf should be zero or one comma.");
                    param_2[10] = 1;
                    goto LAB_0005bed4;
                }
                local_88 = (int)pbVar9 - uVar3;
                iVar7 = 1;
                uVar2 = (*ppuVar5)[uVar6] & 0x800;
            }
        } while (uVar6 == 0x2d);
        iVar7 = 1;
        FUN_00074e00(3, "refclock_jjy.c : jjy_start_telephone : phone in the "
                        "ntpd.conf should be a number or a hyphen.");
        param_2[10] = 1;
    } else {
        iVar7 = 1;
        FUN_00074e00(3, "refclock_jjy.c : jjy_start_telephone : phone in the "
                        "ntpd.conf should be only one.");
        param_2[10] = 1;
    }
LAB_0005bed4:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar7);
    }
    return;
}

void FUN_0005e744(int param_1, int param_2)

{
    int iVar1;
    ushort uVar2;
    ushort uVar3;
    ushort uVar4;
    ushort uVar5;
    ushort uVar6;
    ushort uVar7;
    bool bVar8;
    bool bVar9;

    iVar1 = __stack_chk_guard;
    uVar2 = *(byte *)(param_1 + 0x58) - 0x30;
    if (((((uVar2 & 0xff) < 10) &&
          (uVar3 = *(byte *)(param_1 + 0x59) - 0x30, (uVar3 & 0xff) < 10)) &&
         (uVar6 = *(byte *)(param_1 + 0x5a) - 0x30, (uVar6 & 0xff) < 10)) &&
        (((uVar7 = *(byte *)(param_1 + 0x5b) - 0x30,
           (uVar7 & 0xff) < 10 && (uVar4 = *(byte *)(param_1 + 0x5c) - 0x30,
                                   (uVar4 & 0xff) < 10)) &&
          (uVar5 = *(byte *)(param_1 + 0x5d) - 0x30, (uVar5 & 0xff) < 10)))) {
        uVar3 = uVar3 + uVar2 * 10;
        uVar7 = uVar7 + uVar6 * 10;
        uVar5 = uVar5 + uVar4 * 10;
        bVar9 = 0x3b < uVar7;
        bVar8 = uVar7 == 0x3c;
        if (uVar7 < 0x3d) {
            bVar9 = 0x16 < uVar3;
            bVar8 = uVar3 == 0x17;
        }
        *(ushort *)(param_2 + 0x2e) = uVar3;
        *(ushort *)(param_2 + 0x32) = uVar7;
        bVar8 = uVar5 < 0x3d && (!bVar9 || bVar8);
        *(ushort *)(param_2 + 0x30) = uVar5;
    } else {
        bVar8 = false;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(bVar8);
    }
    return;
}

void FUN_0005f3c0(undefined4 param_1, int param_2, undefined1 *param_3,
                  int param_4)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    uint uVar4;
    int iVar5;
    int *piVar6;
    undefined1 *puVar7;
    undefined1 auStack_74[80];
    int local_24;

    local_24 = __stack_chk_guard;
    if (((param_4 == 0) ||
         (piVar6 = *(int **)(param_4 + 0x54), piVar6 == (int *)0x0)) ||
        (iVar5 = *piVar6, iVar5 == 0)) {
        FUN_00074e00(3, "NeoClock4X(%d): control: unit invalid/inactive",
                     param_1);
        goto LAB_0005f668;
    }
    if (param_2 != 0) {
        uVar4 = ntp_syslogmask & 0x100;
        if ((*(byte *)(param_2 + 2) & 1) != 0) {
            iVar1 = *(int *)(param_2 + 0x28);
            iVar3 = *(int *)(param_2 + 0x2c);
            piVar6[0xba] = iVar1;
            piVar6[0xbb] = iVar3;
            if (uVar4 == 0)
                goto LAB_0005f440;
            FUN_00074e00(
                5,
                "NeoClock4X(%d): using fudgetime1 with %0.5fs from ntp.conf.",
                param_1, uVar4, iVar1, iVar3);
            uVar4 = ntp_syslogmask & 0x100;
        }
        if ((*(byte *)(piVar6 + 0xc0) & 1) == 0) {
            if (uVar4 != 0) {
                FUN_00074e00(5,
                             "NeoClock4X(%d): time is only adjusted with radio "
                             "signal reception.",
                             param_1);
            }
        } else if (uVar4 != 0) {
            FUN_00074e00(5,
                         "NeoClock4X(%d): quartz clock is used to synchronize "
                         "time if radio clock has no reception.",
                         param_1);
        }
    }
LAB_0005f440:
    if (param_3 != (undefined1 *)0x0) {
        *(undefined4 *)(param_3 + 0x44) = 0;
        puVar7 = param_3 + 0x44;
        *param_3 = 0x2c;
        FUN_0007c054(
            auStack_74, 0x4f, "%04d-%02d-%02d %02d:%02d:%02d.%03d",
            *(undefined4 *)(iVar5 + 0x80), *(undefined4 *)(iVar5 + 0x84),
            *(undefined4 *)(iVar5 + 0x88), *(undefined4 *)(iVar5 + 0x8c),
            *(undefined4 *)(iVar5 + 0x90), *(undefined4 *)(iVar5 + 0x94),
            *(undefined4 *)(iVar5 + 0x98));
        uVar2 = FUN_000343ac(puVar7, 0x4f, 0x21);
        FUN_0007c054(uVar2, 0x4f, "calc_utc=\"%s\"", auStack_74);
        uVar2 = FUN_000343ac(puVar7, 0x28, 0x21);
        FUN_0007c054(uVar2, 0x27, "radiosignal=\"%s\"", iVar5 + 0x70);
        uVar2 = FUN_000343ac(puVar7, 0x28, 0x21);
        FUN_0007c054(uVar2, 0x27, &DAT_000a8aa0, *(undefined4 *)(iVar5 + 0x78));
        uVar2 = FUN_000343ac(puVar7, 0x28, 0x21);
        FUN_0007c054(uVar2, 0x27, "antenna2=\"%d\"",
                     *(undefined4 *)(iVar5 + 0x7c));
        uVar2 = FUN_000343ac(puVar7, 0x28, 0x21);
        if (*(char *)(iVar5 + 0x74) == 'A') {
            FUN_0007c054(uVar2, 0x27, "timesource=\"radio\"");
        } else if (*(char *)(iVar5 + 0x74) == 'C') {
            FUN_0007c054(uVar2, 0x27, "timesource=\"quartz\"");
        } else {
            FUN_0007c054(uVar2, 0x27, "timesource=\"unknown\"");
        }
        uVar2 = FUN_000343ac(puVar7, 0x28, 0x21);
        if (*(char *)(iVar5 + 0x76) == 'I') {
            FUN_0007c054(uVar2, 0x27, "quartzstatus=\"synchronized\"");
        } else if (*(char *)(iVar5 + 0x76) == 'X') {
            FUN_0007c054(uVar2, 0x27, "quartzstatus=\"not synchronized\"");
        } else {
            FUN_0007c054(uVar2, 0x27, "quartzstatus=\"unknown\"");
        }
        uVar2 = FUN_000343ac(puVar7, 0x28, 0x21);
        if (*(char *)(iVar5 + 0x75) == 'S') {
            FUN_0007c054(uVar2, 0x27, "dststatus=\"summer\"");
        } else if (*(char *)(iVar5 + 0x75) == 'W') {
            FUN_0007c054(uVar2, 0x27, "dststatus=\"winter\"");
        } else {
            FUN_0007c054(uVar2, 0x27, "dststatus=\"unknown\"");
        }
        uVar2 = FUN_000343ac(puVar7, 0x50, 0x21);
        FUN_0007c054(uVar2, 0x4f, "firmware=\"%s\"", iVar5 + 0x18);
        uVar2 = FUN_000343ac(puVar7, 0x28, 0x21);
        FUN_0007c054(uVar2, 0x27, "firmwaretag=\"%c\"",
                     *(undefined1 *)(iVar5 + 0x68));
        uVar2 = FUN_000343ac(puVar7, 0x50, 0x21);
        FUN_0007c054(uVar2, 0x4f, "driver version=\"%s\"", "1.16 (2009-12-04)");
        uVar2 = FUN_000343ac(puVar7, 0x50, 0x21);
        FUN_0007c054(uVar2, 0x4f, "serialnumber=\"%s\"", iVar5 + 0x69);
    }
LAB_0005f668:
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005f7e8(undefined4 param_1, int param_2)

{
    int iVar1;
    undefined4 *puVar2;
    void *__ptr;
    uint local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    if (((param_2 != 0) && (puVar2 = *(undefined4 **)(param_2 + 0x54),
                            puVar2 != (undefined4 *)0x0)) &&
        (__ptr = (void *)*puVar2, __ptr != (void *)0x0)) {
        if (puVar2[7] == -1) {
            free(__ptr);
            *puVar2 = 0;
        } else {
            iVar1 = ioctl(puVar2[7], 0x5415, &local_28);
            if (iVar1 == -1) {
                FUN_00074e00(2,
                             "NeoClock4X(%d): can\'t query RTS/DTR state: %m",
                             param_1);
            }
            local_28 = local_28 & 0xfffffff9;
            iVar1 = ioctl(puVar2[7], 0x5418, &local_28);
            if (iVar1 == -1) {
                FUN_00074e00(2,
                             "NeoClock4X(%d): can\'t set RTS/DTR to power "
                             "neoclock4x: %m",
                             param_1);
            }
            FUN_00028e64(puVar2 + 2);
            free(__ptr);
            *puVar2 = 0;
        }
    }
    FUN_00074e00(3, "NeoClock4X(%d): shutdown", param_1);
    if ((ntp_syslogmask & 0x100) != 0) {
        FUN_00074e00(6, "NeoClock4X(%d): receiver shutdown done", param_1);
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0005f944(int param_1, int *param_2)

{
    int iVar1;
    int iVar2;
    ushort **ppuVar3;
    byte *pbVar4;
    int iVar5;
    byte *pbVar6;

    iVar1 = __stack_chk_guard;
    ppuVar3 = __ctype_b_loc();
    iVar2 = __stack_chk_guard;
    pbVar6 = (byte *)(param_1 + -1);
    iVar5 = 0;
    while (true) {
        pbVar6 = pbVar6 + 1;
        pbVar4 = pbVar6 + (-2 - param_1);
        if (pbVar4 != (byte *)0x0) {
            pbVar4 = (byte *)0x1;
        }
        if (((uint)pbVar4 & (uint)((*ppuVar3)[*pbVar6] >> 0xb)) == 0)
            break;
        iVar5 = (*pbVar6 - 0x30) + iVar5 * 10;
    }
    *param_2 = iVar5;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar5);
}

void FUN_0005f9d8(int param_1, int *param_2)

{
    byte bVar1;
    ushort uVar2;
    int iVar3;
    ushort **ppuVar4;
    __int32_t **pp_Var5;
    int iVar6;
    uint uVar7;
    ushort *puVar8;
    byte *pbVar9;
    int iVar10;

    iVar3 = __stack_chk_guard;
    pbVar9 = (byte *)(param_1 + -1);
    iVar10 = 0;
    ppuVar4 = __ctype_b_loc();
    puVar8 = *ppuVar4;
    while (true) {
        iVar6 = __stack_chk_guard;
        pbVar9 = pbVar9 + 1;
        bVar1 = *pbVar9;
        uVar2 = puVar8[bVar1];
        uVar7 = ((uint)uVar2 << 0x13) >> 0x1f;
        if ((int)pbVar9 - param_1 == 2) {
            uVar7 = 0;
        }
        if (uVar7 == 0)
            break;
        pp_Var5 = __ctype_toupper_loc();
        if ((uVar2 & 0x800) == 0) {
            iVar6 = (*pp_Var5)[bVar1] + -0x37;
        } else {
            iVar6 = (*pp_Var5)[bVar1] + -0x30;
        }
        iVar10 = iVar6 + iVar10 * 0x10;
    }
    *param_2 = iVar10;
    if (iVar3 == iVar6) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar10);
}

void FUN_0005fa84(int param_1)

{
    uint uVar1;
    char cVar2;
    undefined1 uVar3;
    undefined2 uVar4;
    int iVar5;
    uint uVar6;
    byte *pbVar7;
    int extraout_r1;
    int extraout_r1_00;
    int extraout_r1_01;
    byte bVar8;
    uint uVar9;
    int *piVar10;
    int iVar11;
    int iVar12;
    int *piVar13;
    int iVar14;
    uint uVar15;
    int iVar16;
    int iVar17;
    int local_54;
    int local_3c;
    int local_38;
    int local_34;
    uint local_30;
    int local_2c;

    iVar12 = *(int *)(param_1 + 4);
    piVar10 = *(int **)(iVar12 + 0x54);
    iVar11 = *piVar10;
    local_2c = __stack_chk_guard;
    if (*(int *)(iVar11 + 0x14) == 0)
        goto LAB_0005fabc;
    piVar13 = piVar10 + 0xe;
    *(undefined4 *)(iVar11 + 0x14) = 0;
    iVar5 = FUN_00049ee4(param_1, piVar13, 0x80, piVar10 + 0x3a);
    *(undefined1 *)(piVar10 + 10) = 0;
    piVar10[0x2e] = iVar5;
    if (iVar5 == 0x25) {
        FUN_0005f9d8((int)piVar10 + 0x5b, &local_30);
        uVar9 = 0;
        pbVar7 = (byte *)((int)piVar10 + 0x37);
        do {
            pbVar7 = pbVar7 + 1;
            uVar9 = uVar9 + *pbVar7 & 0xff;
        } while ((byte *)((int)piVar10 + 0x5a) != pbVar7);
        if (uVar9 == local_30) {
            cVar2 = *(char *)((int)piVar10 + 0x56);
            *(char *)(iVar11 + 0x76) = cVar2;
            bVar8 = *(byte *)(piVar10 + 0xc0);
            if ((bVar8 & 2) == 0) {
                if (cVar2 != 'I') {
                    if ((ntp_syslogmask & 0x200) != 0) {
                        FUN_00074e00(5,
                                     "NeoClock4X(%d): quartz clock is not "
                                     "initialized: %s",
                                     (int)*(short *)(iVar11 + 8), piVar13);
                    }
                    *(undefined1 *)(piVar10 + 10) = 3;
                    FUN_000494a0(iVar12, 5);
                    goto LAB_0005fabc;
                }
            LAB_0005fd70:
                iVar5 = *(byte *)(piVar10 + 0x15) - 0x41;
                *(byte *)(iVar11 + 0x74) = *(byte *)(piVar10 + 0x15);
                if (iVar5 != 0) {
                    iVar5 = 1;
                }
                if ((bVar8 & 2) != 0) {
                    iVar5 = 0;
                }
                if ((iVar5 != 0) && ((bVar8 & 1) == 0)) {
                    FUN_000494a0(iVar12, 6);
                    *(undefined1 *)(piVar10 + 10) = 3;
                    goto LAB_0005fabc;
                }
            } else {
                if ((cVar2 != 'I') && ((ntp_syslogmask & 0x200) != 0)) {
                    FUN_00074e00(5,
                                 "NeoClock4X(%d): using uninitialized quartz "
                                 "clock for time synchronization: %s",
                                 (int)*(short *)(iVar11 + 8), piVar13);
                    bVar8 = *(byte *)(piVar10 + 0xc0);
                    goto LAB_0005fd70;
                }
                *(char *)(iVar11 + 0x74) = (char)piVar10[0x15];
            }
            if ((bVar8 & 8) != 0) {
                FUN_00074e00(7, "NeoClock4X(%d): received data: %s",
                             (int)*(short *)(iVar11 + 8), piVar13);
            }
            FUN_0005f944(piVar10 + 0x12, piVar10 + 0x2f);
            FUN_0005f944((int)piVar10 + 0x46, &local_38);
            FUN_0005f944(piVar10 + 0x11, &local_3c);
            FUN_0005f944((int)piVar10 + 0x4a, piVar10 + 0x31);
            FUN_0005f944(piVar10 + 0x13, piVar10 + 0x32);
            FUN_0005f944((int)piVar10 + 0x4e, piVar10 + 0x33);
            FUN_0005f944(piVar10 + 0x14, &local_34);
            piVar10[0x34] = local_34 * 10000000;
            uVar4 = *(undefined2 *)((int)piVar10 + 0x41);
            uVar3 = *(undefined1 *)((int)piVar10 + 0x43);
            *(undefined1 *)(iVar11 + 0x73) = 0;
            *(undefined2 *)(iVar11 + 0x70) = uVar4;
            *(undefined1 *)(iVar11 + 0x72) = uVar3;
            *(undefined4 *)(iVar11 + 0x69) =
                *(undefined4 *)((int)piVar10 + 0x3b);
            uVar4 = *(undefined2 *)((int)piVar10 + 0x3f);
            *(undefined1 *)(iVar11 + 0x6f) = 0;
            *(undefined2 *)(iVar11 + 0x6d) = uVar4;
            *(undefined1 *)(iVar11 + 0x75) =
                *(undefined1 *)((int)piVar10 + 0x55);
            FUN_0005f9d8((int)piVar10 + 0x57, iVar11 + 0x78);
            FUN_0005f9d8((int)piVar10 + 0x59, iVar11 + 0x7c);
            if (((((uint)piVar10[0x31] < 0x18) &&
                  ((uint)piVar10[0x32] < 0x3c)) &&
                 ((uint)piVar10[0x33] < 0x3d)) &&
                (((local_3c - 1U < 0x1f && (local_38 - 1U < 0xc)) &&
                  (uVar9 = piVar10[0x2f], uVar9 < 100)))) {
                local_54 = local_38 + -2;
                uVar15 = uVar9 + 2000;
                if (local_54 < 1) {
                    uVar15 = uVar9 + 1999;
                    local_54 = local_38 + 10;
                }
                iVar5 =
                    ((uVar15 * 0x2238 +
                      ((((int)uVar15 >> 2) - (int)uVar15 / 100) + uVar15 / 400 +
                       (uint)(local_54 * 0x16f) / 0xc + local_3c) *
                          0x18 +
                      piVar10[0x31]) *
                         0x3c +
                     piVar10[0x32]) *
                        0x3c +
                    piVar10[0x33];
                uVar9 = iVar5 + 0x86b1b170;
                if (*(char *)(iVar11 + 0x75) == 'S') {
                    uVar9 = iVar5 + 0x86b1a360;
                }
                FUN_0009b8ec(uVar9, 0x3c);
                piVar10[0x33] = extraout_r1;
                FUN_0009bb9c(uVar9 / 0x3c, 0x3c, uVar9 * -0x77777777);
                piVar10[0x32] = extraout_r1_00;
                FUN_0009b8ec(uVar9 / 0xe10, 0x18, uVar9 * -0x6e5d4c3b);
                piVar10[0x31] = extraout_r1_01;
                iVar5 = uVar9 / 0x15180 + 0x264965;
                uVar9 = (uint)(iVar5 * 4) / 0x23ab1;
                iVar5 = iVar5 - (uVar9 * 0x23ab1 + 3 >> 2);
                uVar15 = (iVar5 * 4000 + 4000U) / 0x164b09;
                iVar14 = (iVar5 + 0x1f) - (uVar15 * 0x5b5 >> 2);
                uVar6 = iVar14 * 0x50;
                uVar1 = uVar6 / 0x98f;
                iVar5 = FUN_0009b690(uVar6, 0x6925);
                local_38 = uVar1 + 2 + iVar5 * -0xc;
                local_3c = iVar14 - (uVar1 * 0x98f) / 0x50;
                iVar5 = iVar5 + uVar9 * 100 + uVar15 + -0x1324;
                piVar10[0x2f] = iVar5;
                iVar5 = FUN_0007ec68(iVar5, local_38, local_3c);
                piVar10[0x30] = iVar5;
                *(undefined1 *)(piVar10 + 10) = 0;
                if ((*(byte *)(piVar10 + 0xc0) & 8) != 0) {
                    FUN_00074e00(7,
                                 "NeoClock4X(%d): calculated UTC date/time: "
                                 "%04d-%02d-%02d %02d:%02d:%02d.%03ld",
                                 (int)*(short *)(iVar11 + 8), piVar10[0x2f],
                                 local_38, local_3c, piVar10[0x31],
                                 piVar10[0x32], piVar10[0x33],
                                 piVar10[0x34] / 1000000);
                }
                iVar14 = piVar10[0x34];
                iVar5 = piVar10[0x31];
                iVar17 = piVar10[0x32];
                iVar16 = piVar10[0x33];
                *(int *)(iVar11 + 0x80) = piVar10[0x2f];
                *(int *)(iVar11 + 0x8c) = iVar5;
                *(int *)(iVar11 + 0x90) = iVar17;
                *(int *)(iVar11 + 0x98) = iVar14 / 1000000;
                *(int *)(iVar11 + 0x94) = iVar16;
                *(int *)(iVar11 + 0x84) = local_38;
                *(int *)(iVar11 + 0x88) = local_3c;
                iVar5 = FUN_00049cf8(piVar10);
                if (iVar5 == 0) {
                    if ((ntp_syslogmask & 0x200) != 0) {
                        FUN_00074e00(4,
                                     "NeoClock4X(%d): refclock_process failed!",
                                     (int)*(short *)(iVar11 + 8));
                    }
                    FUN_000494a0(iVar12, 3);
                } else {
                    FUN_00049d44(iVar12);
                    FUN_000494a0(iVar12, 0);
                    FUN_00051f44(iVar12 + 0x10, piVar13);
                }
            } else {
                if ((ntp_syslogmask & 0x200) != 0) {
                    FUN_00074e00(4,
                                 "NeoClock4X(%d): date/time out of range: %s",
                                 (int)*(short *)(iVar11 + 8), piVar13);
                }
                FUN_000494a0(iVar12, 5);
            }
            goto LAB_0005fabc;
        }
        if ((ntp_syslogmask & 0x200) != 0) {
            FUN_00074e00(4,
                         "NeoClock4X(%d): received data has invalid chksum: %s",
                         (int)*(short *)(iVar11 + 8), piVar13);
        }
    } else if ((ntp_syslogmask & 0x200) != 0) {
        FUN_00074e00(4,
                     "NeoClock4X(%d): received data has invalid length, "
                     "expected %d bytes, received %d bytes: %s",
                     (int)*(short *)(iVar11 + 8), 0x25, iVar5, piVar13);
    }
    FUN_000494a0(iVar12, 2);
LAB_0005fabc:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00060150(undefined4 param_1, int param_2)

{
    short sVar1;
    bool bVar2;
    bool bVar3;
    int __fd;
    int iVar4;
    void *__s;
    ssize_t sVar5;
    char *pcVar6;
    size_t sVar7;
    size_t sVar8;
    int *piVar9;
    char cVar10;
    undefined4 uVar11;
    int iVar12;
    uint uVar13;
    uint uVar14;
    int iVar15;
    int __fd_00;
    undefined4 *puVar16;
    uint uVar17;
    char *__haystack;
    int local_1b4;
    uint local_1ac;
    char local_181;
    uint local_180;
    termios local_17c;
    undefined1 auStack_140[20];
    char local_12c[256];
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_0007c054(auStack_140, 0x13, "/dev/neoclock4x-%d", param_1);
    __fd = FUN_0004a298(auStack_140, 0xb, 0);
    if (__fd < 1) {
        uVar11 = 0;
    } else {
        iVar4 = tcgetattr(__fd, &local_17c);
        if (iVar4 < 0) {
            uVar11 = 0;
            FUN_00074e00(2,
                         "NeoClock4X(%d): (tcgetattr) can\'t query serial port "
                         "settings: %m",
                         param_1);
            close(__fd);
        } else {
            uVar11 = 0;
            local_17c.c_iflag = 0x105;
            local_17c.c_cflag = 0x8f0;
            local_17c.c_oflag = 0;
            cfsetispeed(&local_17c, 0xb);
            cfsetospeed(&local_17c, 0xb);
            iVar4 = tcsetattr(__fd, 0, &local_17c);
            if (iVar4 < 0) {
                FUN_00074e00(2,
                             "NeoClock4X(%d): (tcsetattr) can\'t set serial "
                             "port 2400 8N2: %m",
                             param_1);
                close(__fd);
            } else {
                iVar4 = ioctl(__fd, 0x5415, &local_180);
                if (iVar4 == -1) {
                    FUN_00074e00(
                        2, "NeoClock4X(%d): can\'t query RTS/DTR state: %m",
                        param_1);
                    close(__fd);
                } else {
                    local_180 = local_180 | 6;
                    iVar4 = ioctl(__fd, 0x5418, &local_180);
                    if (iVar4 == -1) {
                        FUN_00074e00(2,
                                     "NeoClock4X(%d): can\'t set RTS/DTR to "
                                     "power neoclock4x: %m",
                                     param_1);
                        close(__fd);
                    } else {
                        __s = (void *)FUN_00073ba4(0, 0x9c, 0, 0);
                        if (__s == (void *)0x0) {
                            FUN_00074e00(3,
                                         "NeoClock4X(%d): can\'t allocate "
                                         "memory for: %m",
                                         param_1);
                            close(__fd);
                            uVar11 = 0;
                        } else {
                            memset(__s, 0, 0x9c);
                            __haystack = (char *)((int)__s + 0x18);
                            puVar16 = *(undefined4 **)(param_2 + 0x54);
                            *puVar16 = __s;
                            puVar16[3] = FUN_0005fa84;
                            *(undefined8 *)(puVar16 + 0xba) =
                                0x3fc5b4e81b4e81b5;
                            puVar16[5] = param_2;
                            puVar16[0xb] = "NeoClock4X";
                            puVar16[6] = 0;
                            puVar16[7] = __fd;
                            *(undefined1 *)(param_2 + 0x5f) = 0xf6;
                            puVar16[0xbf] = 0x6c6f656e;
                            *(undefined1 *)((int)__s + 0x10) = 0;
                            *(short *)((int)__s + 8) = (short)param_1;
                            local_1b4 = 0;
                            FUN_0007d4dc(__haystack, &DAT_000a8f60, 0x50);
                            *(undefined1 *)((int)__s + 0x68) = 0x3f;
                            FUN_0007d4dc((int)__s + 0x69, &DAT_000a8f60, 7);
                            FUN_0007d4dc((int)__s + 0x70, &DAT_000a8f60, 4);
                            *(undefined4 *)((int)__s + 0x78) = 0xffffffff;
                            *(undefined4 *)((int)__s + 0x7c) = 0xffffffff;
                            *(undefined1 *)((int)__s + 0x76) = 0x3f;
                            *(undefined4 *)((int)__s + 0x80) = 0;
                            *(undefined4 *)((int)__s + 0x84) = 0;
                            *(undefined4 *)((int)__s + 0x88) = 0;
                            *(undefined4 *)((int)__s + 0x8c) = 0;
                            *(undefined4 *)((int)__s + 0x90) = 0;
                            *(undefined4 *)((int)__s + 0x94) = 0;
                            *(undefined4 *)((int)__s + 0x98) = 0;
                            *(undefined2 *)((int)__s + 0x74) = 0x3f3f;
                            do {
                                if ((ntp_syslogmask & 0x100) != 0) {
                                    FUN_00074e00(
                                        6,
                                        "NeoClock4X(%d): checking NeoClock4X "
                                        "firmware version (%d/5)",
                                        param_1, local_1b4);
                                }
                                sleep(3);
                                __fd_00 = puVar16[7];
                                iVar4 = (int)*(short *)((int)__s + 8);
                                sleep(1);
                                sVar5 = write(__fd_00, &DAT_000a8fa0, 1);
                                if (sVar5 == -1) {
                                    FUN_00074e00(3,
                                                 "NeoClock4X(%d): can\'t query "
                                                 "firmware version",
                                                 iVar4);
                                    FUN_0007d4dc(local_12c, "unknown error",
                                                 0x100);
                                } else {
                                    uVar17 = 0;
                                    sleep(1);
                                    uVar13 = 0;
                                    memset(local_12c, 0, 0x100);
                                    bVar2 = false;
                                    local_1ac = 0;
                                    iVar12 = 0;
                                    iVar15 = 0;
                                    bVar3 = true;
                                    do {
                                        sVar5 = read(__fd_00, &local_181, 1);
                                        if (sVar5 == -1) {
                                            piVar9 = __errno_location();
                                            if (*piVar9 == 0xb) {
                                                sleep(1);
                                            } else {
                                                iVar15 = iVar15 + 1;
                                                FUN_00074e00(
                                                    7,
                                                    "NeoClock4x(%d): read: %m",
                                                    iVar4);
                                            }
                                        } else {
                                            iVar12 = iVar12 + 1;
                                            if (bVar3) {
                                                if (local_181 == -0x57) {
                                                    bVar3 = false;
                                                    FUN_0007d4dc(local_12c,
                                                                 &DAT_000a9068,
                                                                 0x100);
                                                    uVar13 = 3;
                                                }
                                            } else {
                                                uVar14 = uVar13;
                                                if (local_181 == '\r' ||
                                                    local_181 == '\n') {
                                                    if (bVar2) {
                                                        pcVar6 = strstr(
                                                            local_12c +
                                                                local_1ac,
                                                            "S/N");
                                                        if (pcVar6 !=
                                                            (char *)0x0) {
                                                            local_12c[uVar17] =
                                                                bVar3;
                                                            uVar13 =
                                                                FUN_0007d4dc(
                                                                    __haystack,
                                                                    local_12c,
                                                                    0x50);
                                                            if (0x4f < uVar13) {
                                                                FUN_0007d4dc(
                                                                    __haystack,
                                                                    "buffer "
                                                                    "too small",
                                                                    0x50);
                                                            }
                                                            if ((ntp_syslogmask &
                                                                 0x100) != 0) {
                                                                FUN_00074e00(
                                                                    6,
                                                                    "NeoClock4X"
                                                                    "(%d): "
                                                                    "firmware "
                                                                    "version: "
                                                                    "%s",
                                                                    iVar4,
                                                                    __haystack);
                                                            }
                                                            pcVar6 = strstr(
                                                                __haystack,
                                                                "/R2");
                                                            if (pcVar6 !=
                                                                (char *)0x0) {
                                                                FUN_00074e00(
                                                                    6,
                                                                    "NeoClock4X"
                                                                    "(%d): "
                                                                    "Your "
                                                                    "NeoClock4X"
                                                                    " uses the "
                                                                    "new R2 "
                                                                    "firmware "
                                                                    "release. "
                                                                    "Please "
                                                                    "note the "
                                                                    "changed "
                                                                    "LED "
                                                                    "behaviour"
                                                                    ".",
                                                                    iVar4);
                                                            }
                                                            goto LAB_0006053c;
                                                        }
                                                        local_1ac = uVar13 + 3;
                                                        local_12c[uVar13 + 1] =
                                                            '/';
                                                        local_12c[uVar13] = ' ';
                                                        local_12c[uVar13 + 2] =
                                                            ' ';
                                                        uVar14 = local_1ac;
                                                        uVar17 = uVar13;
                                                    } else {
                                                        bVar2 = true;
                                                    }
                                                } else {
                                                    bVar2 = bVar3;
                                                    if (local_181 != '\0') {
                                                        local_12c[uVar13] =
                                                            local_181;
                                                        uVar14 = uVar13 + 1;
                                                    }
                                                }
                                                local_12c[uVar14] = '\0';
                                                uVar13 = uVar14;
                                                if (0xfb < uVar14)
                                                    goto LAB_000604f4;
                                            }
                                        }
                                        if (iVar15 == 6) {
                                            FUN_00074e00(
                                                3,
                                                "NeoClock4X(%d): can\'t read "
                                                "firmware version (timeout)",
                                                iVar4);
                                            FUN_0007d4dc(
                                                local_12c,
                                                "unknown due to timeout",
                                                0x100);
                                            goto LAB_000604f4;
                                        }
                                    } while (iVar12 != 0x1f5);
                                    FUN_00074e00(3,
                                                 "NeoClock4X(%d): can\'t read "
                                                 "firmware version (garbage)",
                                                 iVar4);
                                    FUN_0007d4dc(local_12c,
                                                 "unknown due to garbage input",
                                                 0x100);
                                }
                            LAB_000604f4:
                                uVar13 =
                                    FUN_0007d4dc(__haystack, local_12c, 0x50);
                                if (0x4f < uVar13) {
                                    FUN_0007d4dc(__haystack, "buffer too small",
                                                 0x50);
                                }
                                local_1b4 = local_1b4 + 1;
                            } while (local_1b4 != 5);
                        LAB_0006053c:
                            cVar10 = '?';
                            *(undefined1 *)((int)__s + 0x68) = 0x3f;
                            pcVar6 = strstr(__haystack, "NDF:");
                            sVar1 = *(short *)((int)__s + 8);
                            if (pcVar6 != (char *)0x0) {
                                sVar7 = strlen(__haystack);
                                sVar8 = strlen(pcVar6);
                                if (((6 < sVar7 - sVar8) &&
                                     (pcVar6[5] == ':')) &&
                                    (pcVar6[6] == '*')) {
                                    cVar10 = pcVar6[4];
                                    *(char *)((int)__s + 0x68) = cVar10;
                                    if (cVar10 == 'A') {
                                        iVar4 = FUN_00028df0(puVar16 + 2);
                                        if (iVar4 == 0) {
                                            FUN_00074e00(
                                                3,
                                                "NeoClock4X(%d): error add "
                                                "peer to ntpd: %m",
                                                param_1);
                                            close(__fd);
                                            puVar16[7] = 0xffffffff;
                                            free((void *)*puVar16);
                                            *puVar16 = 0;
                                            uVar11 = 0;
                                        } else if ((ntp_syslogmask & 0x100) ==
                                                   0) {
                                            uVar11 = 1;
                                        } else {
                                            uVar11 = 1;
                                            FUN_00074e00(
                                                6,
                                                "NeoClock4X(%d): receiver "
                                                "setup successful done",
                                                param_1);
                                        }
                                        goto LAB_000605f4;
                                    }
                                }
                            }
                            uVar11 = 0;
                            FUN_00074e00(
                                2,
                                "NeoClock4X(%d): firmware version \"%c\" not "
                                "supported with this driver version!",
                                (int)sVar1, cVar10);
                            close(__fd);
                            puVar16[7] = 0xffffffff;
                            free((void *)*puVar16);
                            *puVar16 = 0;
                        }
                    }
                }
            }
        }
    }
LAB_000605f4:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar11);
    }
    return;
}

void FUN_000609c4(undefined4 *param_1, int param_2, int param_3, uint param_4)

{
    byte bVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;
    byte *pbVar5;
    int iVar6;

    iVar2 = __stack_chk_guard;
    iVar6 = param_1[3];
    if (param_2 < iVar6) {
        pbVar5 = (byte *)*param_1;
        iVar6 = 0;
        param_1[3] = 0;
        param_1[1] = pbVar5;
        uVar4 = (uint)*pbVar5;
        goto joined_r0x00060a00;
    }
    bVar1 = *(byte *)param_1[1];
    pbVar5 = (byte *)param_1[1];
    while (uVar4 = (uint)bVar1, iVar6 < param_2) {
    joined_r0x00060a00:
        if (uVar4 == 0)
            goto LAB_00060a58;
        if (uVar4 == 0x2c) {
            iVar6 = iVar6 + 1;
        }
        param_1[3] = iVar6;
        param_1[1] = pbVar5 + 1;
        bVar1 = pbVar5[1];
        pbVar5 = pbVar5 + 1;
    }
    if (uVar4 != 0) {
        uVar4 = param_3 - uVar4;
        if (uVar4 != 0) {
            uVar4 = 1;
        }
        if (uVar4 != ((param_4 ^ 1) & 1)) {
            uVar3 = 0;
            goto LAB_00060a5c;
        }
    }
LAB_00060a58:
    uVar3 = 3;
LAB_00060a5c:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

uint FUN_00060d0c(undefined4 param_1, int param_2)

{
    undefined4 uVar1;
    int iVar2;
    uint uVar3;
    undefined4 local_38;
    undefined4 uStack_34;
    undefined4 local_30;
    undefined4 uStack_2c;
    int local_24;
    undefined4 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    FUN_000758e8(&local_38, param_2 + -0xa8c0, 0);
    local_30 = local_38;
    uStack_2c = uStack_34;
    FUN_0007598c(&local_24, &local_30);
    uVar1 = FUN_000765b0(param_1);
    uVar1 = FUN_000757a8(local_20, uVar1, "comp");
    iVar2 = FUN_00075d94(param_1, uVar1);
    uVar3 = FUN_00075bf4(param_1,
                         "Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m" +
                             iVar2 + local_24 + 0x1c);
    if (local_1c == __stack_chk_guard) {
        return ~uVar3 >> 0x1f;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00060dcc(undefined2 *param_1, undefined4 *param_2, int param_3,
                  int param_4)

{
    char cVar1;
    char *__s;
    undefined4 uVar2;
    int iVar3;
    undefined2 local_24[2];
    int local_20;
    int local_1c;
    int local_18;
    int local_14;

    iVar3 = param_2[3];
    local_14 = __stack_chk_guard;
    if (param_3 < iVar3) {
        __s = (char *)*param_2;
        iVar3 = 0;
        param_2[3] = 0;
        param_2[1] = __s;
    LAB_00060e08:
        cVar1 = *__s;
        while (cVar1 != '\0') {
            __s = __s + 1;
            if (cVar1 == ',') {
                iVar3 = iVar3 + 1;
            }
            param_2[1] = __s;
            param_2[3] = iVar3;
            if (param_3 <= iVar3)
                break;
            cVar1 = *__s;
        }
    } else {
        __s = (char *)param_2[1];
        if (iVar3 < param_3)
            goto LAB_00060e08;
    }
    if (param_4 == 1) {
        iVar3 = sscanf(__s, "%2u,%2u,%4u%n", &local_1c, &local_20, local_24,
                       &local_18);
        if ((iVar3 == 3) && (local_18 == 10)) {
        LAB_00060eb4:
            if ((local_1c - 1U < 0x1f) && (local_20 - 1U < 0xc)) {
                uVar2 = 1;
                *(char *)((int)param_1 + 5) = (char)local_1c;
                *(char *)(param_1 + 2) = (char)local_20;
                *param_1 = local_24[0];
                goto LAB_00060e7c;
            }
        }
    } else {
        iVar3 = sscanf(__s, "%2u%2u%2u%n", &local_1c, &local_20, local_24,
                       &local_18);
        if ((iVar3 == 3) && (local_18 == 6))
            goto LAB_00060eb4;
    }
    uVar2 = 0;
LAB_00060e7c:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_00060f28(int param_1, uint *param_2, undefined4 *param_3, int param_4)

{
    char cVar1;
    char *__s;
    undefined4 uVar2;
    int iVar3;
    uint local_2c;
    uint local_28;
    uint local_24;
    int local_20;
    int local_1c;
    int local_18;
    int local_14;

    iVar3 = param_3[3];
    local_14 = __stack_chk_guard;
    if (param_4 < iVar3) {
        __s = (char *)*param_3;
        iVar3 = 0;
        param_3[3] = 0;
        param_3[1] = __s;
    } else {
        __s = (char *)param_3[1];
        if (param_4 <= iVar3)
            goto LAB_00060fa4;
    }
    cVar1 = *__s;
    while (cVar1 != '\0') {
        __s = __s + 1;
        if (cVar1 == ',') {
            iVar3 = iVar3 + 1;
        }
        param_3[1] = __s;
        param_3[3] = iVar3;
        if (param_4 <= iVar3)
            break;
        cVar1 = *__s;
    }
LAB_00060fa4:
    iVar3 = sscanf(__s, "%2u%2u%2u%n.%3lu%n", &local_2c, &local_28, &local_24,
                   &local_20, &local_18, &local_1c);
    if ((((iVar3 < 3) || (local_20 != 6)) || (0x17 < local_2c)) ||
        ((0x3b < local_28 || (0x3c < local_24)))) {
        uVar2 = 0;
    } else {
        *(char *)(param_1 + 6) = (char)local_2c;
        if (iVar3 != 4) {
            local_2c = 0;
        }
        *(char *)(param_1 + 7) = (char)local_28;
        *(char *)(param_1 + 8) = (char)local_24;
        if (iVar3 != 4) {
            uVar2 = 1;
            *param_2 = local_2c;
        } else {
            uVar2 = 1;
            *param_2 = local_18 * *(int *)(&DAT_000a9210 + (local_1c + -7) * 4);
        }
    }
    if (local_14 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_000610a0(int *param_1, uint param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    uint uVar2;
    char *pcVar3;
    char cVar4;
    int iVar5;
    int iVar6;
    uint *puVar7;
    uint auStack_c[3];

    iVar1 = __stack_chk_guard;
    auStack_c[2] = param_4;
    auStack_c[1] = param_3;
    auStack_c[0] = param_2;
    iVar6 = 8;
    puVar7 = auStack_c;
    do {
        uVar2 = *puVar7;
        if (uVar2 < 0x21) {
            iVar5 = param_1[3];
            if ((int)uVar2 < iVar5) {
                pcVar3 = (char *)*param_1;
                iVar5 = 0;
                param_1[3] = 0;
                param_1[1] = (int)pcVar3;
            } else {
                pcVar3 = (char *)param_1[1];
            }
            cVar4 = *pcVar3;
            while (iVar5 < (int)uVar2) {
                if (cVar4 == '\0')
                    goto LAB_00061140;
                if (cVar4 == ',') {
                    iVar5 = iVar5 + 1;
                }
                param_1[3] = iVar5;
                param_1[1] = (int)(pcVar3 + 1);
                cVar4 = pcVar3[1];
                pcVar3 = pcVar3 + 1;
            }
        } else {
            iVar5 = param_1[2];
            pcVar3 = (char *)(*param_1 + iVar5);
            if ((iVar5 < 3) || (pcVar3[-3] != '*')) {
                cVar4 = *(char *)(*param_1 + iVar5);
            } else {
                cVar4 = pcVar3[-2];
                pcVar3 = pcVar3 + -2;
            }
        }
        while (cVar4 != '\0' && (cVar4 - 0x2aU & 0xfd) != 0) {
            if (cVar4 != '.') {
                *pcVar3 = '_';
            }
            pcVar3 = pcVar3 + 1;
            cVar4 = *pcVar3;
        }
    LAB_00061140:
        uVar2 = ~uVar2 >> 0x1f;
        if (iVar6 == 0) {
            uVar2 = 0;
        }
        iVar6 = iVar6 + -1;
        puVar7 = puVar7 + 1;
        if (uVar2 == 0) {
            if (iVar1 != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            return;
        }
    } while (true);
}

void FUN_000611fc(undefined4 param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    char *pcVar3;
    addrinfo *paVar4;
    int iVar5;
    int *piVar6;
    undefined4 uVar7;
    char *local_bc;
    addrinfo *local_b4;
    undefined1 auStack_b0[8];
    undefined4 local_a8;
    undefined4 local_a4;
    char acStack_90[20];
    char acStack_7c[80];
    int local_2c;

    piVar6 = *(int **)(param_2 + 0x54);
    local_2c = __stack_chk_guard;
    iVar1 = FUN_00073ba4(0, 0x30, 0, 1);
    switch ((uint)(*(int *)(param_2 + 0x4c) << 0x19) >> 0x1d) {
    case 0:
        uVar7 = 0xc;
        local_bc = "4800";
        break;
    case 1:
        uVar7 = 0xd;
        local_bc = "9600";
        break;
    case 2:
        uVar7 = 0xe;
        local_bc = "19200";
        break;
    case 3:
        uVar7 = 0xf;
        local_bc = "38400";
        break;
    case 4:
        uVar7 = 0x1001;
        local_bc = "57600";
        break;
    case 5:
        uVar7 = 0x1002;
        local_bc = "115200";
        break;
    default:
        uVar7 = 0xc;
        local_bc = "4800 (fallback)";
    }
    *piVar6 = iVar1;
    piVar6[3] = (int)FUN_00061584;
    piVar6[5] = param_2;
    piVar6[7] = -1;
    piVar6[6] = 0;
    *(undefined1 *)(iVar1 + 0x28) = 2;
    *(undefined4 *)(iVar1 + 4) = 0xffffffff;
    *(undefined4 *)(iVar1 + 8) = 0xffffffff;
    *(undefined4 *)(iVar1 + 0x10) = 0;
    *(undefined4 *)(iVar1 + 0x14) = 0;
    *(undefined4 *)(iVar1 + 0x18) = 0;
    *(undefined4 *)(iVar1 + 0x1c) = 0;
    *(undefined4 *)(iVar1 + 0x20) = 0;
    *(undefined4 *)(iVar1 + 0x24) = 0;
    *(undefined1 *)(param_2 + 0x5f) = 0xf7;
    piVar6[0xbf] = 0x535047;
    piVar6[0xb] = (int)"NMEA GPS Clock";
    uVar2 = FUN_0007c054(acStack_90, 0x14, "/dev/gps%d", param_1);
    if (0x13 < uVar2) {
        pcVar3 = (char *)0x0;
        uVar7 = FUN_0007a3fc(param_2 + 0x10);
        FUN_00074e00(3, "%s clock device name too long", uVar7);
        goto LAB_00061354;
    }
    iVar1 = FUN_0004a298(acStack_90, uVar7, 1);
    piVar6[7] = iVar1;
    if (0 < iVar1) {
    LAB_00061330:
        if ((ntp_syslogmask & 0x100) != 0) {
            uVar7 = FUN_0007a3fc(param_2 + 0x10);
            FUN_00074e00(5, "%s serial %s open at %s bps", uVar7, acStack_90,
                         local_bc);
        }
        pcVar3 = (char *)FUN_00028df0(piVar6 + 2);
        if (pcVar3 != (char *)0x0) {
            pcVar3 = (char *)0x1;
        }
        goto LAB_00061354;
    }
    uVar2 = readlink(acStack_90, acStack_7c, 0x50);
    if (uVar2 < 0x50) {
        acStack_7c[uVar2] = '\0';
        pcVar3 = strchr(acStack_7c, 0x3a);
        if (pcVar3 != (char *)0x0) {
            *pcVar3 = '\0';
            paVar4 = (addrinfo *)memset(auStack_b0, 0, 0x20);
            local_a4 = 6;
            local_a8 = 1;
            iVar1 = getaddrinfo(acStack_7c, pcVar3 + 1, paVar4, &local_b4);
            if (iVar1 != 0)
                goto LAB_00061534;
            pcVar3 = (char *)0x0;
            paVar4 = local_b4;
            if (local_b4 != (addrinfo *)0x0) {
                do {
                    iVar1 = socket(paVar4->ai_family, paVar4->ai_socktype,
                                   paVar4->ai_protocol);
                    if (iVar1 != -1) {
                        iVar5 =
                            connect(iVar1, paVar4->ai_addr, paVar4->ai_addrlen);
                        if (iVar5 != -1) {
                            freeaddrinfo(local_b4);
                            piVar6[7] = iVar1;
                            goto LAB_00061330;
                        }
                        close(iVar1);
                    }
                    paVar4 = paVar4->ai_next;
                } while (paVar4 != (addrinfo *)0x0);
                freeaddrinfo(local_b4);
                piVar6[7] = -1;
                goto LAB_00061354;
            }
            freeaddrinfo((addrinfo *)0x0);
        }
        piVar6[7] = -1;
    } else {
    LAB_00061534:
        piVar6[7] = -1;
        pcVar3 = (char *)0x0;
    }
LAB_00061354:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pcVar3);
    }
    return;
}

/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_00061584(int param_1)

{
    short sVar1;
    undefined1 uVar2;
    ushort uVar3;
    uint __n;
    int iVar4;
    int iVar5;
    int iVar6;
    char *pcVar7;
    byte *__s1;
    uint uVar8;
    byte *pbVar9;
    uint uVar10;
    int iVar11;
    short sVar12;
    uint uVar13;
    int iVar14;
    byte bVar15;
    uint uVar16;
    uint uVar17;
    int iVar18;
    int iVar19;
    undefined4 uVar20;
    char *pcVar21;
    char *pcVar22;
    undefined4 *puVar23;
    bool bVar24;
    bool bVar25;
    double dVar26;
    undefined8 uVar27;
    int local_138;
    int local_130;
    byte **local_12c;
    uint local_108;
    undefined4 uStack_104;
    uint local_100;
    undefined4 uStack_fc;
    undefined4 local_f4;
    char *local_f0;
    int local_ec;
    int local_e8;
    uint local_e4;
    undefined4 local_e0;
    uint local_dc;
    undefined4 local_d8;
    undefined2 local_d4;
    uint local_d0;
    char *local_cc;
    byte *local_c4;
    byte *local_c0;
    uint local_bc;
    undefined4 local_b8;
    byte local_b4[128];
    int local_34;

    iVar19 = *(int *)(param_1 + 4);
    puVar23 = *(undefined4 **)(iVar19 + 0x54);
    local_34 = __stack_chk_guard;
    pcVar22 = (char *)*puVar23;
    local_dc = 0;
    local_d8 = 0;
    local_d4 = 0;
    local_e8 = 0;
    local_ec = 0;
    local_e4 = 0;
    local_e0 = 0;
    __n = FUN_00049ee4(param_1, local_b4, 0x80);
    uVar16 = __n & ~((int)__n >> 0x1f);
    local_b4[uVar16] = 0;
    local_b8 = 0;
    local_c4 = local_b4;
    local_c0 = local_b4;
    local_bc = uVar16;
    if (local_b4[0] == 0)
        goto LAB_00061634;
    if (local_b4[0] == 0x24) {
        uVar13 = (uint)local_b4[1];
        local_bc = uVar16 - 1;
        __s1 = local_b4 + 1;
        local_c4 = __s1;
        local_c0 = __s1;
        if (uVar13 - 0x41 < 0x1a) {
            uVar17 = (uint)local_b4[2];
            uVar8 = uVar17 - 0x30;
            bVar25 = 8 < uVar8;
            bVar24 = uVar8 == 9;
            if (9 < uVar8) {
                bVar25 = 0x18 < uVar17 - 0x41;
                bVar24 = uVar17 - 0x41 == 0x19;
            }
            pbVar9 = local_b4 + 2;
            if (!bVar25 || bVar24) {
                do {
                    uVar13 = uVar13 ^ uVar17;
                    pbVar9 = pbVar9 + 1;
                    uVar17 = (uint)*pbVar9;
                    uVar8 = uVar17 - 0x30;
                    bVar25 = 8 < uVar8;
                    bVar24 = uVar8 == 9;
                    if (9 < uVar8) {
                        bVar25 = 0x18 < uVar17 - 0x41;
                        bVar24 = uVar17 - 0x41 == 0x19;
                    }
                } while (!bVar25 || bVar24);
            }
            if ((uVar17 == 0x2c) && (4 < (int)pbVar9 - (int)__s1)) {
                uVar8 = (uint)pbVar9[1];
                uVar13 = uVar13 ^ 0x2c;
                pbVar9 = pbVar9 + 1;
                if (uVar8 != 0x2a && uVar8 != 0) {
                    do {
                        uVar13 = uVar13 ^ uVar8;
                        pbVar9 = pbVar9 + 1;
                        uVar8 = (uint)*pbVar9;
                    } while (uVar8 != 0 && uVar8 != 0x2a);
                }
                if (uVar8 == 0) {
                    bVar15 = 1;
                LAB_00061784:
                    pbVar9 = local_b4 + 3;
                    *(int *)(pcVar22 + 0x10) = *(int *)(pcVar22 + 0x10) + 1;
                    iVar4 = strncmp((char *)pbVar9, "RMC,", 4);
                    if (iVar4 == 0) {
                    LAB_00061970:
                        uVar16 = *(uint *)(iVar19 + 0x4c);
                        local_130 = iVar4;
                    } else {
                        iVar4 = strncmp((char *)pbVar9, "GGA,", 4);
                        if (iVar4 == 0) {
                            iVar4 = 1;
                            local_130 = 1;
                        } else {
                            iVar4 = strncmp((char *)pbVar9, "GLL,", 4);
                            if (iVar4 == 0) {
                                iVar4 = 2;
                                local_130 = 2;
                            } else {
                                iVar4 = strncmp((char *)pbVar9, "ZDA,", 4);
                                if (iVar4 == 0) {
                                    iVar4 = 3;
                                    local_130 = 3;
                                } else {
                                    iVar4 = strncmp((char *)pbVar9, "ZDG,", 4);
                                    if (iVar4 == 0) {
                                        iVar4 = 4;
                                        goto LAB_00061970;
                                    }
                                    iVar4 = strncmp((char *)__s1, "PGRMF,", 6);
                                    if (iVar4 != 0)
                                        goto LAB_00061634;
                                    iVar4 = 5;
                                    local_130 = 5;
                                }
                            }
                        }
                        uVar16 = *(uint *)(iVar19 + 0x4c);
                    }
                    if ((uVar16 & 0x80) != 0) {
                        dVar26 = ldexp((double)local_f0, -0x20);
                        pcVar7 = strchr((char *)local_b4, 0x2c);
                        FUN_00052050(iVar19 + 0x10, "delay %0.6f %.*s",
                                     SUB84(dVar26, 0),
                                     (int)((ulonglong)dVar26 >> 0x20),
                                     (int)pcVar7 - (int)local_b4, local_b4);
                        uVar16 = *(uint *)(iVar19 + 0x4c);
                    }
                    if (((uVar16 & 0xff0f) == 0) ||
                        ((uVar16 & *(uint *)(&DAT_000a9228 + iVar4 * 4)) !=
                         0)) {
                        if (bVar15 < (byte)pcVar22[iVar4 + 0x28]) {
                            FUN_000494a0(iVar19, 2);
                            *(int *)(pcVar22 + 0x1c) =
                                *(int *)(pcVar22 + 0x1c) + 1;
                            goto LAB_00061634;
                        }
                        pcVar22[iVar4 + 0x28] = bVar15;
                        if (*pcVar22 == '\0') {
                            switch (local_130) {
                            case 1:
                                local_138 = FUN_00060f28(&local_dc, &local_e8,
                                                         &local_c4, 1);
                                uVar2 = FUN_000609c4(&local_c4, 6, 0x30, 1);
                                *(undefined1 *)(puVar23 + 10) = uVar2;
                                iVar4 = FUN_00060d0c(&local_dc, local_f4);
                                if ((*(byte *)(puVar23 + 0xc0) & 8) != 0) {
                                    FUN_000610a0(&local_c4, 2, 4, 0xffffffff);
                                }
                                break;
                            case 2:
                                local_138 = FUN_00060f28(&local_dc, &local_e8,
                                                         &local_c4, 5);
                                uVar2 = FUN_000609c4(&local_c4, 6, 0x41, 0);
                                *(undefined1 *)(puVar23 + 10) = uVar2;
                                iVar4 = FUN_00060d0c(&local_dc, local_f4);
                                if ((*(byte *)(puVar23 + 0xc0) & 8) != 0) {
                                    FUN_000610a0(&local_c4, 1, 3, 0xffffffff);
                                }
                                break;
                            case 3:
                                *(undefined1 *)(puVar23 + 10) = 0;
                                local_138 = FUN_00060f28(&local_dc, &local_e8,
                                                         &local_c4, 1);
                                iVar4 =
                                    FUN_00060dcc(&local_dc, &local_c4, 2, 1);
                                break;
                            case 4:
                                goto LAB_000618bc;
                            case 5:
                                if (local_b8 < 2) {
                                    if (local_b8 != 1)
                                        goto LAB_00061e78;
                                } else {
                                    local_b8 = 0;
                                    local_c0 = local_c4;
                                LAB_00061e78:
                                    bVar15 = *local_c0;
                                    while (bVar15 != 0) {
                                        local_c0 = local_c0 + 1;
                                        if (bVar15 == 0x2c) {
                                            local_b8 = local_b8 + 1;
                                        }
                                        if (local_b8 == 1)
                                            break;
                                        bVar15 = *local_c0;
                                    }
                                }
                                iVar4 =
                                    sscanf((char *)local_c0, "%hu", &local_e0);
                                if (local_b8 < 3) {
                                    if (local_b8 != 2)
                                        goto LAB_00061ee4;
                                } else {
                                    local_b8 = 0;
                                    local_c0 = local_c4;
                                LAB_00061ee4:
                                    bVar15 = *local_c0;
                                    while (bVar15 != 0) {
                                        local_c0 = local_c0 + 1;
                                        if (bVar15 == 0x2c) {
                                            local_b8 = local_b8 + 1;
                                        }
                                        if (local_b8 == 2)
                                            break;
                                        bVar15 = *local_c0;
                                    }
                                }
                                iVar14 =
                                    sscanf((char *)local_c0, "%lu", &local_d0);
                                if (local_b8 < 6) {
                                    if (local_b8 != 5)
                                        goto LAB_00061f50;
                                } else {
                                    local_b8 = 0;
                                    local_c0 = local_c4;
                                LAB_00061f50:
                                    bVar15 = *local_c0;
                                    while (bVar15 != 0) {
                                        local_c0 = local_c0 + 1;
                                        if (bVar15 == 0x2c) {
                                            local_b8 = local_b8 + 1;
                                        }
                                        if (local_b8 == 5)
                                            break;
                                        bVar15 = *local_c0;
                                    }
                                }
                                iVar5 = sscanf((char *)local_c0, "%hd",
                                               (int)&local_e0 + 2);
                                if (((iVar4 + iVar14 + iVar5 == 3) &&
                                     ((ushort)local_e0 < 0x400)) &&
                                    (local_d0 < 0x93a80)) {
                                    local_e4 = local_d0;
                                    iVar4 = FUN_00060dcc(&local_dc, &local_c4,
                                                         3, 0);
                                    if (iVar4 == 0)
                                        goto LAB_00061fb0;
                                    local_138 = FUN_00060f28(
                                        &local_dc, &local_e8, &local_c4, 4);
                                    uVar2 =
                                        FUN_000609c4(&local_c4, 0xb, 0x30, 1);
                                    *(undefined1 *)(puVar23 + 10) = uVar2;
                                    iVar14 = FUN_000765b0(&local_dc);
                                    uVar16 = local_dc & 0xffff;
                                    iVar4 = local_e0._2_2_ + iVar14 >> 0x1f;
                                    if (0x1517f < local_e0._2_2_ + iVar14) {
                                        iVar4 = iVar4 + 1;
                                    }
                                    uVar3 = *(ushort *)(pcVar22 + 2);
                                    iVar14 = 5;
                                    do {
                                        if (uVar3 - 0x13 < 5) {
                                            sVar12 = uVar3 * 100;
                                        } else {
                                            sVar12 = 0x76c;
                                            pcVar22[2] = '\x13';
                                            pcVar22[3] = '\0';
                                        }
                                        sVar1 = (short)(uVar16 % 100);
                                        local_dc = CONCAT22(local_dc._2_2_,
                                                            sVar1 + sVar12);
                                        iVar5 = FUN_00076428(&local_dc);
                                        iVar5 = iVar5 + -0xb0783 + iVar4;
                                        if ((-1 < iVar5) &&
                                            ((local_e0 & 0xffff) ==
                                             (iVar5 / 7 & 0x3ffU))) {
                                            iVar4 = 1;
                                            goto LAB_00061fe8;
                                        }
                                        iVar14 = iVar14 + -1;
                                        uVar3 = *(short *)(pcVar22 + 2) + 1;
                                        *(ushort *)(pcVar22 + 2) = uVar3;
                                    } while (iVar14 != 0);
                                    local_dc = CONCAT22(local_dc._2_2_, sVar1);
                                    iVar4 = 0;
                                } else {
                                LAB_00061fb0:
                                    local_12c = &local_c4;
                                    local_138 = FUN_00060f28(
                                        &local_dc, &local_e8, local_12c, 4);
                                    iVar4 = 0;
                                    uVar2 =
                                        FUN_000609c4(local_12c, 0xb, 0x30, 1);
                                    *(undefined1 *)(puVar23 + 10) = uVar2;
                                }
                            LAB_00061fe8:
                                local_12c = &local_c4;
                                if ((*(byte *)(puVar23 + 0xc0) & 8) != 0) {
                                    FUN_000610a0(local_12c, 6, 8, 0xffffffff);
                                }
                                break;
                            default:
                                local_138 = FUN_00060f28(&local_dc, &local_e8,
                                                         &local_c4, 1);
                                uVar2 = FUN_000609c4(&local_c4, 2, 0x41, 0);
                                *(undefined1 *)(puVar23 + 10) = uVar2;
                                iVar4 =
                                    FUN_00060dcc(&local_dc, &local_c4, 9, 0);
                                if (iVar4 != 0) {
                                    FUN_00076750(&local_d0, local_f4, 0);
                                    iVar4 = (local_d0 & 0xffff) - 0x14;
                                    if (iVar4 < DAT_000cd5f4) {
                                        iVar4 = DAT_000cd5f4;
                                    }
                                    uVar3 = FUN_000757a8(
                                        iVar4, local_dc & 0xffff, 100);
                                    local_dc = CONCAT22(local_dc._2_2_, uVar3);
                                    if (((int)(uint)uVar3 < iVar4) ||
                                        (iVar4 + 99 < (int)(uint)uVar3)) {
                                        iVar4 = 0;
                                    } else {
                                        iVar4 = 1;
                                    }
                                }
                                if ((*(byte *)(puVar23 + 0xc0) & 8) != 0) {
                                    FUN_000610a0(&local_c4, 3, 4, 5, 6,
                                                 0xffffffff);
                                }
                            }
                        } else {
                            if (local_130 != 4)
                                goto LAB_0006187c;
                        LAB_000618bc:
                            local_138 = FUN_00060f28(&local_dc, &local_e8,
                                                     &local_c4, 1);
                            iVar4 = FUN_00060dcc(&local_dc, &local_c4, 2, 1);
                            uVar2 = FUN_000609c4(&local_c4, 4, 0x30, 1);
                            *(undefined1 *)(puVar23 + 10) = uVar2;
                            local_ec = -1;
                        }
                        if (local_138 == 0) {
                            uVar20 = 6;
                            *(int *)(pcVar22 + 0x1c) =
                                *(int *)(pcVar22 + 0x1c) + 1;
                        } else if (iVar4 == 0) {
                            uVar20 = 5;
                            *(int *)(pcVar22 + 0x1c) =
                                *(int *)(pcVar22 + 0x1c) + 1;
                        } else {
                            if (*(char *)(puVar23 + 10) != '\x03') {
                                if (*pcVar22 == '\0' && local_130 == 4) {
                                    uVar20 = FUN_0007a3fc(iVar19 + 0x10);
                                    FUN_00074e00(
                                        6,
                                        "%s using GPS time as if it were UTC",
                                        uVar20);
                                    *pcVar22 = '\x01';
                                }
                                iVar18 = **(int **)(iVar19 + 0x54);
                                iVar5 = FUN_000765b0(&local_dc);
                                iVar6 = FUN_00076428(&local_dc);
                                iVar6 = iVar6 + -0xa955c;
                                iVar14 = local_e8;
                                iVar4 = local_ec;
                                if (local_e8 < 0) {
                                    do {
                                        iVar14 = iVar14 + 1000000000;
                                        iVar4 = iVar4 + -1;
                                    } while (iVar14 < 0);
                                } else if (999999999 < local_e8) {
                                    iVar14 = local_e8 + -1000000000;
                                    if (iVar14 < 1000000000) {
                                        iVar11 = local_e8;
                                        iVar4 = local_ec + 1;
                                    } else {
                                        iVar11 = local_e8 + -0x77360000;
                                    }
                                    if (iVar14 != 999999999 &&
                                        local_e8 + -1999999999 < 0 ==
                                            SBORROW4(iVar14, 999999999)) {
                                        iVar4 = iVar4 + 2;
                                        iVar14 = iVar11 + 0x6c00;
                                    }
                                }
                                pcVar21 = (char *)(iVar5 + iVar4);
                                pcVar7 = (char *)FUN_0009bfd0(500000000, iVar14,
                                                              1000000000, 0);
                                if ((*(uint *)(iVar19 + 0x4c) & 0x2000000) ==
                                    0) {
                                    if ((int)pcVar21 < 0x15180) {
                                        for (; (int)pcVar21 < 0;
                                             pcVar21 = "drift_comp" +
                                                       (int)(pcVar21 + 6)) {
                                            iVar6 = iVar6 + -1;
                                        }
                                    } else {
                                        do {
                                            iVar6 = iVar6 + 1;
                                            pcVar21 = pcVar21 + -0x15180;
                                        } while (0x1517f < (int)pcVar21);
                                    }
                                    FUN_000758e8(&local_108, local_f4, 0);
                                    local_100 = local_108;
                                    uStack_fc = uStack_104;
                                    FUN_0007598c(&local_d0, &local_100);
                                    iVar4 = local_d0 - 0xe00;
                                    if ((local_cc != pcVar21 &&
                                         (int)pcVar21 <= (int)local_cc) ||
                                        ((local_cc == pcVar21 &&
                                          (pcVar7 < local_f0)))) {
                                        iVar4 = local_d0 - 0xdff;
                                    }
                                    if (iVar4 < DAT_000cd5f0) {
                                        iVar4 = DAT_000cd5f0;
                                    }
                                    iVar14 = FUN_000757a8(iVar4, iVar6, 0x1c00);
                                    iVar4 = (iVar14 - iVar6) / 7;
                                    if ((iVar4 != *(short *)(iVar18 + 0xc)) &&
                                        (*(short *)(iVar18 + 0xc) =
                                             (short)iVar4,
                                         (ntp_syslogmask & 0x100) != 0)) {
                                        uVar20 = FUN_0007a3fc(iVar19 + 0x10);
                                        FUN_00074e00(6,
                                                     "%s Changed GPS epoch "
                                                     "warp to %d weeks",
                                                     uVar20, iVar4);
                                    }
                                    FUN_00076038(&local_108, iVar14, pcVar21);
                                } else {
                                    FUN_00076038(&local_108, iVar6, pcVar21);
                                }
                                if ((*(uint *)(pcVar22 + 4) != local_108) ||
                                    (*(char **)(pcVar22 + 8) != pcVar7)) {
                                    if (0x7e < __n) {
                                        __n = 0x7f;
                                    }
                                    uVar27 = *(undefined8 *)(puVar23 + 0xbc);
                                    *(uint *)(pcVar22 + 4) = local_108;
                                    *(int *)(pcVar22 + 0x14) =
                                        *(int *)(pcVar22 + 0x14) + 1;
                                    *(char **)(pcVar22 + 8) = pcVar7;
                                    puVar23[0x2e] = __n;
                                    memcpy(puVar23 + 0xe, local_b4, __n);
                                    *(undefined1 *)((int)puVar23 + __n + 0x38) =
                                        0;
                                    puVar23[0x3a] = local_f4;
                                    puVar23[0x3b] = local_f0;
                                    local_d0 = local_108;
                                    local_cc = pcVar7;
                                    FUN_00049a70((int)uVar27, puVar23,
                                                 local_108, pcVar7, local_f4,
                                                 local_f0);
                                    goto LAB_00061634;
                                }
                                goto LAB_0006187c;
                            }
                            uVar20 = 2;
                            *(int *)(pcVar22 + 0x18) =
                                *(int *)(pcVar22 + 0x18) + 1;
                        }
                        if (0x7e < __n) {
                            __n = 0x7f;
                        }
                        puVar23[0x2e] = __n;
                        memcpy(puVar23 + 0xe, local_b4, __n);
                        *(undefined1 *)((int)puVar23 + __n + 0x38) = 0;
                        FUN_000494a0(iVar19, uVar20);
                    } else {
                    LAB_0006187c:
                        *(int *)(pcVar22 + 0x20) = *(int *)(pcVar22 + 0x20) + 1;
                    }
                    goto LAB_00061634;
                }
                if (((uVar8 == 0x2a) && (local_b4 + (uVar16 - 3) == pbVar9)) &&
                    ((int)pbVar9 - (int)__s1 < 0x50)) {
                    uVar8 = (uint)local_b4[uVar16 - 2];
                    pbVar9 = local_b4 + (uVar16 - 2);
                    if (uVar8 == 0) {
                        uVar17 = 0;
                    } else {
                        uVar17 = 0;
                        do {
                            uVar10 = uVar8 - 0x30 & 0xff;
                            if (uVar10 < 10) {
                                uVar10 = uVar10 + uVar17 * 0x10;
                            } else {
                                if (5 < uVar8 - 0x41)
                                    break;
                                uVar10 = (uVar8 - 0x37) + uVar17 * 0x10;
                            }
                            uVar17 = uVar10 & 0xff;
                            pbVar9 = pbVar9 + 1;
                            uVar8 = (uint)*pbVar9;
                        } while (uVar8 != 0);
                    }
                    if (uVar17 == uVar13 && local_b4 + uVar16 == pbVar9) {
                        bVar15 = 2;
                        goto LAB_00061784;
                    }
                }
            }
        }
    }
    local_c4 = local_c0;
    FUN_000494a0(iVar19, 2);
LAB_00061634:
    if (local_34 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000623a0(short *param_1, int param_2)

{
    short sVar1;
    int iVar2;

    iVar2 = __stack_chk_guard;
    sVar1 = *param_1;
    *param_1 = sVar1 + 1;
    *(undefined1 *)(*(int *)(param_1 + 2) + (int)sVar1) = 0x10;
    sVar1 = *param_1;
    *param_1 = sVar1 + 1;
    *(undefined1 *)(*(int *)(param_1 + 2) + (int)sVar1) = 3;
    if (iVar2 == __stack_chk_guard) {
        write(param_2, *(void **)(param_1 + 2), (int)*param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000624a8(uint *param_1, uint *param_2, byte *param_3)

{
    int iVar1;
    uint uVar2;
    ushort local_30;
    ushort local_2e;
    undefined2 local_2c;
    int local_24;

    local_24 = __stack_chk_guard;
    if (DAT_000cd5f8 == 0) {
        iVar1 = FUN_0007568c(&local_30);
        if (iVar1 == 0) {
            local_2c = 0x101;
            local_30 = 0x7df;
        }
        DAT_000cd5f8 = FUN_00076428(&local_30);
    }
    local_2c._0_1_ = param_3[1];
    local_2c._1_1_ = *param_3;
    local_30 = CONCAT11(param_3[2], param_3[3]);
    iVar1 = FUN_00076428(&local_30);
    FUN_00075bf4(&local_30, iVar1);
    if (((local_2c._1_1_ == *param_3) && ((byte)local_2c == param_3[1])) &&
        (local_30 == CONCAT11(param_3[2], param_3[3]))) {
        for (; iVar1 < DAT_000cd5f8; iVar1 = iVar1 + 0x1c00) {
        }
        FUN_00075bf4(&local_30, iVar1);
        uVar2 = (uint)local_2c._1_1_ | (uint)(byte)local_2c << 5;
        *param_2 = (uint)local_2e;
        *param_1 = (uint)local_30;
    } else {
        uVar2 = 0xffffffff;
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_00062a04(int param_1)

{
    char cVar1;
    byte bVar2;
    int iVar3;
    undefined4 uVar4;
    uint uVar5;
    int iVar6;
    uint uVar7;
    undefined1 uVar8;
    int *piVar9;
    int iVar10;
    int iVar11;
    bool bVar12;
    bool bVar13;
    double dVar14;

    iVar3 = __stack_chk_guard;
    piVar9 = *(int **)(param_1 + 0x54);
    iVar10 = *piVar9;
    iVar6 = *(int *)(iVar10 + 0x8c);
    cVar1 = *(char *)(iVar10 + 0xc);
    if ((iVar6 - 2U < 2) ||
        (cVar1 != 'm' &&
         (cVar1 != 'K' && (cVar1 != 'T' && (cVar1 != 'F' && cVar1 != 'A'))))) {
        if (cVar1 == -0x71) {
            uVar5 = ((*(byte *)(piVar9 + 0xc0) ^ 2) << 0x1e) >> 0x1f;
            if (*(short *)(iVar10 + 0xe) != 0) {
                uVar5 = 0;
            }
            if (uVar5 == 0) {
                bVar2 = *(byte *)(iVar10 + 0xd);
                if (bVar2 == 0xab) {
                    if (*(short *)(iVar10 + 10) == 0x11) {
                        if (*(int *)(iVar10 + 4) < 1)
                            goto LAB_00062a74;
                        if (*(short *)(iVar10 + 0x14) != 0) {
                            if ((*(byte *)(iVar10 + 0x16) & 0x1d) == 0) {
                            LAB_00062e2c:
                                *(undefined1 *)(piVar9 + 10) = 3;
                                goto LAB_00062af8;
                            }
                            piVar9[0x34] = 0;
                            iVar6 = FUN_000624a8(piVar9 + 0x2f, piVar9 + 0x30,
                                                 iVar10 + 0x1a);
                            if (-1 < iVar6) {
                                uVar4 = 1;
                                piVar9[0x31] = (uint) * (byte *)(iVar10 + 0x19);
                                piVar9[0x32] = (uint) * (byte *)(iVar10 + 0x18);
                                piVar9[0x33] = (uint) * (byte *)(iVar10 + 0x17);
                                goto LAB_00062a78;
                            }
                        }
                    }
                    goto LAB_00062c2c;
                }
                if (bVar2 < 0xac) {
                    if ((bVar2 == 0xb) && (0 < *(int *)(iVar10 + 4))) {
                        if ((*(short *)(iVar10 + 10) == 0x4a) &&
                            (*(short *)(iVar10 + 0x1d) != 0)) {
                            uVar7 = *(uint *)(iVar10 + 0x14);
                            uVar5 = *(uint *)(iVar10 + 0x10);
                            dVar14 = (double)CONCAT44(
                                uVar5 << 0x18 | (uVar5 >> 8 & 0xff) << 0x10 |
                                    (uVar5 >> 0x10 & 0xff) << 8 | uVar5 >> 0x18,
                                uVar7 << 0x18 | (uVar7 >> 8 & 0xff) << 0x10 |
                                    (uVar7 >> 0x10 & 0xff) << 8 |
                                    uVar7 >> 0x18);
                            iVar6 = (int)(longlong)dVar14;
                            iVar11 = iVar6 % 0x15180;
                            piVar9[0x34] =
                                (int)(longlong)((dVar14 -
                                                 (double)(longlong)iVar6) *
                                                1000000000.0);
                            iVar6 = iVar11 % 0xe10;
                            piVar9[0x31] = iVar11 / 0xe10;
                            piVar9[0x32] = iVar6 / 0x3c;
                            piVar9[0x33] = iVar6 % 0x3c;
                            iVar6 = FUN_000624a8(piVar9 + 0x2f, piVar9 + 0x30,
                                                 iVar10 + 0x18);
                            if (-1 < iVar6) {
                                if (*(char *)(iVar10 + 8) == '\0') {
                                    uVar4 = 2;
                                } else {
                                    uVar4 = 0;
                                    *(undefined1 *)(iVar10 + 8) = 0;
                                }
                                goto LAB_00062a78;
                            }
                        }
                        goto LAB_00062c2c;
                    }
                } else if (bVar2 == 0xac) {
                    if (0 < *(int *)(iVar10 + 4)) {
                        if (*(short *)(iVar10 + 10) == 0x44) {
                            if (((*(ushort *)(iVar10 + 0x17) >> 8 & 0x80) ==
                                 0) ||
                                (*(int *)(iVar10 + 0x90) != 0xc &&
                                 *(int *)(iVar10 + 0x90) != 6)) {
                                uVar4 = 0;
                                *(undefined1 *)(piVar9 + 10) = 0;
                            } else {
                                *(undefined1 *)(piVar9 + 10) = 1;
                                uVar4 = 0;
                            }
                            goto LAB_00062a78;
                        }
                        goto LAB_00062c2c;
                    }
                } else if (bVar2 == 0xad) {
                    if (*(short *)(iVar10 + 10) != 0x16)
                        goto LAB_00062c2c;
                    *(undefined1 *)(iVar10 + 8) =
                        *(undefined1 *)(iVar10 + 0x20);
                    if (*(int *)(iVar10 + 4) < 1)
                        goto LAB_00062a74;
                    uVar5 = (uint) * (byte *)(iVar10 + 0x1f);
                    if (uVar5 < 0xf) {
                        bVar13 = uVar5 != 0xb;
                        bVar12 = uVar5 - 0xb == 1;
                        if (1 < uVar5 - 0xb) {
                            bVar13 = 4 < uVar5 - 2;
                            bVar12 = uVar5 - 2 == 5;
                        }
                        if (!bVar13 || bVar12)
                            goto LAB_00062af8;
                    }
                    iVar6 = FUN_000624a8(piVar9 + 0x2f, piVar9 + 0x30,
                                         iVar10 + 0x1b);
                    if (iVar6 < 0)
                        goto LAB_00062c2c;
                    bVar2 = *(byte *)(iVar10 + 8);
                    iVar6 = iVar6 >> 5;
                    *(int *)(iVar10 + 0x90) = iVar6;
                    if ((bVar2 & 2) == 0) {
                        if (bVar2 == 0)
                            goto LAB_00062e2c;
                    LAB_00062bc4:
                        *(undefined1 *)(piVar9 + 10) = 0;
                    } else {
                        if (iVar6 != 0xc && iVar6 != 6)
                            goto LAB_00062bc4;
                        bVar12 = (bVar2 & 1) != 0;
                        if (bVar12) {
                            iVar6 = 1;
                        }
                        uVar8 = (undefined1)iVar6;
                        if (!bVar12) {
                            uVar8 = 2;
                        }
                        *(undefined1 *)(piVar9 + 10) = uVar8;
                    }
                    uVar5 = *(uint *)(iVar10 + 0x14);
                    uVar7 = *(uint *)(iVar10 + 0x10);
                    uVar4 = 1;
                    piVar9[0x34] =
                        (int)(longlong)((double)CONCAT44(
                                            uVar7 << 0x18 |
                                                (uVar7 >> 8 & 0xff) << 0x10 |
                                                (uVar7 >> 0x10 & 0xff) << 8 |
                                                uVar7 >> 0x18,
                                            uVar5 << 0x18 |
                                                (uVar5 >> 8 & 0xff) << 0x10 |
                                                (uVar5 >> 0x10 & 0xff) << 8 |
                                                uVar5 >> 0x18) *
                                        1000000000.0);
                    piVar9[0x31] = (uint) * (byte *)(iVar10 + 0x18);
                    piVar9[0x32] = (uint) * (byte *)(iVar10 + 0x19);
                    piVar9[0x33] = (uint) * (byte *)(iVar10 + 0x1a);
                    goto LAB_00062a78;
                }
            }
        } else if (cVar1 == 'B') {
            puts("0x42");
        } else {
            if (cVar1 == 'C') {
                puts("0x43");
                uVar4 = 0;
                goto LAB_00062a78;
            }
            if (iVar6 == 2 && cVar1 == 'A') {
                puts("Undocumented 0x41 packet on Thunderbolt");
                uVar4 = 0;
                goto LAB_00062a78;
            }
            if (cVar1 != 'A' || iVar6 != 3) {
                if (cVar1 != 'F' || iVar6 != 3) {
                    if (cVar1 == 'T' || cVar1 == 'm')
                        goto LAB_00062a74;
                } else if (*(char *)(iVar10 + 0xe) != '\0') {
                LAB_00062af8:
                    FUN_000494a0(param_1, 6);
                    uVar4 = 0;
                    *(undefined4 *)(iVar10 + 4) = 0xffffffff;
                    goto LAB_00062a78;
                }
            LAB_00062c2c:
                FUN_000494a0(param_1, 2);
                uVar4 = 0;
                *(undefined4 *)(iVar10 + 4) = 0xffffffff;
                goto LAB_00062a78;
            }
        }
    }
LAB_00062a74:
    uVar4 = 0;
LAB_00062a78:
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar4);
    }
    return;
}

void FUN_00062e7c(undefined4 *param_1)

{
    int iVar1;
    undefined4 uVar2;
    short *psVar3;
    uint local_20;
    int local_1c;

    psVar3 = (short *)*param_1;
    local_1c = __stack_chk_guard;
    iVar1 = ioctl(param_1[7], 0x5415, &local_20);
    if (iVar1 < 0) {
        FUN_00074e00(3, "Palisade(%d) HW_poll: ioctl(fd,GET): %m",
                     (int)*psVar3);
        uVar2 = 0xffffffff;
    } else {
        iVar1 = param_1[7];
        local_20 = local_20 | 4;
        if (*(int *)(psVar3 + 0x46) == 3) {
            write(iVar1, &DAT_000a7f7c, 1);
            iVar1 = param_1[7];
        }
        iVar1 = ioctl(iVar1, 0x5418, &local_20);
        if (iVar1 < 0) {
            FUN_00074e00(3, "Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m",
                         (int)*psVar3);
            uVar2 = 0xffffffff;
        } else {
            local_20 = local_20 & 0xfffffffb;
            FUN_0006f724(param_1 + 0x3a);
            iVar1 = ioctl(param_1[7], 0x5418, &local_20);
            if (iVar1 == -1) {
                FUN_00074e00(
                    3, "Palisade(%d) HW_poll: ioctl(fd, UNSET, RTS_off): %m",
                    (int)*psVar3);
                uVar2 = 0xffffffff;
            } else {
                uVar2 = 0;
            }
        }
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_00062fc4(undefined4 param_1, int param_2)

{
    int iVar1;
    ssize_t sVar2;
    int iVar3;
    int *piVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    piVar4 = *(int **)(param_2 + 0x54);
    iVar5 = *piVar4;
    iVar3 = *(int *)(iVar5 + 4);
    piVar4[0xc2] = piVar4[0xc2] + 1;
    if (0 < iVar3) {
        FUN_000494a0(param_2, 1);
    }
    *(undefined4 *)(iVar5 + 4) = 2;
    if ((*(byte *)(piVar4 + 0xc0) & 2) == 0) {
        if (*(int *)(iVar5 + 0x8c) == 1) {
            sVar2 = write(*(int *)(*(int *)(param_2 + 0x54) + 0x1c),
                          "SPSTAT\r\n", 8);
            if (-1 < sVar2) {
                praecis_msg = 1;
                goto LAB_00063048;
            }
            FUN_00074e00(3, "Palisade(%d) write: %m:", param_1);
        }
        iVar3 = FUN_00062e7c(piVar4);
        if (iVar3 < 0) {
            if (iVar1 == __stack_chk_guard) {
                FUN_000494a0(param_2, 3);
                return;
            }
            goto LAB_000630cc;
        }
    }
LAB_00063048:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_000630cc:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000630e4(int param_1)

{
    short sVar1;
    char cVar2;
    char cVar3;
    short sVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    char *__src;
    char *pcVar9;
    char *pcVar10;
    int *piVar11;
    int iVar12;
    int *piVar13;

    iVar5 = __stack_chk_guard;
    iVar7 = DAT_000cd5fc;
    iVar12 = *(int *)(param_1 + 4);
    __src = (char *)(param_1 + 0x58);
    piVar13 = *(int **)(iVar12 + 0x54);
    iVar8 = *piVar13;
    if ((*(int *)(iVar8 + 0x8c) != 1) || (praecis_msg == 0)) {
        pcVar10 = __src + *(size_t *)(param_1 + 0x54);
    joined_r0x00063134:
        pcVar9 = __src;
        if (pcVar10 != __src) {
            do {
                cVar2 = *(char *)(iVar8 + 9);
                __src = pcVar9 + 1;
                cVar3 = *pcVar9;
                if (cVar2 == '\x03') {
                    iVar7 = (int)*(short *)(iVar8 + 10);
                    if (cVar3 == '\x10') {
                        *(undefined1 *)(iVar8 + 9) = 4;
                    } else {
                        sVar1 = *(short *)(iVar8 + 10) + 1;
                        iVar6 = iVar8 + iVar7;
                        iVar7 = (int)sVar1;
                        *(short *)(iVar8 + 10) = sVar1;
                        *(char *)(iVar6 + 0xd) = *pcVar9;
                    }
                LAB_000631ac:
                    if (0x80 < iVar7)
                        goto LAB_000631b4;
                } else if (cVar2 == '\x04') {
                    if (cVar3 == '\x10') {
                        sVar4 = *(short *)(iVar8 + 10);
                        *(undefined1 *)(iVar8 + 9) = 3;
                        sVar1 = sVar4 + 1;
                        iVar7 = (int)sVar1;
                        *(short *)(iVar8 + 10) = sVar1;
                        *(char *)(iVar8 + sVar4 + 0xd) = *pcVar9;
                        goto LAB_000631ac;
                    }
                    if (cVar3 == '\x03') {
                        *(undefined1 *)(iVar8 + 9) = 1;
                        if (0x80 < *(short *)(iVar8 + 10))
                            goto LAB_000631b4;
                    } else {
                        *(undefined1 *)(iVar8 + 9) = 2;
                        *(char *)(iVar8 + 0xc) = *pcVar9;
                    LAB_0006322c:
                        *(undefined2 *)(iVar8 + 10) = 0;
                        if (((*(byte *)(piVar13 + 0xc0) & 2) == 0) ||
                            (FUN_0006f724(piVar13 + 0x3a),
                             *(char *)(iVar8 + 9) != '\x01'))
                            goto LAB_0006316c;
                    }
                    piVar11 = *(int **)(iVar12 + 0x54);
                    iVar6 = *piVar11;
                    iVar7 = FUN_00062a04(iVar12);
                    if ((iVar7 != 0) && (0 < *(int *)(iVar6 + 4))) {
                        iVar7 = piVar11[0x34];
                        *(undefined4 *)(iVar6 + 4) = 0;
                        piVar11[0x2e] = 0;
                        FUN_0007c054(piVar11 + 0xe, 0x80,
                                     "%4d %03d %02d:%02d:%02d.%09ld",
                                     piVar11[0x2f], piVar11[0x30],
                                     piVar11[0x31], piVar11[0x32],
                                     piVar11[0x33], iVar7);
                        piVar11[0x2e] = 0x18;
                        iVar7 = FUN_00049cf8(piVar11);
                        if (iVar7 == 0) {
                            FUN_000494a0(iVar12, 6);
                        } else {
                            FUN_00051f44(iVar12 + 0x10, piVar11 + 0xe);
                            piVar11[0x38] = piVar11[0x3a];
                            piVar11[0x39] = piVar11[0x3b];
                            FUN_00049d44(iVar12);
                        }
                    }
                } else {
                    if (cVar2 == '\x02') {
                        if (((cVar3 != '\x03') && (cVar3 != '\x10')) &&
                            (cVar3 != '\0')) {
                            iVar7 = (int)*(short *)(iVar8 + 10);
                            *(undefined1 *)(iVar8 + 9) = 3;
                            *(char *)(iVar8 + 0xc) = *pcVar9;
                            goto LAB_000631ac;
                        }
                    } else if (cVar3 == '\x10') {
                        *(undefined1 *)(iVar8 + 9) = 2;
                        goto LAB_0006322c;
                    }
                    *(undefined1 *)(iVar8 + 9) = 0;
                    *(undefined2 *)(iVar8 + 10) = 0;
                }
            LAB_0006316c:
                pcVar9 = __src;
                if (__src == pcVar10)
                    break;
            } while (true);
        }
        goto LAB_000631c0;
    }
    memcpy(&DAT_000cd600 + DAT_000cd5fc, __src, *(size_t *)(param_1 + 0x54));
    DAT_000cd5fc = iVar7 + *(int *)(param_1 + 0x54);
    if ((*(char *)((int)&DAT_000cd5fc + DAT_000cd5fc + 2) == '\r') &&
        (*(char *)((int)&DAT_000cd5fc + DAT_000cd5fc + 3) == '\n')) {
        *(undefined1 *)((int)&DAT_000cd5fc + DAT_000cd5fc + 2) = 0;
        FUN_00051f44(iVar12 + 0x10, &DAT_000cd600);
        DAT_000cd5fc = 0;
        praecis_msg = 0;
        iVar7 = FUN_00062e7c(piVar13);
        if (iVar7 < 0) {
            if (iVar5 == __stack_chk_guard) {
                FUN_000494a0(iVar12, 3);
                return;
            }
            goto LAB_00063410;
        }
    }
LAB_000631c0:
    if (iVar5 == __stack_chk_guard) {
        return;
    }
LAB_00063410:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
LAB_000631b4:
    *(undefined1 *)(iVar8 + 9) = 0;
    goto joined_r0x00063134;
}

void FUN_00063a84(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    undefined4 *puVar4;
    int *piVar5;
    undefined4 *puVar6;
    int iVar7;
    char *__s;
    undefined1 uStack_46;
    undefined1 uStack_45;
    uint local_44;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined1 auStack_38[12];
    undefined1 auStack_2c[9];
    byte local_23;
    char local_20;
    int local_1c;

    iVar7 = *(int *)(param_1 + 4);
    puVar6 = *(undefined4 **)(iVar7 + 0x54);
    piVar5 = (int *)*puVar6;
    local_1c = __stack_chk_guard;
    iVar1 = FUN_00049ee4(param_1, piVar5[1], (int)puVar6 + (0xb6 - piVar5[1]),
                         &local_40);
    iVar3 = piVar5[1];
    __s = (char *)(puVar6 + 0xe);
    piVar5[1] = iVar3 + iVar1 + 1;
    *(undefined1 *)(iVar3 + iVar1) = 0x20;
    *(undefined1 *)piVar5[1] = 0;
    if (*piVar5 == 0) {
        iVar1 = piVar5[1];
        puVar6[0x3a] = local_40;
        puVar6[0x3b] = uStack_3c;
        *piVar5 = 1;
        puVar6[0x2e] = iVar1 - (int)__s;
    } else {
        iVar1 = piVar5[1];
        iVar3 = *piVar5 + 1;
        *piVar5 = iVar3;
        puVar6[0x2e] = iVar1 - (int)__s;
        if (2 < iVar3) {
            if ((iVar1 - (int)__s < 0x2e) ||
                (iVar1 =
                     sscanf(__s, "%c%2d:%2d:%2d.%3ld%c %9s%3d%13s%4ld",
                            &uStack_46, puVar6 + 0x31, puVar6 + 0x32,
                            puVar6 + 0x33, puVar6 + 0x34, &uStack_45,
                            auStack_38, puVar6 + 0x30, auStack_2c, &local_44),
                 iVar1 != 10)) {
                FUN_000494a0(iVar7, 2);
            } else {
                iVar1 = puVar6[0x34];
                puVar4 = (undefined4 *)(uint)local_23;
                puVar6[0x34] = iVar1 * 1000000;
                if (puVar4 != (undefined4 *)0x38) {
                    *(undefined1 *)(puVar6 + 10) = 3;
                }
                if (local_20 == 'H') {
                    uVar2 = 0x48565757;
                    puVar6[0xbf] = 0x48565757;
                } else {
                    uVar2 = 0x565757;
                    puVar6[0xbf] = 0x565757;
                }
                if (*(byte *)(iVar7 + 0x5d) < 2) {
                    *(undefined4 *)(iVar7 + 0x70) = puVar6[0xbf];
                }
                if (local_44 == 0) {
                    uVar2 = puVar6[0x3a];
                    iVar1 = puVar6[0x3b];
                    puVar4 = puVar6 + 0x38;
                }
                if (local_44 == 0) {
                    *puVar4 = uVar2;
                    puVar4[1] = iVar1;
                }
                *(double *)(puVar6 + 0x3e) = (double)local_44 * 1e-05 * 60.0;
                iVar1 = FUN_00049cf8(puVar6);
                if (iVar1 == 0) {
                    FUN_000494a0(iVar7, 6);
                } else if (1.5 < *(double *)(iVar7 + 0x278)) {
                    FUN_00049d44(iVar7);
                }
            }
        }
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00063cc4(int param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    byte bVar1;
    FILE *__stream;
    int __fd;
    FILE *pFVar2;
    int iVar3;
    char acStack_4c[40];
    int local_24;
    undefined4 uStack_8;
    undefined4 uStack_4;

    iVar3 = **(int **)(param_1 + 0x54);
    bVar1 = *(byte *)(*(int **)(param_1 + 0x54) + 0xc0);
    __stream = *(FILE **)(iVar3 + 0x18);
    pFVar2 = __stream;
    if (__stream != (FILE *)0x0) {
        pFVar2 = (FILE *)0x1;
    }
    local_24 = __stack_chk_guard;
    uStack_8 = param_3;
    uStack_4 = param_4;
    if ((FILE *)(((uint)bVar1 << 0x1e) >> 0x1f) != pFVar2) {
        if ((bVar1 & 2) == 0) {
            fclose(__stream);
            *(uint *)(iVar3 + 0x18) = bVar1 & 2;
            goto LAB_00063d8c;
        }
        FUN_0007c054(acStack_4c, 0x28, "/tmp/true%d.debug",
                     *(undefined4 *)(iVar3 + 0x14));
        __fd = open64(acStack_4c, 0xc1, 0x180);
        if (-1 < __fd) {
            pFVar2 = fdopen(__fd, "w");
            *(FILE **)(iVar3 + 0x18) = pFVar2;
            if (pFVar2 != (FILE *)0x0) {
                setvbuf(pFVar2, &DAT_000cd664, 1, 0x2000);
            }
        }
        __stream = *(FILE **)(iVar3 + 0x18);
    }
    if (__stream != (FILE *)0x0) {
        __fprintf_chk(__stream, 1, "true%d: ", *(undefined4 *)(iVar3 + 0x14));
        __vfprintf_chk(*(undefined4 *)(iVar3 + 0x18), 1, param_2, &uStack_8);
    }
LAB_00063d8c:
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00063e04(int param_1, char *param_2)

{
    int iVar1;
    size_t __n;
    size_t sVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = *(int *)(param_1 + 0x54);
    if ((*(byte *)(iVar3 + 0x300) & 1) == 0) {
        __n = strlen(param_2);
        FUN_00063cc4(param_1, "Send \'%s\'\n", param_2);
        sVar2 = write(*(int *)(iVar3 + 0x1c), param_2, __n);
        if (sVar2 != __n) {
            if (iVar1 == __stack_chk_guard) {
                FUN_000494a0(param_1, 3);
                return;
            }
            goto LAB_00063ebc;
        }
        *(int *)(iVar3 + 0x308) = *(int *)(iVar3 + 0x308) + 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00063ebc:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00063ecc(int param_1, int *param_2)

{
    int iVar1;
    char *pcVar2;
    undefined *puVar3;
    int iVar4;
    undefined *puVar5;
    int iVar6;
    undefined4 uVar7;
    int iVar8;
    int *piVar9;

    iVar1 = __stack_chk_guard;
    piVar9 = *(int **)(param_1 + 0x54);
    iVar8 = *piVar9;
    iVar4 = *(int *)(iVar8 + 0x10);
    if (param_2 == (int *)0x9)
        goto LAB_00063f28;
LAB_00063f14:
    if ((ntp_syslogmask & 0x400) != 0) {
        if (iVar4 < 6) {
            puVar3 = *(undefined **)(types + iVar4 * 4);
            iVar4 = *(int *)(iVar8 + 0xc);
            if (iVar4 < 0xb)
                goto LAB_00063fd0;
        LAB_00064180:
            puVar5 = &DAT_000a8f60;
        } else {
            iVar4 = *(int *)(iVar8 + 0xc);
            puVar3 = &DAT_000a8f60;
            if (10 < iVar4)
                goto LAB_00064180;
        LAB_00063fd0:
            puVar5 = *(undefined **)(states + iVar4 * 4);
        }
        FUN_00074e00(6, "TRUE: clock %s, state %s, event %s", puVar3, puVar5,
                     *(undefined4 *)(events + (int)param_2 * 4));
        iVar4 = *(int *)(iVar8 + 0x10);
    }
LAB_00063f28:
    if (iVar4 < 6) {
        puVar3 = *(undefined **)(types + iVar4 * 4);
        iVar4 = *(int *)(iVar8 + 0xc);
        if (10 < iVar4)
            goto LAB_00063fa8;
    LAB_00063f48:
        puVar5 = *(undefined **)(states + iVar4 * 4);
    } else {
        iVar4 = *(int *)(iVar8 + 0xc);
        puVar3 = &DAT_000a8f60;
        if (iVar4 < 0xb)
            goto LAB_00063f48;
    LAB_00063fa8:
        puVar5 = &DAT_000a8f60;
    }
    FUN_00063cc4(param_1, "clock %s, state %s, event %s\n", puVar3, puVar5,
                 *(undefined4 *)(events + (int)param_2 * 4));
    iVar4 = __stack_chk_guard;
    switch (*(undefined4 *)(iVar8 + 0x10)) {
    case 0:
        if (param_2 == (int *)0x7)
            break;
        iVar6 = *(int *)(iVar8 + 0xc);
        switch (iVar6) {
        case 0:
            if (param_2 != (int *)0x0)
                goto switchD_000643b8_default;
            FUN_00063e04(param_1, &DAT_000a9750);
            *(undefined4 *)(iVar8 + 0xc) = 4;
            goto switchD_000640d0_default;
        case 1:
            if (param_2 < (int *)0x2) {
                FUN_00063e04(param_1, &DAT_000a9784);
                *(undefined4 *)(iVar8 + 0xc) = 2;
                goto switchD_000640d0_default;
            }
            if (param_2 != (int *)0x2) {
                pcVar2 = "TRUE: TM/TMD init fellthrough!";
            joined_r0x00064534:
                if (iVar1 == __stack_chk_guard) {
                    FUN_00074e00(6, pcVar2);
                    return;
                }
            LAB_00064588:
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            piVar9 = *(int **)(param_1 + 0x54);
            *(undefined4 *)(iVar8 + 0x10) = 2;
            param_2 = (int *)0x0;
            iVar8 = *piVar9;
            iVar4 = *(int *)(iVar8 + 0x10);
            goto LAB_00063f14;
        case 2:
            if (param_2 < (int *)0x2) {
                *(undefined4 *)(iVar8 + 0xc) = 0;
                if (iVar1 == iVar4) {
                    sleep(1);
                    return;
                }
                goto LAB_00064588;
            }
            if (param_2 != (int *)0x8) {
                pcVar2 = "TRUE: TCU init fellthrough!";
                goto joined_r0x00064534;
            }
            piVar9 = *(int **)(param_1 + 0x54);
            uVar7 = 3;
        LAB_00064400:
            *(undefined4 *)(iVar8 + 0x10) = uVar7;
            iVar8 = *piVar9;
            param_2 = (int *)0x0;
            iVar4 = *(int *)(iVar8 + 0x10);
            goto LAB_00063f14;
        case 3:
            if ((int *)0x1 < param_2) {
                if (param_2 != (int *)0x9)
                    goto switchD_000643b8_default;
                *(undefined4 *)(iVar8 + 0xc) = 10;
                *(undefined4 *)(iVar8 + 0x10) = 4;
                goto switchD_000640d0_default;
            }
            *(undefined4 *)(iVar8 + 0xc) = 1;
            if (iVar1 == iVar4) {
                pcVar2 = "F18\r";
                goto LAB_000640c0;
            }
            goto LAB_00064588;
        case 4:
            switch (param_2) {
            case (int *)0x0:
                goto LAB_00064424;
            case (int *)0x1:
                goto LAB_00064424;
            case (int *)0x2:
                break;
            case (int *)0x3:
                break;
            case (int *)0x4:
                break;
            case (int *)0x5:
                piVar9 = *(int **)(param_1 + 0x54);
                uVar7 = 1;
                goto LAB_00064400;
            case (int *)0x6:
                break;
            case (int *)0x7:
                break;
            case (int *)0x8:
                break;
            case (int *)0x9:
            LAB_00064424:
                FUN_00063e04(param_1, &DAT_000a9754);
                sleep(1);
                iVar4 = __stack_chk_guard;
                *(undefined4 *)(iVar8 + 0xc) = 5;
                if (iVar1 == iVar4) {
                    pcVar2 = "QV";
                LAB_000640c0:
                    FUN_00063e04(param_1, pcVar2);
                    return;
                }
                goto LAB_00064588;
            }
        switchD_000643b8_default:
            /* WARNING: Subroutine does not return */
            abort();
        case 5:
            switch (param_2) {
            case (int *)0x0:
                goto LAB_000644a4;
            case (int *)0x1:
            LAB_000644a4:
                *(undefined4 *)(iVar8 + 0xc) = 3;
                if (iVar1 == iVar4) {
                    pcVar2 = "C\r";
                    goto LAB_000640c0;
                }
                goto LAB_00064588;
            case (int *)0x2:
                break;
            case (int *)0x3:
                break;
            case (int *)0x4:
                break;
            case (int *)0x5:
                break;
            case (int *)0x6:
                *(undefined4 *)(iVar8 + 0x10) = 5;
                *(undefined4 *)(iVar8 + 0xc) = 10;
                if (iVar1 == iVar4) {
                    pcVar2 = "ST1";
                    goto LAB_000640c0;
                }
                goto LAB_00064588;
            case (int *)0x7:
                break;
            case (int *)0x8:
                break;
            case (int *)0x9:
                *(undefined4 *)(iVar8 + 0xc) = 10;
                *(undefined4 *)(iVar8 + 0x10) = 5;
                goto switchD_000640d0_default;
            }
            if (iVar1 == __stack_chk_guard) {
                pcVar2 = "TRUE: TL3 init fellthrough! (%d)";
                goto LAB_000642b4;
            }
            goto LAB_00064588;
        case 6:
            break;
        case 7:
            break;
        case 8:
            break;
        case 9:
            break;
        case 10:
            break;
        case 0xb:
            break;
        default:
            goto switchD_000640d0_default;
        }
        if (iVar6 == 0xb) {
            param_2 = (int *)&DAT_000a8f60;
        } else {
            param_2 = *(int **)(states + iVar6 * 4);
        }
        if (iVar1 == __stack_chk_guard) {
            pcVar2 = "TRUE: state %s is unexpected!";
        LAB_000642b4:
            FUN_00074e00(6, pcVar2, param_2);
            return;
        }
        goto LAB_00064588;
    case 1:
        if (param_2 != (int *)0x5) {
            if (param_2 == (int *)0x7) {
                if (iVar1 == __stack_chk_guard) {
                    pcVar2 = "P";
                    goto LAB_000640c0;
                }
                goto LAB_00064588;
            }
            if (param_2 != (int *)0x0)
                goto LAB_0006408c;
        }
        FUN_00063e04(param_1, "C");
        *(undefined4 *)(iVar8 + 0xc) = 9;
        if (param_2 == (int *)0x0)
            goto LAB_0006414c;
        break;
    case 2:
        switch (param_2) {
        case (int *)0x0:
            FUN_00063e04(param_1, &DAT_000a96e4);
            *(undefined4 *)(iVar8 + 0xc) = 6;
            break;
        case (int *)0x1:
            break;
        case (int *)0x2:
            param_2 = piVar9 + 0xe;
            FUN_00063e04(param_1, &DAT_000a96ec);
            iVar4 = strcmp((char *)param_2, " TRUETIME Mk III");
            if ((iVar4 == 0) ||
                (iVar4 = strncmp((char *)param_2, " TRUETIME XL", 0xc),
                 iVar4 == 0)) {
                FUN_00063ecc(param_1, 2);
                if ((ntp_syslogmask & 0x400) != 0) {
                    if (iVar1 == __stack_chk_guard) {
                        pcVar2 = "TM/TMD/XL: %s";
                        goto LAB_000642b4;
                    }
                    goto LAB_00064588;
                }
            } else {
                *(undefined4 *)(iVar8 + 0xc) = 7;
            }
            break;
        case (int *)0x3:
            FUN_00063e04(param_1, &DAT_000a9728);
            *(undefined4 *)(iVar8 + 0xc) = 8;
            break;
        case (int *)0x4:
            FUN_00063e04(param_1, &DAT_000a9730);
            *(undefined4 *)(iVar8 + 0xc) = 9;
            break;
        case (int *)0x5:
            break;
        case (int *)0x6:
            break;
        case (int *)0x7:
            break;
        case (int *)0x8:
            break;
        case (int *)0x9:
        LAB_00064094:
            if (*(int *)(iVar8 + 0xc) - 9U < 2)
                goto LAB_0006400c;
            if (iVar1 == __stack_chk_guard) {
                pcVar2 = "\x03\r";
                goto LAB_000640c0;
            }
            goto LAB_00064588;
        }
        break;
    case 3:
        if (param_2 == (int *)0x0) {
            FUN_00063e04(param_1, &DAT_000a9738);
            FUN_00063e04(param_1, &DAT_000a9740);
            FUN_00063e04(param_1, &DAT_000a9748);
            *(undefined4 *)(iVar8 + 0xc) = 9;
        } else {
        LAB_0006408c:
            if (param_2 == (int *)0x9)
                goto LAB_00064094;
        }
        break;
    case 4:
        if (param_2 != (int *)0x0)
            goto LAB_0006408c;
    LAB_0006414c:
        FUN_00063e04(param_1, "C");
        *(undefined4 *)(iVar8 + 0xc) = 9;
        break;
    case 5:
        if (param_2 == (int *)0x0) {
            if (iVar1 == __stack_chk_guard) {
                pcVar2 = "ST1";
                goto LAB_000640c0;
            }
            goto LAB_00064588;
        }
        if (param_2 != (int *)0x9)
            break;
    LAB_0006400c:
        *(undefined4 *)(iVar8 + 0xc) = 10;
        break;
    default:
        FUN_00074e00(6, "TRUE: cannot identify refclock!");
        goto switchD_000643b8_default;
    }
switchD_000640d0_default:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    goto LAB_00064588;
}

void FUN_0006465c(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;
    undefined4 *puVar4;
    int *piVar5;

    iVar1 = __stack_chk_guard;
    puVar4 = *(undefined4 **)(param_2 + 0x54);
    piVar5 = (int *)*puVar4;
    if (*piVar5 == 0) {
        FUN_00063ecc(param_2);
        FUN_000494a0(param_2, 1);
    } else {
        *piVar5 = *piVar5 + -1;
    }
    iVar2 = __stack_chk_guard;
    iVar3 = puVar4[0xc2];
    piVar5[2] = 1;
    puVar4[0xc2] = iVar3 + 1;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006476c(int param_1)

{
    uint uVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    char *pcVar5;
    undefined4 *puVar6;
    int iVar7;
    undefined4 *puVar8;
    byte local_c5;
    int local_c4;
    undefined1 auStack_c0[4];
    int local_bc;
    undefined1 auStack_b8[4];
    undefined4 local_b4;
    undefined4 uStack_b0;
    undefined1 auStack_ac[128];
    int local_2c;

    iVar7 = *(int *)(param_1 + 4);
    puVar6 = *(undefined4 **)(iVar7 + 0x54);
    local_2c = __stack_chk_guard;
    puVar8 = (undefined4 *)*puVar6;
    uVar1 = FUN_00049ee4(param_1, auStack_ac, 0x80, &local_b4);
    uVar1 = uVar1 & 0xffff;
    auStack_ac[uVar1] = 0;
    if (uVar1 != 0) {
        pcVar5 = (char *)(puVar6 + 0xe);
        puVar6[0x2e] = uVar1;
        FUN_0007d4dc(pcVar5, auStack_ac, 0x80);
        puVar6[0x3a] = local_b4;
        puVar6[0x3b] = uStack_b0;
        FUN_00063cc4(iVar7, "receive(%s) [%d]\n", pcVar5, puVar6[0x2e]);
        *puVar8 = 2;
        FUN_00051f44(iVar7 + 0x10, pcVar5);
        if ((*(char *)(puVar6 + 0xe) == '?') ||
            (iVar2 = strcmp(pcVar5, "ERROR 05 NO SUCH FUNCTION"), iVar2 == 0)) {
            FUN_00063ecc(iVar7, 1);
        } else if ((((*(char *)((int)puVar6 + 0x3d) - 0x2bU & 0xfd) == 0) &&
                    ((*(char *)((int)puVar6 + 0x41) - 0x2bU & 0xfd) == 0)) &&
                   (iVar2 = sscanf(pcVar5, "%5d%*c%3d%*c%3d", &local_bc,
                                   auStack_c0, auStack_b8),
                    iVar2 == 3)) {
            if (local_bc - 0x1b59U < 6999) {
                if (9999 < local_bc) {
                    pcVar5 = "WEST";
                } else {
                    pcVar5 = "EAST";
                }
                uVar1 = (uint)(9999 >= local_bc);
                if (uVar1 != puVar8[1]) {
                    uVar3 = puVar6[0xbc];
                    uVar4 = puVar6[0xbd];
                    puVar6[0xbc] = puVar6[0xba];
                    puVar6[0xbd] = puVar6[0xbb];
                    puVar6[0xba] = uVar3;
                    puVar6[0xbb] = uVar4;
                    puVar8[1] = uVar1;
                }
            } else {
                pcVar5 = "UNKNOWN";
            }
            FUN_00063cc4(iVar7, "GOES: station %s\n", pcVar5);
            FUN_00063ecc(iVar7, 5);
        } else {
            iVar2 = sscanf(pcVar5, "F%2d", &local_c4);
            if ((iVar2 == 1) && (local_c4 - 1U < 0x4f)) {
                if (local_c4 == 0x32) {
                    FUN_00063ecc(iVar7, 3);
                } else if (local_c4 == 0x33) {
                    FUN_00063ecc(iVar7, 4);
                } else {
                    FUN_00063cc4(iVar7, "got F%02d - ignoring\n");
                }
            } else if ((*(short *)(puVar6 + 0xe) == 0x4556) &&
                       ((*(char *)((int)puVar6 + 0x3a) == 'R' &&
                         (*(char *)((int)puVar6 + 0x3e) == '.')))) {
                FUN_00063ecc(iVar7, 6);
                if ((ntp_syslogmask & 0x400) != 0) {
                    FUN_00074e00(6, "TL3: %s", pcVar5);
                }
            } else {
                iVar2 = strncmp(pcVar5, " TRUETIME Mk III ", 0x11);
                if ((iVar2 == 0) ||
                    (iVar2 = strncmp(pcVar5, " TRUETIME XL", 0xc),
                     iVar2 == 0)) {
                    FUN_00063ecc(iVar7, 2);
                    if ((ntp_syslogmask & 0x400) != 0) {
                        FUN_00074e00(6, "TM/TMD/XL: %s", pcVar5);
                    }
                } else if (((*(char *)(puVar6 + 0xe) == 'S' ||
                             *(char *)(puVar6 + 0xe) == 'N') &&
                            (*(char *)((int)puVar6 + 0x41) == 'E' ||
                             *(char *)((int)puVar6 + 0x41) == 'W')) &&
                           (*(char *)((int)puVar6 + 0x4a) == '+')) {
                    FUN_00063ecc(iVar7, 8);
                    if ((ntp_syslogmask & 0x400) != 0) {
                        FUN_00074e00(6, "TCU-800: %s", pcVar5);
                    }
                } else if (((*(char *)((int)puVar6 + 0x3b) == ':') &&
                            (*(char *)((int)puVar6 + 0x3e) == ':')) &&
                           ((*(char *)((int)puVar6 + 0x41) == ':' &&
                             (iVar2 = sscanf(pcVar5, "%3d:%2d:%2d:%2d%c",
                                             puVar6 + 0x30, puVar6 + 0x31,
                                             puVar6 + 0x32, puVar6 + 0x33,
                                             &local_c5),
                              iVar2 == 5)))) {
                    uVar1 = (uint)local_c5;
                    *(bool *)(puVar6 + 10) =
                        uVar1 - 0x3e < 2 || (uVar1 == 0x58 || uVar1 == 0x23);
                    FUN_00063ecc(iVar7, 9);
                    if (puVar8[2] != 0) {
                        if ((uint)puVar8[4] < 2) {
                            FUN_00063ecc(iVar7, 7);
                        }
                        iVar2 = FUN_00049cf8(puVar6);
                        if (iVar2 == 0) {
                            FUN_000494a0(iVar7, 6);
                        } else {
                            puVar6[0x38] = puVar6[0x3a];
                            puVar6[0x39] = puVar6[0x3b];
                            FUN_00049d44(iVar7);
                            FUN_000494a0(iVar7, 0);
                            puVar8[2] = 0;
                        }
                    }
                } else {
                    FUN_000494a0(iVar7, 2);
                }
            }
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00064f04(int param_1)

{
    char cVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    undefined1 uVar5;
    undefined4 *puVar6;
    char *__s;
    char *pcVar7;
    int iVar8;
    bool bVar9;
    char local_38;
    char local_37[3];
    uint local_34;
    undefined4 local_30;
    undefined4 uStack_2c;
    char local_28;
    byte local_27;
    int local_24;

    iVar8 = *(int *)(param_1 + 4);
    puVar6 = *(undefined4 **)(iVar8 + 0x54);
    local_34 = 0x7fffffff;
    __s = (char *)(puVar6 + 0xe);
    pcVar7 = (char *)*puVar6;
    local_24 = __stack_chk_guard;
    iVar2 = FUN_00049ee4(param_1, __s, 0x80, &local_30);
    if (iVar2 == 0) {
        bVar9 = *pcVar7 == '\0';
        if (bVar9) {
            *pcVar7 = bVar9;
            *(undefined4 *)(pcVar7 + 4) = local_30;
            *(undefined4 *)(pcVar7 + 8) = uStack_2c;
        } else {
            *pcVar7 = bVar9;
        }
        goto LAB_00064f74;
    }
    uVar3 = *(undefined4 *)(pcVar7 + 4);
    uVar4 = *(undefined4 *)(pcVar7 + 8);
    puVar6[0x2e] = iVar2;
    puVar6[0x3a] = uVar3;
    puVar6[0x3b] = uVar4;
    *(undefined4 *)(pcVar7 + 4) = local_30;
    *(undefined4 *)(pcVar7 + 8) = uStack_2c;
    *pcVar7 = '\x01';
    local_37[2] = ' ';
    local_37[1] = 0x20;
    local_37[0] = ' ';
    local_38 = ' ';
    if (iVar2 == 0x18) {
    LAB_00065010:
        iVar2 = sscanf(__s, "%c%1d%c%4d%3d%*c%2d:%2d:%2d.%2ld%c", &local_38,
                       &local_34, local_37 + 1, puVar6 + 0x2f, puVar6 + 0x30,
                       puVar6 + 0x31, puVar6 + 0x32, puVar6 + 0x33,
                       puVar6 + 0x34, local_37);
        if (iVar2 == 10) {
            iVar2 = puVar6[0x34] * 10000000;
            puVar6[0x34] = iVar2;
            if (local_37[0] == 'I') {
                iVar2 = 0x2b;
            }
            cVar1 = (char)iVar2;
            if ((local_37[0] != 'I') &&
                (cVar1 = local_37[0], local_37[0] == 'D')) {
                local_37[0] = '-';
                cVar1 = local_37[0];
            }
            local_37[0] = cVar1;
            if (local_38 == '?') {
                iVar2 = puVar6[0x2e];
            } else {
                iVar2 = puVar6[0x2e];
                local_38 = ':';
            }
        LAB_000650cc:
            if (iVar2 == 0x20) {
                switch (local_34) {
                case 0:
                    goto LAB_0006512c;
                case 1:
                    goto LAB_00065170;
                case 2:
                    goto LAB_000651a0;
                case 3:
                    goto LAB_00065188;
                }
            switchD_000650e0_default:
                puVar6[0x3e] = 0;
                puVar6[0x3f] = 0x40300000;
            } else {
                switch (local_34) {
                case 1:
                    puVar6[0x3e] = 0x47ae147b;
                    puVar6[0x3f] = 0x3fc47ae1;
                    break;
                case 2:
                LAB_00065188:
                    puVar6[0x3e] = 0x47ae147b;
                    puVar6[0x3f] = 0x3fb47ae1;
                    break;
                case 3:
                LAB_000651a0:
                    puVar6[0x3e] = 0x47ae147b;
                    puVar6[0x3f] = 0x3fa47ae1;
                    break;
                case 4:
                LAB_00065170:
                    puVar6[0x3e] = 0x47ae147b;
                    puVar6[0x3f] = 0x3f947ae1;
                    break;
                case 5:
                LAB_0006512c:
                    puVar6[0x3e] = 0xd2f1a9fc;
                    puVar6[0x3f] = 0x3f60624d;
                    break;
                default:
                    goto switchD_000650e0_default;
                }
            }
            if (local_38 == ':') {
                if (local_37[0] == '+') {
                    *(undefined1 *)(puVar6 + 10) = 1;
                } else {
                    if (local_37[0] == '-') {
                        uVar5 = 2;
                    } else {
                        uVar5 = 0;
                    }
                    *(undefined1 *)(puVar6 + 10) = uVar5;
                }
            } else {
                *(undefined1 *)(puVar6 + 10) = 3;
            }
            iVar2 = FUN_00049cf8(puVar6);
            if (iVar2 == 0) {
                FUN_000494a0(iVar8, 6);
            }
            goto LAB_00064f74;
        }
    } else if (iVar2 == 0x20) {
        iVar2 = sscanf(__s, "%c%*31c", local_37 + 2);
        if (iVar2 != 1)
            goto LAB_00065010;
        if ((local_37[2] == 'R') &&
            (iVar2 =
                 sscanf(__s, "%*2c %*2c%2c%*c%4d%*c%3d%*4c %2d%c%2d:%2d%c%*2c",
                        &local_28, puVar6 + 0x2f, puVar6 + 0x30, puVar6 + 0x31,
                        &local_38, puVar6 + 0x32, puVar6 + 0x33, local_37),
             iVar2 == 8)) {
            if (local_28 == '0') {
                local_34 = 0;
            } else {
                local_34 = 99;
            }
            if (local_37[0] == 'I') {
                local_37[0] = '+';
            } else if (local_37[0] == 'D') {
                local_37[0] = '-';
            }
        }
        if ((local_37[2] != 'S') ||
            (iVar2 =
                 sscanf(__s, "%*4c %2c %4d%*c%3d%*4c %2d%c%2d:%2d%c%*2c",
                        &local_28, puVar6 + 0x2f, puVar6 + 0x30, puVar6 + 0x31,
                        &local_38, puVar6 + 0x32, puVar6 + 0x33, local_37),
             iVar2 != 8)) {
            iVar2 = puVar6[0x2e];
            goto LAB_000650cc;
        }
        iVar2 = puVar6[0x2e];
        if (local_28 == 'L') {
            local_34 = 0;
            if (iVar2 == 0x20)
                goto LAB_0006512c;
        } else {
            if (local_28 == '0') {
                local_34 = local_27 & 0xf;
                goto LAB_000650cc;
            }
            local_34 = 99;
        }
        goto switchD_000650e0_default;
    }
    FUN_000494a0(iVar8, 2);
LAB_00064f74:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00065480(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    piVar4 = *(int **)(param_2 + 0x54);
    iVar5 = *piVar4;
    if (*(int *)(iVar5 + 0x34) != 0) {
        FUN_000494a0(param_2);
    }
    iVar2 = __stack_chk_guard;
    iVar3 = piVar4[0xc2];
    *(undefined4 *)(iVar5 + 0x34) = 0;
    piVar4[0xc2] = iVar3 + 1;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00065584(int *param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = *param_1;
    iVar2 = *(int *)(iVar3 + 0x844);
    if (*(int *)(iVar3 + 0x84c) == 0) {
        iVar2 = iVar2 + 4;
        if (0xff < iVar2) {
            iVar2 = 0xff;
        }
    } else {
        if (*(int *)(iVar3 + 0x84c) < 0x65)
            goto LAB_000655c8;
        iVar2 = iVar2 + -4;
        if (iVar2 < 0) {
            iVar2 = 0;
            *(undefined4 *)(iVar3 + 0x844) = 0;
            goto LAB_000655c8;
        }
    }
    *(int *)(iVar3 + 0x844) = iVar2;
LAB_000655c8:
    FUN_000712e0(iVar2, *(undefined4 *)(iVar3 + 0x848),
                 *(undefined4 *)(iVar3 + 0x840));
    iVar2 = __stack_chk_guard;
    *(undefined4 *)(iVar3 + 0x84c) = 0;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00065620(uint param_1, int *param_2, int param_3)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    iVar4 = *param_2;
    iVar2 = *(int *)(iVar4 + 0x30);
    if (0 < iVar2) {
        *(undefined4 *)(*(int *)(iVar4 + 0xcdc) * 0xd8 + iVar4 + 0x898) =
            *(undefined4 *)(iVar4 + 0x844);
        FUN_00073dc0((int)*(undefined8 *)(&DAT_000a9aa0 + param_3 * 8), iVar2,
                     param_1 & 0x7f);
        uVar3 = *(undefined4 *)(param_3 * 0xd8 + iVar4 + 0x898);
        *(int *)(iVar4 + 0xcdc) = param_3;
        *(undefined4 *)(iVar4 + 0x844) = uVar3;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000656c0(int param_1)

{
    bool bVar1;
    double dVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    int iVar9;
    int *piVar10;
    uint uVar11;
    uint uVar12;
    double dVar13;
    double dVar14;

    iVar3 = __stack_chk_guard;
    iVar6 = 0;
    iVar7 = 0;
    piVar10 = *(int **)(param_1 + 0x54);
    iVar5 = 0;
    iVar9 = *piVar10;
    dVar14 = 0.0;
    iVar8 = iVar9 + 0x8a0;
    do {
        dVar13 = *(double *)(iVar8 + 0xb0);
        bVar1 = dVar14 <= dVar13;
        dVar2 = dVar14;
        if (bVar1) {
            iVar5 = iVar8 + 0x68;
            dVar2 = dVar13;
        }
        dVar14 = *(double *)(iVar8 + 0x48);
        if (bVar1) {
            iVar6 = iVar7;
        }
        if (dVar2 <= dVar14) {
            iVar6 = iVar7;
        }
        iVar7 = iVar7 + 1;
        iVar4 = iVar8;
        if (dVar14 < dVar2) {
            dVar14 = dVar2;
            iVar4 = iVar5;
        }
        iVar5 = iVar4;
        iVar8 = iVar8 + 0xd8;
    } while (iVar7 != 5);
    uVar12 = *(uint *)(iVar9 + 0x10e8);
    *(uint *)(iVar9 + 0x10e8) = uVar12 & 0xfffffcff;
    if (13.0 <= dVar14) {
        *(int *)(iVar9 + 0xcd4) = iVar6;
        *(int *)(iVar9 + 0xcd0) = iVar5;
        iVar6 = *(int *)(iVar5 + 0x5c);
        piVar10[0xbf] = iVar6;
        uVar12 = *(uint *)(iVar5 + 0x58);
        uVar11 = *(uint *)(iVar9 + 0x10e8);
        *(int *)(param_1 + 0x70) = iVar6;
        *(uint *)(iVar9 + 0x10e8) = uVar11 | 0x80;
        if ((uVar12 & 0x100) == 0) {
            if ((uVar12 & 0x200) == 0) {
                *(undefined4 *)(iVar9 + 0x28) = 0;
                *(undefined4 *)(iVar9 + 0x2c) = 0;
            } else {
                iVar5 = piVar10[0xbc];
                iVar6 = piVar10[0xbd];
                *(uint *)(iVar9 + 0x10e8) = uVar11 | 0x280;
                *(int *)(iVar9 + 0x28) = iVar5;
                *(int *)(iVar9 + 0x2c) = iVar6;
            }
            uVar11 = 1;
        } else {
            iVar5 = piVar10[0xba];
            iVar6 = piVar10[0xbb];
            *(uint *)(iVar9 + 0x10e8) = uVar11 | 0x180;
            uVar11 = 1;
            *(int *)(iVar9 + 0x28) = iVar5;
            *(int *)(iVar9 + 0x2c) = iVar6;
        }
    } else {
        uVar11 = uVar12 & 0x80;
        *(int *)(iVar9 + 0xcd4) = (*(int *)(iVar9 + 0xcd4) + 1) % 5;
        if (uVar11 != 0) {
            *(uint *)(iVar9 + 0x10e8) = uVar12 & 0xfffffc7f;
            FUN_000494a0(param_1, 4);
            uVar11 = 0;
        }
    }
    if (0 < *(int *)(iVar9 + 0x30)) {
        FUN_00065620(*(undefined4 *)(param_1 + 0x4c),
                     *(undefined4 *)(param_1 + 0x54),
                     *(undefined4 *)(iVar9 + 0xcd4));
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar11);
}

void FUN_00065870(int param_1)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    int iVar4;
    int iVar5;
    double *pdVar6;
    bool bVar7;
    double dVar8;

    iVar1 = __stack_chk_guard;
    iVar5 = **(int **)(param_1 + 0x54);
    iVar4 = iVar5 + 0x8fc;
    dVar8 = 2.0;
    if (*(int *)(iVar5 + 0x10e8) != 0) {
        *(undefined4 *)(iVar5 + 0x34) = 1;
    }
    *(undefined1 *)(param_1 + 0x5b) = 3;
    *(undefined4 *)(iVar5 + 0x10ec) = 0;
    *(undefined4 *)(iVar5 + 0x10e8) = 0;
    *(undefined4 *)(iVar5 + 0x18) = 0;
    *(undefined4 *)(iVar5 + 0x1c) = 0;
    *(undefined4 *)(iVar5 + 0x844) = 0x7f;
    *(undefined4 *)(iVar5 + 0x38) = 0;
    *(undefined4 *)(iVar5 + 0x850) = 8;
    memset((void *)(iVar5 + 0x898), 0, 0x438);
    uVar3 = 0x7f;
    pdVar6 = (double *)&DAT_000a9aa8;
    while (true) {
        *(undefined4 *)(iVar4 + -100) = uVar3;
        *(undefined4 *)(iVar4 + -4) = 0x100;
        FUN_0007c054(iVar4, 5, "WV%.0f", uVar3, dVar8);
        iVar2 = iVar4 + 0x68;
        *(undefined4 *)(iVar4 + 100) = 0x200;
        iVar4 = iVar4 + 0xd8;
        FUN_0007c054(iVar2, 5, "WH%.0f", 0x200, dVar8);
        if (iVar4 == iVar5 + 0xd34)
            break;
        dVar8 = *pdVar6;
        pdVar6 = pdVar6 + 1;
        dVar8 = floor(dVar8);
        uVar3 = *(undefined4 *)(iVar5 + 0x844);
    }
    *(undefined4 *)(iVar5 + 0xcd4) = 2;
    FUN_000656c0(param_1);
    bVar7 = iVar1 != __stack_chk_guard;
    *(undefined4 *)(iVar5 + 0xcd8) = *(undefined4 *)(iVar5 + 0xcd4);
    if (bVar7) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00065c88(int param_1, int param_2, double *param_3)

{
    double *pdVar1;
    int iVar2;
    double *pdVar3;
    double *pdVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    int *piVar8;
    double *pdVar9;
    double dVar10;
    double dVar11;
    double dVar12;
    double dVar13;
    double dVar14;
    undefined1 auStack_ac[128];
    int local_2c;

    dVar14 = *param_3;
    piVar8 = *(int **)(param_1 + 0x54);
    local_2c = __stack_chk_guard;
    iVar6 = *piVar8;
    if (dVar14 == 0.0) {
        *(undefined4 *)(param_2 + 0x10) = 0;
        *(undefined4 *)(param_2 + 0x14) = 0xc0b77000;
    LAB_00065efc:
        *(undefined4 *)(param_2 + 0x18) = 0;
        *(undefined4 *)(param_2 + 0x1c) = 0;
    } else {
        iVar2 = 0;
        pdVar9 = (double *)(param_2 + 0x20);
        pdVar3 = param_3 + 1;
        iVar5 = 0;
        dVar10 = -6000.0;
        dVar11 = -6000.0;
        do {
            pdVar1 = (double *)&DAT_000cf670;
            dVar14 = DAT_000cf668 * dVar14 + 0.0;
            for (pdVar4 = pdVar3; pdVar3 + 3 != pdVar4; pdVar4 = pdVar4 + 1) {
                dVar13 = *pdVar1;
                pdVar1 = pdVar1 + 1;
                dVar14 = dVar14 + dVar13 * *pdVar4;
            }
            dVar14 = *pdVar9 + (dVar14 - *pdVar9) * 0.0625;
            *pdVar9 = dVar14;
            pdVar9 = pdVar9 + 1;
            iVar7 = iVar2;
            dVar13 = dVar11;
            dVar12 = dVar14;
            if ((dVar14 <= dVar11) && (iVar7 = iVar5, dVar13 = dVar10,
                                       dVar12 = dVar11, dVar10 < dVar14)) {
                dVar13 = dVar14;
            }
            dVar14 = pdVar3[3];
            iVar2 = iVar2 + 1;
            pdVar3 = pdVar3 + 4;
            iVar5 = iVar7;
            dVar10 = dVar13;
            dVar11 = dVar12;
        } while (dVar14 != 0.0);
        *(double *)(param_2 + 0x10) = dVar12;
        if (dVar12 <= 0.0)
            goto LAB_00065efc;
        if (0.0 < dVar13) {
            dVar14 = log10(dVar12 / dVar13);
            dVar14 = dVar14 * 20.0;
            if (40.0 < dVar14) {
                dVar12 = *(double *)(param_2 + 0x10);
                goto LAB_00065d78;
            }
            *(double *)(param_2 + 0x18) = dVar14;
            if ((1000.0 <= *(double *)(param_2 + 0x10)) && (3.0 <= dVar14))
                goto LAB_00065e38;
        } else {
        LAB_00065d78:
            *(undefined4 *)(param_2 + 0x18) = 0;
            *(undefined4 *)(param_2 + 0x1c) = 0x40440000;
            if (1000.0 <= dVar12) {
            LAB_00065e38:
                if (*(int *)(param_2 + 4) == iVar7) {
                    iVar5 = *(int *)(param_2 + 8);
                    if (iVar5 < 3) {
                        iVar5 = iVar5 + 1;
                        *(int *)(param_2 + 8) = iVar5;
                    }
                    if (iVar5 == 3) {
                        *(uint *)(iVar6 + 0x10e8) =
                            *(uint *)(iVar6 + 0x10e8) | 4;
                        *(int *)(iVar6 + 0x10d4) = *(int *)(iVar6 + 0x10d4) + 1;
                    }
                } else {
                    iVar2 = *(int *)(param_2 + 8);
                    iVar5 = iVar2;
                    if (0 < iVar2) {
                        iVar5 = iVar2 + -1;
                    }
                    *(uint *)(iVar6 + 0x10ec) = *(uint *)(iVar6 + 0x10ec) | 1;
                    if (0 < iVar2) {
                        *(int *)(param_2 + 8) = iVar5;
                    }
                    if (iVar5 == 0) {
                        *(int *)(param_2 + 4) = iVar7;
                    }
                }
                goto LAB_00065da8;
            }
        }
    }
    *(uint *)(iVar6 + 0x10e8) = *(uint *)(iVar6 + 0x10e8) | 0x40;
LAB_00065da8:
    if (((*(byte *)(piVar8 + 0xc0) & 8) != 0) &&
        ((*(uint *)(iVar6 + 0x10e8) & 8) == 0)) {
        FUN_0007c054(auStack_ac, 0x80,
                     "wwv4 %2d %04x %3d %4d %5.0f %2d %d %d %d %5.0f %5.1f",
                     *(int *)(iVar6 + 0x10d0) + -1, *(uint *)(iVar6 + 0x10e8),
                     *(undefined4 *)(iVar6 + 0x844),
                     *(undefined4 *)(iVar6 + 0x854));
        FUN_00051f44(param_1 + 0x10, auStack_ac);
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00065f80(int param_1, int param_2, int param_3)

{
    uint uVar1;
    byte bVar2;
    int iVar3;
    int iVar4;
    int iVar5;
    int *piVar6;
    double dVar7;
    double dVar8;
    double dVar9;
    undefined1 auStack_ac[128];
    int local_2c;

    piVar6 = *(int **)(param_1 + 0x54);
    dVar7 = *(double *)(param_2 + 8);
    iVar5 = *piVar6;
    dVar8 = *(double *)(param_2 + 0x28);
    iVar4 = *(int *)(iVar5 + 0x894);
    param_3 = iVar4 - param_3;
    iVar3 = param_3 + -0x1900;
    if (iVar3 < 0) {
        iVar3 = param_3 + 0x73a00;
    }
    local_2c = __stack_chk_guard;
    if (dVar7 < dVar8) {
        *(double *)(param_2 + 8) = dVar8;
    }
    dVar9 = dVar8 + *(double *)(param_2 + 0x10);
    if (dVar7 < dVar8) {
        *(int *)(param_2 + 0x18) = iVar3;
    }
    *(double *)(param_2 + 0x10) = dVar9;
    if (iVar4 == 0) {
        dVar7 = *(double *)(param_2 + 8);
        *(double *)(param_2 + 0x38) = dVar7;
        if (dVar7 <= 0.0) {
            dVar8 = 0.0;
        } else {
            dVar8 = (dVar9 - dVar7) / 480000.0;
            if (0.0 < dVar8) {
                dVar9 = log10(dVar7 / dVar8);
                dVar7 = *(double *)(param_2 + 0x38);
                dVar8 = dVar9 * 20.0;
                if (40.0 < dVar9 * 20.0) {
                    dVar8 = 40.0;
                }
            } else {
                dVar8 = 40.0;
            }
        }
        iVar3 = *(int *)(param_2 + 0x18);
        *(double *)(param_2 + 0x40) = dVar8;
        if (*(int *)(param_2 + 0x54) == 0) {
            *(int *)(param_2 + 0x1c) = iVar3;
            iVar4 = 0;
        } else {
            iVar4 = (iVar3 - *(int *)(param_2 + 0x1c)) % 480000;
        }
        uVar1 = *(int *)(param_2 + 0x50) << 1;
        *(uint *)(param_2 + 0x50) = uVar1;
        if ((uVar1 & 0x40) != 0) {
            *(int *)(param_2 + 0x54) = *(int *)(param_2 + 0x54) + -1;
        }
        if ((2500.0 < dVar7) && (20.0 < dVar8)) {
            if (iVar4 + 0x9fU < 0x13f) {
                *(uint *)(param_2 + 0x50) = uVar1 | 1;
                *(int *)(param_2 + 0x54) = *(int *)(param_2 + 0x54) + 1;
                *(int *)(param_2 + 0x1c) = iVar3;
                *(int *)(param_2 + 0x20) = iVar3;
            } else if (*(int *)(param_2 + 0x54) == 1) {
                *(int *)(param_2 + 0x1c) = iVar3;
            }
        }
        if (*(int *)(iVar5 + 0x38) < 7) {
            dVar8 = (double)(longlong) * (int *)(param_2 + 0x54) * 6000.0;
            if (6000.0 <= dVar7) {
                dVar8 = dVar8 + 5999.0;
            } else {
                dVar8 = dVar8 + dVar7;
            }
            *(double *)(param_2 + 0x48) = (dVar8 / 42000.0) * 100.0;
            bVar2 = *(byte *)(piVar6 + 0xc0);
        } else {
            *(undefined4 *)(param_2 + 0x48) = 0;
            *(undefined4 *)(param_2 + 0x4c) = 0;
            bVar2 = *(byte *)(piVar6 + 0xc0);
        }
        if ((bVar2 & 8) != 0) {
            FUN_0007c054(auStack_ac, 0x80,
                         "wwv8 %04x %3d %s %04x %.0f %.0f/%.1f %ld %ld",
                         *(undefined4 *)(iVar5 + 0x10e8),
                         *(undefined4 *)(iVar5 + 0x844), param_2 + 0x5c,
                         *(undefined2 *)(param_2 + 0x50));
            FUN_00051f44(param_1 + 0x10, auStack_ac);
        }
        *(undefined4 *)(param_2 + 0x10) = 0;
        *(undefined4 *)(param_2 + 0x14) = 0;
        *(undefined4 *)(param_2 + 8) = 0;
        *(undefined4 *)(param_2 + 0xc) = 0;
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00066264(int param_1)

{
    double *pdVar1;
    byte bVar2;
    size_t sVar3;
    undefined8 *puVar4;
    uint uVar5;
    int iVar6;
    undefined1 *puVar7;
    undefined1 *extraout_r2;
    undefined4 *puVar8;
    undefined4 *puVar9;
    int iVar10;
    int iVar11;
    uint uVar12;
    undefined4 *puVar13;
    int iVar14;
    undefined4 uVar15;
    int iVar16;
    int *piVar17;
    int iVar18;
    int iVar19;
    char *__s;
    uint uVar20;
    undefined4 *puVar21;
    undefined4 *puVar22;
    undefined4 *puVar23;
    int iVar24;
    undefined4 uVar25;
    int iVar26;
    bool bVar27;
    double in_d0;
    double dVar28;
    int iVar29;
    double dVar30;
    int local_f0;
    uint local_e8;
    int local_e4;
    uint local_e0;
    uint local_dc;
    undefined4 local_bc;
    undefined4 local_b8;
    undefined1 auStack_b4[128];
    int local_34;

    piVar17 = *(int **)(param_1 + 0x54);
    local_34 = __stack_chk_guard;
    iVar18 = *piVar17;
    if (DAT_000cf688 == 0) {
        DAT_000cf688 = 1;
        memset(&DAT_000cf690, 0, 0x1e8);
    }
    iVar24 = *(int *)(iVar18 + 0x10d0);
    uVar5 = iVar24 + 1;
    iVar10 = iVar24 * 8;
    *(uint *)(iVar18 + 0x10d0) = uVar5;
    dVar30 = *(double *)(&DAT_000cf690 + iVar10) +
             (in_d0 - *(double *)(&DAT_000cf690 + iVar10)) * 0.0625;
    *(double *)(&DAT_000cf690 + iVar10) = dVar30;
    puVar7 = progx + iVar10;
    uVar20 = *(uint *)(progx + iVar10 + 4);
    switch (*(undefined4 *)(progx + iVar24 * 8)) {
    case 1:
        uVar5 = *(uint *)(iVar18 + 0x10e8);
        if ((uVar5 & 4) == 0) {
            bVar2 = *(byte *)(piVar17 + 0xc0);
            *(undefined4 *)(&DAT_000cf668 + uVar20) = 0;
            *(undefined4 *)((int)&DAT_000cf668 + uVar20 * 8 + 4) = 0;
            if ((bVar2 & 8) == 0)
                goto LAB_00066594;
            goto LAB_0006660c;
        }
        (&DAT_000cf668)[uVar20] = in_d0;
        goto LAB_00066594;
    case 2:
        (&DAT_000cf668)[uVar20] = in_d0;
        break;
    case 3:
        *(undefined4 *)(&DAT_000cf668 + uVar20) = 0;
        *(undefined4 *)((int)&DAT_000cf668 + uVar20 * 8 + 4) = 0;
        break;
    case 4:
        iVar10 = 0x8d8;
        goto LAB_00066770;
    case 5:
        iVar10 = 0x7c0;
        goto LAB_00066770;
    case 6:
        iVar10 = 0x668;
        goto LAB_00066770;
    case 7:
        iVar10 = 0x810;
    LAB_00066770:
        FUN_00065c88(param_1, iVar18 + uVar20 * 0x70 + 0xce0,
                     *(undefined4 *)((int)&__DT_PLTGOT + iVar10));
        bVar2 = *(byte *)(piVar17 + 0xc0);
        goto joined_r0x00066790;
    case 8:
        goto LAB_0006670c;
    case 9:
        FUN_00065c88(param_1, iVar18 + 0x1060, bcd9);
        dVar30 = *(double *)(&DAT_000cf690 + iVar10);
        puVar7 = extraout_r2;
    LAB_0006670c:
        if (dVar30 <= 1000.0) {
            if (-1000.0 <= dVar30) {
                *(uint *)(iVar18 + 0x10e8) = *(uint *)(iVar18 + 0x10e8) | 0x40;
            } else {
                bVar27 = (*(uint *)(iVar18 + 0x10f0) & uVar20) != 0;
                if (bVar27) {
                    puVar7 = *(undefined1 **)(iVar18 + 0x10ec);
                }
                *(uint *)(iVar18 + 0x10f0) =
                    *(uint *)(iVar18 + 0x10f0) & ~uVar20;
                if (bVar27) {
                    *(uint *)(iVar18 + 0x10ec) = (uint)puVar7 | 1;
                }
            }
        } else {
            bVar27 = (*(uint *)(iVar18 + 0x10f0) & uVar20) == 0;
            if (bVar27) {
                puVar7 = *(undefined1 **)(iVar18 + 0x10ec);
            }
            *(uint *)(iVar18 + 0x10f0) = *(uint *)(iVar18 + 0x10f0) | uVar20;
            if (bVar27) {
                *(uint *)(iVar18 + 0x10ec) = (uint)puVar7 | 1;
            }
        }
        break;
    case 10:
        uVar12 = *(uint *)(iVar18 + 0x10e8);
        if (1000.0 < dVar30) {
            bVar27 = (*(uint *)(iVar18 + 0x10f0) & uVar20) == 0;
            if (bVar27) {
                uVar5 = *(uint *)(iVar18 + 0x10ec);
            }
            *(uint *)(iVar18 + 0x10f0) = *(uint *)(iVar18 + 0x10f0) | uVar20;
            if (bVar27) {
                *(uint *)(iVar18 + 0x10ec) = uVar5 | 1;
            }
        } else if (-1000.0 <= dVar30) {
            uVar12 = uVar12 | 0x40;
        } else {
            bVar27 = (*(uint *)(iVar18 + 0x10f0) & uVar20) != 0;
            if (bVar27) {
                uVar5 = *(uint *)(iVar18 + 0x10ec);
            }
            *(uint *)(iVar18 + 0x10f0) = *(uint *)(iVar18 + 0x10f0) & ~uVar20;
            if (bVar27) {
                *(uint *)(iVar18 + 0x10ec) = uVar5 | 1;
            }
        }
        *(uint *)(iVar18 + 0x10e8) = uVar12 & 0xfffffcff;
        if (*(int *)(iVar18 + 0x30) < 1) {
            *(undefined4 *)(*(int *)(iVar18 + 0xcdc) * 0xd8 + iVar18 + 0x898) =
                *(undefined4 *)(iVar18 + 0x844);
        } else {
            uVar15 = *(undefined4 *)(param_1 + 0x54);
            *(int *)(iVar18 + 0xcd8) = (*(int *)(iVar18 + 0xcd8) + 1) % 5;
            FUN_00065620(*(undefined4 *)(param_1 + 0x4c), uVar15);
        }
        break;
    case 0xb:
        uVar5 = *(uint *)(iVar18 + 0x10e8);
        if ((uVar5 & 0x1000) == 0)
            goto LAB_00066868;
        break;
    case 0xc:
        uVar5 = *(uint *)(iVar18 + 0x10e8);
    LAB_00066868:
        puVar8 = *(undefined4 **)(param_1 + 0x54);
        *(uint *)(iVar18 + 0x10e8) = uVar5 & 0xffffefff;
        puVar23 = (undefined4 *)*puVar8;
        puVar13 = (undefined4 *)puVar23[0x338];
        puVar21 = (undefined4 *)(puVar23[0x339] + 1);
        puVar23[0x339] = puVar21;
        puVar9 = puVar8;
        if (puVar21 == puVar13) {
            puVar9 = (undefined4 *)0x0;
        }
        iVar10 = (int)puVar13 + -1;
        if (puVar21 == puVar13) {
            puVar23[0x339] = puVar9;
            puVar21 = puVar9;
        }
        dVar30 = *(double *)(puVar23 + (int)puVar13 * 2 + 0x33e);
        if (0 < iVar10) {
            puVar4 = (undefined8 *)(puVar23 + (int)puVar13 * 2 + 0x33e);
            do {
                iVar10 = iVar10 + -1;
                *puVar4 = puVar4[-1];
                puVar4 = puVar4 + -1;
            } while (iVar10 != 0);
        }
        iVar19 = puVar23[0x3c5];
        iVar10 = puVar23[0x3a9];
        puVar9 = (undefined4 *)puVar23[0x3e1];
        local_e0 = puVar23[0x43a];
        local_dc = puVar23[0x43c];
        local_f0 = (int)puVar9 * 100 + iVar10 + iVar19 * 10;
        uVar5 = puVar23[0x3fd];
        local_e8 = local_dc & 0x40;
        *(double *)(puVar23 + 0x340) = (double)(longlong)(int)(longlong)dVar30;
        if ((local_e0 & 4) == 0) {
            iVar6 = puVar23[0x38d];
            local_e4 = (int)puVar21 + puVar23[0x355] * 10;
            iVar11 = puVar23[0x371];
            iVar10 = uVar5 + puVar23[0x419] * 10;
        } else {
            if (puVar21 == (undefined4 *)0x0) {
                iVar6 = puVar23[0x355];
                iVar26 = puVar23[0x354];
                iVar11 = iVar6 + 1;
                puVar23[0x355] = iVar11;
                if (iVar11 == iVar26) {
                    puVar23[0x355] = 0;
                    iVar14 = (int)(longlong) *
                             (double *)(puVar23 + iVar6 * 2 + 0x35c);
                    local_e4 = 0;
                    if (0 < iVar6) {
                        iVar11 = 0;
                        goto LAB_00066c98;
                    }
                    *(double *)(puVar23 + 0x35c) = (double)(longlong)iVar14;
                } else {
                    iVar6 = iVar26 + -1;
                    local_e4 = iVar11 * 10;
                    iVar14 = (int)(longlong) *
                             (double *)(puVar23 + iVar26 * 2 + 0x35a);
                    if (0 < iVar6) {
                    LAB_00066c98:
                        puVar21 = puVar23 + iVar26 * 2 + 0x35a;
                        do {
                            iVar6 = iVar6 + -1;
                            *puVar21 = puVar21[-2];
                            puVar21[1] = puVar21[-1];
                            puVar21 = puVar21 + -2;
                        } while (iVar6 != 0);
                    }
                    *(double *)(puVar23 + 0x35c) = (double)(longlong)iVar14;
                    if (iVar11 != 0) {
                        iVar11 = puVar23[0x371];
                        iVar6 = puVar23[0x38d];
                        iVar26 = iVar6 * 600 + iVar11 * 0x3c + local_e4;
                        goto LAB_00066970;
                    }
                }
                iVar6 = puVar23[0x371];
                iVar14 = puVar23[0x370];
                iVar11 = iVar6 + 1;
                puVar23[0x371] = iVar11;
                if (iVar11 == iVar14) {
                    iVar11 = 0;
                    dVar30 = *(double *)(puVar23 + iVar6 * 2 + 0x378);
                    puVar23[0x371] = 0;
                    iVar16 = (int)(longlong)dVar30;
                    iVar26 = local_e4;
                    if (0 < iVar6)
                        goto LAB_00066d0c;
                    *(double *)(puVar23 + 0x378) = (double)(longlong)iVar16;
                } else {
                    iVar6 = iVar14 + -1;
                    iVar16 = (int)(longlong) *
                             (double *)(puVar23 + iVar14 * 2 + 0x376);
                    iVar26 = local_e4 + iVar11 * 0x3c;
                    if (0 < iVar6) {
                    LAB_00066d0c:
                        puVar4 = (undefined8 *)(puVar23 + iVar14 * 2 + 0x376);
                        do {
                            iVar6 = iVar6 + -1;
                            *puVar4 = puVar4[-1];
                            puVar4 = puVar4 + -1;
                        } while (iVar6 != 0);
                    }
                    *(double *)(puVar23 + 0x378) = (double)(longlong)iVar16;
                    if (iVar11 != 0) {
                        iVar6 = puVar23[0x38d];
                        iVar26 = iVar6 * 600 + iVar26;
                        goto LAB_00066970;
                    }
                }
                iVar14 = puVar23[0x38c];
                iVar11 = puVar23[0x38d] + 1;
                puVar23[0x38d] = iVar11;
                if (iVar11 == iVar14) {
                    iVar6 = 0;
                } else {
                    iVar6 = 600;
                }
                dVar30 = *(double *)(puVar23 + iVar14 * 2 + 0x392);
                if (iVar11 == iVar14) {
                    puVar23[0x38d] = iVar6;
                } else {
                    iVar26 = iVar6 * iVar11 + iVar26;
                    iVar6 = iVar11;
                }
                iVar11 = iVar14 + -1;
                if (0 < iVar11) {
                    puVar21 = puVar23 + iVar14 * 2 + 0x392;
                    do {
                        iVar11 = iVar11 + -1;
                        *puVar21 = puVar21[-2];
                        puVar21[1] = puVar21[-1];
                        puVar21 = puVar21 + -2;
                    } while (iVar11 != 0);
                }
                *(double *)(puVar23 + 0x394) =
                    (double)(longlong)(int)(longlong)dVar30;
                iVar11 = 0;
            } else {
                iVar11 = puVar23[0x371];
                iVar6 = puVar23[0x38d];
                local_e4 = (int)puVar21 + puVar23[0x355] * 10;
                iVar26 = iVar6 * 600 + local_e4 + iVar11 * 0x3c;
            }
        LAB_00066970:
            if ((local_e8 != 0) && ((local_e0 & 8) != 0)) {
                if ((uVar5 & 3) == 0) {
                    if (local_f0 != 0xb7) {
                        iVar14 = 0x16e;
                        goto LAB_000669ac;
                    }
                } else if (local_f0 != 0xb6) {
                    iVar14 = 0x16d;
                LAB_000669ac:
                    if (iVar14 != local_f0)
                        goto LAB_000669b8;
                }
                if (iVar26 == 0x59f) {
                    local_e0 = local_e0 | 0x1000;
                    puVar23[0x43a] = local_e0;
                    iVar10 = uVar5 + puVar23[0x419] * 10;
                    goto LAB_000669d4;
                }
            }
        LAB_000669b8:
            if (iVar26 == 0x5a0) {
                iVar14 = puVar23[0x370];
                iVar26 = iVar14 + -1;
                do {
                    iVar11 = iVar11 + 1;
                    puVar4 = (undefined8 *)(puVar23 + iVar14 * 2 + 0x376);
                    iVar16 = iVar26;
                    if (iVar11 == iVar14) {
                        iVar29 = (int)(longlong) *
                                 (double *)(puVar23 + (iVar14 + 3) * 2 + 0x370);
                        if (iVar26 < 1) {
                            *(double *)(puVar23 + 0x378) =
                                (double)(longlong)iVar29;
                            break;
                        }
                        iVar11 = 0;
                    LAB_000670c8:
                        do {
                            iVar16 = iVar16 + -1;
                            *puVar4 = puVar4[-1];
                            puVar4 = puVar4 + -1;
                        } while (iVar16 != 0);
                    } else {
                        iVar29 = (int)(longlong) *
                                 (double *)(puVar23 + (iVar14 + 3) * 2 + 0x370);
                        if (0 < iVar26)
                            goto LAB_000670c8;
                    }
                    *(double *)(puVar23 + 0x378) = (double)(longlong)iVar29;
                } while (iVar11 != 0);
                iVar26 = puVar23[0x38c];
                puVar23[0x371] = 0;
                iVar11 = iVar26 + -1;
                do {
                    iVar6 = iVar6 + 1;
                    puVar4 = (undefined8 *)(puVar23 + iVar26 * 2 + 0x392);
                    iVar14 = iVar11;
                    if (iVar6 == iVar26) {
                        iVar16 = (int)(longlong) *
                                 (double *)(puVar23 + (iVar26 + 3) * 2 + 0x38c);
                        if (iVar11 < 1) {
                            *(double *)(puVar23 + 0x394) =
                                (double)(longlong)iVar16;
                            break;
                        }
                        iVar6 = 0;
                    LAB_00067138:
                        do {
                            iVar14 = iVar14 + -1;
                            *puVar4 = puVar4[-1];
                            puVar4 = puVar4 + -1;
                        } while (iVar14 != 0);
                    } else {
                        iVar16 = (int)(longlong) *
                                 (double *)(puVar23 + (iVar26 + 3) * 2 + 0x38c);
                        if (0 < iVar11)
                            goto LAB_00067138;
                    }
                    *(double *)(puVar23 + 0x394) = (double)(longlong)iVar16;
                } while (iVar6 != 0);
                iVar26 = puVar23[0x3a8];
                iVar11 = local_f0 + 1;
                iVar6 = iVar26 + -1;
                local_f0 = iVar10 + 1;
                puVar23[0x3a9] = local_f0;
                if (local_f0 == iVar26) {
                    puVar23[0x3a9] = 0;
                }
                puVar23[0x38d] = 0;
                dVar30 = *(double *)(puVar23 + iVar26 * 2 + 0x3ae);
                if (local_f0 == iVar26) {
                    local_f0 = 0;
                }
                if (0 < iVar6) {
                    iVar10 = iVar6;
                    puVar4 = (undefined8 *)(puVar23 + iVar26 * 2 + 0x3ae);
                    do {
                        iVar10 = iVar10 + -1;
                        *puVar4 = puVar4[-1];
                        puVar4 = puVar4 + -1;
                    } while (iVar10 != 0);
                }
                *(double *)(puVar23 + 0x3b0) =
                    (double)(longlong)(int)(longlong)dVar30;
                if (local_f0 == 0) {
                    puVar13 = (undefined4 *)puVar23[0x3c4];
                    puVar21 = (undefined4 *)(iVar19 + 1);
                    puVar23[0x3c5] = puVar21;
                    if (puVar21 == puVar13) {
                        puVar21 = puVar23 + iVar19 * 2 + 0x3c4;
                        puVar23[0x3c5] = 0;
                        pdVar1 = (double *)(puVar21 + 8);
                        if (0 < iVar19) {
                            puVar21 = (undefined4 *)0x0;
                        }
                        iVar10 = (int)(longlong)*pdVar1;
                        puVar22 = (undefined4 *)0x0;
                        if (0 < iVar19)
                            goto LAB_000673b8;
                        *(double *)(puVar23 + 0x3cc) = (double)(longlong)iVar10;
                    } else {
                        puVar22 = puVar23 + (int)puVar13 * 2 + 0x3c4;
                        iVar19 = (int)puVar13 + -1;
                        iVar10 = (int)(longlong) * (double *)(puVar22 + 6);
                        if (0 < iVar19) {
                        LAB_000673b8:
                            puVar4 = (undefined8 *)(puVar23 + (int)puVar13 * 2 +
                                                    0x3ca);
                            do {
                                iVar19 = iVar19 + -1;
                                *puVar4 = puVar4[-1];
                                puVar4 = puVar4 + -1;
                            } while (iVar19 != 0);
                        }
                        if (puVar21 != (undefined4 *)0x0) {
                            puVar22 = (undefined4 *)puVar23[0x3e1];
                        }
                        *(double *)(puVar23 + 0x3cc) = (double)(longlong)iVar10;
                        if (puVar21 != (undefined4 *)0x0)
                            goto LAB_000671f0;
                    }
                    puVar21 = (undefined4 *)puVar23[0x3e0];
                    puVar22 = (undefined4 *)((int)puVar9 + 1);
                    puVar23[0x3e1] = puVar22;
                    if (puVar22 == puVar21) {
                        puVar9 = (undefined4 *)0x0;
                    }
                    dVar30 = *(double *)(puVar23 + (int)puVar21 * 2 + 0x3e6);
                    if (puVar22 == puVar21) {
                        puVar23[0x3e1] = puVar9;
                        puVar22 = puVar9;
                    }
                    iVar10 = (int)puVar21 + -1;
                    if (0 < iVar10) {
                        puVar4 =
                            (undefined8 *)(puVar23 + (int)puVar21 * 2 + 0x3e6);
                        do {
                            iVar10 = iVar10 + -1;
                            *puVar4 = puVar4[-1];
                            puVar4 = puVar4 + -1;
                        } while (iVar10 != 0);
                    }
                    puVar21 = (undefined4 *)0x0;
                    *(double *)(puVar23 + 1000) =
                        (double)(longlong)(int)(longlong)dVar30;
                } else {
                    puVar21 = (undefined4 *)puVar23[0x3c5];
                    puVar22 = (undefined4 *)puVar23[0x3e1];
                }
            LAB_000671f0:
                iVar10 = 0x16e;
                if ((uVar5 & 3) != 0) {
                    iVar10 = 0x16d;
                }
                if (iVar11 == iVar10) {
                LAB_000674f0:
                    do {
                        local_f0 = local_f0 + 1;
                        puVar4 = (undefined8 *)(puVar23 + iVar26 * 2 + 0x3ae);
                        iVar10 = iVar6;
                        if (iVar26 == local_f0) {
                            iVar19 = (int)(longlong) *
                                     (double *)(puVar23 + iVar26 * 2 + 0x3ae);
                            if (iVar6 < 1) {
                                local_f0 = 0;
                                *(double *)(puVar23 + 0x3b0) =
                                    (double)(longlong)iVar19;
                                goto LAB_000674f0;
                            }
                            local_f0 = 0;
                        LAB_00067514:
                            do {
                                iVar10 = iVar10 + -1;
                                *puVar4 = puVar4[-1];
                                puVar4 = puVar4 + -1;
                            } while (iVar10 != 0);
                        } else {
                            iVar19 = (int)(longlong) *
                                     (double *)(puVar23 + iVar26 * 2 + 0x3ae);
                            if (0 < iVar6)
                                goto LAB_00067514;
                        }
                        *(double *)(puVar23 + 0x3b0) = (double)(longlong)iVar19;
                    } while (local_f0 != 1);
                    puVar9 = (undefined4 *)puVar23[0x3c4];
                    puVar23[0x3a9] = 1;
                    iVar10 = (int)puVar9 + -1;
                    do {
                        puVar21 = (undefined4 *)((int)puVar21 + 1);
                        puVar4 =
                            (undefined8 *)(puVar23 + (int)puVar9 * 2 + 0x3ca);
                        iVar19 = iVar10;
                        if (puVar21 == puVar9) {
                            iVar11 = (int)(longlong) *
                                     (double *)(puVar23 +
                                                ((int)puVar9 + 3) * 2 + 0x3c4);
                            if (iVar10 < 1) {
                                *(double *)(puVar23 + 0x3cc) =
                                    (double)(longlong)iVar11;
                                break;
                            }
                            puVar21 = (undefined4 *)0x0;
                        LAB_00067594:
                            do {
                                iVar19 = iVar19 + -1;
                                *puVar4 = puVar4[-1];
                                puVar4 = puVar4 + -1;
                            } while (iVar19 != 0);
                        } else {
                            iVar11 = (int)(longlong) *
                                     (double *)(puVar23 +
                                                ((int)puVar9 + 3) * 2 + 0x3c4);
                            if (0 < iVar10)
                                goto LAB_00067594;
                        }
                        *(double *)(puVar23 + 0x3cc) = (double)(longlong)iVar11;
                    } while (puVar21 != (undefined4 *)0x0);
                    puVar21 = (undefined4 *)puVar23[0x3e0];
                    puVar23[0x3c5] = 0;
                    iVar10 = (int)puVar21 + -1;
                    do {
                        puVar22 = (undefined4 *)((int)puVar22 + 1);
                        dVar30 = *(double *)(puVar23 + ((int)puVar21 + 3) * 2 +
                                             0x3e0);
                        if (puVar22 == puVar21) {
                            if (iVar10 < 1) {
                                *(double *)(puVar23 + 1000) =
                                    (double)(longlong)(int)(longlong)dVar30;
                                break;
                            }
                            puVar22 = (undefined4 *)0x0;
                        LAB_000675fc:
                            iVar19 = (int)(longlong)dVar30;
                            puVar4 = (undefined8 *)(puVar23 + (int)puVar21 * 2 +
                                                    0x3e6);
                            iVar11 = iVar10;
                            do {
                                iVar11 = iVar11 + -1;
                                *puVar4 = puVar4[-1];
                                puVar4 = puVar4 + -1;
                            } while (iVar11 != 0);
                        } else {
                            iVar19 = (int)(longlong)dVar30;
                            if (0 < iVar10)
                                goto LAB_000675fc;
                        }
                        *(double *)(puVar23 + 1000) = (double)(longlong)iVar19;
                    } while (puVar22 != (undefined4 *)0x0);
                    puVar9 = (undefined4 *)puVar23[0x3fc];
                    puVar23[0x3e1] = 0;
                    puVar21 = (undefined4 *)(uVar5 + 1);
                    puVar23[0x3fd] = puVar21;
                    local_f0 = 1;
                    if (puVar21 == puVar9) {
                        puVar23[0x3fd] = 0;
                        puVar21 = puVar23 + uVar5 * 2 + 0x3fc;
                        pdVar1 = (double *)(puVar21 + 8);
                        if (0 < (int)uVar5) {
                            puVar21 = (undefined4 *)0x0;
                        }
                        iVar10 = (int)(longlong)*pdVar1;
                        if (0 < (int)uVar5)
                            goto LAB_00067660;
                        *(double *)(puVar23 + 0x404) = (double)(longlong)iVar10;
                    } else {
                        uVar5 = (int)puVar9 - 1;
                        iVar10 = (int)(longlong) *
                                 (double *)(puVar23 + (int)puVar9 * 2 + 0x402);
                        if (0 < (int)uVar5) {
                        LAB_00067660:
                            puVar9 = puVar23 + (int)puVar9 * 2 + 0x402;
                            do {
                                uVar5 = uVar5 - 1;
                                *puVar9 = puVar9[-2];
                                puVar9[1] = puVar9[-1];
                                puVar9 = puVar9 + -2;
                            } while (uVar5 != 0);
                        }
                        *(double *)(puVar23 + 0x404) = (double)(longlong)iVar10;
                        if (puVar21 != (undefined4 *)0x0) {
                            iVar6 = 0;
                            iVar11 = 0;
                            iVar10 = (int)puVar21 + puVar23[0x419] * 10;
                            goto LAB_000669d4;
                        }
                    }
                    iVar19 = puVar23[0x418];
                    iVar10 = puVar23[0x419] + 1;
                    puVar23[0x419] = iVar10;
                    if (iVar10 == iVar19) {
                        iVar10 = 0;
                        puVar23[0x419] = 0;
                    } else {
                        iVar10 = iVar10 * 10;
                    }
                    iVar11 = iVar19 + -1;
                    dVar30 = *(double *)(puVar23 + iVar19 * 2 + 0x41e);
                    if (0 < iVar11) {
                        puVar21 = puVar23 + iVar19 * 2 + 0x41e;
                        do {
                            iVar11 = iVar11 + -1;
                            *puVar21 = puVar21[-2];
                            puVar21[1] = puVar21[-1];
                            puVar21 = puVar21 + -2;
                        } while (iVar11 != 0);
                    }
                    iVar6 = 0;
                    iVar11 = 0;
                    *(double *)(puVar23 + 0x420) =
                        (double)(longlong)(int)(longlong)dVar30;
                } else {
                    iVar6 = 0;
                    local_f0 =
                        (int)puVar22 * 100 + local_f0 + (int)puVar21 * 10;
                    iVar10 = uVar5 + puVar23[0x419] * 10;
                    iVar11 = iVar6;
                }
            } else {
                iVar10 = uVar5 + puVar23[0x419] * 10;
            }
        }
    LAB_000669d4:
        *(undefined4 *)(iVar18 + 0x10d0) = 0;
        uVar5 = puVar23[0x43b];
        if ((local_e0 & 2) == 0) {
            uVar5 = uVar5 | 8;
            puVar23[0x43b] = uVar5;
            if ((int)puVar23[0x435] < 9) {
            LAB_00066a04:
                puVar23[0x43b] = uVar5 | 4;
            }
        } else {
            if ((int)puVar23[0x435] < 9)
                goto LAB_00066a04;
            if (uVar5 == 0) {
                puVar23[0x43a] = local_e0 | 8;
            }
        }
        if ((puVar23[0x43a] & 10) == 10) {
            iVar11 = iVar11 + iVar6 * 10;
            if (local_e8 == 0) {
                *(undefined1 *)(puVar8 + 10) = 0;
            } else {
                *(undefined1 *)(puVar8 + 10) = 1;
            }
            local_bc = 0;
            uVar15 = puVar23[0x434];
            puVar8[0x32] = local_e4;
            puVar8[0x2f] = iVar10 + 2000;
            puVar8[0x31] = iVar11;
            puVar8[0x33] = uVar15;
            puVar8[0x30] = local_f0;
            local_b8 = 0;
            iVar10 = FUN_000733d8(local_f0, iVar11, local_e4, uVar15, 0,
                                  *puVar23, puVar8 + 0x35, &local_bc);
            if (iVar10 == 0) {
                local_f0 =
                    puVar23[0x3e1] * 100 + puVar23[0x3a9] + puVar23[0x3c5] * 10;
                local_dc = puVar23[0x43c];
                puVar23[0xd] = 6;
                iVar10 = puVar23[0x3fd] + puVar23[0x419] * 10;
                iVar11 = puVar23[0x371];
                iVar6 = puVar23[0x38d];
                local_e4 = puVar23[0x339] + puVar23[0x355] * 10;
                local_e8 = local_dc & 0x40;
            } else {
                dVar30 = *(double *)(puVar23 + 10);
                uVar15 = *puVar23;
                uVar25 = puVar23[1];
                puVar23[0xe] = 0;
                *(undefined8 *)(puVar8 + 0x3e) = 0;
                puVar8[0x38] = uVar15;
                puVar8[0x39] = uVar25;
                FUN_00049a70(SUB84(dVar30 + 0.0051600000000000005, 0), puVar8,
                             local_bc, local_b8, *puVar23, uVar25);
                FUN_00049d44(param_1);
                local_e4 = puVar23[0x339] + puVar23[0x355] * 10;
                local_dc = puVar23[0x43c];
                local_f0 =
                    puVar23[0x3e1] * 100 + puVar23[0x3a9] + puVar23[0x3c5] * 10;
                iVar11 = puVar23[0x371];
                iVar6 = puVar23[0x38d];
                iVar10 = puVar23[0x3fd] + puVar23[0x419] * 10;
                local_e8 = local_dc & 0x40;
            }
        }
        uVar5 = local_dc & 7;
        uVar20 = (uint) * (byte *)((int)&dstcod + ((local_dc << 0x1a) >> 0x1e));
        if ((puVar23[0x43a] & 8) == 0) {
            uVar15 = 0x3f;
        } else {
            uVar15 = 0x20;
        }
        if (local_e8 == 0) {
            uVar25 = 0x20;
        } else {
            uVar25 = 0x4c;
        }
        if ((local_dc & 8) == 0) {
            uVar5 = -uVar5;
        }
        __s = (char *)(puVar8 + 0xe);
        FUN_0007c054(__s, 0x80, "%c%1X", uVar15, puVar23[0x43b]);
        FUN_0007c054(auStack_b4, 0x32, " %4d %03d %02d:%02d:%02d %c%c %+d",
                     iVar10 + 2000, local_f0, iVar11 + iVar6 * 10, local_e4, 0,
                     uVar25, uVar20, uVar5);
        FUN_0007d58c(__s, auStack_b4, 0x80);
        FUN_0007c054(
            auStack_b4, 0x32, " %d %d %s %.0f %d %.1f %d", puVar23[0xe],
            puVar23[puVar23[0x335] * 0x36 + 0x226], puVar23[0x334] + 0x5c,
            *(undefined8 *)(puVar23[0x334] + 0x48), puVar23[0x43d], uVar20,
            (*(double *)(puVar23 + 6) / 8000.0) * 1000000.0, puVar23[0x214]);
        FUN_0007d58c(__s, auStack_b4, 0x80);
        sVar3 = strlen(__s);
        puVar8[0x2e] = sVar3;
        FUN_00051f44(param_1 + 0x10, __s);
        if ((*(byte *)(piVar17 + 0xc0) & 8) == 0)
            goto LAB_00066594;
        goto LAB_00066588;
    case 0xd:
        iVar10 = *(int *)(iVar18 + 0xcdc) * 0xd8 + iVar18;
        *(undefined4 *)(iVar10 + 0x8d8) = *(undefined4 *)(iVar10 + 0x8d0);
        *(undefined4 *)(iVar10 + 0x8dc) = *(undefined4 *)(iVar10 + 0x8d4);
        *(undefined4 *)(iVar10 + 0x940) = *(undefined4 *)(iVar10 + 0x938);
        *(undefined4 *)(iVar10 + 0x944) = *(undefined4 *)(iVar10 + 0x93c);
        break;
    case 0xe:
        iVar19 = *(int *)(iVar18 + 0xcdc);
        iVar10 = iVar19 * 0xd8 + iVar18;
        dVar30 = *(double *)(iVar10 + 0x8d8);
        if (dVar30 <= 0.0) {
            dVar30 = 0.0;
        } else {
            dVar28 = *(double *)(iVar10 + 0x8c8);
            if (0.0 < dVar28) {
                dVar30 = log10(dVar30 / dVar28);
                dVar30 = dVar30 * 20.0;
                if (dVar30 <= 40.0)
                    goto LAB_00066378;
            }
            dVar30 = 40.0;
        }
    LAB_00066378:
        iVar10 = iVar19 * 0xd8 + iVar18;
        *(double *)(iVar10 + 0x8e0) = dVar30;
        uVar5 = *(int *)(iVar10 + 0x8f0) << 1;
        *(uint *)(iVar10 + 0x8f0) = uVar5;
        if ((uVar5 & 0x40) != 0) {
            *(int *)(iVar10 + 0x8f4) = *(int *)(iVar10 + 0x8f4) + -1;
        }
        iVar10 = iVar19 * 0xd8 + iVar18;
        dVar30 = *(double *)(iVar10 + 0x8d8);
        if (((dVar30 < 2500.0) || (*(double *)(iVar10 + 0x8e0) < 20.0)) ||
            ((*(uint *)(iVar18 + 0x10e8) & 0x60) != 0)) {
            iVar11 = *(int *)(iVar10 + 0x8f4);
        } else {
            iVar11 = *(int *)(iVar10 + 0x8f4) + 1;
            *(uint *)(iVar10 + 0x8f0) = *(uint *)(iVar10 + 0x8f0) | 1;
            *(int *)(iVar10 + 0x8f4) = iVar11;
            dVar30 = *(double *)(iVar10 + 0x8d8);
        }
        iVar10 = iVar19 * 0xd8 + iVar18;
        if (6000.0 <= dVar30) {
            dVar30 = 5999.0;
        }
        *(double *)(iVar10 + 0x8e8) =
            (((double)(longlong)iVar11 * 6000.0 + dVar30) / 42000.0) * 100.0;
        if (*(double *)(iVar10 + 0x940) <= 0.0) {
            dVar30 = 0.0;
        } else {
            if (0.0 < *(double *)(iVar10 + 0x930)) {
                dVar30 = log10(*(double *)(iVar10 + 0x940) /
                               *(double *)(iVar10 + 0x930));
                dVar30 = dVar30 * 20.0;
                if (dVar30 <= 40.0)
                    goto LAB_00066474;
            }
            dVar30 = 40.0;
        }
    LAB_00066474:
        iVar11 = iVar19 * 0xd8 + iVar18;
        iVar10 = iVar19 * 0xd8 + iVar18;
        *(double *)(iVar11 + 0x948) = dVar30;
        uVar5 = *(int *)(iVar11 + 0x958) << 1;
        *(uint *)(iVar11 + 0x958) = uVar5;
        if ((uVar5 & 0x40) != 0) {
            *(int *)(iVar11 + 0x95c) = *(int *)(iVar11 + 0x95c) + -1;
        }
        dVar30 = *(double *)(iVar10 + 0x940);
        uVar5 = *(uint *)(iVar18 + 0x10e8);
        if (((dVar30 < 2500.0) || (*(double *)(iVar10 + 0x948) < 20.0)) ||
            ((uVar5 & 0x60) != 0)) {
            iVar11 = *(int *)(iVar10 + 0x95c);
        } else {
            iVar11 = *(int *)(iVar10 + 0x95c) + 1;
            *(uint *)(iVar10 + 0x958) = *(uint *)(iVar10 + 0x958) | 1;
            *(int *)(iVar10 + 0x95c) = iVar11;
            dVar30 = *(double *)(iVar10 + 0x940);
        }
        iVar19 = iVar19 * 0xd8;
        iVar10 = iVar18 + iVar19;
        if (6000.0 <= dVar30) {
            dVar30 = 5999.0;
        }
        dVar30 =
            (((double)(longlong)iVar11 * 6000.0 + dVar30) / 42000.0) * 100.0;
        *(double *)(iVar10 + 0x950) = dVar30;
        if ((*(byte *)(piVar17 + 0xc0) & 8) != 0) {
            FUN_0007c054(
                auStack_b4, 0x80,
                "wwv5 %04x %3d %4d %.0f/%.1f %.0f/%.1f %s %04x %.0f %.0f/%.1f "
                "%s %04x %.0f %.0f/%.1f",
                uVar5, *(undefined4 *)(iVar18 + 0x844),
                *(undefined4 *)(iVar18 + 0x854),
                *(undefined4 *)(iVar18 + 0x860),
                *(undefined4 *)(iVar18 + 0x864),
                *(undefined4 *)(iVar18 + 0x868),
                *(undefined4 *)(iVar18 + 0x86c),
                *(undefined4 *)(iVar18 + 0x10d8),
                *(undefined4 *)(iVar18 + 0x10dc),
                *(undefined4 *)(iVar18 + 0x10e0),
                *(undefined4 *)(iVar18 + 0x10e4), iVar18 + iVar19 + 0x8fc,
                *(uint *)(iVar10 + 0x8f0) & 0xffff,
                *(undefined4 *)(iVar10 + 0x8e8),
                *(undefined4 *)(iVar10 + 0x8ec),
                *(undefined4 *)(iVar10 + 0x8d8),
                *(undefined4 *)(iVar10 + 0x8dc),
                *(undefined4 *)(iVar10 + 0x8e0),
                *(undefined4 *)(iVar10 + 0x8e4), iVar18 + iVar19 + 0x964,
                *(uint *)(iVar10 + 0x958) & 0xffff, dVar30,
                *(undefined4 *)(iVar10 + 0x940),
                *(undefined4 *)(iVar10 + 0x944),
                *(undefined4 *)(iVar10 + 0x948),
                *(undefined4 *)(iVar10 + 0x94c));
            FUN_00051f44(param_1 + 0x10, auStack_b4);
            uVar5 = *(uint *)(iVar18 + 0x10e8);
        }
        *(undefined4 *)(iVar18 + 0x10ec) = 0;
        *(undefined4 *)(iVar18 + 0x10d4) = 0;
        *(undefined4 *)(iVar18 + 0x10f4) = 0;
        iVar10 = *(int *)(iVar18 + 0x38);
        if ((uVar5 & 8) == 0) {
            if ((uVar5 & 4) == 0) {
                if (0xf < iVar10)
                    goto LAB_00066f48;
            } else if (0x28 < iVar10) {
            LAB_00066f48:
                FUN_00065870(param_1);
                goto LAB_000665a4;
            }
        } else if (0xb40 < iVar10)
            goto LAB_00066f48;
        FUN_000656c0(param_1);
    }
    bVar2 = *(byte *)(piVar17 + 0xc0);
joined_r0x00066790:
    if ((bVar2 & 8) != 0) {
    LAB_00066588:
        uVar5 = *(uint *)(iVar18 + 0x10e8);
        if ((uVar5 & 4) == 0) {
        LAB_0006660c:
            FUN_0007c054(auStack_b4, 0x80,
                         "wwv3 %2d %04x %3d %4d %5.0f %5.1f %5.0f %5.1f %5.0f",
                         iVar24, uVar5, *(undefined4 *)(iVar18 + 0x844),
                         *(undefined4 *)(iVar18 + 0x854));
            FUN_00051f44(param_1 + 0x10, auStack_b4);
        }
    }
LAB_00066594:
    *(double *)(piVar17 + 0x3e) = *(double *)(piVar17 + 0x3e) + 5e-06;
LAB_000665a4:
    if (local_34 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Globals starting with '_' overlap smaller symbols at the same
 * address */

void FUN_00067878(int param_1)

{
    byte bVar1;
    undefined8 *puVar2;
    undefined8 *puVar3;
    int *piVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    undefined8 *puVar9;
    int iVar10;
    uint uVar11;
    undefined8 *puVar12;
    double *pdVar13;
    int iVar14;
    uint uVar15;
    int iVar16;
    bool bVar17;
    double in_d0;
    double dVar18;
    double dVar19;
    double dVar20;
    double dVar21;
    double dVar22;
    double dVar23;
    double dVar24;
    double dVar25;
    double dVar26;
    double dVar27;
    double dVar28;
    double local_168;
    double local_158;
    double local_150;
    double local_148;
    double local_140;
    double local_138;
    double local_130;
    double local_128;
    double local_120;
    double local_118;
    double local_110;
    double local_108;
    undefined8 auStack_ec[16];
    int local_6c;

    piVar4 = *(int **)(param_1 + 0x54);
    local_6c = __stack_chk_guard;
    iVar10 = *piVar4;
    if (DAT_000cf878 == 0) {
        DAT_000cf878 = 1;
        memset(&DAT_000cf8f0, 0, 0x148);
        memset(&DAT_00114490, 0, 0x2a80);
        memset(&DAT_00111a10, 0, 0x2a80);
        memset(&DAT_00105210, 0, 0xc800);
        memset(&DAT_000f8a10, 0, 0xc800);
        memset(&DAT_000cfa38, 0, 0x140);
        memset(&DAT_000cfb78, 0, 0x140);
        memset(&DAT_000ec210, 0, 0xc800);
        memset(&DAT_000dfa10, 0, 0xc800);
        memset(&DAT_000cfcb8, 0, 0x140);
        memset(&DAT_000cfdf8, 0, 0x140);
        memset(&DAT_000d0010, 0, 64000);
        dVar18 = 0.0;
        dVar21 = -0.0;
        local_108 = 0.0;
        local_118 = 0.0;
        local_168 = 0.0;
        local_128 = 0.0;
        local_130 = 0.0;
        local_138 = 0.0;
        local_140 = 0.0;
        local_148 = 0.0;
        local_150 = 0.0;
        local_120 = 0.0;
        local_158 = 0.0;
        local_110 = -0.0;
        dVar26 = dVar18;
        dVar19 = dVar21;
        dVar20 = dVar21;
        dVar24 = dVar18;
        dVar22 = dVar21;
        dVar28 = dVar18;
        dVar23 = dVar21;
        dVar27 = in_d0;
        DAT_000cf8a0 = dVar18;
        DAT_000cf8b0 = dVar18;
        dVar25 = dVar18;
        DAT_000cf898 = dVar18;
    } else {
        local_148 = DAT_000cf8d8;
        local_150 = DAT_000cf8e0;
        local_140 = DAT_000cf8d0;
        local_130 = DAT_000cf8c0;
        local_138 = DAT_000cf8c8;
        local_128 = DAT_000cf8b8;
        local_168 = DAT_000cf8b0;
        local_158 = DAT_000cf888;
        local_120 = DAT_000cf880;
        dVar21 = DAT_000cf890 * -0.01149947;
        local_118 = DAT_000cf8b0 * 0.03353214;
        local_108 = DAT_000cf8d0 * 0.03353214;
        local_110 = DAT_000cf8c8 * -0.04080258;
        dVar18 = DAT_000cf8c0 * 0.04605479;
        dVar26 = DAT_000cf8e0 * 0.008203628;
        dVar19 = DAT_000cf8d8 * -0.02375732;
        dVar20 = DAT_000cf8b8 * -0.04080258;
        dVar24 = DAT_000cf890 * -3.48174 + DAT_000cf898 * 0.8360961 +
                 DAT_000cf888 * 5.452988 + DAT_000cf880 * -3.807229;
        dVar22 = DAT_000cf8a8 * -0.02375732;
        dVar28 = DAT_000cf888 * 0.01654858;
        dVar23 = DAT_000cf880 * -0.01149947;
        dVar27 = in_d0 - (DAT_000cf8d8 * -2.765914 + DAT_000cf8e0 * 0.4897278 +
                          DAT_000cf8d0 * 8.110921 + DAT_000cf8c8 * -15.17732 +
                          DAT_000cf8c0 * 19.75197 + DAT_000cf8b8 * -18.14365 +
                          DAT_000cf8b0 * 11.59783 + DAT_000cf8a8 * -4.73504);
        DAT_000cf8a0 = DAT_000cf898;
        DAT_000cf8b0 = DAT_000cf8a8;
        dVar25 = DAT_000cf898 * 0.003281435;
        DAT_000cf898 = DAT_000cf890;
    }
    iVar14 = *(int *)(iVar10 + 0x880);
    pdVar13 = (double *)(iVar10 + 0x870);
    DAT_000cf880 = in_d0 * 5.0 - dVar24;
    DAT_000cf890 = local_158;
    dVar24 = DAT_000cf880 * 0.003281435;
    DAT_000cf888 = local_120;
    *(int *)(iVar10 + 0x880) = (iVar14 + 1) % 0x50;
    iVar8 = DAT_000cff38 * 8;
    DAT_000cf8e8 = local_150;
    DAT_000cf8d8 = local_140;
    DAT_000cf8e0 = local_148;
    dVar25 = dVar23 + dVar24 + dVar28 + dVar21 + dVar25;
    DAT_000cff38 = (DAT_000cff38 + 1) % 0x550;
    DAT_000cf8d0 = local_138;
    DAT_000cf8c8 = local_130;
    dVar28 = (dVar25 * *(double *)(sintab + iVar14 * 8)) / 680.0;
    DAT_000cf8c0 = local_128;
    dVar24 =
        (dVar25 * *(double *)(sintab + ((iVar14 + 0x14) % 0x50) * 8)) / 680.0;
    DAT_000cf8b8 = local_168;
    *pdVar13 = *pdVar13 - *(double *)(&DAT_00114490 + iVar8);
    *(double *)(&DAT_00114490 + iVar8) = dVar28;
    DAT_000cf8a8 = dVar27;
    *pdVar13 = *pdVar13 + dVar28;
    dVar26 = dVar22 + dVar27 * 0.008203628 + local_118 + dVar20 + dVar18 +
             local_110 + local_108 + dVar19 + dVar26;
    *(double *)(iVar10 + 0x878) =
        *(double *)(iVar10 + 0x878) - *(double *)(&DAT_00111a10 + iVar8);
    *(double *)(&DAT_00111a10 + iVar8) = dVar24;
    iVar14 = DAT_000cff40;
    local_150._0_4_ = DAT_000cff40;
    *(double *)(iVar10 + 0x878) = *(double *)(iVar10 + 0x878) + dVar24;
    iVar5 = DAT_000cff3c + 0x14;
    iVar8 = DAT_000cff3c * 8;
    iVar14 = iVar14 * 8;
    DAT_000cff3c = (DAT_000cff3c + 10) % 0x50;
    dVar19 = *(double *)(&DAT_000f8a10 + iVar14);
    dVar20 = dVar26 * *(double *)(sintab + iVar8) * 0.25;
    iVar6 = (*(int *)(iVar10 + 0x894) + 1) % 480000;
    local_158._0_4_ = DAT_000cff50;
    dVar24 = dVar26 * *(double *)(sintab + (iVar5 % 0x50) * 8) * 0.25;
    dVar22 = *(double *)(&DAT_00105210 + iVar14);
    iVar8 = DAT_000cff50 * 8;
    *(int *)(iVar10 + 0x894) = iVar6;
    DAT_000cff60 = (DAT_000cff60 - dVar19) + dVar24;
    *(double *)(&DAT_000f8a10 + iVar14) = dVar24;
    DAT_000cff48 = (DAT_000cff48 - dVar22) + dVar20;
    dVar22 = *(double *)(&DAT_000cfb78 + iVar8);
    iVar6 = iVar6 % 8000;
    dVar28 = *(double *)(&DAT_000cfa38 + iVar8);
    dVar19 = DAT_000cff60 * DAT_000cff60 + DAT_000cff48 * DAT_000cff48;
    *(double *)(&DAT_000cfb78 + iVar8) = dVar24;
    *(double *)(&DAT_00105210 + iVar14) = dVar20;
    DAT_000cff68 = (DAT_000cff68 - dVar22) + dVar24;
    *(double *)(&DAT_000cfa38 + iVar8) = dVar20;
    DAT_000cff58 = (DAT_000cff58 - dVar28) + dVar20;
    iVar5 = *(int *)(iVar10 + 0xcdc);
    if (dVar19 < 0.0) {
        sqrt(dVar19);
    }
    iVar5 = iVar5 * 0xd8;
    iVar7 = iVar10 + 0x1000;
    *(double *)(iVar10 + iVar5 + 0x8c8) = SQRT(dVar19) / 800.0;
    if ((*(uint *)(iVar10 + 0x10e8) & 1) == 0) {
        FUN_00065f80(param_1, iVar10 + iVar5 + 0x8a0,
                     (int)(longlong)(*(double *)(piVar4 + 0xba) * 8000.0));
        local_150._0_4_ = DAT_000cff40;
        local_158._0_4_ = DAT_000cff50;
        iVar14 = DAT_000cff40 << 3;
        iVar8 = DAT_000cff50 << 3;
    }
    iVar16 = DAT_000cff70 + 0x14;
    dVar28 = *(double *)(&DAT_000dfa10 + iVar14);
    iVar5 = DAT_000cff70 * 8;
    DAT_000cff70 = (DAT_000cff70 + 0xc) % 0x50;
    dVar20 = dVar26 * *(double *)(sintab + iVar5) * 0.25;
    dVar19 = *(double *)(sintab + (iVar16 % 0x50) * 8);
    dVar22 = *(double *)(&DAT_000cfcb8 + iVar8);
    dVar23 = *(double *)(&DAT_000cfdf8 + iVar8);
    dVar24 = (DAT_000cff78 - *(double *)(&DAT_000ec210 + iVar14)) + dVar20;
    *(double *)(&DAT_000cfcb8 + iVar8) = dVar20;
    DAT_000cff78 = dVar24;
    *(double *)(&DAT_000ec210 + iVar14) = dVar20;
    dVar26 = dVar26 * dVar19 * 0.25;
    DAT_000cff80 = (DAT_000cff80 - dVar22) + dVar20;
    iVar5 = *(int *)(iVar10 + 0xcdc);
    DAT_000cff88 = (DAT_000cff88 - dVar28) + dVar26;
    *(double *)(&DAT_000dfa10 + iVar14) = dVar26;
    dVar19 = DAT_000cff88 * DAT_000cff88;
    DAT_000cff90 = (DAT_000cff90 - dVar23) + dVar26;
    *(double *)(&DAT_000cfdf8 + iVar8) = dVar26;
    dVar19 = dVar19 + dVar24 * dVar24;
    if (dVar19 < 0.0) {
        sqrt(dVar19);
    }
    iVar5 = iVar5 * 0xd8;
    *(double *)(iVar10 + iVar5 + 0x930) = SQRT(dVar19) / 800.0;
    uVar15 = *(uint *)(iVar10 + 0x10e8);
    uVar11 = uVar15 & 1;
    if (uVar11 == 0) {
        FUN_00065f80(param_1, iVar10 + iVar5 + 0x908,
                     (int)(longlong)(*(double *)(piVar4 + 0xbc) * 8000.0));
        uVar15 = *(uint *)(iVar10 + 0x10e8);
        local_150._0_4_ = DAT_000cff40;
        local_158._0_4_ = DAT_000cff50;
        uVar11 = uVar15 & 1;
    }
    DAT_000cff50 = (local_158._0_4_ + 1) % 0x28;
    DAT_000cff40 = (local_150._0_4_ + 1) % 0x1900;
    if (*(int *)(iVar10 + 0x894) == 0) {
        *(int *)(iVar10 + 0x38) = *(int *)(iVar10 + 0x38) + 1;
        if (uVar11 == 0) {
            iVar8 = FUN_000656c0(param_1, &DAT_000cf668,
                                 (local_158._0_4_ + 1) * 0x66666667);
            uVar15 = *(uint *)(iVar10 + 0x10e8);
            if (iVar8 == 0) {
                *(undefined4 *)(iVar10 + 0x38) = 0;
            }
            uVar11 = uVar15 & 1;
            goto LAB_0006838c;
        }
        if ((uVar15 & 0x1000) != 0) {
            *(undefined4 **)(iVar10 + 0x894) = &DAT_000733c0;
        }
    LAB_00068044:
        iVar5 = **(int **)(param_1 + 0x54);
        iVar14 = *(int *)(iVar5 + 0xcdc);
        iVar8 = iVar14 * 0xd8 + iVar5;
        pdVar13 = (double *)(iVar8 + 0x8d0);
        dVar26 = *(double *)(iVar8 + 0x8c8);
        if (*pdVar13 < dVar26) {
            *pdVar13 = dVar26;
        }
        iVar8 = iVar14 * 0xd8 + iVar5;
        dVar26 = *(double *)(iVar8 + 0x930);
        pdVar13 = (double *)(iVar8 + 0x938);
        if (*pdVar13 < dVar26) {
            *pdVar13 = dVar26;
        }
        iVar8 = *(int *)(iVar5 + 0x890);
        if (iVar8 == 0x1900) {
            *(undefined4 *)(iVar5 + 0x858) = *(undefined4 *)(iVar5 + 0x854);
        } else if (iVar8 == 0x78) {
            pdVar13 = (double *)(iVar5 + 0x870);
            DAT_000cffa8 = *(undefined4 *)pdVar13;
            DAT_000cffac = *(undefined4 *)(iVar5 + 0x874);
            _DAT_000cffa0 = *pdVar13;
            _DAT_000cff98 = *pdVar13;
        } else if (iVar8 == 0x640) {
            dVar19 = *(double *)(iVar5 + 0x878);
            _DAT_000cffa0 = *(double *)(iVar5 + 0x870);
            dVar26 = dVar19 * dVar19 + _DAT_000cffa0 * _DAT_000cffa0;
            if (dVar26 < 0.0) {
                sqrt(dVar26);
                dVar19 = *(double *)(iVar5 + 0x878);
                iVar8 = *(int *)(iVar5 + 0x890);
            }
            iVar14 = *(int *)(iVar5 + 0x880);
            dVar19 = dVar19 / (double)(longlong) * (int *)(iVar5 + 0x850);
            DAT_000cffb0 = SQRT(dVar26);
            *(double *)(iVar5 + 0x888) = dVar19;
            if (dVar19 < 0.0) {
                *(int *)(iVar5 + 0x880) = iVar14 + -1;
                if (iVar14 + -1 < 0) {
                    *(int *)(iVar5 + 0x880) = iVar14 + 0x4f;
                }
            } else {
                iVar16 = iVar14 + 1;
                iVar7 = iVar14 + -0x4e;
                *(int *)(iVar5 + 0x880) = iVar16;
                if (0x4f < iVar16) {
                    iVar14 = iVar14 + -0x4f;
                }
                if (iVar16 != 0x4f && iVar7 < 0 == SBORROW4(iVar16, 0x4f)) {
                    *(int *)(iVar5 + 0x880) = iVar14;
                }
            }
        } else if (iVar8 == 4000) {
            _DAT_000cff98 = *(double *)(iVar5 + 0x870);
        }
        *(int *)(iVar5 + 0x890) = iVar8 + 1;
        if (*(int *)(iVar5 + 0x894) % 8000 == *(int *)(iVar5 + 0x858)) {
            *(uint *)(iVar5 + 0x10e8) = *(uint *)(iVar5 + 0x10e8) & 0xffffff9f;
            dVar26 = *(double *)(iVar5 + 0x878) * *(double *)(iVar5 + 0x878) +
                     *(double *)(iVar5 + 0x870) * *(double *)(iVar5 + 0x870);
            if (dVar26 < 0.0) {
                sqrt(dVar26);
            }
            dVar19 = DAT_000cffb0;
            pdVar13 = (double *)(iVar5 + 0x10e0);
            *(double *)(iVar5 + 0x10d8) = DAT_000cffb0;
            if (dVar19 <= 0.0) {
                *(undefined4 *)pdVar13 = 0;
                *(undefined4 *)(iVar5 + 0x10e4) = 0;
            LAB_00068b64:
                *(uint *)(iVar5 + 0x10e8) = *(uint *)(iVar5 + 0x10e8) | 0x20;
                FUN_00066264(0, param_1);
            } else {
                if (0.0 < SQRT(dVar26)) {
                    dVar26 = log10(dVar19 / SQRT(dVar26));
                    dVar26 = dVar26 * 20.0;
                    if (40.0 < dVar26)
                        goto LAB_00068b44;
                    *pdVar13 = dVar26;
                    if ((dVar19 < 1000.0) || (dVar26 < 10.0))
                        goto LAB_00068b64;
                } else {
                LAB_00068b44:
                    *(undefined4 *)pdVar13 = 0;
                    *(undefined4 *)(iVar5 + 0x10e4) = 0x40440000;
                    if (dVar19 < 1000.0)
                        goto LAB_00068b64;
                }
                _DAT_000cffa0 = _DAT_000cffa0 - _DAT_000cff98;
                _DAT_000cff98 = _DAT_000cff98 -
                                (double)CONCAT44(DAT_000cffac, DAT_000cffa8);
                FUN_00066264(SUB84(_DAT_000cff98 - _DAT_000cffa0, 0), param_1);
            }
            iVar8 = *(int *)(iVar5 + 0x10f4);
            if ((*(uint *)(iVar5 + 0x10e8) & 0x60) != 0) {
                iVar8 = iVar8 + 1;
                *(int *)(iVar5 + 0x10f4) = iVar8;
            }
            if (0x28 < iVar8) {
                *(uint *)(iVar5 + 0x10ec) = *(uint *)(iVar5 + 0x10ec) | 2;
            }
            FUN_00065584(*(undefined4 *)(param_1 + 0x54));
            iVar8 = *(int *)(iVar5 + 0xcdc) * 0xd8 + iVar5;
            *(undefined4 *)(iVar8 + 0x8d0) = 0;
            *(undefined4 *)(iVar8 + 0x8d4) = 0;
            *(undefined4 *)(iVar8 + 0x938) = 0;
            *(undefined4 *)(iVar8 + 0x93c) = 0;
            *(undefined4 *)(iVar5 + 0x890) = 0;
        }
        uVar15 = *(uint *)(iVar10 + 0x10e8);
    } else {
    LAB_0006838c:
        if (uVar11 != 0)
            goto LAB_00068044;
        iVar8 = *(int *)(iVar10 + 0xcd0);
        if ((iVar8 != 0) && (50.0 <= *(double *)(iVar8 + 0x48))) {
            iVar5 = *(int *)(iVar8 + 0x20);
            iVar8 = iVar5 >> 0x1f;
            iVar14 = iVar5 / 8000 + iVar8;
            if (iVar5 + (iVar14 - iVar8) * -8000 == iVar6) {
                bVar17 = (uVar15 & 2) != 0;
                uVar15 = uVar15 | 1;
                *(int *)(iVar10 + 0x10d0) = ((iVar8 - iVar14) + 0x3c) % 0x3c;
                *(undefined4 *)(iVar10 + 0x890) = 0;
                *(uint *)(iVar10 + 0x10e8) = uVar15;
                if (bVar17) {
                    iVar7 = *(int *)(iVar10 + 0x854);
                }
                *(undefined4 *)(iVar10 + 0x38) = 0;
                if (bVar17) {
                    *(int *)(iVar10 + 0x858) = iVar7;
                } else {
                    *(int *)(iVar10 + 0x854) = iVar6;
                    *(int *)(iVar10 + 0x858) = iVar6;
                }
            }
        }
    }
    dVar26 = DAT_000cff68;
    dVar19 = DAT_000cff58;
    if (((uVar15 & 0x100) == 0) &&
        (dVar26 = DAT_000cff90, dVar19 = DAT_000cff80, (uVar15 & 0x200) == 0)) {
        dVar26 = 0.0;
    } else {
        dVar26 = dVar26 * dVar26 + dVar19 * dVar19;
        if (dVar26 < 0.0) {
            sqrt(dVar26);
        }
        dVar26 = SQRT(dVar26) / 5.0;
    }
    dVar20 = *(double *)(&DAT_000d0010 + iVar6 * 8);
    dVar19 = (double)CONCAT44(DAT_000cffbc, _DAT_000cffb8);
    dVar20 = (dVar26 - dVar20) / (double)(longlong) * (int *)(iVar10 + 0x850) +
             dVar20;
    *(double *)(&DAT_000d0010 + iVar6 * 8) = dVar20;
    if (dVar19 < dVar20) {
        iVar8 = iVar6 + -0x30;
        if (iVar8 < 0) {
            iVar8 = iVar6 + 0x1f10;
        }
        DAT_000cffc8 = ABS(*(double *)(&DAT_000d0010 + iVar8 * 8));
        DAT_000cffc0 = iVar6;
    }
    if (iVar6 != 0)
        goto LAB_00068350;
    dVar26 = (double)CONCAT44(DAT_000cffbc, _DAT_000cffb8);
    *(double *)(iVar10 + 0x860) = dVar26;
    if (dVar26 <= 0.0) {
        dVar26 = 0.0;
    } else {
        if (0.0 < DAT_000cffc8) {
            dVar26 = log10(dVar26 / DAT_000cffc8);
            dVar26 = dVar26 * 20.0;
            if (dVar26 <= 40.0)
                goto LAB_000681e8;
        }
        dVar26 = 40.0;
    }
LAB_000681e8:
    *(double *)(iVar10 + 0x868) = dVar26;
    iVar8 = DAT_000cffc0 + -0x28;
    if (iVar8 < 0) {
        iVar8 = DAT_000cffc0 + 0x1f18;
    }
    piVar4 = *(int **)(param_1 + 0x54);
    iVar14 = *piVar4;
    dVar26 = *(double *)(iVar14 + 0x860);
    if (DAT_000cffd0 == 0) {
        DAT_000cffd4 = 0;
        DAT_000cffd8 = 0;
        DAT_000cffdc = 0;
        DAT_000cffd0 = 1;
    }
    iVar5 = DAT_000cffd8;
    DAT_000cffe0 = (undefined8 *)((int)DAT_000cffe0 + 1);
    uVar11 = *(uint *)(iVar14 + 0x10e8);
    DAT_000cffc0 = iVar8;
    if ((dVar26 < 2500.0) || (*(double *)(iVar14 + 0x868) < 15.0)) {
        *(uint *)(iVar14 + 0x10e8) = uVar11 & 0xffffffed;
        DAT_000cffe4 = 0;
        DAT_000cffe8 = 0;
        DAT_000cffec = 0;
        iVar6 = DAT_000cfff4;
    } else {
        iVar6 = DAT_000cfff4;
        if ((uVar11 & 0x300) != 0) {
            DAT_000cffd8 = DAT_000cffd4;
            DAT_000cffdc = iVar5;
            DAT_000cfff0 = iVar8;
            if (DAT_000cffd4 < iVar8) {
                if (iVar5 < DAT_000cffd4)
                    goto LAB_00068c3c;
                if (iVar5 <= iVar8) {
                    DAT_000cfff0 = iVar5;
                }
            } else if (DAT_000cffd4 < iVar5) {
            LAB_00068c3c:
                DAT_000cfff0 = DAT_000cffd4;
            } else if (iVar8 <= iVar5) {
                DAT_000cfff0 = iVar5;
            }
            iVar6 = DAT_000cfff0;
            bVar1 = *(byte *)(piVar4 + 0xc0);
            iVar7 = DAT_000cffe8;
            puVar12 = (undefined8 *)((ulonglong)((longlong)(DAT_000cfff0 -
                                                            DAT_000cfff4) *
                                                 0x10624dd3) >>
                                     0x20);
            iVar5 = (DAT_000cfff0 - DAT_000cfff4) % 8000;
            DAT_000cffd4 = iVar8;
            if (iVar5 == 0) {
                DAT_000cffe8 = DAT_000cffe8 + 1;
                if (DAT_000cffe8 < 0xb)
                    goto LAB_000687ec;
                if ((uVar11 & 1) == 0) {
                    if ((bVar1 & 8) != 0)
                        goto LAB_00068d60;
                    goto LAB_00068804;
                }
                if (((uVar11 & 0x10) != 0) ||
                    (iVar8 = *(int *)(iVar14 + 0x850),
                     (int)DAT_000cffe0 - (int)DAT_000cfff8 <= iVar8)) {
                    *(uint *)(iVar14 + 0x10e8) = uVar11 | 2;
                    *(int *)(iVar14 + 0x854) = iVar6;
                    goto LAB_000687ec;
                }
            } else {
                if (DAT_000cffe4 <= DAT_000cffe8) {
                    DAT_000cffe8 = 0;
                    DAT_000cffe4 = iVar7;
                    DAT_000cfffc = DAT_000cffe0;
                    DAT_000d0000 = DAT_000cfff4;
                }
            LAB_000687ec:
                if (((bVar1 & 8) != 0) &&
                    (uVar11 = *(uint *)(iVar14 + 0x10e8), (uVar11 & 1) == 0)) {
                LAB_00068d60:
                    puVar12 = auStack_ec;
                    FUN_0007c054(
                        puVar12, 0x80,
                        "wwv1 %04x %3d %4d %5.0f %5.1f %5d %4d %4d %4d", uVar11,
                        *(undefined4 *)(iVar14 + 0x844), iVar6, dVar26,
                        *(double *)(iVar14 + 0x868), iVar5, DAT_000cffec,
                        DAT_000cffe8, DAT_000cffe4);
                    FUN_00051f44(param_1 + 0x10, puVar12);
                    iVar6 = DAT_000cfff0;
                }
            LAB_00068804:
                iVar8 = *(int *)(iVar14 + 0x850);
            }
            DAT_000cffec = DAT_000cffec + 1;
            if (iVar8 <= DAT_000cffec) {
                if (DAT_000cffe4 <= DAT_000cffe8) {
                    DAT_000cffe4 = DAT_000cffe8;
                    DAT_000cfffc = DAT_000cffe0;
                    DAT_000d0000 = DAT_000cfff4;
                }
                iVar7 = DAT_000cffe4;
                uVar11 = *(uint *)(iVar14 + 0x10e8);
                puVar9 = &DAT_000cf668;
                puVar2 = DAT_000cffe0;
                iVar5 = iVar6;
                puVar3 = DAT_000cffe0;
                if (DAT_000cffe4 != 0) {
                    puVar2 = puVar12;
                    iVar5 = DAT_000d0000;
                    puVar9 = DAT_000cfffc;
                    puVar3 = DAT_000cfffc;
                }
                DAT_000cfffc = puVar3;
                iVar16 = iVar5 - DAT_000d0004;
                DAT_000cfff4 = iVar6;
                if (DAT_000cffe4 == 0) {
                    *(int *)(puVar9 + 0x133) = iVar5;
                    puVar9 = puVar2;
                }
                dVar26 = (double)(longlong)(iVar16 % 8000);
                if ((uVar11 & 0x10) != 0) {
                    if (12.0 <= ABS(dVar26)) {
                        if (DAT_000d0008 + 2 < 0 == SCARRY4(DAT_000d0008, 2)) {
                            DAT_000d0008 = DAT_000d0008 + -1;
                        } else if (8 < iVar8) {
                            DAT_000d0008 = 0;
                            *(int *)(iVar14 + 0x850) = iVar8 >> 1;
                        }
                    } else {
                        dVar19 = (dVar26 * 0.5) /
                                     (double)(longlong)(((int)puVar9 -
                                                         (int)DAT_000cfff8) *
                                                        3) +
                                 *(double *)(iVar14 + 0x18);
                        if (1.5 < dVar19) {
                            *(undefined8 *)(iVar14 + 0x18) = 0x3ff8000000000000;
                        } else {
                            if (dVar19 < -1.5) {
                                dVar19 = -1.5;
                            }
                            *(double *)(iVar14 + 0x18) = dVar19;
                        }
                        if (ABS(dVar26) < 6.0) {
                            if (DAT_000d0008 < 3) {
                                DAT_000d0008 = DAT_000d0008 + 1;
                            } else if (iVar8 < 0x400) {
                                DAT_000d0008 = 0;
                                *(int *)(iVar14 + 0x850) = iVar8 << 1;
                            }
                        }
                    }
                }
                if ((*(byte *)(piVar4 + 0xc0) & 8) != 0) {
                    FUN_0007c054(
                        auStack_ec, 0x80,
                        "wwv2 %04x %5.0f %5.1f %5d %4d %4d %4d %4.0f %7.2f",
                        uVar11, *(undefined4 *)(iVar14 + 0x860),
                        *(undefined4 *)(iVar14 + 0x864),
                        *(undefined4 *)(iVar14 + 0x868),
                        *(undefined4 *)(iVar14 + 0x86c), iVar5,
                        *(undefined4 *)(iVar14 + 0x850), iVar7,
                        (int)puVar9 - (int)DAT_000cfff8, dVar26,
                        (*(double *)(iVar14 + 0x18) * 1000000.0) / 8000.0);
                    FUN_00051f44(param_1 + 0x10, auStack_ec);
                    uVar11 = *(uint *)(iVar14 + 0x10e8);
                    puVar9 = DAT_000cfffc;
                    iVar5 = DAT_000d0000;
                }
                *(uint *)(iVar14 + 0x10e8) = uVar11 | 0x10;
                DAT_000cffe4 = 0;
                DAT_000cffe8 = 0;
                DAT_000cffec = 0;
                iVar6 = DAT_000cfff4;
                DAT_000cfff8 = puVar9;
                DAT_000d0004 = iVar5;
            }
        }
    }
    DAT_000cfff4 = iVar6;
    if ((*(uint *)(iVar10 + 0x10e8) & 2) == 0) {
        *(uint *)(iVar10 + 0x10ec) = *(uint *)(iVar10 + 0x10ec) | 8;
    }
    _DAT_000cffb8 = 0;
    DAT_000cffbc = 0;
    if ((*(uint *)(iVar10 + 0x10e8) & 1) == 0) {
        FUN_00065584(*(undefined4 *)(param_1 + 0x54));
    }
LAB_00068350:
    if (local_6c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006906c(undefined4 param_1, int param_2)

{
    ssize_t sVar1;
    int iVar2;
    bool bVar3;
    undefined1 local_15;
    int local_14;

    local_14 = __stack_chk_guard;
    bVar3 = *(char *)(**(int **)(param_2 + 0x54) + 0xd) != '\0';
    iVar2 = __stack_chk_guard;
    if (bVar3) {
        iVar2 = 0x52;
    }
    local_15 = (undefined1)iVar2;
    if (!bVar3) {
        local_15 = 0x54;
    }
    sVar1 = write((*(int **)(param_2 + 0x54))[7], &local_15, 1);
    if (sVar1 != 1) {
        FUN_000494a0(param_2, 3);
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00069238(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    int iVar4;
    int *piVar5;
    undefined4 *puVar6;
    char *__s;
    int iVar7;
    undefined8 uVar8;
    char local_3d;
    undefined1 local_3c;
    char local_3b[3];
    undefined4 local_38;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;
    int iStack_28;
    int local_24;

    iVar7 = *(int *)(param_1 + 4);
    puVar6 = *(undefined4 **)(iVar7 + 0x54);
    __s = (char *)(puVar6 + 0xe);
    piVar5 = (int *)*puVar6;
    local_24 = __stack_chk_guard;
    uVar8 = FUN_00049ee4(param_1, __s, 0x80, &local_2c);
    iVar1 = (int)uVar8;
    if (iVar1 == 0) {
        iVar4 = piVar5[2];
        iVar1 = 0;
        iVar7 = (int)((ulonglong)uVar8 >> 0x20);
        if (iVar4 == 0) {
            iVar1 = local_2c;
            iVar7 = iStack_28;
        }
        piVar5[2] = (uint)(iVar4 == 0);
        if (iVar4 == 0) {
            *piVar5 = iVar1;
            piVar5[1] = iVar7;
        }
        goto LAB_000692a0;
    }
    iVar4 = *piVar5;
    iVar3 = piVar5[1];
    puVar6[0x2e] = iVar1;
    puVar6[0x3a] = iVar4;
    puVar6[0x3b] = iVar3;
    iVar3 = puVar6[0x3b];
    piVar5[2] = 1;
    *piVar5 = local_2c;
    piVar5[1] = iStack_28;
    if (iVar4 == 0 && iVar3 == 0)
        goto LAB_000692a0;
    local_3b[1] = 0x20;
    local_3b[0] = ' ';
    local_3c = 0x20;
    local_3d = ' ';
    local_38 = 0;
    if (iVar1 == 0x18) {
        iVar1 = sscanf(__s, "%c%c %2d %3d %2d:%2d:%2d.%3ld %c", &local_3d,
                       &local_3c, puVar6 + 0x2f, puVar6 + 0x30, puVar6 + 0x31,
                       puVar6 + 0x32, puVar6 + 0x33, puVar6 + 0x34, local_3b);
        if (iVar1 != 9)
            goto LAB_0006931c;
        puVar6[0x34] = puVar6[0x34] * 1000000;
    } else if (iVar1 == 0x1d) {
        iVar1 = sscanf(__s, "0003%c %4d%2d%2d %2d%2d%2d+0000%c%c", &local_3d,
                       puVar6 + 0x2f, &local_30, &local_34, puVar6 + 0x31,
                       puVar6 + 0x32, puVar6 + 0x33, local_3b + 1, local_3b);
        if (iVar1 != 8)
            goto LAB_0006931c;
        uVar2 = FUN_0007ec68(puVar6[0x2f], local_30, local_34);
        puVar6[0x34] = 0;
        puVar6[0x30] = uVar2;
    } else {
        if ((iVar1 != 0x16) ||
            (iVar1 =
                 sscanf(__s, "%c %3d %2d:%2d:%2d%c%cTZ=%2d", &local_3d,
                        puVar6 + 0x30, puVar6 + 0x31, puVar6 + 0x32,
                        puVar6 + 0x33, local_3b + 2, local_3b + 1, &local_38),
             iVar1 != 8)) {
        LAB_0006931c:
            if (*(char *)((int)piVar5 + 0xd) == '\0') {
                FUN_000494a0(iVar7, 2);
            } else {
                *(char *)((int)piVar5 + 0xd) =
                    *(char *)((int)piVar5 + 0xd) + -1;
                FUN_00051f44(iVar7 + 0x10, __s);
            }
            goto LAB_000692a0;
        }
        puVar6[0x34] = 0;
    }
    switch (local_3c) {
    case 0x20:
        puVar6[0x3e] = 0xd2f1a9fc;
        puVar6[0x3f] = 0x3f50624d;
        puVar6[0x38] = puVar6[0x3a];
        puVar6[0x39] = puVar6[0x3b];
        goto LAB_00069540;
    case 0x21:
        break;
    case 0x22:
        break;
    case 0x23:
        break;
    case 0x24:
        break;
    case 0x25:
        break;
    case 0x26:
        break;
    case 0x27:
        break;
    case 0x28:
        break;
    case 0x29:
        break;
    case 0x2a:
        break;
    case 0x2b:
        break;
    case 0x2c:
        break;
    case 0x2d:
        break;
    case 0x2e:
        break;
    case 0x2f:
        break;
    case 0x30:
        break;
    case 0x31:
        break;
    case 0x32:
        break;
    case 0x33:
        break;
    case 0x34:
        break;
    case 0x35:
        break;
    case 0x36:
        break;
    case 0x37:
        break;
    case 0x38:
        break;
    case 0x39:
        break;
    case 0x3a:
        break;
    case 0x3b:
        break;
    case 0x3c:
        break;
    case 0x3d:
        break;
    case 0x3e:
        break;
    case 0x3f:
        break;
    case 0x40:
        break;
    case 0x41:
        puVar6[0x3e] = 0x47ae147b;
        puVar6[0x3f] = 0x3f847ae1;
        goto LAB_00069540;
    case 0x42:
        puVar6[0x3e] = 0x9999999a;
        puVar6[0x3f] = 0x3fb99999;
        goto LAB_00069540;
    case 0x43:
        puVar6[0x3e] = 0;
        puVar6[0x3f] = 0x3fe00000;
        goto LAB_00069540;
    case 0x44:
        puVar6[0x3e] = 0;
        puVar6[0x3f] = 0x40300000;
        goto LAB_00069540;
    }
    puVar6[0x3e] = 0;
    puVar6[0x3f] = 0x40300000;
    FUN_000494a0(iVar7, 2);
LAB_00069540:
    if (local_3d == ' ') {
        *(bool *)(puVar6 + 10) = local_3b[0] == 'L';
    } else {
        *(undefined1 *)(puVar6 + 10) = 3;
    }
    iVar1 = FUN_00049bc8((int)*(undefined8 *)(puVar6 + 0xbc), puVar6);
    if (iVar1 == 0) {
        FUN_000494a0(iVar7, 6);
    }
LAB_000692a0:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00069754(undefined4 param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    int iVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    piVar2 = *(int **)(param_2 + 0x54);
    iVar3 = *piVar2;
    if (*(int *)(iVar3 + 0x20) == 0) {
        FUN_000494a0(param_2, 1);
    } else {
        *(int *)(iVar3 + 0x20) = *(int *)(iVar3 + 0x20) + -1;
    }
    bVar4 = iVar1 == __stack_chk_guard;
    piVar2[0xc2] = piVar2[0xc2] + 1;
    *(undefined1 *)(iVar3 + 0x1e) = 1;
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000699b8(int param_1)

{
    int iVar1;
    int *piVar2;
    int iVar3;
    int iVar4;
    int local_30;
    undefined1 auStack_2c[4];
    int local_28;
    int local_24;

    iVar3 = *(int *)(param_1 + 4);
    piVar2 = *(int **)(iVar3 + 0x54);
    iVar1 = piVar2[0x2e];
    iVar4 = *piVar2;
    local_24 = __stack_chk_guard;
    if (iVar1 < 0x1d) {
        if (iVar1 == 0)
            goto LAB_00069a64;
        memcpy((void *)((int)piVar2 + iVar1 + 0x38), (void *)(param_1 + 0x58),
               *(size_t *)(param_1 + 0x54));
        iVar1 = piVar2[0x2e] + *(int *)(param_1 + 0x54);
        piVar2[0x2e] = iVar1;
        *(undefined1 *)((int)piVar2 + iVar1 + 0x38) = 0;
    } else {
        piVar2[0x2e] = 0;
    LAB_00069a64:
        if (*(char *)(param_1 + 0x58) != '!')
            goto LAB_00069a70;
        iVar1 = FUN_00049ee4(param_1, piVar2 + 0xe, 0x80, piVar2 + 0x3a);
        piVar2[0x2e] = iVar1;
    }
    if (iVar1 < 0x1d)
        goto LAB_00069a70;
    FUN_00051f44(iVar3 + 0x10, piVar2 + 0xe);
    if (piVar2[0x2e] == 0x1d) {
        iVar1 =
            sscanf((char *)(piVar2 + 0xe), "!TIME,%4d,%3d,%2d,%2d,%2d,%d,%d,%d",
                   piVar2 + 0x2f, piVar2 + 0x30, piVar2 + 0x31, piVar2 + 0x32,
                   piVar2 + 0x33, &local_30, auStack_2c, &local_28);
        if (iVar1 != 8) {
            FUN_000494a0(iVar3, 2);
            goto LAB_00069a70;
        }
        if (local_30 == 2) {
            if (local_28 != 1) {
                *(undefined1 *)(piVar2 + 10) = 3;
                goto LAB_00069a70;
            }
            iVar1 = FUN_00049cf8(piVar2);
            if (iVar1 != 0) {
                *(undefined4 *)(iVar4 + 0x20) = 2;
                if (*(char *)(iVar4 + 0x1e) != '\0') {
                    *(undefined1 *)(iVar4 + 0x1e) = 0;
                    FUN_00049d44(iVar3);
                }
                goto LAB_00069a70;
            }
        }
    }
    FUN_000494a0(iVar3, 6);
LAB_00069a70:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00069c80(undefined4 param_1, int param_2)

{
    uint *puVar1;
    undefined **ppuVar2;
    undefined **ppuVar3;
    int iVar4;
    size_t sVar5;
    int iVar6;
    int iVar7;
    uint extraout_r2;
    undefined4 extraout_r2_00;
    char *extraout_r2_01;
    char *pcVar8;
    int extraout_r3;
    undefined4 extraout_r3_00;
    undefined4 extraout_r3_01;
    int iVar9;
    uint uVar10;
    char *pcVar11;
    int iVar12;
    undefined4 *puVar13;
    int iVar14;
    double dVar15;
    undefined8 uVar16;
    undefined4 local_1c0;
    undefined4 local_1bc;
    undefined4 local_1b8;
    undefined4 local_1b4;
    undefined4 local_1b0;
    int local_1ac;
    int local_1a8;
    char acStack_1a4[44];
    undefined4 local_178;
    undefined4 local_174;
    undefined4 local_170;
    undefined4 local_16c;
    undefined4 local_168;
    int local_164;
    int local_160;
    uint local_15c;
    undefined4 local_158;
    undefined4 local_154;
    undefined4 local_148;
    undefined4 local_144;
    undefined4 local_140;
    undefined4 local_13c;
    undefined4 local_138;
    int local_134;
    int local_130;
    undefined4 local_12c;
    char *local_128;
    uint local_124;
    undefined4 local_120;
    uint local_10c;
    uint local_108;
    int local_104;
    uint local_100;
    int local_fc;
    int local_f8;
    char *local_f4;
    uint *local_f0;
    char *local_ec;
    char *local_e8;
    uint local_e4;
    undefined **local_e0;
    undefined4 uStack_dc;
    int local_d8;
    undefined4 local_d4;
    ushort local_d0[4];
    undefined1 local_c8;
    int local_c4;
    uint local_c0;
    uint local_bc;
    int local_b8;
    int local_b4;
    int local_b0;
    undefined1 auStack_a8[4];
    uint uStack_a4;
    byte local_9f;
    byte local_9e;
    ushort local_9c;
    ushort local_9a;
    ushort local_98;
    int local_94;
    int iStack_90;
    int local_88[7];
    undefined4 local_6c;
    undefined1 local_68;
    char *local_64;
    undefined1 local_60;
    char acStack_5c[32];
    int local_3c;

    local_124 = (uint) * (byte *)(param_2 + 0x59);
    local_128 = "/dev/tsyncpci";
    local_3c = __stack_chk_guard;
    __sprintf_chk(acStack_5c, 1, 0x20, &DAT_000a9de0);
    __printf_chk(1, "Polling device number %d...\n",
                 *(undefined1 *)(param_2 + 0x59));
    local_88[0] = open64(acStack_5c, 0x800, 0x1ff);
    if (local_88[0] < 0) {
        FUN_00074e00(3, "Couldn\'t open device");
        goto LAB_0006a1e8;
    }
    iVar4 = ioctl(local_88[0], 0xc01c7400, local_88);
    if (iVar4 < 0) {
        FUN_00074e00(3, "Couldn\'t initialize device");
        close(local_88[0]);
        goto LAB_0006a1e8;
    }
    local_148 = 0x25000001;
    local_138 = 0x10;
    local_144 = 0;
    local_140 = 0;
    local_13c = 0;
    local_134 = 0;
    local_130 = 0;
    local_12c = 0;
    local_128 = (char *)0x0;
    local_124 = 0;
    local_120 = 0;
    local_e4 = ioctl(local_88[0], 0xc020741a, &local_148);
    local_174 = 0;
    local_170 = 0;
    local_16c = 0;
    local_164 = 0;
    local_160 = 0;
    local_15c = 0;
    local_178 = 0x23010001;
    local_168 = 0xc;
    local_158 = 0;
    local_154 = 0;
    local_e0 = (undefined **)ioctl(local_88[0], 0xc020741a, &local_178);
    local_f4 = acStack_1a4;
    local_1c0 = 0x23070001;
    local_1b0 = 0x24;
    local_1bc = 0;
    local_1b8 = 0;
    local_1b4 = 0;
    local_1ac = 0;
    local_1a8 = 0;
    memset(local_f4, 0, 0x24);
    local_e8 = (char *)ioctl(local_88[0], 0xc020741a, &local_1c0);
    puVar13 = *(undefined4 **)(param_2 + 0x54);
    local_f0 = (uint *)*puVar13;
    local_ec = (char *)ioctl(local_88[0], 0xc0207419, auStack_a8);
    close(local_88[0]);
    if (((((int)(local_e4 | (uint)local_e0) < 0) ||
          ((int)((uint)local_e8 | (uint)local_ec) < 0)) ||
         (local_130 != 0)) ||
        (((local_160 != 0 || (local_1a8 != 0)) ||
          ((local_134 != 8 || ((local_164 != 4 || (local_1ac != 0x1c)))))))) {
        FUN_000494a0(param_2, 3);
        goto LAB_0006a1e8;
    }
    iVar4 = 0;
    local_10c = local_15c << 0x18 | (local_15c >> 8 & 0xff) << 0x10 |
                (local_15c >> 0x10 & 0xff) << 8 | local_15c >> 0x18;
    local_68 = 0;
    local_60 = 0;
    local_6c = local_12c;
    local_64 = local_128;
    do {
        pcVar8 = local_f4 + iVar4 + 4;
        pcVar11 = (char *)((int)&local_c4 + iVar4);
        do {
            pcVar8 = pcVar8 + -1;
            *pcVar11 = *pcVar8;
            pcVar11 = pcVar11 + 1;
        } while (local_f4 + iVar4 != pcVar8);
        iVar4 = iVar4 + 4;
    } while (iVar4 != 0x1c);
    pcVar11 = "gps";
    iVar4 = 0;
    local_e0 = &__DT_PLTGOT;
    do {
        pcVar8 = strstr((char *)&local_6c, pcVar11);
        if (pcVar8 != (char *)0x0)
            break;
        iVar4 = iVar4 + 1;
        pcVar11 = *(char **)(&UNK_000c4b04 + iVar4 * 8);
    } while (pcVar11 != (char *)0x0);
    pcVar8 = "gps";
    iVar12 = 0;
    local_f8 = iVar4;
    local_e8 = pcVar11;
    do {
        pcVar11 = strstr((char *)&local_64, pcVar8);
        ppuVar2 = local_e0;
        if (pcVar11 != (char *)0x0)
            break;
        iVar12 = iVar12 + 1;
        pcVar8 = *(char **)(&UNK_000c4b04 + iVar12 * 8);
    } while (pcVar8 != (char *)0x0);
    local_e0 = (undefined **)(uint)local_98;
    dVar15 = (double)(longlong)iStack_90 / 1000000.0;
    local_ec = pcVar8;
    if (dVar15 < 0.0) {
        dVar15 = ldexp(-dVar15, 0x20);
        uVar16 =
            FUN_0009c010(SUB84(dVar15, 0), (int)((ulonglong)dVar15 >> 0x20));
        uVar16 = CONCAT44(
            -((int)((ulonglong)uVar16 >> 0x20) + (uint)((int)uVar16 != 0)),
            -(int)uVar16);
    } else {
        dVar15 = ldexp(dVar15, 0x20);
        uVar16 =
            FUN_0009c010(SUB84(dVar15, 0), (int)((ulonglong)dVar15 >> 0x20));
    }
    puVar13[0x3b] = (int)uVar16;
    pcVar11 = (char *)(puVar13 + 0xe);
    puVar13[0x3a] = local_94 + -0x7c558180 + (int)((ulonglong)uVar16 >> 0x20);
    puVar13[0xc2] = puVar13[0xc2] + 1;
    local_f4 = pcVar11;
    __sprintf_chk(pcVar11, 1, 0x80, "%03d %02d:%02d:%02.6f");
    sVar5 = strlen(pcVar11);
    iVar4 = (int)(longlong)((double)uStack_a4 / 1000000.0);
    local_d0[1] = 1;
    local_d0[2] = 0x101;
    puVar13[0x33] = iVar4;
    local_d0[3] = 0;
    local_c8 = 0;
    puVar13[0x2e] = sVar5;
    puVar13[0x30] = (uint)local_9c;
    puVar13[0x31] = (uint)local_9e;
    puVar13[0x32] = (uint)local_9f;
    local_d0[0] = local_9a;
    puVar13[0x34] = (int)(longlong)(((double)uStack_a4 / 1000000.0 -
                                     (double)(longlong)iVar4) *
                                    1000000000.0);
    iVar4 = FUN_000731f0(local_d0);
    iVar9 = puVar13[0x30];
    iVar14 = puVar13[0x31];
    iVar6 = puVar13[0x32];
    puVar13[0x35] = iVar4;
    iVar7 = puVar13[0x33];
    dVar15 = (double)(longlong)(int)puVar13[0x34] / 1000000000.0;
    if (dVar15 < 0.0) {
        dVar15 = ldexp(-dVar15, 0x20);
        uVar16 =
            FUN_0009c010(SUB84(dVar15, 0), (int)((ulonglong)dVar15 >> 0x20));
        uVar16 = CONCAT44(
            -((int)((ulonglong)uVar16 >> 0x20) + (uint)((int)uVar16 != 0)),
            -(int)uVar16);
    } else {
        dVar15 = ldexp(dVar15, 0x20);
        uVar16 =
            FUN_0009c010(SUB84(dVar15, 0), (int)((ulonglong)dVar15 >> 0x20));
    }
    local_d4 = (undefined4)uVar16;
    local_d8 = (((iVar9 + -1) * 0x18 + iVar14) * 0x3c + iVar6) * 0x3c + iVar7 +
               iVar4 + (int)((ulonglong)uVar16 >> 0x20);
    FUN_00049a70((int)*(undefined8 *)(puVar13 + 0xba), puVar13, local_d8,
                 local_d4, puVar13[0x3a]);
    if (local_e0 == (undefined **)0x4) {
        iVar6 = (local_c0 - 0x7b2) * 0x1e13380 +
                (local_c0 - 0x7b1 >> 2) * 0x15180 + local_b4 * 0x3c +
                local_b8 * 0xe10 + local_bc * 0x15180 + local_b0 + -0x15181;
        iVar4 = FUN_0009bf30(iVar6, 0, 0x7861f80, 0);
        local_e0 = (undefined **)(iVar4 << 2);
        FUN_0009bf30(iVar6, 0, 0x7861f80, 0);
        uVar10 = extraout_r2;
        iVar4 = extraout_r3;
        if (0 < (int)(extraout_r3 + (uint)(0x1e1337f < extraout_r2)) !=
            SBORROW4(-extraout_r3, (uint)(0x1e1337f < extraout_r2))) {
            local_100 = extraout_r2 + 0xfe1ecc80;
            local_fc = extraout_r3 + -1 + (uint)(0x1e1337f < extraout_r2);
            if (0 < (int)(local_fc + (uint)(0x1e1337f < local_100)) ==
                SBORROW4(-local_fc, (uint)(0x1e1337f < local_100))) {
                local_e0 = (undefined **)((int)local_e0 + 1);
                uVar10 = local_100;
                iVar4 = local_fc;
            } else {
                local_108 = extraout_r2 + 0xfc3d9900;
                local_104 = extraout_r3 + -1 + (uint)(0x3c266ff < extraout_r2);
                if (0 < (int)(local_104 + (uint)(0x1e284ff < local_108)) ==
                    SBORROW4(-local_104, (uint)(0x1e284ff < local_108))) {
                    local_e0 = (undefined **)((int)local_e0 + 2);
                    uVar10 = local_108;
                    iVar4 = local_104;
                } else {
                    local_e0 = (undefined **)((int)local_e0 + 3);
                    uVar10 = extraout_r2 + 0xfa5b1400;
                    iVar4 = extraout_r3 + -1 + (uint)(0x5a4ebff < extraout_r2);
                }
            }
        }
        iVar6 = FUN_0009bf30(uVar10, iVar4, "comp", 0);
        ppuVar3 = local_e0;
        local_e4 = iVar6 + 1;
        FUN_0009bf30(uVar10, iVar4, "comp", 0);
        local_100 = extraout_r2_00;
        local_fc = extraout_r3_00;
        FUN_0009bf30(extraout_r2_00, extraout_r3_00, 0xe10, 0);
        local_bc = local_e4;
        local_e0 = (undefined **)extraout_r2_01;
        uStack_dc = extraout_r3_01;
        local_c0 = (int)ppuVar3 + 0x7b2U;
        local_b8 = FUN_0009bf30(local_100, local_fc, 0xe10, 0);
        local_b4 = FUN_0009bf30(local_e0, uStack_dc, 0x3c, 0);
        FUN_0009bf30(local_e0, uStack_dc, 0x3c, 0);
        if (((local_10c - 1 < 2) ||
             ((uint)local_9a != (int)ppuVar3 + 0x7b2U)) ||
            (local_9c != local_e4)) {
        LAB_0006a484:
            local_c4 = 0;
        LAB_0006a488:
            *(char *)(puVar13 + 10) = (char)local_c4;
        } else {
            if (local_c4 == 1)
                goto LAB_0006a488;
            if (local_c4 != -1)
                goto LAB_0006a484;
            *(undefined1 *)(puVar13 + 10) = 2;
        }
        *(undefined1 *)(param_2 + 0x5b) = *(undefined1 *)(puVar13 + 10);
        FUN_000494a0(param_2, 0);
        if (local_ec == (char *)0x0 || local_e8 == (char *)0x0) {
            uVar10 = local_f0[1];
            *(uint *)(param_2 + 0x44) = *(uint *)(param_2 + 0x44) | *local_f0;
            puVar13[0xbf] = uVar10;
            *(uint *)(param_2 + 0x70) = uVar10;
            uVar10 = local_f0[2];
            *(char *)(puVar13 + 0xbe) = (char)uVar10;
            *(char *)(param_2 + 0x5d) = (char)uVar10;
        } else {
            local_e0 = (undefined **)0xa8944;
            iVar4 = strcmp((char *)(&DAT_000c4b08)[local_f8 * 2], "LOCL");
            uVar10 = *(uint *)(param_2 + 0x44);
            pcVar11 = (char *)(&DAT_000c4b08)[iVar12 * 2];
            if ((iVar4 == 0) ||
                (iVar4 = strcmp(pcVar11, (char *)local_e0), iVar4 == 0)) {
                puVar1 = local_f0;
                *(uint *)(param_2 + 0x44) = uVar10 & 0xffffffdf;
                *(undefined1 *)(puVar13 + 0xbe) = 0x10;
                *(undefined1 *)(param_2 + 0x5d) = 0x10;
                iVar4 = *(int *)ppuVar2[0x241];
                if (iVar4 != param_2 && iVar4 != 0) {
                    *(undefined1 *)(local_f0 + 2) =
                        *(undefined1 *)(iVar4 + 0x5d);
                    uVar10 = FUN_0007083c(iVar4 + 0x10);
                    puVar1[1] = uVar10;
                }
            } else {
                *(uint *)(param_2 + 0x44) = *local_f0 | uVar10;
                *(undefined1 *)(local_f0 + 2) = 0;
                strncpy((char *)(local_f0 + 1), pcVar11, 4);
                *(undefined1 *)(puVar13 + 0xbe) = 0;
                *(undefined1 *)(param_2 + 0x5d) = 0;
            }
            strncpy((char *)(puVar13 + 0xbf), pcVar11, 4);
            *(undefined4 *)(param_2 + 0x70) = puVar13[0xbf];
        }
    } else {
        puVar13[0xbf] = 0x4c434f4c;
        *(undefined4 *)(param_2 + 0x70) = puVar13[0xbf];
        *(undefined1 *)(puVar13 + 10) = 3;
        *(undefined1 *)(param_2 + 0x5b) = 3;
    }
    if (puVar13[0x36] == puVar13[0x37]) {
        FUN_000494a0(param_2, 1);
    } else {
        FUN_00051f44(param_2 + 0x10, local_f4);
        FUN_00049d44(param_2);
        puVar13[0xc2] = puVar13[0xc2] + 1;
    }
LAB_0006a1e8:
    if (local_3c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006a694(int param_1)

{
    byte bVar1;
    int iVar2;
    undefined4 *puVar3;
    undefined4 *puVar4;
    char acStack_9c[128];
    int local_1c;

    puVar3 = *(undefined4 **)(param_1 + 0x54);
    puVar4 = (undefined4 *)*puVar3;
    local_1c = __stack_chk_guard;
    if (puVar3[7] == -1) {
        bVar1 = *(byte *)(puVar3 + 0xc0);
    } else {
        FUN_00035ee0(0x8b, param_1, "close");
        iVar2 = ioctl(puVar3[7], 0x5417);
        if (iVar2 < 0) {
            FUN_00074e00(3, "acts: ioctl(TIOCMBIC) failed: %m");
        }
        FUN_00028e64(puVar3 + 2);
        puVar3[7] = 0xffffffff;
        bVar1 = *(byte *)(puVar3 + 0xc0);
    }
    if ((bVar1 & 2) != 0) {
        FUN_0007c054(acStack_9c, 0x80, "/var/spool/lock/LCK..cua%d", *puVar4);
        unlink(acStack_9c);
    }
    if (((puVar4[4] == 0) && (0 < (int)puVar4[3])) &&
        (*(int *)(sys_phone + puVar4[3] * 4) != 0)) {
        puVar4[1] = 0;
        puVar4[2] = 0x1e;
    } else {
        puVar4[1] = 0;
        puVar4[2] = 0;
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006a7d8(int param_1, undefined4 param_2)

{
    undefined *__buf;
    int iVar1;
    __pid_t _Var2;
    size_t sVar3;
    ssize_t sVar4;
    int iVar5;
    undefined4 uVar6;
    undefined4 *puVar7;
    undefined4 *puVar8;
    char acStack_c0[8];
    undefined1 auStack_b8[20];
    char acStack_a4[128];
    int local_24;

    puVar7 = *(undefined4 **)(param_1 + 0x54);
    puVar8 = (undefined4 *)*puVar7;
    local_24 = __stack_chk_guard;
    switch (param_2) {
    case 0:
        if (puVar7[7] == -1) {
            uVar6 = *puVar8;
            if ((*(byte *)(puVar7 + 0xc0) & 2) != 0) {
                FUN_0007c054(acStack_a4, 0x80, "/var/spool/lock/LCK..cua%d",
                             uVar6);
                iVar1 = open64(acStack_a4, 0xc1, 0x1a4);
                if (iVar1 < 0) {
                    FUN_00035ee0(0x8b, param_1, "acts: port busy");
                    goto code_r0x0006a83c;
                }
                _Var2 = getpid();
                FUN_0007c054(acStack_c0, 8, "%d\n", _Var2);
                sVar3 = strlen(acStack_c0);
                sVar4 = write(iVar1, acStack_c0, sVar3);
                if (sVar4 < 0) {
                    FUN_00074e00(3, "acts: write lock fails %m");
                }
                close(iVar1);
                uVar6 = *puVar8;
            }
            FUN_0007c054(auStack_b8, 0x14, "/dev/acts%d", uVar6);
            iVar1 = FUN_0004a298(auStack_b8, 0xe, 0xa4);
            if (iVar1 < 0) {
                FUN_00074e00(3, "acts: open fails %m");
            } else {
                puVar7[7] = iVar1;
                iVar5 = FUN_00028df0(puVar7 + 2);
                if (iVar5 == 0) {
                    FUN_00074e00(3, "acts: addclock fails");
                    close(iVar1);
                    puVar7[7] = 0xffffffff;
                } else {
                    puVar8[4] = 0;
                    puVar8[7] = puVar8 + 8;
                    if (*(int *)(sys_phone + puVar8[3] * 4) == 0) {
                        sVar4 = write(puVar7[7], "T", 1);
                        if (sVar4 < 0) {
                            FUN_00074e00(3, "acts: write T fails %m");
                        }
                        puVar8[1] = 3;
                        puVar8[2] = 0x3c;
                    } else {
                        FUN_000362e8(0x8b, param_1, "SETUP %s", modem_setup);
                        __buf = modem_setup;
                        sVar3 = strlen(modem_setup);
                        sVar4 = write(puVar7[7], __buf, sVar3);
                        if (sVar4 < 0) {
                            FUN_00074e00(3, "acts: write SETUP fails %m");
                        }
                        write(puVar7[7], "\r", 1);
                        puVar8[1] = 1;
                        puVar8[2] = 3;
                    }
                }
            }
        }
        goto code_r0x0006a83c;
    case 1:
        FUN_00035ee0(0x8b, param_1, "no modem");
        break;
    case 2:
        FUN_00035ee0(0x8b, param_1, "no answer");
        break;
    case 3:
        if (puVar8[4] == 0) {
            FUN_00035ee0(0x8b, param_1, "no timecodes");
        } else {
            puVar7[0x38] = puVar7[0x3a];
            puVar7[0x39] = puVar7[0x3b];
            FUN_00051f44(param_1 + 0x10, puVar7 + 0xe);
            FUN_00049d44(param_1);
        }
    }
    FUN_0006a694(param_1);
code_r0x0006a83c:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Type propagation algorithm not settling */

void FUN_0006acf0(int param_1)

{
    uint uVar1;
    ushort **ppuVar2;
    size_t sVar3;
    ssize_t sVar4;
    byte *pbVar5;
    int iVar6;
    int *piVar7;
    int iVar8;
    byte *__buf;
    int iVar9;
    char *__s;
    int *piVar10;
    int *piVar11;
    int iVar12;
    char *__s_00;
    int iVar13;
    int *piVar14;
    byte local_16e;
    char local_16d;
    undefined1 uStack_16c;
    char local_16b;
    undefined1 uStack_16a;
    char local_169;
    undefined4 local_168;
    undefined4 local_164;
    int local_160;
    undefined1 auStack_15c[4];
    undefined1 auStack_158[4];
    int local_154;
    undefined1 auStack_150[4];
    int local_14c;
    undefined1 auStack_148[8];
    undefined1 auStack_140[8];
    undefined1 auStack_138[12];
    byte local_12c[128];
    char local_ac;
    char local_ab;
    char local_aa;
    int local_2c;

    iVar12 = *(int *)(param_1 + 4);
    __buf = local_12c;
    piVar10 = *(int **)(iVar12 + 0x54);
    piVar11 = piVar10 + 0x3a;
    iVar9 = *piVar10;
    __s = (char *)(iVar9 + 0x20);
    local_2c = __stack_chk_guard;
    FUN_00049f94(param_1, __buf, 0x80 - (*(int *)(iVar9 + 0x1c) - (int)__s),
                 piVar11);
    do {
        while (true) {
            uVar1 = (uint)local_12c[0];
            if (uVar1 == 0) {
                if (local_2c == __stack_chk_guard) {
                    return;
                }
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            if (uVar1 == 10)
                break;
            ppuVar2 = __ctype_b_loc();
            if (((*ppuVar2)[uVar1] & 2) == 0) {
                pbVar5 = *(byte **)(iVar9 + 0x1c);
                *(byte **)(iVar9 + 0x1c) = pbVar5 + 1;
                *pbVar5 = *__buf;
                if (*__buf == 0x23 || *__buf == 0x2a) {
                    iVar6 = piVar10[0x3b];
                    *(int *)(iVar9 + 0x14) = *piVar11;
                    *(int *)(iVar9 + 0x18) = iVar6;
                    sVar4 = write(piVar10[7], __buf, 1);
                    if (sVar4 < 0) {
                        FUN_00074e00(3, "acts: write echo fails %m");
                    }
                }
            }
        LAB_0006adb8:
            __buf = __buf + 1;
            local_12c[0] = *__buf;
        }
        if (__s == *(char **)(iVar9 + 0x1c)) {
            iVar6 = piVar10[0x3b];
            *(int *)(iVar9 + 0x14) = *piVar11;
            *(int *)(iVar9 + 0x18) = iVar6;
            goto LAB_0006adb8;
        }
        **(char **)(iVar9 + 0x1c) = '\0';
        piVar14 = *(int **)(iVar12 + 0x54);
        *(char **)(iVar9 + 0x1c) = __s;
        iVar13 = *piVar14;
        local_168 = 2;
        FUN_0007d4dc(&local_ac, __s, 0x80);
        strtok(&local_ac, " ");
        iVar6 = *(int *)(iVar13 + 4);
        if (iVar6 == 2) {
            iVar6 = strcmp(&local_ac, "CONNECT");
            if (iVar6 != 0)
                goto LAB_0006ae30;
            FUN_00035ee0(0x8b, iVar12, __s);
            *(undefined4 *)(iVar13 + 4) = 3;
            *(undefined4 *)(iVar13 + 8) = 0x3c;
            goto LAB_0006adb8;
        }
        if (iVar6 == 3) {
            if (((local_ac == 'N') && (local_ab == 'O')) &&
                (local_aa == '\0')) {
                FUN_00035ee0(0x8b, iVar12, __s);
            }
            if (*(int *)(iVar13 + 0x10) < 0x14) {
                piVar14 = *(int **)(iVar12 + 0x54);
                piVar14[0x34] = 0;
                sVar3 = strlen(__s);
                iVar6 = *piVar14;
                if (sVar3 == 0x16) {
                    iVar13 =
                        sscanf(__s, "%c %3d %2d:%2d:%2d %cTZ=%2d", &local_16d,
                               piVar14 + 0x30, piVar14 + 0x31, piVar14 + 0x32,
                               piVar14 + 0x33, &uStack_16a, auStack_150);
                    if (iVar13 == 7) {
                        *(undefined1 *)(piVar14 + 10) = 0;
                        if (local_16d != ' ') {
                            *(undefined1 *)(piVar14 + 10) = 3;
                        }
                        piVar7 = &DAT_000a9a98;
                        goto LAB_0006b0b0;
                    }
                LAB_0006b1b8:
                    FUN_000494a0(iVar12, 2);
                } else if (sVar3 < 0x17) {
                    if (sVar3 == 1) {
                        if ((*(char *)(iVar9 + 0x20) == '*') &&
                            (0 < *(int *)(iVar6 + 0x10))) {
                            iVar13 = *(int *)(iVar6 + 0x14);
                            iVar6 = *(int *)(iVar6 + 0x18);
                            *(int *)(iVar12 + 0x70) = piVar14[0xbf];
                            piVar14[0x3a] = iVar13;
                            piVar14[0x3b] = iVar6;
                            goto LAB_0006b0e4;
                        }
                    } else if (sVar3 == 0x14) {
                        iVar13 =
                            sscanf(__s, "%5ld %3d %2d%2d%2d %3s", auStack_15c,
                                   piVar14 + 0x30, piVar14 + 0x31,
                                   piVar14 + 0x32, piVar14 + 0x33, auStack_138);
                        if (iVar13 != 6)
                            goto LAB_0006b1b8;
                        *(undefined1 *)(piVar14 + 10) = 0;
                        piVar7 = &DAT_000aa090;
                        goto LAB_0006b0b0;
                    }
                } else {
                    if (sVar3 == 0x32) {
                        iVar13 = sscanf(__s,
                                        "%5ld %2d-%2d-%2d %2d:%2d:%2d %2d %1d "
                                        "%3lf %5lf %9s %c",
                                        auStack_15c, piVar14 + 0x2f, &local_160,
                                        &local_164, piVar14 + 0x31,
                                        piVar14 + 0x32, piVar14 + 0x33,
                                        auStack_158, &local_154, auStack_148,
                                        auStack_140, auStack_138, &local_16e);
                        if (iVar13 != 0xd)
                            goto LAB_0006b1b8;
                        iVar13 =
                            FUN_0007ec68(piVar14[0x2f], local_160, local_164);
                        piVar14[0x30] = iVar13;
                        *(undefined1 *)(piVar14 + 10) = 0;
                        if ((local_154 == 1) || (local_154 == 2)) {
                            *(char *)(piVar14 + 10) = (char)local_154;
                        }
                        iVar13 = local_16e - 0x23;
                        if (iVar13 != 0) {
                            iVar13 = 1;
                        }
                        piVar14[0xbf] = 0x5453494e;
                        iVar8 = *(int *)(iVar6 + 0x10) + 1;
                        *(int *)(iVar6 + 0x10) = iVar8;
                        if (9 < iVar8) {
                            iVar13 = 0;
                        }
                        if (iVar13 != 0)
                            goto LAB_0006adb8;
                    } else {
                        if (sVar3 == 0x4e) {
                            iVar13 = sscanf(
                                __s,
                                "%*4d-%*2d-%*2d %*2d:%*2d:%2d "
                                "%*5c%*12c%4d%2d%2d%2d%2d%5ld%2lf%c%2d%3lf%*"
                                "15c%c",
                                piVar14 + 0x33, piVar14 + 0x2f, &local_160,
                                &local_164, piVar14 + 0x31, piVar14 + 0x32,
                                auStack_15c, auStack_148, &local_169,
                                &local_14c, auStack_140, &local_16e);
                            if (iVar13 != 0xc)
                                goto LAB_0006b1b8;
                            *(undefined1 *)(piVar14 + 10) = 0;
                            if (local_14c == local_160) {
                                if (local_169 == '+') {
                                    *(undefined1 *)(piVar14 + 10) = 1;
                                } else if (local_169 == '-') {
                                    *(undefined1 *)(piVar14 + 10) = 2;
                                }
                            }
                            iVar13 = FUN_0007ec68(piVar14[0x2f], local_160,
                                                  local_164);
                            piVar14[0x30] = iVar13;
                            piVar7 = &DAT_000a9eb8;
                        } else {
                            if (sVar3 != 0x18)
                                goto LAB_0006adb8;
                            iVar13 = sscanf(
                                __s, "%c%c%2d %3d %2d:%2d:%2d.%3ld%c%c%c",
                                &local_16d, &uStack_16c, piVar14 + 0x2f,
                                piVar14 + 0x30, piVar14 + 0x31, piVar14 + 0x32,
                                piVar14 + 0x33, piVar14 + 0x34, &uStack_16a,
                                &local_16b, &uStack_16a);
                            if (iVar13 != 0xb)
                                goto LAB_0006b1b8;
                            *(undefined1 *)(piVar14 + 10) = 0;
                            piVar14[0x34] = piVar14[0x34] * 1000000;
                            if (local_16d == ' ') {
                                if (local_16b == 'L') {
                                    *(undefined1 *)(piVar14 + 10) = 1;
                                }
                            } else {
                                *(undefined1 *)(piVar14 + 10) = 3;
                            }
                            piVar7 = &DAT_000a9a98;
                        }
                    LAB_0006b0b0:
                        piVar14[0xbf] = *piVar7;
                        iVar8 = *(int *)(iVar6 + 0x10) + 1;
                        *(int *)(iVar6 + 0x10) = iVar8;
                    }
                    iVar13 = *(int *)(iVar6 + 0x14);
                    iVar6 = *(int *)(iVar6 + 0x18);
                    *(int *)(iVar12 + 0x70) = piVar14[0xbf];
                    piVar14[0x3a] = iVar13;
                    piVar14[0x3b] = iVar6;
                    if (iVar8 != 0) {
                    LAB_0006b0e4:
                        FUN_0007d4dc(piVar14 + 0xe, __s, 0x80);
                        sVar3 = strlen((char *)(piVar14 + 0xe));
                        piVar14[0x2e] = sVar3;
                        iVar6 = FUN_00049cf8(piVar14);
                        if (iVar6 == 0) {
                            FUN_000494a0(iVar12, 6);
                        } else {
                            piVar14[0x38] = piVar14[0x3a];
                            piVar14[0x39] = piVar14[0x3b];
                        }
                    }
                }
            } else {
                FUN_0006a7d8(iVar12, 3);
            }
            goto LAB_0006adb8;
        }
        if (iVar6 == 1) {
            if (((local_ac == 'O') && (local_ab == 'K')) &&
                (local_aa == '\0')) {
                FUN_000362e8(
                    0x8b, iVar12, "DIAL #%d %s", *(int *)(iVar13 + 0xc),
                    *(undefined4 *)(sys_phone + *(int *)(iVar13 + 0xc) * 4));
                iVar6 = ioctl(piVar14[7], 0x5416, &local_168);
                if (iVar6 < 0) {
                    FUN_00074e00(3, "acts: ioctl(TIOCMBIS) failed: %m");
                }
                __s_00 = *(char **)(sys_phone + *(int *)(iVar13 + 0xc) * 4);
                sVar3 = strlen(__s_00);
                sVar4 = write(piVar14[7], __s_00, sVar3);
                if (sVar4 < 0) {
                    FUN_00074e00(3, "acts: write DIAL fails %m");
                }
                write(piVar14[7], "\r", 1);
                *(undefined4 *)(iVar13 + 4) = 2;
                *(undefined4 *)(iVar13 + 8) = 0x3c;
                *(int *)(iVar13 + 0xc) = *(int *)(iVar13 + 0xc) + 1;
            } else {
                iVar6 = strcmp(&local_ac, modem_setup);
                if (iVar6 != 0)
                    goto LAB_0006ae30;
            }
            goto LAB_0006adb8;
        }
    LAB_0006ae30:
        FUN_00035ee0(0x8b, iVar12, __s);
        FUN_0006a694(iVar12);
        __buf = __buf + 1;
        local_12c[0] = *__buf;
    } while (true);
}

void FUN_0006b4c0(undefined4 param_1, int param_2)

{
    int iVar1;
    undefined4 *puVar2;
    int iVar3;
    undefined4 *puVar4;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined4 *)FUN_00073ba4(0, 0xa0, 0, 1);
    puVar4 = *(undefined4 **)(param_2 + 0x54);
    *puVar2 = param_1;
    puVar4[7] = 0xffffffff;
    puVar4[3] = FUN_0006acf0;
    puVar4[6] = 0;
    *puVar4 = puVar2;
    puVar4[5] = param_2;
    *(undefined1 *)(param_2 + 0x5f) = 0xf6;
    puVar4[0xb] = "Automated Computer Time Service";
    puVar4[0xbf] = 0x454e4f4e;
    *(undefined1 *)(param_2 + 0x5a) = 9;
    puVar2[7] = puVar2 + 8;
    if ((modem_setup == def_modem_setup) &&
        (iVar3 = FUN_00034d10("modemsetup"), iVar3 != 0)) {
        modem_setup = (undefined *)FUN_00073d08();
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(1);
}

void FUN_0006b5dc(undefined4 param_1, int param_2)

{
    int iVar1;
    ssize_t sVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    piVar3 = *(int **)(param_2 + 0x54);
    piVar3[0xc2] = piVar3[0xc2] + 1;
    *(undefined4 *)(*piVar3 + 8) = 0;
    sVar2 = write(piVar3[7], &DAT_000aa178, 2);
    if (sVar2 != 2) {
        FUN_000494a0(param_2, 3);
    }
    if (piVar3[0x36] == piVar3[0x37]) {
        if (iVar1 == __stack_chk_guard) {
            FUN_000494a0(param_2, 1);
            return;
        }
    } else {
        FUN_00049d44(param_2);
        if (iVar1 == __stack_chk_guard) {
            FUN_00051f44(param_2 + 0x10, piVar3 + 0xe);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006bfcc(int param_1)

{
    ssize_t sVar1;
    int iVar2;
    int *piVar3;
    bool bVar4;
    char local_1d;
    int local_1c;

    piVar3 = *(int **)(param_1 + 0x54);
    iVar2 = *piVar3;
    local_1d = *(char *)(iVar2 + 0x1c);
    *(undefined1 *)(iVar2 + 0x1c) = *(undefined1 *)(iVar2 + 0x1d);
    local_1c = __stack_chk_guard;
    *(undefined1 *)(iVar2 + 0x1d) = *(undefined1 *)(iVar2 + 0x1e);
    *(undefined1 *)(iVar2 + 0x1e) = *(undefined1 *)(iVar2 + 0x1f);
    *(undefined1 *)(iVar2 + 0x1f) = *(undefined1 *)(iVar2 + 0x20);
    if (local_1d != '\0') {
        sVar1 = write(piVar3[7], &local_1d, 1);
        if (sVar1 != 1) {
            FUN_00074e00(5, "ARCRON: write to fd %d failed", piVar3[7]);
        }
        piVar3 = *(int **)(param_1 + 0x54);
    }
    bVar4 = local_1c == __stack_chk_guard;
    piVar3[0xc] = current_time + 2;
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006c09c(byte *param_1, int *param_2)

{
    int iVar1;
    ushort **ppuVar2;

    iVar1 = __stack_chk_guard;
    ppuVar2 = __ctype_b_loc();
    if (((*ppuVar2)[*param_1] & 0x800) != 0) {
        if (((*ppuVar2)[param_1[1]] & 0x800) != 0) {
            *param_2 = (uint)param_1[1] + (*param_1 - 0x30) * 10 + -0x30;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006c130(int param_1, int param_2)

{
    int iVar1;
    int iVar2;
    void *__ptr;
    uint uVar3;
    undefined4 uVar4;
    undefined4 *puVar5;
    termios local_7c;
    char acStack_40[20];
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_00074e00(5, "MSF_ARCRON %s: opening unit %d", "V1.3 2003/02/21",
                 param_1);
    FUN_0007c054(acStack_40, 0x14, "/dev/arc%d", param_1);
    iVar1 = FUN_0004a298(acStack_40, 7, 1);
    if (iVar1 < 1) {
        uVar4 = 0;
    } else {
        iVar2 = open64(acStack_40, 0x102, 0x1ff);
        if (iVar2 < 0) {
            uVar4 = 0;
            FUN_00074e00(3, "MSF_ARCRON(%d): failed second open(%s, 0777): %m.",
                         param_1, acStack_40);
            close(iVar1);
        } else {
            close(iVar1);
            iVar1 = fcntl(iVar2, 4, 0);
            if (iVar1 == -1) {
                FUN_00074e00(3, "MSF_ARCRON(%d): fcntl(F_SETFL, 0): %m.",
                             param_1);
            }
            iVar1 = tcgetattr(iVar2, &local_7c);
            if (iVar1 < 0) {
                uVar4 = 0;
                FUN_00074e00(3, "MSF_ARCRON(%d): tcgetattr(%s): %m.", param_1,
                             acStack_40);
                close(iVar2);
            } else {
                uVar4 = 0;
                local_7c.c_iflag = 0x21;
                local_7c.c_oflag = 0;
                local_7c.c_lflag = 0;
                local_7c.c_cflag = 0x8f7;
                local_7c.c_cc[5] = '\0';
                local_7c.c_cc[6] = '\x01';
                iVar1 = tcsetattr(iVar2, 0, &local_7c);
                if (iVar1 < 0) {
                    uVar4 = 0;
                    FUN_00074e00(3, "MSF_ARCRON(%d): tcsetattr(%s): %m.",
                                 param_1, acStack_40);
                    close(iVar2);
                } else {
                    __ptr = (void *)FUN_00073ba4(0, 0x28, 0, 1);
                    puVar5 = *(undefined4 **)(param_2 + 0x54);
                    puVar5[5] = param_2;
                    puVar5[6] = 0;
                    puVar5[7] = iVar2;
                    puVar5[3] = FUN_0006c6dc;
                    iVar1 = FUN_00028df0(puVar5 + 2);
                    if (iVar1 == 0) {
                        close(iVar2);
                        puVar5[7] = 0xffffffff;
                        free(__ptr);
                        uVar4 = 0;
                    } else {
                        uVar3 = *(uint *)(param_2 + 0x4c);
                        *puVar5 = __ptr;
                        *(undefined1 *)(param_2 + 0x5f) = 0xfc;
                        *(undefined1 *)(param_2 + 0x5d) = 2;
                        puVar5[0xb] = "ARCRON MSF/DCF/WWVB Receiver";
                        if (uVar3 < 4) {
                            if (uVar3 == 2) {
                                puVar5[0xbf] = 0x464344;
                            } else if (uVar3 == 3) {
                                puVar5[0xbf] = 0x42565757;
                            } else if (uVar3 == 1) {
                                puVar5[0xbf] = 0x46534d;
                            } else {
                                puVar5[0xbf] = 0x6146534d;
                            }
                            iVar2 = *(int *)(param_2 + 0x54);
                            uVar4 = 1;
                            *(undefined4 *)((int)__ptr + 0xc) = 0xffffffff;
                            iVar1 = current_time + 2;
                            *(int *)((int)__ptr + 0x14) =
                                (param_1 * 0x43) % 0x3f1 + current_time + 500;
                            *(int *)(iVar2 + 0x30) = iVar1;
                            *(code **)(iVar2 + 0x34) = FUN_0006bfcc;
                        } else {
                            FUN_00074e00(5, "ARCRON: Invalid mode %d");
                        }
                    }
                }
            }
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar4);
    }
    return;
}

void FUN_0006c498(int param_1, char *param_2)

{
    int iVar1;
    size_t sVar2;
    undefined4 uVar3;
    int iVar4;
    char *pcVar5;
    char cVar6;

    iVar1 = __stack_chk_guard;
    sVar2 = strlen(param_2);
    if (*(char *)(param_1 + 0x1f) == '\0') {
        if (*(char *)(param_1 + 0x1e) == '\0') {
            if (*(char *)(param_1 + 0x1d) == '\0') {
                if (*(char *)(param_1 + 0x1c) == '\0') {
                    iVar4 = 4;
                } else {
                    iVar4 = 3;
                }
            } else {
                iVar4 = 2;
            }
        } else {
            iVar4 = 1;
        }
    } else {
        iVar4 = 0;
    }
    if (iVar4 < (int)sVar2) {
        uVar3 = 0;
    } else {
        cVar6 = *param_2;
        if (cVar6 != '\0' && iVar4 != 0) {
            pcVar5 = (char *)(param_1 + (0x20 - iVar4));
            do {
                *pcVar5 = cVar6;
                iVar4 = iVar4 + -1;
                param_2 = param_2 + 1;
                cVar6 = *param_2;
                pcVar5 = pcVar5 + 1;
            } while (cVar6 != '\0' && iVar4 != 0);
        }
        uVar3 = 1;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_0006c588(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    undefined4 *puVar4;
    int iVar5;
    bool bVar6;

    iVar1 = __stack_chk_guard;
    piVar3 = *(int **)(param_2 + 0x54);
    iVar5 = *piVar3;
    if (((*(byte *)(piVar3 + 0xc0) & 2) == 0) &&
        (*(uint *)(iVar5 + 0x14) <= current_time)) {
        *(undefined4 *)(iVar5 + 0xc) = 0xffffffff;
        *(undefined4 *)(iVar5 + 0x18) = 1;
        FUN_00074e00(5, "ARCRON: unit %d: sending resync command", param_1);
        FUN_0006c498(iVar5, &DAT_000aa3b8);
        *(uint *)(iVar5 + 0x14) = current_time + 0xd5c;
    }
    iVar2 = __stack_chk_guard;
    if (*(int *)(iVar5 + 0xc) == -1 || 2 < *(int *)(iVar5 + 0xc)) {
        puVar4 = *(undefined4 **)(param_2 + 0x54);
        iVar5 = FUN_0006c498(*puVar4, &DAT_000aa3bc);
        iVar2 = __stack_chk_guard;
        if (iVar5 != 0) {
            bVar6 = iVar1 == __stack_chk_guard;
            puVar4[0xc2] = puVar4[0xc2] + 1;
            if (bVar6) {
                return;
            }
            goto LAB_0006c6c0;
        }
        puVar4[0x2e] = 0;
    } else {
        piVar3[0x2e] = 0;
    }
    if (iVar1 == iVar2) {
        FUN_000494a0(param_2, 3);
        return;
    }
LAB_0006c6c0:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006c6dc(int param_1)

{
    byte bVar1;
    byte bVar2;
    char *pcVar3;
    ushort **ppuVar4;
    tm *ptVar5;
    undefined4 uVar6;
    int iVar7;
    int extraout_r1;
    int extraout_r1_00;
    int iVar8;
    int iVar9;
    char cVar10;
    undefined1 uVar11;
    byte bVar12;
    undefined4 *puVar13;
    int *piVar14;
    uint uVar15;
    uint uVar16;
    uint uVar17;
    int iVar18;
    int iVar19;
    int iVar20;
    bool bVar21;
    bool bVar22;
    int local_64;
    time_t local_60[2];
    tm local_58;
    int local_2c;

    iVar18 = *(int *)(param_1 + 4);
    puVar13 = *(undefined4 **)(iVar18 + 0x54);
    piVar14 = (int *)*puVar13;
    local_2c = __stack_chk_guard;
    if ((((piVar14[6] != 0) && (*(char *)((int)piVar14 + 0x1f) == '\0')) &&
         (*(char *)((int)piVar14 + 0x1e) == '\0')) &&
        ((*(char *)((int)piVar14 + 0x1d) == '\0' &&
          ((char)piVar14[7] == '\0')))) {
        FUN_0006c498(piVar14, &DAT_000aa414);
    }
    iVar8 = puVar13[0x2e];
    iVar7 = *(int *)(param_1 + 0x54);
    cVar10 = *(char *)(param_1 + 0x58);
    if (*(char *)(puVar13 + 0xe) != 'o')
        goto LAB_0006c770;
    if (iVar8 == 1 && cVar10 == '\r') {
        if (iVar7 < 1)
            goto LAB_0006c780;
        goto LAB_0006c7a0;
    }
    iVar9 = iVar8 + iVar7 + -1;
    if (iVar9 < 1) {
    LAB_0006c770:
        if (iVar8 < 0x10) {
            if (0 < iVar7) {
            LAB_0006c7a0:
                pcVar3 = (char *)(param_1 + 0x58);
                iVar9 = iVar8;
                do {
                    if (cVar10 == '\r' || cVar10 == 'h') {
                        iVar8 = puVar13[0x2e];
                    } else {
                        iVar8 = iVar9 + 1;
                        puVar13[0x2e] = iVar8;
                        *(char *)((int)puVar13 + iVar9 + 0x38) = cVar10;
                    }
                    if ((cVar10 == 'o') && (iVar8 == 1)) {
                        piVar14[1] = 0;
                        *piVar14 = 0;
                        if (iVar7 <= (int)(pcVar3 + (-0x57 - param_1)))
                            goto code_r0x0006c810;
                    } else {
                        if (iVar7 <= (int)(pcVar3 + (-0x57 - param_1)))
                            break;
                        if (0xf < iVar8)
                            goto LAB_0006c8a8;
                    }
                    pcVar3 = pcVar3 + 1;
                    cVar10 = *pcVar3;
                    iVar9 = iVar8;
                } while (true);
            }
            if (iVar8 == 0)
                goto LAB_0006c780;
        LAB_0006c8a8:
            iVar7 = DAT_00116f18;
            cVar10 = *(char *)(puVar13 + 0xe);
            if (cVar10 != 'g')
                goto LAB_0006c8b4;
            if (((iVar8 < 3) ||
                 ((*(byte *)((int)puVar13 + 0x3a) & 0x70) != 0x30)) ||
                ((uVar15 = *(byte *)((int)puVar13 + 0x3a) & 0xf,
                  5 < uVar15 ||
                      ((*(byte *)((int)puVar13 + 0x39) & 0x70) != 0x30))))
                goto LAB_0006c780;
            if ((*(byte *)((int)puVar13 + 0x39) & 0x7f) == 0x33) {
                if ((uint)piVar14[4] < current_time) {
                    FUN_0006f724(local_60);
                    FUN_00073138(local_60[0], &local_58);
                    piVar14[4] =
                        (current_time + 0x41) - (local_58.tm_hour & 0xffU);
                    DAT_00116f10 = 0;
                    DAT_00116f14 = 0;
                }
                DAT_00116f14 = DAT_00116f14 + 1;
                DAT_00116f10 = uVar15 + DAT_00116f10;
                DAT_00116f18 = FUN_0009b908(DAT_00116f10, DAT_00116f14);
            } else if (piVar14[6] != 0) {
                bVar21 = DAT_00116f18 == -1;
                piVar14[3] = DAT_00116f18;
                if (bVar21) {
                    pcVar3 = "UNKNOWN, will use clock anyway";
                } else if (iVar7 < 3) {
                    pcVar3 = "TOO POOR, will not use clock";
                } else {
                    pcVar3 = "OK, will use clock";
                }
                FUN_00074e00(5, "ARCRON: sync finished, signal quality %d: %s",
                             iVar7, pcVar3);
                piVar14[6] = 0;
                DAT_00116f18 = 0;
                DAT_00116f10 = 0;
                DAT_00116f14 = 0;
                if (piVar14[3] < 3) {
                    piVar14[5] = current_time + 0x654;
                }
            }
        }
        puVar13[0x2e] = 0;
        goto LAB_0006c780;
    }
    if (iVar9 < 0x11) {
        iVar19 = *(int *)(param_1 + 0x48);
        iVar20 = *piVar14;
        uVar15 = piVar14[1];
        if (*(uint *)(param_1 + 0x4c) < *(uint *)(&DAT_000aa20c + iVar9 * 4)) {
            iVar19 = iVar19 + -1;
        }
        uVar16 =
            *(uint *)(param_1 + 0x4c) - *(uint *)(&DAT_000aa20c + iVar9 * 4);
        if ((iVar20 != 0 || uVar15 != 0) &&
            (iVar20 + 0x80000000U <= iVar19 + 0x80000000U)) {
            bVar21 = uVar16 == uVar15;
            if (uVar16 <= uVar15) {
                bVar21 = iVar19 == iVar20;
            }
            if (!bVar21)
                goto LAB_0006c770;
        }
        piVar14[1] = uVar16;
        *piVar14 = iVar19;
        goto LAB_0006c770;
    }
LAB_0006c8bc:
    puVar13[0x2e] = 0;
    FUN_000494a0(iVar18, 2);
LAB_0006c780:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
code_r0x0006c810:
    cVar10 = *(char *)(puVar13 + 0xe);
    if (cVar10 == 'g')
        goto LAB_0006c780;
LAB_0006c8b4:
    if (cVar10 == 'o') {
        if (iVar8 < 0x10)
            goto LAB_0006c780;
        if (*piVar14 == 0 && piVar14[1] == 0) {
            puVar13[0x2e] = 0;
            FUN_000494a0(iVar18, 2);
            goto LAB_0006c780;
        }
        iVar7 = piVar14[3];
        *(undefined1 *)((int)puVar13 + iVar8 + 0x39) = 0;
        bVar21 = iVar7 != -1;
        if (bVar21) {
            iVar7 = iVar7 + 0x30;
        }
        uVar11 = (undefined1)iVar7;
        if (!bVar21) {
            uVar11 = 0x36;
        }
        *(undefined1 *)((int)puVar13 + iVar8 + 0x38) = uVar11;
        puVar13[0x34] = 0;
        if ((((*(char *)(puVar13 + 0xe) == 'o') &&
              (iVar7 = FUN_0006c09c((int)puVar13 + 0x39, puVar13 + 0x31),
               iVar7 != 0)) &&
             (iVar7 = FUN_0006c09c((int)puVar13 + 0x3b, puVar13 + 0x32),
              iVar7 != 0)) &&
            (iVar7 = FUN_0006c09c((int)puVar13 + 0x3d, puVar13 + 0x33),
             iVar7 != 0)) {
            bVar12 = *(byte *)((int)puVar13 + 0x3f);
            ppuVar4 = __ctype_b_loc();
            if (((((*ppuVar4)[bVar12] & 0x800) != 0) &&
                 (iVar7 = FUN_0006c09c(puVar13 + 0x10, puVar13 + 0x30),
                  iVar7 != 0)) &&
                ((iVar7 = FUN_0006c09c((int)puVar13 + 0x42, &local_64),
                  iVar7 != 0 &&
                      (iVar7 = FUN_0006c09c(puVar13 + 0x11, puVar13 + 0x2f),
                       iVar7 != 0)))) {
                bVar1 = *(byte *)((int)puVar13 + 0x46);
                uVar15 = (uint)bVar1;
                bVar2 = *(byte *)((int)puVar13 + 0x47);
                if (((uint)puVar13[0x31] < 0x18) &&
                    ((uint)puVar13[0x32] < 0x3c)) {
                    uVar16 = bVar12 - 0x31;
                    bVar22 = 5 < uVar16;
                    bVar21 = uVar16 == 6;
                    if (uVar16 < 7) {
                        bVar22 = 0x3b < (uint)puVar13[0x33];
                        bVar21 = puVar13[0x33] == 0x3c;
                    }
                    if ((((!bVar22 || bVar21) && (puVar13[0x30] - 1 < 0x1f)) &&
                         (local_64 - 1U < 0xc)) &&
                        (uVar16 = puVar13[0x2f], uVar16 < 100)) {
                        if ((*(int *)(iVar18 + 0x4c) == 0) &&
                            ((uVar15 << 0x1e) >> 0x1f !=
                             ((uVar15 ^ 4) << 0x1d) >> 0x1f)) {
                            puVar13[0x2e] = 0;
                            FUN_000494a0(iVar18, 2);
                            goto LAB_0006c780;
                        }
                        if ((bVar2 & 8) != 0) {
                            FUN_00074e00(5, "ARCRON: battery low");
                            uVar16 = puVar13[0x2f];
                        }
                        if ((int)uVar16 < 0x62) {
                            uVar16 = uVar16 + 100;
                            puVar13[0x2f] = uVar16;
                        }
                        puVar13[0x2f] = uVar16 + 0x76c;
                        if (0x82f < (int)(uVar16 + 0x76c)) {
                            FUN_00074e00(
                                5, "ARCRON: fix me!  EITHER YOUR DATE IS BADLY "
                                   "WRONG or else I will break soon!");
                        }
                        uVar16 = bVar2 & 7;
                        *(undefined1 *)(puVar13 + 10) = 0;
                        if (uVar16 == 3) {
                            if (piVar14[2] != 3) {
                                FUN_00074e00(5, "ARCRON: signal acquired");
                            }
                        } else if (uVar16 != piVar14[2]) {
                            FUN_00074e00(5, "ARCRON: signal lost");
                            *(undefined1 *)(puVar13 + 10) = 3;
                            piVar14[2] = uVar16;
                            puVar13[0x2e] = 0;
                            FUN_000494a0(iVar18);
                            goto LAB_0006c780;
                        }
                        iVar7 = local_64;
                        iVar9 = *(int *)(iVar18 + 0x4c);
                        uVar17 = puVar13[0x2f];
                        piVar14[2] = uVar16;
                        iVar8 = puVar13[0x30];
                        if (iVar9 == 0) {
                            iVar9 = *(int *)(&DAT_000aa24c + local_64 * 4);
                            puVar13[0x30] = iVar8 + iVar9;
                            if (((uVar17 & 3) == 0) &&
                                (((FUN_0009bb9c(uVar17, 100),
                                   extraout_r1 != 0 ||
                                       (FUN_0009bb9c(uVar17, 400),
                                        extraout_r1_00 == 0)) &&
                                  (2 < iVar7)))) {
                                puVar13[0x30] = iVar8 + iVar9 + 1;
                            }
                            if (((bVar1 & 2) != 0) &&
                                (iVar7 = puVar13[0x31],
                                 puVar13[0x31] = iVar7 + -1, iVar7 + -1 < 0)) {
                                iVar7 = puVar13[0x30];
                                puVar13[0x31] = 0x17;
                                puVar13[0x30] = iVar7 + -1;
                                if (iVar7 + -1 < 0) {
                                    puVar13[0x2e] = 0;
                                    FUN_000494a0(iVar18, 6);
                                    goto LAB_0006c780;
                                }
                            }
                            bVar12 = *(byte *)(puVar13 + 0xc0);
                        LAB_0006cd24:
                            if (piVar14[3] != -1)
                                goto LAB_0006cd38;
                            *(undefined1 *)(iVar18 + 0x5f) = 0xfc;
                        } else {
                            if ((*(byte *)(puVar13 + 0xc0) & 1) == 0) {
                                uVar6 = FUN_0007ec68(uVar17, local_64, iVar8);
                                puVar13[0x30] = uVar6;
                            } else {
                                local_58.tm_yday = 0;
                                local_58.tm_wday = 0;
                                local_58.tm_year = uVar17 - 0x76c;
                                local_58.tm_isdst = 0;
                                local_58.tm_mon = local_64 + -1;
                                local_58.tm_gmtoff = 0;
                                local_58.tm_zone = (char *)0x0;
                                local_58.tm_hour = puVar13[0x31];
                                local_58.tm_min = puVar13[0x32];
                                local_58.tm_sec = puVar13[0x33];
                                local_58.tm_mday = iVar8;
                                if (iVar9 == 2) {
                                LAB_0006cef4:
                                    local_58.tm_isdst = uVar15 & 2;
                                } else {
                                    if (iVar9 != 3) {
                                        if (iVar9 != 1) {
                                            FUN_00074e00(
                                                5, "ARCRON: Invalid mode %d");
                                            goto LAB_0006c780;
                                        }
                                        goto LAB_0006cef4;
                                    }
                                    if ((bVar1 & 3) != 0) {
                                        if ((uVar15 & 3) < 3) {
                                            local_58.tm_isdst = 0xffffffff;
                                        } else if ((uVar15 & 3) == 3) {
                                            local_58.tm_isdst = 1;
                                        }
                                    }
                                }
                                local_60[0] = mktime(&local_58);
                                ptVar5 = gmtime(local_60);
                                if (ptVar5 == (tm *)0x0) {
                                    puVar13[0x2e] = 0;
                                    FUN_000494a0(iVar18, 3);
                                    goto LAB_0006c780;
                                }
                                iVar8 = ptVar5->tm_mday;
                                local_64 = ptVar5->tm_mon + 1;
                                iVar7 = ptVar5->tm_year + 0x76c;
                                puVar13[0x2f] = iVar7;
                                uVar6 = FUN_0007ec68(iVar7, local_64, iVar8);
                                iVar7 = ptVar5->tm_hour;
                                iVar8 = ptVar5->tm_min;
                                iVar9 = ptVar5->tm_sec;
                                puVar13[0x30] = uVar6;
                                puVar13[0x31] = iVar7;
                                puVar13[0x32] = iVar8;
                                puVar13[0x33] = iVar9;
                            }
                            bVar12 = *(byte *)(puVar13 + 0xc0);
                            if (((*(int *)(iVar18 + 0x4c) == 0) ||
                                 (uVar16 != 3)) ||
                                ((bVar12 & 2) == 0))
                                goto LAB_0006cd24;
                        LAB_0006cd38:
                            if ((bVar12 & 4) == 0) {
                                uVar11 = 0xfc;
                            } else {
                                uVar11 = 0xfb;
                            }
                            *(undefined1 *)(iVar18 + 0x5f) = uVar11;
                        }
                        iVar7 = piVar14[1];
                        if (piVar14[9] != (uint) * (byte *)(puVar13 + 0xc0)) {
                            piVar14[9] = (uint) * (byte *)(puVar13 + 0xc0);
                        }
                        puVar13[0x3a] = *piVar14;
                        puVar13[0x3b] = iVar7;
                        iVar7 = FUN_00049cf8(puVar13);
                        if (iVar7 == 0) {
                            puVar13[0x2e] = 0;
                            FUN_000494a0(iVar18, 6);
                        } else {
                            FUN_00051f44(iVar18 + 0x10, puVar13 + 0xe);
                            FUN_00049d44(iVar18);
                        }
                        goto LAB_0006c780;
                    }
                }
            }
        }
    }
    goto LAB_0006c8bc;
}

void FUN_0006d1f8(int param_1)

{
    int iVar1;
    undefined1 *puVar2;
    size_t sVar3;
    long lVar4;
    undefined4 *puVar5;
    char *__nptr;
    int *piVar6;
    int iVar7;
    int *piVar8;
    int iVar9;
    bool bVar10;
    undefined4 local_34;
    undefined4 uStack_30;
    int local_2c;

    iVar7 = *(int *)(param_1 + 4);
    puVar5 = *(undefined4 **)(iVar7 + 0x54);
    __nptr = (char *)(puVar5 + 0xe);
    piVar8 = (int *)*puVar5;
    local_2c = __stack_chk_guard;
    iVar1 = FUN_00049ee4(param_1, __nptr, 0x80, &local_34);
    puVar5[0x2e] = iVar1;
    if (iVar1 != 0) {
        if ((*(byte *)(puVar5 + 0xc0) & 2) != 0) {
            puVar5[0x3a] = local_34;
            puVar5[0x3b] = uStack_30;
        }
        if (piVar8[0x33] < 1) {
            if (iVar1 == 1) {
                lVar4 = strtol(__nptr, (char **)0x0, 10);
                piVar8[0x33] = lVar4;
            } else {
                piVar6 = piVar8 + 1;
                FUN_00051f44(iVar7 + 0x10, piVar6);
                *(undefined1 *)(piVar8 + 1) = 0;
                iVar1 = puVar5[0x2e];
                *piVar8 = (int)piVar6;
                if ((iVar1 < 0x13) ||
                    (iVar1 =
                         sscanf(__nptr, "%2d:%3d:%2d:%2d:%2d.%3ld",
                                puVar5 + 0x2f, puVar5 + 0x30, puVar5 + 0x31,
                                puVar5 + 0x32, puVar5 + 0x33, puVar5 + 0x34),
                     iVar1 != 6)) {
                    FUN_000494a0(iVar7, 2);
                } else {
                    bVar10 = *(char *)((int)puVar5 + 0x3a) == ':';
                    if (bVar10) {
                        *(undefined1 *)(puVar5 + 10) = 0;
                    }
                    puVar5[0x34] = puVar5[0x34] * 1000000;
                    if (!bVar10) {
                        *(undefined1 *)(puVar5 + 10) = 3;
                    }
                    iVar1 = FUN_00049cf8(puVar5);
                    if (iVar1 == 0) {
                        FUN_000494a0(iVar7, 6);
                    } else if (*piVar8 + (puVar5[0x2e] - (int)piVar6) < 199) {
                        memcpy((void *)*piVar8, __nptr, puVar5[0x2e]);
                        iVar9 = *piVar8;
                        iVar7 = puVar5[0x2e];
                        iVar1 = iVar9 + iVar7;
                        *piVar8 = iVar1;
                        if (((*(byte *)(puVar5 + 0xc0) & 8) != 0) &&
                            (sVar3 =
                                 strlen(&DAT_000c79f0 + piVar8[0x34] * 0x1e),
                             (int)((iVar1 - (int)piVar6) + 1 + sVar3) < 199)) {
                            *piVar8 = iVar1 + 1;
                            *(undefined1 *)(iVar9 + iVar7) = 0x20;
                            memcpy((void *)*piVar8,
                                   &DAT_000c79f0 + piVar8[0x34] * 0x1e, sVar3);
                            iVar1 = *piVar8;
                            *piVar8 = iVar1 + (sVar3 - 1);
                            *(undefined1 *)(iVar1 + (sVar3 - 1)) = 0;
                            iVar1 = piVar8[0x34];
                            sVar3 = strlen(&DAT_000c79f0 + iVar1 * 0x1e);
                            write(puVar5[7], &DAT_000c79f0 + iVar1 * 0x1e,
                                  sVar3);
                            iVar1 = piVar8[0x34];
                            piVar8[0x34] = iVar1 + 1;
                            if ((&DAT_000c79f0)[(iVar1 + 1) * 0x1e] == '\0') {
                                piVar8[0x34] = 0;
                            }
                        }
                    }
                }
            }
        } else {
            puVar2 = (undefined1 *)*piVar8;
            piVar8[0x33] = piVar8[0x33] + -1;
            if ((int)(puVar2 + (iVar1 - (int)(piVar8 + 1))) < 199) {
                *piVar8 = (int)(puVar2 + 1);
                *puVar2 = 0x20;
                memcpy((void *)*piVar8, __nptr, puVar5[0x2e] + 1);
                *piVar8 = *piVar8 + puVar5[0x2e];
            }
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006d6b4(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    tm *ptVar3;
    undefined4 uVar4;
    int iVar5;
    int iVar6;
    char *pcVar7;
    char *__s;
    int iVar8;
    undefined4 *puVar9;
    bool bVar10;
    undefined4 local_70;
    undefined4 local_6c;
    undefined4 local_68;
    time_t local_64;
    undefined4 local_60;
    undefined4 uStack_5c;
    undefined4 local_58;
    undefined4 local_54;
    undefined4 local_50;
    undefined4 local_4c;
    int local_48;
    undefined4 local_44;
    undefined4 local_38;
    int local_2c;

    iVar8 = *(int *)(param_1 + 4);
    puVar9 = *(undefined4 **)(iVar8 + 0x54);
    __s = (char *)(puVar9 + 0xe);
    pcVar7 = (char *)*puVar9;
    local_2c = __stack_chk_guard;
    iVar1 = FUN_00049ee4(param_1, __s, 0x80, &local_60);
    if (iVar1 == 0) {
        bVar10 = *pcVar7 == '\0';
        if (bVar10) {
            *pcVar7 = bVar10;
            *(undefined4 *)(pcVar7 + 4) = local_60;
            *(undefined4 *)(pcVar7 + 8) = uStack_5c;
        } else {
            *pcVar7 = bVar10;
        }
    } else {
        uVar2 = *(undefined4 *)(pcVar7 + 4);
        uVar4 = *(undefined4 *)(pcVar7 + 8);
        puVar9[0x2e] = iVar1;
        puVar9[0x3a] = uVar2;
        puVar9[0x3b] = uVar4;
        *(undefined4 *)(pcVar7 + 4) = local_60;
        *(undefined4 *)(pcVar7 + 8) = uStack_5c;
        *pcVar7 = '\x01';
        iVar1 = sscanf(__s, "Y %d/%d/%d", pcVar7 + 0x10, pcVar7 + 0x18,
                       pcVar7 + 0x14);
        if (iVar1 == 0) {
            iVar1 = sscanf(__s, "Z %02d:%02d:%02d", &local_70, &local_6c,
                           &local_68);
            if (iVar1 == 3) {
                ptVar3 = (tm *)memset(&local_58, 0, 0x2c);
                local_44 = *(undefined4 *)(pcVar7 + 0x10);
                local_4c = *(undefined4 *)(pcVar7 + 0x14);
                local_48 = *(int *)(pcVar7 + 0x18) + -1;
                local_50 = local_70;
                local_54 = local_6c;
                local_58 = local_68;
                local_38 = 0xffffffff;
                local_64 = mktime(ptVar3);
                ptVar3 = gmtime(&local_64);
                if (ptVar3 == (tm *)0x0) {
                    FUN_000494a0(iVar8, 3);
                } else {
                    uVar2 = FUN_0007ec68(ptVar3->tm_year + 0x76c,
                                         ptVar3->tm_mon + 1, ptVar3->tm_mday);
                    iVar1 = ptVar3->tm_hour;
                    iVar5 = ptVar3->tm_min;
                    iVar6 = ptVar3->tm_sec;
                    puVar9[0x30] = uVar2;
                    puVar9[0x31] = iVar1;
                    puVar9[0x32] = iVar5;
                    puVar9[0x33] = iVar6;
                    iVar1 = FUN_00049cf8(puVar9);
                    if (iVar1 == 0) {
                        FUN_000494a0(iVar8, 6);
                    } else {
                        puVar9[0x38] = puVar9[0x3a];
                        puVar9[0x39] = puVar9[0x3b];
                        FUN_00049d44(iVar8);
                        FUN_00051f44(iVar8 + 0x10, __s);
                        pcVar7[0xc] = (char)puVar9[0x31];
                    }
                }
            }
        } else {
            iVar1 = *(int *)(pcVar7 + 0x10);
            if (iVar1 < 0x45) {
                iVar1 = iVar1 + 100;
            }
            *(int *)(pcVar7 + 0x10) = iVar1;
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006d924(int param_1)

{
    char cVar1;
    int iVar2;
    int iVar3;
    size_t sVar4;
    int *piVar5;
    int iVar6;
    int iVar7;
    undefined4 uVar8;
    uint uVar9;
    uint uVar10;
    undefined1 *puVar11;
    uint uVar13;
    int iVar14;
    int iVar15;
    uint *puVar16;
    char *pcVar17;
    undefined4 *puVar18;
    int iVar19;
    uint *puVar20;
    int iVar21;
    uint uVar22;
    bool bVar23;
    undefined8 uVar24;
    int local_9c;
    uint local_98;
    char local_88[12];
    char acStack_7c[80];
    int local_2c;
    undefined1 *puVar12;

    piVar5 = *(int **)(param_1 + 0x54);
    iVar15 = *piVar5;
    iVar19 = *(int *)(iVar15 + 0x458);
    local_2c = __stack_chk_guard;
    uVar10 = *(uint *)(iVar15 + 0x398);
    if (iVar19 < 9) {
        *(uint *)(iVar15 + 0x398) = uVar10 | 1;
    } else {
        puVar20 = (uint *)(iVar15 + 0x428);
        uVar13 = 0;
        iVar21 = 0;
        *(undefined4 *)(iVar15 + 0x460) = 0;
        puVar16 = puVar20;
        do {
            iVar6 = 8;
            iVar2 = 0;
            uVar9 = *puVar16 ^ puVar16[5];
            do {
                uVar22 = uVar9 & 1;
                uVar9 = (int)uVar9 >> 1;
                if (uVar22 == 0) {
                    iVar2 = iVar2 + 1;
                } else {
                    iVar2 = iVar2 + -1;
                }
                iVar6 = iVar6 + -1;
            } while (iVar6 != 0);
            uVar13 = uVar13 + 1;
            iVar21 = iVar21 + iVar2;
            *(int *)(iVar15 + 0x460) = iVar21;
        } while ((uVar13 != 5) &&
                 (puVar16 = puVar16 + 1, uVar13 != iVar19 - 5U));
        if (iVar21 < 0x1c) {
            if (iVar21 + 0x1b < 0 == SCARRY4(iVar21, 0x1b)) {
                *(uint *)(iVar15 + 0x398) = uVar10 | 2;
                goto LAB_0006d9f4;
            }
            iVar21 = -iVar21;
            puVar18 = (undefined4 *)(iVar15 + 0x424);
            uVar24 = *(undefined8 *)(iVar15 + 0x470);
            iVar6 = 0;
            uVar13 = 0x50;
            iVar2 = iVar19;
            FUN_0007c054(acStack_7c, 0x50, "chuB %04x %4.0f %2d %2d ", uVar10,
                         uVar24, iVar19, iVar21);
            pcVar17 = acStack_7c;
            do {
                sVar4 = strlen(pcVar17);
                if (uVar13 < sVar4 + 1) {
                    FUN_00074e00(3, "chu_b() fatal out buffer");
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                uVar13 = uVar13 - sVar4;
                pcVar17 = pcVar17 + sVar4;
                iVar6 = iVar6 + 1;
                puVar18 = puVar18 + 1;
                FUN_0007c054(pcVar17, uVar13, &DAT_000a6ecc, *puVar18, uVar24,
                             iVar2, iVar21);
            } while (iVar19 != iVar6);
            if ((*(byte *)(piVar5 + 0xc0) & 8) != 0) {
                FUN_00051f44(param_1 + 0x10, acStack_7c);
            }
            if (*(int *)(iVar15 + 0x460) + 0x27 < 0 ==
                SCARRY4(*(int *)(iVar15 + 0x460), 0x27)) {
                *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 4;
            } else {
                iVar19 = 0;
                do {
                    cVar1 = "0123456789abcdef_*="[(*puVar20 << 0x18) >> 0x1c];
                    local_88[iVar19] = "0123456789abcdef_*="[*puVar20 & 0xf];
                    iVar21 = iVar19 + 2;
                    local_88[iVar19 + 1] = cVar1;
                    iVar19 = iVar21;
                    puVar20 = puVar20 + 1;
                } while (iVar21 != 10);
                iVar19 = sscanf(local_88, "%1x%1d%4d%2d%2x", iVar15 + 0x47c,
                                iVar15 + 0x480, piVar5 + 0x2f, iVar15 + 0x484,
                                iVar15 + 0x488);
                if (iVar19 == 5) {
                    *(uint *)(iVar15 + 0x398) =
                        *(uint *)(iVar15 + 0x398) | 0x200;
                    if ((*(uint *)(iVar15 + 0x47c) & 8) != 0) {
                        *(int *)(iVar15 + 0x480) = -*(int *)(iVar15 + 0x480);
                    }
                } else {
                    *(uint *)(iVar15 + 0x398) = *(uint *)(iVar15 + 0x398) | 8;
                }
            }
        } else {
            iVar2 = 0;
            iVar6 = -1;
            *(undefined4 *)(iVar15 + 0x464) = 0;
            uVar9 = *(uint *)(iVar15 + 0x434) & 0xf;
            local_9c = 0;
            puVar16 = puVar20;
            while (true) {
                uVar9 = uVar9 ^ 99;
                iVar3 = 8;
                iVar7 = 0;
                do {
                    uVar22 = uVar9 & 1;
                    uVar9 = (int)uVar9 >> 1;
                    if (uVar22 == 0) {
                        iVar7 = iVar7 + 1;
                    } else {
                        iVar7 = iVar7 + -1;
                    }
                    iVar3 = iVar3 + -1;
                } while (iVar3 != 0);
                iVar3 = 0;
                if (iVar6 + 9 < iVar19) {
                    uVar13 = puVar16[8] & 0xf;
                }
                uVar9 = (puVar16[4] & 0xf) << 4;
                if (iVar6 + 9 < iVar19) {
                    uVar9 = uVar9 | uVar13;
                }
                iVar14 = 8;
                uVar9 = uVar9 ^ 99;
                do {
                    uVar13 = uVar9 & 1;
                    uVar9 = (int)uVar9 >> 1;
                    if (uVar13 == 0) {
                        iVar3 = iVar3 + 1;
                    } else {
                        iVar3 = iVar3 + -1;
                    }
                    iVar14 = iVar14 + -1;
                } while (iVar14 != 0);
                iVar7 = iVar7 + iVar3;
                if (iVar2 < iVar7) {
                    local_9c = iVar6;
                }
                iVar6 = iVar6 + 1;
                if (iVar2 < iVar7) {
                    *(int *)(iVar15 + 0x464) = iVar7;
                    iVar2 = iVar7;
                }
                if (iVar6 == 2)
                    break;
                uVar9 = (*puVar16 & 0xf) << 4 | puVar16[4] & 0xf;
                uVar13 = 0;
                puVar16 = puVar16 + 1;
            }
            iVar6 = iVar15 + local_9c * 4;
            uVar13 = (uint)(*(int *)(iVar6 + 0x438) << 0x18) >> 0x1c;
            if ((uVar13 - 2 < 8) && (local_9c + 9 < iVar19)) {
                local_98 = (uint)(*(int *)(iVar6 + 0x44c) << 0x18) >> 0x1c;
                if (uVar13 != local_98) {
                    local_98 = 0;
                }
            } else {
                local_98 = 0;
            }
            puVar18 = (undefined4 *)(iVar15 + 0x424);
            iVar7 = 0;
            uVar24 = *(undefined8 *)(iVar15 + 0x470);
            uVar9 = 0x50;
            iVar6 = iVar19;
            iVar3 = local_9c;
            uVar13 = local_98;
            FUN_0007c054(acStack_7c, 0x50,
                         "chuA %04x %4.0f %2d %2d %2d %2d %1d ", uVar10, uVar24,
                         iVar19, iVar21, local_9c, iVar2, local_98);
            pcVar17 = acStack_7c;
            do {
                sVar4 = strlen(pcVar17);
                if (uVar9 < sVar4 + 1) {
                    FUN_00074e00(3, "chu_a() fatal out buffer");
                    /* WARNING: Subroutine does not return */
                    exit(1);
                }
                uVar9 = uVar9 - sVar4;
                pcVar17 = pcVar17 + sVar4;
                iVar7 = iVar7 + 1;
                puVar18 = puVar18 + 1;
                FUN_0007c054(pcVar17, uVar9, &DAT_000a6ecc, *puVar18, uVar24,
                             iVar6, iVar21, iVar3, iVar2, uVar13);
            } while (iVar19 != iVar7);
            if ((*(byte *)(piVar5 + 0xc0) & 8) != 0) {
                FUN_00051f44(param_1 + 0x10, acStack_7c);
            }
            uVar10 = *(uint *)(iVar15 + 0x398);
            if (*(int *)(iVar15 + 0x464) < 8) {
                *(uint *)(iVar15 + 0x398) = uVar10 | 0x10;
            } else {
                if (local_98 == 0) {
                    *(uint *)(iVar15 + 0x398) = uVar10 | 0x20;
                } else {
                    *(uint *)(iVar15 + 0x398) = uVar10 | 0x100;
                    iVar19 = local_98 + 0x1e;
                    piVar5[0x33] = iVar19;
                    *(int *)(iVar15 + 0x390) = iVar19;
                    if (local_9c == -1) {
                        iVar19 = *(int *)(iVar15 + 0x388);
                        iVar21 = 0;
                        uVar10 = *(uint *)(iVar15 + 0x38c);
                    } else {
                        uVar10 = 0;
                        iVar21 = local_9c;
                        if (local_9c != 0) {
                            iVar21 = 1;
                        }
                    }
                    iVar2 = iVar15 + iVar21 * 8;
                    do {
                        if (local_9c < iVar21 + -9)
                            break;
                        iVar14 = *(int *)(iVar15 + 0x454);
                        iVar6 = *(int *)(iVar2 + 0x140);
                        uVar8 = *(undefined4 *)(iVar2 + 0x144);
                        iVar21 = iVar21 + 1;
                        iVar2 = iVar2 + 8;
                        iVar3 = iVar15 + iVar14 * 8;
                        *(int *)(iVar3 + 0x198) = iVar6;
                        *(undefined4 *)(iVar3 + 0x19c) = uVar8;
                        iVar6 = iVar6 - iVar19;
                        if (*(uint *)(iVar3 + 0x19c) < uVar10) {
                            iVar6 = iVar6 + -1;
                        }
                        *(uint *)(iVar3 + 0x19c) =
                            *(uint *)(iVar3 + 0x19c) - uVar10;
                        *(int *)(iVar3 + 0x198) = iVar6;
                        bVar23 = CARRY4(*(uint *)(iVar15 + 0x38c), uVar10);
                        uVar10 = *(uint *)(iVar15 + 0x38c) + uVar10;
                        if (iVar14 < 0x3b) {
                            *(int *)(iVar15 + 0x454) = iVar14 + 1;
                        }
                        iVar19 =
                            iVar19 + (uint)bVar23 + *(int *)(iVar15 + 0x388);
                    } while (iVar21 < iVar7);
                    iVar19 = *(int *)(iVar15 + 0x45c);
                    if (iVar19 < (int)local_98) {
                        iVar21 = 0;
                        puVar12 = (undefined1 *)(iVar15 + 0x9f);
                        do {
                            do {
                                puVar11 = puVar12 + -1;
                                *puVar12 = *puVar11;
                                puVar12[0xa0] = puVar12[0x9f];
                                puVar12 = puVar11;
                            } while (puVar11 != (undefined1 *)(iVar15 + 0x90));
                            iVar21 = iVar21 + 1;
                            *(undefined1 *)(iVar15 + 0x130) = 0;
                            *(undefined1 *)(iVar15 + 0x90) = 0;
                            puVar12 = (undefined1 *)(iVar15 + 0x9f);
                        } while (local_98 - iVar19 != iVar21);
                        *(uint *)(iVar15 + 0x45c) = local_98;
                    }
                }
                uVar10 = local_9c * -2;
                uVar13 = uVar10 + iVar7 * 2;
                do {
                    if (uVar10 < 0x13) {
                        iVar19 = iVar15 + uVar10 * 0x10;
                        iVar21 = iVar15 + (uVar10 + 1) * 0x10;
                        uVar22 = *puVar20 & 0xf;
                        uVar9 = (*puVar20 << 0x18) >> 0x1c;
                        *(char *)(iVar19 + uVar22) =
                            *(char *)(iVar19 + uVar22) + '\x01';
                        *(char *)(iVar21 + uVar9) =
                            *(char *)(iVar21 + uVar9) + '\x01';
                    }
                    uVar10 = uVar10 + 2;
                    puVar20 = puVar20 + 1;
                } while (uVar10 != uVar13);
                *(int *)(iVar15 + 0x468) = *(int *)(iVar15 + 0x468) + 1;
            }
        }
        if (*(int *)(param_1 + 0x2cc) != current_time) {
            *(int *)(param_1 + 0x2d0) = current_time + 10;
        }
    }
LAB_0006d9f4:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006dfb4(int param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    int iVar5;
    int iVar6;
    int *piVar7;
    undefined4 uVar8;
    int iVar9;
    double *pdVar10;
    double in_d0;
    double dVar11;
    double dVar12;

    iVar1 = __stack_chk_guard;
    piVar7 = *(int **)(param_1 + 0x54);
    iVar6 = *piVar7;
    iVar2 = *(int *)(iVar6 + 0x3a4);
    if (iVar2 < 1) {
        uVar8 = 0;
    } else {
        dVar12 = 0.0;
        iVar3 = 0;
        iVar5 = *(int *)(iVar6 + 0x3a8) * 5;
        iVar9 = iVar6 + *(int *)(iVar6 + 0x3a8) * 0x28;
        pdVar10 =
            (double *)(iVar6 + (iVar5 + *(int *)(iVar9 + 0x3d0) + 0x76) * 8);
        *(double *)(iVar9 + 0x3c8) = *(double *)(iVar9 + 0x3c8) - *pdVar10;
        *pdVar10 = in_d0;
        dVar11 =
            *(double *)(iVar6 + (iVar5 + *(int *)(iVar9 + 0x3d0)) * 8 + 0x3b0);
        *(undefined4 *)(iVar9 + 0x3d4) = 0;
        *(double *)(iVar9 + 0x3c8) = dVar11 + *(double *)(iVar9 + 0x3c8);
        *(int *)(iVar9 + 0x3d0) = (*(int *)(iVar9 + 0x3d0) + 1) % 3;
        iVar5 = iVar6;
        do {
            dVar11 = *(double *)(iVar5 + 0x3c8);
            uVar4 = *(int *)(iVar5 + 0x3d4) + 1;
            *(uint *)(iVar5 + 0x3d4) = uVar4;
            if (dVar12 < dVar11) {
                uVar4 = *(uint *)(iVar6 + 0x398);
                *(int *)(iVar6 + 0x3a8) = iVar3;
            }
            iVar3 = iVar3 + 1;
            if (dVar12 < dVar11) {
                *(uint *)(iVar6 + 0x398) = uVar4 | 0x800;
                dVar12 = dVar11;
            }
            iVar5 = iVar5 + 0x28;
        } while (iVar3 != 3);
        iVar5 = (*(int *)(iVar6 + 0x3ac) + 1) % 5;
        *(int *)(iVar6 + 0x3ac) = iVar5;
        if (iVar5 == 0 || dVar12 == 0.0) {
            iVar5 = *(int *)(iVar6 + 0x3d4);
            uVar4 = *(uint *)(param_1 + 0x4c);
            if (iVar5 < 1) {
                iVar5 = 0;
            } else {
                *(undefined4 *)(iVar6 + 0x3a8) = 0;
            }
            if (iVar5 < *(int *)(iVar6 + 0x3fc)) {
                *(undefined4 *)(iVar6 + 0x3a8) = 1;
                iVar5 = *(int *)(iVar6 + 0x3fc);
            }
            if (iVar5 < *(int *)(iVar6 + 0x424)) {
                *(undefined4 *)(iVar6 + 0x3a8) = 2;
            }
            uVar8 = FUN_00073dc0(
                SUB84(*(double *)(&DAT_000aa588 + *(int *)(iVar6 + 0x3a8) * 8) +
                          0.001,
                      0),
                iVar2, uVar4 & 0x7f);
            FUN_0007c054(iVar6 + 0x39c, 5, "CHU%d",
                         *(undefined4 *)(iVar6 + 0x3a8));
            piVar7[0xbf] = *(int *)(iVar6 + 0x39c);
            *(undefined4 *)(param_1 + 0x70) = *(undefined4 *)(iVar6 + 0x39c);
            if ((dVar12 == 0.0) && ((*(uint *)(iVar6 + 0x398) & 0x800) != 0)) {
                *(uint *)(iVar6 + 0x398) =
                    *(uint *)(iVar6 + 0x398) & 0xfffff7ff;
                FUN_000494a0(param_1, 4);
            }
        } else {
            uVar8 = FUN_00073dc0(
                SUB84(*(double *)(&DAT_000aa588 + *(int *)(iVar6 + 0x3a8) * 8) +
                          0.001,
                      0),
                iVar2, *(uint *)(param_1 + 0x4c) & 0x7f);
            FUN_0007c054(iVar6 + 0x39c, 5, "CHU%d",
                         *(undefined4 *)(iVar6 + 0x3a8));
            piVar7[0xbf] = *(int *)(iVar6 + 0x39c);
            *(undefined4 *)(param_1 + 0x70) = *(undefined4 *)(iVar6 + 0x39c);
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar8);
}

void FUN_0006e2f0(int param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    undefined4 *puVar4;
    int iVar5;
    uint *unaff_r10;
    int iVar6;
    int iVar7;
    bool bVar8;
    double dVar9;

    iVar1 = __stack_chk_guard;
    iVar5 = **(int **)(param_1 + 0x54);
    uVar3 = *(uint *)(iVar5 + 900);
    uVar2 = *(uint *)(iVar5 + 0x380) | uVar3;
    bVar8 = uVar2 == 0;
    if (bVar8) {
        unaff_r10 = (uint *)(iVar5 + 0x378);
        uVar2 = *unaff_r10;
        uVar3 = *(uint *)(iVar5 + 0x37c);
    }
    if (bVar8) {
        *(uint *)(iVar5 + 0x380) = uVar2;
        *(uint *)(iVar5 + 900) = uVar3;
        uVar3 = *(uint *)(iVar5 + 900);
    } else {
        unaff_r10 = (uint *)(iVar5 + 0x378);
        uVar2 = *(uint *)(iVar5 + 0x380);
    }
    iVar6 = *(int *)(iVar5 + 0x378) - uVar2;
    if (*(uint *)(iVar5 + 0x37c) < uVar3) {
        iVar6 = iVar6 + -1;
    }
    iVar7 = *(uint *)(iVar5 + 0x37c) - uVar3;
    uVar3 = unaff_r10[1];
    *(uint *)(iVar5 + 0x380) = *unaff_r10;
    *(uint *)(iVar5 + 900) = uVar3;
    if (iVar6 < 0) {
        dVar9 = (double)FUN_0009bec4(-iVar7, -(iVar6 + (uint)(iVar7 != 0)));
        dVar9 = ldexp(dVar9, -0x20);
        dVar9 = -dVar9;
        if (0.4033333333333333 < dVar9)
            goto LAB_0006e450;
    LAB_0006e3c0:
        if (0.09166666666666667 < dVar9)
            goto LAB_0006e3d0;
        iVar6 = *(int *)(iVar5 + 0x458);
        if (10 < iVar6)
            goto LAB_0006e3f8;
        iVar7 = iVar6 + 1;
    } else {
        dVar9 = (double)FUN_0009bec4(iVar7, iVar6);
        dVar9 = ldexp(dVar9, -0x20);
        if (dVar9 <= 0.4033333333333333)
            goto LAB_0006e3c0;
    LAB_0006e450:
        FUN_0006d924(param_1);
    LAB_0006e3d0:
        iVar7 = 1;
        iVar6 = 0;
    }
    puVar4 = (undefined4 *)(iVar5 + (iVar6 + 0x28) * 8);
    *(undefined4 *)(iVar5 + (iVar6 + 0x10a) * 4) = param_2;
    *puVar4 = param_3;
    puVar4[1] = param_4;
    *(int *)(iVar5 + 0x458) = iVar7;
LAB_0006e3f8:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006e78c(undefined4 param_1, int param_2)

{
    uint uVar1;
    size_t sVar2;
    int iVar3;
    int *piVar4;
    int iVar5;
    uint uVar6;
    int iVar7;
    uint uVar8;
    undefined4 uVar9;
    undefined1 *puVar10;
    int iVar11;
    uint uVar12;
    uint extraout_r3;
    undefined4 uVar13;
    undefined1 *puVar14;
    byte *pbVar15;
    int iVar16;
    uint uVar17;
    int *piVar18;
    int iVar19;
    char *pcVar20;
    byte *pbVar21;
    byte *pbVar22;
    byte bVar23;
    double dVar24;
    undefined4 local_50;
    undefined4 local_4c;
    char acStack_48[12];
    int local_3c;

    piVar18 = *(int **)(param_2 + 0x54);
    iVar16 = *piVar18;
    iVar3 = *(int *)(iVar16 + 0x390) + 1;
    local_3c = __stack_chk_guard;
    *(int *)(iVar16 + 0x390) = iVar3 % 0x3c;
    if (iVar3 % 0x3c != 0)
        goto LAB_0006e7f4;
    FUN_0006d924(param_2, iVar3, iVar3 * -0x77777777);
    piVar4 = *(int **)(param_2 + 0x54);
    iVar11 = *(int *)(param_2 + 0x2c0);
    iVar19 = *piVar4;
    iVar5 = *(int *)(iVar19 + 0x468);
    iVar7 = current_time + 0x1e;
    pbVar22 = (byte *)(iVar19 + -1);
    iVar3 = 0;
    pcVar20 = acStack_48;
    do {
        uVar1 = 0;
        uVar6 = 0;
        uVar8 = 0;
        pbVar15 = pbVar22 + 0xa1;
        pbVar21 = pbVar22;
        do {
            pbVar21 = pbVar21 + 1;
            uVar12 = (uint)*pbVar21 + (uint)*pbVar15;
            uVar17 = (uint)*pbVar15;
            if (uVar6 < uVar12) {
                uVar17 = uVar8;
            }
            uVar8 = uVar8 + 1;
            if (uVar12 <= uVar6) {
                uVar12 = uVar6;
                uVar17 = uVar1;
            }
            uVar1 = uVar17;
            uVar6 = uVar12;
            pbVar15 = pbVar15 + 1;
        } while (uVar8 != 0x10);
        pbVar22 = pbVar22 + 0x10;
        uVar8 = 0x10;
        if ((int)uVar6 <= iVar5) {
            uVar8 = *(uint *)(iVar19 + 0x398);
        }
        iVar3 = iVar3 + uVar6;
        if ((int)uVar6 <= iVar5) {
            *(uint *)(iVar19 + 0x398) = uVar8 | 0x40;
        }
        *pcVar20 = "0123456789abcdef_*="[uVar1];
        pcVar20 = pcVar20 + 1;
    } while (pbVar22 != (byte *)(iVar19 + 0x8f));
    iVar5 = sscanf(acStack_48, "%1x%3d%2d%2d", &local_50, piVar4 + 0x30,
                   piVar4 + 0x31, piVar4 + 0x32);
    uVar1 = extraout_r3;
    if (iVar5 != 4) {
        uVar1 = *(uint *)(iVar19 + 0x398);
    }
    dVar24 = (double)(longlong)iVar3;
    if (iVar5 != 4) {
        *(uint *)(iVar19 + 0x398) = uVar1 | 0x40;
    }
    if (*(int *)(iVar19 + 0x454) < 0x14) {
        *(uint *)(iVar19 + 0x398) = *(uint *)(iVar19 + 0x398) | 0x80;
    }
    uVar1 = *(uint *)(iVar16 + 0x398);
    bVar23 = (uVar1 & 0x14) != 0;
    if ((uVar1 & 0x28) != 0) {
        bVar23 = bVar23 | 2;
    }
    if ((uVar1 & 0x40) != 0) {
        bVar23 = bVar23 | 4;
    }
    if ((uVar1 & 0x80) != 0) {
        bVar23 = bVar23 | 8;
    }
    if (((uVar1 & 0x200) == 0) || (dVar24 < 50.0)) {
        if ((uVar1 & 0x400) != 0)
            goto LAB_0006e9a0;
        uVar9 = 0x20;
        *(undefined1 *)(piVar18 + 10) = 3;
        uVar13 = 0x3f;
    } else {
        *(uint *)(iVar16 + 0x398) = uVar1 | 0x400;
    LAB_0006e9a0:
        if ((*(uint *)(iVar16 + 0x47c) & 2) == 0) {
            uVar1 = *(uint *)(iVar16 + 0x47c) & 4;
            if (uVar1 == 0) {
                uVar9 = 0x20;
                *(char *)(piVar18 + 10) = (char)uVar1;
            } else {
                *(undefined1 *)(piVar18 + 10) = 2;
                uVar9 = 0x6c;
            }
            uVar13 = 0x20;
        } else {
            uVar9 = 0x4c;
            *(undefined1 *)(piVar18 + 10) = 1;
            uVar13 = 0x20;
        }
    }
    piVar4 = piVar18 + 0xe;
    FUN_0007c054(piVar4, 0x80,
                 "%c%1X %04d %03d %02d:%02d:%02d %c%x %+d %d %d %s %.0f %d",
                 uVar13, bVar23, piVar18[0x2f], piVar18[0x30], piVar18[0x31],
                 piVar18[0x32], piVar18[0x33], uVar9,
                 *(undefined4 *)(iVar16 + 0x488),
                 *(undefined4 *)(iVar16 + 0x480), (uint)(iVar7 - iVar11) / 0x3c,
                 *(undefined4 *)(iVar16 + 0x478), iVar16 + 0x39c, dVar24,
                 *(undefined4 *)(iVar16 + 0x454));
    sVar2 = strlen((char *)piVar4);
    uVar1 = *(uint *)(iVar16 + 0x398);
    piVar18[0x2e] = sVar2;
    if (((uVar1 & 0x4c0) == 0x400) && (50.0 < dVar24)) {
        iVar3 = FUN_000733d8(piVar18[0x30], piVar18[0x31], piVar18[0x32], 0, 0,
                             *(undefined4 *)(iVar16 + 0x198), piVar18 + 0x35,
                             &local_50);
        if (iVar3 == 0) {
            *(undefined4 *)(iVar16 + 0x394) = 6;
        } else {
            local_4c = 0;
            if (0 < *(int *)(iVar16 + 0x454)) {
                iVar3 = 0;
                do {
                    iVar5 = iVar3 + 0x33;
                    iVar3 = iVar3 + 1;
                    FUN_00049a70(SUB84(*(double *)(piVar18 + 0xba) + 0.1768, 0),
                                 piVar18, local_50, local_4c,
                                 *(undefined4 *)(iVar16 + iVar5 * 8),
                                 *(undefined4 *)(iVar16 + iVar5 * 8 + 4));
                } while (iVar3 < *(int *)(iVar16 + 0x454));
            }
            iVar3 = *(int *)(iVar16 + 0x37c);
            piVar18[0x38] = *(int *)(iVar16 + 0x378);
            piVar18[0x39] = iVar3;
            FUN_00049d44(param_2);
        }
    }
    if (0.0 < dVar24) {
        FUN_00051f44(param_2 + 0x10, piVar4);
    }
    FUN_0006dfb4(SUB84(dVar24, 0), param_2);
    iVar3 = **(int **)(param_2 + 0x54);
    *(undefined4 *)(iVar3 + 0x45c) = 0;
    *(undefined4 *)(iVar3 + 0x458) = 0;
    puVar14 = (undefined1 *)(iVar3 + -1);
    *(undefined4 *)(iVar3 + 0x454) = 0;
    *(uint *)(iVar3 + 0x398) = *(uint *)(iVar3 + 0x398) & 0xc00;
    *(undefined4 *)(iVar3 + 0x468) = 0;
    do {
        puVar10 = puVar14 + 0x10;
        do {
            puVar14 = puVar14 + 1;
            *puVar14 = 0;
        } while (puVar14 != puVar10);
    } while (puVar14 != (undefined1 *)(iVar3 + 0x13f));
    if (*(int *)(iVar16 + 0x394) != 0) {
        FUN_000494a0(param_2);
    }
    *(undefined4 *)(iVar16 + 0x394) = 0;
LAB_0006e7f4:
    if (local_3c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006ec18(int param_1)

{
    double *pdVar1;
    byte bVar2;
    int iVar3;
    int *piVar4;
    int iVar5;
    undefined4 uVar6;
    int iVar7;
    double *pdVar8;
    uint uVar9;
    int iVar10;
    undefined4 uVar11;
    int iVar12;
    byte *pbVar13;
    int iVar15;
    byte *pbVar16;
    int iVar17;
    uint uVar18;
    double dVar19;
    double dVar20;
    double dVar21;
    double dVar22;
    double dVar23;
    double dVar24;
    double dVar25;
    double dVar26;
    double dVar27;
    double dVar28;
    double dVar29;
    double dVar30;
    double dVar31;
    double dVar32;
    double dVar33;
    double dVar34;
    double dVar35;
    double dVar36;
    double dVar37;
    double dVar38;
    double dVar39;
    double dVar40;
    double dVar41;
    double dVar42;
    double dVar43;
    double dVar44;
    double dVar45;
    double dVar46;
    double dVar47;
    undefined8 uVar48;
    byte *pbVar14;

    iVar3 = __stack_chk_guard;
    iVar15 = *(int *)(param_1 + 4);
    piVar4 = *(int **)(iVar15 + 0x54);
    iVar12 = *piVar4;
    if (*(int *)(iVar12 + 0x48c) < 1) {
        FUN_0006e2f0(iVar15, *(undefined1 *)(param_1 + 0x58),
                     *(undefined4 *)(param_1 + 0x48),
                     *(undefined4 *)(param_1 + 0x4c));
        return;
    }
    dVar19 = (double)(longlong) * (int *)(param_1 + 0x54) / 8000.0;
    if (dVar19 < 0.0) {
        dVar19 = ldexp(-dVar19, 0x20);
        uVar48 =
            FUN_0009c010(SUB84(dVar19, 0), (int)((ulonglong)dVar19 >> 0x20));
        uVar48 = CONCAT44(
            -((int)((ulonglong)uVar48 >> 0x20) + (uint)((int)uVar48 != 0)),
            -(int)uVar48);
    } else {
        dVar19 = ldexp(dVar19, 0x20);
        uVar48 =
            FUN_0009c010(SUB84(dVar19, 0), (int)((ulonglong)dVar19 >> 0x20));
    }
    iVar5 = *(int *)(param_1 + 0x54);
    iVar7 = *(int *)(param_1 + 0x48) - (int)((ulonglong)uVar48 >> 0x20);
    if (*(uint *)(param_1 + 0x4c) < (uint)uVar48) {
        iVar7 = iVar7 + -1;
    }
    *(uint *)(param_1 + 0x4c) = *(uint *)(param_1 + 0x4c) - (uint)uVar48;
    *(int *)(param_1 + 0x48) = iVar7;
    pbVar16 = (byte *)(param_1 + 0x58);
    uVar6 = *(undefined4 *)(param_1 + 0x4c);
    *(int *)(iVar12 + 0x378) = *(int *)(param_1 + 0x48);
    *(undefined4 *)(iVar12 + 0x37c) = uVar6;
    pbVar14 = pbVar16;
    if (0 < iVar5) {
    LAB_0006ef40:
        do {
            pbVar13 = pbVar14 + 1;
            dVar38 = 6000.0;
            dVar19 =
                *(double *)(iVar12 + ((~(uint)*pbVar14 & 0xff) + 0x92) * 8);
            if ((6000.0 < dVar19) || (dVar38 = -6000.0, dVar19 < -6000.0)) {
                *(int *)(iVar12 + 0xc98) = *(int *)(iVar12 + 0xc98) + 1;
                dVar19 = dVar38;
            }
            iVar5 = **(int **)(iVar15 + 0x54);
            dVar44 = *(double *)(iVar5 + 0xce0);
            *(double *)(iVar5 + 0xce8) = dVar44;
            dVar42 = *(double *)(iVar5 + 0xcd8);
            *(double *)(iVar5 + 0xce0) = dVar42;
            dVar23 = *(double *)(iVar5 + 0xcd0);
            *(double *)(iVar5 + 0xcd8) = dVar23;
            dVar22 = *(double *)(iVar5 + 0xcc8);
            *(double *)(iVar5 + 0xcd0) = dVar22;
            dVar21 = *(double *)(iVar5 + 0xcc0);
            *(double *)(iVar5 + 0xcc8) = dVar21;
            dVar20 = *(double *)(iVar5 + 0xcb8);
            *(double *)(iVar5 + 0xcc0) = dVar20;
            dVar38 = *(double *)(iVar5 + 0xcb0);
            *(double *)(iVar5 + 0xcb8) = dVar38;
            dVar40 = *(double *)(iVar5 + 0xca8);
            *(double *)(iVar5 + 0xcb0) = dVar40;
            dVar19 = dVar19 - (dVar42 * 0.488486 + dVar44 * 0.5844676 +
                               dVar23 * 2.704384 + dVar22 * 1.645032 +
                               dVar21 * 4.644557 + dVar20 * 1.879165 +
                               dVar38 * 3.522634 + dVar40 * 0.7315738);
            *(double *)(iVar5 + 0xca8) = dVar19;
            dVar19 = dVar40 * 0.003156599 + dVar19 * 0.006176213 +
                     dVar38 * 0.007567487 + dVar20 * 0.00434458 +
                     dVar21 * 0.01190128 + dVar22 * 0.00434458 +
                     dVar23 * 0.007567487 + dVar42 * 0.003156599 +
                     dVar44 * 0.006176213;
            *(double *)(iVar5 + 0xe18) = dVar19 * 0.25;
            if (dVar19 <= 1000.0) {
                dVar20 = -1000.0;
                dVar38 = 1000.0;
                if (-1000.0 <= dVar19) {
                    dVar38 = -dVar19;
                    dVar20 = dVar19;
                }
            } else {
                dVar38 = -1000.0;
                dVar20 = 1000.0;
            }
            iVar7 = *(int *)(iVar5 + 0xe20);
            pdVar8 = (double *)(iVar5 + iVar7 * 8 + 0xcf0);
            dVar19 = *pdVar8;
            *pdVar8 = dVar20;
            dVar38 = dVar38 * dVar19;
            *(int *)(iVar5 + 0xe20) = (iVar7 + 1) % 10;
            if (dVar38 < 0.0) {
                if (-0.0 < dVar38) {
                    sqrt(-dVar38);
                }
                dVar19 = -SQRT(-dVar38);
            } else {
                dVar19 = SQRT(dVar38);
                if (dVar38 < 0.0) {
                    sqrt(dVar38);
                }
            }
            dVar21 = *(double *)(iVar5 + 0xe08);
            *(double *)(iVar5 + 0xe10) = dVar21;
            dVar37 = *(double *)(iVar5 + 0xe00);
            *(double *)(iVar5 + 0xe08) = dVar37;
            dVar22 = *(double *)(iVar5 + 0xdf8);
            *(double *)(iVar5 + 0xe00) = dVar22;
            dVar20 = *(double *)(iVar5 + 0xdf0);
            *(double *)(iVar5 + 0xdf8) = dVar20;
            dVar38 = *(double *)(iVar5 + 0xde8);
            *(double *)(iVar5 + 0xdf0) = dVar38;
            dVar39 = *(double *)(iVar5 + 0xde0);
            *(double *)(iVar5 + 0xde8) = dVar39;
            dVar23 = *(double *)(iVar5 + 0xdd8);
            *(double *)(iVar5 + 0xde0) = dVar23;
            dVar43 = *(double *)(iVar5 + 0xdd0);
            *(double *)(iVar5 + 0xdd8) = dVar43;
            dVar40 = *(double *)(iVar5 + 0xdc8);
            *(double *)(iVar5 + 0xdd0) = dVar40;
            dVar42 = *(double *)(iVar5 + 0xdc0);
            *(double *)(iVar5 + 0xdc8) = dVar42;
            dVar44 = *(double *)(iVar5 + 0xdb8);
            *(double *)(iVar5 + 0xdc0) = dVar44;
            dVar24 = *(double *)(iVar5 + 0xdb0);
            *(double *)(iVar5 + 0xdb8) = dVar24;
            dVar25 = *(double *)(iVar5 + 0xda8);
            *(double *)(iVar5 + 0xdb0) = dVar25;
            dVar26 = *(double *)(iVar5 + 0xda0);
            *(double *)(iVar5 + 0xda8) = dVar26;
            dVar27 = *(double *)(iVar5 + 0xd98);
            *(double *)(iVar5 + 0xda0) = dVar27;
            dVar28 = *(double *)(iVar5 + 0xd90);
            *(double *)(iVar5 + 0xd98) = dVar28;
            dVar29 = *(double *)(iVar5 + 0xd88);
            *(double *)(iVar5 + 0xd90) = dVar29;
            dVar30 = *(double *)(iVar5 + 0xd80);
            *(double *)(iVar5 + 0xd88) = dVar30;
            dVar31 = *(double *)(iVar5 + 0xd78);
            *(double *)(iVar5 + 0xd80) = dVar31;
            dVar32 = *(double *)(iVar5 + 0xd70);
            *(double *)(iVar5 + 0xd78) = dVar32;
            dVar33 = *(double *)(iVar5 + 0xd68);
            *(double *)(iVar5 + 0xd70) = dVar33;
            dVar34 = *(double *)(iVar5 + 0xd60);
            *(double *)(iVar5 + 0xd68) = dVar34;
            dVar47 = *(double *)(iVar5 + 0xd58);
            *(double *)(iVar5 + 0xd60) = dVar47;
            dVar46 = *(double *)(iVar5 + 0xd50);
            *(double *)(iVar5 + 0xd58) = dVar46;
            dVar45 = *(double *)(iVar5 + 0xd48);
            dVar35 = *(double *)(iVar5 + 0xe28) + 0.000125;
            *(double *)(iVar5 + 0xd50) = dVar45;
            dVar41 = *(double *)(iVar5 + 0xd40);
            *(double *)(iVar5 + 0xd48) = dVar41;
            *(double *)(iVar5 + 0xd40) = dVar19 * 0.02538771;
            if (dVar35 <= 0.0004166666666666667) {
                *(double *)(iVar5 + 0xe28) = dVar35;
                goto LAB_0006eed4;
            }
            uVar6 = *(undefined4 *)(iVar5 + 0x37c);
            *(double *)(iVar5 + 0xe28) = dVar35 - 0.0004166666666666667;
            uVar18 = *(int *)(iVar5 + 0x1230) + 1;
            uVar9 = uVar18 & 7;
            if ((int)uVar18 < 1) {
                uVar9 = -(-uVar18 & 7);
            }
            iVar7 = uVar9 * 0x80;
            *(uint *)(iVar5 + 0x1230) = uVar9;
            iVar17 = iVar5 + iVar7;
            *(undefined4 *)(iVar17 + 0xe30) = *(undefined4 *)(iVar5 + 0x378);
            *(undefined4 *)(iVar17 + 0xe34) = uVar6;
            dVar36 = 1000000.0;
            dVar35 = -1000000.0;
            *(double *)(iVar17 + 0xe38) = -(
                (dVar37 * 0.1084671 + dVar21 * 0.02538771 + dVar22 * 0.2003159 +
                 dVar20 * 0.2985303 + dVar38 * 0.4003697 + dVar39 * 0.5028552 +
                 dVar23 * 0.6028795 + dVar43 * 0.6973249 + dVar40 * 0.7831828 +
                 dVar42 * 0.8576717 + dVar44 * 0.9183463 + dVar24 * 0.9631951 +
                 dVar25 * 0.9907208 + dVar26 + dVar27 * 0.9907208 +
                 dVar28 * 0.9631951 + dVar29 * 0.9183463 + dVar30 * 0.8576717 +
                 dVar31 * 0.7831828 + dVar32 * 0.6973249 + dVar33 * 0.6028795 +
                 dVar34 * 0.5028552 + dVar47 * 0.4003697 + dVar46 * 0.2985303 +
                 dVar45 * 0.2003159 + dVar41 * 0.1084671 +
                 dVar19 * 0.02538771) *
                6.0);
            pdVar8 = (double *)(iVar5 + iVar7 + 0xe90);
            do {
                pdVar1 = pdVar8 + -1;
                dVar19 = *pdVar1;
                *pdVar8 = dVar19;
                if (dVar35 < dVar19) {
                    dVar35 = dVar19;
                }
                if (dVar19 < dVar36) {
                    dVar36 = dVar19;
                }
                pdVar8 = pdVar1;
            } while ((double *)(iVar5 + 0xe38 + iVar7) != pdVar1);
            dVar38 = dVar35 - dVar36;
            iVar17 = iVar5 + iVar7;
            uVar18 = 0;
            dVar19 = 0.0;
            pdVar8 = (double *)(iVar5 + iVar7 + 0xe40);
            iVar10 = 0;
            dVar20 = dVar36 + dVar38 * 0.45;
            *(double *)(iVar17 + 0xe98) = dVar38;
        LAB_0006f3a8:
            *(int *)(iVar17 + 0xea8) = iVar10 << 1;
            dVar21 = *pdVar8;
            pdVar8 = pdVar8 + 1;
            if (dVar20 < dVar21) {
                *(uint *)(iVar17 + 0xea8) = iVar10 << 1 | 1;
            }
            if (uVar18 < 2) {
            LAB_0006f3e0:
                dVar21 = dVar21 - dVar36;
            joined_r0x0006f3f0:
                dVar19 = dVar19 + dVar21;
                if (uVar18 == 10)
                    goto LAB_0006f3f4;
                uVar18 = uVar18 + 1;
                iVar10 = *(int *)(iVar17 + 0xea8);
                goto LAB_0006f3a8;
            }
            if (uVar18 != 10) {
                if (dVar20 < dVar21)
                    goto LAB_0006f3e0;
                dVar21 = dVar35 - dVar21;
                goto joined_r0x0006f3f0;
            }
            dVar19 = dVar19 + (dVar35 - dVar21);
        LAB_0006f3f4:
            *(double *)(iVar5 + iVar7 + 0xea0) = dVar19 / (dVar38 * 11.0);
            if (*(int *)(iVar5 + 0x1238) < 1) {
                if (uVar9 == *(uint *)(iVar5 + 0x1234))
                    goto LAB_0006f42c;
            } else {
                iVar7 = *(int *)(iVar5 + 0x1238) + -1;
                *(int *)(iVar5 + 0x1238) = iVar7;
                if (iVar7 == 0) {
                    *(uint *)(iVar5 + 0x1234) = uVar9;
                LAB_0006f42c:
                    dVar19 = 0.0;
                    pdVar8 = (double *)(iVar5 + 0xe98);
                    iVar7 = -1;
                    iVar17 = 0;
                    do {
                        if (((((ulonglong)pdVar8[2] & 0x601) == 0x600) &&
                             (800.0 <= *pdVar8)) &&
                            (dVar19 < pdVar8[1])) {
                            iVar7 = iVar17;
                            dVar19 = pdVar8[1];
                        }
                        iVar17 = iVar17 + 1;
                        pdVar8 = pdVar8 + 0x10;
                    } while (iVar17 != 8);
                    if (iVar7 != -1) {
                        iVar17 = iVar5 + iVar7 * 0x80;
                        iVar7 = *(int *)(iVar17 + 0xea8);
                        uVar6 = *(undefined4 *)(iVar17 + 0xe30);
                        uVar11 = *(undefined4 *)(iVar17 + 0xe34);
                        *(undefined8 *)(iVar5 + 0x470) =
                            *(undefined8 *)(iVar17 + 0xe98);
                        FUN_0006e2f0(iVar15, (uint)(iVar7 << 0x17) >> 0x18,
                                     uVar6, uVar11);
                        *(undefined4 *)(iVar5 + 0x1238) = 0x58;
                    }
                }
            }
        LAB_0006eed4:
            uVar9 = *(uint *)(iVar12 + 0x37c);
            *(uint *)(iVar12 + 0x37c) = uVar9 + *(uint *)(iVar12 + 0xca4);
            *(uint *)(iVar12 + 0x378) =
                *(int *)(iVar12 + 0x378) + *(int *)(iVar12 + 0xca0) +
                (uint)CARRY4(uVar9, *(uint *)(iVar12 + 0xca4));
            iVar5 = (*(int *)(iVar12 + 0xc9c) + 1) % 8000;
            *(int *)(iVar12 + 0xc9c) = iVar5;
            pbVar14 = pbVar13;
            if (iVar5 == 0) {
                iVar7 = **(int **)(iVar15 + 0x54);
                iVar5 = *(int *)(iVar7 + 0x478);
                if (*(int *)(iVar7 + 0xc98) == 0) {
                    iVar5 = iVar5 + 4;
                    if (0xff < iVar5) {
                        iVar5 = 0xff;
                    }
                LAB_0006f510:
                    *(int *)(iVar7 + 0x478) = iVar5;
                } else if (100 < *(int *)(iVar7 + 0xc98)) {
                    iVar5 = iVar5 + -4;
                    if (-1 < iVar5)
                        goto LAB_0006f510;
                    *(undefined4 *)(iVar7 + 0x478) = 0;
                    iVar5 = 0;
                }
                FUN_000712e0(iVar5, *(undefined4 *)(iVar7 + 0xc94),
                             *(undefined4 *)(iVar7 + 0xc90));
                iVar5 = *(int *)(param_1 + 0x54);
                *(undefined4 *)(iVar7 + 0xc98) = 0;
                if (iVar5 <= (int)pbVar13 - (int)pbVar16)
                    break;
                goto LAB_0006ef40;
            }
        } while ((int)pbVar13 - (int)pbVar16 < *(int *)(param_1 + 0x54));
    }
    bVar2 = *(byte *)(piVar4 + 0xc0);
    if ((bVar2 & 2) == 0) {
        uVar6 = 1;
    } else {
        uVar6 = 2;
    }
    uVar9 = bVar2 & 4;
    *(undefined4 *)(iVar12 + 0xc90) = uVar6;
    if ((bVar2 & 4) != 0) {
        uVar9 = 0x7f;
    }
    *(uint *)(iVar12 + 0xc94) = uVar9;
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0006f600(void)

{
    int iVar1;
    double in_d0;
    double dVar2;

    iVar1 = __stack_chk_guard;
    sys_fuzz = in_d0;
    if (in_d0 < 0.0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("systime.c", 0x75, 2, "sys_fuzz >= 0");
    }
    if (in_d0 <= 1.0) {
        dVar2 = ceil(in_d0 * 1000000000.0);
        sys_fuzz_nsec = (undefined4)(longlong)dVar2;
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("systime.c", 0x76, 2, "sys_fuzz <= 1.0");
}

/* WARNING: Removing unreachable block (ram,0x0006f718) */

void FUN_0006f6e0(void)

{
    return;
}

void FUN_0006f724(int *param_1)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    int iVar4;
    int iVar5;
    int iVar6;
    uint uVar7;
    int iVar8;
    code *pcVar9;
    bool bVar10;
    bool bVar11;
    undefined4 uVar12;
    double dVar13;
    undefined4 extraout_s1;
    double dVar14;
    undefined8 uVar15;
    timeval tStack_5c;
    timeval tStack_54;
    int iStack_4c;
    timespec local_34;
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar2 = clock_gettime(0, &local_34);
    if (iVar2 < 0) {
        pcVar9 = FUN_0006fca8;
        uVar12 = FUN_0001c5c4();
        iStack_4c = __stack_chk_guard;
        if ((double)CONCAT44(extraout_s1, uVar12) == 0.0) {
            if (((enable_panic_check != 0) && (allow_panic != 0)) &&
                (FUN_00074e00(3, "adj_systime: allow_panic is TRUE!"),
                 allow_panic != 0)) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("systime.c", 0x136, 2, "!allow_panic");
            }
        } else {
            dVar13 = (double)CONCAT44(extraout_s1, uVar12) + sys_residual;
            bVar10 = dVar13 < 0.0;
            if (bVar10) {
                dVar13 = -dVar13;
                pcVar9 = (code *)0x1;
            }
            tStack_5c.tv_sec = (__time_t)(longlong)dVar13;
            if (!bVar10) {
                pcVar9 = (code *)0x0;
            }
            dVar13 = dVar13 - (double)(longlong)tStack_5c.tv_sec;
            dVar14 = sys_tick;
            if (sys_tick <= sys_fuzz) {
                dVar14 = 1e-06;
            }
            tStack_5c.tv_usec =
                (__suseconds_t)(longlong)((double)(longlong)(int)(longlong)(dVar13 /
                                                                                dVar14 +
                                                                            0.5) *
                                              dVar14 * 1000000.0 +
                                          0.5);
            if (999999 < tStack_5c.tv_usec) {
                dVar13 = dVar13 - 1.0;
                tStack_5c.tv_usec = tStack_5c.tv_usec + -1000000;
                tStack_5c.tv_sec = tStack_5c.tv_sec + 1;
            }
            sys_residual = dVar13 - (double)(longlong)tStack_5c.tv_usec * 1e-06;
            if (pcVar9 != (code *)0x0) {
                sys_residual = -sys_residual;
                tStack_5c.tv_sec = -tStack_5c.tv_sec;
                tStack_5c.tv_usec = -tStack_5c.tv_usec;
            }
            if (((tStack_5c.tv_sec != 0) || (tStack_5c.tv_usec != 0)) &&
                (iVar2 = adjtime(&tStack_5c, &tStack_54), iVar2 < 0)) {
                FUN_00074e00(3, "adj_systime: %m");
                iVar2 = enable_panic_check;
                if ((enable_panic_check != 0) &&
                    (iVar2 = allow_panic, allow_panic != 0)) {
                    FUN_00074e00(3, "adj_systime: allow_panic is TRUE!");
                    iVar2 = 0;
                }
                goto LAB_0006fd00;
            }
            if ((enable_panic_check != 0) && (allow_panic != 0)) {
                FUN_00074e00(3, "adj_systime: allow_panic is TRUE!");
            }
        }
        iVar2 = 1;
    LAB_0006fd00:
        if (iStack_4c == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    if (trunc_os_clock != 0) {
        local_34.tv_nsec =
            (long)(longlong)((double)(longlong)(int)(longlong)(((double)(longlong)
                                                                    local_34
                                                                        .tv_nsec *
                                                                1e-09) /
                                                               sys_tick) *
                             1000000000.0 * sys_tick);
    }
    iVar5 = local_34.tv_nsec + 50000000;
    iVar6 = local_34.tv_sec;
    if (iVar5 < 0) {
        do {
            iVar5 = iVar5 + 1000000000;
            iVar4 = iVar6 + -1;
            iVar6 = iVar6 + -1;
        } while (iVar5 < 0);
    } else {
        iVar4 = local_34.tv_sec;
        if (999999999 < iVar5) {
            iVar5 = local_34.tv_nsec + -950000000;
            bVar11 = SBORROW4(iVar5, 999999999);
            bVar10 = iVar5 != 999999999;
            if (iVar5 < 1000000000) {
                iVar2 = local_34.tv_sec + 1;
            } else {
                iVar5 = -1950000000;
            }
            iVar4 = iVar2;
            if (bVar10 && local_34.tv_nsec + -1949999999 < 0 == bVar11) {
                iVar5 = local_34.tv_nsec + iVar5;
                iVar4 = local_34.tv_sec + 2;
            }
        }
    }
    if (DAT_00116f20 < iVar4) {
        iVar2 = 1 - (uint)(iVar4 < DAT_00116f20);
    } else {
        iVar2 = -(uint)(iVar4 < DAT_00116f20);
    }
    if (iVar2 == 0) {
        if (DAT_00116f24 < iVar5) {
            iVar2 = 1 - (uint)(iVar5 < DAT_00116f24);
        } else {
            iVar2 = -(uint)(iVar5 < DAT_00116f24);
        }
    }
    if (iVar2 == -1) {
        DAT_00116f28 = 1;
        sys_lamport = sys_lamport + 1;
    }
    DAT_00116f20 = local_34.tv_sec;
    DAT_00116f24 = local_34.tv_nsec;
    iVar6 = sys_fuzz_nsec + DAT_00116f30;
    iVar2 = DAT_00116f2c;
    if (iVar6 < 0) {
        do {
            iVar5 = iVar6 + 1000000000;
            iVar2 = iVar2 + -1;
            iVar6 = iVar5;
        } while (iVar5 < 0);
    } else {
        iVar5 = iVar6;
        if (999999999 < iVar6) {
            iVar5 = iVar6 + -1000000000;
            iVar4 = iVar6 + -1999999999;
            if (iVar5 < 1000000000) {
                iVar2 = DAT_00116f2c + 1;
            } else {
                iVar6 = iVar6 + -0x77360000;
            }
            if (iVar5 != 999999999 && iVar4 < 0 == SBORROW4(iVar5, 999999999)) {
                iVar2 = iVar2 + 2;
                iVar5 = iVar6 + 0x6c00;
            }
        }
    }
    if (iVar2 < local_34.tv_sec) {
        iVar6 = 1 - (uint)(local_34.tv_sec < iVar2);
    } else {
        iVar6 = -(uint)(local_34.tv_sec < iVar2);
    }
    if (iVar6 == 0) {
        if (iVar5 < local_34.tv_nsec) {
            iVar6 = 1 - (uint)(local_34.tv_nsec < iVar5);
        } else {
            iVar6 = -(uint)(local_34.tv_nsec < iVar5);
        }
        if (iVar6 == -1)
            goto LAB_0006facc;
    LAB_0006f8ec:
        DAT_00116f2c = local_34.tv_sec;
        DAT_00116f30 = local_34.tv_nsec;
        iVar5 = local_34.tv_nsec;
        iVar2 = local_34.tv_sec;
        if (local_34.tv_nsec < 0)
            goto LAB_0006fc40;
        if (999999999 < local_34.tv_nsec) {
            iVar5 = local_34.tv_nsec + -1000000000;
            iVar6 = local_34.tv_nsec + -1999999999;
            if (iVar5 < 1000000000) {
                iVar2 = local_34.tv_sec + 1;
            } else {
                local_34.tv_nsec = local_34.tv_nsec + -0x77360000;
            }
            if (iVar5 != 999999999 && iVar6 < 0 == SBORROW4(iVar5, 999999999)) {
                iVar2 = iVar2 + 2;
                iVar5 = local_34.tv_nsec + 0x6c00;
            }
        }
    } else {
        if (iVar6 != -1)
            goto LAB_0006f8ec;
    LAB_0006facc:
        iVar4 = iVar5 - local_34.tv_nsec;
        iVar6 = iVar2 - local_34.tv_sec;
        if (iVar4 < 0) {
            do {
                iVar8 = iVar4 + 1000000000;
                iVar6 = iVar6 + -1;
                iVar4 = iVar8;
            } while (iVar8 < 0);
        } else {
            iVar8 = iVar4;
            if (999999999 < iVar4) {
                iVar8 = iVar4 + -1000000000;
                iVar1 = iVar4 + -1999999999;
                if (iVar8 < 1000000000) {
                    iVar6 = iVar6 + 1;
                } else {
                    iVar4 = iVar4 + -0x77360000;
                }
                if (iVar8 != 999999999 &&
                    iVar1 < 0 == SBORROW4(iVar8, 999999999)) {
                    iVar6 = iVar6 + 2;
                    iVar8 = iVar4 + 0x6c00;
                }
            }
        }
        if (0 < iVar6) {
            if (DAT_00116f28 == 0) {
                dVar13 =
                    (double)(longlong)iVar6 + (double)(longlong)iVar8 * 1e-09;
                FUN_00074e00(
                    3, "get_systime Lamport advance exceeds one second (%.9f)",
                    SUB84(dVar13, 0), (int)((ulonglong)dVar13 >> 0x20));
                /* WARNING: Subroutine does not return */
                exit(1);
            }
            goto LAB_0006f8ec;
        }
        DAT_00116f30 = iVar5;
        DAT_00116f2c = iVar2;
        if (DAT_00116f28 != 0)
            goto LAB_0006f8ec;
        for (; local_34.tv_nsec = DAT_00116f30, local_34.tv_sec = DAT_00116f2c,
               iVar5 < 0;
             iVar5 = iVar5 + 1000000000) {
        LAB_0006fc40:
            iVar2 = iVar2 + -1;
            DAT_00116f30 = local_34.tv_nsec;
            DAT_00116f2c = local_34.tv_sec;
        }
    }
    local_34.tv_sec = DAT_00116f2c;
    local_34.tv_nsec = DAT_00116f30;
    uVar3 = FUN_0009bfd0(500000000, iVar5, 1000000000, 0);
    iVar6 = FUN_00078ae4();
    dVar13 = ((double)(longlong)iVar6 + (double)(longlong)iVar6) *
             2.3283064365386963e-10 * sys_fuzz;
    if (dVar13 < 0.0) {
        dVar13 = ldexp(-dVar13, 0x20);
        uVar15 =
            FUN_0009c010(SUB84(dVar13, 0), (int)((ulonglong)dVar13 >> 0x20));
        uVar15 = CONCAT44(
            -((int)((ulonglong)uVar15 >> 0x20) + (uint)((int)uVar15 != 0)),
            -(int)uVar15);
    } else {
        dVar13 = ldexp(dVar13, 0x20);
        uVar15 =
            FUN_0009c010(SUB84(dVar13, 0), (int)((ulonglong)dVar13 >> 0x20));
    }
    iVar6 = __stack_chk_guard;
    uVar7 = (uint)uVar15 + uVar3;
    iVar2 = iVar2 + -0x7c558180 + (int)((ulonglong)uVar15 >> 0x20) +
            (uint)CARRY4((uint)uVar15, uVar3);
    if (DAT_00116f34 == 0 && DAT_00116f38 == 0) {
        if (DAT_00116f28 == 0)
            goto LAB_0006fa18;
    } else if (DAT_00116f28 == 0) {
        if (0.0 < sys_fuzz) {
            iVar5 = iVar2;
            if (uVar7 < DAT_00116f38) {
                iVar5 = iVar2 + -1;
            }
            iVar5 = iVar5 - DAT_00116f34;
            if (uVar7 == DAT_00116f38) {
                iVar5 = iVar5 + -1;
            }
            if (iVar5 < 0) {
                sys_tsrounding = sys_tsrounding + 1;
                iVar2 = (uint)(DAT_00116f38 == 0xffffffff) + DAT_00116f34;
                uVar7 = DAT_00116f38 + 1;
            }
        }
        goto LAB_0006fa18;
    }
    DAT_00116f28 = 0;
LAB_0006fa18:
    DAT_00116f38 = uVar7;
    DAT_00116f34 = iVar2;
    iVar2 = DAT_00116f34;
    param_1[1] = DAT_00116f38;
    *param_1 = iVar2;
    if (local_2c == iVar6) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0006fca8(void)

{
    bool bVar1;
    int iVar2;
    int unaff_lr;
    double in_d0;
    double dVar3;
    double dVar4;
    timeval local_24;
    timeval tStack_1c;
    int local_14;

    local_14 = __stack_chk_guard;
    if (in_d0 == 0.0) {
        if (((enable_panic_check != 0) && (allow_panic != 0)) &&
            (FUN_00074e00(3, "adj_systime: allow_panic is TRUE!"),
             allow_panic != 0)) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("systime.c", 0x136, 2, "!allow_panic");
        }
    } else {
        dVar3 = in_d0 + sys_residual;
        bVar1 = dVar3 < 0.0;
        if (bVar1) {
            dVar3 = -dVar3;
            unaff_lr = 1;
        }
        local_24.tv_sec = (__time_t)(longlong)dVar3;
        if (!bVar1) {
            unaff_lr = 0;
        }
        dVar3 = dVar3 - (double)(longlong)local_24.tv_sec;
        dVar4 = sys_tick;
        if (sys_tick <= sys_fuzz) {
            dVar4 = 1e-06;
        }
        local_24.tv_usec =
            (__suseconds_t)(longlong)((double)(longlong)(int)(longlong)(dVar3 /
                                                                            dVar4 +
                                                                        0.5) *
                                          dVar4 * 1000000.0 +
                                      0.5);
        if (999999 < local_24.tv_usec) {
            dVar3 = dVar3 - 1.0;
            local_24.tv_usec = local_24.tv_usec + -1000000;
            local_24.tv_sec = local_24.tv_sec + 1;
        }
        sys_residual = dVar3 - (double)(longlong)local_24.tv_usec * 1e-06;
        if (unaff_lr != 0) {
            sys_residual = -sys_residual;
            local_24.tv_sec = -local_24.tv_sec;
            local_24.tv_usec = -local_24.tv_usec;
        }
        if (((local_24.tv_sec != 0) || (local_24.tv_usec != 0)) &&
            (iVar2 = adjtime(&local_24, &tStack_1c), iVar2 < 0)) {
            FUN_00074e00(3, "adj_systime: %m");
            iVar2 = enable_panic_check;
            if ((enable_panic_check != 0) &&
                (iVar2 = allow_panic, allow_panic != 0)) {
                FUN_00074e00(3, "adj_systime: allow_panic is TRUE!");
                iVar2 = 0;
            }
            goto LAB_0006fd00;
        }
        if ((enable_panic_check != 0) && (allow_panic != 0)) {
            FUN_00074e00(3, "adj_systime: allow_panic is TRUE!");
        }
    }
    iVar2 = 1;
LAB_0006fd00:
    if (local_14 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00070304) */

int FUN_0006ff34(void)

{
    longlong lVar1;
    int iVar2;
    uint uVar3;
    undefined4 uVar4;
    undefined4 *puVar5;
    long lVar6;
    undefined4 extraout_r2;
    uint uVar7;
    int iVar8;
    undefined4 unaff_r9;
    int iVar9;
    undefined4 extraout_r12;
    bool bVar10;
    undefined4 in_cr1;
    undefined4 in_cr2;
    undefined4 in_cr11;
    double in_d0;
    double dVar11;
    undefined8 uVar12;
    undefined8 uVar13;
    int local_50[2];
    undefined4 local_48;
    int local_44;
    undefined *local_40;
    timespec local_3c;
    int local_34;

    local_48 = 0x7fffffff;
    local_34 = __stack_chk_guard;
    if (sys_residual < 0.0) {
        dVar11 = ldexp(-sys_residual, 0x20);
        uVar12 =
            FUN_0009c010(SUB84(dVar11, 0), (int)((ulonglong)dVar11 >> 0x20));
        uVar12 = CONCAT44(
            -((int)((ulonglong)uVar12 >> 0x20) + (uint)((int)uVar12 != 0)),
            -(int)uVar12);
    } else {
        dVar11 = ldexp(sys_residual, 0x20);
        uVar12 =
            FUN_0009c010(SUB84(dVar11, 0), (int)((ulonglong)dVar11 >> 0x20));
    }
    puVar5 = (undefined4 *)((ulonglong)uVar12 >> 0x20);
    if (in_d0 < 0.0) {
        dVar11 = ldexp(-in_d0, 0x20);
        uVar13 =
            FUN_0009c010(SUB84(dVar11, 0), (int)((ulonglong)dVar11 >> 0x20));
        uVar13 = CONCAT44(
            -((int)((ulonglong)uVar13 >> 0x20) + (uint)((int)uVar13 != 0)),
            -(int)uVar13);
    } else {
        dVar11 = ldexp(in_d0, 0x20);
        uVar13 =
            FUN_0009c010(SUB84(dVar11, 0), (int)((ulonglong)dVar11 >> 0x20));
    }
    uVar7 = (uint)uVar12 + (uint)uVar13;
    iVar8 = (int)puVar5 + (int)((ulonglong)uVar13 >> 0x20) + -0x7c558180;
    iVar2 = clock_gettime(0, &local_3c);
    bVar10 = true;
    if (iVar2 < 0) {
        uVar4 = FUN_0001c5c4();
        *puVar5 = 0x70280;
        puVar5[-1] = 0x70278;
        puVar5[-2] = extraout_r12;
        puVar5[-3] = &__stack_chk_guard;
        puVar5[-4] = unaff_r9;
        puVar5[-5] = iVar8;
        puVar5[-6] = uVar7;
        puVar5[-7] = extraout_r2;
        puVar5[-8] = uVar4;
        if (!bVar10) {
            coprocessor_function(0xe, 1, 0, in_cr2, in_cr1, in_cr11);
            func_0xfe722a90(uVar4);
        }
        return 0;
    }
    if (trunc_os_clock != 0) {
        local_3c.tv_nsec =
            (long)(longlong)((double)(longlong)(int)(longlong)(((double)(longlong)
                                                                    local_3c
                                                                        .tv_nsec *
                                                                1e-09) /
                                                               sys_tick) *
                             1000000000.0 * sys_tick);
    }
    iVar2 = local_3c.tv_nsec;
    if (local_3c.tv_nsec < 0) {
        do {
            iVar2 = iVar2 + 1000000000;
            iVar9 = local_3c.tv_sec + -1;
            local_3c.tv_sec = iVar9;
        } while (iVar2 < 0);
    } else {
        iVar9 = local_3c.tv_sec;
        if (999999999 < local_3c.tv_nsec) {
            iVar2 = local_3c.tv_nsec + -1000000000;
            if (iVar2 < 1000000000) {
                lVar6 = local_3c.tv_nsec;
                iVar9 = local_3c.tv_sec + 1;
            } else {
                lVar6 = local_3c.tv_nsec + -0x77360000;
            }
            if (iVar2 != 999999999 && local_3c.tv_nsec + -1999999999 < 0 ==
                                          SBORROW4(iVar2, 999999999)) {
                iVar9 = iVar9 + 2;
                iVar2 = lVar6 + 0x6c00;
            }
        }
    }
    uVar3 = FUN_0009bfd0(500000000, iVar2, 1000000000, 0);
    FUN_00075844(local_50,
                 (uint)CARRY4((uint)uVar12, (uint)uVar13) + iVar8 + iVar9 +
                     (uint)CARRY4(uVar7, uVar3),
                 &local_48);
    lVar1 = (ulonglong)(uVar7 + uVar3) * 1000000 + 0x80000000;
    local_40 = (undefined *)((ulonglong)lVar1 >> 0x20);
    if (local_40 == &DAT_000f4240) {
        local_50[0] = local_50[0] + 1;
        local_40 = (undefined *)0x0;
    }
    local_44 = local_50[0];
    iVar2 = FUN_000742e4(&local_44, 0, (int)lVar1);
    if (iVar2 == 0) {
        DAT_00116f28 = (uint)(in_d0 < 0.0);
        sys_residual._0_4_ = 0;
        sys_residual._4_4_ = 0;
        if (step_callback != (code *)0x0) {
            (*step_callback)();
        }
        if (((enable_panic_check != 0) && (allow_panic != 0)) &&
            (FUN_00074e00(3, "step_systime: allow_panic is TRUE!"),
             allow_panic != 0)) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("systime.c", 0x24d, 2, "!allow_panic");
        }
        iVar2 = 1;
    } else {
        FUN_00074e00(3, "step-systime: %m");
        iVar2 = enable_panic_check;
        if ((enable_panic_check != 0) &&
            (iVar2 = allow_panic, allow_panic != 0)) {
            FUN_00074e00(3, "step_systime: allow_panic is TRUE!");
            iVar2 = 0;
        }
    }
    if (local_34 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return iVar2;
}

/* WARNING: Removing unreachable block (ram,0x00070304) */

undefined4 FUN_000702c8(void)

{
    return 0;
}

void FUN_00070310(undefined4 *param_1, int param_2, undefined4 *param_3,
                  undefined4 *param_4)

{
    CMAC_CTX *ctx;
    EVP_CIPHER *cipher;
    int iVar1;
    size_t sVar2;
    EVP_MD_CTX *ctx_00;
    char *pcVar3;
    EVP_MD *pEVar4;
    EVP_CIPHER_CTX *ctx_01;
    uint uVar5;
    undefined1 *key;
    size_t local_3c;
    uint local_38;
    undefined1 auStack_34[16];
    int local_24;

    local_3c = 0;
    local_24 = __stack_chk_guard;
    if (ssl_init_done == 0) {
        FUN_0007c6b8();
    }
    if (param_2 == 0x37e) {
        uVar5 = param_3[1];
        key = (undefined1 *)*param_3;
        if (uVar5 < 0x10) {
            __memcpy_chk(auStack_34, key, uVar5, 0x10);
            memset(auStack_34 + uVar5, 0, 0x10 - uVar5);
            ctx = CMAC_CTX_new();
            key = auStack_34;
        } else {
            ctx = CMAC_CTX_new();
        }
        if (ctx == (CMAC_CTX *)0x0) {
            FUN_00074e00(3, "MAC encrypt: CMAC %s CTX new failed.",
                         "AES128CMAC");
            sVar2 = local_3c;
        } else {
            cipher = EVP_aes_128_cbc();
            iVar1 = CMAC_Init(ctx, key, 0x10, cipher, (ENGINE *)0x0);
            if (iVar1 == 0) {
                FUN_00074e00(3, "MAC encrypt: CMAC %s Init failed.",
                             "AES128CMAC");
            } else {
                ctx_01 = CMAC_CTX_get0_cipher_ctx(ctx);
                if ((ctx_01 == (EVP_CIPHER_CTX *)0x0) ||
                    (uVar5 = EVP_CIPHER_CTX_block_size(ctx_01),
                     uVar5 <= (uint)param_1[1])) {
                    iVar1 = CMAC_Update(ctx, (void *)*param_4, param_4[1]);
                    if (iVar1 == 0) {
                        FUN_00074e00(3, "MAC encrypt: CMAC %s Update failed.",
                                     "AES128CMAC");
                    } else {
                        iVar1 = CMAC_Final(ctx, (uchar *)*param_1, &local_3c);
                        if (iVar1 == 0) {
                            FUN_00074e00(3,
                                         "MAC encrypt: CMAC %s Final failed.",
                                         "AES128CMAC");
                            local_3c = 0;
                        }
                    }
                } else {
                    FUN_00074e00(3, "MAC encrypt: CMAC %s buf too small.",
                                 "AES128CMAC");
                }
            }
            CMAC_CTX_cleanup(ctx);
            sVar2 = local_3c;
        }
    } else {
        ctx_00 = (EVP_MD_CTX *)EVP_MD_CTX_new();
        local_38 = 0;
        if (ctx_00 == (EVP_MD_CTX *)0x0) {
            pcVar3 = OBJ_nid2sn(param_2);
            FUN_00074e00(3, "MAC encrypt: MAC %s Digest CTX new failed.",
                         pcVar3);
            sVar2 = local_38;
        } else {
            EVP_MD_CTX_set_flags(ctx_00, 8);
            pcVar3 = OBJ_nid2sn(param_2);
            pEVar4 = EVP_get_digestbyname(pcVar3);
            iVar1 = EVP_DigestInit_ex(ctx_00, pEVar4, (ENGINE *)0x0);
            if (iVar1 == 0) {
                pcVar3 = OBJ_nid2sn(param_2);
                FUN_00074e00(3, "MAC encrypt: MAC %s Digest Init failed.",
                             pcVar3);
            } else {
                pEVar4 = EVP_MD_CTX_md(ctx_00);
                uVar5 = EVP_MD_size(pEVar4);
                if ((uint)param_1[1] < uVar5) {
                    pcVar3 = OBJ_nid2sn(param_2);
                    FUN_00074e00(3, "MAC encrypt: MAC %s buf too small.",
                                 pcVar3);
                } else {
                    iVar1 =
                        EVP_DigestUpdate(ctx_00, (void *)*param_3, param_3[1]);
                    if (iVar1 == 0) {
                        pcVar3 = OBJ_nid2sn(param_2);
                        FUN_00074e00(
                            3, "MAC encrypt: MAC %s Digest Update key failed.",
                            pcVar3);
                    } else {
                        iVar1 = EVP_DigestUpdate(ctx_00, (void *)*param_4,
                                                 param_4[1]);
                        if (iVar1 == 0) {
                            pcVar3 = OBJ_nid2sn(param_2);
                            FUN_00074e00(3,
                                         "MAC encrypt: MAC %s Digest Update "
                                         "data failed.",
                                         pcVar3);
                        } else {
                            iVar1 = EVP_DigestFinal(ctx_00, (uchar *)*param_1,
                                                    &local_38);
                            if (iVar1 == 0) {
                                pcVar3 = OBJ_nid2sn(param_2);
                                FUN_00074e00(
                                    3,
                                    "MAC encrypt: MAC %s Digest Final failed.",
                                    pcVar3);
                                local_38 = 0;
                            }
                        }
                    }
                }
            }
            local_3c = local_38;
            EVP_MD_CTX_free(ctx_00);
            sVar2 = local_3c;
        }
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(sVar2);
    }
    return;
}

int FUN_000706cc(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                 int param_4, int param_5)

{
    uint __n;
    undefined1 *puStack_74;
    undefined4 uStack_70;
    undefined4 local_6c;
    undefined4 local_68;
    int local_64;
    int local_60;
    undefined1 auStack_5c[64];
    int local_1c;

    local_1c = __stack_chk_guard;
    uStack_70 = 0x40;
    local_60 = param_5;
    puStack_74 = auStack_5c;
    local_6c = param_2;
    local_68 = param_3;
    local_64 = param_4;
    __n = FUN_00070310(&puStack_74, param_1, &local_6c, &local_64);
    if (0x13 < __n) {
        __n = 0x14;
    }
    memcpy((void *)(param_4 + param_5 + 4), auStack_5c, __n);
    if (local_1c == __stack_chk_guard) {
        return __n + 4;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00070770(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  int param_4, int param_5, int param_6)

{
    bool bVar1;
    uint uVar2;
    int iVar3;
    undefined1 *puStack_74;
    undefined4 uStack_70;
    undefined4 local_6c;
    undefined4 local_68;
    int local_64;
    int local_60;
    undefined1 auStack_5c[64];
    int local_1c;

    local_1c = __stack_chk_guard;
    uStack_70 = 0x40;
    local_60 = param_5;
    puStack_74 = auStack_5c;
    local_6c = param_2;
    local_68 = param_3;
    local_64 = param_4;
    uVar2 = FUN_00070310(&puStack_74, param_1, &local_6c, &local_64);
    if (0x13 < uVar2) {
        uVar2 = 0x14;
    }
    if (uVar2 + 4 == param_6) {
        iVar3 = FUN_00088564(auStack_5c, param_4 + param_5 + 4);
        bVar1 = iVar3 == 0;
    } else {
        FUN_00074e00(3, "MAC decrypt: MAC length error");
        bVar1 = false;
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(bVar1);
}

void FUN_0007083c(short *param_1)

{
    short *psVar1;
    EVP_MD_CTX *ctx;
    EVP_MD *type;
    int iVar2;
    uint uStack_58;
    short *local_54[16];
    int local_14;

    psVar1 = param_1;
    if (*param_1 == 2) {
        psVar1 = *(short **)(param_1 + 2);
    }
    local_14 = __stack_chk_guard;
    if (*param_1 != 2) {
        if (ssl_init_done == 0) {
            FUN_0007c6b8(psVar1);
        }
        ctx = (EVP_MD_CTX *)EVP_MD_CTX_new();
        EVP_MD_CTX_set_flags(ctx, 8);
        type = EVP_md5();
        iVar2 = EVP_DigestInit_ex(ctx, type, (ENGINE *)0x0);
        if (iVar2 == 0) {
            FUN_00074e00(3, "MD5 init failed");
            EVP_MD_CTX_free(ctx);
            /* WARNING: Subroutine does not return */
            exit(1);
        }
        EVP_DigestUpdate(ctx, param_1 + 4, 0x10);
        EVP_DigestFinal(ctx, (uchar *)local_54, &uStack_58);
        EVP_MD_CTX_free(ctx);
        psVar1 = local_54[0];
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(psVar1);
}

void FUN_00070930(byte *param_1, int *param_2)

{
    int iVar1;
    ushort **ppuVar2;
    int iVar3;
    uint uVar4;
    uint uVar5;
    undefined1 uVar6;
    uint uVar7;
    int iVar8;
    bool bVar9;

    iVar1 = __stack_chk_guard;
    uVar5 = (uint)*param_1;
    bVar9 = uVar5 == 0x2d;
    if (bVar9) {
        uVar5 = (uint)param_1[1];
        uVar7 = 0x38;
        param_1 = param_1 + 1;
    } else {
        uVar7 = 0x37;
    }
    if (uVar5 == 0) {
    LAB_000709ec:
        uVar6 = 0;
    } else {
        ppuVar2 = __ctype_b_loc();
        iVar3 = 0;
        do {
            uVar4 = (((*ppuVar2)[uVar5] ^ 0x800) << 0x14) >> 0x1f;
            if (0xccccccc < iVar3) {
                uVar4 = 1;
            }
            if (uVar4 != 0)
                goto LAB_000709ec;
            if ((iVar3 == 0xccccccc) && (uVar7 < uVar5)) {
                uVar6 = 0;
                goto LAB_000709f0;
            }
            iVar8 = uVar5 - 0x30;
            param_1 = param_1 + 1;
            uVar5 = (uint)*param_1;
            iVar3 = iVar8 + iVar3 * 10;
        } while (uVar5 != 0);
        if (bVar9) {
            *param_2 = -iVar3;
        } else {
            *param_2 = iVar3;
        }
        uVar6 = 1;
    }
LAB_000709f0:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar6);
}

void FUN_00070a30(char *param_1, int param_2)

{
    int iVar1;
    int iVar2;
    uint uVar3;

    iVar1 = __stack_chk_guard;
    uVar3 = 0;
    do {
        if (((param_2 >> (uVar3 & 0xff) & 1U) != 0) &&
            (iVar2 = strcmp((char *)(&DAT_000c4b64)[uVar3], param_1),
             iVar2 == 0))
            goto LAB_00070a94;
        uVar3 = uVar3 + 1;
    } while (uVar3 != 0x19);
    uVar3 = 0xffffffff;
LAB_00070a94:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_00070ac0(char *param_1, undefined4 param_2, undefined4 param_3)

{
    byte bVar1;
    ushort uVar2;
    size_t sVar3;
    FILE *__stream;
    char *pcVar4;
    size_t sVar5;
    ushort **ppuVar6;
    __int32_t **pp_Var7;
    int iVar8;
    undefined4 uVar9;
    int iVar10;
    int iVar11;
    int *piVar12;
    ushort *puVar13;
    byte *pbVar14;
    uint uVar15;
    uint uVar16;
    size_t sVar17;
    byte *__s;
    byte *__s1;
    char *local_144;
    char acStack_128[20];
    char acStack_114[31];
    byte abStack_f5[101];
    undefined1 auStack_90[100];
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_0007c054(acStack_114, 0x1e, "/dev/mixer%d", param_3);
    FUN_0007c054(acStack_128, 0x14, &DAT_000a9de0, "/etc/ntp.audio", param_3);
    __stream = fopen64(acStack_128, "r");
    if (__stream == (FILE *)0x0) {
        __printf_chk(1, "audio_config_read: <%s> NO\n", acStack_128);
        FUN_0007c054(acStack_128, 0x14, "%s.%d", "/etc/ntp.audio", param_3);
        __stream = fopen64(acStack_128, "r");
        if (__stream == (FILE *)0x0) {
            __printf_chk(1, "audio_config_read: <%s> NO\n", acStack_128);
            FUN_0007c054(acStack_128, 0x14, "%s", "/etc/ntp.audio", param_3);
            __stream = fopen64(acStack_128, "r");
            if (__stream == (FILE *)0x0) {
                __printf_chk(1, "audio_config_read: <%s> NO\n", acStack_128);
                goto LAB_00070e10;
            }
        }
    }
    __s = abStack_f5 + 1;
    __printf_chk(1, "audio_config_read: reading <%s>\n", acStack_128);
LAB_00070b98:
    pcVar4 = fgets((char *)__s, 100, __stream);
    if (pcVar4 != (char *)0x0) {
        pcVar4 = strchr((char *)__s, 0x23);
        if (pcVar4 != (char *)0x0) {
            *pcVar4 = '\0';
        }
        sVar5 = strlen((char *)__s);
        if (sVar5 == 0) {
        LAB_00070df8:
            sVar5 = 0;
        } else {
            bVar1 = abStack_f5[sVar5];
            if ((bVar1 & 0x80) == 0) {
                ppuVar6 = __ctype_b_loc();
                pbVar14 = __s + (sVar5 - 1);
                puVar13 = *ppuVar6;
                sVar3 = sVar5 - 1;
                do {
                    sVar17 = sVar3;
                    sVar5 = sVar17 + 1;
                    if ((puVar13[bVar1] & 0x2000) == 0)
                        break;
                    *pbVar14 = 0;
                    if (sVar17 == 0)
                        goto LAB_00070df8;
                    pbVar14 = pbVar14 + -1;
                    bVar1 = *pbVar14;
                    sVar3 = sVar17 - 1;
                    sVar5 = sVar17;
                } while ((bVar1 & 0x80) == 0);
            }
        }
        uVar16 = (uint)abStack_f5[1];
        if (uVar16 != 0) {
            uVar15 = uVar16 & 0xffffff80;
            pbVar14 = __s;
            __s1 = __s;
            if ((abStack_f5[1] & 0x80) == 0) {
                ppuVar6 = __ctype_b_loc();
                do {
                    if (((*ppuVar6)[uVar16] & 0x2000) == 0) {
                        uVar16 = (uint)*pbVar14;
                        __s1 = pbVar14;
                        if (uVar16 == 0)
                            goto LAB_00070d0c;
                        uVar15 = uVar16 & 0xffffff80;
                        break;
                    }
                    pbVar14 = pbVar14 + 1;
                    uVar16 = (uint)*pbVar14;
                    if (uVar16 == 0)
                        goto LAB_00070b98;
                    uVar15 = uVar16 & 0xffffff80;
                    __s1 = pbVar14;
                } while ((*pbVar14 & 0x80) == 0);
            }
            do {
                if (uVar15 == 0) {
                    ppuVar6 = __ctype_b_loc();
                    uVar2 = (*ppuVar6)[(short)uVar16];
                    if ((uVar2 & 0x200) == 0) {
                        uVar15 = ((uint)uVar2 << 0x12) >> 0x1f;
                        if (uVar16 == 0x3d) {
                            uVar15 = 1;
                        }
                        if (uVar15 != 0) {
                            uVar16 = (uint)*pbVar14;
                            if (uVar16 != 0)
                                goto LAB_00070ce4;
                            goto LAB_00070d0c;
                        }
                    } else {
                        pp_Var7 = __ctype_toupper_loc();
                        *pbVar14 = (byte)(*pp_Var7)[(short)uVar16];
                    }
                }
                pbVar14 = pbVar14 + 1;
                uVar16 = (uint)*pbVar14;
                if (uVar16 == 0)
                    goto LAB_00070d0c;
                uVar15 = uVar16 & 0xffffff80;
            } while (true);
        }
        goto LAB_00070b98;
    }
    fclose(__stream);
LAB_00070e10:
    pcVar4 = acStack_114;
    if (DAT_00116f64 != '\0') {
        pcVar4 = &DAT_00116f64;
    }
    local_144 = param_1;
    if (DAT_00116fc8 != '\0') {
        local_144 = &DAT_00116fc8;
    }
    iVar8 = open64(local_144, 0x802, 0x1ff);
    if (iVar8 < 0) {
        FUN_00074e00(3, "audio_init: %s %m", local_144);
    } else {
        DAT_001170f4 = open64(pcVar4, 2);
        if (DAT_001170f4 < 0) {
            FUN_00074e00(3, "audio_init: invalid control device <%s>", pcVar4);
            close(iVar8);
            iVar8 = DAT_001170f4;
        } else {
            __printf_chk(1, "audio_init: <%s> bufsiz %d\n", local_144, param_2);
            iVar10 = ioctl(iVar8, 0xc004500a);
            if (iVar10 == -1) {
                piVar12 = __errno_location();
                pcVar4 = strerror(*piVar12);
                __printf_chk(1, "audio_init: SNDCTL_DSP_SETFRAGMENT: %s\n",
                             pcVar4);
            }
            iVar10 = DAT_001170f4;
            iVar11 = ioctl(DAT_001170f4, 0x80044dfe, &DAT_001170f8);
            if (iVar11 == -1) {
                piVar12 = __errno_location();
                pcVar4 = strerror(*piVar12);
                __printf_chk(1, "SOUND_MIXER_READ_DEVMASK: %s\n", pcVar4);
                iVar10 = DAT_001170f4;
            }
            iVar10 = ioctl(iVar10, 0x80044dfd, &DAT_001170fc);
            if (iVar10 == -1) {
                piVar12 = __errno_location();
                pcVar4 = strerror(*piVar12);
                __printf_chk(1, "SOUND_MIXER_READ_RECMASK: %s\n", pcVar4);
            }
            uVar9 = DAT_001170fc;
            if (DAT_0011702c != '\0') {
                uVar16 = FUN_00070a30(&DAT_0011702c, DAT_001170fc);
                if ((int)uVar16 < 0) {
                    __printf_chk(1, "input %s not in recmask %#x\n",
                                 &DAT_0011702c, uVar9);
                } else {
                    DAT_000c7cc0 = uVar16 | 0xc0044d00;
                }
            }
            uVar9 = DAT_001170f8;
            if (DAT_00117090 != '\0') {
                uVar16 = FUN_00070a30(&DAT_00117090, DAT_001170f8);
                if ((int)uVar16 < 0) {
                    __printf_chk(1, "monitor %s not in devmask %#x\n",
                                 &DAT_00117090, uVar9);
                } else {
                    DAT_000c7cc4 = uVar16 | 0xc0044d00;
                }
            }
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar8);
    while (true) {
        uVar15 = ((uint)(*ppuVar6)[uVar16] << 0x12) >> 0x1f;
        if (uVar16 == 0x3d) {
            uVar15 = 1;
        }
        if (uVar15 == 0)
            break;
        pbVar14 = pbVar14 + 1;
        uVar16 = (uint)*pbVar14;
        if (uVar16 == 0)
            break;
    LAB_00070ce4:
        if ((uVar16 & 0x80) != 0)
            break;
    }
LAB_00070d0c:
    iVar8 = strncmp((char *)__s1, "IDEV", 4);
    if (iVar8 == 0) {
        iVar8 = sscanf((char *)pbVar14, "%99s", auStack_90);
        if (iVar8 == 1) {
            FUN_0007d4dc(&DAT_00116fc8, auStack_90);
            __printf_chk(1, "idev <%s>\n", auStack_90);
            goto LAB_00070b98;
        }
    }
    iVar8 = strncmp((char *)__s1, "CDEV", 4);
    if (iVar8 == 0) {
        iVar8 = sscanf((char *)pbVar14, "%99s", auStack_90);
        if (iVar8 == 1) {
            FUN_0007d4dc(&DAT_00116f64, auStack_90, 100);
            __printf_chk(1, "cdev <%s>\n", auStack_90);
            goto LAB_00070b98;
        }
    }
    iVar8 = strncmp((char *)__s1, "AGC", 3);
    if (iVar8 == 0) {
        iVar8 = sscanf((char *)pbVar14, "%99s", auStack_90);
        if (iVar8 == 1) {
            FUN_0007d4dc(&DAT_0011702c, auStack_90, 100);
            __printf_chk(1, "agc <%s> %d\n", auStack_90, sVar5);
            goto LAB_00070b98;
        }
    }
    iVar8 = strncmp((char *)__s1, "MONITOR", 7);
    if (iVar8 == 0) {
        iVar8 = sscanf((char *)pbVar14, "%99s", auStack_90);
        if (iVar8 == 1) {
            FUN_0007d4dc(&DAT_00117090, auStack_90, 100);
            uVar9 = FUN_00070a30(auStack_90, 0xffffffff);
            __printf_chk(1, "monitor <%s> %d\n", auStack_90, uVar9);
        }
    }
    goto LAB_00070b98;
}

void FUN_000712e0(int param_1, int param_2, int param_3)

{
    int __fd;
    int iVar1;
    int iVar2;
    int *piVar3;
    char *pcVar4;
    ulong __request;
    uint extraout_r1;
    uint uVar5;
    uint __request_00;
    uint extraout_r1_00;
    uint *puVar6;
    uint *puVar7;
    bool bVar8;
    uint local_28;
    int local_24;

    __fd = DAT_001170f4;
    puVar7 = &local_28;
    local_28 = (param_1 * 100) / 0xff;
    local_24 = __stack_chk_guard;
    local_28 = local_28 | local_28 * 0x100;
    if (DAT_0011702c == '\0') {
        __request = 0xc0044d07;
        if (param_3 == 2) {
            __request = 0xc0044d06;
        }
        iVar2 = ioctl(DAT_001170f4, __request, &local_28);
        uVar5 = extraout_r1;
    } else {
        iVar2 = ioctl(DAT_001170f4, DAT_000c7cc0, &local_28);
        uVar5 = extraout_r1_00;
    }
    if (iVar2 == -1) {
        piVar3 = __errno_location();
        pcVar4 = strerror(*piVar3);
        __printf_chk(1, "audio_gain: agc write: %s\n", pcVar4);
        iVar1 = DAT_000c7ccc;
    } else {
        puVar6 = &DAT_000c7cc0;
        iVar1 = DAT_000c7cc8;
        if (DAT_000c7cc8 != param_2) {
            bVar8 = DAT_00117090 == '\0';
            if (bVar8) {
                uVar5 = 0x4d00;
            }
            local_28 = (param_2 * 100) / 0xff;
            __request_00 = DAT_000c7cc4;
            if (bVar8) {
                puVar6 = &local_28;
                __request_00 = uVar5;
            }
            local_28 = local_28 | local_28 * 0x100;
            if (bVar8) {
                __request_00 = __request_00 & 0xffff | 0xc0040000;
                puVar7 = puVar6;
            }
            iVar2 = ioctl(__fd, __request_00, puVar7);
            iVar1 = param_2;
            if (iVar2 == -1) {
                piVar3 = __errno_location();
                pcVar4 = strerror(*piVar3);
                __printf_chk(1, "audio_gain: mongain write: %s\n", pcVar4);
                iVar1 = DAT_000c7ccc;
                goto LAB_00071444;
            }
        }
        DAT_000c7cc8 = iVar1;
        iVar1 = DAT_000c7ccc;
        if (DAT_000c7ccc != param_3) {
            if (param_3 == 2) {
                local_28 = 0x40;
            } else {
                local_28 = 0x80;
            }
            iVar2 = ioctl(__fd, 0xc0044dff, &local_28);
            iVar1 = param_3;
            if (iVar2 == -1) {
                piVar3 = __errno_location();
                pcVar4 = strerror(*piVar3);
                __printf_chk(1, "SOUND_MIXER_WRITE_RECSRC: %s\n", pcVar4);
                iVar1 = DAT_000c7ccc;
            }
        }
    }
LAB_00071444:
    DAT_000c7ccc = iVar1;
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

/* WARNING: Removing unreachable block (ram,0x0007165c) */

void FUN_000715d8(void)

{
    cache_keyid = 0;
    cache_type = 0;
    cache_flags = 0;
    cache_secret = 0;
    cache_secretsize = 0;
    cache_keyacclist = 0;
    return;
}

void FUN_00071680(undefined4 param_1, undefined4 *param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    undefined4 uVar6;

    iVar1 = __stack_chk_guard;
    puVar3 = (undefined4 *)FUN_00073ba4(0, 0x24, 0);
    uVar6 = param_2[1];
    uVar4 = param_2[2];
    uVar5 = param_2[3];
    puVar3[1] = *param_2;
    iVar2 = __stack_chk_guard;
    puVar3[2] = uVar6;
    puVar3[3] = uVar4;
    puVar3[4] = uVar5;
    uVar5 = param_2[4];
    uVar4 = param_2[6];
    puVar3[6] = param_2[5];
    puVar3[5] = uVar5;
    puVar3[7] = uVar4;
    puVar3[8] = param_3;
    *puVar3 = param_1;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00071724(undefined4 *param_1)

{
    int iVar1;
    undefined4 *puVar2;

    iVar1 = __stack_chk_guard;
    puVar2 = param_1;
    if (param_1 != (undefined4 *)0x0) {
        puVar2 = (undefined4 *)*param_1;
        free(param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar2);
}

void FUN_0007177c(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 != 0) {
        do {
            iVar2 = FUN_00071724();
        } while (iVar2 != 0);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(0);
}

void FUN_000717d8(int *param_1)

{
    int *piVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    uint uVar5;
    uint uVar6;
    int *piVar7;

    iVar2 = __stack_chk_guard;
    if (param_1 != (int *)0x0) {
        if (param_1[6] == cache_keyid) {
            FUN_000715d8();
        }
        FUN_0007177c(param_1[4]);
        iVar3 = key_hash;
        uVar5 = param_1[6];
        uVar6 = (uint)authhashmask;
        piVar7 = (int *)(key_hash + (uVar6 & uVar5) * 4);
        if ((void *)param_1[3] != (void *)0x0) {
            memset((void *)param_1[3], 0, param_1[8]);
            free((void *)param_1[3]);
        }
        piVar4 = *(int **)(iVar3 + (uVar6 & uVar5) * 4);
        if (param_1 == piVar4) {
        LAB_000718ac:
            *piVar7 = *piVar4;
        } else if (piVar4 != (int *)0x0) {
            piVar7 = piVar4;
            for (piVar1 = (int *)*piVar4; piVar1 != (int *)0x0;
                 piVar1 = (int *)*piVar1) {
                piVar4 = param_1;
                if (param_1 == piVar1)
                    goto LAB_000718ac;
                piVar7 = piVar1;
            }
        }
        iVar3 = param_1[1];
        *(int *)(iVar3 + 8) = param_1[2];
        *(int *)(param_1[2] + 4) = iVar3;
        param_1[3] = 0;
        param_1[4] = 0;
        param_1[5] = 0;
        param_1[6] = 0;
        param_1[7] = 0;
        param_1[8] = 0;
        param_1[9] = 0;
        piVar7 = param_1;
        param_1[2] = (int)authfreekeys;
        authfreekeys = piVar7;
        authnumkeys = authnumkeys + -1;
        authnumfreekeys = authnumfreekeys + 1;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00071968(short *param_1, short *param_2, uint param_3)

{
    uint __n;
    short sVar1;
    int iVar2;
    int iVar3;
    uint uVar4;

    iVar2 = __stack_chk_guard;
    if (param_1 == (short *)0x0)
        goto LAB_000719b0;
    sVar1 = *param_1;
    if ((sVar1 != 0 && param_2 != (short *)0x0) &&
        (sVar1 == *param_2 && *param_2 != 0)) {
        if (sVar1 == 2) {
            param_1 = param_1 + 2;
            if (0x1f < param_3) {
                param_3 = 0x20;
            }
            param_2 = param_2 + 2;
        } else {
            if ((sVar1 != 10) ||
                (*(int *)(param_1 + 0xc) != *(int *)(param_2 + 0xc)))
                goto LAB_000719ac;
            param_1 = param_1 + 4;
            if (0x7f < param_3) {
                param_3 = 0x80;
            }
            param_2 = param_2 + 4;
        }
        __n = param_3 >> 3;
        uVar4 = ~(0xffU >> (param_3 & 7)) & 0xff;
        if ((__n == 0) || (iVar3 = memcmp(param_1, param_2, __n), iVar3 == 0)) {
            if (uVar4 == 0) {
                param_1 = (short *)0x1;
            } else {
                param_1 =
                    (short *)(uint)((uVar4 & (*(byte *)((int)param_1 + __n) ^
                                              *(byte *)((int)param_2 + __n))) ==
                                    0);
            }
            goto LAB_000719b0;
        }
    }
LAB_000719ac:
    param_1 = (short *)0x0;
LAB_000719b0:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_1);
    }
    return;
}

void FUN_00071a8c(int *param_1, undefined4 param_2, int param_3)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 == (int *)0x0) {
        if (param_3 != 0) {
            param_3 = 1;
        }
    } else {
        do {
            iVar2 = FUN_00071968(param_1 + 1, param_2, param_1[8]);
            if (iVar2 != 0) {
                param_3 = 1;
                break;
            }
            param_1 = (int *)*param_1;
            param_3 = 0;
        } while (param_1 != (int *)0x0);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_3);
    }
    return;
}

void FUN_00071b14(void)

{
    int iVar1;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    uVar2 = (uint)authhashbuckets;
    key_hash = (void *)FUN_00073ba4(key_hash, uVar2 << 2, 0);
    memset(key_hash, 0, uVar2 << 2);
    key_listhead._8_4_ = key_listhead;
    key_listhead._4_4_ = key_listhead;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00071bb0(int param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    if (param_1 < 1) {
        param_1 = 0x10;
    }
    iVar2 = FUN_00073c68(0, param_1, 0x28);
    authnumfreekeys = authnumfreekeys + param_1;
    iVar3 = param_1;
    iVar4 = iVar2;
    do {
        iVar3 = iVar3 + -1;
        *(int *)(iVar4 + 8) = authfreekeys;
        authfreekeys = iVar4;
        iVar4 = iVar4 + 0x28;
    } while (iVar3 != 0);
    authfreekeys = iVar2 + (param_1 + -1) * 0x28;
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00071c70(uint param_1, undefined2 param_2, undefined2 param_3,
                  undefined4 param_4, undefined4 param_5, undefined4 param_6,
                  undefined4 param_7)

{
    int iVar1;
    undefined4 *puVar2;
    int iVar3;
    uint uVar4;
    undefined4 uVar5;

    iVar3 = __stack_chk_guard;
    iVar1 = key_hash;
    uVar4 = (uint)authhashmask;
    if (authnumfreekeys < 1) {
        FUN_00071bb0(0xffffffff);
    }
    puVar2 = authfreekeys;
    authnumfreekeys = authnumfreekeys + -1;
    if (authfreekeys != (undefined4 *)0x0) {
        authfreekeys = (undefined4 *)authfreekeys[2];
    }
    uVar5 = *(undefined4 *)(iVar1 + (uVar4 & param_1) * 4);
    puVar2[8] = param_5;
    *puVar2 = uVar5;
    *(undefined2 *)(puVar2 + 9) = param_2;
    *(undefined2 *)(puVar2 + 7) = param_3;
    puVar2[6] = param_1;
    puVar2[3] = param_6;
    puVar2[4] = param_7;
    puVar2[5] = param_4;
    *(undefined4 **)(iVar1 + (uVar4 & param_1) * 4) = puVar2;
    uVar5 = key_listhead._4_4_;
    puVar2[2] = key_listhead;
    puVar2[1] = uVar5;
    uVar5 = key_listhead._4_4_;
    key_listhead._4_4_ = puVar2;
    *(undefined4 **)(uVar5 + 8) = puVar2;
    authnumkeys = authnumkeys + 1;
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00071dbc(int param_1)

{
    size_t __n;
    void *pvVar1;
    int iVar2;
    uint uVar3;
    undefined4 *puVar4;
    uint uVar5;
    int iVar6;
    int iVar7;
    undefined4 *puVar8;
    int iVar9;

    iVar2 = __stack_chk_guard;
    uVar5 = authnumkeys + authnumfreekeys;
    if (0 < (int)(param_1 - uVar5)) {
        FUN_00071bb0();
        uVar5 = authnumkeys + authnumfreekeys;
    }
    uVar5 = uVar5 >> 2;
    iVar9 = 5;
    iVar6 = 0;
    iVar7 = 0x10;
    uVar3 = 0xffffffff;
    do {
        uVar3 = uVar3 << iVar7;
        if ((uVar3 & uVar5) == 0) {
            uVar5 = uVar5 << iVar7;
        } else {
            iVar6 = iVar6 + iVar7;
        }
        iVar9 = iVar9 + -1;
        iVar7 = iVar7 >> 1;
    } while (iVar9 != 0);
    uVar5 = iVar6 + 1U & 0xffff;
    if (uVar5 < 4) {
        uVar5 = 4;
    }
    if (0xe < uVar5) {
        uVar5 = 0xf;
    }
    __n = 4 << (uVar5 & 0xff);
    authhashbuckets = (short)(1 << (uVar5 & 0xff));
    authhashmask = authhashbuckets - 1;
    key_hash = (void *)FUN_00073ba4(key_hash, __n, 0, 0);
    memset(key_hash, 0, __n);
    pvVar1 = key_hash;
    if ((undefined1 *)key_listhead._8_4_ != key_listhead) {
        uVar5 = (uint)authhashmask;
        puVar8 = (undefined4 *)key_listhead._8_4_;
        do {
            puVar4 = (undefined4 *)puVar8[2];
            *puVar8 = *(undefined4 *)((int)pvVar1 + (puVar8[6] & uVar5) * 4);
            *(undefined4 **)((int)pvVar1 + (puVar8[6] & uVar5) * 4) = puVar8;
            puVar8 = puVar4;
        } while (puVar4 != (undefined4 *)key_listhead);
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00071fc0) */

void FUN_00071f34(uint param_1)

{
    uint uVar1;
    int *piVar2;

    piVar2 = *(int **)(key_hash + (authhashmask & param_1) * 4);
    if (piVar2 != (int *)0x0) {
        uVar1 = piVar2[6];
        while ((param_1 != uVar1 &&
                (piVar2 = (int *)*piVar2, piVar2 != (int *)0x0))) {
            uVar1 = piVar2[6];
        }
    }
    return;
}

void FUN_00071fd4(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if ((param_1 == 0) || (cache_keyid == param_1)) {
        iVar2 = 1;
    } else {
        iVar2 = FUN_00071f34();
        if (iVar2 != 0) {
            iVar2 = 1;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_0007204c(int param_1)

{
    ushort uVar1;
    int iVar2;
    ushort uVar3;
    int iVar4;

    iVar2 = __stack_chk_guard;
    authkeylookups = authkeylookups + 1;
    if ((param_1 == 0) || (cache_keyid == param_1)) {
        uVar3 = cache_flags & 1;
    } else {
        authkeyuncached = authkeyuncached + 1;
        iVar4 = FUN_00071f34();
        if ((iVar4 == 0) || (*(ushort *)(iVar4 + 0x1c) == 0)) {
            uVar3 = 0;
            authkeynotfound = authkeynotfound + 1;
        } else {
            uVar1 = *(ushort *)(iVar4 + 0x24);
            uVar3 = uVar1 & 1;
            if ((uVar1 & 1) == 0) {
                authnokey = authnokey + 1;
            } else {
                cache_keyid = *(int *)(iVar4 + 0x18);
                uVar3 = 1;
                cache_secret = *(undefined4 *)(iVar4 + 0xc);
                cache_keyacclist = *(undefined4 *)(iVar4 + 0x10);
                cache_secretsize = *(undefined4 *)(iVar4 + 0x20);
                cache_flags = uVar1;
                cache_type = (uint) * (ushort *)(iVar4 + 0x1c);
            }
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_000721bc(int param_1, uint param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00071f34();
    if (param_2 != 0 || iVar2 != 0) {
        if (iVar2 == 0) {
            if (param_2 < 2) {
                iVar2 = 0;
            } else {
                iVar2 = param_2 + current_time;
            }
            FUN_00071c70(param_1, 1, 0, iVar2, 0, 0, 0);
        } else {
            if (param_1 == cache_keyid) {
                FUN_000715d8();
            }
            if (param_2 == 0) {
                if (iVar1 == __stack_chk_guard) {
                    FUN_000717d8();
                    return;
                }
                goto LAB_000722cc;
            }
            *(ushort *)(iVar2 + 0x24) = *(ushort *)(iVar2 + 0x24) | 1;
            if (param_2 < 2) {
                *(undefined4 *)(iVar2 + 0x14) = 0;
            } else {
                *(uint *)(iVar2 + 0x14) = current_time + param_2;
            }
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_000722cc:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000722e0(int param_1)

{
    int iVar1;
    ushort uVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (cache_keyid == param_1) {
        uVar2 = cache_flags & 1;
    } else {
        authkeyuncached = authkeyuncached + 1;
        iVar3 = FUN_00071f34();
        if ((iVar3 == 0) || ((*(ushort *)(iVar3 + 0x24) & 1) == 0)) {
            uVar2 = 0;
            authkeynotfound = authkeynotfound + 1;
        } else {
            uVar2 = 1;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_000723a4(int param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (cache_keyid == param_1) {
        if ((cache_flags & 1) != 0) {
            iVar2 = FUN_00071a8c(cache_keyacclist, param_2, 1);
            if (iVar2 != 0) {
                iVar2 = 1;
            }
            goto LAB_000723f0;
        }
    } else {
        iVar2 = FUN_00071f34();
        if (iVar2 == 0) {
            authkeynotfound = authkeynotfound + 1;
            iVar2 = 0;
            goto LAB_000723f0;
        }
        authkeyuncached = authkeyuncached + 1;
        if ((*(ushort *)(iVar2 + 0x24) & 1) != 0) {
            iVar2 = FUN_00071a8c(*(undefined4 *)(iVar2 + 0x10), param_2, 1);
            if (iVar2 != 0) {
                iVar2 = 1;
            }
            goto LAB_000723f0;
        }
    }
    iVar2 = 0;
LAB_000723f0:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_000724ac(int param_1, undefined2 param_2, void *param_3,
                  size_t param_4, int param_5)

{
    int iVar1;
    int iVar2;
    void *pvVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00071f34();
    if ((iVar2 == 0) || (*(int *)(iVar2 + 0x18) != param_1)) {
        pvVar3 = (void *)FUN_00073ba4(0, param_4 + 1, 0);
        memcpy(pvVar3, param_3, param_4);
        FUN_00071c70(param_1, 0, param_2, 0, param_4, pvVar3, param_5);
    } else {
        if (*(void **)(iVar2 + 0xc) != (void *)0x0) {
            memset(*(void **)(iVar2 + 0xc), 0, *(size_t *)(iVar2 + 0x20));
            free(*(void **)(iVar2 + 0xc));
        }
        pvVar3 = (void *)FUN_00073ba4(0, param_4 + 1, 0);
        *(void **)(iVar2 + 0xc) = pvVar3;
        *(undefined2 *)(iVar2 + 0x1c) = param_2;
        *(size_t *)(iVar2 + 0x20) = param_4;
        if (*(int *)(iVar2 + 0x10) != param_5) {
            FUN_0007177c(*(int *)(iVar2 + 0x10));
            pvVar3 = *(void **)(iVar2 + 0xc);
            *(int *)(iVar2 + 0x10) = param_5;
        }
        memcpy(pvVar3, param_3, param_4);
        if (param_1 == cache_keyid) {
            if (iVar1 == __stack_chk_guard) {
                FUN_000715d8();
                return;
            }
            goto LAB_000725e8;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_000725e8:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000725f8(void)

{
    int iVar1;
    undefined4 uVar2;
    undefined1 *puVar3;
    undefined1 *puVar4;

    iVar1 = __stack_chk_guard;
    puVar3 = (undefined1 *)key_listhead._8_4_;
    if ((undefined1 *)key_listhead._8_4_ != key_listhead) {
    LAB_00072678:
        do {
            puVar4 = *(undefined1 **)(puVar3 + 8);
            if (*(uint *)(puVar3 + 0x18) < 0x10000) {
                if ((*(ushort *)(puVar3 + 0x24) & 1) == 0) {
                    FUN_000717d8(puVar3);
                    puVar3 = puVar4;
                    if (puVar4 == key_listhead)
                        break;
                    goto LAB_00072678;
                }
                if (*(void **)(puVar3 + 0xc) != (void *)0x0) {
                    memset(*(void **)(puVar3 + 0xc), 0,
                           *(size_t *)(puVar3 + 0x20));
                    free(*(void **)(puVar3 + 0xc));
                    *(undefined4 *)(puVar3 + 0xc) = 0;
                }
                uVar2 = FUN_0007177c(*(undefined4 *)(puVar3 + 0x10));
                *(undefined4 *)(puVar3 + 0x20) = 0;
                *(undefined4 *)(puVar3 + 0x10) = uVar2;
                *(undefined4 *)(puVar3 + 0x14) = 0;
            }
            puVar3 = puVar4;
        } while (puVar4 != key_listhead);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000726d0(void)

{
    uint *puVar1;
    int iVar2;
    undefined1 *puVar3;

    iVar2 = __stack_chk_guard;
    puVar3 = (undefined1 *)key_listhead._8_4_;
    if ((undefined1 *)key_listhead._8_4_ != key_listhead) {
        do {
            while (true) {
                puVar1 = (uint *)(puVar3 + 0x14);
                puVar3 = *(undefined1 **)(puVar3 + 8);
                if ((*puVar1 == 0) || (current_time <= *puVar1))
                    break;
                FUN_000717d8();
                authkeyexpired = authkeyexpired + 1;
                if (puVar3 == key_listhead)
                    goto LAB_0007275c;
            }
        } while (puVar3 != key_listhead);
    }
LAB_0007275c:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0007278c(uint param_1, int param_2, uint param_3)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    int iVar5;
    int iVar6;
    bool bVar7;

    iVar5 = __stack_chk_guard;
    bVar7 = param_1 == 0;
    uVar1 = param_1 >> 8;
    uVar2 = param_1 >> 0x10;
    uVar3 = param_1 >> 0x18;
    uVar4 = param_1 << 0x18;
    if (bVar7) {
        param_1 = 4;
    }
    authencryptions = authencryptions + 1;
    *(uint *)(param_2 + (param_3 & 0xfffffffc)) =
        uVar4 | (uVar1 & 0xff) << 0x10 | (uVar2 & 0xff) << 8 | uVar3;
    if ((!bVar7) && (iVar6 = FUN_0007204c(param_1), iVar6 != 0)) {
        FUN_000706cc(cache_type, cache_secret, cache_secretsize, param_2,
                     param_3);
    }
    if (iVar5 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00072854(int param_1, undefined4 param_2, undefined4 param_3,
                  uint param_4)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    authdecryptions = authdecryptions + 1;
    if ((param_1 == 0) || (iVar3 = FUN_0007204c(), iVar3 == 0 || param_4 < 4)) {
        uVar2 = 0;
    } else {
        uVar2 = FUN_00070770(cache_type, cache_secret, cache_secretsize,
                             param_2, param_3, param_4);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_0007291c(undefined4 *param_1)

{
    int iVar1;
    byte *pbVar2;
    byte *pbVar3;
    int iVar4;
    uint uVar5;
    byte *pbVar6;

    iVar1 = __stack_chk_guard;
    pbVar2 = (byte *)*param_1;
    uVar5 = (uint)*pbVar2;
    if (uVar5 == 9 || uVar5 == 0x20) {
        do {
            pbVar2 = pbVar2 + 1;
            uVar5 = (uint)*pbVar2;
        } while (uVar5 == 9 || uVar5 == 0x20);
    }
    if ((((uVar5 & 0xdf) != 0) && (1 < uVar5 - 9)) &&
        (pbVar3 = pbVar2, uVar5 != 0x23)) {
        do {
            uVar5 = (uint)pbVar3[1];
            pbVar6 = pbVar3 + 1;
            iVar4 = uVar5 - 10;
            if (iVar4 != 0) {
                iVar4 = 1;
            }
            if (uVar5 == 0) {
                iVar4 = 0;
            }
            if (iVar4 == 0) {
                if (pbVar6 == pbVar2)
                    goto LAB_00072a1c;
                if (uVar5 != 9 && uVar5 != 0x20)
                    goto LAB_00072a04;
            LAB_000729c8:
                *pbVar6 = 0;
                pbVar6 = pbVar3 + 2;
                goto LAB_000729d4;
            }
            if (uVar5 == 0x20 || uVar5 == 9) {
                if (pbVar6 != pbVar2)
                    goto LAB_000729c8;
                goto LAB_00072a1c;
            }
            pbVar3 = pbVar6;
        } while (uVar5 != 0x23);
        if (pbVar6 != pbVar2) {
        LAB_00072a04:
            *pbVar6 = 0;
        LAB_000729d4:
            *param_1 = pbVar6;
            goto LAB_000729d8;
        }
    }
LAB_00072a1c:
    pbVar2 = (byte *)0x0;
LAB_000729d8:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pbVar2);
}

void FUN_00072a30(uint *param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    uint uVar2;
    undefined4 uStack_8;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_8 = param_3;
    uStack_4 = param_4;
    if ((param_1 == (uint *)0x0) ||
        (uVar2 = *param_1, *param_1 = uVar2 + 1, uVar2 + 1 < 6)) {
        FUN_00074e88(3, param_2, &uStack_8, &uStack_8, &uStack_8);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00072ab4(void *param_1)

{
    int iVar1;
    undefined4 *__ptr;

    iVar1 = __stack_chk_guard;
    __ptr = *(undefined4 **)((int)param_1 + 4);
    while (__ptr != (undefined4 *)0x0) {
        *(undefined4 *)((int)param_1 + 4) = *__ptr;
        free(__ptr);
        __ptr = *(undefined4 **)((int)param_1 + 4);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    free(param_1);
    return;
}

void FUN_00073138(undefined4 param_1, int param_2)

{
    undefined4 local_38;
    undefined4 uStack_34;
    undefined4 local_30;
    undefined4 uStack_2c;
    undefined4 local_28;
    undefined4 uStack_24;
    undefined4 local_1c;
    undefined4 uStack_18;
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_2 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("caljulian.c", 0x1f, 2, "((void *)0) != jt");
    }
    FUN_000758e8(&local_30, param_1, 0);
    local_28 = local_30;
    uStack_24 = uStack_2c;
    FUN_0007598c(&local_38, &local_28);
    local_1c = local_38;
    uStack_18 = uStack_34;
    FUN_00075ee8(param_2, &local_1c, "fd, SET, RTS_on): %m");
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000731f0(undefined2 *param_1)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 local_20[3];
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_1 == (undefined2 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("caltontp.c", 0x2b, 0, "jt != ((void *)0)");
    }
    if (0xd < *(byte *)(param_1 + 2)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("caltontp.c", 0x2d, 0, "jt->month <= 13");
    }
    if (0x20 < *(byte *)((int)param_1 + 5)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("caltontp.c", 0x2e, 0, "jt->monthday <= 32");
    }
    if (0x16e < (ushort)param_1[1]) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("caltontp.c", 0x2f, 0, "jt->yearday <= 366");
    }
    if (0x18 < *(byte *)(param_1 + 3)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("caltontp.c", 0x30, 0, "jt->hour <= 24");
    }
    if (0x3c < *(byte *)((int)param_1 + 7)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("caltontp.c", 0x31, 0, "jt->minute <= (60)");
    }
    if (0x3c < *(byte *)(param_1 + 4)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("caltontp.c", 0x32, 0, "jt->second <= (60)");
    }
    if (param_1[1] == 0) {
        iVar1 = FUN_00076428();
    } else {
        iVar1 = FUN_0007648c(*param_1);
        iVar1 = (uint)(ushort)param_1[1] + iVar1 + -1;
    }
    uVar2 = FUN_0007636c(*(undefined1 *)(param_1 + 3),
                         *(undefined1 *)((int)param_1 + 7),
                         *(undefined1 *)(param_1 + 4));
    FUN_00076038(local_20, iVar1 + -0xa955c, uVar2);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_20[0]);
}

void FUN_000733d8(int param_1, int param_2, int param_3, int param_4,
                  int param_5, int param_6, int *param_7, int *param_8)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    int iVar5;
    undefined4 local_68;
    undefined4 uStack_64;
    undefined4 local_60;
    undefined4 uStack_5c;
    int local_58[2];
    int local_50[6];
    uint local_38;
    uint local_34;
    uint local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    param_4 =
        param_4 +
        (param_3 + (param_2 + param_5 + (param_1 + -1) * 0x18) * 0x3c) * 0x3c;
    if (*param_7 != 0) {
        local_50[3] = *param_7 + param_4;
        local_38 = local_50[3] - param_6;
        if ((int)local_38 < 0) {
            local_38 = -local_38;
        }
        if (local_38 < 0xeff100) {
            *param_8 = local_50[3];
            uVar1 = local_38;
            goto LAB_00073560;
        }
    }
    FUN_000758e8(&local_68, param_6 - param_4, 0);
    local_60 = local_68;
    uStack_5c = uStack_64;
    FUN_0007598c(local_58, &local_60);
    iVar5 = 0;
    FUN_00075a30(local_58, "Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m" +
                               local_58[0] + 0x1b);
    do {
        iVar2 = FUN_000760f4(local_58[0] + -1 + iVar5);
        iVar2 = (iVar2 + -0xa955b) * 0x15180;
        iVar3 = param_4 + iVar2;
        local_50[iVar5] = iVar2;
        iVar2 = iVar3 - param_6;
        local_50[iVar5 + 3] = iVar3;
        if (iVar2 < 0) {
            iVar2 = -iVar2;
        }
        local_50[iVar5 + 6] = iVar2;
        iVar5 = iVar5 + 1;
    } while (iVar5 != 3);
    uVar1 = local_38;
    if (local_34 <= local_38) {
        uVar1 = local_34;
    }
    uVar4 = (uint)(local_34 <= local_38);
    if (local_30 < uVar1) {
        uVar4 = 2;
        uVar1 = local_30;
    }
    iVar5 = local_50[uVar4];
    *param_8 = local_50[uVar4 + 3];
    *param_7 = iVar5;
LAB_00073560:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar1 < 0x3840);
    }
    return;
}

void FUN_000735a0(char *param_1, undefined4 *param_2)

{
    addrinfo *__ai;
    char *pcVar1;
    size_t sVar2;
    char *pcVar3;
    int iVar4;
    undefined4 uVar5;
    char *pcVar6;
    char cVar7;
    ushort uVar8;
    char *pcVar9;
    char *pcVar10;
    ushort local_92;
    addrinfo *local_90;
    addrinfo local_8c;
    char acStack_6c[80];
    int local_1c;

    pcVar10 = (char *)0x0;
    local_90 = (addrinfo *)0x0;
    local_1c = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("decodenetnum.c", 0x26, 0, "num != ((void *)0)");
    }
    sVar2 = strlen(param_1);
    if (sVar2 < 0x50) {
        if (*param_1 == '[') {
            cVar7 = param_1[1];
            pcVar9 = acStack_6c;
            pcVar10 = param_1 + 1;
            pcVar3 = pcVar9;
            if (cVar7 != '\0' && cVar7 != ']') {
                pcVar6 = pcVar9;
                pcVar1 = param_1 + 2;
                do {
                    pcVar10 = pcVar1;
                    *pcVar6 = cVar7;
                    cVar7 = *pcVar10;
                    pcVar3 = pcVar6 + 1;
                    pcVar6 = pcVar6 + 1;
                    pcVar1 = pcVar10 + 1;
                } while (cVar7 != '\0' && cVar7 != ']');
            }
            *pcVar3 = '\0';
            if (((cVar7 == ']') && (pcVar10[1] == ':')) &&
                (pcVar10[2] != '\0')) {
                pcVar10 = pcVar10 + 2;
            } else {
                pcVar10 = (char *)0x0;
            }
        } else {
            pcVar3 = strchr(param_1, 0x3a);
            pcVar9 = param_1;
            if (pcVar3 == (char *)0x0) {
                pcVar10 = (char *)0x0;
            } else {
                pcVar3 = strchr(pcVar3 + 1, 0x3a);
                if (pcVar3 == (char *)0x0) {
                    pcVar9 = acStack_6c;
                    FUN_0007d4dc(pcVar9, param_1, 0x50);
                    pcVar3 = strchr(pcVar9, 0x3a);
                    pcVar10 = pcVar3 + 1;
                    *pcVar3 = '\0';
                }
            }
        }
        local_8c.ai_socktype = 0;
        local_8c.ai_family = 0;
        local_8c.ai_protocol = 0;
        local_8c.ai_addrlen = 0;
        local_8c.ai_addr = (sockaddr *)0x0;
        local_8c.ai_canonname = (char *)0x0;
        local_8c.ai_next = (addrinfo *)0x0;
        local_8c.ai_flags = 4;
        iVar4 = getaddrinfo(pcVar9, "ntp", &local_8c, &local_90);
        __ai = local_90;
        if (iVar4 == 0) {
            if (0x1c < local_90->ai_addrlen) {
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("decodenetnum.c", 0x4e, 2,
                             "ai->ai_addrlen <= sizeof(*netnum)");
            }
            *param_2 = 0;
            param_2[1] = 0;
            param_2[2] = 0;
            param_2[3] = 0;
            param_2[4] = 0;
            param_2[5] = 0;
            param_2[6] = 0;
            memcpy(param_2, local_90->ai_addr, local_90->ai_addrlen);
            freeaddrinfo(__ai);
            if ((pcVar10 == (char *)0x0) ||
                (iVar4 = sscanf(pcVar10, "%hu", &local_92), iVar4 != 1)) {
                uVar8 = 0x7b00;
            } else {
                uVar8 = local_92 << 8 | local_92 >> 8;
            }
            uVar5 = 1;
            *(ushort *)((int)param_2 + 2) = uVar8;
            goto LAB_000736dc;
        }
    }
    uVar5 = 0;
LAB_000736dc:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar5);
    }
    return;
}

void FUN_00073804(uint param_1, uint param_2, int param_3, uint param_4,
                  int param_5)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    char cVar4;
    uint uVar5;
    char *pcVar6;
    int iVar7;
    int iVar8;
    char *pcVar9;
    char *pcVar10;
    char *pcVar11;
    char *pcVar12;
    int iVar13;
    char *__s;
    char *pcVar14;
    uint uVar15;
    int iVar16;
    bool bVar17;
    undefined4 local_44;
    undefined4 local_40;
    undefined4 local_3c;
    undefined4 local_38;
    undefined4 local_34;
    undefined4 local_30;
    int local_2c;

    iVar8 = lib_nextbuf;
    local_2c = __stack_chk_guard;
    iVar1 = lib_nextbuf * 0x80;
    __s = lib_stringbuf + iVar1;
    memset(__s, 0, 0x80);
    lib_nextbuf = iVar8 + 1U & 0xf;
    local_40 = 0;
    local_44 = 0;
    local_3c = 0;
    local_38 = 0;
    local_34 = 0;
    local_30 = 0;
    pcVar12 = (char *)((int)&local_3c + 2);
    pcVar9 = pcVar12;
    if (param_1 != 0) {
        iVar16 = 10;
        do {
            iVar16 = iVar16 + -1;
            uVar15 = param_1 / 10;
            pcVar9 = pcVar9 + -1;
            *pcVar9 = (char)(param_1 % 10);
            param_1 = uVar15;
        } while ((uVar15 != 0 && iVar16 != 0) && (uVar15 == 0 || -1 < iVar16));
    }
    pcVar14 = pcVar12;
    if ((int)param_4 < 0) {
        if (param_5 != 0) {
            uVar15 = 3;
            goto LAB_00073904;
        }
    LAB_00073a44:
        pcVar11 = pcVar12;
        if (((uint)(0 < (int)pcVar12 - (int)&local_44) & param_2 >> 0x1f) !=
            0) {
            do {
                pcVar11 = pcVar11 + -1;
                if ((char)(*pcVar11 + '\x01') != '\n') {
                    *pcVar11 = *pcVar11 + '\x01';
                    break;
                }
                *pcVar11 = '\0';
            } while (0 < (int)(pcVar11 + (((int)pcVar12 - (int)&local_44) -
                                          (int)pcVar12)));
        }
        if (pcVar11 <= pcVar9) {
            pcVar9 = pcVar11;
        }
    } else {
        if (param_5 == 0) {
            uVar15 = param_4;
            if (0xd < (int)param_4) {
                uVar15 = 0xe;
            }
            bVar17 = (int)param_2 < 0;
            if (param_2 != 0) {
                bVar17 = (int)param_4 < 0;
            }
            if ((param_2 != 0 && param_4 != 0) && !bVar17)
                goto LAB_00073930;
        LAB_00073974:
            if (uVar15 == 0)
                goto LAB_00073a44;
        } else {
            uVar15 = param_4 + 3;
            if (0xd < (int)uVar15) {
                uVar15 = 0xe;
            }
        LAB_00073904:
            pcVar14 = (char *)((int)&local_38 + 1);
            if (param_2 != 0) {
            LAB_00073930:
                do {
                    uVar2 = param_2 * 2;
                    iVar16 = (int)param_2 >> 0x1f;
                    iVar7 = (int)param_2 >> 0x1f;
                    uVar3 = param_2 * 8;
                    iVar13 = param_2 << 2;
                    param_2 = param_2 * 10;
                    uVar15 = uVar15 - 1;
                    uVar5 = param_2;
                    if (param_2 != 0) {
                        uVar5 = uVar15;
                    }
                    pcVar11 = pcVar12 + 1;
                    *pcVar12 = (CARRY4(uVar2, uVar3) - (char)iVar7) +
                               ((byte)((uint)iVar13 >> 0x1f) |
                                (byte)((uVar2 >> 0x1f | iVar16 * -2) << 1));
                    pcVar12 = pcVar11;
                } while ((param_2 != 0 && uVar15 != 0) && -1 < (int)uVar5);
                goto LAB_00073974;
            }
        }
        pcVar12 = pcVar12 + uVar15;
    }
    if (pcVar9 < pcVar14) {
        cVar4 = *pcVar9;
        while (cVar4 == '\0') {
            pcVar9 = pcVar9 + 1;
            if (pcVar9 == pcVar14)
                goto LAB_000739b8;
            cVar4 = *pcVar9;
        }
    } else {
    LAB_000739b8:
        pcVar9 = pcVar14 + -1;
    }
    pcVar11 = __s;
    if (param_3 != 0) {
        lib_stringbuf[iVar8 * 0x80] = 0x2d;
        pcVar11 = lib_stringbuf + iVar1 + 1;
    }
    if (pcVar9 < pcVar12) {
        do {
            pcVar10 = pcVar11 + 1;
            pcVar6 = pcVar11;
            if (pcVar9 == pcVar14) {
                *pcVar11 = '.';
                pcVar10 = pcVar11 + 2;
                pcVar6 = pcVar11 + 1;
            }
            pcVar11 = pcVar10;
            pcVar10 = pcVar9 + 1;
            *pcVar6 = *pcVar9 + '0';
            pcVar9 = pcVar10;
        } while (pcVar10 != pcVar12);
    }
    *pcVar11 = '\0';
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_00073ba4(void *param_1, size_t param_2, uint param_3, int param_4)

{
    int iVar1;
    void *pvVar2;

    iVar1 = __stack_chk_guard;
    if (param_2 == 0) {
        pvVar2 = realloc(param_1, 1);
        if (pvVar2 == (void *)0x0)
            goto LAB_00073c28;
    } else {
        pvVar2 = realloc(param_1, param_2);
        if (pvVar2 == (void *)0x0) {
        LAB_00073c28:
            msyslog_term = 1;
            FUN_00074e00(3, "fatal out of memory (%lu bytes)", param_2);
            /* WARNING: Subroutine does not return */
            exit(1);
        }
        if (param_4 != 0 && param_3 < param_2) {
            memset((void *)((int)pvVar2 + param_3), 0, param_2 - param_3);
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pvVar2);
}

/* WARNING: Removing unreachable block (ram,0x00073cf8) */

void FUN_00073c68(undefined4 param_1, uint param_2, uint param_3, int param_4)

{
    bool bVar1;
    bool bVar2;

    bVar2 = 0xfffe < param_3;
    bVar1 = param_3 == 0xffff;
    if (param_3 < 0x10000) {
        bVar2 = 0xfffe < param_2;
        bVar1 = param_2 == 0xffff;
    }
    if ((param_2 != 0 && (bVar2 && !bVar1)) &&
        ((int)((ulonglong)param_2 * (ulonglong)param_3 >> 0x20) != 0)) {
        FUN_00074e00(3, "fatal allocation size overflow");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    FUN_00073ba4(param_1, param_3 * param_2 + param_4, 0, 1);
    return;
}

void FUN_00073d08(char *param_1)

{
    int iVar1;
    size_t sVar2;
    void *__dest;

    iVar1 = __stack_chk_guard;
    sVar2 = strlen(param_1);
    __dest = (void *)FUN_00073ba4(0, sVar2 + 1, 0);
    memcpy(__dest, param_1, sVar2 + 1);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00073db0) */

void FUN_00073d78(void)

{
    return;
}

void FUN_00073dc0(int param_1, int param_2)

{
    byte bVar1;
    size_t sVar2;
    byte bVar3;
    int iVar4;
    int iVar5;
    undefined4 uVar6;
    undefined1 *puVar7;
    int iVar8;
    size_t __n;
    byte *pbVar9;
    double in_d0;
    undefined3 local_40;
    undefined1 uStack_3d;
    undefined4 uStack_3c;
    undefined4 uStack_38;
    undefined1 auStack_34[8];
    byte local_2c[8];
    int local_24;

    uStack_3c = 0x5e0;
    uStack_38 = 0xfdfd0000;
    local_24 = __stack_chk_guard;
    _local_40 = CONCAT13((char)param_2, 0xfefeff);
    if (param_2 == 4) {
        __n = 0xb;
        iVar8 = 4;
    } else {
        iVar8 = 5;
        __n = 0xc;
    }
    FUN_0007c054(auStack_34, 0x10, " %10.0f", __stack_chk_guard,
                 in_d0 * 1000000.0);
    if (local_2c[2] == 0x20) {
        iVar4 = 0;
    } else {
        pbVar9 = (byte *)((int)&uStack_3c + 1);
        puVar7 = auStack_34;
        iVar4 = 0;
        bVar3 = local_2c[2];
        do {
            iVar5 = iVar4;
            bVar1 = bVar3 & 0xf;
            iVar4 = iVar5 + 1;
            bVar3 = puVar7[8];
            pbVar9 = pbVar9 + 1;
            *pbVar9 = bVar1 | puVar7[9] << 4;
            puVar7 = puVar7 + -2;
        } while (bVar3 != 0x20);
        puVar7 = (undefined1 *)((int)&uStack_3c + iVar5 + 3);
        if (iVar8 <= iVar4)
            goto LAB_00073eb4;
    }
    puVar7 = (undefined1 *)((int)&local_40 + iVar4 + 5);
    do {
        puVar7 = puVar7 + 1;
        *puVar7 = 0;
    } while ((undefined1 *)((int)&uStack_3c + iVar8 + 1) != puVar7);
    puVar7 = (undefined1 *)((int)&uStack_3c + iVar8 + 2);
LAB_00073eb4:
    *puVar7 = 0xfd;
    sVar2 = write(param_1, &local_40, __n);
    if (sVar2 == 0xffffffff) {
        FUN_00074e00(3, "icom_freq: write() failed: %m");
        uVar6 = 0xffffffff;
    } else if (sVar2 == __n) {
        uVar6 = 0;
    } else {
        FUN_00074e00(3, "icom_freq: only wrote %d of %d bytes.", sVar2, __n);
        uVar6 = 1;
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar6);
    }
    return;
}

void FUN_00073f68(char *param_1, speed_t param_2)

{
    int __fd;
    int iVar1;
    int iVar2;
    int *piVar3;
    termios local_58;
    int local_1c;

    local_1c = __stack_chk_guard;
    __fd = open64(param_1, 2, 0x1ff);
    if (__fd < 0) {
        iVar1 = -1;
    } else {
        iVar1 = tcgetattr(__fd, &local_58);
        if (-1 < iVar1) {
            local_58.c_cflag = 0x839;
            local_58.c_cc[5] = '\x05';
            local_58.c_cc[6] = '\0';
            local_58.c_iflag = 0;
            local_58.c_oflag = 0;
            local_58.c_lflag = 0;
            cfsetispeed(&local_58, param_2);
            cfsetospeed(&local_58, param_2);
            iVar2 = tcsetattr(__fd, 0, &local_58);
            iVar1 = __fd;
            if (-1 < iVar2)
                goto LAB_00074004;
        }
        piVar3 = __errno_location();
        iVar2 = *piVar3;
        iVar1 = -1;
        close(__fd);
        *piVar3 = iVar2;
    }
LAB_00074004:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_00074054(char *param_1, uint param_2, undefined4 *param_3)

{
    size_t sVar1;
    int iVar2;
    char *pcVar3;
    undefined4 uVar4;
    sockaddr *psVar5;
    undefined4 uVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    undefined4 local_c4;
    addrinfo *local_c0;
    addrinfo local_bc;
    char acStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("is_ip_address.c", 0x28, 0, "host != ((void *)0)");
    }
    if (param_3 == (undefined4 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("is_ip_address.c", 0x29, 0, "addr != ((void *)0)");
    }
    *param_3 = 0;
    param_3[1] = 0;
    param_3[2] = 0;
    param_3[3] = 0;
    param_3[4] = 0;
    param_3[5] = 0;
    param_3[6] = 0;
    if (((param_2 & 0xfffd) == 0) &&
        (iVar2 = inet_pton(2, param_1, &local_c4), iVar2 == 1)) {
        *(undefined2 *)param_3 = 2;
        param_3[1] = local_c4;
        uVar4 = 1;
    } else {
        if ((param_2 == 10 || param_2 == 0) &&
            (sVar1 = strlen(param_1), sVar1 < 0x80)) {
            if (*param_1 == '[') {
                FUN_0007d4dc(acStack_9c, param_1 + 1, 0x80);
                pcVar3 = strchr(acStack_9c, 0x5d);
                if (pcVar3 != (char *)0x0) {
                    *pcVar3 = '\0';
                }
            } else {
                FUN_0007d4dc(acStack_9c, param_1, 0x80);
            }
            local_bc.ai_socktype = 0;
            local_bc.ai_protocol = 0;
            local_bc.ai_addrlen = 0;
            local_bc.ai_addr = (sockaddr *)0x0;
            local_bc.ai_canonname = (char *)0x0;
            local_bc.ai_next = (addrinfo *)0x0;
            local_bc.ai_family = 10;
            local_bc.ai_flags = 4;
            iVar2 = getaddrinfo(acStack_9c, (char *)0x0, &local_bc, &local_c0);
            if (iVar2 == 0) {
                *(undefined2 *)param_3 = 10;
                psVar5 = local_c0->ai_addr;
                uVar8 = *(undefined4 *)(psVar5[1].sa_data + 6);
                uVar4 = *(undefined4 *)(psVar5->sa_data + 10);
                uVar6 = *(undefined4 *)(psVar5 + 1);
                uVar7 = *(undefined4 *)(psVar5[1].sa_data + 2);
                param_3[2] = *(undefined4 *)(psVar5->sa_data + 6);
                param_3[3] = uVar4;
                param_3[4] = uVar6;
                param_3[5] = uVar7;
                param_3[6] = uVar8;
                freeaddrinfo(local_c0);
                uVar4 = 1;
                goto LAB_00074184;
            }
        }
        uVar4 = 0;
    }
LAB_00074184:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar4);
    }
    return;
}

void FUN_00074244(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (lib_inited == 0) {
        iVar2 = FUN_00083c50();
        ipv4_works = (uint)(iVar2 == 0);
        iVar2 = FUN_00083ca8();
        ipv6_works = (uint)(iVar2 == 0);
        FUN_0006f6e0();
        lib_inited = 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000742e4(timeval *param_1, timezone *param_2)

{
    int *piVar1;
    int iVar2;
    code *pcVar3;
    uint uVar4;
    uint uVar5;
    timespec local_34;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (0 < debug) {
        FUN_00074d28("In ntp_set_tod\n");
    }
    piVar1 = __errno_location();
    uVar4 = DAT_00117100;
    if (DAT_00117100 < 2) {
        iVar2 = param_1->tv_usec;
        local_34.tv_sec = param_1->tv_sec;
        *piVar1 = 0;
        local_34.tv_nsec = iVar2 * 1000;
        pcVar3 = (code *)clock_settime(0, &local_34);
        iVar2 = *piVar1;
        if (debug < 1) {
            if (pcVar3 != (code *)0x0 || uVar4 != 0) {
            LAB_00074580:
                if (pcVar3 != (code *)0x0)
                    goto LAB_00074354;
                goto LAB_000743e4;
            }
        } else {
            FUN_00074d28("ntp_set_tod: clock_settime: %d %m\n", pcVar3);
            uVar4 = DAT_00117100;
            if (pcVar3 != (code *)0x0 || DAT_00117100 != 0)
                goto LAB_00074580;
        }
        DAT_00117100 = 1;
    LAB_000743e4:
        *piVar1 = iVar2;
        if (0 < debug) {
            FUN_00074d28("ntp_set_tod: Final result: %s: %d %m\n",
                         *(undefined4 *)(set_tod_used + DAT_00117100 * 4), 0);
        }
    } else {
        iVar2 = 0;
        pcVar3 = (code *)0xffffffff;
    LAB_00074354:
        uVar5 = uVar4 & 0xfffffffd;
        if (uVar5 == 0) {
            local_34.tv_sec = uVar5;
            local_34.tv_nsec = uVar5;
            adjtime((timeval *)&local_34, (timeval *)0x0);
            *piVar1 = 0;
            pcVar3 = (code *)settimeofday(param_1, param_2);
            iVar2 = *piVar1;
            if (debug < 1) {
                if (pcVar3 == (code *)0x0 && uVar4 == 0) {
                LAB_00074540:
                    DAT_00117100 = 2;
                    goto LAB_000743e4;
                }
            } else {
                FUN_00074d28("ntp_set_tod: settimeofday: %d %m\n", pcVar3);
                uVar4 = DAT_00117100;
                if (pcVar3 == (code *)0x0 && DAT_00117100 == 0)
                    goto LAB_00074540;
            }
            if (pcVar3 == (code *)0x0)
                goto LAB_000743e4;
        }
        if (uVar4 != 0 && uVar4 != 3) {
            *piVar1 = iVar2;
            if (0 < debug) {
            LAB_000745c0:
                FUN_00074d28("ntp_set_tod: Final result: %s: %d %m\n",
                             *(undefined4 *)(set_tod_used + uVar4 * 4), pcVar3);
                goto LAB_000745e4;
            }
        LAB_00074378:
            *piVar1 = iVar2;
            goto LAB_0007437c;
        }
        local_34.tv_sec = param_1->tv_sec;
        *piVar1 = 0;
        pcVar3 = (code *)stime(&local_34.tv_sec);
        iVar2 = *piVar1;
        if (0 < debug) {
            FUN_00074d28("ntp_set_tod: stime: %d %m\n", pcVar3);
            uVar4 = DAT_00117100;
        }
        *piVar1 = iVar2;
        if (uVar4 == 0 && pcVar3 == (code *)0x0) {
            DAT_00117100 = 3;
            if (0 < debug) {
                FUN_00074d28("ntp_set_tod: Final result: %s: %d %m\n", "stime",
                             0);
            }
        } else {
            if (0 < debug)
                goto LAB_000745c0;
        LAB_000745e4:
            if (pcVar3 != (code *)0x0)
                goto LAB_00074378;
        }
    }
    pcVar3 = set_tod_using;
    if (set_tod_using != (code *)0x0) {
        (*set_tod_using)(*(undefined4 *)(set_tod_used + DAT_00117100 * 4));
        pcVar3 = (code *)0x0;
        set_tod_using = (code *)0x0;
    }
LAB_0007437c:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pcVar3);
    }
    return;
}

void FUN_00074648(uint param_1)

{
    int iVar1;
    undefined *__s;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    if (param_1 < 9) {
        __s = (&PTR_s_unspec_000c4bd8)[param_1];
    } else {
        __s = lib_stringbuf + lib_nextbuf * 0x80;
        uVar2 = lib_nextbuf + 1;
        memset(__s, 0, 0x80);
        lib_nextbuf = uVar2 & 0xf;
        FUN_0007c054(__s, 0x80, "mode#%zu", param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_00074708(int param_1, char *param_2, char *param_3)

{
    int iVar1;
    char *pcVar2;
    int *piVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    *param_2 = '\0';
    pcVar2 = strerror_r(param_1, param_2, (size_t)param_3);
    if (pcVar2 == (char *)0x0) {
        if (*param_2 == '\0') {
            piVar3 = __errno_location();
            FUN_0007c054(param_2, param_3, "%s(%d): errno %d", "strerror_r",
                         param_1, *piVar3);
        }
    } else {
        bVar4 = pcVar2 <= param_2;
        if (param_2 != pcVar2) {
            bVar4 = param_3 <= pcVar2;
        }
        if (bVar4 && (param_2 != pcVar2 && pcVar2 != param_3)) {
            if (iVar1 == __stack_chk_guard) {
                FUN_0007d4dc(param_2, pcVar2, param_3);
                return;
            }
            goto LAB_000747cc;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_000747cc:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000747e0(char *param_1, int param_2, char *param_3, undefined4 param_4)

{
    char cVar1;
    size_t __n;
    char *__dest;
    char acStack_124[256];
    int local_24;

    local_24 = __stack_chk_guard;
    __dest = param_1;
    while (true) {
        while (true) {
            cVar1 = *param_3;
            while (true) {
                if ((cVar1 == '\0') || (param_1 + param_2 + -1 <= __dest))
                    goto LAB_0007484c;
                if (cVar1 == '%')
                    break;
                param_3 = param_3 + 1;
                *__dest = cVar1;
                cVar1 = *param_3;
                __dest = __dest + 1;
            }
            cVar1 = param_3[1];
            param_3 = param_3 + 2;
            if (cVar1 != 'm')
                break;
            FUN_00074708(param_4, acStack_124, 0x100);
            __n = strlen(acStack_124);
            if (__dest + __n < param_1 + param_2 + -1) {
                memcpy(__dest, acStack_124, __n);
                __dest = __dest + __n;
            }
        }
        *__dest = '%';
        if (cVar1 == '\0')
            break;
        __dest[1] = cVar1;
        __dest = __dest + 2;
    }
    __dest = __dest + 1;
LAB_0007484c:
    *__dest = '\0';
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000748ec(int param_1, char *param_2)

{
    bool bVar1;
    char *pcVar2;
    size_t sVar3;
    char *pcVar4;
    int iVar5;
    FILE *__stream;
    __pid_t _Var6;
    undefined2 *puVar7;
    undefined4 local_3c;
    undefined1 local_34[4];
    undefined2 local_30[2];
    int local_2c;

    local_30[0] = 10;
    local_34[0] = 0;
    local_2c = __stack_chk_guard;
    pcVar4 = progname;
    if ((progname != DAT_00117108) &&
        (DAT_00117108 = pcVar4, pcVar2 = strrchr(progname, 0x2f),
         DAT_0011710c = pcVar4, pcVar2 != (char *)0x0)) {
        DAT_0011710c = pcVar2 + 1;
    }
    iVar5 = msyslog_term;
    if (syslogit == 0) {
        if (syslog_file == (FILE *)0x0) {
            iVar5 = 1;
            bVar1 = false;
        } else {
            bVar1 = true;
        }
    } else {
        __syslog_chk(param_1, 1, "%s", param_2);
        if (iVar5 == 0)
            goto LAB_00074aa4;
        bVar1 = false;
    }
    if (msyslog_include_timestamp == 0) {
        local_3c = 0;
    } else {
        local_3c = FUN_00088740();
    }
    if (bVar1 || msyslog_term_pid != 0) {
        _Var6 = getpid();
    } else {
        _Var6 = -1;
    }
    sVar3 = strlen(param_2);
    if (param_2[sVar3 - 1] == '\n') {
        puVar7 = (undefined2 *)local_34;
    } else {
        puVar7 = local_30;
    }
    if (iVar5 != 0) {
        __stream = stderr;
        if (3 < param_1) {
            __stream = stdout;
        }
        if (msyslog_include_timestamp != 0) {
            __fprintf_chk(__stream, 1, &DAT_0009ffa0, local_3c);
        }
        if (msyslog_term_pid != 0) {
            __fprintf_chk(__stream, 1, "%s[%d]: ", DAT_0011710c, _Var6);
        }
        __fprintf_chk(__stream, 1, "%s%s", param_2, puVar7);
        fflush(__stream);
    }
    if (bVar1) {
        if (msyslog_include_timestamp != 0) {
            __fprintf_chk(syslog_file, 1, &DAT_0009ffa0, local_3c);
        }
        __fprintf_chk(syslog_file, 1, "%s[%d]: %s%s", DAT_0011710c, _Var6,
                      param_2, puVar7);
        fflush(syslog_file);
    }
LAB_00074aa4:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00074bbc(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int *piVar1;
    undefined1 auStack_11c[256];
    int local_1c;

    local_1c = __stack_chk_guard;
    piVar1 = __errno_location();
    FUN_000747e0(auStack_11c, 0x100, param_3, *piVar1);
    FUN_0007b6f8(param_1, param_2, auStack_11c, param_4);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00074c44(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    int *piVar1;
    undefined1 auStack_11c[256];
    int local_1c;

    local_1c = __stack_chk_guard;
    piVar1 = __errno_location();
    FUN_000747e0(auStack_11c, 0x100, param_2, *piVar1);
    __vfprintf_chk(param_1, 1, auStack_11c, param_3);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00074cc4(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_8;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_8 = param_3;
    uStack_4 = param_4;
    FUN_00074c44(param_1, param_2, &uStack_8, __stack_chk_guard, &uStack_8);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00074d28(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_c;
    undefined4 uStack_8;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_c = param_2;
    uStack_8 = param_3;
    uStack_4 = param_4;
    FUN_00074c44(stdout, param_1, &uStack_c, &stdout, &uStack_c);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00074e00(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    undefined1 auStack_424[1024];
    int local_24;
    undefined4 uStack_8;
    undefined4 uStack_4;

    local_24 = __stack_chk_guard;
    uStack_8 = param_3;
    uStack_4 = param_4;
    FUN_00074bbc(auStack_424, 0x400, param_2, &uStack_8, &uStack_8);
    FUN_000748ec(param_1, auStack_424);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00074e88(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    undefined1 auStack_414[1024];
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_00074bbc(auStack_414, 0x400, param_2, param_3);
    FUN_000748ec(param_1, auStack_414);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00074efc(char *param_1, int param_2, int param_3)

{
    int iVar1;
    char *pcVar2;
    int __facility;

    iVar1 = __stack_chk_guard;
    if (param_2 != 0 && ntp_syslogmask == -1) {
        ntp_syslogmask = param_2;
    }
    pcVar2 = strrchr(param_1, 0x2f);
    if (pcVar2 != (char *)0x0) {
        param_1 = pcVar2 + 1;
    }
    progname = (char *)FUN_00073d08(param_1);
    if (param_3 == 0) {
        __facility = DAT_00117110;
        if (DAT_00117110 != 0) {
            __facility = 0x18;
        }
    } else {
        DAT_00117110 = 1;
        __facility = 0x18;
    }
    openlog(progname, 9, __facility);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    setlogmask(0xff);
    return;
}

void FUN_00074fec(char *param_1, int param_2)

{
    int iVar1;
    char *pcVar2;
    size_t sVar3;
    size_t sVar4;
    FILE *__stream;
    int iVar5;
    char *pcVar6;
    char *__buf;
    bool bVar7;
    char acStack_22d[513];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("msyslog.c", 0x1d5, 0, "fname != ((void *)0)");
    }
    if (((syslog_file != (FILE *)0x0) && (syslog_fname != (char *)0x0)) &&
        (iVar1 = strcmp(syslog_fname, param_1), iVar1 == 0))
        goto LAB_00075050;
    iVar1 = strcmp(param_1, "stderr");
    iVar5 = 0x9b8;
    if (iVar1 == 0) {
    LAB_00075284:
        __stream = (FILE *)**(undefined4 **)((int)&__DT_PLTGOT + iVar5);
        pcVar2 = (char *)FUN_00073d08(param_1);
    } else {
        iVar1 = strcmp(param_1, "stdout");
        pcVar6 = syslog_abs_fname;
        if (iVar1 == 0) {
            iVar5 = 0x968;
            goto LAB_00075284;
        }
        if (((syslog_fname == (char *)0x0) ||
             (iVar1 = strcmp(param_1, syslog_fname), iVar1 != 0)) &&
            ((bVar7 = param_1 != pcVar6, pcVar6 = param_1,
              bVar7 && (*param_1 != '/')))) {
            __buf = acStack_22d + 1;
            pcVar2 = getcwd(__buf, 0x200);
            if (pcVar2 == (char *)0x0)
                goto LAB_0007517c;
            sVar3 = strlen(__buf);
            if ((1 < sVar3) && (acStack_22d[sVar3] == '/')) {
                sVar3 = sVar3 - 1;
            }
            sVar4 = strlen(param_1);
            iVar1 = sVar4 + sVar3 + 2;
            pcVar2 = (char *)FUN_00073ba4(0, iVar1, 0);
            FUN_0007c054(pcVar2, iVar1, "%.*s%c%s", sVar3, __buf, 0x2f,
                         param_1);
        } else {
        LAB_0007517c:
            pcVar2 = (char *)FUN_00073d08(pcVar6);
        }
        if (0 < debug) {
            FUN_00074d28("attempting to open log %s\n", pcVar2);
        }
        __stream = fopen64(pcVar2, "a");
        param_1 = pcVar6;
    }
    if (__stream == (FILE *)0x0) {
        free(pcVar2);
        iVar1 = -1;
        goto LAB_00075050;
    }
    if ((param_2 != 0) && ((syslogit != 0 || (syslog_abs_fname != param_1)))) {
        FUN_00074e00(5, "switching logging to file %s", pcVar2);
    }
    if (((syslog_file != (FILE *)0x0) && (syslog_file != stderr)) &&
        (syslog_file != stdout)) {
        iVar1 = fileno(syslog_file);
        iVar5 = fileno(__stream);
        if (iVar1 != iVar5) {
            fclose(syslog_file);
        }
    }
    syslog_file = __stream;
    if (syslog_abs_fname == param_1) {
        free(pcVar2);
    } else {
        if (syslog_abs_fname == (char *)0x0) {
        LAB_00075258:
            if (syslog_fname != (char *)0x0)
                goto LAB_000752dc;
        } else {
            if (syslog_abs_fname != syslog_fname) {
                free(syslog_abs_fname);
                goto LAB_00075258;
            }
        LAB_000752dc:
            free(syslog_fname);
        }
        syslog_fname = (char *)FUN_00073d08(param_1);
        syslog_abs_fname = pcVar2;
    }
    iVar1 = 0;
    syslogit = 0;
LAB_00075050:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar1);
    }
    return;
}

void FUN_00075384(int param_1)

{
    int iVar1;
    int iVar2;
    char *pcVar3;

    iVar1 = __stack_chk_guard;
    if (syslog_fname == 0) {
        if ((param_1 != 0) && (iVar2 = FUN_00074fec(param_1, 1), iVar2 == -1)) {
            if (iVar1 == __stack_chk_guard) {
                pcVar3 = "Cannot open log file %s, %m";
                goto LAB_00075444;
            }
            goto LAB_00075450;
        }
    } else {
        iVar2 = FUN_00074fec(syslog_fname, 0);
        if (iVar2 == -1) {
            if (iVar1 == __stack_chk_guard) {
                pcVar3 = "Cannot reopen log file %s, %m";
                param_1 = syslog_fname;
            LAB_00075444:
                FUN_00074e00(3, pcVar3, param_1);
                return;
            }
            goto LAB_00075450;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00075450:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075468(undefined4 *param_1)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    int iVar5;
    undefined4 uVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    uint uVar9;
    uint uVar10;
    bool bVar11;

    iVar5 = __stack_chk_guard;
    iVar4 = DAT_00117118;
    uVar6 = param_1[1];
    uVar7 = param_1[2];
    uVar8 = param_1[3];
    iVar1 = DAT_00117118 * 0x1c;
    DAT_00117118 = DAT_00117118 + 1 & 7;
    *(undefined4 *)(&DAT_0011711c + iVar1) = *param_1;
    *(undefined4 *)(&DAT_00117120 + iVar1) = uVar6;
    *(undefined4 *)(&DAT_00117124 + iVar1) = uVar7;
    *(undefined4 *)(&DAT_00117128 + iVar1) = uVar8;
    uVar6 = param_1[5];
    uVar7 = param_1[6];
    *(undefined4 *)(&DAT_0011712c + iVar1) = param_1[4];
    *(undefined4 *)(&DAT_00117130 + iVar1) = uVar6;
    *(undefined4 *)(&DAT_00117134 + iVar1) = uVar7;
    if (*(short *)(&DAT_0011711c + iVar1) == 2) {
        uVar9 = *(uint *)(&DAT_00117120 + iVar1);
        uVar10 = uVar9 >> 0x18;
        uVar2 = uVar9 << 0x18;
        uVar3 = uVar2 | (uVar9 >> 8 & 0xff) << 0x10;
        bVar11 = (uVar2 & 0xe0000000) == 0xc0000000;
        if (bVar11) {
            uVar10 = 0;
        }
        uVar10 = uVar3 | (uVar9 >> 0x10 & 0xff) << 8 | uVar10;
        if ((!bVar11) && ((uVar2 & 0xc0000000) == 0x80000000)) {
            uVar10 = uVar3;
        }
        *(uint *)(&DAT_00117120 + iVar4 * 0x1c) =
            uVar10 << 0x18 | (uVar10 >> 8 & 0xff) << 0x10 |
            (uVar10 >> 0x10 & 0xff) << 8 | uVar10 >> 0x18;
    } else if (*(short *)(&DAT_0011711c + iVar1) == 10) {
        *(undefined4 *)(&DAT_0011712c + iVar1) = 0;
        *(undefined4 *)(&DAT_00117130 + iVar1) = 0;
    }
    if (iVar5 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(&DAT_0011711c + iVar1);
    }
    return;
}

void FUN_0007568c(undefined2 *param_1)

{
    int iVar1;
    char *pcVar2;
    char *pcVar3;
    undefined1 local_32[2];
    undefined1 local_30[2];
    undefined1 local_2e[2];
    undefined1 local_2c[2];
    undefined2 local_2a;
    char acStack_28[4];
    int local_24;

    *(undefined4 *)(param_1 + 3) = 0;
    local_24 = __stack_chk_guard;
    *(undefined4 *)(param_1 + 1) = 0;
    param_1[2] = 0x101;
    *param_1 = 0x7b2;
    iVar1 = sscanf("07:21:24/Sep  6 2023", "%hu:%hu:%hu/%3s %hu %hu", local_32,
                   local_30, local_2e, acStack_28, local_2c, &local_2a);
    if (iVar1 == 6) {
        pcVar2 = strstr("JanFebMarAprMayJunJulAugSepOctNovDec", acStack_28);
        if (pcVar2 != (char *)0x0) {
            pcVar3 = pcVar2 + -0xab2ac;
            *(undefined1 *)(param_1 + 3) = local_32[0];
            *param_1 = local_2a;
            pcVar2 = (char *)0x1;
            *(undefined1 *)((int)param_1 + 5) = local_2c[0];
            *(undefined1 *)((int)param_1 + 7) = local_30[0];
            *(char *)(param_1 + 2) =
                ((char)((ulonglong)((longlong)(int)pcVar3 * 0x55555556) >>
                        0x20) -
                 (char)((int)pcVar3 >> 0x1f)) +
                '\x01';
            *(undefined1 *)(param_1 + 4) = local_2e[0];
        }
    } else {
        pcVar2 = (char *)0x0;
    }
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pcVar2);
    }
    return;
}

void FUN_000757a8(int param_1, int param_2, int param_3)

{
    bool bVar1;
    int iVar2;
    int extraout_r1;
    int iVar3;
    bool bVar4;

    iVar2 = __stack_chk_guard;
    bVar4 = param_3 < 0;
    if (bVar4) {
        param_3 = -param_3;
    }
    if (1 < param_3) {
        if (param_2 < param_1) {
            param_2 = param_1 - param_2;
            bVar1 = !bVar4;
        } else {
            param_2 = param_2 - param_1;
            bVar1 = bVar4;
        }
        FUN_0009b8ec(param_2, param_3);
        if (extraout_r1 != 0) {
            iVar3 = extraout_r1;
            if (bVar1) {
                iVar3 = param_3 - extraout_r1;
            }
            if (bVar4) {
                iVar3 = -iVar3;
            }
            param_1 = param_1 + iVar3;
        }
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_00075844(int *param_1, int param_2, uint *param_3)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;

    iVar1 = __stack_chk_guard;
    if (param_3 == (uint *)0x0) {
        uVar3 = (*DAT_000c7ce8)(0);
    } else {
        uVar3 = *param_3;
    }
    iVar2 = __stack_chk_guard;
    uVar5 = uVar3 + 0x80000000;
    uVar4 = (param_2 + 0x7c558180) - uVar5;
    *param_1 = uVar5 + uVar4;
    param_1[1] = (((int)uVar3 >> 0x1f) - (uint)(uVar3 < 0x80000000)) +
                 (uint)CARRY4(uVar5, uVar4);
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_000758e8(int *param_1, int param_2, uint *param_3)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    if (param_3 == (uint *)0x0) {
        uVar2 = (*DAT_000c7ce8)(0);
    } else {
        uVar2 = *param_3;
    }
    uVar3 = uVar2 + 0x3aa7e80;
    bVar4 = iVar1 == __stack_chk_guard;
    *param_1 = uVar3 + (param_2 - uVar3);
    param_1[1] = ((int)uVar2 >> 0x1f) + (uint)(0xfc55817f < uVar2) +
                 (uint)CARRY4(uVar3, param_2 - uVar3);
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0007598c(uint *param_1, uint *param_2)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    uVar3 = param_2[1];
    if ((int)uVar3 < 0) {
        uVar3 = FUN_0009bfd0(~*param_2, ~uVar3, "comp", 0);
        uVar3 = ~uVar3;
    } else {
        uVar3 = FUN_0009bfd0(*param_2, uVar3, "comp", 0);
    }
    iVar2 = __stack_chk_guard;
    uVar4 = *param_2;
    *param_1 = uVar3;
    param_1[1] = uVar4 + uVar3 * -0x15180;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_00075a30(int *param_1, uint param_2, uint *param_3)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;
    uint uVar7;

    iVar1 = __stack_chk_guard;
    uVar7 = (int)param_2 >> 0x1f;
    if (0x3fffffff < (param_2 ^ uVar7)) {
        piVar3 = __errno_location();
        param_2 = ~uVar7;
        *piVar3 = 0x21;
    }
    uVar5 = param_2 << 2 | 3;
    uVar7 = uVar7 ^ (uVar5 ^ uVar7) / 0x23ab1;
    uVar6 = uVar5 + uVar7 * -0x23ab1 | 3;
    uVar5 = uVar6 / 0x5b5;
    if (param_3 != (uint *)0x0) {
        if ((uVar5 + 1 & 3) == 0) {
            if (uVar5 == 99) {
                uVar4 = (uint)((uVar7 + 1 & 3) == 0);
            } else {
                uVar4 = 1;
            }
        } else {
            uVar4 = 0;
        }
        *param_3 = uVar4;
    }
    iVar2 = __stack_chk_guard;
    *param_1 = uVar7 * 100 + uVar5;
    param_1[1] = uVar6 % 0x5b5 >> 2;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_1);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00075be4) */

void FUN_00075b3c(int *param_1, int param_2, int param_3)

{
    int iVar1;
    int iVar2;
    int iVar3;

    if (-1 < param_2) {
        if (param_3 == 0) {
            iVar1 = 0;
        } else {
            iVar1 = 0x1a;
        }
        if (param_2 < (int)(uint) * (ushort *)((int)&DAT_000ab2ec + iVar1)) {
            iVar3 = (param_2 >> 5) + 1;
            iVar2 = iVar3 * 2;
            if (param_2 <
                (int)(uint) * (ushort *)(&DAT_000ab2d4 + iVar2 + iVar1)) {
                iVar2 = iVar2 + -2;
                iVar3 = param_2 >> 5;
            }
            param_2 =
                param_2 - (uint) * (ushort *)(&DAT_000ab2d4 + iVar2 + iVar1);
            goto LAB_00075bc0;
        }
    }
    param_2 = -1;
    iVar3 = -1;
LAB_00075bc0:
    *param_1 = iVar3;
    param_1[1] = param_2;
    return;
}

void FUN_00075bf4(ushort *param_1, int param_2)

{
    char cVar1;
    int iVar2;
    undefined4 local_28;
    int local_24;
    undefined4 local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    cVar1 = (char)(param_2 % 7);
    if (6 < (param_2 % 7 & 0xffU)) {
        cVar1 = cVar1 + '\a';
    }
    *(char *)((int)param_1 + 9) = cVar1;
    FUN_00075a30(&local_24, param_2 + -1, &local_28);
    if (local_24 + 1U >> 0x10 == 0) {
        iVar2 = -1;
    } else {
        iVar2 = 0;
    }
    param_1[1] = (short)local_20 + 1;
    *param_1 = (ushort)(local_24 + 1U) & (ushort)iVar2;
    FUN_00075b3c(&local_24, local_20, local_28);
    if (iVar2 == 0) {
        local_28 = 0xffffffff;
    }
    *(char *)((int)param_1 + 5) = (char)local_20 + '\x01';
    *(char *)(param_1 + 2) = (char)local_24 + '\x01';
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_28);
}

void FUN_00075cd8(int param_1, int param_2)

{
    int iVar1;
    bool bVar2;
    undefined4 local_28;
    int local_24;
    int local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = param_2 % 7;
    if (iVar1 < 0) {
        iVar1 = iVar1 + 7;
    }
    *(int *)(param_1 + 0x18) = iVar1;
    FUN_00075a30(&local_24, param_2 + -1, &local_28);
    *(int *)(param_1 + 0x1c) = local_20;
    *(int *)(param_1 + 0x14) = local_24 + -0x76b;
    FUN_00075b3c(&local_24, local_20, local_28);
    bVar2 = local_1c == __stack_chk_guard;
    *(int *)(param_1 + 0x10) = local_24;
    *(int *)(param_1 + 0xc) = local_20 + 1;
    if (bVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_28);
}

/* WARNING: Removing unreachable block (ram,0x00075e34) */

void FUN_00075d94(int param_1, uint param_2)

{
    byte bVar1;
    byte bVar2;
    byte bVar3;
    uint uVar4;

    uVar4 = (int)param_2 >> 0x1f ^ param_2;
    bVar3 = (byte)((int)param_2 >> 0x1f);
    bVar1 = bVar3 ^ (byte)(uVar4 / 0xe10);
    bVar2 = bVar3 ^ (byte)(uVar4 / 0x3c);
    *(byte *)(param_1 + 6) = bVar1 + (bVar3 ^ (byte)(uVar4 / 0x15180)) * -0x18;
    *(byte *)(param_1 + 7) = bVar2 + bVar1 * -0x3c;
    *(byte *)(param_1 + 8) = (char)param_2 + bVar2 * -0x3c;
    return;
}

void FUN_00075ee8(undefined4 param_1, int *param_2, int param_3)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00075d94(param_1, param_2[1]);
    if (iVar1 == __stack_chk_guard) {
        FUN_00075bf4(param_1, iVar2 + param_3 + *param_2);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00075fc0(undefined4 param_1)

{
    int iVar1;
    int local_1c;
    undefined4 local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_0007598c(&local_1c);
    iVar1 = FUN_00075d94(param_1, local_18);
    if (local_14 == __stack_chk_guard) {
        FUN_00075bf4(
            param_1,
            "The genshellopt library is free software; you can redistribute it "
            "and/or\nmodify it under the terms of the GNU Library General "
            "Public License as\npublished by the Free Software Foundation; "
            "either version 2 of the License,\nor (at your option) any later "
            "version.\n\nThis library is distributed in the hope that it will "
            "be useful, but WITHOUT\nANY WARRANTY; without even the implied "
            "warranty of MERCHANTABILITY or\nFITNESS FOR A PARTICULAR PURPOSE. "
            " See the GNU Library General Public\nLicense for more "
            "details.\n\nYou should have received a copy of the GNU Library "
            "General Public License\nalong with this library; if not, "
            "see\n<http://www.gnu.org/licenses/old-licenses/lgpl-2.0.html>\n" +
                iVar1 + local_1c + 0x136);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00076084) */

void FUN_00076038(longlong *param_1, int param_2, int param_3)

{
    *param_1 = (longlong)param_2 * 0x15180 + (longlong)param_3;
    return;
}

/* WARNING: Removing unreachable block (ram,0x000760e8) */

void FUN_00076090(void)

{
    return;
}

void FUN_000760f4(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00076090();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1 * 0x16d + iVar2);
}

void FUN_00076148(uint *param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    bool bVar5;
    bool bVar6;

    iVar1 = __stack_chk_guard;
    uVar3 = param_2 + 10;
    bVar6 = SBORROW4(uVar3, 0xb);
    bVar5 = uVar3 != 0xb;
    if (0xb < (int)uVar3) {
        uVar3 = param_2 - 2;
    }
    uVar4 = (uint)(bVar5 && param_2 + -1 < 0 == bVar6);
    if (0xb < uVar3) {
        uVar2 = (int)uVar3 >> 0x1f ^ (uVar3 ^ (int)uVar3 >> 0x1f) / 0xc;
        uVar4 = uVar4 + uVar2;
        uVar3 = uVar3 + uVar2 * -0xc;
    }
    *param_1 = uVar4;
    bVar5 = iVar1 != __stack_chk_guard;
    param_1[1] = *(ushort *)(&DAT_000ab308 + uVar3 * 2) - 0x132;
    if (bVar5) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(param_1);
    }
    return;
}

void FUN_000761f8(int param_1, int param_2, int param_3)

{
    int iVar1;
    int local_1c;
    int local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_2 == 0) {
        iVar1 = FUN_000760f4();
    } else {
        FUN_00076148(&local_1c);
        iVar1 = FUN_000760f4(param_1 + local_1c);
        iVar1 = iVar1 + local_18;
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1 + param_3);
}

void FUN_00076274(int param_1, uint param_2, int param_3)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    int iStack_24;
    int iStack_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_2 < 0xc) {
        uVar1 = param_1 + 1;
        if ((uVar1 & 3) == 0) {
            if ((int)uVar1 % 100 == 0) {
                uVar1 = (uint)((int)uVar1 % 400 == 0);
            } else {
                uVar1 = 1;
            }
        } else {
            uVar1 = 0;
        }
        uVar1 =
            (uint) * (ushort *)(&DAT_000ab2d4 + (uVar1 * 0xd + param_2) * 2);
    } else {
        FUN_00076148(&iStack_24);
        iVar2 = FUN_000760f4(param_1 + iStack_24);
        iVar3 = FUN_000760f4(param_1);
        uVar1 = (iStack_20 + iVar2) - iVar3;
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1 + param_3);
}

/* WARNING: Removing unreachable block (ram,0x000763b4) */

void FUN_0007636c(void)

{
    return;
}

int FUN_000763c0(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_000761f8(*(int *)(param_1 + 0x14) + 0x76b,
                         *(undefined4 *)(param_1 + 0x10),
                         *(int *)(param_1 + 0xc) + -1);
    if (iVar1 == __stack_chk_guard) {
        return iVar2 + 1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

int FUN_00076428(ushort *param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_000761f8(*param_1 - 1, (byte)param_1[2] - 1,
                         *(byte *)((int)param_1 + 5) - 1);
    if (iVar1 == __stack_chk_guard) {
        return iVar2 + 1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

int FUN_0007648c(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_000760f4(param_1 + -1);
    if (iVar1 == __stack_chk_guard) {
        return iVar2 + 1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x000765f8) */

void FUN_000765b0(int param_1)

{
    FUN_0007636c(*(undefined1 *)(param_1 + 6), *(undefined1 *)(param_1 + 7),
                 *(undefined1 *)(param_1 + 8));
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007664c) */

void FUN_00076604(undefined4 *param_1)

{
    FUN_0007636c(param_1[2], param_1[1], *param_1);
    return;
}

void FUN_000766d8(undefined4 param_1)

{
    int iVar1;
    int local_1c;
    undefined4 local_18;
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_0007598c(&local_1c);
    iVar1 = FUN_00075d94(param_1, local_18);
    if (local_14 == __stack_chk_guard) {
        FUN_00075bf4(param_1,
                     "Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m" +
                         iVar1 + local_1c + 0x1c);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00076750(undefined4 param_1)

{
    undefined4 local_28;
    undefined4 uStack_24;
    undefined4 local_20;
    undefined4 uStack_1c;
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_000758e8(&local_28);
    local_20 = local_28;
    uStack_1c = uStack_24;
    FUN_000766d8(param_1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

undefined4 FUN_000767b4(undefined4 param_1, undefined4 param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00076428(param_2);
    uVar3 = FUN_000765b0(param_2);
    FUN_00076038(param_1, iVar2 + -0xa955c, uVar3);
    if (iVar1 == __stack_chk_guard) {
        return param_1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00076830(undefined4 param_1)

{
    undefined4 local_18[3];
    int local_c;

    local_c = __stack_chk_guard;
    FUN_000767b4(local_18, param_1);
    if (local_c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_18[0]);
}

/* WARNING: Removing unreachable block (ram,0x00076914) */

void FUN_000768d4(undefined4 param_1, undefined4 param_2)

{
    FUN_000757a8(param_1, param_2, 7);
    return;
}

/* WARNING: Removing unreachable block (ram,0x00076a9c) */

void FUN_00076a0c(void)

{
    return;
}

void FUN_00076aac(int *param_1, uint param_2)

{
    int iVar1;
    int *piVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    bool bVar6;

    iVar1 = __stack_chk_guard;
    uVar5 = (int)param_2 >> 0x1f;
    if (0x3fffffff < (param_2 ^ uVar5)) {
        param_2 = ~uVar5;
        piVar2 = __errno_location();
        *piVar2 = 0x21;
    }
    uVar3 = param_2 * 4 + 2;
    uVar5 = uVar5 ^ (uVar3 ^ uVar5) / 0x5187;
    uVar4 = (uVar3 + uVar5 * -0x5187 >> 2) * 0x9d +
            (uint) * (ushort *)(&DAT_000ab32c + (uVar5 & 3) * 2);
    bVar6 = iVar1 == __stack_chk_guard;
    uVar3 = uVar4 & 0x1fff;
    *param_1 = uVar5 * 100 + (uVar4 >> 0xd);
    param_1[1] = uVar3 / 0x9d;
    if (bVar6) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1, 100, uVar3 * 0x342da7f3);
}

void FUN_00076b90(short *param_1)

{
    byte bVar1;
    byte bVar2;
    int iVar3;
    char *pcVar4;
    uint uVar5;
    uint uVar6;
    uint local_34;
    uint local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    FUN_0007598c(&local_34);
    uVar5 = (int)local_30 >> 0x1f ^ local_30;
    uVar6 = (int)local_30 >> 0x1f ^ uVar5 / 0x15180;
    pcVar4 = "Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m" + uVar6 +
             local_34 + 0x1b;
    bVar2 = (byte)((int)local_30 >> 0x1f);
    bVar1 = bVar2 ^ (byte)(uVar5 / 0xe10);
    bVar2 = bVar2 ^ (byte)(uVar5 / 0x3c);
    *(byte *)(param_1 + 2) = bVar1 + (char)uVar6 * -0x18;
    *(byte *)((int)param_1 + 5) = bVar2 + bVar1 * -0x3c;
    *(byte *)(param_1 + 3) = (char)local_30 + bVar2 * -0x3c;
    *(byte *)((int)param_1 + 3) =
        (char)pcVar4 +
        ((byte)((int)pcVar4 >> 0x1f) ^
         (byte)(((uint)pcVar4 ^ (int)pcVar4 >> 0x1f) / 7)) *
            -7 +
        '\x01';
    FUN_00076aac(&local_34);
    *(char *)(param_1 + 1) = (char)local_30 + '\x01';
    iVar3 = __stack_chk_guard;
    *param_1 = (short)local_34 + 1;
    if (local_2c != iVar3) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(local_34 < 0xffff);
    }
    return;
}

void FUN_00076cc4(undefined4 param_1)

{
    undefined4 local_28;
    undefined4 uStack_24;
    undefined4 local_20;
    undefined4 uStack_1c;
    int local_14;

    local_14 = __stack_chk_guard;
    FUN_000758e8(&local_28);
    local_20 = local_28;
    uStack_1c = uStack_24;
    FUN_00076b90(param_1);
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

undefined4 FUN_00076d28(undefined4 param_1, ushort *param_2)

{
    byte bVar1;
    ushort uVar2;
    int iVar3;
    int iVar4;
    undefined4 uVar5;

    iVar3 = __stack_chk_guard;
    iVar4 = FUN_00076a0c(*param_2 - 1);
    uVar2 = param_2[1];
    bVar1 = *(byte *)((int)param_2 + 3);
    uVar5 = FUN_0007636c((char)param_2[2], *(undefined1 *)((int)param_2 + 5),
                         (char)param_2[3]);
    FUN_00076038(param_1,
                 ((uint)(byte)uVar2 + iVar4 + -1) * 7 + (uint)bVar1 + -0xa955c,
                 uVar5);
    if (iVar3 == __stack_chk_guard) {
        return param_1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00076dc4(undefined4 param_1)

{
    undefined4 local_18[3];
    int local_c;

    local_c = __stack_chk_guard;
    FUN_00076d28(local_18, param_1);
    if (local_c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_18[0]);
}

void FUN_00076e18(void)

{
    int iVar1;
    undefined1 auStack_20[5];
    char local_1b;
    int local_14;

    local_14 = __stack_chk_guard;
    iVar1 = FUN_0007568c(auStack_20);
    if (iVar1 == 0) {
        iVar1 = 0x63df;
    } else {
        local_1b = local_1b + -1;
        iVar1 = FUN_00076428(auStack_20);
        iVar1 = iVar1 + -0xa955c;
        if (iVar1 < 0x63df) {
            iVar1 = 0x63df;
        }
    }
    if (local_14 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar1);
    }
    return;
}

void FUN_00076ea4(char *param_1)

{
    size_t sVar1;
    int iVar2;
    ushort *puVar3;
    size_t *psVar4;
    ushort local_2a;
    short local_28;
    ushort local_26;
    int local_24;
    size_t local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    sVar1 = strlen(param_1);
    puVar3 = &local_26;
    psVar4 = &local_20;
    iVar2 = sscanf(param_1, "%4hu-%2hu-%2hu%n", &local_2a, &local_28, puVar3,
                   &local_20);
    if ((iVar2 == 3) && (local_20 == sVar1)) {
        if (((ushort)(local_28 - 1U) < 0xc) && (local_26 - 1 < 0x1f)) {
            local_24 = FUN_000761f8(local_2a - 1);
            local_24 = local_24 + -0xa955c;
            goto LAB_00076f48;
        }
    } else {
        iVar2 = sscanf(param_1, "%lu%n", &local_24, &local_20, puVar3, psVar4);
        if ((iVar2 == 1) && ((local_20 == sVar1 && (-1 < local_24))))
            goto LAB_00076f48;
    }
    FUN_00074e00(4, "basedate string \"%s\" invalid, build date substituted!",
                 param_1);
    local_24 = FUN_00076e18();
LAB_00076f48:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(local_24);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007701c) */

void FUN_00076fd8(void)

{
    return;
}

void FUN_0007702c(int param_1)

{
    undefined4 uVar1;
    int iVar2;
    char *pcVar3;
    undefined2 local_30[2];
    undefined1 local_2c;
    undefined1 local_2b;
    int local_24;

    local_24 = __stack_chk_guard;
    if (param_1 < 0x63df) {
        pcVar3 =
            "ll be useful, but WITHOUT\nANY WARRANTY; without even the implied "
            "warranty of MERCHANTABILITY or\nFITNESS FOR A PARTICULAR PURPOSE. "
            " See the GNU Library General Public\nLicense for more "
            "details.\n\nYou should have received a copy of the GNU Library "
            "General Public License\nalong with this library; if not, "
            "see\n<http://www.gnu.org/licenses/old-licenses/lgpl-2.0.html>\n";
        FUN_00074e00(
            4, "baseday_set_day: invalid day (%lu), UNIX epoch substituted");
        param_1 = 0x63df;
    } else {
        pcVar3 =
            "Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m" + param_1 + 0x1c;
    }
    uVar1 = DAT_000c7ce4;
    DAT_000c7ce4 = param_1;
    FUN_00075bf4(local_30, pcVar3);
    FUN_00074e00(6, "basedate set to %04hu-%02hu-%02hu", local_30[0], local_2c,
                 local_2b);
    iVar2 = FUN_000768d4(pcVar3, 0);
    iVar2 = iVar2 + -0xa955c;
    if (iVar2 < 0x7227) {
        iVar2 = 0x7227;
    }
    DAT_001171fc = (iVar2 + -0x7227) / 7;
    FUN_00075bf4(local_30, "Palisade(%d) HW_poll: ioctl(fd, SET, RTS_on): %m" +
                               iVar2 + 0x1c);
    FUN_00074e00(6, "gps base set to %04hu-%02hu-%02hu (week %d)", local_30[0],
                 local_2c, local_2b, DAT_001171fc);
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar1);
}

void FUN_00077318(void)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;
    uint uVar5;
    undefined4 *puVar6;

    iVar2 = __stack_chk_guard;
    uVar4 = 0;
    while (true) {
        while (dnschild_contexts_alloc <= uVar4) {
            uVar5 = dnschild_contexts_alloc + 0x14;
            iVar1 = uVar5 * 4;
            dnschild_contexts =
                FUN_00073ba4(dnschild_contexts, iVar1, iVar1 + -0x50, 1);
            dnschild_contexts_alloc = uVar5;
        }
        puVar6 = (undefined4 *)(dnschild_contexts + uVar4 * 4);
        if (*(int *)(dnschild_contexts + uVar4 * 4) == 0)
            break;
        uVar4 = uVar4 + 1;
    }
    uVar3 = FUN_00073ba4(0, 8, 0, 1);
    *puVar6 = uVar3;
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_000773dc(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (worker_per_query != 0) {
        FUN_00077318();
        return;
    }
    if (DAT_000c7cec == -1) {
        DAT_000c7cec = FUN_00077318();
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00077478(undefined4 param_1, uint param_2)

{
    int iVar1;
    int iVar2;
    undefined4 *puVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    FUN_0007e2cc(1);
    if (param_2 < dnsworker_contexts_alloc) {
        puVar3 = *(undefined4 **)(dnsworker_contexts + param_2 * 4);
        if (puVar3 == (undefined4 *)0x0) {
            puVar3 = (undefined4 *)FUN_00073ba4(0, 0xc, 0, 1);
            *(undefined4 **)(dnsworker_contexts + param_2 * 4) = puVar3;
        }
    } else {
        uVar4 = param_2 + 5 & 0xfffffffc;
        dnsworker_contexts = FUN_00073ba4(dnsworker_contexts, uVar4 << 2,
                                          dnsworker_contexts_alloc << 2, 1);
        dnsworker_contexts_alloc = uVar4;
        puVar3 = (undefined4 *)FUN_00073ba4(0, 0xc, 0, 1);
        *(undefined4 **)(dnsworker_contexts + param_2 * 4) = puVar3;
    }
    FUN_0007e2cc(0);
    puVar3[1] = 0;
    iVar2 = __stack_chk_guard;
    puVar3[2] = 0;
    *puVar3 = param_1;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(puVar3);
}

void FUN_00077590(int param_1)

{
    int iVar1;
    int iVar2;
    char *pcVar3;
    undefined *puVar4;
    bool bVar5;

    iVar2 = __stack_chk_guard;
    iVar1 = DAT_00117200;
    switch (param_1) {
    case -0xb:
        if (debug < 2) {
        LAB_00077700:
            bVar5 = true;
            goto LAB_000776e4;
        }
        bVar5 = true;
        pcVar3 = gai_strerror(-0xb);
        puVar4 = &DAT_000a7f7c;
        goto LAB_000776d4;
    case -10:
        break;
    case -9:
        break;
    case -8:
        break;
    case -7:
        break;
    case -6:
        break;
    case -5:
        goto LAB_0007761c;
    case -4:
        if (debug < 2)
            goto LAB_00077700;
        bVar5 = true;
        pcVar3 = gai_strerror(-4);
        puVar4 = &DAT_000a7f7c;
        goto LAB_000776d4;
    case -3:
        bVar5 = true;
        DAT_00117200 = 1;
        if (debug < 2)
            goto LAB_00077700;
        pcVar3 = gai_strerror(-3);
        puVar4 = &DAT_000a7f7c;
        goto LAB_000776d4;
    case -2:
    LAB_0007761c:
        if (debug < 2) {
            bVar5 = DAT_00117200 == 0;
            goto LAB_000776e4;
        }
        pcVar3 = gai_strerror(param_1);
        if (iVar1 == 0) {
            bVar5 = true;
            puVar4 = &DAT_000a7f7c;
        } else {
            bVar5 = false;
            puVar4 = &DAT_000ab42c;
        }
        goto LAB_000776d4;
    }
    if (debug < 2) {
        bVar5 = false;
    } else {
        bVar5 = false;
        pcVar3 = gai_strerror(param_1);
        puVar4 = &DAT_000ab42c;
    LAB_000776d4:
        FUN_00074d28("intres: resolver returned: %s (%d), %sretrying\n", pcVar3,
                     param_1, puVar4);
    }
LAB_000776e4:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(bVar5);
}

void FUN_0007774c(undefined4 param_1, undefined4 *param_2, undefined4 param_3,
                  int param_4)

{
    uint uVar1;
    int iVar2;
    int iVar3;
    time_t tVar4;
    undefined4 uVar5;
    char *pcVar6;
    int *piVar7;
    int iVar8;
    int iVar9;
    int iVar10;
    uint uVar11;
    int iVar12;
    undefined4 *puVar13;
    undefined4 uVar14;
    undefined *puVar15;
    uint uVar16;
    int iVar17;
    int iVar18;

    iVar2 = __stack_chk_guard;
    puVar13 = param_2 + 0x12;
    iVar3 = *(int *)(param_4 + 4);
    iVar12 = param_2[0x10];
    iVar17 = *(int *)(dnschild_contexts + param_2[1] * 4);
    if (iVar3 == 0) {
        if (2 < *(int *)(param_4 + 8)) {
            tVar4 = time((time_t *)0x0);
            *(time_t *)(iVar17 + 4) = tVar4;
            if (0 < debug) {
                uVar14 = param_2[1];
                uVar5 = FUN_00088840();
                FUN_00074d28("DNS success after retry, %u next_dns_timeslot "
                             "reset (%s)\n",
                             uVar14, uVar5);
            }
        }
    } else {
        uVar16 = param_2[0xd];
        if ((uVar16 & 1) == 0) {
            iVar3 = FUN_00077590();
            if ((iVar3 != 0) && (0 < (int)param_2[4])) {
                if ((param_2[4] != 2) || ((ntp_syslogmask & 1) == 0)) {
                    iVar3 = time((time_t *)0x0);
                    iVar8 = param_2[4];
                    uVar16 = 0x40;
                    goto LAB_000778a4;
                }
                iVar3 = *(int *)(param_4 + 4);
            LAB_0007799c:
                if (param_2[6] == 10) {
                    puVar15 = &UNK_000ab464;
                } else if (param_2[6] == 2) {
                    puVar15 = &UNK_000ab46c;
                } else {
                    puVar15 = &DAT_000a7f7c;
                }
                if (iVar3 == -0xb) {
                    piVar7 = __errno_location();
                    *piVar7 = *(int *)(param_4 + 0xc);
                    FUN_00074e00(6, "retrying DNS %s%s: EAI_SYSTEM %d: %m",
                                 puVar13, puVar15,
                                 *(undefined4 *)(param_4 + 0xc));
                } else {
                    pcVar6 = gai_strerror(iVar3);
                    FUN_00074e00(6, "retrying DNS %s%s: %s (%d)", puVar13,
                                 puVar15, pcVar6, *(undefined4 *)(param_4 + 4));
                }
                iVar3 = time((time_t *)0x0);
                iVar8 = param_2[4];
                iVar18 = iVar3 + iVar8;
                if (iVar3 + iVar8 < *(int *)(iVar17 + 4)) {
                    iVar18 = *(int *)(iVar17 + 4);
                }
                if ((uVar16 & 1) == 0) {
                    uVar16 = 0x40;
                } else {
                    uVar16 = 0x400;
                }
                *(int *)(iVar17 + 4) = iVar18;
                goto LAB_000778b8;
            }
        } else if (0 < (int)param_2[4]) {
            if ((param_2[4] == 2) && ((ntp_syslogmask & 1) != 0))
                goto LAB_0007799c;
            iVar3 = time((time_t *)0x0);
            iVar8 = param_2[4];
            uVar16 = 0x400;
        LAB_000778a4:
            iVar18 = iVar3 + iVar8;
            if (iVar3 + iVar8 < *(int *)(iVar17 + 4)) {
                iVar18 = *(int *)(iVar17 + 4);
            }
            *(int *)(iVar17 + 4) = iVar18;
        LAB_000778b8:
            uVar1 = iVar8 * 2;
            param_2[2] = iVar3;
            param_2[3] = iVar18;
            uVar11 = uVar1 - 1 & uVar1;
            if (uVar11 == 0) {
                uVar11 = uVar1 - ((int)uVar1 >> 2);
            }
            if ((int)uVar16 <= (int)uVar11) {
                uVar11 = uVar16;
            }
            param_2[4] = uVar11;
            iVar3 = FUN_00079188(1, param_2, *param_2, FUN_0007774c, param_2);
            if (iVar3 == 0) {
                if (iVar2 == __stack_chk_guard) {
                    return;
                }
                goto LAB_00077aa8;
            }
            FUN_00074e00(3, "unable to retry hostname %s", puVar13);
        }
    }
    iVar3 = *(int *)(param_4 + 0x10);
    iVar17 = param_4 + 0x14;
    if (-1 < iVar3 + -1) {
        iVar8 = 0;
        iVar18 = param_4 + (iVar3 + -1) * 0x20 + 0x14;
        do {
            *(int *)(iVar18 + 0x1c) = iVar8;
            iVar9 = iVar18 + -0x20;
            iVar8 = iVar18;
            iVar18 = iVar9;
        } while (param_4 + -0xc != iVar9);
    }
    iVar8 = iVar17 + iVar3 * 0x20;
    iVar18 = iVar8 + iVar3 * 0x1c;
    if (iVar3 < 1) {
        if (iVar8 != iVar18) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_intres.c", 0x24d, 1,
                         "(char *)psau == canon_start");
        }
        if (iVar3 == 0) {
            iVar17 = 0;
        }
    } else {
        iVar9 = param_4;
        do {
            iVar10 = iVar9 + 0x20;
            if (*(int *)(iVar9 + 0x28) != 0) {
                *(int *)(iVar9 + 0x28) = iVar8;
            }
            iVar8 = iVar8 + 0x1c;
            if (*(int *)(iVar9 + 0x2c) != 0) {
                *(int *)(iVar9 + 0x2c) = *(int *)(iVar9 + 0x2c) + iVar18;
            }
            iVar9 = iVar10;
        } while (iVar3 * 0x20 + param_4 != iVar10);
    }
    (*(code *)param_2[0xe])(
        *(undefined4 *)(param_4 + 4), *(undefined4 *)(param_4 + 0xc),
        param_2[0xf], puVar13, (int)puVar13 + iVar12, param_2 + 5, iVar17);
    if (iVar2 == __stack_chk_guard) {
        free(param_2);
        return;
    }
LAB_00077aa8:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00077b04(int param_1, int param_2, undefined4 *param_3)

{
    int iVar1;
    undefined4 uVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    time_t tVar5;
    int iVar6;

    iVar1 = __stack_chk_guard;
    if (param_1 < (int)param_3[1]) {
        if (0 < debug) {
            uVar2 = FUN_00088840(param_2);
            uVar3 = FUN_00088840(param_1);
            uVar4 = FUN_00088840(param_3[1]);
            if (iVar1 == __stack_chk_guard) {
                FUN_00074d28(
                    "ignoring sleep until %s scheduled at %s (before %s)\n",
                    uVar2, uVar3, uVar4);
                return;
            }
            goto LAB_00077c88;
        }
    } else {
        tVar5 = time((time_t *)0x0);
        if (tVar5 < param_2) {
            if (0 < debug) {
                uVar2 = FUN_00088840(param_2);
                uVar3 = FUN_00088840(param_1);
                uVar4 = FUN_00088840(param_3[1]);
                FUN_00074d28("sleep until %s scheduled at %s (>= %s)\n", uVar2,
                             uVar3, uVar4);
            }
            iVar6 = FUN_0007e3c8(*param_3, param_2 - tVar5);
            if (iVar6 == -1) {
                tVar5 = time((time_t *)0x0);
                DAT_00117204 = tVar5 + 0x3c;
                param_3[1] = tVar5;
                param_3[2] = DAT_00117204;
                __res_init();
                if (0 < debug) {
                    uVar2 = FUN_00088840(param_3[1]);
                    if (iVar1 == __stack_chk_guard) {
                        FUN_00074d28("sleep interrupted by daemon, ignoring "
                                     "sleeps scheduled before now (%s)\n",
                                     uVar2);
                        return;
                    }
                    goto LAB_00077c88;
                }
            }
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_00077c88:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00077ca8(int *param_1)

{
    int iVar1;
    int iVar2;
    time_t tVar3;

    iVar2 = __stack_chk_guard;
    tVar3 = time((time_t *)0x0);
    iVar1 = DAT_00117204;
    *param_1 = DAT_00117204;
    if (iVar1 <= tVar3) {
        if (iVar1 != 0) {
            __res_init();
        }
        DAT_00117204 = tVar3 + 0x3c;
        *param_1 = DAT_00117204;
    }
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00077d40(undefined4 param_1, undefined4 *param_2, undefined4 param_3,
                  int param_4)

{
    uint uVar1;
    int iVar2;
    time_t tVar3;
    undefined4 uVar4;
    uint uVar5;
    uint uVar6;
    uint uVar7;
    undefined4 uVar8;
    int iVar9;
    int iVar10;

    iVar2 = __stack_chk_guard;
    iVar9 = *(int *)(dnschild_contexts + param_2[1] * 4);
    if (*(int *)(param_4 + 4) == 0) {
        uVar4 = 0;
        if (2 < *(int *)(param_4 + 0xc)) {
            tVar3 = time((time_t *)0x0);
            *(time_t *)(iVar9 + 4) = tVar3;
            if (debug < 1) {
            LAB_00077e20:
                uVar4 = *(undefined4 *)(param_4 + 4);
            } else {
                uVar8 = param_2[1];
                uVar4 = FUN_00088840();
                FUN_00074d28("DNS success after retry, %u next_dns_timeslot "
                             "reset (%s)\n",
                             uVar8, uVar4);
                uVar4 = *(undefined4 *)(param_4 + 4);
            }
        }
    } else {
        uVar5 = FUN_00077590();
        if (0 < (int)param_2[4]) {
            tVar3 = time((time_t *)0x0);
            iVar10 = tVar3 + param_2[4];
            uVar7 = param_2[4] * 2;
            if (iVar10 < *(int *)(iVar9 + 4)) {
                iVar10 = *(int *)(iVar9 + 4);
            }
            *(int *)(iVar9 + 4) = iVar10;
            uVar6 = uVar7 - 1 & uVar7;
            param_2[2] = tVar3;
            if (uVar6 == 0) {
                uVar6 = uVar7 - ((int)uVar7 >> 2);
            }
            param_2[3] = iVar10;
            uVar7 = uVar6;
            if (0x3f < (int)uVar6) {
                uVar7 = 0x40;
            }
            uVar1 = uVar5;
            if (uVar5 != 0) {
                uVar1 = uVar6;
            }
            param_2[4] = uVar7;
            if ((uVar5 != 0 && uVar6 != 0) && -1 < (int)uVar1) {
                iVar9 =
                    FUN_00079188(0, param_2, *param_2, FUN_00077d40, param_2);
                if (iVar9 == 0) {
                    if (iVar2 == __stack_chk_guard) {
                        return;
                    }
                    goto LAB_00077f20;
                }
                uVar4 = FUN_0007c2e8(param_2 + 10);
                FUN_00074e00(3, "unable to retry reverse lookup of %s", uVar4);
                goto LAB_00077e20;
            }
        }
        uVar4 = *(undefined4 *)(param_4 + 4);
    }
    if (*(int *)(param_4 + 0x10) == 0) {
        iVar9 = 0;
        iVar10 = 0;
    } else {
        iVar9 = *(int *)(param_4 + 0x14);
        iVar10 = param_4 + 0x18;
        if (iVar9 != 0) {
            iVar9 = iVar10 + *(int *)(param_4 + 0x10);
        }
    }
    (*(code *)param_2[8])(uVar4, *(undefined4 *)(param_4 + 8), param_2 + 10,
                          param_2[7], iVar10, iVar9, param_2[9]);
    if (iVar2 == __stack_chk_guard) {
        free(param_2);
        return;
    }
LAB_00077f20:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00077f40(char *param_1, char *param_2, int *param_3, int param_4,
                  int param_5, int param_6, int param_7)

{
    int iVar1;
    int iVar2;
    size_t sVar3;
    size_t sVar4;
    int *piVar5;
    time_t tVar6;
    int iVar7;
    int iVar8;
    int iVar9;
    size_t __n;
    int *extraout_r12;
    int *piVar10;

    iVar1 = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_intres.c", 0xfd, 0, "((void *)0) != node");
    }
    if (param_3 != (int *)0x0) {
        if (param_3[4] != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_intres.c", 0xff, 0, "0 == hints->ai_addrlen");
        }
        if (param_3[5] != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_intres.c", 0x100, 0,
                         "((void *)0) == hints->ai_addr");
        }
        if (param_3[6] != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_intres.c", 0x101, 0,
                         "((void *)0) == hints->ai_canonname");
        }
        if (param_3[7] != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_intres.c", 0x102, 0,
                         "((void *)0) == hints->ai_next");
        }
    }
    iVar2 = FUN_000773dc();
    iVar7 = *(int *)(dnschild_contexts + iVar2 * 4);
    sVar3 = strlen(param_1);
    __n = sVar3 + 1;
    sVar4 = strlen(param_2);
    sVar4 = sVar4 + 1;
    iVar9 = __n + sVar4 + 0x48;
    piVar5 = (int *)FUN_00073ba4(0, iVar9, 0, 1);
    *piVar5 = iVar9;
    piVar5[1] = iVar2;
    tVar6 = time((time_t *)0x0);
    iVar2 = *(int *)(iVar7 + 4);
    piVar5[2] = tVar6;
    if (tVar6 < iVar2) {
        tVar6 = iVar2;
    }
    piVar5[3] = tVar6;
    piVar10 = extraout_r12;
    if (param_3 != (int *)0x0) {
        piVar10 = piVar5 + 5;
    }
    *(time_t *)(iVar7 + 4) = tVar6;
    if (param_3 != (int *)0x0) {
        iVar2 = param_3[1];
        iVar7 = param_3[2];
        iVar8 = param_3[3];
        *piVar10 = *param_3;
        piVar10[1] = iVar2;
        piVar10[2] = iVar7;
        piVar10[3] = iVar8;
        iVar2 = param_3[5];
        iVar7 = param_3[6];
        iVar8 = param_3[7];
        piVar10[4] = param_3[4];
        piVar10[5] = iVar2;
        piVar10[6] = iVar7;
        piVar10[7] = iVar8;
    }
    piVar5[0x10] = __n;
    piVar5[4] = param_4;
    piVar5[0x11] = sVar4;
    piVar5[0xe] = param_5;
    piVar5[0xf] = param_6;
    piVar5[0xd] = param_7;
    memcpy(piVar5 + 0x12, param_1, __n);
    memcpy((void *)((int)piVar5 + sVar3 + 0x49), param_2, sVar4);
    iVar2 = FUN_00079188(1, piVar5, iVar9, FUN_0007774c, piVar5);
    if (iVar2 != 0) {
        FUN_00074e00(3, "unable to queue getaddrinfo request");
        piVar5 = __errno_location();
        iVar2 = -1;
        *piVar5 = 0xe;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

void FUN_000781e0(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    size_t sVar3;
    time_t tVar4;
    undefined4 uVar5;
    sockaddr *psVar6;
    int iVar7;
    addrinfo *paVar8;
    int iVar9;
    int iVar10;
    int *__dest;
    int *piVar11;
    char *pcVar12;
    addrinfo *paVar13;
    int iVar14;
    addrinfo *local_30;
    int local_2c;

    pcVar12 = (char *)(param_2 + 0x60);
    iVar9 = *(int *)(param_2 + 0x58);
    local_2c = __stack_chk_guard;
    iVar1 = FUN_00077478(param_1, *(undefined4 *)(param_2 + 0x1c));
    FUN_00077b04(*(undefined4 *)(param_2 + 0x20),
                 *(undefined4 *)(param_2 + 0x24), iVar1);
    FUN_00077ca8(iVar1 + 8);
    iVar2 = FUN_00073ba4(0, 0x4ec, 0, 1);
    if (1 < debug) {
        FUN_00074d28(
            "blocking_getaddrinfo given node %s serv %s fam %d flags %x\n",
            pcVar12, pcVar12 + iVar9, *(undefined4 *)(param_2 + 0x30),
            *(undefined4 *)(param_2 + 0x2c));
    }
    iVar14 = 0;
    local_30 = (addrinfo *)0x0;
    iVar9 = getaddrinfo(pcVar12, pcVar12 + iVar9, (addrinfo *)(param_2 + 0x2c),
                        &local_30);
    iVar10 = *(int *)(param_2 + 0x28);
    *(int *)(iVar2 + 0x1c) = iVar9;
    *(int *)(iVar2 + 0x20) = iVar10;
    if (iVar9 == -0xb) {
        piVar11 = __errno_location();
        *(int *)(iVar2 + 0x24) = *piVar11;
    } else if (iVar9 == 0) {
        if (local_30 == (addrinfo *)0x0) {
            iVar14 = 0;
        } else {
            iVar9 = *(int *)(iVar2 + 0x28);
            iVar14 = 0;
            paVar13 = local_30;
            do {
                iVar9 = iVar9 + 1;
                pcVar12 = paVar13->ai_canonname;
                *(int *)(iVar2 + 0x28) = iVar9;
                if (pcVar12 != (char *)0x0) {
                    sVar3 = strlen(pcVar12);
                    iVar14 = sVar3 + iVar14 + 1;
                }
                paVar13 = paVar13->ai_next;
            } while (paVar13 != (addrinfo *)0x0);
        }
        if (2 < iVar10) {
            tVar4 = time((time_t *)0x0);
            *(time_t *)(iVar1 + 4) = tVar4;
            if (0 < debug) {
                uVar5 = FUN_00088840();
                FUN_00074d28("DNS success after retry, ignoring sleeps "
                             "scheduled before now (%s)\n",
                             uVar5);
            }
        }
    }
    iVar14 = iVar14 + *(int *)(iVar2 + 0x28) * 0x3c;
    iVar9 = iVar14 + 0x2c;
    *(int *)(iVar2 + 0x18) = iVar14 + 0x14;
    iVar1 = FUN_00073ba4(iVar2, iVar9, 0);
    if (*(int *)(iVar1 + 0x1c) == 0) {
        iVar2 = 0;
        paVar13 = local_30;
        piVar11 = (int *)(iVar1 + 0x2c);
        if (local_30 != (addrinfo *)0x0) {
            do {
                __dest = piVar11 + 8;
                iVar14 = paVar13->ai_family;
                iVar10 = paVar13->ai_socktype;
                iVar7 = paVar13->ai_protocol;
                *piVar11 = paVar13->ai_flags;
                piVar11[1] = iVar14;
                piVar11[2] = iVar10;
                piVar11[3] = iVar7;
                paVar8 = paVar13->ai_next;
                psVar6 = paVar13->ai_addr;
                pcVar12 = paVar13->ai_canonname;
                piVar11[4] = paVar13->ai_addrlen;
                piVar11[5] = (int)psVar6;
                piVar11[6] = (int)pcVar12;
                piVar11[7] = (int)paVar8;
                if (paVar13->ai_canonname != (char *)0x0) {
                    piVar11[6] = iVar2;
                    sVar3 = strlen(paVar13->ai_canonname);
                    iVar2 = sVar3 + iVar2 + 1;
                }
                paVar13 = paVar13->ai_next;
                piVar11 = __dest;
            } while (paVar13 != (addrinfo *)0x0);
            paVar13 = local_30;
            if (local_30 != (addrinfo *)0x0) {
                do {
                    if (0x1c < paVar13->ai_addrlen) {
                        /* WARNING: Subroutine does not return */
                        FUN_0007ecc0("ntp_intres.c", 0x1a9, 2,
                                     "ai->ai_addrlen <= sizeof(sockaddr_u)");
                    }
                    memcpy(__dest, paVar13->ai_addr, paVar13->ai_addrlen);
                    paVar13 = paVar13->ai_next;
                    __dest = __dest + 7;
                    paVar8 = local_30;
                } while (paVar13 != (addrinfo *)0x0);
                for (; paVar8 != (addrinfo *)0x0; paVar8 = paVar8->ai_next) {
                    pcVar12 = paVar8->ai_canonname;
                    piVar11 = __dest;
                    if (pcVar12 != (char *)0x0) {
                        sVar3 = strlen(pcVar12);
                        piVar11 = (int *)((int)__dest + sVar3 + 1);
                        memcpy(__dest, pcVar12, sVar3 + 1);
                    }
                    __dest = piVar11;
                }
            }
        }
        freeaddrinfo(local_30);
    }
    iVar1 = FUN_00079350(param_1, iVar1, iVar9, param_2);
    if (iVar1 != 0) {
        FUN_00074e00(3, "blocking_getaddrinfo can not queue response");
        iVar1 = -1;
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_00078520(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00077f40();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00078580(short *param_1, int param_2, int param_3, undefined4 param_4,
                  undefined4 param_5, undefined4 param_6)

{
    short sVar1;
    int iVar2;
    int iVar3;
    undefined4 *puVar4;
    time_t tVar5;
    int *piVar6;
    size_t __n;
    int iVar7;

    iVar2 = __stack_chk_guard;
    if (param_2 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_intres.c", 0x28f, 0, "hostoctets");
    }
    if (0x3ff < (uint)(param_2 + param_3)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_intres.c", 0x290, 0,
                     "hostoctets + servoctets < 1024");
    }
    iVar3 = FUN_000773dc();
    iVar7 = *(int *)(dnschild_contexts + iVar3 * 4);
    puVar4 = (undefined4 *)FUN_00073ba4(0, 0x44, 0, 1);
    *puVar4 = 0x44;
    puVar4[1] = iVar3;
    tVar5 = time((time_t *)0x0);
    iVar3 = *(int *)(iVar7 + 4);
    sVar1 = *param_1;
    puVar4[2] = tVar5;
    if (tVar5 < iVar3) {
        tVar5 = iVar3;
    }
    if (sVar1 == 2) {
        __n = 0x10;
    } else {
        __n = 0x1c;
    }
    puVar4[3] = tVar5;
    *(time_t *)(iVar7 + 4) = tVar5;
    memcpy(puVar4 + 10, param_1, __n);
    puVar4[4] = 2;
    puVar4[8] = param_5;
    puVar4[5] = param_2;
    puVar4[6] = param_3;
    puVar4[7] = param_4;
    puVar4[9] = param_6;
    iVar3 = FUN_00079188(0, puVar4, 0x44, FUN_00077d40, puVar4);
    if (iVar3 != 0) {
        FUN_00074e00(3, "unable to queue getnameinfo request");
        piVar6 = __errno_location();
        iVar3 = -1;
        *piVar6 = 0xe;
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_00078738(undefined4 param_1, int param_2)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    size_t sVar4;
    size_t sVar5;
    int *piVar6;
    time_t tVar7;
    socklen_t __salen;
    int iVar8;
    uint uVar9;
    int iVar10;
    char *__serv;
    void *__dest;
    char acStack_42c[1024];
    int local_2c;

    iVar10 = *(int *)(param_2 + 0x2c);
    uVar9 = iVar10 + *(int *)(param_2 + 0x30);
    local_2c = __stack_chk_guard;
    if (0x3ff < uVar9) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_intres.c", 0x2d0, 0, "octets < sizeof(host)");
    }
    iVar1 = FUN_00077478(param_1, *(undefined4 *)(param_2 + 0x1c));
    __serv = acStack_42c + iVar10;
    FUN_00077b04(*(undefined4 *)(param_2 + 0x20),
                 *(undefined4 *)(param_2 + 0x24), iVar1);
    FUN_00077ca8(iVar1 + 8);
    iVar10 = FUN_00073ba4(0, uVar9 + 0x30, 0, 1);
    if (1 < debug) {
        uVar2 = FUN_0007c2e8((sockaddr *)(param_2 + 0x40));
        FUN_00074d28("blocking_getnameinfo given addr %s flags 0x%x hostlen "
                     "%lu servlen %lu\n",
                     uVar2, *(undefined4 *)(param_2 + 0x34),
                     *(undefined4 *)(param_2 + 0x2c),
                     *(undefined4 *)(param_2 + 0x30));
    }
    if (*(short *)(param_2 + 0x40) == 2) {
        __salen = 0x10;
    } else {
        __salen = 0x1c;
    }
    iVar3 =
        getnameinfo((sockaddr *)(param_2 + 0x40), __salen, acStack_42c,
                    *(socklen_t *)(param_2 + 0x2c), __serv,
                    *(socklen_t *)(param_2 + 0x30), *(uint *)(param_2 + 0x34));
    iVar8 = *(int *)(param_2 + 0x28);
    *(int *)(iVar10 + 0x1c) = iVar3;
    *(int *)(iVar10 + 0x24) = iVar8;
    if (iVar3 == -0xb) {
        piVar6 = __errno_location();
        *(int *)(iVar10 + 0x20) = *piVar6;
    LAB_00078920:
        iVar1 = 0x30;
        *(undefined4 *)(iVar10 + 0x28) = 0;
        iVar3 = 0x18;
        *(undefined4 *)(iVar10 + 0x2c) = 0;
    } else {
        if (iVar3 != 0)
            goto LAB_00078920;
        sVar4 = strlen(acStack_42c);
        *(size_t *)(iVar10 + 0x28) = sVar4 + 1;
        sVar5 = strlen(__serv);
        *(size_t *)(iVar10 + 0x2c) = sVar5 + 1;
        if (iVar8 < 3) {
            iVar1 = sVar4 + 1 + sVar5 + 1;
            iVar3 = iVar1 + 0x18;
            iVar1 = iVar1 + 0x30;
        } else {
            tVar7 = time((time_t *)0x0);
            iVar3 = debug;
            *(time_t *)(iVar1 + 4) = tVar7;
            if (0 < iVar3) {
                uVar2 = FUN_00088840();
                FUN_00074d28("DNS success after retrying, ignoring sleeps "
                             "scheduled before now (%s)\n",
                             uVar2);
            }
            iVar1 = *(int *)(iVar10 + 0x2c) + *(int *)(iVar10 + 0x28);
            iVar3 = iVar1 + 0x18;
            iVar1 = iVar1 + 0x30;
        }
    }
    iVar10 = FUN_00073ba4(iVar10, iVar1, 0);
    *(int *)(iVar10 + 0x18) = iVar3;
    if (*(int *)(iVar10 + 0x1c) == 0) {
        __dest = (void *)(iVar10 + 0x30 + *(size_t *)(iVar10 + 0x28));
        memcpy((void *)(iVar10 + 0x30), acStack_42c,
               *(size_t *)(iVar10 + 0x28));
        memcpy(__dest, __serv, *(size_t *)(iVar10 + 0x2c));
        if ((int)__dest + (*(int *)(iVar10 + 0x2c) - iVar10) != iVar1)
            goto LAB_000789d8;
        if (*(int *)(iVar10 + 0x18) != iVar3) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_intres.c", 0x31d, 2,
                         "resp_octets - sizeof(*resp) == gni_resp->octets");
        }
    } else if (iVar1 != 0x30) {
    LAB_000789d8:
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_intres.c", 0x31c, 2,
                     "(size_t)(cp - (char *)resp) == resp_octets");
    }
    iVar10 = FUN_00079350(param_1, iVar10, iVar1, param_2);
    if (iVar10 != 0) {
        FUN_00074e00(3, "blocking_getnameinfo unable to queue response");
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar10);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00078a80) */

void FUN_00078a44(int *param_1, int param_2, undefined4 *param_3)

{
    size_t __size;
    int iVar1;
    char *pcVar2;
    void *__src;
    void *__src_00;
    undefined4 *puVar3;
    char cVar4;
    short *psVar5;
    int iVar6;
    void *pvVar7;
    int iVar8;
    uint uVar9;
    int *piVar10;
    undefined4 uVar11;
    uint uVar12;
    int iVar13;
    uint uVar14;
    undefined4 *puVar15;
    int iVar16;
    short *psVar17;
    int local_3c;
    int local_38;
    undefined4 local_34;
    int local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar1 = FUN_00097480(param_1, *param_3);
    if (iVar1 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0008cec0(option_xlateable_txt._60_4_);
    }
    if ((param_1[3] & 0x40U) == 0) {
        param_1[3] = param_1[3] | 0x40;
        param_1[1] = param_2;
        param_1[2] = (int)param_3;
        if (0x21fff < *param_1) {
            DAT_000c8604 = param_1[0x1f];
        }
        iVar1 = FUN_00096ad8(param_1);
        if (iVar1 != 0) {
            uVar9 = 0;
            goto LAB_0009920c;
        }
        uVar9 = param_1[3];
        if ((*(ushort *)((int)param_1 + 0x5e) & 0x7fff) == 0) {
            param_1[3] = uVar9 | 0x80000;
            if (param_1[0xd] != 0) {
                FUN_00098e84(param_1, 1);
                goto LAB_00099168;
            }
        LAB_0009924c:
            FUN_00098e84(param_1, 0);
            uVar12 = param_1[3];
            uVar9 = uVar12 & 0xfff7ffff;
            param_1[3] = uVar9;
        } else {
            iVar1 =
                param_1[0x11] + (*(ushort *)((int)param_1 + 0x5e) + 1) * 0x40;
            uVar12 = uVar9;
            if ((*(uint *)(iVar1 + 0x10) & 0x20) == 0) {
                param_1[3] = uVar9 | 0x80000;
                if (param_1[0xd] == 0)
                    goto LAB_0009924c;
                FUN_00098e84(param_1, 1);
                if ((*(uint *)(iVar1 + 0x10) & 0x20) == 0) {
                    FUN_000984d4(param_1);
                }
            LAB_00099168:
                FUN_00098e84(param_1, 2);
                uVar9 = param_1[3] & 0xfff7ffff;
                param_1[3] = uVar9;
                uVar12 = uVar9;
            }
        }
        if ((((uVar12 & 0x2000) != 0) &&
             ((code *)param_1[0x16] != (code *)0x0)) &&
            ((uVar9 & 0x30000) == 0x10000)) {
            param_1[3] = uVar9 & 0xfffeffff;
            (*(code *)param_1[0x16])();
            uVar9 = param_1[3];
        }
        if ((uVar9 & 0x800) != 0) {
            local_3c = 0;
            local_38 = 0;
            local_34 = 4;
            local_30 = 0;
            pcVar2 = getenv("POSIXLY_CORRECT");
            if ((pcVar2 == (char *)0x0) && ((param_1[3] & 3U) != 0)) {
                uVar9 = param_1[1];
                __size = uVar9 << 2;
                __src = malloc(__size);
                if ((__src == (void *)0x0) ||
                    (__src_00 = malloc(__size), __src_00 == (void *)0x0)) {
                    /* WARNING: Subroutine does not return */
                    FUN_0001c610(__size);
                }
                uVar12 = 1;
                param_1[5] = 0;
                param_1[4] = 1;
                iVar1 = 0;
                iVar8 = 0;
            LAB_00099400:
                iVar13 = iVar8;
                if (uVar12 < uVar9) {
                    while (true) {
                        iVar8 = param_1[2];
                        pcVar2 = *(char **)(iVar8 + uVar12 * 4);
                        puVar15 = (undefined4 *)(iVar8 + uVar12 * 4);
                        if ((*pcVar2 != '-') ||
                            (cVar4 = pcVar2[1], cVar4 == '\0'))
                            break;
                        if (cVar4 == '-') {
                            if (pcVar2[2] == '\0') {
                                uVar14 = uVar12 + 1;
                                *(char **)((int)__src + iVar13 * 4) = pcVar2;
                                pvVar7 = __src;
                                if (uVar14 < uVar9) {
                                    pvVar7 = (void *)(iVar8 + uVar9 * 4);
                                }
                                iVar8 = iVar13 + 1;
                                param_1[4] = uVar14;
                                if (uVar14 < uVar9) {
                                    puVar3 = (undefined4 *)((int)__src_00 +
                                                            iVar1 * 4);
                                    do {
                                        puVar15 = puVar15 + 1;
                                        *puVar3 = *puVar15;
                                        puVar3 = puVar3 + 1;
                                    } while ((undefined4 *)((int)pvVar7 + -4) !=
                                             puVar15);
                                    iVar1 = (iVar1 + uVar9 + -1) - uVar12;
                                    param_1[4] =
                                        ((uVar9 - 1) + uVar14) - uVar12;
                                }
                                goto LAB_000994cc;
                            }
                            iVar8 =
                                FUN_00095a98(param_1, pcVar2 + 2, &local_3c);
                        } else if ((param_1[3] & 2U) == 0) {
                            iVar8 =
                                FUN_00095a98(param_1, pcVar2 + 1, &local_3c);
                        } else {
                            iVar8 = FUN_0008dff0(param_1, cVar4, &local_3c,
                                                 &local_30);
                        }
                        if (iVar8 < 0)
                            goto LAB_00099774;
                        iVar8 = iVar13 + 1;
                        iVar6 = param_1[4];
                        iVar16 = param_1[2];
                        uVar9 = *(uint *)(local_3c + 0x10);
                        uVar11 = *(undefined4 *)(iVar16 + iVar6 * 4);
                        uVar12 = iVar6 + 1;
                        param_1[4] = uVar12;
                        *(undefined4 *)((int)__src + iVar13 * 4) = uVar11;
                        if ((uVar9 & 0xf000) != 0) {
                            if ((uVar9 & 0x10000) == 0) {
                                if (local_30 == 1) {
                                    uVar9 = param_1[1];
                                    if (pcVar2[2] != '\0')
                                        goto LAB_00099400;
                                } else {
                                    if (local_30 != 2)
                                        goto LAB_00099708;
                                    uVar9 = param_1[1];
                                    if (local_38 != 0)
                                        goto LAB_00099400;
                                }
                                if (uVar9 <= uVar12) {
                                LAB_00099708:
                                    piVar10 = __errno_location();
                                    *piVar10 = 5;
                                    goto LAB_00099508;
                                }
                                pcVar2 = *(char **)(iVar16 + iVar6 * 4 + 4);
                            } else {
                                if (local_30 == 1) {
                                    uVar9 = param_1[1];
                                    if (pcVar2[2] != '\0')
                                        goto LAB_00099400;
                                } else {
                                    if (local_30 != 2)
                                        goto LAB_00099708;
                                    uVar9 = param_1[1];
                                    if (local_38 != 0)
                                        goto LAB_00099400;
                                }
                                if (uVar9 <= uVar12) {
                                    piVar10 = __errno_location();
                                    *piVar10 = 0;
                                    goto LAB_000994cc;
                                }
                                pcVar2 = *(char **)(iVar16 + iVar6 * 4 + 4);
                                if (*pcVar2 == '-')
                                    goto LAB_00099400;
                            }
                            uVar12 = iVar6 + 2;
                            param_1[4] = uVar12;
                            *(char **)((int)__src + iVar13 * 4 + 4) = pcVar2;
                            iVar8 = iVar13 + 2;
                            goto LAB_00099400;
                        }
                        if (local_30 == 1) {
                            cVar4 = pcVar2[2];
                            pcVar2 = pcVar2 + 2;
                            if (cVar4 != '\0')
                                goto LAB_0009975c;
                        }
                        uVar9 = param_1[1];
                        iVar13 = iVar8;
                        if (uVar9 <= uVar12)
                            goto LAB_000994b8;
                    }
                    uVar12 = uVar12 + 1;
                    *(char **)((int)__src_00 + iVar1 * 4) = pcVar2;
                    param_1[4] = uVar12;
                    iVar1 = iVar1 + 1;
                    iVar8 = iVar13;
                    goto LAB_00099400;
                }
            LAB_000994b8:
                piVar10 = __errno_location();
                *piVar10 = 0;
            LAB_000994cc:
                if (iVar8 != 0) {
                    memcpy((void *)(param_1[2] + 4), __src, iVar8 << 2);
                }
                if (iVar1 != 0) {
                    memcpy((void *)(param_1[2] + (iVar8 + 1) * 4), __src_00,
                           iVar1 << 2);
                }
            LAB_00099508:
                free(__src);
                free(__src_00);
            }
        }
    LAB_000991b8:
        param_1[4] = 1;
        param_1[5] = 0;
    } else if (param_1[4] == 0)
        goto LAB_000991b8;
    iVar1 = FUN_000969ac(param_1);
    if (iVar1 != 0) {
        uVar9 = param_1[1];
        goto LAB_0009920c;
    }
    uVar9 = (uint) * (ushort *)((int)param_1 + 0x5e);
    if (((uVar9 != 0) && (uVar9 != 0x8000)) &&
        ((*(uint *)(param_1[0x11] + uVar9 * 0x40 + 0x10) & 5) != 0)) {
        FUN_00095318(param_1);
        /* WARNING: Subroutine does not return */
        FUN_0008ce5c(0);
    }
    uVar12 = param_1[3];
    if ((uVar12 & 4) != 0) {
        psVar17 = (short *)param_1[0x11];
        iVar1 = param_1[0x1a];
        psVar5 = psVar17;
        while (true) {
            uVar9 = *(uint *)(psVar5 + 8);
            if ((uVar9 & 5) != 0) {
                if (*(int *)(psVar5 + 0x10) != 0) {
                    piVar10 = (int *)(*(int *)(psVar5 + 0x10) + -4);
                    while (true) {
                        piVar10 = piVar10 + 1;
                        iVar8 = *piVar10;
                        if (iVar8 == 0x8000)
                            break;
                        if ((*(uint *)(psVar17 + iVar8 * 0x20 + 8) & 0xf) ==
                            0) {
                            fprintf(
                                stderr, (char *)option_xlateable_txt._236_4_,
                                param_1[7], *(undefined4 *)(psVar5 + 0x1a),
                                *(undefined4 *)(psVar17 + iVar8 * 0x20 + 0x1a));
                            goto LAB_00099354;
                        }
                    }
                }
                if (*(int *)(psVar5 + 0x12) != 0) {
                    piVar10 = (int *)(*(int *)(psVar5 + 0x12) + -4);
                    while (true) {
                        piVar10 = piVar10 + 1;
                        iVar8 = *piVar10;
                        if (iVar8 == 0x8000)
                            break;
                        if ((*(uint *)(psVar17 + iVar8 * 0x20 + 8) & 5) != 0) {
                            fprintf(
                                stderr, (char *)option_xlateable_txt._108_4_,
                                param_1[7], *(undefined4 *)(psVar5 + 0x1a),
                                *(undefined4 *)(psVar17 + iVar8 * 0x20 + 0x1a));
                            goto LAB_00099354;
                        }
                    }
                }
            }
            if (((psVar5[4] == -0x8000) || (*psVar5 == psVar5[4])) &&
                ((uVar14 = (uint)(ushort)psVar5[5],
                  (ushort)psVar5[7] < uVar14 &&
                      (((uVar9 & 0x100000) == 0 || ((uVar9 & 3) == 0)))))) {
                if (uVar14 < 2) {
                    fprintf(stderr, (char *)option_xlateable_txt._152_4_,
                            param_1[7], *(undefined4 *)(psVar5 + 0x1a));
                } else {
                    fprintf(stderr, (char *)option_xlateable_txt._200_4_,
                            param_1[7], *(undefined4 *)(psVar5 + 0x1a), uVar14);
                }
                goto LAB_00099354;
            }
            iVar1 = iVar1 + -1;
            if (iVar1 < 1)
                break;
            psVar5 = psVar5 + 0x20;
        }
        uVar9 = param_1[4];
        if ((uVar12 & 0x200) == 0) {
            if (((uVar12 & 0x400) == 0) || (uVar9 < (uint)param_1[1]))
                goto LAB_0009920c;
            fprintf(stderr, (char *)option_xlateable_txt._88_4_, param_1[7]);
        } else {
            if ((uint)param_1[1] <= uVar9)
                goto LAB_0009920c;
            fprintf(stderr, (char *)option_xlateable_txt._160_4_, param_1[7]);
        }
    LAB_00099354:
        (*(code *)param_1[0x15])(param_1, 1);
    }
    uVar9 = param_1[4];
LAB_0009920c:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar9);
    }
    return;
    while (true) {
        pcVar2 = pcVar2 + 1;
        cVar4 = *pcVar2;
        if ((*(uint *)(local_3c + 0x10) & 0xf000) != 0) {
            uVar12 = param_1[4];
            uVar9 = param_1[1];
            if ((*(uint *)(local_3c + 0x10) & 0x10000) != 0) {
                if ((cVar4 == '\0') &&
                    (pcVar2 = *(char **)(param_1[2] + uVar12 * 4),
                     *pcVar2 != '-')) {
                    uVar12 = uVar12 + 1;
                    param_1[4] = uVar12;
                    *(char **)((int)__src + iVar13 * 4 + 4) = pcVar2;
                    iVar8 = iVar13 + 2;
                }
                goto LAB_00099400;
            }
            if (cVar4 != '\0')
                goto LAB_00099400;
            if (uVar9 <= uVar12)
                goto LAB_00099774;
            uVar11 = *(undefined4 *)(param_1[2] + uVar12 * 4);
            uVar12 = uVar12 + 1;
            param_1[4] = uVar12;
            *(undefined4 *)((int)__src + iVar13 * 4 + 4) = uVar11;
            iVar8 = iVar13 + 2;
            goto LAB_00099400;
        }
        if (cVar4 == '\0')
            break;
    LAB_0009975c:
        iVar6 = FUN_0008dff0(param_1, cVar4, &local_3c, &local_30);
        if (iVar6 < 0)
            goto LAB_00099774;
    }
    uVar12 = param_1[4];
    uVar9 = param_1[1];
    goto LAB_00099400;
LAB_00099774:
    piVar10 = __errno_location();
    *piVar10 = 0x16;
    goto LAB_00099508;
}

void FUN_00078a8c(void)

{
    puts(Version);
    fflush(stdout);
    /* WARNING: Subroutine does not return */
    exit(0);
}

void FUN_00078ae4(void)

{
    int iVar1;
    uint uVar2;
    uint *puVar3;
    int *piVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    uVar2 = *DAT_000c7d70;
    piVar4 = DAT_000c7d74 + 1;
    iVar5 = *DAT_000c7d74;
    puVar3 = DAT_000c7d70 + 1;
    *DAT_000c7d70 = uVar2 + iVar5;
    if (puVar3 < (uint *)0xc7d70) {
        if ((int *)0xc7d6f < piVar4) {
            piVar4 = &DAT_000c7cf4;
        }
    } else {
        puVar3 = &DAT_000c7cf4;
    }
    DAT_000c7d70 = puVar3;
    DAT_000c7d74 = piVar4;
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2 + iVar5 >> 1);
    }
    return;
}

void FUN_00078b80(int param_1)

{
    int iVar1;
    uint __seed;
    int *piVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    piVar2 = &DAT_000c7cf8;
    DAT_000c7cf4 = param_1;
    while (true) {
        param_1 = param_1 * 0x41a7 + (param_1 / 0x1f31d) * -0x7fffffff;
        if (param_1 < 1) {
            param_1 = param_1 + 0x7fffffff;
        }
        *piVar2 = param_1;
        if (piVar2 == (int *)0xc7d6c)
            break;
        piVar2 = piVar2 + 1;
    }
    iVar3 = 0x136;
    DAT_000c7d70 = &DAT_000c7d00;
    DAT_000c7d74 = &DAT_000c7cf4;
    do {
        __seed = FUN_00078ae4();
        iVar3 = iVar3 + -1;
    } while (iVar3 != 0);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    srand(__seed);
    return;
}

/* WARNING: Removing unreachable block (ram,0x00078d0c) */
/* WARNING: Removing unreachable block (ram,0x00078cb0) */
/* WARNING: Removing unreachable block (ram,0x00078cb8) */
/* WARNING: Removing unreachable block (ram,0x00078d80) */
/* WARNING: Removing unreachable block (ram,0x00078efc) */

void FUN_00078ebc(undefined4 *param_1)

{
    int iVar1;
    undefined4 *puVar2;
    size_t sVar3;
    undefined4 uVar4;
    undefined4 uVar5;
    undefined4 uVar6;
    int iVar7;
    char *__s;
    undefined4 *__dest;
    undefined4 *puVar8;
    int iVar9;
    undefined4 *puVar10;
    undefined4 *puVar11;
    undefined4 *puVar12;

    iVar1 = __stack_chk_guard;
    if (param_1 == (undefined4 *)0x0) {
        FUN_00073ba4(0, 0, 0, 1);
        return;
    }
    iVar7 = 0;
    iVar9 = 0;
    puVar8 = param_1;
    do {
        iVar9 = iVar9 + 1;
        puVar10 = puVar8 + 6;
        puVar8 = (undefined4 *)puVar8[7];
        if ((char *)*puVar10 != (char *)0x0) {
            sVar3 = strlen((char *)*puVar10);
            iVar7 = sVar3 + iVar7 + 1;
        }
    } while (puVar8 != (undefined4 *)0x0);
    iVar7 = iVar7 + iVar9 * 0x3c;
    puVar2 = (undefined4 *)FUN_00073ba4(0, iVar7, 0, 1);
    __dest = puVar2 + iVar9 * 8;
    puVar10 = __dest + iVar9 * 7;
    puVar8 = puVar2;
    do {
        uVar4 = param_1[1];
        uVar5 = param_1[2];
        uVar6 = param_1[3];
        puVar12 = (undefined4 *)param_1[7];
        *puVar8 = *param_1;
        puVar8[1] = uVar4;
        puVar8[2] = uVar5;
        puVar8[3] = uVar6;
        uVar4 = param_1[5];
        uVar5 = param_1[6];
        uVar6 = param_1[7];
        puVar8[4] = param_1[4];
        puVar8[5] = uVar4;
        puVar8[6] = uVar5;
        puVar8[7] = uVar6;
        if (0x1c < (uint)param_1[4]) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("ntp_rfc2553.c", 0xcf, 2,
                         "ai_src->ai_addrlen <= sizeof(sockaddr_u)");
        }
        memcpy(__dest, (void *)param_1[5], param_1[4]);
        iVar9 = param_1[6];
        puVar8[5] = __dest;
        __dest = __dest + 7;
        puVar11 = puVar10;
        if (iVar9 != 0) {
            puVar8[6] = puVar10;
            __s = (char *)param_1[6];
            sVar3 = strlen(__s);
            puVar11 = (undefined4 *)((int)puVar10 + sVar3 + 1);
            memcpy(puVar10, __s, sVar3 + 1);
        }
        if (puVar8[7] != 0) {
            puVar8[7] = puVar8 + 8;
        }
        param_1 = puVar12;
        puVar10 = puVar11;
        puVar8 = puVar8 + 8;
    } while (puVar12 != (undefined4 *)0x0);
    if (puVar11 == (undefined4 *)((int)puVar2 + iVar7)) {
        if (iVar1 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(puVar2);
        }
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("ntp_rfc2553.c", 0xe1, 1, "pcanon == ((char *)dst + octets)");
}

void FUN_00078f08(int *param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 uVar2;
    int local_24;
    int local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = socketpair(1, 1, 0, &local_24);
    if (iVar1 == -1) {
        iVar1 = pipe(&local_24);
        if (iVar1 == -1)
            goto LAB_00078f70;
        uVar2 = 1;
    } else {
        uVar2 = 0;
    }
    iVar1 = 0;
    *param_1 = local_24;
    param_1[1] = local_20;
    if (param_2 != (undefined4 *)0x0) {
        *param_2 = uVar2;
    }
LAB_00078f70:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar1);
    }
    return;
}

void FUN_00079020(int param_1)

{
    long lVar1;
    int iVar2;
    int iVar3;
    int iVar4;

    iVar2 = __stack_chk_guard;
    if (0 < param_1) {
        iVar3 = 0;
        do {
            iVar4 = iVar3 + 1;
            close(iVar3);
            iVar3 = iVar4;
        } while (param_1 != iVar4);
    }
    iVar3 = __stack_chk_guard;
    if (iVar2 == __stack_chk_guard) {
        param_1 = param_1 + 1;
        lVar1 = sysconf(4);
        if (param_1 < lVar1) {
            do {
                iVar2 = param_1 + 1;
                close(param_1);
                param_1 = iVar2;
            } while (lVar1 != iVar2);
        }
        if (iVar3 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007908c(void)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    int iVar5;
    int iVar6;
    undefined4 *puVar7;

    iVar1 = __stack_chk_guard;
    if (blocking_children_alloc == 0) {
        iVar2 = 0x10;
        iVar6 = 4;
        iVar3 = 0;
        iVar5 = 0;
    LAB_00079120:
        blocking_children =
            (undefined4 *)FUN_00073ba4(blocking_children, iVar2, iVar3, 1);
        blocking_children_alloc = iVar6;
    } else {
        piVar4 = (int *)*blocking_children;
        if (piVar4 == (int *)0x0) {
            iVar5 = 0;
        } else {
            if (*piVar4 == 0) {
                iVar6 = 0;
                puVar7 = blocking_children;
                do {
                    iVar5 = iVar6 + 1;
                    if (blocking_children_alloc == iVar5) {
                        iVar3 = blocking_children_alloc * 4;
                        iVar6 = iVar6 + 5;
                        iVar2 = iVar3 + 0x10;
                        goto LAB_00079120;
                    }
                    puVar7 = puVar7 + 1;
                    piVar4 = (int *)*puVar7;
                    if (piVar4 == (int *)0x0)
                        goto LAB_00079130;
                    iVar6 = iVar5;
                } while (*piVar4 == 0);
            } else {
                iVar5 = 0;
            }
            *piVar4 = 0;
        }
    }
LAB_00079130:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
}

void FUN_00079188(undefined4 param_1, undefined4 param_2, int param_3,
                  undefined4 param_4, undefined4 param_5)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int local_34[3];
    int local_28;
    undefined4 local_24;
    undefined4 local_20;
    int local_1c;

    local_34[0] = param_3 + 0x18;
    local_1c = __stack_chk_guard;
    local_34[1] = 0x510c7ecf;
    local_20 = param_5;
    local_34[2] = param_1;
    local_24 = param_4;
    if (((worker_per_query == 0) && (DAT_000c7d78 != -1)) &&
        (**(int **)(blocking_children + DAT_000c7d78 * 4) == 0)) {
    LAB_0007921c:
        if (intres_req_pending != 0) {
            intres_req_pending = intres_req_pending + 1;
            iVar3 = DAT_000c7d78;
            goto LAB_00079230;
        }
    LAB_000792b4:
        iVar3 = DAT_000c7d78;
        FUN_00050dfc(0);
    } else {
        iVar3 = FUN_0007908c();
        if (worker_per_query == 0) {
            if (DAT_000c7d78 != -1)
                goto LAB_0007921c;
            DAT_000c7d78 = iVar3;
            if (intres_req_pending != 0)
                goto LAB_000792d4;
            goto LAB_000792b4;
        }
    }
LAB_000792d4:
    intres_req_pending = intres_req_pending + 1;
    if (iVar3 == -1) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("ntp_worker.c", 0xc1, 2,
                     "(0x7fffffff * 2U + 1U) != child_slot");
    }
LAB_00079230:
    iVar2 = *(int *)(blocking_children + iVar3 * 4);
    if (iVar2 == 0) {
        iVar2 = FUN_00073ba4(0, 0x90, 0, 1);
        iVar1 = blocking_children;
        *(undefined4 *)(iVar2 + 0x34) = 0xffffffff;
        *(undefined4 *)(iVar2 + 0x38) = 0xffffffff;
        *(int *)(iVar1 + iVar3 * 4) = iVar2;
    }
    local_28 = iVar3;
    FUN_0007e544(iVar2, local_34, param_2);
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00079350(undefined4 param_1, undefined4 *param_2, undefined4 param_3,
                  int param_4)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;

    uVar3 = *(undefined4 *)(param_4 + 8);
    param_2[1] = 0x510c7e54;
    param_2[2] = uVar3;
    iVar1 = __stack_chk_guard;
    *param_2 = param_3;
    iVar2 = __stack_chk_guard;
    uVar3 = *(undefined4 *)(param_4 + 0x10);
    param_2[5] = *(undefined4 *)(param_4 + 0x14);
    param_2[4] = uVar3;
    if (iVar1 == iVar2) {
        FUN_0007e6e8();
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000793bc(undefined4 param_1)

{
    int iVar1;
    int *__ptr;

    iVar1 = __stack_chk_guard;
    while (__ptr = (int *)FUN_0007e948(param_1), __ptr != (int *)0x0) {
        intres_req_pending = intres_req_pending + -1;
        (*(code *)__ptr[4])(__ptr[2], __ptr[5], *__ptr + -0x18, __ptr + 6);
        free(__ptr);
    }
    if (worker_per_query == 0) {
        if (intres_req_pending == 0) {
            if (iVar1 == __stack_chk_guard) {
                FUN_00050dfc(0xb4);
                return;
            }
        } else if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_0007eae8(param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000794b8(void)

{
    int iVar1;
    int iVar2;
    uint uVar3;

    iVar1 = __stack_chk_guard;
    if (blocking_child_ready_seen != blocking_child_ready_done) {
        blocking_child_ready_done = blocking_child_ready_seen;
        if (blocking_children_alloc != 0) {
            uVar3 = 0;
            do {
                iVar2 = *(int *)(blocking_children + uVar3 * 4);
                if (iVar2 != 0) {
                    if (*(int *)(iVar2 + 0x44) != *(int *)(iVar2 + 0x48)) {
                        *(int *)(iVar2 + 0x48) = *(int *)(iVar2 + 0x44);
                        FUN_000793bc();
                    }
                }
                uVar3 = uVar3 + 1;
            } while (uVar3 < blocking_children_alloc);
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00079588(undefined4 param_1)

{
    int iVar1;
    void *__ptr;
    int iVar2;

    iVar1 = __stack_chk_guard;
    do {
        __ptr = (void *)FUN_0007e870(param_1);
        if (__ptr == (void *)0x0) {
        LAB_000795ec:
            if (iVar1 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(0);
        }
        if (*(int *)((int)__ptr + 8) != 0) {
            if (*(int *)((int)__ptr + 8) == 1) {
                iVar2 = FUN_000781e0(param_1, __ptr);
                if (iVar2 == 0)
                    goto LAB_00079638;
            LAB_000795e4:
                free(__ptr);
            } else {
                FUN_00074e00(3, "unknown req %d to blocking worker");
                free(__ptr);
            }
            goto LAB_000795ec;
        }
        iVar2 = FUN_00078738(param_1, __ptr);
        if (iVar2 != 0)
            goto LAB_000795e4;
    LAB_00079638:
        free(__ptr);
    } while (true);
}

void FUN_00079654(void)

{
    int iVar1;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    FUN_00050dfc(0);
    if (blocking_children_alloc != 0) {
        uVar2 = 0;
        do {
            if (*(int *)(blocking_children + uVar2 * 4) != 0) {
                FUN_0007eae8();
            }
            uVar2 = uVar2 + 1;
        } while (uVar2 < blocking_children_alloc);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

undefined1 *FUN_000796ec(uint param_1)

{
    int iVar1;
    uint uVar2;
    undefined1 *__s;

    iVar1 = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar2 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    lib_nextbuf = uVar2 & 0xf;
    FUN_0007c054(__s, 0x80, "%lu.%lu.%lu.%lu", param_1 & 0xff,
                 param_1 >> 8 & 0xff, param_1 >> 0x10 & 0xff, param_1 >> 0x18);
    if (iVar1 == __stack_chk_guard) {
        return __s;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000797a8(undefined4 param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;
    size_t sVar4;
    char *__s;

    iVar3 = __stack_chk_guard;
    iVar2 = lib_nextbuf;
    if (1 < param_2) {
        FUN_000796ec();
        return;
    }
    iVar1 = lib_nextbuf * 0x80;
    __s = lib_stringbuf + iVar1;
    memset(__s, 0, 0x80);
    lib_stringbuf[iVar2 * 0x80] = 0x2e;
    lib_nextbuf = iVar2 + 1U & 0xf;
    *(undefined4 *)(lib_stringbuf + iVar1 + 1) = param_1;
    lib_stringbuf[iVar1 + 5] = 0;
    sVar4 = strlen(__s);
    iVar2 = __stack_chk_guard;
    __s[sVar4] = '.';
    (__s + sVar4)[1] = '\0';
    if (iVar3 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_0007987c(uint *param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    int iVar4;
    code *pcVar5;
    bool bVar6;
    uint local_30;
    int local_2c;

    local_30 = *param_1;
    uVar3 = param_1[1];
    local_2c = __stack_chk_guard;
    uVar2 = local_30;
    if (uVar3 == (int)local_30 >> 0x1f) {
        iVar4 = 0;
    } else {
        iVar1 = 0;
        do {
            while (-1 < (int)uVar3) {
                iVar1 = iVar1 + 1;
                if (3 < iVar1)
                    goto LAB_000799d0;
                bVar6 = 0x34aadc7f < uVar2;
                uVar2 = uVar2 + 0xcb552380;
                uVar3 = (uVar3 - 1) + (uint)bVar6;
                iVar4 = iVar1;
                if ((int)uVar2 >> 0x1f == uVar3)
                    goto LAB_00079930;
            }
            iVar4 = iVar1 + -1;
            if (iVar1 + 2 < 0 != SCARRY4(iVar4, 3))
                goto LAB_000799d0;
            bVar6 = 0xcb55237f < uVar2;
            uVar2 = uVar2 + 0x34aadc80;
            uVar3 = uVar3 + bVar6;
            iVar1 = iVar4;
        } while ((int)uVar2 >> 0x1f != uVar3);
    }
LAB_00079930:
    local_30 = uVar2;
    pcVar5 = localtime;
    if (param_2 == 0) {
        pcVar5 = gmtime;
    }
    while (iVar1 = (*pcVar5)(&local_30), iVar1 == 0) {
        while (-1 < (int)local_30) {
            if (((int)local_30 < 0x34aadc80) || (iVar4 = iVar4 + 1, 3 < iVar4))
                goto LAB_000799d0;
            local_30 = local_30 + 0xcb552380;
            iVar1 = (*pcVar5)(&local_30);
            if (iVar1 != 0)
                goto LAB_000799ac;
        }
        if (iVar4 + 2 < 0 != SCARRY4(iVar4 + -1, 3))
            goto LAB_000799d0;
        local_30 = local_30 + 0x34aadc80;
        iVar4 = iVar4 + -1;
    }
LAB_000799ac:
    if ((iVar4 != 0) && (iVar4 = *(int *)(iVar1 + 0x14) + iVar4 * 0x1c,
                         *(int *)(iVar1 + 0x14) = iVar4, 0xc6 < iVar4 - 1U)) {
    LAB_000799d0:
        iVar1 = 0;
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar1);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00079c1c) */
/* WARNING: Removing unreachable block (ram,0x00079ce0) */

void FUN_00079ca0(int *param_1)

{
    undefined4 *puVar1;
    int iVar2;
    uint uVar3;
    undefined1 *__s;
    undefined4 local_40;
    undefined4 uStack_3c;
    undefined4 local_38;
    undefined4 uStack_34;
    undefined2 local_30[2];
    byte local_2c;
    undefined1 local_2b;
    undefined1 local_2a;
    undefined1 local_29;
    undefined1 local_28;
    byte local_27;
    int local_24;

    local_24 = __stack_chk_guard;
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar3 = lib_nextbuf + 1 & 0xf;
    memset(__s, 0, 0x80);
    iVar2 = *param_1;
    lib_nextbuf = uVar3;
    if ((iVar2 == 0) && (param_1[1] == 0)) {
        FUN_0007d4dc(__s, "(no time)", 0x80);
    } else {
        uVar3 = (uint)param_1[1] / 0x418937;
        if (uVar3 == 1000) {
            iVar2 = iVar2 + 1;
            uVar3 = 0;
        }
        FUN_00075844(&local_40, iVar2, 0);
        local_38 = local_40;
        uStack_34 = uStack_3c;
        puVar1 = (undefined4 *)FUN_0007987c(&local_38, 0);
        if (puVar1 == (undefined4 *)0x0) {
            FUN_00075fc0(local_30, &local_38);
            FUN_0007c054(__s, 0x80,
                         "%08lx.%08lx  %s, %s %2d %4d %2d:%02d:%02d.%03u",
                         *param_1, param_1[1],
                         *(undefined4 *)(daynames + (uint)local_27 * 4),
                         *(undefined4 *)(months + (local_2c - 1) * 4), local_2b,
                         local_30[0], local_2a, local_29, local_28, uVar3);
        } else {
            FUN_0007c054(
                __s, 0x80, "%08lx.%08lx  %s, %s %2d %4d %2d:%02d:%02d.%03u",
                *param_1, param_1[1], *(undefined4 *)(daynames + puVar1[6] * 4),
                *(undefined4 *)(months + puVar1[4] * 4), puVar1[3],
                puVar1[5] + 0x76c, puVar1[2], puVar1[1], *puVar1, uVar3);
        }
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Removing unreachable block (ram,0x00079d9c) */

void FUN_00079d58(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x00079df0) */

void FUN_00079dac(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x00079e44) */

void FUN_00079e00(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x00079e98) */

void FUN_00079e54(void)

{
    return;
}

void FUN_00079ea8(int param_1)

{
    int iVar1;
    int *piVar2;
    int iVar3;
    int *piVar4;

    iVar1 = __stack_chk_guard;
    iVar3 = DAT_00117218;
    DAT_00117210 = 0;
    DAT_00117208 = 0;
    DAT_00117214 = 0;
    DAT_0011720c = 0;
    DAT_00117218 = 0;
    param_1 = param_1 + iVar3;
    piVar2 = (int *)FUN_00073c68(0, param_1, 0x8a4, 0);
    if (0 < param_1) {
        iVar3 = 0;
        piVar4 = piVar2;
        do {
            iVar3 = iVar3 + 1;
            *piVar4 = (int)DAT_0011721c;
            DAT_00117208 = DAT_00117208 + 1;
            DAT_00117210 = DAT_00117210 + 1;
            DAT_0011721c = piVar4;
            piVar4 = piVar4 + 0x229;
        } while (param_1 != iVar3);
        DAT_0011721c = piVar2 + param_1 * 0x229 + -0x229;
    }
    DAT_00117214 = DAT_00117214 + 1;
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00079fa8(undefined4 *param_1)

{
    int iVar1;
    undefined4 *puVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 != (undefined4 *)0x0) {
        iVar3 = param_1[0x228];
        param_1[0x228] = iVar3 + -1;
        if (iVar3 + -1 != 0) {
            FUN_00074e00(3, "******** freerecvbuff non-zero usage: %d *******");
        }
        DAT_00117208 = DAT_00117208 + 1;
        puVar2 = param_1;
        *param_1 = DAT_0011721c;
        DAT_0011721c = puVar2;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007a044(undefined4 *param_1)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (param_1 == (undefined4 *)0x0) {
        FUN_00074e00(3, "add_full_recv_buffer received NULL buffer");
        return;
    }
    *param_1 = 0;
    if (DAT_00117224 == (undefined4 *)0x0) {
        DAT_00117224 = &DAT_00117220;
        DAT_00117220 = param_1;
    } else {
        *(undefined4 **)*DAT_00117224 = param_1;
        DAT_00117224 = (undefined4 *)*DAT_00117224;
    }
    DAT_0011720c = DAT_0011720c + 1;
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0007a108(void)

{
    undefined4 *__s;
    int iVar1;

    iVar1 = __stack_chk_guard;
    __s = DAT_0011721c;
    if (DAT_0011721c == (undefined4 *)0x0) {
        DAT_00117218 = DAT_00117218 + 1;
    } else {
        DAT_0011721c = (undefined4 *)*DAT_0011721c;
        DAT_00117208 = DAT_00117208 + -1;
        memset(__s, 0, 0x8a4);
        __s[0x228] = 1;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Removing unreachable block (ram,0x0007a22c) */

void FUN_0007a1a4(void)

{
    undefined4 *puVar1;
    undefined4 *puVar2;

    if (DAT_00117220 != (undefined4 *)0x0) {
        puVar2 = (undefined4 *)*DAT_00117220;
        puVar1 = puVar2;
        if ((puVar2 != (undefined4 *)0x0) &&
            (puVar1 = DAT_00117224, DAT_00117224 == DAT_00117220)) {
            puVar1 = &DAT_00117220;
        }
        DAT_00117224 = puVar1;
        DAT_0011720c = DAT_0011720c + -1;
        DAT_00117220 = puVar2;
    }
    return;
}

void FUN_0007a240(int param_1)

{
    int iVar1;
    undefined4 *puVar2;
    undefined4 *puVar3;
    undefined4 *puVar4;
    undefined4 *puVar5;
    undefined4 *puVar6;

    iVar1 = __stack_chk_guard;
    puVar3 = DAT_00117220;
    if (DAT_00117220 != (undefined4 *)0x0) {
        do {
            while (puVar5 = (undefined4 *)*puVar3, puVar3[0x10] != param_1) {
                puVar3 = puVar5;
                if (puVar5 == (undefined4 *)0x0)
                    goto LAB_0007a328;
            }
            puVar4 = (undefined4 *)*DAT_00117220;
            puVar6 = DAT_00117220;
            if (DAT_00117220 == puVar3) {
                puVar6 = &DAT_00117220;
                puVar2 = puVar3;
            } else {
                while (true) {
                    puVar2 = puVar4;
                    if (puVar2 == (undefined4 *)0x0)
                        goto LAB_0007a35c;
                    if (puVar2 == puVar3)
                        break;
                    puVar4 = (undefined4 *)*puVar2;
                    puVar6 = puVar2;
                }
                puVar4 = *(undefined4 **)*puVar6;
                puVar2 = (undefined4 *)*puVar6;
            }
            *puVar6 = puVar4;
            if (puVar4 == (undefined4 *)0x0) {
                DAT_00117224 = (undefined4 *)0x0;
            } else if (DAT_00117224 == puVar2) {
                DAT_00117224 = &DAT_00117220;
            }
            if (puVar2 != puVar3) {
            LAB_0007a35c:
                /* WARNING: Subroutine does not return */
                FUN_0007ecc0("recvbuff.c", 0x11d, 2, "punlinked == rbufp");
            }
            DAT_0011720c = DAT_0011720c + -1;
            FUN_00079fa8();
            puVar3 = puVar5;
        } while (puVar5 != (undefined4 *)0x0);
    }
LAB_0007a328:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007a3ec) */

void FUN_0007a3a0(void)

{
    return;
}

void FUN_0007a3fc(short *param_1)

{
    uint uVar1;
    uint uVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    undefined1 *__s;

    iVar3 = __stack_chk_guard;
    if ((*param_1 != 2) || (param_1[2] != 0x7f7f)) {
        FUN_0007c2e8(param_1);
        return;
    }
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar5 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    uVar1 = *(uint *)(param_1 + 2) >> 0x10 & 0xff;
    uVar2 = *(uint *)(param_1 + 2) >> 0x18;
    lib_nextbuf = uVar5 & 0xf;
    iVar4 = FUN_000886b8(uVar1);
    if (iVar4 == 0) {
        FUN_0007c054(__s, 0x80, "REFCLK(%lu,%lu)", uVar1, uVar2);
    } else {
        FUN_0007c054(__s, 0x80, "%s(%lu)", iVar4, uVar2);
    }
    if (iVar3 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_0007a520(int param_1, uint *param_2, uint param_3, char *param_4,
                  uint param_5, int param_6, uint param_7)

{
    char cVar1;
    int iVar2;
    uint uVar3;
    int iVar4;
    uint uVar5;
    char *pcVar6;
    uint uVar7;
    uint uVar8;
    int iVar9;

    iVar2 = __stack_chk_guard;
    if (param_4 == (char *)0x0) {
        param_4 = "(null)";
    } else if (*param_4 == '\0')
        goto LAB_0007a580;
    if (0 < param_6 || param_6 == -1) {
        iVar4 = 0;
        pcVar6 = param_4;
        do {
            pcVar6 = pcVar6 + 1;
            iVar4 = iVar4 + 1;
            if (*pcVar6 == '\0')
                break;
        } while (iVar4 < param_6 || param_6 == -1);
        param_5 = param_5 - iVar4;
    }
LAB_0007a580:
    uVar3 = param_5 & ~((int)param_5 >> 0x1f);
    if ((param_7 & 1) == 0) {
        if (0 < (int)param_5) {
            uVar7 = *param_2;
            uVar8 = uVar3;
            do {
                uVar5 = uVar7 + 1;
                if (uVar5 < param_3) {
                    *(undefined1 *)(param_1 + uVar7) = 0x20;
                    uVar5 = *param_2 + 1;
                }
                uVar8 = uVar8 - 1;
                *param_2 = uVar5;
                uVar7 = uVar5;
            } while (uVar8 != 0);
            if ((int)uVar3 < 1) {
                uVar3 = uVar3 - 1;
            } else {
                uVar3 = 0;
            }
        }
    } else {
        uVar3 = -uVar3;
    }
    cVar1 = *param_4;
    iVar4 = param_6;
    while (
        (cVar1 != '\0' &&
         ((iVar9 = iVar4, param_6 == -1 || (iVar9 = iVar4 + -1, 0 < iVar4))))) {
        uVar7 = *param_2 + 1;
        if (uVar7 < param_3) {
            *(char *)(param_1 + *param_2) = cVar1;
            uVar7 = *param_2 + 1;
        }
        *param_2 = uVar7;
        param_4 = param_4 + 1;
        cVar1 = *param_4;
        iVar4 = iVar9;
    }
    if (uVar3 != 0) {
        uVar7 = *param_2;
        do {
            uVar8 = uVar7 + 1;
            if (uVar8 < param_3) {
                *(undefined1 *)(param_1 + uVar7) = 0x20;
                uVar8 = *param_2 + 1;
            }
            uVar3 = uVar3 + 1;
            *param_2 = uVar8;
            uVar7 = uVar8;
        } while (uVar3 != 0);
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0007a6bc(int param_1, uint *param_2, uint param_3, undefined4 param_4,
                  uint param_5, uint param_6, int param_7, int param_8,
                  uint param_9, uint param_10)

{
    uint uVar1;
    uint uVar2;
    int extraout_r2;
    uint uVar3;
    char *pcVar4;
    uint uVar5;
    char *pcVar6;
    uint uVar7;
    uint uVar8;
    uint uVar9;
    uint uVar10;
    longlong lVar11;
    uint local_88;
    int local_80;
    uint local_7c;
    uint local_70;
    uint local_6c;
    char acStack_59[45];
    int local_2c;

    uVar8 = param_10 & 0x20;
    local_2c = __stack_chk_guard;
    local_80 = param_8;
    if ((param_10 & 0x80) == 0) {
        uVar3 = (int)param_6 >> 0x1f;
        local_88 = (uVar3 ^ param_5) - uVar3;
        local_7c = (uVar3 ^ param_6) - (uVar3 + ((uVar3 ^ param_5) < uVar3));
        if ((int)param_6 < 0) {
            local_70 = 1;
            local_6c = 0x2d;
        } else if ((param_10 & 2) == 0) {
            local_70 = param_10 & 4;
            local_6c = local_70;
            if (local_70 != 0) {
                local_70 = 1;
                local_6c = 0x20;
            }
        } else {
            local_70 = 1;
            local_6c = 0x2b;
        }
    } else {
        local_88 = param_5;
        local_70 = 0;
        local_6c = 0;
        local_7c = param_6;
    }
    lVar11 = CONCAT44(local_7c, local_88);
    if ((param_10 & 0x40) == 0) {
        pcVar6 = "0123456789abcdef";
    } else {
        pcVar6 = "0123456789ABCDEF";
    }
    uVar3 = 0;
    pcVar4 = acStack_59 + 1;
    do {
        uVar1 = uVar3;
        uVar3 = uVar1 + 1;
        lVar11 = FUN_0009bfd0((int)lVar11, (int)((ulonglong)lVar11 >> 0x20),
                              param_7, param_7 >> 0x1f);
        *pcVar4 = pcVar6[extraout_r2];
        pcVar4 = pcVar4 + 1;
    } while (lVar11 != 0 && uVar3 < 0x2b);
    uVar9 = (uint)(local_88 != 0 || local_7c != 0) & param_10 >> 3;
    uVar2 = param_9;
    if (uVar9 != 0) {
        uVar9 = 0;
        if (param_7 == 8) {
            if ((int)param_9 <= (int)uVar3) {
                uVar7 = 1;
                uVar2 = uVar1 + 2;
                goto LAB_0007a7cc;
            }
        } else if (param_7 == 0x10) {
            uVar7 = param_9 - uVar3;
            if ((param_10 & 0x40) == 0) {
                uVar9 = 0x78;
            } else {
                uVar9 = 0x58;
            }
            goto LAB_0007a7cc;
        }
    }
    uVar7 = param_9 - uVar3;
LAB_0007a7cc:
    if (uVar8 != 0) {
        uVar8 = uVar3;
        if (uVar3 == ((int)uVar3 / 3) * 3) {
            uVar8 = uVar1;
        }
        uVar8 = (int)uVar8 / 3;
        uVar7 = uVar7 - uVar8;
        local_80 = param_8 - uVar8;
    }
    uVar7 = uVar7 & ~((int)uVar7 >> 0x1f);
    if ((int)uVar2 < (int)uVar3) {
        uVar2 = uVar3;
    }
    local_70 = (local_80 - uVar2) - local_70;
    if (uVar9 != 0) {
        local_70 = local_70 - 2;
    }
    uVar1 = local_70 & ~((int)local_70 >> 0x1f);
    if ((param_10 & 1) == 0) {
        if (((uint)(param_9 == 0xffffffff) & param_10 >> 4) == 0) {
            if (0 < (int)local_70) {
                uVar2 = *param_2;
                uVar10 = uVar1;
                do {
                    uVar5 = uVar2 + 1;
                    if (uVar5 < param_3) {
                        *(undefined1 *)(param_1 + uVar2) = 0x20;
                        uVar5 = *param_2 + 1;
                    }
                    uVar10 = uVar10 - 1;
                    *param_2 = uVar5;
                    uVar2 = uVar5;
                } while (uVar10 != 0);
                if ((int)uVar1 < 1) {
                    uVar1 = uVar1 - 1;
                } else {
                    uVar1 = 0;
                }
            }
        } else {
            uVar7 = uVar7 + uVar1;
            uVar1 = 0;
        }
    } else {
        uVar1 = -uVar1;
    }
    if (local_6c != 0) {
        uVar2 = *param_2 + 1;
        if (uVar2 < param_3) {
            *(char *)(param_1 + *param_2) = (char)local_6c;
            uVar2 = *param_2 + 1;
        }
        *param_2 = uVar2;
    }
    if (uVar9 != 0) {
        uVar2 = *param_2;
        uVar10 = uVar2 + 1;
        if (uVar10 < param_3) {
            *(undefined1 *)(param_1 + uVar2) = 0x30;
            uVar2 = *param_2;
            uVar10 = uVar2 + 1;
        }
        *param_2 = uVar10;
        if (uVar2 + 2 < param_3) {
            *(char *)(param_1 + uVar10) = (char)uVar9;
            uVar10 = *param_2;
        }
        *param_2 = uVar10 + 1;
    }
    if (uVar7 != 0) {
        uVar2 = *param_2;
        do {
            uVar9 = uVar2 + 1;
            if (uVar9 < param_3) {
                *(undefined1 *)(param_1 + uVar2) = 0x30;
                uVar9 = *param_2 + 1;
            }
            uVar7 = uVar7 - 1;
            *param_2 = uVar9;
            uVar2 = uVar9;
        } while (uVar7 != 0);
    }
    if (0 < (int)uVar3) {
        do {
            while (true) {
                uVar2 = *param_2;
                uVar3 = uVar3 - 1;
                uVar9 = uVar2 + 1;
                if (uVar9 < param_3) {
                    *(char *)(param_1 + uVar2) = (acStack_59 + 1)[uVar3];
                    uVar2 = *param_2;
                    uVar9 = uVar2 + 1;
                }
                *param_2 = uVar9;
                if ((int)uVar3 < 1 || (int)uVar8 < 1)
                    break;
                if (uVar3 == (uVar3 / 3) * 3) {
                    if (uVar2 + 2 < param_3) {
                        *(undefined1 *)(param_1 + uVar9) = 0x2c;
                        uVar9 = *param_2;
                    }
                    *param_2 = uVar9 + 1;
                }
            }
        } while (uVar3 != 0);
    }
    if (uVar1 != 0) {
        uVar8 = *param_2;
        do {
            uVar3 = uVar8 + 1;
            if (uVar3 < param_3) {
                *(undefined1 *)(param_1 + uVar8) = 0x20;
                uVar3 = *param_2 + 1;
            }
            uVar1 = uVar1 + 1;
            *param_2 = uVar3;
            uVar8 = uVar3;
        } while (uVar1 != 0);
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007af9c) */
/* WARNING: Removing unreachable block (ram,0x0007b698) */
/* WARNING: Removing unreachable block (ram,0x0007afa4) */
/* WARNING: Removing unreachable block (ram,0x0007af6c) */
/* WARNING: Removing unreachable block (ram,0x0007ae68) */
/* WARNING: Removing unreachable block (ram,0x0007ae78) */
/* WARNING: Removing unreachable block (ram,0x0007af2c) */
/* WARNING: Removing unreachable block (ram,0x0007af7c) */
/* WARNING: Removing unreachable block (ram,0x0007af3c) */

void FUN_0007ab20(int param_1, uint *param_2, uint param_3, int param_4,
                  uint param_5, uint param_6, undefined4 *param_7)

{
    byte *pbVar1;
    uint uVar2;
    char *pcVar3;
    int extraout_r2;
    uint uVar4;
    int extraout_r2_00;
    int extraout_r2_01;
    undefined1 uVar5;
    uint uVar6;
    int iVar7;
    char *pcVar8;
    int iVar9;
    uint uVar10;
    undefined4 uVar11;
    int iVar12;
    uint uVar13;
    uint uVar14;
    uint uVar15;
    uint uVar16;
    uint uVar17;
    bool bVar18;
    double in_d0;
    double dVar19;
    double dVar20;
    double dVar21;
    double dVar22;
    longlong lVar23;
    longlong lVar24;
    longlong lVar25;
    char *local_e0;
    int local_c8;
    uint local_c4;
    undefined4 local_b4;
    char local_b0[47];
    char acStack_81[45];
    int local_54;

    if (param_5 == 0xffffffff) {
        param_5 = 6;
    }
    local_54 = __stack_chk_guard;
    if (in_d0 < 0.0) {
        local_c8 = 0x2d;
    LAB_0007ae8c:
        if (in_d0 + in_d0 == in_d0) {
            if ((param_6 & 0x40) == 0) {
                pbVar1 = &DAT_000abb70;
            } else {
                pbVar1 = &DAT_000abb74;
            }
            pcVar8 = (char *)(uint)*pbVar1;
            if (local_c8 == 0) {
            LAB_0007aec0:
                pcVar3 = local_b0 + 4 + local_c8 + -1;
                do {
                    pcVar3 = pcVar3 + 1;
                    *pcVar3 = (char)pcVar8;
                    local_c8 = local_c8 + 1;
                    pbVar1 = pbVar1 + 1;
                    pcVar8 = (char *)(uint)*pbVar1;
                    local_e0 = local_b0 + 4;
                } while (pcVar8 != (char *)0x0);
            } else {
                local_b0[4] = (undefined1)local_c8;
                bVar18 = pcVar8 == (char *)0x0;
                if (bVar18) {
                    pcVar8 = local_b0 + 4;
                }
                local_c8 = 1;
                local_e0 = pcVar8;
                if (!bVar18)
                    goto LAB_0007aec0;
            }
            FUN_0007a520(param_1, param_2, param_3, local_e0, param_4, local_c8,
                         param_6);
        LAB_0007af0c:
            if (local_54 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
    } else {
        if ((param_6 & 2) == 0) {
            if ((param_6 & 4) == 0) {
                local_c8 = 0;
            } else {
                local_c8 = 0x20;
            }
        } else {
            local_c8 = 0x2b;
        }
        if (in_d0 != 0.0)
            goto LAB_0007ae8c;
    }
    dVar22 = -in_d0;
    if ((param_6 & 0x300) == 0) {
        if (0.0 <= in_d0) {
            dVar22 = in_d0;
        }
        uVar17 = param_5;
        if (0x12 < (int)param_5) {
            uVar17 = 0x13;
        }
        uVar15 = param_6 & 0x200;
        dVar19 = dVar22;
        if (uVar15 == 0) {
            iVar12 = 0;
            local_c4 = 0;
            goto LAB_0007acb8;
        }
        dVar21 = 1.0;
        iVar12 = 0;
        local_c4 = 0;
    } else {
        local_c4 = param_6 & 0x100;
        if (local_c4 != 0) {
            param_5 = param_5 - 1;
            local_c4 = (uint)((param_6 & 8) == 0);
        }
        dVar19 = dVar22;
        if (0.0 <= in_d0) {
            dVar19 = in_d0;
        }
        if ((1.0 <= dVar19) || (dVar19 <= 0.0)) {
            iVar12 = 0;
        } else {
            iVar12 = -1;
            do {
                dVar19 = dVar19 * 10.0;
                if ((1.0 <= dVar19) || (dVar19 <= 0.0))
                    break;
                iVar12 = iVar12 + -1;
            } while (iVar12 != -99);
        }
        uVar17 = param_5;
        if (10.0 <= dVar19) {
            iVar12 = iVar12 + 1;
            do {
                dVar19 = dVar19 / 10.0;
                if (dVar19 < 10.0)
                    break;
                iVar12 = iVar12 + 1;
            } while (iVar12 < 99);
            if (0.0 <= in_d0) {
                dVar22 = in_d0;
            }
            if (0x12 < (int)param_5) {
                uVar17 = 0x13;
            }
            if (iVar12 < 1)
                goto LAB_0007b6c8;
            dVar21 = 1.0;
            iVar9 = iVar12;
            do {
                iVar9 = iVar9 + -1;
                dVar21 = dVar21 * 10.0;
            } while (iVar9 != 0);
        } else {
            if (0.0 <= in_d0) {
                dVar22 = in_d0;
            }
            if (0x12 < (int)param_5) {
                uVar17 = 0x13;
            }
        LAB_0007b6c8:
            if (iVar12 == 0) {
                uVar15 = 1;
                dVar21 = 1.0;
                dVar19 = dVar22;
                goto LAB_0007acb4;
            }
            dVar21 = 1.0;
            iVar9 = iVar12;
            do {
                iVar9 = iVar9 + 1;
                dVar21 = dVar21 / 10.0;
            } while (iVar9 != 0);
        }
        uVar15 = 1;
        dVar19 = dVar22;
    }
LAB_0007acb4:
    dVar22 = dVar19 / dVar21;
LAB_0007acb8:
LAB_0007acd4:
    if (1.8446744073709552e+19 <= dVar22)
        goto LAB_0007b060;
    lVar23 = FUN_0009c010(SUB84(dVar22, 0), (int)((ulonglong)dVar22 >> 0x20));
    dVar21 = (double)FUN_0009bec4();
    if (dVar22 < dVar21) {
        lVar23 = CONCAT44((int)((ulonglong)lVar23 >> 0x20) -
                              (uint)((int)lVar23 == 0),
                          (int)lVar23 + -1);
    }
    if (lVar23 == -1)
        goto LAB_0007b060;
    dVar21 = 1.0;
    uVar6 = uVar17;
    if (0 < (int)param_5) {
        do {
            uVar6 = uVar6 - 1;
            dVar21 = dVar21 * 10.0;
        } while (uVar6 != 0);
        if ((int)uVar17 < 1) {
            uVar6 = uVar17 - 1;
        } else {
            uVar6 = 0;
        }
    }
    for (; uVar6 != 0; uVar6 = uVar6 + 1) {
        dVar21 = dVar21 / 10.0;
    }
    lVar24 = FUN_0009c010(SUB84(dVar21, 0), (int)((ulonglong)dVar21 >> 0x20));
    uVar6 = (uint)((ulonglong)lVar24 >> 0x20);
    dVar21 =
        (double)FUN_0009bec4((int)lVar23, (int)((ulonglong)lVar23 >> 0x20));
    dVar20 = (double)FUN_0009bec4((uint)lVar24, uVar6);
    dVar20 = (dVar22 - dVar21) * dVar20;
    if (1.8446744073709552e+19 <= dVar20) {
        if (0.5 <= dVar20 - 1.8446744073709552e+19) {
            lVar25 = 0;
            goto LAB_0007ae04;
        }
    LAB_0007afd0:
        lVar23 = lVar23 + 1;
        if (uVar15 != 0 && lVar23 == 10) {
            iVar12 = iVar12 + 1;
            lVar23 = 1;
        }
        lVar25 = 0;
    } else {
        lVar25 =
            FUN_0009c010(SUB84(dVar20, 0), (int)((ulonglong)dVar20 >> 0x20));
        dVar22 = (double)FUN_0009bec4();
        if (dVar20 < dVar22) {
            iVar9 = (int)lVar25 + -1;
            iVar7 = (int)((ulonglong)lVar25 >> 0x20) - (uint)((int)lVar25 == 0);
            lVar25 = CONCAT44(iVar7, iVar9);
            dVar22 = (double)FUN_0009bec4(iVar9, iVar7);
        }
        if (0.5 <= dVar20 - dVar22) {
            lVar25 = lVar25 + 1;
        }
    LAB_0007ae04:
        uVar2 = (uint)((ulonglong)lVar25 >> 0x20);
        bVar18 = uVar2 <= uVar6;
        if (uVar6 == uVar2) {
            bVar18 = (uint)lVar25 <= (uint)lVar24;
        }
        if (!bVar18 || lVar24 == lVar25)
            goto LAB_0007afd0;
    }
    if (((param_6 & 0x100) != 0) && (uVar15 != 0 && iVar12 <= (int)uVar17)) {
        if (iVar12 + 4 < 0 != SCARRY4(iVar12, 4))
            goto LAB_0007b5bc;
        param_5 = uVar17 - iVar12;
        uVar15 = 0;
        uVar17 = param_5;
        dVar22 = dVar19;
        if (0x12 < (int)param_5) {
            uVar17 = 0x13;
        }
        goto LAB_0007acd4;
    }
    if (uVar15 != 0) {
    LAB_0007b5bc:
        if (iVar12 < 0) {
            uVar5 = 0x2d;
            iVar12 = -iVar12;
        } else {
            uVar5 = 0x2b;
        }
        lVar24 = (longlong)iVar12;
        iVar12 = 0;
        do {
            uVar11 = (undefined4)((ulonglong)lVar24 >> 0x20);
            uVar15 = iVar12 + 1;
            FUN_0009bfd0((int)lVar24, uVar11, 10, 0);
            local_b0[iVar12] = "0123456789abcdef"[extraout_r2_01];
            iVar12 = 1;
            lVar24 = FUN_0009bfd0((int)lVar24, uVar11, 10, 0);
            bVar18 = lVar24 != 0 && uVar15 < 2;
        } while (bVar18);
        if (uVar15 == 1) {
            local_b0[1] = uVar15 != 1 && bVar18;
        }
        uVar15 = 4;
        local_b0[2] = uVar5;
        if ((param_6 & 0x40) == 0) {
            local_b0[3] = 0x65;
        } else {
            local_b0[3] = 0x45;
        }
    }
    pcVar8 = local_b0 + 4;
    uVar6 = 0;
    do {
        uVar2 = uVar6;
        uVar11 = (undefined4)((ulonglong)lVar23 >> 0x20);
        FUN_0009bfd0((int)lVar23, uVar11, 10, 0);
        uVar6 = uVar2 + 1;
        *pcVar8 = "0123456789abcdef"[extraout_r2];
        lVar23 = FUN_0009bfd0((int)lVar23, uVar11, 10, 0);
        pcVar8 = pcVar8 + 1;
    } while (lVar23 != 0 && uVar6 < 0x2b);
    uVar16 = uVar17;
    if (lVar25 == 0) {
        uVar10 = uVar6;
        if (local_c4 == 0) {
            uVar4 = uVar17;
            uVar14 = 0;
            goto LAB_0007b4c0;
        }
        uVar16 = 0;
        uVar4 = 0;
        uVar14 = 0;
        local_c4 = uVar17;
    LAB_0007b154:
        uVar17 = (param_6 << 0x1c) >> 0x1f;
    } else {
        uVar14 = 0;
        pcVar8 = acStack_81 + 1;
        local_b4 = uVar6;
        do {
            uVar11 = (undefined4)((ulonglong)lVar25 >> 0x20);
            FUN_0009bfd0((int)lVar25, uVar11, 10, 0);
            uVar14 = uVar14 + 1;
            *pcVar8 = "0123456789abcdef"[extraout_r2_00];
            lVar25 = FUN_0009bfd0((int)lVar25, uVar11, 10, 0);
            pcVar8 = pcVar8 + 1;
        } while (lVar25 != 0 && uVar14 < 0x2b);
        uVar4 = uVar17 - uVar14;
        uVar10 = local_b4;
        if (local_c4 != 0) {
            local_c4 = 0;
            pcVar8 = acStack_81 + 1;
            if ((int)uVar14 < 1) {
                uVar16 = 0;
                uVar4 = 0;
                local_c4 = uVar17;
                goto LAB_0007b154;
            }
            do {
                if (*pcVar8 != '0') {
                    uVar16 = uVar17 - local_c4;
                    goto LAB_0007b4c0;
                }
                local_c4 = local_c4 + 1;
                pcVar8 = pcVar8 + 1;
            } while (local_c4 != uVar14);
            uVar16 = uVar17 - local_c4;
            uVar14 = local_c4;
        }
    LAB_0007b4c0:
        if ((int)uVar16 < 1)
            goto LAB_0007b154;
        uVar17 = 1;
    }
    uVar13 = param_6 & 0x20;
    if (uVar13 != 0) {
        uVar13 = uVar6;
        if (uVar6 == ((int)uVar6 / 3) * 3) {
            uVar13 = uVar2;
        }
        uVar13 = (int)uVar13 / 3;
    }
    iVar12 = ((((param_4 - uVar6) - uVar15) - uVar16) - uVar13) - uVar17;
    if (local_c8 != 0) {
        iVar12 = iVar12 + -1;
    }
    if (iVar12 < 0) {
        iVar9 = 0;
    LAB_0007b29c:
        if (local_c8 != 0) {
            uVar2 = *param_2 + 1;
            if (uVar2 < param_3) {
                *(char *)(param_1 + *param_2) = (char)local_c8;
                uVar2 = *param_2 + 1;
            }
            *param_2 = uVar2;
        }
    } else {
        if ((param_6 & 1) != 0) {
            iVar9 = -iVar12;
            goto LAB_0007b29c;
        }
        iVar9 = 0;
        if ((param_6 & 0x10) == 0) {
            if (iVar12 != 0) {
                uVar2 = *param_2;
                iVar9 = iVar12;
                do {
                    uVar16 = uVar2 + 1;
                    if (uVar16 < param_3) {
                        *(undefined1 *)(param_1 + uVar2) = 0x20;
                        uVar16 = *param_2 + 1;
                    }
                    iVar9 = iVar9 + -1;
                    *param_2 = uVar16;
                    uVar2 = uVar16;
                } while (iVar9 != 0);
            }
            goto LAB_0007b29c;
        }
        if (iVar12 == 0)
            goto LAB_0007b29c;
        uVar2 = *param_2;
        if (local_c8 != 0) {
            uVar16 = uVar2 + 1;
            if (uVar2 + 1 < param_3) {
                *(char *)(param_1 + uVar2) = (char)local_c8;
                uVar16 = *param_2 + 1;
            }
            uVar2 = uVar16;
            *param_2 = uVar2;
        }
        do {
            uVar16 = uVar2 + 1;
            if (uVar16 < param_3) {
                *(undefined1 *)(param_1 + uVar2) = 0x30;
                uVar16 = *param_2 + 1;
            }
            iVar12 = iVar12 + -1;
            *param_2 = uVar16;
            uVar2 = uVar16;
        } while (iVar12 != 0);
        iVar9 = 0;
    }
    if (0 < (int)uVar6) {
        do {
            while (true) {
                uVar6 = *param_2;
                uVar10 = uVar10 - 1;
                uVar2 = uVar6 + 1;
                if (uVar2 < param_3) {
                    *(char *)(param_1 + uVar6) = (local_b0 + 4)[uVar10];
                    uVar6 = *param_2;
                    uVar2 = uVar6 + 1;
                }
                *param_2 = uVar2;
                if ((int)uVar10 < 1 || (int)uVar13 < 1)
                    break;
                if (uVar10 % 3 == 0) {
                    if (uVar6 + 2 < param_3) {
                        *(undefined1 *)(param_1 + uVar2) = 0x2c;
                        uVar2 = *param_2;
                    }
                    *param_2 = uVar2 + 1;
                }
            }
        } while (uVar10 != 0);
    }
    if (uVar17 != 0) {
        uVar17 = *param_2 + 1;
        if (uVar17 < param_3) {
            *(undefined1 *)(param_1 + *param_2) = 0x2e;
            uVar17 = *param_2 + 1;
        }
        *param_2 = uVar17;
    }
    if (0 < (int)uVar4) {
        uVar17 = *param_2;
        do {
            uVar6 = uVar17 + 1;
            if (uVar6 < param_3) {
                *(undefined1 *)(param_1 + uVar17) = 0x30;
                uVar6 = *param_2 + 1;
            }
            uVar4 = uVar4 - 1;
            *param_2 = uVar6;
            uVar17 = uVar6;
        } while (uVar4 != 0);
    }
    if ((int)local_c4 < (int)uVar14) {
        uVar17 = *param_2;
        do {
            uVar6 = uVar17 + 1;
            uVar2 = uVar14 - 1;
            if (uVar6 < param_3) {
                *(char *)(param_1 + uVar17) = acStack_81[uVar14];
                uVar6 = *param_2 + 1;
            }
            *param_2 = uVar6;
            uVar17 = uVar6;
            uVar14 = uVar2;
        } while (local_c4 != uVar2);
    }
    if (uVar15 != 0) {
        uVar17 = *param_2;
        do {
            uVar6 = uVar17 + 1;
            uVar2 = uVar15 - 1;
            if (uVar6 < param_3) {
                *(char *)(param_1 + uVar17) = local_b0[uVar15 - 1];
                uVar6 = *param_2 + 1;
            }
            *param_2 = uVar6;
            uVar17 = uVar6;
            uVar15 = uVar2;
        } while (uVar2 != 0);
    }
    if (iVar9 != 0) {
        uVar17 = *param_2;
        do {
            uVar15 = uVar17 + 1;
            if (uVar15 < param_3) {
                *(undefined1 *)(param_1 + uVar17) = 0x20;
                uVar15 = *param_2 + 1;
            }
            iVar9 = iVar9 + 1;
            *param_2 = uVar15;
            uVar17 = uVar15;
        } while (iVar9 != 0);
    }
    goto LAB_0007af0c;
LAB_0007b060:
    *param_7 = 1;
    goto LAB_0007af0c;
}

void FUN_0007b6f8(int param_1, uint param_2, char *param_3, uint *param_4)

{
    uint uVar1;
    int *piVar2;
    uint uVar3;
    uint *puVar4;
    char cVar5;
    undefined4 uVar6;
    int iVar7;
    undefined8 *puVar8;
    uint *puVar9;
    uint uVar10;
    uint uVar11;
    uint uVar12;
    uint uVar13;
    uint uVar14;
    uint local_34;
    int local_30;
    int local_2c;

    uVar12 = param_2;
    if (param_2 != 0) {
        uVar12 = 1;
    }
    if (param_1 != 0) {
        uVar12 = 0;
    }
    local_2c = __stack_chk_guard;
    if (uVar12 != 0) {
        param_2 = 0;
    }
    local_34 = 0;
    cVar5 = *param_3;
    uVar3 = 0;
    local_30 = 0;
    param_3 = param_3 + 1;
    uVar1 = 0xffffffff;
    uVar10 = 0;
    uVar12 = 0;
    uVar14 = 0;
LAB_0007b774:
    uVar13 = uVar14;
    if (cVar5 != '\0') {
        do {
            uVar11 = uVar1;
            uVar14 = uVar13;
            switch (uVar13) {
            case 1:
                switch (cVar5) {
                case ' ':
                    cVar5 = *param_3;
                    uVar3 = uVar3 | 4;
                    param_3 = param_3 + 1;
                    goto LAB_0007b774;
                case '!':
                    break;
                case '\"':
                    break;
                case '#':
                    cVar5 = *param_3;
                    uVar3 = uVar3 | 8;
                    param_3 = param_3 + 1;
                    goto LAB_0007b774;
                case '$':
                    break;
                case '%':
                    break;
                case '&':
                    break;
                case '\'':
                    cVar5 = *param_3;
                    uVar3 = uVar3 | 0x20;
                    param_3 = param_3 + 1;
                    goto LAB_0007b774;
                case '(':
                    break;
                case ')':
                    break;
                case '*':
                    break;
                case '+':
                    cVar5 = *param_3;
                    uVar3 = uVar3 | 2;
                    param_3 = param_3 + 1;
                    goto LAB_0007b774;
                case ',':
                    break;
                case '-':
                    uVar3 = uVar3 | 1;
                    goto LAB_0007b8a4;
                case '.':
                    break;
                case '/':
                    break;
                case '0':
                    cVar5 = *param_3;
                    uVar3 = uVar3 | 0x10;
                    param_3 = param_3 + 1;
                    goto LAB_0007b774;
                }
                uVar14 = 2;
                goto LAB_0007b774;
            case 2:
                goto LAB_0007b924;
            case 3:
                if (cVar5 == '.') {
                    cVar5 = *param_3;
                    param_3 = param_3 + 1;
                    uVar14 = 4;
                } else {
                LAB_0007b91c:
                    uVar14 = 5;
                }
                goto LAB_0007b774;
            case 4:
                uVar11 = (uint)(byte)(cVar5 - 0x30);
                if (uVar1 == 0xffffffff) {
                    if (uVar11 < 10)
                        goto LAB_0007b8a4;
                    uVar1 = 0;
                LAB_0007bd6c:
                    if (cVar5 != '*')
                        goto LAB_0007b91c;
                    uVar1 = *param_4;
                    cVar5 = *param_3;
                    param_4 = param_4 + 1;
                    param_3 = param_3 + 1;
                    uVar1 = uVar1 | (int)uVar1 >> 0x1f;
                    uVar14 = 5;
                    goto LAB_0007b774;
                }
                if (9 < uVar11)
                    goto LAB_0007bd6c;
                if ((int)((0x7fffffff - uVar11) / 10) < (int)uVar1)
                    goto LAB_0007bfb8;
                uVar11 = uVar11 + uVar1 * 10;
            LAB_0007b8a4:
                cVar5 = *param_3;
                param_3 = param_3 + 1;
                uVar1 = uVar11;
                if (cVar5 == '\0')
                    goto LAB_0007b8b8;
                break;
            case 5:
                switch (cVar5) {
                case 'L':
                    cVar5 = *param_3;
                    uVar14 = 6;
                    param_3 = param_3 + 1;
                    uVar10 = uVar13;
                    goto LAB_0007b774;
                case 'M':
                    break;
                case 'N':
                    break;
                case 'O':
                    break;
                case 'P':
                    break;
                case 'Q':
                    break;
                case 'R':
                    break;
                case 'S':
                    break;
                case 'T':
                    break;
                case 'U':
                    break;
                case 'V':
                    break;
                case 'W':
                    break;
                case 'X':
                    break;
                case 'Y':
                    break;
                case 'Z':
                    break;
                case '[':
                    break;
                case '\\':
                    break;
                case ']':
                    break;
                case '^':
                    break;
                case '_':
                    break;
                case '`':
                    break;
                case 'a':
                    break;
                case 'b':
                    break;
                case 'c':
                    break;
                case 'd':
                    break;
                case 'e':
                    break;
                case 'f':
                    break;
                case 'g':
                    break;
                case 'h':
                    cVar5 = *param_3;
                    if (cVar5 == 'h') {
                        cVar5 = param_3[1];
                        param_3 = param_3 + 2;
                        uVar10 = 1;
                    } else {
                        param_3 = param_3 + 1;
                        uVar10 = 2;
                    }
                    uVar14 = 6;
                    goto LAB_0007b774;
                case 'i':
                    break;
                case 'j':
                    cVar5 = *param_3;
                    uVar14 = 6;
                    param_3 = param_3 + 1;
                    uVar10 = 8;
                    goto LAB_0007b774;
                case 'k':
                    break;
                case 'l':
                    cVar5 = *param_3;
                    if (cVar5 == 'l') {
                        cVar5 = param_3[1];
                        param_3 = param_3 + 2;
                        uVar10 = 4;
                    } else {
                        param_3 = param_3 + 1;
                        uVar10 = 3;
                    }
                    uVar14 = 6;
                    goto LAB_0007b774;
                case 'm':
                    break;
                case 'n':
                    break;
                case 'o':
                    break;
                case 'p':
                    break;
                case 'q':
                    break;
                case 'r':
                    break;
                case 's':
                    break;
                case 't':
                    cVar5 = *param_3;
                    uVar14 = 6;
                    param_3 = param_3 + 1;
                    uVar10 = 7;
                    goto LAB_0007b774;
                case 'u':
                    break;
                case 'v':
                    break;
                case 'w':
                    break;
                case 'x':
                    break;
                case 'y':
                    break;
                case 'z':
                    uVar14 = 6;
                    cVar5 = *param_3;
                    param_3 = param_3 + 1;
                    uVar10 = 6;
                    goto LAB_0007b774;
                }
                uVar14 = 6;
                goto LAB_0007b774;
            case 6:
                puVar9 = param_4;
                uVar14 = local_34;
                switch (cVar5) {
                case '%':
                    uVar14 = local_34 + 1;
                    if (uVar14 < param_2) {
                        *(undefined1 *)(param_1 + local_34) = 0x25;
                    }
                    break;
                case '&':
                    break;
                case '\'':
                    break;
                case '(':
                    break;
                case ')':
                    break;
                case '*':
                    break;
                case '+':
                    break;
                case ',':
                    break;
                case '-':
                    break;
                case '.':
                    break;
                case '/':
                    break;
                case '0':
                    break;
                case '1':
                    break;
                case '2':
                    break;
                case '3':
                    break;
                case '4':
                    break;
                case '5':
                    break;
                case '6':
                    break;
                case '7':
                    break;
                case '8':
                    break;
                case '9':
                    break;
                case ':':
                    break;
                case ';':
                    break;
                case '<':
                    break;
                case '=':
                    break;
                case '>':
                    break;
                case '?':
                    break;
                case '@':
                    break;
                case 'A':
                    goto LAB_0007bd14;
                case 'B':
                    break;
                case 'C':
                    break;
                case 'D':
                    break;
                case 'E':
                    uVar3 = uVar3 | 0x40;
                    goto LAB_0007bce0;
                case 'F':
                LAB_0007bd14:
                    uVar3 = uVar3 | 0x40;
                    goto LAB_0007bd18;
                case 'G':
                    uVar3 = uVar3 | 0x40;
                    goto LAB_0007bc70;
                case 'H':
                    break;
                case 'I':
                    break;
                case 'J':
                    break;
                case 'K':
                    break;
                case 'L':
                    break;
                case 'M':
                    break;
                case 'N':
                    break;
                case 'O':
                    break;
                case 'P':
                    break;
                case 'Q':
                    break;
                case 'R':
                    break;
                case 'S':
                    break;
                case 'T':
                    break;
                case 'U':
                    break;
                case 'V':
                    break;
                case 'W':
                    break;
                case 'X':
                    uVar3 = uVar3 | 0x40;
                    goto LAB_0007bc34;
                case 'Y':
                    break;
                case 'Z':
                    break;
                case '[':
                    break;
                case '\\':
                    break;
                case ']':
                    break;
                case '^':
                    break;
                case '_':
                    break;
                case '`':
                    break;
                case 'a':
                    goto LAB_0007bd18;
                case 'b':
                    break;
                case 'c':
                    uVar14 = local_34 + 1;
                    puVar9 = param_4 + 1;
                    if (uVar14 < param_2) {
                        *(char *)(param_1 + local_34) = (char)*param_4;
                    }
                    break;
                case 'd':
                    goto LAB_0007be88;
                case 'e':
                LAB_0007bce0:
                    uVar3 = uVar3 | 0x200;
                    puVar8 =
                        (undefined8 *)((uint)((int)param_4 + 7) & 0xfffffff8);
                    uVar6 = (undefined4)*puVar8;
                    goto LAB_0007bca8;
                case 'f':
                LAB_0007bd18:
                    puVar8 =
                        (undefined8 *)((uint)((int)param_4 + 7) & 0xfffffff8);
                    uVar6 = (undefined4)*puVar8;
                LAB_0007bca8:
                    FUN_0007ab20(uVar6, param_1, &local_34, param_2, uVar12,
                                 uVar1, uVar3, &local_30);
                    puVar9 = (uint *)(puVar8 + 1);
                    uVar14 = local_34;
                    if (local_30 != 0)
                        goto LAB_0007b8b8;
                    break;
                case 'g':
                LAB_0007bc70:
                    uVar3 = uVar3 | 0x100;
                    puVar8 =
                        (undefined8 *)((uint)((int)param_4 + 7) & 0xfffffff8);
                    uVar6 = (undefined4)*puVar8;
                    if (uVar1 == 0) {
                        uVar1 = 1;
                    }
                    goto LAB_0007bca8;
                case 'h':
                    break;
                case 'i':
                LAB_0007be88:
                    switch (uVar10) {
                    case 1:
                        uVar10 = (uint)(char)(byte)*param_4;
                        puVar9 = param_4 + 1;
                        uVar14 = (int)uVar10 >> 0x1f;
                        break;
                    case 2:
                        uVar10 = (uint)(short)(ushort)*param_4;
                        puVar9 = param_4 + 1;
                        uVar14 = (int)uVar10 >> 0x1f;
                        break;
                    case 3:
                    default:
                    switchD_0007be90_default:
                        uVar10 = *param_4;
                        puVar9 = param_4 + 1;
                        uVar14 = (int)uVar10 >> 0x1f;
                        break;
                    case 4:
                        goto LAB_0007bfa4;
                    case 5:
                        goto switchD_0007be90_default;
                    case 6:
                        uVar10 = *param_4;
                        uVar14 = 0;
                        puVar9 = param_4 + 1;
                        break;
                    case 7:
                        goto switchD_0007be90_default;
                    case 8:
                    LAB_0007bfa4:
                        puVar4 =
                            (uint *)((uint)((int)param_4 + 7) & 0xfffffff8);
                        puVar9 = puVar4 + 2;
                        uVar10 = *puVar4;
                        uVar14 = puVar4[1];
                    }
                    FUN_0007a6bc(param_1, &local_34, param_2, 10, uVar10,
                                 uVar14, 10, uVar12, uVar1, uVar3);
                    uVar14 = local_34;
                    break;
                case 'j':
                    break;
                case 'k':
                    break;
                case 'l':
                    break;
                case 'm':
                    break;
                case 'n':
                    puVar9 = param_4 + 1;
                    param_4 = (uint *)*param_4;
                    switch (uVar10) {
                    case 1:
                        *(char *)param_4 = (char)local_34;
                        goto switchD_0007bad8_default;
                    case 2:
                        *(short *)param_4 = (short)local_34;
                        goto switchD_0007bad8_default;
                    case 3:
                        break;
                    case 4:
                        goto LAB_0007bf94;
                    case 5:
                        break;
                    case 6:
                        break;
                    case 7:
                        break;
                    case 8:
                    LAB_0007bf94:
                        *param_4 = local_34;
                        param_4[1] = 0;
                        goto switchD_0007bad8_default;
                    }
                    *param_4 = local_34;
                    break;
                case 'o':
                    uVar6 = 8;
                    goto LAB_0007bc38;
                case 'p':
                    uVar14 = *param_4;
                    puVar9 = param_4 + 1;
                    if (uVar14 == 0) {
                        FUN_0007a520(param_1, &local_34, param_2, "(nil)",
                                     uVar12, 0xffffffff, uVar3);
                        uVar14 = local_34;
                    } else {
                        FUN_0007a6bc(param_1, &local_34, param_2, uVar14,
                                     uVar14, 0, 0x10, uVar12, uVar1,
                                     uVar3 | 0x88);
                        uVar14 = local_34;
                    }
                    break;
                case 'q':
                    break;
                case 'r':
                    break;
                case 's':
                    FUN_0007a520(param_1, &local_34, param_2, *param_4, uVar12,
                                 uVar1, uVar3);
                    puVar9 = param_4 + 1;
                    uVar14 = local_34;
                    break;
                case 't':
                    break;
                case 'u':
                    uVar6 = 10;
                    goto LAB_0007bc38;
                case 'v':
                    break;
                case 'w':
                    break;
                case 'x':
                LAB_0007bc34:
                    uVar6 = 0x10;
                LAB_0007bc38:
                    switch (uVar10) {
                    case 1:
                        uVar10 = (uint)(byte)*param_4;
                        uVar14 = 0;
                        puVar9 = param_4 + 1;
                        break;
                    case 2:
                        uVar10 = (uint)(ushort)*param_4;
                        uVar14 = 0;
                        puVar9 = param_4 + 1;
                        break;
                    case 3:
                    default:
                    switchD_0007bc44_default:
                        uVar10 = *param_4;
                        uVar14 = 0;
                        puVar9 = param_4 + 1;
                        break;
                    case 4:
                        goto LAB_0007bdf8;
                    case 5:
                        goto switchD_0007bc44_default;
                    case 6:
                        goto switchD_0007bc44_default;
                    case 7:
                        uVar10 = *param_4;
                        puVar9 = param_4 + 1;
                        uVar14 = (int)uVar10 >> 0x1f;
                        break;
                    case 8:
                    LAB_0007bdf8:
                        puVar4 =
                            (uint *)((uint)((int)param_4 + 7) & 0xfffffff8);
                        puVar9 = puVar4 + 2;
                        uVar10 = *puVar4;
                        uVar14 = puVar4[1];
                    }
                    FUN_0007a6bc(param_1, &local_34, param_2, uVar6, uVar10,
                                 uVar14, uVar6, uVar12, uVar1, uVar3 | 0x80);
                    uVar14 = local_34;
                }
            switchD_0007bad8_default:
                local_34 = uVar14;
                uVar3 = 0;
                cVar5 = *param_3;
                param_3 = param_3 + 1;
                uVar1 = 0xffffffff;
                param_4 = puVar9;
                uVar10 = uVar3;
                uVar12 = uVar3;
                uVar14 = uVar3;
                goto LAB_0007b774;
            default:
                if (cVar5 == '%') {
                    uVar13 = 1;
                } else {
                    if (local_34 + 1 < param_2) {
                        *(char *)(param_1 + local_34) = cVar5;
                    }
                    uVar13 = 0;
                    local_34 = local_34 + 1;
                }
                goto LAB_0007b8a4;
            }
        } while (true);
    }
    goto LAB_0007b8b8;
LAB_0007b924:
    uVar13 = (uint)(byte)(cVar5 - 0x30);
    if (9 < uVar13) {
        if (cVar5 == '*') {
            uVar12 = *param_4;
            uVar14 = 3;
            cVar5 = *param_3;
            param_4 = param_4 + 1;
            param_3 = param_3 + 1;
            if ((int)uVar12 < 0) {
                uVar3 = uVar3 | 1;
                uVar12 = -uVar12;
            }
        } else {
            uVar14 = 3;
        }
        goto LAB_0007b774;
    }
    if ((int)uVar12 <= (int)((0x7fffffff - uVar13) / 10)) {
        cVar5 = *param_3;
        param_3 = param_3 + 1;
        uVar12 = uVar13 + uVar12 * 10;
        goto LAB_0007b774;
    }
LAB_0007bfb8:
    local_30 = 1;
LAB_0007b8b8:
    if (local_34 < param_2) {
        *(undefined1 *)(param_1 + local_34) = 0;
    } else if (param_2 != 0) {
        *(undefined1 *)(param_1 + param_2 + -1) = 0;
    }
    if (local_30 == 0) {
        uVar12 = local_34;
        if (local_34 < 0x7fffffff)
            goto LAB_0007b8f4;
        iVar7 = 0x22;
    } else {
        iVar7 = 0x4b;
    }
    piVar2 = __errno_location();
    *piVar2 = iVar7;
    uVar12 = 0xffffffff;
LAB_0007b8f4:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar12);
    }
    return;
}

void FUN_0007c054(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_4 = param_4;
    FUN_0007b6f8(param_1, param_2, param_3, &uStack_4, &uStack_4);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007c0b8(int param_1)

{
    int iVar1;
    int iVar2;
    long lVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 < 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("socket.c", 0x51, 0, "(int)fd >= 0");
    }
    if (DAT_000c7d7c == -1) {
        lVar3 = sysconf(4);
        if ((lVar3 < 0x1a) && (lVar3 = sysconf(4), lVar3 < 10)) {
            iVar2 = 0;
        } else {
            lVar3 = sysconf(4);
            if (lVar3 < 0x1a) {
                lVar3 = sysconf(4);
                iVar2 = lVar3 + -10;
            } else {
                iVar2 = 0x10;
            }
        }
        DAT_000c7d7c = iVar2;
        if (0 < debug) {
            lVar3 = sysconf(4);
            FUN_00074d28("move_fd: estimated max descriptors: %d, initial "
                         "socket boundary: %d\n",
                         lVar3, iVar2);
        }
    }
    do {
        if (DAT_000c7d7c <= param_1)
            break;
        iVar2 = fcntl(param_1, 0);
        if (iVar2 != -1) {
            close(param_1);
            param_1 = iVar2;
            break;
        }
        if (DAT_000c7d7c < 10) {
            DAT_000c7d7c = 10;
        }
        DAT_000c7d7c = DAT_000c7d7c + -10;
        if (0 < debug) {
            FUN_00074d28("move_fd: selecting new socket boundary: %d\n",
                         DAT_000c7d7c);
        }
    } while (0 < DAT_000c7d7c);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_0007c26c(int param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = fcntl(param_1, 4, 0x800);
    if (iVar2 < 0) {
        FUN_00074e00(3, "fcntl(O_NONBLOCK) fails on fd #%d: %m", param_1);
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007c2e8(short *param_1)

{
    int iVar1;
    short sVar2;
    int iVar3;
    int *piVar4;
    char *pcVar5;
    char *__buf;
    int iVar6;
    uint uVar7;
    int iVar8;

    iVar3 = __stack_chk_guard;
    piVar4 = __errno_location();
    iVar6 = *piVar4;
    __buf = lib_stringbuf + lib_nextbuf * 0x80;
    uVar7 = lib_nextbuf + 1 & 0xf;
    memset(__buf, 0, 0x80);
    lib_nextbuf = uVar7;
    if (param_1 == (short *)0x0) {
        FUN_0007d4dc(__buf, "(null)", 0x80);
        goto LAB_0007c384;
    }
    sVar2 = *param_1;
    if (sVar2 != 2) {
        if (sVar2 == 10) {
            inet_ntop(10, param_1 + 4, __buf, 0x80);
            iVar8 = *(int *)(param_1 + 0xc);
            if ((iVar8 != 0) && (pcVar5 = strchr(__buf, 0x25),
                                 uVar7 = lib_nextbuf, pcVar5 == (char *)0x0)) {
                iVar1 = lib_nextbuf * 0x80;
                pcVar5 = lib_stringbuf + iVar1;
                memset(pcVar5, 0, 0x80);
                lib_nextbuf = uVar7 + 1 & 0xf;
                FUN_0007c054(pcVar5, 0x80, "%s%%%lu", __buf, iVar8);
                lib_stringbuf[iVar1 + 0x7f] = 0;
                __buf = pcVar5;
            }
            goto LAB_0007c384;
        }
        if (sVar2 != 0) {
            FUN_0007c054(__buf, 0x80, "(socktoa unknown family %d)");
            goto LAB_0007c384;
        }
    }
    inet_ntop(2, param_1 + 2, __buf, 0x80);
LAB_0007c384:
    iVar8 = __stack_chk_guard;
    *piVar4 = iVar6;
    if (iVar3 == iVar8) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__buf);
}

void FUN_0007c47c(short *param_1)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    undefined4 uVar4;
    char *pcVar5;
    uint uVar6;
    undefined1 *__s;
    int iVar7;

    iVar1 = __stack_chk_guard;
    piVar3 = __errno_location();
    iVar7 = *piVar3;
    uVar4 = FUN_0007c2e8(param_1);
    __s = lib_stringbuf + lib_nextbuf * 0x80;
    uVar6 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    if (*param_1 == 10) {
        pcVar5 = "[%s]:%hu";
    } else {
        pcVar5 = "%s:%hu";
    }
    lib_nextbuf = uVar6 & 0xf;
    FUN_0007c054(__s, 0x80, pcVar5, uVar4,
                 param_1[1] << 8 | (ushort)param_1[1] >> 8);
    iVar2 = __stack_chk_guard;
    *piVar3 = iVar7;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Removing unreachable block (ram,0x0007c600) */

void FUN_0007c568(short *param_1)

{
    uint uVar1;
    uint uVar2;

    if (*param_1 == 2) {
        uVar2 = 4;
    } else {
        if (*param_1 != 10) {
            return;
        }
        uVar2 = 0x10;
    }
    uVar1 = 0;
    do {
        uVar1 = uVar1 + 1;
    } while (uVar1 < uVar2);
    return;
}

void FUN_0007c60c(undefined4 *param_1)

{
    int iVar1;
    undefined4 local_60;
    undefined1 auStack_5c[24];
    undefined4 local_44;
    undefined4 uStack_40;
    undefined4 uStack_3c;
    undefined4 uStack_38;
    undefined4 local_34;
    undefined4 uStack_30;
    undefined4 uStack_2c;
    undefined4 local_28;
    undefined4 local_24;
    undefined4 local_20;
    int local_1c;

    uStack_40 = param_1[1];
    uStack_3c = param_1[2];
    uStack_38 = param_1[3];
    local_44 = *param_1;
    local_24 = 0;
    local_28 = 0;
    local_20 = 0;
    local_34 = param_1[4];
    uStack_30 = param_1[5];
    uStack_2c = param_1[6];
    local_1c = __stack_chk_guard;
    FUN_00084ce8(auStack_5c, &local_44);
    iVar1 = FUN_000849dc(auStack_5c, &local_60);
    if (iVar1 != 0) {
        local_60 = 0xffffffff;
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(local_60);
}

void FUN_0007c6b8(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00074244();
    ssl_init_done = 1;
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007c714(void)

{
    int iVar1;
    uint uVar2;

    iVar1 = __stack_chk_guard;
    uVar2 = OpenSSL_version_num();
    if (((uVar2 ^ 0x1010104f) & 0xfffff00f) != 0) {
        FUN_00074e00(
            4, "OpenSSL version mismatch. Built against %lx, you have %lx",
            0x1010104f, uVar2);
        __fprintf_chk(
            stderr, 1,
            "OpenSSL version mismatch. Built against %lx, you have %lx\n",
            0x1010104f, uVar2);
    }
    if (ssl_init_done == 0) {
        if (iVar1 == __stack_chk_guard) {
            FUN_0007c6b8();
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007c7ec(int param_1)

{
    int iVar1;
    char *pcVar2;

    iVar1 = __stack_chk_guard;
    if (ssl_init_done == 0) {
        FUN_0007c6b8();
    }
    pcVar2 = OBJ_nid2sn(param_1);
    if (param_1 == 0x37e) {
        if (debug == 0) {
            pcVar2 = "AES128CMAC";
        } else {
            pcVar2 = "AES128CMAC";
            __fprintf_chk(stderr, 1, "%s:%d:%s():%s:nid\n", "ssl_init.c", 0xdf,
                          "keytype_name", "AES128CMAC");
        }
    } else if (pcVar2 == (char *)0x0) {
        pcVar2 = "(unknown key type)";
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pcVar2);
}

void FUN_0007c910(byte *param_1, uint *param_2)

{
    int iVar1;
    __int32_t **pp_Var2;
    int iVar3;
    int iVar4;
    char *name;
    EVP_MD *md;
    undefined4 uVar5;
    undefined4 uVar6;
    byte *pbVar7;
    uint uVar8;
    byte *s;

    iVar1 = __stack_chk_guard;
    if (ssl_init_done == 0) {
        FUN_0007c6b8();
    }
    iVar4 = lib_nextbuf;
    s = lib_stringbuf + lib_nextbuf * 0x80;
    memset(s, 0, 0x80);
    lib_nextbuf = iVar4 + 1U & 0xf;
    FUN_0007d4dc(s, param_1, 0x80);
    uVar8 = (uint)(byte)lib_stringbuf[iVar4 * 0x80];
    if (uVar8 != 0) {
        pp_Var2 = __ctype_toupper_loc();
        pbVar7 = s;
        do {
            *pbVar7 = (byte)(*pp_Var2)[uVar8];
            pbVar7 = pbVar7 + 1;
            uVar8 = (uint)*pbVar7;
        } while (uVar8 != 0);
    }
    iVar3 = OBJ_sn2nid((char *)s);
    iVar4 = iVar3;
    if (iVar3 == 0) {
        iVar4 = strcmp("AES128CMAC", (char *)s);
        if (iVar4 == 0) {
            if (debug == 0) {
                iVar4 = 0x37e;
            } else {
                iVar4 = 0x37e;
                __fprintf_chk(stderr, 1, "%s:%d:%s():%s:key\n", "ssl_init.c",
                              0x87, "keytype_from_text", "AES128CMAC");
            }
        } else {
            pp_Var2 = __ctype_tolower_loc();
            if ((*pp_Var2)[*param_1] != 0x6d)
                goto LAB_0007ca98;
            iVar4 = 4;
        }
    }
    iVar3 = iVar4;
    if (param_2 != (uint *)0x0) {
        name = OBJ_nid2sn(iVar4);
        md = EVP_get_digestbyname(name);
        if ((md == (EVP_MD *)0x0) ||
            (uVar8 = EVP_MD_size(md), uVar6 = stderr, uVar8 == 0)) {
            uVar6 = stderr;
            if (iVar4 != 0x37e) {
                uVar5 = FUN_0007c7ec(iVar4);
                __fprintf_chk(uVar6, 1,
                              "key type %s is not supported by OpenSSL\n",
                              uVar5);
                iVar3 = 0;
                uVar6 = FUN_0007c7ec(iVar4);
                FUN_00074e00(3, "key type %s is not supported by OpenSSL\n",
                             uVar6);
                goto LAB_0007ca98;
            }
            if (debug == 0) {
                uVar8 = 0x10;
            } else {
                __fprintf_chk(stderr, 1, "%s:%d:%s():%s:len\n", "ssl_init.c",
                              0xa4, "keytype_from_text", "AES128CMAC");
                uVar8 = 0x10;
            }
        } else if (0x14 < uVar8) {
            uVar5 = FUN_0007c7ec(iVar4);
            __fprintf_chk(uVar6, 1,
                          "key type %s %u octet digests are too big, max %lu\n",
                          uVar5, uVar8, 0x14);
            uVar6 = FUN_0007c7ec(iVar4);
            FUN_00074e00(3, "key type %s %u octet digests are too big, max %lu",
                         uVar6, uVar8, 0x14);
            iVar3 = 0;
            goto LAB_0007ca98;
        }
        *param_2 = uVar8;
    }
LAB_0007ca98:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

/* WARNING: Removing unreachable block (ram,0x0007cdf0) */
/* WARNING: Removing unreachable block (ram,0x0007ce30) */
/* WARNING: Removing unreachable block (ram,0x0007d140) */

void FUN_0007d0ec(uint param_1)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    uint *puVar4;
    undefined *puVar5;
    uint uVar6;
    uint uVar7;
    undefined1 *puVar8;
    undefined1 *__s;
    int iVar9;

    iVar2 = __stack_chk_guard;
    puVar4 = &DAT_000c4c84;
    piVar3 = __errno_location();
    iVar9 = *piVar3;
    iVar1 = lib_nextbuf * 0x80;
    __s = lib_stringbuf + iVar1;
    uVar7 = lib_nextbuf + 1;
    memset(__s, 0, 0x80);
    puVar5 = &DAT_000a7f7c;
    puVar8 = __s;
    lib_nextbuf = uVar7 & 0xf;
    do {
        uVar7 = puVar4[1];
        if ((param_1 & *puVar4) == 0) {
            uVar7 = puVar4[2];
        }
        if (uVar7 != 0) {
            uVar6 = (iVar1 + 0x118df8) - (int)puVar8;
            uVar7 = FUN_0007c054(puVar8, uVar6, "%s%s", puVar5, uVar7);
            if (uVar6 <= uVar7) {
                FUN_0007c054(
                    __s, 0x80,
                    "decode_bitflags(%s) can\'t decode 0x%x in %d bytes",
                    "kern_st", param_1, 0x80);
                *piVar3 = iVar9;
                break;
            }
            puVar8 = puVar8 + uVar7;
            puVar5 = &DAT_000a6ec8;
        }
        puVar4 = puVar4 + 3;
    } while (puVar4 != &DAT_000c4d44);
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007d468) */

void FUN_0007d3c4(uint param_1)

{
    int iVar1;
    uint *puVar2;
    uint uVar3;
    undefined1 *__s;

    iVar1 = __stack_chk_guard;
    if ((param_1 & 0x80) == 0) {
        if ((param_1 & 0x100) == 0) {
            puVar2 = &DAT_000c4ec4;
        } else {
            param_1 = param_1 & 0xfffffeff;
            puVar2 = &DAT_000c511c;
        }
    } else {
        param_1 = param_1 & 0xffffff7f;
        puVar2 = &DAT_000c4ffc;
    }
    uVar3 = *puVar2;
    do {
        if (uVar3 == 0xffffffff) {
            __s = lib_stringbuf + lib_nextbuf * 0x80;
            uVar3 = lib_nextbuf + 1;
            memset(__s, 0, 0x80);
            lib_nextbuf = uVar3 & 0xf;
            FUN_0007c054(__s, 0x80, "%s_%d", puVar2[1], param_1);
        LAB_0007cf10:
            if (iVar1 != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail(__s);
            }
            return;
        }
        if (uVar3 == param_1) {
            __s = (undefined1 *)puVar2[1];
            goto LAB_0007cf10;
        }
        puVar2 = puVar2 + 3;
        uVar3 = *puVar2;
    } while (true);
}

/* WARNING: Removing unreachable block (ram,0x0007d4cc) */

void FUN_0007d480(int param_1)

{
    int iVar1;
    int *piVar2;
    int *piVar3;
    undefined1 *__s;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    piVar2 = (int *)&UNK_000c50bc;
    piVar3 = piVar2;
    if (param_1 != 0) {
        do {
            piVar2 = piVar3 + 3;
            if (*piVar2 == -1) {
                __s = lib_stringbuf + lib_nextbuf * 0x80;
                uVar4 = lib_nextbuf + 1;
                memset(__s, 0, 0x80);
                lib_nextbuf = uVar4 & 0xf;
                FUN_0007c054(__s, 0x80, "%s_%d", piVar3[4], param_1);
                goto LAB_0007cf10;
            }
            piVar3 = piVar2;
        } while (*piVar2 != param_1);
    }
    __s = (undefined1 *)piVar2[1];
LAB_0007cf10:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(__s);
    }
    return;
}

void FUN_0007d4dc(char *param_1, char *param_2, int param_3)

{
    char cVar1;
    int iVar2;
    char *pcVar3;
    char *pcVar4;
    char *pcVar5;

    iVar2 = __stack_chk_guard;
    pcVar5 = param_2;
    if (param_3 == 0)
        goto LAB_0007d570;
    pcVar3 = param_1;
    while (pcVar4 = pcVar5 + 1, param_1 + param_3 + -1 != pcVar3) {
        cVar1 = *pcVar5;
        *pcVar3 = cVar1;
        pcVar3 = pcVar3 + 1;
        pcVar5 = pcVar4;
        if (cVar1 == '\0')
            goto LAB_0007d54c;
    }
    param_1[param_3 + -1] = '\0';
    cVar1 = *pcVar5;
    while (pcVar4 = pcVar5 + 1, pcVar5 = pcVar4, cVar1 != '\0') {
    LAB_0007d570:
        cVar1 = *pcVar5;
    }
LAB_0007d54c:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pcVar4 + (-1 - (int)param_2));
}

void FUN_0007d58c(char *param_1, char *param_2, int param_3)

{
    int iVar1;
    size_t sVar2;
    char *pcVar3;
    char cVar4;
    char *pcVar5;
    bool bVar6;

    iVar1 = __stack_chk_guard;
    if (param_3 == 0) {
        pcVar5 = (char *)0x0;
    LAB_0007d658:
        sVar2 = strlen(param_2);
        pcVar5 = pcVar5 + sVar2;
    } else {
        if (*param_1 == '\0') {
            pcVar5 = (char *)0x0;
        } else {
            pcVar5 = param_1 + 1;
            do {
                pcVar3 = pcVar5;
                if (param_1 + param_3 == pcVar3)
                    break;
                pcVar5 = pcVar3 + 1;
            } while (*pcVar3 != '\0');
            pcVar5 = pcVar3 + -(int)param_1;
            param_3 = param_3 - (int)pcVar5;
            param_1 = pcVar3;
            if (param_3 == 0)
                goto LAB_0007d658;
        }
        cVar4 = *param_2;
        pcVar3 = param_2;
        if (cVar4 != '\0') {
            do {
                bVar6 = param_3 != 1;
                if (bVar6) {
                    *param_1 = cVar4;
                    param_3 = param_3 + -1;
                }
                pcVar3 = pcVar3 + 1;
                cVar4 = *pcVar3;
                if (bVar6) {
                    param_1 = param_1 + 1;
                }
            } while (cVar4 != '\0');
            pcVar5 = pcVar3 + ((int)pcVar5 - (int)param_2);
        }
        *param_1 = '\0';
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pcVar5);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007d6e0) */

void sigint_handler(void)

{
    if (DAT_00117228 != (code *)0x0) {
        /* WARNING: Could not recover jumptable at 0x0007d6c8. Too many branches
         */
        /* WARNING: Treating indirect jump as call */
        (*DAT_00117228)();
        return;
    }
    return;
}

void FUN_0007d6f0(int param_1, _union_1051 param_2)

{
    int *piVar1;
    int iVar2;
    undefined4 extraout_r3;
    undefined4 uVar3;
    _union_1051 local_134;
    sigset_t sStack_130;
    undefined4 local_b0;
    sigaction sStack_a8;
    int local_1c;

    local_1c = __stack_chk_guard;
    memset(&local_134, 0, 0x8c);
    sigemptyset(&sStack_130);
    uVar3 = extraout_r3;
    if (param_1 == 0x1d) {
        uVar3 = 0x10000000;
    }
    local_134 = param_2;
    if (param_1 == 0x1d) {
        local_b0 = uVar3;
    }
    while (iVar2 = sigaction(param_1, (sigaction *)&local_134, &sStack_a8),
           iVar2 == -1) {
        piVar1 = __errno_location();
        if (*piVar1 != 4) {
            perror("sigaction");
            /* WARNING: Subroutine does not return */
            exit(1);
        }
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0007d854(uint *param_1, byte *param_2, undefined4 *param_3,
                  uint param_4)

{
    ushort uVar1;
    int iVar2;
    ulonglong uVar3;
    int iVar4;
    ushort **ppuVar5;
    int *piVar6;
    __int32_t **pp_Var7;
    uint uVar8;
    byte *pbVar9;
    ushort *puVar10;
    ushort uVar11;
    bool bVar12;
    uint local_48;
    uint local_38;
    uint local_34;

    iVar4 = __stack_chk_guard;
    ppuVar5 = __ctype_b_loc();
    puVar10 = *ppuVar5;
    do {
        pbVar9 = param_2;
        uVar8 = (uint)*pbVar9;
        param_2 = pbVar9 + 1;
        uVar1 = puVar10[uVar8];
        uVar11 = uVar1 & 0x2000;
    } while ((uVar1 & 0x2000) != 0);
    if (uVar8 == 0x2d) {
        uVar11 = 1;
        pbVar9 = param_2;
    } else if (uVar8 == 0x2b) {
        pbVar9 = param_2;
    }
    if (param_4 == 0) {
        if (*pbVar9 == 0x30) {
            pp_Var7 = __ctype_toupper_loc();
            if ((*pp_Var7)[pbVar9[1]] == 0x58) {
                pbVar9 = pbVar9 + 2;
                param_4 = 0x10;
            } else {
                pbVar9 = pbVar9 + 1;
                param_4 = 8;
            }
        } else {
            param_4 = 10;
        }
    } else if (param_4 == 0x10) {
        if ((*pbVar9 == 0x30) &&
            (pp_Var7 = __ctype_toupper_loc(), (*pp_Var7)[pbVar9[1]] == 0x58)) {
            pbVar9 = pbVar9 + 2;
        }
    } else if (0x21 < param_4 - 3) {
        piVar6 = __errno_location();
        *piVar6 = 0x22;
        *param_1 = 0xffffffff;
        param_1[1] = 0xffffffff;
        goto LAB_0007d9b0;
    }
    bVar12 = false;
    local_34 = 0;
    local_38 = 0;
    uVar8 = (uint)*pbVar9;
    if (uVar8 == 0) {
    LAB_0007d98c:
        piVar6 = __errno_location();
        *piVar6 = 0x16;
    } else {
        do {
            uVar1 = puVar10[uVar8];
            if ((uVar1 & 0x800) == 0) {
                if ((uVar1 & 0x100) != 0) {
                    uVar8 = uVar8 - 0x37 & 0xff;
                    goto LAB_0007d97c;
                }
                if ((uVar1 & 0x200) != 0) {
                    uVar8 = uVar8 - 0x57 & 0xff;
                    goto LAB_0007d97c;
                }
            LAB_0007d984:
                if (!bVar12)
                    goto LAB_0007d98c;
                break;
            }
            uVar8 = uVar8 - 0x30 & 0xff;
        LAB_0007d97c:
            if ((int)param_4 <= (int)uVar8)
                goto LAB_0007d984;
            bVar12 = true;
            uVar3 = (ulonglong)local_38;
            iVar2 = local_38 * ((int)param_4 >> 0x1f);
            local_48 = (uint)(param_4 * uVar3);
            local_38 = local_48 + uVar8;
            local_34 = iVar2 + param_4 * local_34 +
                       (int)(param_4 * uVar3 >> 0x20) +
                       (uint)CARRY4(local_48, uVar8);
            pbVar9 = pbVar9 + 1;
            uVar8 = (uint)*pbVar9;
        } while (uVar8 != 0);
    }
    if (param_3 != (undefined4 *)0x0) {
        *param_3 = pbVar9;
    }
    if (uVar11 != 0) {
        uVar8 = -local_38;
        local_34 = ~local_34;
        bVar12 = local_38 == 0;
        local_38 = uVar8;
        if (bVar12) {
            local_34 = local_34 + 1;
        }
    }
    *param_1 = local_38;
    param_1[1] = local_34;
LAB_0007d9b0:
    if (iVar4 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

/* WARNING: Removing unreachable block (ram,0x0007db50) */

void FUN_0007daf4(void)

{
    return;
}

void FUN_0007db5c(int *param_1, uint *param_2, uint *param_3)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;

    iVar1 = __stack_chk_guard;
    uVar4 = *param_2;
    uVar6 = *param_3;
    uVar5 = param_3[1];
    uVar3 = param_2[1];
    *param_1 = uVar4 + uVar6;
    iVar2 = __stack_chk_guard;
    param_1[1] = uVar3 + uVar5 + (uint)CARRY4(uVar4, uVar6);
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007dbc0(int *param_1, uint *param_2, uint *param_3)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;

    iVar1 = __stack_chk_guard;
    uVar4 = *param_2;
    uVar6 = *param_3;
    uVar5 = param_3[1];
    uVar3 = param_2[1];
    *param_1 = uVar4 - uVar6;
    iVar2 = __stack_chk_guard;
    param_1[1] = uVar3 - (uVar5 + (uVar4 < uVar6));
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0007dc74) */

void FUN_0007dc24(int *param_1, uint *param_2, uint param_3)

{
    uint uVar1;
    uint uVar2;

    uVar1 = *param_2;
    uVar2 = param_2[1];
    *param_1 = uVar1 + param_3;
    param_1[1] = uVar2 + ((int)param_3 >> 0x1f) + (uint)CARRY4(uVar1, param_3);
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007dcd0) */

void FUN_0007dc80(int *param_1, uint *param_2, uint param_3)

{
    uint uVar1;
    uint uVar2;

    uVar1 = *param_2;
    uVar2 = param_2[1];
    *param_1 = uVar1 - param_3;
    param_1[1] = uVar2 - (((int)param_3 >> 0x1f) + (uint)(uVar1 < param_3));
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007dd88) */

void FUN_0007dd38(int *param_1, uint *param_2, uint param_3)

{
    uint uVar1;
    uint uVar2;

    uVar1 = *param_2;
    uVar2 = param_2[1];
    *param_1 = uVar1 - param_3;
    param_1[1] = uVar2 - (uVar1 < param_3);
    return;
}

void FUN_0007dd94(void *param_1)

{
    int iVar1;
    undefined4 uVar2;
    uint uVar3;
    int __errnum;
    char *pcVar4;
    size_t __stacksize;
    undefined4 local_158;
    uint local_154;
    undefined4 local_150;
    undefined4 local_14c;
    pthread_attr_t pStack_148;
    sigset_t sStack_124;
    sigset_t sStack_a4;
    int local_24;

    *(undefined4 *)((int)param_1 + 8) = 0;
    local_24 = __stack_chk_guard;
    iVar1 = FUN_00078f08(&local_150, &local_158);
    if (iVar1 != 0) {
        FUN_00074e00(3, "start_blocking_thread: pipe_socketpair() %m");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    uVar2 = FUN_0007c0b8(local_150);
    *(undefined4 *)((int)param_1 + 0x34) = uVar2;
    uVar2 = FUN_0007c0b8(local_14c);
    *(undefined4 *)((int)param_1 + 0x38) = uVar2;
    *(undefined4 *)((int)param_1 + 0x3c) = local_158;
    uVar3 = fcntl(*(int *)((int)param_1 + 0x34), 3, 0);
    if (uVar3 == 0xffffffff) {
        FUN_00074e00(3, "start_blocking_thread: fcntl(F_GETFL) %m");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    iVar1 = fcntl(*(int *)((int)param_1 + 0x34), 4, uVar3 | 0x800);
    if (iVar1 == -1) {
        FUN_00074e00(3, "start_blocking_thread: fcntl(F_SETFL, O_NONBLOCK) %m");
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    (*addremove_io_fd)(*(undefined4 *)((int)param_1 + 0x34),
                       *(undefined4 *)((int)param_1 + 0x3c), 0);
    pthread_attr_init(&pStack_148);
    pthread_attr_setdetachstate(&pStack_148, 1);
    iVar1 = pthread_attr_getstacksize(&pStack_148, &local_154);
    if (iVar1 == 0) {
        if (local_154 < 0x10000) {
            __stacksize = 0x10000;
        } else {
            if (local_154 < 0x40001)
                goto LAB_0007de80;
            __stacksize = 0x40000;
        }
        iVar1 = pthread_attr_setstacksize(&pStack_148, __stacksize);
        if (iVar1 != 0) {
            pcVar4 = strerror(iVar1);
            FUN_00074e00(3,
                         "start_blocking_thread: "
                         "pthread_attr_setstacksize(0x%lx -> 0x%lx) -> %s",
                         local_154, __stacksize, pcVar4);
        }
    } else {
        pcVar4 = strerror(iVar1);
        FUN_00074e00(3,
                     "start_blocking_thread: pthread_attr_getstacksize() -> %s",
                     pcVar4);
    }
LAB_0007de80:
    uVar2 = FUN_00073ba4(0, 4, 0, 1);
    *(undefined4 *)((int)param_1 + 8) = uVar2;
    sigemptyset(&sStack_a4);
    sigaddset(&sStack_a4, 0xe);
    sigaddset(&sStack_a4, 10);
    sigaddset(&sStack_a4, 0xc);
    sigaddset(&sStack_a4, 1);
    sigaddset(&sStack_a4, 2);
    sigaddset(&sStack_a4, 3);
    sigaddset(&sStack_a4, 0xf);
    sigaddset(&sStack_a4, 7);
    sigemptyset(&sStack_124);
    pthread_sigmask(0, &sStack_a4, &sStack_124);
    __errnum = pthread_create((pthread_t *)((int)param_1 + 0x8c), &pStack_148,
                              blocking_thread, param_1);
    pthread_sigmask(2, &sStack_124, (__sigset_t *)0x0);
    pthread_attr_destroy(&pStack_148);
    iVar1 = __stack_chk_guard;
    if (__errnum != 0) {
        pcVar4 = strerror(__errnum);
        FUN_00074e00(3, "start_blocking_thread: pthread_create() -> %s",
                     pcVar4);
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    *(pthread_t **)((int)param_1 + 8) = (pthread_t *)((int)param_1 + 0x8c);
    if (local_24 == iVar1) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007e078(sem_t *param_1, timespec *param_2)

{
    int iVar1;
    int *piVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == (sem_t *)0x0) {
        piVar2 = __errno_location();
        iVar3 = -1;
        *piVar2 = 0x16;
    } else {
        do {
            if (param_2 == (timespec *)0x0) {
                iVar3 = sem_wait(param_1);
            } else {
                iVar3 = sem_timedwait(param_1, param_2);
            }
        } while ((iVar3 == -1) && (piVar2 = __errno_location(), *piVar2 == 4));
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

void FUN_0007e26c(sem_t *param_1, uint param_2)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = sem_init(param_1, 0, param_2);
    if (iVar2 != 0) {
        param_1 = (sem_t *)0x0;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

/* WARNING: Removing unreachable block (ram,0x0007e35c) */

void FUN_0007e2cc(int param_1)

{
    if (DAT_0011722c == (sem_t *)0x0) {
        return;
    }
    if (param_1 == 0) {
        sem_post(DAT_0011722c);
        return;
    }
    FUN_0007e078(DAT_0011722c, 0);
    return;
}

void FUN_0007e36c(void *param_1)

{
    /* WARNING: Subroutine does not return */
    pthread_exit(param_1);
}

void blocking_thread(void)

{
    FUN_00079588();
    /* WARNING: Subroutine does not return */
    FUN_0007e36c();
}

void FUN_0007e3c8(int param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    undefined4 uVar3;
    timespec local_24;
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = clock_gettime(0, &local_24);
    if (iVar1 == 0) {
        local_24.tv_sec = local_24.tv_sec + param_2;
        iVar1 = FUN_0007e078(*(undefined4 *)(param_1 + 0x30), &local_24);
        if (iVar1 == 0) {
            uVar3 = 0xffffffff;
        } else if ((iVar1 != -1) ||
                   (piVar2 = __errno_location(), uVar3 = 0, *piVar2 != 0x6e)) {
            uVar3 = 0xffffffff;
            FUN_00074e00(3, "worker_sleep: sem_timedwait: %m");
        }
    } else {
        uVar3 = 0xffffffff;
        FUN_00074e00(3, "worker_sleep: clock_gettime() failed: %m");
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0007e544(int param_1, uint *param_2, void *param_3)

{
    int iVar1;
    sem_t *__sem;
    undefined4 uVar2;
    uint *puVar3;
    void *pvVar4;
    int extraout_r1;
    int extraout_r1_00;
    uint uVar5;
    int iVar6;
    uint uVar7;
    int iVar8;
    size_t __n;
    uint uVar9;

    iVar6 = __stack_chk_guard;
    if (param_2 == (uint *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("work_thread.c", 0x12e, 0, "hdr != ((void *)0)");
    }
    if (param_3 == (void *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("work_thread.c", 0x12f, 0, "data != ((void *)0)");
    }
    uVar5 = *param_2;
    if (uVar5 < 0x19) {
        return;
    }
    __n = uVar5 - 0x18;
    if (*(int *)(param_1 + 8) == 0) {
        if (DAT_0011722c == 0) {
            DAT_0011722c = FUN_0007e26c(&DAT_00117230, 1);
        }
        uVar2 = FUN_0007e26c(param_1 + 0x4c, 1);
        *(undefined4 *)(param_1 + 4) = uVar2;
        uVar2 = FUN_0007e26c(param_1 + 0x5c, 0);
        *(undefined4 *)(param_1 + 0x1c) = uVar2;
        uVar2 = FUN_0007e26c(param_1 + 0x6c, 0);
        *(undefined4 *)(param_1 + 0x30) = uVar2;
        FUN_0007dd94(param_1);
        uVar5 = *param_2;
    }
    puVar3 = (uint *)FUN_00073ba4(0, uVar5, 0);
    uVar5 = param_2[1];
    uVar7 = param_2[2];
    uVar9 = param_2[3];
    *puVar3 = *param_2;
    puVar3[1] = uVar5;
    puVar3[2] = uVar7;
    puVar3[3] = uVar9;
    uVar5 = param_2[4];
    puVar3[5] = param_2[5];
    puVar3[4] = uVar5;
    pvVar4 = memcpy(puVar3 + 6, param_3, __n);
    iVar1 = __stack_chk_guard;
    if (iVar6 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pvVar4);
    }
    FUN_0007e078(*(undefined4 *)(param_1 + 4), 0);
    iVar6 = *(int *)(param_1 + 0x14);
    if (*(uint *)(param_1 + 0x10) <= (uint)(iVar6 - *(int *)(param_1 + 0x18))) {
        uVar7 = *(int *)(param_1 + 0x10) + 0x10;
        uVar2 = FUN_00073ba4(*(undefined4 *)(param_1 + 0xc), uVar7 * 4, 0);
        *(undefined4 *)(param_1 + 0xc) = uVar2;
        uVar5 = *(uint *)(param_1 + 0x10);
        if (uVar5 < uVar7) {
            iVar6 = uVar5 << 2;
            do {
                uVar5 = uVar5 + 1;
                *(undefined4 *)(*(int *)(param_1 + 0xc) + iVar6) = 0;
                iVar6 = iVar6 + 4;
            } while (uVar7 != uVar5);
        }
        iVar6 = *(int *)(param_1 + 0x10);
        *(uint *)(param_1 + 0x10) = uVar7;
        *(undefined4 *)(param_1 + 0x18) = 0;
        *(int *)(param_1 + 0x14) = iVar6;
    }
    iVar8 = *(int *)(param_1 + 0xc);
    FUN_0009b8ec(iVar6, *(undefined4 *)(param_1 + 0x10));
    if (*(int *)(iVar8 + extraout_r1 * 4) != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("work_thread.c", 0xdb, 2,
                     "((void *)0) == c->workitems[c->head_workitem % "
                     "c->workitems_alloc]");
    }
    iVar8 = *(int *)(param_1 + 0xc);
    FUN_0009b8ec(iVar6, *(undefined4 *)(param_1 + 0x10));
    __sem = *(sem_t **)(param_1 + 4);
    *(uint **)(iVar8 + extraout_r1_00 * 4) = puVar3;
    *(int *)(param_1 + 0x14) = iVar6 + 1;
    sem_post(__sem);
    sem_post(*(sem_t **)(param_1 + 0x1c));
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(0);
    }
    return;
}

void FUN_0007e6e8(int param_1, undefined4 param_2)

{
    int iVar1;
    sem_t *__sem;
    ssize_t sVar2;
    undefined4 uVar3;
    int extraout_r1;
    int extraout_r1_00;
    int iVar4;
    uint uVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    uint uVar9;

    iVar1 = __stack_chk_guard;
    FUN_0007e078(*(undefined4 *)(param_1 + 4), 0);
    iVar6 = *(int *)(param_1 + 0x28);
    iVar7 = *(int *)(param_1 + 0x2c);
    iVar4 = iVar6;
    if (*(uint *)(param_1 + 0x24) <= (uint)(iVar6 - iVar7)) {
        uVar9 = *(int *)(param_1 + 0x24) + 4;
        uVar3 = FUN_00073ba4(*(undefined4 *)(param_1 + 0x20), uVar9 * 4, 0);
        *(undefined4 *)(param_1 + 0x20) = uVar3;
        uVar5 = *(uint *)(param_1 + 0x24);
        if (uVar5 < uVar9) {
            iVar4 = uVar5 << 2;
            do {
                uVar5 = uVar5 + 1;
                *(undefined4 *)(*(int *)(param_1 + 0x20) + iVar4) = 0;
                iVar4 = iVar4 + 4;
            } while (uVar9 != uVar5);
        }
        iVar4 = *(int *)(param_1 + 0x24);
        *(uint *)(param_1 + 0x24) = uVar9;
        *(undefined4 *)(param_1 + 0x2c) = 0;
        *(int *)(param_1 + 0x28) = iVar4;
    }
    iVar8 = *(int *)(param_1 + 0x20);
    FUN_0009b8ec(iVar4, *(undefined4 *)(param_1 + 0x24));
    if (*(int *)(iVar8 + extraout_r1 * 4) == 0) {
        iVar8 = *(int *)(param_1 + 0x20);
        FUN_0009b8ec(iVar4, *(undefined4 *)(param_1 + 0x24));
        __sem = *(sem_t **)(param_1 + 4);
        *(undefined4 *)(iVar8 + extraout_r1_00 * 4) = param_2;
        *(int *)(param_1 + 0x28) = iVar4 + 1;
        sem_post(__sem);
        if ((iVar6 == iVar7) &&
            (sVar2 = write(*(int *)(param_1 + 0x38), &DAT_000a7f7c, 1),
             sVar2 != 1)) {
            FUN_00074e00(4, "async resolver: %s",
                         "failed to notify main thread!");
        }
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(0);
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0(
        "work_thread.c", 0xff, 2,
        "((void *)0) == c->responses[c->head_response % c->responses_alloc]");
}

void FUN_0007e870(int param_1)

{
    int iVar1;
    int iVar2;
    int extraout_r1;
    int iVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    do {
        FUN_0007e078(*(undefined4 *)(param_1 + 0x1c), 0);
        FUN_0007e078(*(undefined4 *)(param_1 + 4), 0);
        iVar4 = *(int *)(param_1 + 0x14);
        iVar2 = *(int *)(param_1 + 0x18);
        while (iVar4 != iVar2) {
            iVar3 = *(int *)(param_1 + 0xc);
            *(int *)(param_1 + 0x18) = iVar2 + 1;
            FUN_0009b8ec(iVar2, *(undefined4 *)(param_1 + 0x10));
            iVar3 = *(int *)(iVar3 + extraout_r1 * 4);
            *(undefined4 *)(*(int *)(param_1 + 0xc) + extraout_r1 * 4) = 0;
            iVar2 = iVar2 + 1;
            if (iVar3 != 0) {
                sem_post(*(sem_t **)(param_1 + 4));
                if (iVar3 == -1) {
                    FUN_0007e6e8(param_1, 0xffffffff);
                    iVar3 = 0;
                }
                if (iVar1 != __stack_chk_guard) {
                    /* WARNING: Subroutine does not return */
                    __stack_chk_fail(iVar3);
                }
                return;
            }
        }
        sem_post(*(sem_t **)(param_1 + 4));
    } while (true);
}

void FUN_0007e948(undefined4 *param_1)

{
    int *piVar1;
    ssize_t sVar2;
    int extraout_r1;
    int iVar3;
    int iVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    undefined1 auStack_4c[32];
    int local_2c;

    local_2c = __stack_chk_guard;
    do {
        sVar2 = read(param_1[0xd], auStack_4c, 0x20);
        if (sVar2 != -1)
            break;
        piVar1 = __errno_location();
    } while (*piVar1 == 4);
    FUN_0007e078(param_1[1], 0);
    iVar7 = param_1[10];
    iVar3 = param_1[0xb];
    if (iVar7 == iVar3) {
        iVar5 = 0;
        sem_post((sem_t *)param_1[1]);
    } else {
        do {
            iVar5 = param_1[8];
            iVar4 = iVar3 + 1;
            FUN_0009b8ec(iVar3, param_1[9]);
            iVar5 = *(int *)(iVar5 + extraout_r1 * 4);
            iVar6 = iVar7 - iVar4;
            if (iVar6 != 0) {
                iVar6 = 1;
            }
            *(undefined4 *)(param_1[8] + extraout_r1 * 4) = 0;
            if (iVar5 != 0) {
                iVar6 = 0;
            }
            iVar3 = iVar4;
        } while (iVar6 != 0);
        param_1[0xb] = iVar4;
        sem_post((sem_t *)param_1[1]);
        if (iVar5 == -1) {
            param_1[2] = 0;
            if ((sem_t *)param_1[1] != (sem_t *)0x0) {
                sem_destroy((sem_t *)param_1[1]);
            }
            param_1[1] = 0;
            if ((sem_t *)param_1[7] != (sem_t *)0x0) {
                sem_destroy((sem_t *)param_1[7]);
            }
            param_1[7] = 0;
            if ((sem_t *)param_1[0xc] != (sem_t *)0x0) {
                sem_destroy((sem_t *)param_1[0xc]);
            }
            iVar5 = 0;
            param_1[0xc] = 0;
            (*addremove_io_fd)(param_1[0xd], param_1[0xf], 1);
            close(param_1[0xe]);
            close(param_1[0xd]);
            param_1[5] = 0;
            param_1[6] = 0;
            param_1[10] = 0;
            param_1[0xb] = 0;
            param_1[0xe] = 0xffffffff;
            param_1[0xd] = 0xffffffff;
            *param_1 = 1;
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007eb4c) */

void FUN_0007eae8(int param_1)

{
    int iVar1;
    sem_t *__sem;
    undefined4 uVar2;
    int extraout_r1;
    int extraout_r1_00;
    uint uVar3;
    int iVar4;
    int iVar5;
    uint uVar6;

    iVar1 = __stack_chk_guard;
    if (*(int *)(param_1 + 4) == 0) {
        return;
    }
    FUN_0007e078(*(undefined4 *)(param_1 + 4), 0);
    iVar4 = *(int *)(param_1 + 0x14);
    if (*(uint *)(param_1 + 0x10) <= (uint)(iVar4 - *(int *)(param_1 + 0x18))) {
        uVar6 = *(int *)(param_1 + 0x10) + 0x10;
        uVar2 = FUN_00073ba4(*(undefined4 *)(param_1 + 0xc), uVar6 * 4, 0);
        *(undefined4 *)(param_1 + 0xc) = uVar2;
        uVar3 = *(uint *)(param_1 + 0x10);
        if (uVar3 < uVar6) {
            iVar4 = uVar3 << 2;
            do {
                uVar3 = uVar3 + 1;
                *(undefined4 *)(*(int *)(param_1 + 0xc) + iVar4) = 0;
                iVar4 = iVar4 + 4;
            } while (uVar6 != uVar3);
        }
        iVar4 = *(int *)(param_1 + 0x10);
        *(uint *)(param_1 + 0x10) = uVar6;
        *(undefined4 *)(param_1 + 0x18) = 0;
        *(int *)(param_1 + 0x14) = iVar4;
    }
    iVar5 = *(int *)(param_1 + 0xc);
    FUN_0009b8ec(iVar4, *(undefined4 *)(param_1 + 0x10));
    if (*(int *)(iVar5 + extraout_r1 * 4) != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("work_thread.c", 0xdb, 2,
                     "((void *)0) == c->workitems[c->head_workitem % "
                     "c->workitems_alloc]");
    }
    iVar5 = *(int *)(param_1 + 0xc);
    FUN_0009b8ec(iVar4, *(undefined4 *)(param_1 + 0x10));
    __sem = *(sem_t **)(param_1 + 4);
    *(undefined4 *)(iVar5 + extraout_r1_00 * 4) = 0xffffffff;
    *(int *)(param_1 + 0x14) = iVar4 + 1;
    sem_post(__sem);
    sem_post(*(sem_t **)(param_1 + 0x1c));
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(0);
    }
    return;
}

void FUN_0007eb58(undefined4 *param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    int *piVar3;
    undefined1 *puVar4;
    uint uVar5;

    iVar1 = __stack_chk_guard;
    if (((param_1 == (undefined4 *)0x0) ||
         (puVar4 = (undefined1 *)*param_1, puVar4 == (undefined1 *)0x0)) ||
        (uVar5 = param_2 - (int)puVar4, (int)uVar5 < 1)) {
        piVar3 = __errno_location();
        uVar2 = 0xffffffff;
        *piVar3 = 0x16;
    } else {
        uVar2 = FUN_0007b6f8(puVar4, uVar5);
        if (0 < (int)uVar2) {
            if (uVar2 < uVar5) {
                puVar4 = puVar4 + uVar2;
            } else {
                uVar2 = 0;
            }
        }
        *puVar4 = 0;
        *param_1 = puVar4;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0007ec04(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_4 = param_4;
    FUN_0007eb58(param_1, param_2, param_3, &uStack_4, &uStack_4);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

int FUN_0007ec68(int param_1, int param_2, int param_3)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00076274(param_1 + -1, param_2 + -1, param_3 + -1);
    if (iVar1 == __stack_chk_guard) {
        return iVar2 + 1;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007ecc0(void)

{
    (*DAT_000c7d80)();
    /* WARNING: Subroutine does not return */
    abort();
}

/* WARNING: Removing unreachable block (ram,0x0007ed64) */

void FUN_0007ed00(code *param_1)

{
    DAT_000c7d80 = param_1;
    if (param_1 == (code *)0x0) {
        DAT_000c7d80 = FUN_0007ee20;
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007ee04) */

void FUN_0007ed7c(undefined4 param_1)

{
    switch (param_1) {
    case 0:
        break;
    case 1:
        break;
    case 2:
        break;
    case 3:
    }
    return;
}

void FUN_0007ee20(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    FILE *pFVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    int iVar5;
    undefined4 *puVar6;
    char *pcVar7;
    int local_238;
    undefined4 local_234;
    undefined4 local_230;
    undefined4 local_22c[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar2 = FUN_0007f058(local_22c, 0x80, &local_238);
    pFVar1 = stderr;
    if (iVar2 == 0) {
        if (local_238 < 1) {
            pcVar7 = ".";
        } else {
            pcVar7 = ", back trace";
        }
        uVar3 = FUN_0007ed7c(param_3);
        uVar4 = FUN_00083830(isc_msgcat, 1, 0x65, "failed");
        __fprintf_chk(pFVar1, 1, "%s:%d: %s(%s) %s%s\n", param_1, param_2,
                      uVar3, param_4, uVar4, pcVar7);
        if (0 < local_238) {
            iVar2 = 0;
            puVar6 = &local_230;
            do {
                puVar6 = puVar6 + 1;
                local_234 = 0;
                iVar5 = FUN_0007f1ac(*puVar6, &local_234, &local_230);
                if (iVar5 == 0) {
                    uVar3 = local_234;
                    param_4 = local_230;
                    __fprintf_chk(stderr, 1, "#%d %p in %s()+0x%lx\n", iVar2,
                                  *puVar6, local_234, local_230, uVar4, pcVar7);
                } else {
                    __fprintf_chk(stderr, 1, "#%d %p in ??\n", iVar2, *puVar6,
                                  uVar3, param_4, uVar4, pcVar7);
                }
                iVar2 = iVar2 + 1;
            } while (iVar2 < local_238);
        }
    } else {
        uVar3 = FUN_0007ed7c(param_3);
        uVar4 = FUN_00083830(isc_msgcat, 1, 0x65, "failed");
        __fprintf_chk(pFVar1, 1, "%s:%d: %s(%s) %s%s\n", param_1, param_2,
                      uVar3, param_4, uVar4, ".");
    }
    fflush(stderr);
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0007f0a0) */

void FUN_0007f058(void)

{
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007f224) */
/* WARNING: Removing unreachable block (ram,0x0007f238) */
/* WARNING: Removing unreachable block (ram,0x0007f244) */
/* WARNING: Removing unreachable block (ram,0x0007f258) */
/* WARNING: Removing unreachable block (ram,0x0007f25c) */
/* WARNING: Removing unreachable block (ram,0x0007f260) */
/* WARNING: Removing unreachable block (ram,0x0007f2a0) */
/* WARNING: Removing unreachable block (ram,0x0007f2a8) */
/* WARNING: Removing unreachable block (ram,0x0007f2b4) */
/* WARNING: Removing unreachable block (ram,0x0007f2c0) */
/* WARNING: Removing unreachable block (ram,0x0007f268) */
/* WARNING: Removing unreachable block (ram,0x0007f270) */
/* WARNING: Removing unreachable block (ram,0x0007f28c) */
/* WARNING: Removing unreachable block (ram,0x0007f2c8) */

void FUN_0007f1ac(void)

{
    return;
}

void FUN_0007f2dc(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    __fprintf_chk(stderr, 1, "%s:%d: ", param_1, param_2);
    __vfprintf_chk(stderr, 1, param_3, param_4);
    fputc(10, stderr);
    if (iVar1 == __stack_chk_guard) {
        fflush(stderr);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007f380(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    FILE *pFVar2;
    undefined4 uVar3;

    pFVar2 = stderr;
    iVar1 = __stack_chk_guard;
    uVar3 = FUN_00083830(isc_msgcat, 1, 0x6e, "fatal error");
    __fprintf_chk(pFVar2, 1, "%s:%d: %s: ", param_1, param_2, uVar3);
    __vfprintf_chk(stderr, 1, param_3, param_4);
    fputc(10, stderr);
    if (iVar1 == __stack_chk_guard) {
        fflush(stderr);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0007f4c0) */

void FUN_0007f45c(code *param_1)

{
    DAT_000c7d84 = param_1;
    if (param_1 == (code *)0x0) {
        DAT_000c7d84 = FUN_0007f2dc;
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0007f53c) */

void FUN_0007f4d8(code *param_1)

{
    DAT_000c7d88 = param_1;
    if (param_1 == (code *)0x0) {
        DAT_000c7d88 = FUN_0007f380;
    }
    return;
}

void FUN_0007f554(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    int iVar1;
    undefined4 uStack_4;

    iVar1 = __stack_chk_guard;
    uStack_4 = param_4;
    (*DAT_000c7d84)(param_1, param_2, param_3, &uStack_4, &uStack_4);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007f5c8(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                  undefined4 param_4)

{
    undefined4 uStack_4;

    uStack_4 = param_4;
    (*DAT_000c7d88)(param_1, param_2, param_3, &uStack_4, &uStack_4,
                    __stack_chk_guard);
    /* WARNING: Subroutine does not return */
    abort();
}

void FUN_0007f61c(uint param_1, undefined4 param_2, uint param_3)

{
    uint uVar1;
    char *pcVar2;
    undefined4 uVar3;
    uint extraout_r2;
    FILE *__stream;
    uint extraout_r12;
    undefined4 *puVar4;
    undefined1 in_ZR;
    undefined4 local_28[3];
    int local_1c;

    puVar4 = local_28;
    local_1c = __stack_chk_guard;
    local_28[0] = FUN_00083830(isc_msgcat, 1, 0x65, "failed");
    uVar1 = FUN_0007f5c8(param_1, param_2, "RUNTIME_CHECK(%s) %s", param_3);
    if ((bool)in_ZR) {
        param_1 = (int)extraout_r12 >> 0x1e & 0x82c;
        uVar1 = uVar1 & extraout_r12 >> 0x10 & 0x82c << (param_3 & 0xff);
        puVar4 = (undefined4 *)(extraout_r2 & (int)extraout_r12 >> 1);
    }
    *(undefined4 *)((int)puVar4 + -4) = 0x7f688;
    *(uint *)((int)puVar4 + -8) = param_1;
    *(undefined4 *)((int)puVar4 + -0xc) = 0x82c;
    __stream = *(FILE **)(uVar1 + 0xa8);
    *(int *)((int)puVar4 + -0x14) = __stack_chk_guard;
    if ((__stream == (FILE *)0x0) ||
        (pcVar2 = fgets((char *)(uVar1 + 0xac), 0x3f, __stream),
         pcVar2 == (char *)0x0)) {
        uVar3 = 0x1d;
        *(undefined4 *)(uVar1 + 0xec) = 0x1d;
    } else {
        uVar3 = 0;
        *(undefined4 *)(uVar1 + 0xec) = 0;
    }
    if (*(int *)((int)puVar4 + -0x14) != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_0007f69c(int param_1)

{
    int iVar1;
    char *pcVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    if ((*(FILE **)(param_1 + 0xa8) == (FILE *)0x0) ||
        (pcVar2 =
             fgets((char *)(param_1 + 0xac), 0x3f, *(FILE **)(param_1 + 0xa8)),
         pcVar2 == (char *)0x0)) {
        uVar3 = 0x1d;
        *(undefined4 *)(param_1 + 0xec) = 0x1d;
    } else {
        uVar3 = 0;
        *(undefined4 *)(param_1 + 0xec) = 0;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_0007f718(int param_1, int *param_2, int param_3, char *param_4)

{
    int iVar1;
    int iVar2;
    int iVar3;
    uint uVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    param_2[1] = 0;
    param_2[2] = 0;
    param_2[3] = 0;
    param_2[4] = 0;
    param_2[5] = 0;
    *param_2 = param_1;
    if (param_1 == 2) {
        param_2[1] = *(int *)(param_3 + 4);
    } else {
        if (param_1 != 10) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("./../lib/isc/unix/interfaceiter.c", 0x8f, 2, "0");
        }
        iVar3 = *(int *)(param_3 + 0xc);
        iVar5 = *(int *)(param_3 + 0x10);
        iVar2 = *(int *)(param_3 + 0x14);
        param_2[1] = *(int *)(param_3 + 8);
        param_2[2] = iVar3;
        param_2[3] = iVar5;
        param_2[4] = iVar2;
        uVar4 = *(uint *)(param_3 + 0x18);
        if (uVar4 != 0) {
        joined_r0x0007f820:
            if (iVar1 == __stack_chk_guard) {
                FUN_00084c28(param_2, uVar4);
                return;
            }
            goto LAB_0007f7f0;
        }
        if ((*(uint *)(param_3 + 8) & 0xc0ff) == 0x80fe) {
            if ((*(ushort *)(param_3 + 10) & 0xff) == 0 &&
                *(ushort *)(param_3 + 10) >> 8 == 0) {
                if ((param_4 != (char *)0x0) &&
                    (uVar4 = if_nametoindex(param_4), uVar4 != 0))
                    goto joined_r0x0007f820;
            } else {
                FUN_00084c28(param_2);
                *(undefined2 *)((int)param_2 + 6) = 0;
            }
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_0007f7f0:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0007f874(int *param_1)

{
    size_t sVar1;
    char *pcVar2;
    char *pcVar3;
    undefined4 uVar4;
    int iVar5;
    uint uVar6;
    byte *pbVar7;
    int iVar8;
    uint uVar9;
    byte *pbVar10;
    int *piVar11;
    byte *pbVar12;
    bool bVar13;
    int local_84;
    int local_80;
    undefined1 auStack_7c[4];
    undefined4 local_78;
    byte local_74[16];
    byte abStack_64[20];
    byte local_50[33];
    byte abStack_2f[3];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 0x49464947)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/ifiter_getifaddrs.c", 0x91, 0,
                     "(((iter) != ((void *)0)) && (((const isc__magic_t "
                     "*)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | "
                     "(\'I\') << 8 | (\'G\')))))");
    }
    iVar8 = param_1[5];
    if (iVar8 == 0) {
        iVar8 = param_1[0x3b];
        if (iVar8 != 0)
            goto LAB_0007fa14;
        if (param_1[0x2a] == 0) {
            iVar8 = 0x19;
            FUN_00083300(isc_lctx, 0xc7dc4, 0xc7d9c, 0xfffffffc,
                         "/proc/net/if_inet6:iter->proc == NULL");
            goto LAB_0007fa14;
        }
        iVar5 = sscanf((char *)(param_1 + 0x2b),
                       "%32[a-f0-9] %x %x %x %x %16s\n", local_50, &local_84,
                       &local_80, auStack_7c, &local_78, abStack_64);
        if (iVar5 != 6) {
            iVar8 = 0x19;
            FUN_00083300(isc_lctx, 0xc7dc4, 0xc7d9c, 0xfffffffc,
                         "/proc/net/if_inet6:sscanf() -> %d (expected 6)",
                         iVar5);
            goto LAB_0007fa14;
        }
        sVar1 = strlen((char *)local_50);
        if (sVar1 != 0x20) {
            iVar8 = 0x19;
            FUN_00083300(isc_lctx, 0xc7dc4, 0xc7d9c, 0xfffffffc,
                         "/proc/net/if_inet6:strlen(%s) != 32", local_50);
            goto LAB_0007fa14;
        }
        if ((local_78 & 0x40) == 0) {
            pbVar12 = (byte *)((int)&local_78 + 3);
            pbVar7 = local_50 + 1;
            do {
                pcVar2 = strchr("0123456789abcdef", (uint)pbVar7[-1]);
                pbVar10 = pbVar7 + 2;
                pcVar3 = strchr("0123456789abcdef", (uint)*pbVar7);
                pbVar12 = pbVar12 + 1;
                *pbVar12 =
                    (char)pcVar3 + 0x94U | ((char)pcVar2 + -0x6c) * '\x10';
                pbVar7 = pbVar10;
            } while (abStack_2f != pbVar10);
            piVar11 = param_1 + 0xf;
            param_1[0xe] = 10;
            param_1[0x27] = 1;
            FUN_00084b70(piVar11, local_74);
            param_1[0x28] = local_84;
            iVar5 = FUN_00084f64(piVar11);
            pbVar7 = local_74;
            if (iVar5 != 0) {
                FUN_00084c28(piVar11, local_84);
            }
            do {
                if (local_80 < 9)
                    goto LAB_0007fba4;
                local_80 = local_80 + -8;
                pbVar12 = pbVar7 + 1;
                *pbVar7 = 0xff;
                pbVar7 = pbVar12;
            } while (abStack_64 != pbVar12);
            goto LAB_0007fbc0;
        }
    } else {
        if (*(int *)(iVar8 + 4) == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("./../lib/isc/unix/ifiter_getifaddrs.c", 0xa3, 2,
                         "ifa->ifa_name != ((void *)0)");
        }
        if ((((*(uint *)(iVar8 + 8) & 0x40) != 0) &&
             (*(ushort **)(iVar8 + 0xc) != (ushort *)0x0)) &&
            (uVar9 = (uint) * *(ushort **)(iVar8 + 0xc),
             (uVar9 & 0xfff7) == 2)) {
            if (uVar9 == 10) {
                DAT_00117240 = 1;
            }
            piVar11 = param_1 + 6;
            memset(piVar11, 0, 0x8c);
            sVar1 = strlen(*(char **)(iVar8 + 4));
            memset(piVar11, 0, 0x20);
            if (0x1e < sVar1) {
                sVar1 = 0x1f;
            }
            memcpy(piVar11, *(void **)(iVar8 + 4), sVar1);
            uVar6 = *(uint *)(iVar8 + 8);
            param_1[0x27] = 0;
            param_1[0xe] = uVar9;
            bVar13 = (uVar6 & 1) != 0;
            if (bVar13) {
                param_1[0x27] = (uint)bVar13;
            }
            if ((uVar6 & 0x10) != 0) {
                param_1[0x27] = param_1[0x27] | 2;
            }
            if ((uVar6 & 8) != 0) {
                param_1[0x27] = param_1[0x27] | 4;
            }
            if ((uVar6 & 2) != 0) {
                param_1[0x27] = param_1[0x27] | 8;
            }
            bVar13 = (uVar6 & 0x1000) != 0;
            if (bVar13) {
                uVar6 = param_1[0x27];
            }
            uVar4 = *(undefined4 *)(iVar8 + 0xc);
            if (bVar13) {
                param_1[0x27] = uVar6 | 0x10;
            }
            FUN_0007f718(uVar9, param_1 + 0xf, uVar4,
                         *(undefined4 *)(iVar8 + 4));
            if (*(int *)(iVar8 + 0x10) != 0) {
                FUN_0007f718(uVar9, param_1 + 0x15, *(int *)(iVar8 + 0x10),
                             *(undefined4 *)(iVar8 + 4));
            }
            iVar5 = *(int *)(iVar8 + 0x14);
            if (iVar5 != 0) {
                uVar6 = param_1[0x27];
                if ((uVar6 & 2) != 0) {
                    FUN_0007f718(uVar9, param_1 + 0x21, iVar5,
                                 *(undefined4 *)(iVar8 + 4));
                    iVar5 = *(int *)(iVar8 + 0x14);
                    if (iVar5 == 0)
                        goto LAB_0007f9fc;
                    uVar6 = param_1[0x27];
                }
                if ((uVar6 & 8) != 0) {
                    FUN_0007f718(uVar9, param_1 + 0x1b, iVar5,
                                 *(undefined4 *)(iVar8 + 4));
                }
            }
        LAB_0007f9fc:
            iVar8 = 0;
            uVar9 = if_nametoindex((char *)piVar11);
            param_1[0x28] = uVar9;
            goto LAB_0007fa14;
        }
    }
    iVar8 = 0x24;
LAB_0007fa14:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar8);
    }
    return;
LAB_0007fba4:
    do {
        uVar9 = 8 - local_80;
        local_80 = 0;
        pbVar12 = pbVar7 + 1;
        *pbVar7 = (byte)(0xff << (uVar9 & 0xff));
        pbVar7 = pbVar12;
    } while (abStack_64 != pbVar12);
LAB_0007fbc0:
    FUN_00084b70(param_1 + 0x15, local_74);
    strncpy((char *)(param_1 + 6), (char *)abStack_64, 0x20);
    goto LAB_0007fa14;
}

void FUN_0007fd38(int param_1, int *param_2)

{
    undefined4 *__ptr;
    undefined4 uVar1;
    int iVar2;
    int *piVar3;
    FILE *pFVar4;
    int iVar5;
    undefined1 auStack_a4[128];
    int local_24;

    local_24 = __stack_chk_guard;
    if (param_1 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/ifiter_getifaddrs.c", 0x3c, 0,
                     "mctx != ((void *)0)");
    }
    if (param_2 == (int *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/ifiter_getifaddrs.c", 0x3d, 0,
                     "iterp != ((void *)0)");
    }
    if (*param_2 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/ifiter_getifaddrs.c", 0x3e, 0,
                     "*iterp == ((void *)0)");
    }
    __ptr = (undefined4 *)FUN_00073ba4(0, 0xf0, 0, 0);
    if (__ptr == (undefined4 *)0x0) {
        uVar1 = 1;
    } else {
        __ptr[1] = param_1;
        __ptr[2] = 0;
        __ptr[3] = 0;
        iVar5 = DAT_00117240;
        __ptr[4] = 0;
        if (iVar5 == 0) {
            pFVar4 = fopen64("/proc/net/if_inet6", "r");
            __ptr[0x2a] = pFVar4;
            if (pFVar4 == (FILE *)0x0) {
                piVar3 = __errno_location();
                FUN_00085b10(*piVar3, auStack_a4, 0x80);
                FUN_00083300(isc_lctx, 0xc7dc4, isc_modules, 0xfffffffd,
                             "failed to open /proc/net/if_inet6");
            }
        } else {
            __ptr[0x2a] = 0;
        }
        iVar5 = 3;
        __ptr[0x3b] = 0x19;
        do {
            iVar2 = getifaddrs(__ptr + 4);
            if (-1 < iVar2) {
                uVar1 = 0;
                __ptr[5] = 0;
                *__ptr = 0x49464947;
                __ptr[0x29] = 0x19;
                *param_2 = (int)__ptr;
                goto LAB_0007fe74;
            }
            piVar3 = __errno_location();
        } while ((*piVar3 == 4) && (iVar5 = iVar5 + -1, iVar5 != 0));
        FUN_00085b10(*piVar3, auStack_a4, 0x80);
        uVar1 = FUN_00083830(isc_msgcat, 0x15, 0x709, "getifaddrs");
        FUN_0007f554("./../lib/isc/unix/ifiter_getifaddrs.c", 99,
                     "getting interface addresses: %s: %s", uVar1, auStack_a4);
        if ((FILE *)__ptr[0x2a] != (FILE *)0x0) {
            fclose((FILE *)__ptr[0x2a]);
        }
        if (__ptr[4] != 0) {
            freeifaddrs();
        }
        free(__ptr);
        uVar1 = 0x22;
    }
LAB_0007fe74:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar1);
    }
    return;
}

void FUN_0007ffc4(int param_1, void *param_2)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (*(int *)(param_1 + 0xa4) != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/interfaceiter.c", 0x10d, 0,
                     "iter->result == 0");
    }
    memcpy(param_2, (void *)(param_1 + 0x18), 0x8c);
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(0);
}

void FUN_00080050(int *param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 0x49464947)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/interfaceiter.c", 0x116, 0,
                     "(((iter) != ((void *)0)) && (((const isc__magic_t "
                     "*)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | "
                     "(\'I\') << 8 | (\'G\')))))");
    }
    if ((FILE *)param_1[0x2a] == (FILE *)0x0) {
        param_1[0x3b] = 0x1d;
    } else {
        rewind((FILE *)param_1[0x2a]);
        FUN_0007f69c(param_1);
    }
    param_1[5] = param_1[4];
    do {
        do {
            iVar3 = FUN_0007f874(param_1);
            if (iVar3 != 0x24)
                goto LAB_00080108;
        } while (((int *)param_1[5] != (int *)0x0) &&
                 (iVar3 = *(int *)param_1[5], param_1[5] = iVar3, iVar3 != 0));
        if (DAT_00117240 != 0) {
            iVar3 = 0x1d;
            break;
        }
        iVar3 = FUN_0007f69c(param_1);
    } while (iVar3 == 0);
LAB_00080108:
    iVar2 = __stack_chk_guard;
    param_1[0x29] = iVar3;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_00080164(int *param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 0x49464947)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/interfaceiter.c", 0x129, 0,
                     "(((iter) != ((void *)0)) && (((const isc__magic_t "
                     "*)(iter))->magic == (((\'I\') << 24 | (\'F\') << 16 | "
                     "(\'I\') << 8 | (\'G\')))))");
    }
    if (param_1[0x29] != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/interfaceiter.c", 0x12a, 0,
                     "iter->result == 0");
    }
    do {
        if (((int *)param_1[5] == (int *)0x0) ||
            (iVar3 = *(int *)param_1[5], param_1[5] = iVar3, iVar3 == 0)) {
            if (DAT_00117240 != 0) {
                iVar3 = 0x1d;
                break;
            }
            iVar3 = FUN_0007f69c(param_1);
            if (iVar3 != 0)
                break;
        }
        iVar3 = FUN_0007f874(param_1);
    } while (iVar3 == 0x24);
    iVar2 = __stack_chk_guard;
    param_1[0x29] = iVar3;
    if (iVar1 != iVar2) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_00080284(undefined4 *param_1)

{
    int iVar1;
    int *__ptr;

    iVar1 = __stack_chk_guard;
    if (param_1 == (undefined4 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/interfaceiter.c", 0x13c, 0,
                     "iterp != ((void *)0)");
    }
    __ptr = (int *)*param_1;
    if ((__ptr != (int *)0x0) && (*__ptr == 0x49464947)) {
        if ((FILE *)__ptr[0x2a] != (FILE *)0x0) {
            fclose((FILE *)__ptr[0x2a]);
        }
        __ptr[0x2a] = 0;
        if (__ptr[4] != 0) {
            freeifaddrs();
        }
        __ptr[4] = 0;
        if ((void *)__ptr[2] != (void *)0x0) {
            free((void *)__ptr[2]);
        }
        free(__ptr);
        *param_1 = 0;
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0(
        "./../lib/isc/unix/interfaceiter.c", 0x13e, 0,
        "(((iter) != ((void *)0)) && (((const isc__magic_t *)(iter))->magic == "
        "(((\'I\') << 24 | (\'F\') << 16 | (\'I\') << 8 | (\'G\')))))");
}

void FUN_000803e8(void)

{
    int iVar1;
    undefined4 uVar2;
    int iVar3;
    undefined4 uVar4;
    undefined4 uVar5;

    iVar1 = __stack_chk_guard;
    iVar3 = pthread_once((pthread_once_t *)&DAT_00117244,
                         (__init_routine *)&DAT_00080388);
    uVar2 = stderr;
    if (iVar3 != 0) {
        uVar4 = FUN_00083830(isc_msgcat, 1, 0x6e, "fatal error");
        uVar5 = FUN_00083830(isc_msgcat, 1, 0x65, "failed");
        __fprintf_chk(uVar2, 1, "%s:%d: %s: isc_once_do() %s.\n",
                      "./../lib/isc/lib.c", 0x4d, uVar4, uVar5);
        /* WARNING: Subroutine does not return */
        abort();
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000807c8(int param_1)

{
    char *pcVar1;
    size_t __n;
    int iVar2;
    int iVar3;
    long lVar4;
    uint uVar5;
    int iVar6;
    undefined4 uVar7;
    char *pcVar8;
    char *__s;
    int local_2550;
    char *local_2544;
    undefined1 auStack_2540[1028];
    char acStack_213c[256];
    uint local_203c;
    undefined1 auStack_2034[4100];
    undefined1 auStack_1030[4100];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (*(int *)(param_1 + 0x18) != -2) {
        __s = *(char **)(param_1 + 0x14);
        if (*(int *)(param_1 + 4) != 3) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("./../lib/isc/log.c", 0x485, 0, "channel->type == 3");
        }
        pcVar1 = strrchr(__s, 0x2f);
        if (pcVar1 == (char *)0x0) {
            pcVar8 = ".";
            pcVar1 = __s;
        } else {
            *pcVar1 = '\0';
            pcVar8 = *(char **)(param_1 + 0x14);
            pcVar1 = pcVar1 + 1;
        }
        __n = strlen(pcVar1);
        FUN_0008a2b0(auStack_2540);
        iVar2 = FUN_0008a33c(auStack_2540, pcVar8);
        if (pcVar1 != *(char **)(param_1 + 0x14)) {
            pcVar1[-1] = '/';
        }
        if (iVar2 != 0)
            goto LAB_00080940;
        local_2550 = -1;
        while (iVar3 = FUN_0008a4a4(auStack_2540), iVar3 == 0) {
            if ((((__n < local_203c) &&
                  (iVar3 = strncmp(acStack_213c, pcVar1, __n), iVar3 == 0)) &&
                 (acStack_213c[__n] == '.')) &&
                (lVar4 = strtol(auStack_2540 + __n + 0x405, &local_2544, 10),
                 *local_2544 == '\0' && local_2550 < lVar4)) {
                local_2550 = lVar4;
            }
        }
        local_2550 = local_2550 + 1;
        FUN_0008a584(auStack_2540);
        iVar3 = *(int *)(param_1 + 0x18);
        if (iVar3 <= local_2550 && iVar3 != -1) {
            while (true) {
                local_2550 = local_2550 + -1;
                if (local_2550 < iVar3)
                    break;
                uVar5 = FUN_0007c054(auStack_2034, 0x1001, "%s.%d", __s,
                                     local_2550);
                if (uVar5 < 0x1001) {
                    iVar3 = FUN_0008b648(auStack_2034);
                    if (iVar3 != 0 && iVar3 != 0x26)
                        goto LAB_00080b68;
                    iVar3 = *(int *)(param_1 + 0x18);
                } else {
                    iVar3 = 0x13;
                LAB_00080b68:
                    uVar7 = FUN_000854a0(iVar3);
                    __syslog_chk(3, 1,
                                 "unable to remove log file \'%s.%d\': %s", __s,
                                 local_2550, uVar7);
                    iVar3 = *(int *)(param_1 + 0x18);
                }
            }
        }
        if (0 < local_2550) {
            do {
                while (true) {
                    iVar3 = local_2550 + -1;
                    uVar5 =
                        FUN_0007c054(auStack_2034, 0x1001, "%s.%d", __s, iVar3);
                    if (uVar5 < 0x1001)
                        break;
                LAB_000809c4:
                    iVar6 = 0x13;
                LAB_000809c8:
                    uVar7 = FUN_000854a0(iVar6);
                    __syslog_chk(
                        3, 1,
                        "unable to rename log file \'%s.%d\' to \'%s.%d\': %s",
                        __s, iVar3, __s, local_2550, uVar7);
                    local_2550 = iVar3;
                    if (iVar3 == 0)
                        goto LAB_00080a74;
                }
                uVar5 = FUN_0007c054(auStack_1030, 0x1001, "%s.%d", __s,
                                     local_2550);
                if (0x1000 < uVar5)
                    goto LAB_000809c4;
                iVar6 = FUN_0008b6f4(auStack_2034, auStack_1030);
                if (iVar6 != 0 && iVar6 != 0x26)
                    goto LAB_000809c8;
                local_2550 = iVar3;
            } while (iVar3 != 0);
        LAB_00080a74:
            iVar3 = *(int *)(param_1 + 0x18);
        }
        if (iVar3 != 0) {
            uVar5 = FUN_0007c054(auStack_1030, 0x1001, &DAT_000acbb0, __s);
            if (uVar5 < 0x1001) {
                iVar3 = FUN_0008b6f4(__s, auStack_1030);
                if (iVar3 == 0 || iVar3 == 0x26)
                    goto LAB_0008093c;
            } else {
                iVar3 = 0x13;
            }
            uVar7 = FUN_000854a0(iVar3);
            __syslog_chk(3, 1,
                         "unable to rename log file \'%s\' to \'%s.0\': %s",
                         __s, __s, uVar7);
            goto LAB_00080940;
        }
        iVar3 = FUN_0008b648(__s);
        if (iVar3 != 0 && iVar3 != 0x26) {
            uVar7 = FUN_000854a0();
            __syslog_chk(3, 1, "unable to remove log file \'%s\': %s", __s,
                         uVar7);
            goto LAB_00080940;
        }
    }
LAB_0008093c:
    iVar2 = 0;
LAB_00080940:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar2);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x0008263c) */

void FUN_000825b8(void)

{
    return;
}

/* WARNING: Restarted to delay deadcode elimination for space: stack */

void FUN_00082648(int *param_1, undefined4 *param_2, undefined4 *param_3,
                  int param_4, int param_5, int param_6, undefined4 param_7,
                  undefined4 param_8, int param_9, undefined4 param_10)

{
    byte bVar1;
    int iVar2;
    undefined4 uVar3;
    size_t sVar4;
    int *piVar5;
    uint uVar6;
    int *piVar7;
    undefined *puVar8;
    int iVar9;
    undefined *puVar10;
    undefined *puVar11;
    pthread_mutex_t *__mutex;
    undefined4 *puVar12;
    uint uVar13;
    undefined4 uVar14;
    char *pcVar15;
    int iVar16;
    undefined *puVar17;
    int iVar18;
    undefined *puVar19;
    undefined4 *puVar20;
    undefined4 *__ptr;
    char *pcVar21;
    uint uVar22;
    undefined *puVar23;
    char *pcVar24;
    bool bVar25;
    int local_184;
    int local_168;
    undefined1 auStack_160[8];
    stat64 sStack_158;
    stat64 sStack_f0;
    char local_84[24];
    char local_6c[64];
    int local_2c;

    local_2c = __stack_chk_guard;
    local_184 = param_9;
    if ((param_1 != (int *)0x0) && (*param_1 != 0x4c637478)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/log.c", 0x590, 0,
                     "lctx == ((void *)0) || (((lctx) != ((void *)0)) && "
                     "(((const isc__magic_t *)(lctx))->magic == (((\'L\') << "
                     "24 | (\'c\') << 16 | (\'t\') << 8 | (\'x\')))))");
    }
    if (param_2 == (undefined4 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/log.c", 0x591, 0, "category != ((void *)0)");
    }
    if (param_3 == (undefined4 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/log.c", 0x592, 0, "module != ((void *)0)");
    }
    if (param_4 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/log.c", 0x593, 0, "level != 0");
    }
    if (param_9 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/log.c", 0x594, 0, "format != ((void *)0)");
    }
    if (param_1 != (int *)0x0) {
        if ((uint)param_1[3] <= (uint)param_2[1]) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("./../lib/isc/log.c", 0x59e, 0,
                         "category->id < lctx->category_count");
        }
        if ((uint)param_1[5] <= (uint)param_3[1]) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("./../lib/isc/log.c", 0x59f, 0,
                         "module->id < lctx->module_count");
        }
        iVar2 = FUN_000825b8(param_1, param_4);
        if (iVar2 != 0) {
            if (param_6 != 0) {
                local_184 = FUN_00083830(param_6, param_7, param_8, param_9);
            }
            __mutex = (pthread_mutex_t *)(param_1 + 7);
            local_6c[0] = '\0';
            local_84[0] = '\0';
            iVar2 = pthread_mutex_lock(__mutex);
            if (iVar2 != 0) {
                FUN_0007f61c("./../lib/isc/log.c", 0x5ac,
                             "((pthread_mutex_lock(((&lctx->lock))) == 0) ? 0 "
                             ": 34) == 0");
            }
            iVar2 = param_1[0xd];
            bVar1 = 0;
            *(undefined1 *)(param_1 + 0xe) = 0;
            puVar12 = *(undefined4 **)(*(int *)(iVar2 + 0x10) + param_2[1] * 8);
            bVar25 = puVar12 == (undefined4 *)0x0;
            do {
                puVar20 = puVar12;
                if (((bool)(bVar25 & (bVar1 ^ 1))) &&
                    (puVar20 = (undefined4 *)**(undefined4 **)(iVar2 + 0x10),
                     (undefined4 *)**(undefined4 **)(iVar2 + 0x10) ==
                         (undefined4 *)0x0)) {
                    puVar20 = &DAT_0011724c;
                }
                puVar12 = (undefined4 *)puVar20[3];
                if ((undefined4 *)*puVar20 == param_3 ||
                    (undefined4 *)*puVar20 == (undefined4 *)0x0) {
                    iVar16 = puVar20[1];
                    uVar13 = *(uint *)(iVar16 + 0xc);
                    if (((uVar13 & 0x1000) == 0) || (param_1[6] != 0)) {
                        iVar9 = *(int *)(iVar16 + 8);
                        if (iVar9 == 0) {
                            iVar9 = param_1[6];
                        }
                        if (param_4 <= iVar9) {
                            if (((uVar13 & 1) != 0) && (local_6c[0] == '\0')) {
                                iVar9 = FUN_00085fe8(&sStack_f0);
                                if (iVar9 != 0) {
                                    FUN_0007f61c(
                                        "./../lib/isc/log.c", 0x5eb,
                                        "isc_time_now((&isctime)) == 0");
                                }
                                FUN_000869f8(&sStack_f0, local_6c, 0x40);
                                uVar13 = *(uint *)(iVar16 + 0xc);
                            }
                            if (((uVar13 & 2) != 0) && (local_84[0] == '\0')) {
                                if (param_4 + 5 < 0 == SCARRY4(param_4, 5)) {
                                    if (param_4 < 1) {
                                        FUN_0007c054(
                                            local_84, 0x18, &DAT_000ad350,
                                            (&PTR_s_debug_000c51e8)[-param_4]);
                                    } else {
                                        FUN_0007c054(local_84, 0x18,
                                                     "%s %d: ", "debug",
                                                     param_4);
                                    }
                                } else {
                                    uVar3 = FUN_00083830(isc_msgcat, 10, 0x322,
                                                         "level");
                                    FUN_0007c054(local_84, 0x18,
                                                 "%s %d: ", uVar3, param_4);
                                }
                            }
                            if ((char)param_1[0xe] == '\0') {
                                piVar7 = param_1 + 0xe;
                                FUN_0007b6f8(piVar7, 0x2000, local_184,
                                             param_10);
                                if (param_5 != 0) {
                                    FUN_00085cac(&sStack_f0,
                                                 *(undefined4 *)(iVar2 + 0x18),
                                                 0);
                                    iVar9 = FUN_00085fe8(auStack_160);
                                    if (iVar9 != 0) {
                                        FUN_0007f61c(
                                            "./../lib/isc/log.c", 0x61a,
                                            "isc_time_now((&oldest)) == 0");
                                    }
                                    iVar9 = FUN_000865a8(
                                        auStack_160, &sStack_f0, auStack_160);
                                    if (iVar9 == 0) {
                                        puVar20 = (undefined4 *)param_1[0x80e];
                                        while (__ptr = puVar20,
                                               puVar20 != (undefined4 *)0x0) {
                                            while (iVar9 = FUN_00086378(
                                                       __ptr + 1, auStack_160),
                                                   -1 < iVar9) {
                                                iVar9 = strcmp((char *)piVar7,
                                                               (char *)*__ptr);
                                                if (iVar9 == 0) {
                                                    iVar2 =
                                                        pthread_mutex_unlock(
                                                            __mutex);
                                                    if (iVar2 != 0) {
                                                        FUN_0007f61c(
                                                            "./../lib/isc/"
                                                            "log.c",
                                                            0x64e,
                                                            "((pthread_mutex_"
                                                            "unlock(((&lctx->"
                                                            "lock))) == 0) ? 0 "
                                                            ": 34) == 0");
                                                    }
                                                    goto LAB_0008272c;
                                                }
                                                __ptr = (undefined4 *)__ptr[4];
                                                if (__ptr == (undefined4 *)0x0)
                                                    goto LAB_00082c5c;
                                            }
                                            puVar20 = (undefined4 *)__ptr[4];
                                            if (puVar20 == (undefined4 *)0x0) {
                                                if ((undefined4 *)
                                                        param_1[0x80f] !=
                                                    __ptr) {
                                                    /* WARNING: Subroutine does
                                                     * not return */
                                                    FUN_0007ecc0(
                                                        "./../lib/isc/log.c",
                                                        0x638, 2,
                                                        "(lctx->messages).tail "
                                                        "== (message)");
                                                }
                                                iVar9 = __ptr[3];
                                                param_1[0x80f] = iVar9;
                                            } else {
                                                puVar20[3] = __ptr[3];
                                                iVar9 = __ptr[3];
                                            }
                                            if (iVar9 == 0) {
                                                if ((undefined4 *)
                                                        param_1[0x80e] !=
                                                    __ptr) {
                                                    /* WARNING: Subroutine does
                                                     * not return */
                                                    FUN_0007ecc0(
                                                        "./../lib/isc/log.c",
                                                        0x638, 2,
                                                        "(lctx->messages).head "
                                                        "== (message)");
                                                }
                                                param_1[0x80e] = (int)puVar20;
                                            } else {
                                                *(undefined4 **)(iVar9 + 0x10) =
                                                    puVar20;
                                            }
                                            free(__ptr);
                                        }
                                    }
                                LAB_00082c5c:
                                    sVar4 = strlen((char *)piVar7);
                                    piVar5 =
                                        (int *)FUN_00073ba4(0, sVar4 + 0x15, 0);
                                    if (piVar5 != (int *)0x0) {
                                        *piVar5 = (int)(piVar5 + 5);
                                        FUN_0007d4dc(piVar5 + 5, piVar7,
                                                     sVar4 + 1);
                                        iVar9 = FUN_00085fe8(piVar5 + 1);
                                        if (iVar9 != 0) {
                                            FUN_0007f61c("./../lib/isc/log.c",
                                                         0x665,
                                                         "isc_time_now((&new->"
                                                         "time)) == 0");
                                        }
                                        iVar9 = param_1[0x80f];
                                        if (iVar9 == 0) {
                                            param_1[0x80e] = (int)piVar5;
                                        } else {
                                            *(int **)(iVar9 + 0x10) = piVar5;
                                        }
                                        piVar5[3] = iVar9;
                                        piVar5[4] = 0;
                                        param_1[0x80f] = (int)piVar5;
                                    }
                                }
                            }
                            uVar22 = *(uint *)(iVar16 + 0xc);
                            uVar13 = uVar22 & 0x10;
                            if ((uVar13 != 0) &&
                                (uVar13 = *(uint *)(iVar2 + 0x20),
                                 uVar13 != 0)) {
                                uVar13 = 1;
                            }
                            iVar9 = *(int *)(iVar16 + 4);
                            iVar18 = uVar22 << 0x1d;
                            if (iVar9 == 3) {
                                if (*(int *)(iVar16 + 0x28) == 0) {
                                    iVar9 = *(int *)(iVar16 + 0x10);
                                    if (iVar9 != 0)
                                        goto LAB_00082aa8;
                                } else {
                                    if ((*(int *)(iVar16 + 0x18) == -2) &&
                                        (((iVar9 = __xstat64(
                                               3, *(char **)(iVar16 + 0x14),
                                               &sStack_158),
                                           iVar9 == 0 ||
                                               (piVar7 = __errno_location(),
                                                *piVar7 != 2)) &&
                                          (iVar9 = *(int *)(iVar16 + 0x24),
                                           bVar25 = (uint)sStack_158.st_size <
                                                    *(uint *)(iVar16 + 0x20),
                                           (int)(sStack_158.st_size._4_4_ -
                                                 (iVar9 + (uint)bVar25)) < 0 ==
                                               (SBORROW4(
                                                    sStack_158.st_size._4_4_,
                                                    iVar9) !=
                                                SBORROW4(
                                                    sStack_158.st_size._4_4_ -
                                                        iVar9,
                                                    (uint)bVar25))))))
                                        goto LAB_00082898;
                                    fclose(*(FILE **)(iVar16 + 0x10));
                                    *(undefined4 *)(iVar16 + 0x10) = 0;
                                    *(undefined4 *)(iVar16 + 0x28) = 0;
                                    if (*(int *)(iVar16 + 4) != 3) {
                                        /* WARNING: Subroutine does not return
                                         */
                                        FUN_0007ecc0("./../lib/isc/log.c",
                                                     0x52e, 0,
                                                     "channel->type == 3");
                                    }
                                }
                                pcVar24 = *(char **)(iVar16 + 0x14);
                                if ((pcVar24 == (char *)0x0) ||
                                    (*pcVar24 == '\0')) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007ecc0("./../lib/isc/log.c", 0x533, 0,
                                                 "path != ((void *)0) && *path "
                                                 "!= \'\\0\'");
                                }
                                iVar9 = __xstat64(3, pcVar24, &sStack_f0);
                                if (iVar9 == 0) {
                                    uVar6 = *(uint *)(iVar16 + 0x20);
                                    iVar9 = *(int *)(iVar16 + 0x24);
                                    if (uVar6 != 0 || iVar9 != 0) {
                                        if ((((int)(uint)(uVar6 == 0) <=
                                              iVar9) &&
                                             ((int)(sStack_f0.st_size._4_4_ -
                                                    (iVar9 +
                                                     (uint)((uint)sStack_f0
                                                                .st_size <
                                                            uVar6))) < 0 ==
                                              (SBORROW4(sStack_f0.st_size._4_4_,
                                                        iVar9) !=
                                               SBORROW4(
                                                   sStack_f0.st_size._4_4_ -
                                                       iVar9,
                                                   (uint)((uint)sStack_f0
                                                              .st_size <
                                                          uVar6))))) &&
                                            ((sStack_f0.st_mode & 0xf000) ==
                                             0x8000)) {
                                            if (*(int *)(iVar16 + 0x18) == -2)
                                                goto LAB_00082898;
                                            goto LAB_000829e4;
                                        }
                                        goto LAB_00083000;
                                    }
                                    if ((*(int *)(iVar16 + 0x18) == -2) ||
                                        ((sStack_f0.st_mode & 0xf000) !=
                                         0x8000))
                                        goto LAB_00083000;
                                LAB_000829e4:
                                    local_168 = FUN_000807c8(iVar16);
                                    if (local_168 == 0)
                                        goto LAB_00083000;
                                    uVar6 = *(uint *)(iVar16 + 0xc);
                                    if ((uVar6 & 0x8000) == 0) {
                                        uVar14 = *(undefined4 *)(iVar16 + 0x14);
                                        uVar3 = FUN_000854a0();
                                        __syslog_chk(3, 1,
                                                     "isc_log_open: roll_log "
                                                     "\'%s\' failed: %s",
                                                     uVar14, uVar3);
                                        uVar6 =
                                            *(uint *)(iVar16 + 0xc) | 0x8000;
                                        *(uint *)(iVar16 + 0xc) = uVar6;
                                    }
                                    if ((local_168 == 0x3a) ||
                                        ((uVar6 & 0x8000) != 0))
                                        goto LAB_00082898;
                                LAB_00082a54:
                                    uVar14 = *(undefined4 *)(iVar16 + 0x14);
                                    uVar3 = FUN_000854a0(local_168);
                                    __syslog_chk(
                                        3, 1, "isc_log_open \'%s\' failed: %s",
                                        uVar14, uVar3);
                                    *(uint *)(iVar16 + 0xc) =
                                        *(uint *)(iVar16 + 0xc) | 0x8000;
                                } else {
                                LAB_00083000:
                                    local_168 = FUN_00085654(
                                        pcVar24, &DAT_000a9960, iVar16 + 0x10);
                                    if ((local_168 != 0 && local_168 != 0x3a) &&
                                        ((*(uint *)(iVar16 + 0xc) & 0x8000) ==
                                         0))
                                        goto LAB_00082a54;
                                }
                                if (local_168 != 0)
                                    goto LAB_00082898;
                                iVar9 = *(int *)(iVar16 + 0x10);
                                *(uint *)(iVar16 + 0xc) =
                                    *(uint *)(iVar16 + 0xc) & 0xffff7fff;
                            } else {
                                if (iVar9 != 4) {
                                    if (iVar9 == 2) {
                                        if (param_4 < 1) {
                                            uVar6 = 2;
                                            if (param_4 + 5 < 0 ==
                                                SCARRY4(param_4, 5)) {
                                                uVar6 =
                                                    *(uint *)(&DAT_000aca04 +
                                                              param_4 * -4);
                                            }
                                        } else {
                                            uVar6 = 7;
                                        }
                                        if ((uVar22 & 1) == 0) {
                                            pcVar15 = "";
                                            pcVar24 = pcVar15;
                                        } else {
                                            pcVar15 = local_6c;
                                            pcVar24 = " ";
                                        }
                                        if (uVar13 == 0) {
                                            puVar11 = &DAT_000a7f7c;
                                            puVar10 = puVar11;
                                        } else {
                                            puVar11 =
                                                *(undefined **)(iVar2 + 0x20);
                                            puVar10 = &DAT_000ad1f0;
                                        }
                                        if (iVar18 < 0) {
                                            puVar17 = &DAT_000ad1f0;
                                            puVar23 = (undefined *)*param_2;
                                        } else {
                                            puVar17 = &DAT_000a7f7c;
                                            puVar23 = puVar17;
                                        }
                                        if ((int)(uVar22 << 0x1c) < 0) {
                                            puVar8 = (undefined *)*param_3;
                                            puVar19 = &DAT_000ad1f0;
                                        } else {
                                            puVar8 = &DAT_000a7f7c;
                                            puVar19 = puVar8;
                                        }
                                        if ((int)(uVar22 << 0x1e) < 0) {
                                            pcVar21 = local_84;
                                        } else {
                                            pcVar21 = "";
                                        }
                                        __syslog_chk(
                                            uVar6 | *(uint *)(iVar16 + 0x10), 1,
                                            "%s%s%s%s%s%s%s%s%s%s", pcVar15,
                                            pcVar24, puVar11, puVar10, puVar23,
                                            puVar17, puVar8, puVar19, pcVar21,
                                            param_1 + 0xe);
                                        bVar1 = 1;
                                        goto LAB_000828a0;
                                    }
                                    goto LAB_00082898;
                                }
                                iVar9 = *(int *)(iVar16 + 0x10);
                            }
                        LAB_00082aa8:
                            if ((uVar22 & 1) == 0) {
                                pcVar15 = "";
                                pcVar24 = pcVar15;
                            } else {
                                pcVar15 = local_6c;
                                pcVar24 = " ";
                            }
                            if (uVar13 == 0) {
                                puVar10 = &DAT_000a7f7c;
                                puVar11 = puVar10;
                                if (iVar18 < 0)
                                    goto LAB_00082adc;
                            LAB_00082da4:
                                puVar23 = &DAT_000a7f7c;
                                puVar17 = puVar23;
                            } else {
                                puVar10 = *(undefined **)(iVar2 + 0x20);
                                puVar11 = &DAT_000ad1f0;
                                if (-1 < iVar18)
                                    goto LAB_00082da4;
                            LAB_00082adc:
                                puVar23 = (undefined *)*param_2;
                                puVar17 = &DAT_000ad1f0;
                            }
                            puVar19 = &DAT_000a7f7c;
                            puVar8 = &DAT_000a7f7c;
                            if ((int)(uVar22 << 0x1c) < 0) {
                                puVar19 = (undefined *)*param_3;
                                puVar8 = &DAT_000ad1f0;
                            }
                            if ((int)(uVar22 << 0x1e) < 0) {
                                pcVar21 = local_84;
                            } else {
                                pcVar21 = "";
                            }
                            __fprintf_chk(iVar9, 1, "%s%s%s%s%s%s%s%s%s%s\n",
                                          pcVar15, pcVar24, puVar10, puVar11,
                                          puVar23, puVar17, puVar19, puVar8,
                                          pcVar21, param_1 + 0xe);
                            fflush(*(FILE **)(iVar16 + 0x10));
                            if ((int)(uint)(*(int *)(iVar16 + 0x20) == 0) <=
                                *(int *)(iVar16 + 0x24)) {
                                if (*(int *)(iVar16 + 4) != 3) {
                                    /* WARNING: Subroutine does not return */
                                    FUN_0007ecc0("./../lib/isc/log.c", 0x6bb, 2,
                                                 "channel->type == 3");
                                }
                                iVar9 = fileno(*(FILE **)(iVar16 + 0x10));
                                iVar9 = __fxstat64(3, iVar9, &sStack_158);
                                if ((-1 < iVar9) &&
                                    (iVar9 = *(int *)(iVar16 + 0x24),
                                     bVar25 = *(uint *)(iVar16 + 0x20) <
                                              (uint)sStack_158.st_size,
                                     (int)(iVar9 - (sStack_158.st_size._4_4_ +
                                                    (uint)bVar25)) < 0 !=
                                         (SBORROW4(iVar9,
                                                   sStack_158.st_size._4_4_) !=
                                          SBORROW4(iVar9 -
                                                       sStack_158.st_size._4_4_,
                                                   (uint)bVar25)))) {
                                    bVar1 = 1;
                                    *(undefined4 *)(iVar16 + 0x28) = 1;
                                    goto LAB_000828a0;
                                }
                            }
                        }
                    }
                LAB_00082898:
                    bVar1 = 1;
                }
            LAB_000828a0:
                bVar25 = puVar12 == (undefined4 *)0x0;
            } while (!(bool)(bVar25 & bVar1));
            iVar2 = pthread_mutex_unlock(__mutex);
            if (iVar2 != 0) {
                FUN_0007f61c("./../lib/isc/log.c", 0x6e6,
                             "((pthread_mutex_unlock(((&lctx->lock))) == 0) ? "
                             "0 : 34) == 0");
            }
        }
    }
LAB_0008272c:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00083300(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00082648();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00083370(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00082648();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000833dc(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00082648();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008344c(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00082648();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000834bc(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00082648();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00083538(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00082648();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000835b0(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00082648();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008362c(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00082648();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x000838bc) */

void FUN_00083830(int *param_1, int param_2, int param_3, int param_4)

{
    if ((param_1 != (int *)0x0) && (*param_1 != 0x4d436174)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/nls/msgcat.c", 0x77, 0,
                     "(((msgcat) != ((void *)0)) && (((const isc__magic_t "
                     "*)(msgcat))->magic == (((\'M\') << 24 | (\'C\') << 16 | "
                     "(\'a\') << 8 | (\'t\'))))) || msgcat == ((void *)0)");
    }
    if (param_2 < 1) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/nls/msgcat.c", 0x78, 0, "set > 0");
    }
    if (param_3 < 1) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/nls/msgcat.c", 0x79, 0, "message > 0");
    }
    if (param_4 != 0) {
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("./../lib/isc/nls/msgcat.c", 0x7a, 0,
                 "default_text != ((void *)0)");
}

void FUN_0008393c(int param_1)

{
    int iVar1;
    int *piVar2;
    undefined4 uVar3;
    int iVar4;
    undefined4 uVar5;
    socklen_t local_c4;
    sockaddr sStack_c0;
    undefined1 auStack_a4[128];
    int local_24;

    local_24 = __stack_chk_guard;
    iVar1 = socket(param_1, 1, 0);
    if (iVar1 == -1) {
        piVar2 = __errno_location();
        iVar1 = *piVar2;
        if (((iVar1 == 0x5d) || (iVar1 == 0x61)) || (iVar1 == 0x16)) {
            uVar5 = 0x17;
        } else {
            FUN_00085b10(iVar1, auStack_a4, 0x80);
            uVar5 = 0x22;
            uVar3 = FUN_00083830(isc_msgcat, 1, 0x65, "failed");
            FUN_0007f554("./../lib/isc/unix/net.c", 0x90, "socket() %s: %s",
                         uVar3, auStack_a4);
        }
        goto LAB_0008398c;
    }
    if (param_1 == 10) {
        local_c4 = 0x1c;
        iVar4 = getsockname(iVar1, &sStack_c0, &local_c4);
        if (iVar4 < 0) {
            uVar5 = 0x17;
            FUN_00083300(isc_lctx, 0xc7dc4, isc_modules, 0xfffffffc,
                         "retrieving the address of an IPv6 socket from the "
                         "kernel failed.");
            FUN_00083300(isc_lctx, 0xc7dc4, isc_modules, 0xfffffffc,
                         "IPv6 is not supported.");
        } else {
            if (local_c4 == 0x1c)
                goto LAB_00083980;
            uVar5 = 0x17;
            FUN_00083300(
                isc_lctx, 0xc7dc4, isc_modules, 0xfffffffc,
                "IPv6 structures in kernel and user space do not match.");
            FUN_00083300(isc_lctx, 0xc7dc4, isc_modules, 0xfffffffc,
                         "IPv6 is not supported.");
        }
    } else {
    LAB_00083980:
        uVar5 = 0;
    }
    close(iVar1);
LAB_0008398c:
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar5);
}

void FUN_00083bb8(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = pthread_once((pthread_once_t *)&DAT_00117260,
                         (__init_routine *)&LAB_00083b50);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_0007f61c("./../lib/isc/unix/net.c", 0xdd,
                     "((pthread_once((&once), (initialize_action)) == 0) ? 0 : "
                     "34) == 0");
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00083c50(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00083bb8();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(DAT_000c7dd4);
}

void FUN_00083ca8(void)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    FUN_00083bb8();
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(DAT_000c7dd8);
}

void FUN_00083d00(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    undefined4 uVar4;
    undefined4 local_a8;
    undefined1 auStack_a4[128];
    int local_24;

    local_24 = __stack_chk_guard;
    iVar1 = FUN_00083ca8();
    if (iVar1 == 0) {
        iVar1 = socket(10, 1, 0);
        if (iVar1 == -1) {
            piVar3 = __errno_location();
            FUN_00085b10(*piVar3, auStack_a4, 0x80);
            uVar4 = FUN_00083830(isc_msgcat, 1, 0x65, "failed");
            FUN_0007f554("./../lib/isc/unix/net.c", 0x10a, "socket() %s: %s",
                         uVar4, auStack_a4);
            DAT_000c7ddc = 0x22;
            iVar1 = DAT_000c7ddc;
        } else {
            local_a8 = 1;
            iVar2 = setsockopt(iVar1, 0x29, 0x1a, &local_a8, 4);
            if (iVar2 < 0) {
                DAT_000c7ddc = 0x17;
            } else {
                close(iVar1);
                iVar1 = socket(10, 2, 0);
                if (iVar1 == -1) {
                    piVar3 = __errno_location();
                    FUN_00085b10(*piVar3, auStack_a4, 0x80);
                    uVar4 = FUN_00083830(isc_msgcat, 1, 0x65, "failed");
                    FUN_0007f554("./../lib/isc/unix/net.c", 0x121,
                                 "socket() %s: %s", uVar4, auStack_a4);
                    DAT_000c7ddc = 0x22;
                    iVar1 = DAT_000c7ddc;
                    goto LAB_00083d38;
                }
                local_a8 = 1;
                iVar2 = setsockopt(iVar1, 0x29, 0x1a, &local_a8, 4);
                if (iVar2 < 0) {
                    DAT_000c7ddc = 0x17;
                } else {
                    DAT_000c7ddc = 0;
                }
            }
            close(iVar1);
            iVar1 = DAT_000c7ddc;
        }
    }
LAB_00083d38:
    DAT_000c7ddc = iVar1;
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00083f34(void)

{
    int iVar1;
    int iVar2;
    int *piVar3;
    undefined4 uVar4;
    undefined4 local_a0;
    undefined1 auStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = FUN_00083ca8();
    if (iVar1 == 0) {
        iVar1 = socket(10, 2, 0x11);
        if (iVar1 == -1) {
            piVar3 = __errno_location();
            FUN_00085b10(*piVar3, auStack_9c, 0x80);
            uVar4 = FUN_00083830(isc_msgcat, 1, 0x65, "failed");
            FUN_0007f554("./../lib/isc/unix/net.c", 0x152, "socket() %s: %s",
                         uVar4, auStack_9c);
            DAT_000c7de0 = 0x22;
            iVar1 = DAT_000c7de0;
        } else {
            local_a0 = 1;
            iVar2 = setsockopt(iVar1, 0x29, 0x31, &local_a0, 4);
            if (iVar2 < 0) {
                DAT_000c7de0 = 0x17;
            } else {
                DAT_000c7de0 = 0;
            }
            close(iVar1);
            iVar1 = DAT_000c7de0;
        }
    }
    DAT_000c7de0 = iVar1;
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_000840d8(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = pthread_once((pthread_once_t *)&DAT_00117264, FUN_00083d00);
    if (iVar2 != 0) {
        FUN_0007f61c("./../lib/isc/unix/net.c", 0x13d,
                     "((pthread_once((&once_ipv6only), (try_ipv6only)) == 0) ? "
                     "0 : 34) == 0");
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(DAT_000c7ddc);
}

void FUN_00084518(int *param_1, int *param_2, uint param_3)

{
    uint __n;
    int iVar1;
    uint uVar2;
    uint uVar3;
    int *piVar4;
    int iVar5;
    bool bVar6;

    iVar1 = __stack_chk_guard;
    piVar4 = param_2;
    if (param_2 != (int *)0x0) {
        piVar4 = (int *)0x1;
    }
    if (param_1 == (int *)0x0) {
        piVar4 = (int *)0x0;
    }
    if (piVar4 == (int *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/netaddr.c", 0x4e, 0,
                     "a != ((void *)0) && b != ((void *)0)");
    }
    iVar5 = *param_1;
    if ((iVar5 == *param_2) && (param_1[5] == param_2[5] || param_2[5] == 0)) {
        if (iVar5 == 2) {
            uVar2 = 0x20;
            uVar3 = 4;
        } else {
            if (iVar5 != 10)
                goto LAB_00084560;
            uVar2 = 0x80;
            uVar3 = 0x10;
        }
        if (param_3 < uVar2) {
            uVar2 = param_3;
        }
        __n = uVar2 >> 3;
        if ((__n == 0) ||
            (iVar5 = memcmp(param_1 + 1, param_2 + 1, __n), iVar5 == 0)) {
            if ((uVar2 & 7) == 0) {
                bVar6 = true;
            } else {
                if (uVar3 <= __n) {
                    /* WARNING: Subroutine does not return */
                    FUN_0007ecc0("./../lib/isc/netaddr.c", 0x74, 2,
                                 "nbytes < ipabytes");
                }
                bVar6 = ((uint)(*(byte *)((int)(param_1 + 1) + (uVar2 >> 3)) ^
                                *(byte *)((int)(param_2 + 1) + (uVar2 >> 3))) &
                         0xff << (8 - (uVar2 & 7) & 0xff)) == 0;
            }
            goto LAB_00084564;
        }
    }
LAB_00084560:
    bVar6 = false;
LAB_00084564:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(bVar6);
    }
    return;
}

void FUN_000849dc(int *param_1, int *param_2)

{
    int iVar1;
    uint uVar2;
    undefined4 uVar3;
    uint uVar4;
    byte bVar5;
    char *pcVar6;
    int iVar7;
    byte *pbVar8;
    uint uVar9;

    iVar1 = __stack_chk_guard;
    if (*param_1 == 2) {
        uVar9 = 4;
    } else {
        if (*param_1 != 10) {
            uVar3 = 0x1b;
            goto LAB_00084a50;
        }
        uVar9 = 0x10;
    }
    pbVar8 = (byte *)((int)param_1 + 3);
    uVar4 = 0;
    do {
        pbVar8 = pbVar8 + 1;
        bVar5 = *pbVar8;
        if (bVar5 != 0xff) {
            uVar2 = uVar4;
            if (uVar4 < uVar9) {
                iVar7 = 0;
                if ((bVar5 & 0x80) == 0)
                    goto LAB_00084aa0;
                goto LAB_00084a88;
            }
            break;
        }
        uVar4 = uVar4 + 1;
        uVar2 = uVar9;
    } while (uVar9 != uVar4);
    uVar4 = uVar2;
    iVar7 = 0;
LAB_00084a3c:
    uVar3 = 0;
    *param_2 = iVar7 + uVar4 * 8;
    goto LAB_00084a50;
    while (iVar7 != 8) {
    LAB_00084a88:
        bVar5 = bVar5 << 1;
        iVar7 = iVar7 + 1;
        if ((bVar5 & 0x80) == 0)
            break;
    }
LAB_00084aa0:
    if (bVar5 == 0) {
        if (uVar9 <= uVar4 + 1)
            goto LAB_00084a3c;
        pcVar6 = (char *)((int)param_1 + uVar4 + 5);
        if (*(char *)((int)param_1 + uVar4 + 5) == '\0') {
            do {
                if (pcVar6 == (char *)((int)param_1 + uVar9 + 3))
                    goto LAB_00084a3c;
                pcVar6 = pcVar6 + 1;
            } while (*pcVar6 == '\0');
        }
    }
    uVar3 = 0x25;
LAB_00084a50:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_00084b70(undefined4 *param_1, undefined4 *param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;
    undefined4 uVar5;

    param_1[2] = 0;
    param_1[3] = 0;
    iVar1 = __stack_chk_guard;
    param_1[1] = 0;
    param_1[4] = 0;
    iVar2 = __stack_chk_guard;
    param_1[5] = 0;
    *param_1 = 10;
    uVar3 = param_2[1];
    uVar4 = param_2[2];
    uVar5 = param_2[3];
    param_1[1] = *param_2;
    param_1[2] = uVar3;
    param_1[3] = uVar4;
    param_1[4] = uVar5;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00084c8c) */

void FUN_00084c28(int *param_1, int param_2)

{
    if (*param_1 == 10) {
        param_1[5] = param_2;
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("./../lib/isc/netaddr.c", 0x144, 0, "netaddr->family == 10");
}

void FUN_00084ce8(uint *param_1, ushort *param_2)

{
    int iVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    uVar3 = (uint)*param_2;
    *param_1 = uVar3;
    if (uVar3 == 2) {
        uVar3 = *(uint *)(param_2 + 2);
        param_1[5] = 0;
        param_1[1] = uVar3;
    } else {
        if (uVar3 != 10) {
            /* WARNING: Subroutine does not return */
            FUN_0007ecc0("./../lib/isc/netaddr.c", 0x166, 2, "0");
        }
        uVar2 = *(uint *)(param_2 + 6);
        uVar4 = *(uint *)(param_2 + 8);
        uVar3 = *(uint *)(param_2 + 10);
        param_1[1] = *(uint *)(param_2 + 4);
        param_1[2] = uVar2;
        param_1[3] = uVar4;
        param_1[4] = uVar3;
        param_1[5] = *(uint *)(param_2 + 0xc);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00084fc4) */

void FUN_00084f64(void)

{
    return;
}

void FUN_0008511c(uint param_1, uint param_2, uint param_3, uint param_4,
                  uint param_5)

{
    int iVar1;
    uint *puVar2;
    uint *puVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    if ((param_1 & 0xffff) != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/result.c", 0x79, 0, "base % 65536 == 0");
    }
    if (0x10000 < param_2) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/result.c", 0x7a, 0, "nresults <= 65536");
    }
    if (param_3 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/result.c", 0x7b, 0, "txt != ((void *)0)");
    }
    puVar3 = (uint *)malloc(0x1c);
    if (puVar3 == (uint *)0x0) {
        iVar4 = 1;
    } else {
        *puVar3 = param_1;
        puVar3[1] = (param_2 - 1) + param_1;
        puVar3[2] = param_3;
        puVar3[3] = param_4;
        puVar3[4] = param_5;
        puVar3[5] = 0xffffffff;
        puVar3[6] = 0xffffffff;
        iVar4 = pthread_mutex_lock((pthread_mutex_t *)&DAT_0011726c);
        if (iVar4 != 0) {
            FUN_0007f61c(
                "./../lib/isc/result.c", 0x8b,
                "((pthread_mutex_lock(((&lock))) == 0) ? 0 : 34) == 0");
        }
        puVar2 = puVar3;
        if (DAT_00117288 != (uint *)0x0) {
            DAT_00117288[6] = (uint)puVar3;
            puVar2 = DAT_00117284;
        }
        DAT_00117284 = puVar2;
        puVar3[5] = (uint)DAT_00117288;
        puVar3[6] = 0;
        DAT_00117288 = puVar3;
        iVar4 = pthread_mutex_unlock((pthread_mutex_t *)&DAT_0011726c);
        if (iVar4 != 0) {
            FUN_0007f61c(
                "./../lib/isc/result.c", 0x8f,
                "((pthread_mutex_unlock(((&lock))) == 0) ? 0 : 34) == 0");
            iVar4 = 0;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar4);
    }
    return;
}

void FUN_000852e0(void)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = FUN_00088614(&DAT_0011726c, "./../lib/isc/result.c", 0x98);
    if (iVar2 != 0) {
        FUN_0007f61c(
            "./../lib/isc/result.c", 0x98,
            "isc__mutex_init((&lock), \"./../lib/isc/result.c\", 152) == 0");
    }
    DAT_00117284 = 0;
    DAT_00117288 = 0;
    iVar2 = FUN_0008511c(0, 0x3e, &PTR_s_success_000c7de4, isc_msgcat, 2);
    if (iVar2 != 0) {
        uVar3 = FUN_00083830(isc_msgcat, 1, 0x65, "failed");
        FUN_0007f554("./../lib/isc/result.c", 0x9e, "register_table() %s: %u",
                     uVar3, iVar2);
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00085400(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    FUN_000803e8();
    iVar2 = pthread_once((pthread_once_t *)&DAT_0011728c, FUN_000852e0);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_0007f61c("./../lib/isc/result.c", 0xa8,
                     "((pthread_once((&once), (initialize_action)) == 0) ? 0 : "
                     "34) == 0");
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000854a0(uint param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;
    uint *puVar4;

    iVar1 = __stack_chk_guard;
    FUN_00085400();
    iVar2 = pthread_mutex_lock((pthread_mutex_t *)&DAT_0011726c);
    if (iVar2 != 0) {
        FUN_0007f61c("./../lib/isc/result.c", 0xb3,
                     "((pthread_mutex_lock(((&lock))) == 0) ? 0 : 34) == 0");
    }
    puVar4 = (uint *)&DAT_0011726c;
    do {
        puVar4 = (uint *)puVar4[6];
        if (puVar4 == (uint *)0x0)
            goto LAB_00085528;
    } while ((param_1 < *puVar4) || (puVar4[1] < param_1));
    iVar2 = param_1 - *puVar4;
    iVar2 = FUN_00083830(puVar4[3], puVar4[4], iVar2 + 1,
                         *(undefined4 *)(puVar4[2] + iVar2 * 4));
    if (iVar2 == 0) {
    LAB_00085528:
        iVar2 =
            FUN_00083830(isc_msgcat, 3, 1, "(result code text not available)");
    }
    iVar3 = pthread_mutex_unlock((pthread_mutex_t *)&DAT_0011726c);
    if (iVar3 != 0) {
        FUN_0007f61c("./../lib/isc/result.c", 0xca,
                     "((pthread_mutex_unlock(((&lock))) == 0) ? 0 : 34) == 0");
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar2);
}

void FUN_00085654(char *param_1, char *param_2, undefined4 *param_3)

{
    int iVar1;
    FILE *pFVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    pFVar2 = fopen64(param_1, param_2);
    if (pFVar2 == (FILE *)0x0) {
        piVar3 = __errno_location();
        if (iVar1 == __stack_chk_guard) {
            FUN_0008a990(*piVar3, "./../lib/isc/unix/stdio.c", 0x24);
            return;
        }
    } else {
        *param_3 = pFVar2;
        piVar3 = (int *)0x0;
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar3);
}

void FUN_00085b10(int param_1, int param_2, undefined4 param_3)

{
    int iVar1;
    int iVar2;
    char *pcVar3;

    iVar1 = __stack_chk_guard;
    if (param_2 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/strerror.c", 0x37, 0,
                     "buf != ((void *)0)");
    }
    iVar2 = pthread_once((pthread_once_t *)&DAT_001172a8,
                         (__init_routine *)&LAB_00085a78);
    if (iVar2 != 0) {
        FUN_0007f61c(
            "./../lib/isc/unix/strerror.c", 0x39,
            "((pthread_once((&once), (init_lock)) == 0) ? 0 : 34) == 0");
    }
    iVar2 = pthread_mutex_lock((pthread_mutex_t *)&DAT_00117290);
    if (iVar2 == 0) {
        pcVar3 = strerror(param_1);
    } else {
        FUN_0007f61c("./../lib/isc/unix/strerror.c", 0x3b,
                     "((pthread_mutex_lock(((&isc_strerror_lock))) == 0) ? 0 : "
                     "34) == 0");
        pcVar3 = strerror(param_1);
    }
    if (pcVar3 == (char *)0x0) {
        FUN_0007c054(param_2, param_3, "Unknown error: %u", param_1);
    } else {
        FUN_0007c054(param_2, param_3, "%s");
    }
    iVar2 = pthread_mutex_unlock((pthread_mutex_t *)&DAT_00117290);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_0007f61c("./../lib/isc/unix/strerror.c", 0x41,
                     "((pthread_mutex_unlock(((&isc_strerror_lock))) == 0) ? 0 "
                     ": 34) == 0");
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x00085d1c) */

void FUN_00085cac(undefined4 *param_1, undefined4 param_2, uint param_3)

{
    if (param_1 == (undefined4 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/time.c", 0x5a, 0, "i != ((void *)0)");
    }
    if (999999999 < param_3) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/time.c", 0x5b, 0,
                     "nanoseconds < 1000000000");
    }
    *param_1 = param_2;
    param_1[1] = param_3;
    return;
}

void FUN_00085fe8(int *param_1)

{
    int iVar1;
    undefined4 uVar2;
    int *piVar3;
    timeval local_9c;
    undefined1 auStack_94[128];
    int local_14;

    local_14 = __stack_chk_guard;
    if (param_1 == (int *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/time.c", 0x96, 0, "t != ((void *)0)");
    }
    iVar1 = gettimeofday(&local_9c, (__timezone_ptr_t)0x0);
    if (iVar1 == -1) {
        piVar3 = __errno_location();
        FUN_00085b10(*piVar3, auStack_94, 0x80);
        FUN_0007f554("./../lib/isc/unix/time.c", 0x9a, "%s", auStack_94);
        uVar2 = 0x22;
        goto LAB_000860bc;
    }
    if (local_9c.tv_usec < 0) {
        do {
            local_9c.tv_sec = local_9c.tv_sec + -1;
            local_9c.tv_usec =
                (__suseconds_t)(&DAT_000f4240 + local_9c.tv_usec);
        } while (local_9c.tv_usec < 0);
    LAB_00086084:
        __syslog_chk(3, 1, "gettimeofday returned bad tv_usec: corrected");
    } else if (999999 < local_9c.tv_usec) {
        do {
            local_9c.tv_sec = local_9c.tv_sec + 1;
            local_9c.tv_usec = local_9c.tv_usec + -1000000;
        } while (999999 < local_9c.tv_usec);
        goto LAB_00086084;
    }
    if (local_9c.tv_sec < 0) {
        uVar2 = 0x22;
    } else {
        uVar2 = 0;
        *param_1 = local_9c.tv_sec;
        param_1[1] = local_9c.tv_usec * 1000;
    }
LAB_000860bc:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

/* WARNING: Removing unreachable block (ram,0x0008644c) */

void FUN_00086378(int param_1, int param_2)

{
    int iVar1;

    iVar1 = param_2;
    if (param_2 != 0) {
        iVar1 = 1;
    }
    if (param_1 == 0) {
        iVar1 = 0;
    }
    if (iVar1 != 0) {
        if ((*(uint *)(param_1 + 4) < 1000000000) &&
            (*(uint *)(param_2 + 4) < 1000000000)) {
            return;
        }
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0(
            "./../lib/isc/unix/time.c", 0xf1, 2,
            "t1->nanoseconds < 1000000000 && t2->nanoseconds < 1000000000");
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("./../lib/isc/unix/time.c", 0xf0, 0,
                 "t1 != ((void *)0) && t2 != ((void *)0)");
}

void FUN_00086468(uint *param_1, uint *param_2, int *param_3)

{
    int iVar1;
    uint uVar2;
    undefined4 uVar3;
    uint uVar4;
    int *piVar5;
    uint uVar6;
    int iVar7;
    uint uVar8;

    iVar1 = __stack_chk_guard;
    piVar5 = param_3;
    if (param_3 != (int *)0x0) {
        piVar5 = (int *)0x1;
    }
    if (param_2 == (uint *)0x0) {
        piVar5 = (int *)0x0;
    }
    if (param_1 == (uint *)0x0) {
        piVar5 = (int *)0x0;
    }
    if (piVar5 == (int *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0(
            "./../lib/isc/unix/time.c", 0x101, 0,
            "t != ((void *)0) && i != ((void *)0) && result != ((void *)0)");
    }
    uVar8 = param_1[1];
    if ((999999999 < uVar8) || (999999999 < param_2[1])) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0(
            "./../lib/isc/unix/time.c", 0x102, 2,
            "t->nanoseconds < 1000000000 && i->nanoseconds < 1000000000");
    }
    uVar2 = *param_1;
    uVar6 = *param_2;
    if ((((int)uVar2 < 0) || ((int)uVar6 < 0)) && (CARRY4(uVar6, uVar2))) {
        uVar3 = 0x29;
    } else {
        uVar4 = uVar8 + param_2[1];
        iVar7 = uVar6 + uVar2;
        *param_3 = iVar7;
        if (999999999 < uVar4) {
            iVar7 = iVar7 + 1;
            uVar8 = uVar4 + 0xc4653600;
        }
        uVar3 = 0;
        param_3[1] = uVar4;
        if (999999999 < uVar4) {
            *param_3 = iVar7;
            param_3[1] = uVar8;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_000865a8(uint *param_1, uint *param_2, int *param_3)

{
    int iVar1;
    uint uVar2;
    undefined4 uVar3;
    uint uVar4;
    int *piVar5;
    uint uVar6;
    int iVar7;
    uint uVar8;

    iVar1 = __stack_chk_guard;
    piVar5 = param_3;
    if (param_3 != (int *)0x0) {
        piVar5 = (int *)0x1;
    }
    if (param_2 == (uint *)0x0) {
        piVar5 = (int *)0x0;
    }
    if (param_1 == (uint *)0x0) {
        piVar5 = (int *)0x0;
    }
    if (piVar5 == (int *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0(
            "./../lib/isc/unix/time.c", 0x11c, 0,
            "t != ((void *)0) && i != ((void *)0) && result != ((void *)0)");
    }
    uVar6 = param_1[1];
    if ((999999999 < uVar6) || (uVar8 = param_2[1], 999999999 < uVar8)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0(
            "./../lib/isc/unix/time.c", 0x11d, 2,
            "t->nanoseconds < 1000000000 && i->nanoseconds < 1000000000");
    }
    uVar2 = *param_1;
    uVar4 = *param_2;
    if (uVar2 < uVar4) {
    LAB_00086684:
        uVar3 = 0x29;
    } else {
        if (uVar2 == uVar4) {
            if (uVar6 < uVar8)
                goto LAB_00086684;
            iVar7 = uVar6 - uVar8;
            *param_3 = 0;
        } else {
            *param_3 = uVar2 - uVar4;
            iVar7 = uVar6 - uVar8;
            if (uVar6 < uVar8) {
                *param_3 = (uVar2 - uVar4) + -1;
                uVar3 = 0;
                param_3[1] = iVar7 + 1000000000;
                goto LAB_0008664c;
            }
        }
        param_3[1] = iVar7;
        uVar3 = 0;
    }
LAB_0008664c:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_000869f8(time_t *param_1, char *param_2, size_t param_3)

{
    tm *__tp;
    size_t sVar1;
    time_t local_20;
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_3 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/time.c", 0x182, 0, "len > 0");
    }
    local_20 = *param_1;
    __tp = localtime(&local_20);
    sVar1 = strftime(param_2, param_3, "%d-%b-%Y %X", __tp);
    if (sVar1 < param_3) {
        if (sVar1 == 0) {
            FUN_0007c054(param_2, param_3, "99-Bad-9999 99:99:99.999");
        } else {
            FUN_0007c054(param_2 + sVar1, param_3 - sVar1, ".%03u",
                         (uint)param_1[1] / 1000000);
        }
        if (local_1c == __stack_chk_guard) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("./../lib/isc/unix/time.c", 0x186, 2, "flen < len");
}

void FUN_00086ca4(uint *param_1, uint *param_2)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;
    uint uVar7;
    uint *unaff_r4;
    uint uVar8;
    uint *unaff_r5;
    uint uVar9;
    uint uVar10;
    uint uVar11;
    uint uVar12;
    uint uVar13;
    uint uVar14;
    uint uVar15;
    uint uVar16;
    uint uVar17;
    uint uVar18;
    uint uVar19;
    uint uVar20;
    uint uVar21;
    uint uVar22;
    uint uVar23;
    uint *puVar24;
    uint uVar25;
    uint uVar26;
    uint uVar27;
    uint uVar28;
    uint uVar29;
    bool bVar30;
    uint local_6c;
    uint local_68;
    uint local_64;
    uint local_60;
    uint local_5c;
    uint local_58;
    uint local_54;
    uint local_50;
    uint local_4c;
    uint local_48;
    uint local_44;
    uint local_40;
    uint local_3c;
    uint local_38;
    uint local_34;
    uint local_30;
    int local_2c;

    if (param_2 != (uint *)0x0) {
        unaff_r4 = &local_6c;
        unaff_r5 = param_2 + 0x10;
    }
    local_2c = __stack_chk_guard;
    if (param_2 == (uint *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/sha1.c", 0xd0, 2, "buffer != ((void *)0)");
    }
    do {
        puVar24 = param_2 + 4;
        uVar1 = param_2[1];
        uVar6 = param_2[2];
        uVar7 = param_2[3];
        *unaff_r4 = *param_2;
        unaff_r4[1] = uVar1;
        unaff_r4[2] = uVar6;
        unaff_r4[3] = uVar7;
        unaff_r4 = unaff_r4 + 4;
        param_2 = puVar24;
    } while (puVar24 != unaff_r5);
    uVar16 = param_1[1];
    uVar9 = *param_1;
    uVar25 = param_1[2];
    uVar21 = local_68 << 0x18 | (local_68 >> 8 & 0xff) << 0x10 |
             (local_68 >> 0x10 & 0xff) << 8 | local_68 >> 0x18;
    uVar15 = param_1[3];
    uVar1 = uVar16 >> 2 | uVar16 << 0x1e;
    uVar6 = uVar9 >> 2 | uVar9 << 0x1e;
    uVar22 = local_6c << 0x18 | (local_6c >> 8 & 0xff) << 0x10 |
             (local_6c >> 0x10 & 0xff) << 8 | local_6c >> 0x18;
    uVar2 = uVar22 + ((uVar25 ^ uVar15) & uVar16 ^ uVar15) + param_1[4] +
            0x5a827999 + (uVar9 >> 0x1b | uVar9 << 5);
    uVar7 = uVar2 >> 2 | uVar2 * 0x40000000;
    uVar10 = ((uVar25 ^ uVar1) & uVar9 ^ uVar25) + uVar15 + 0x5a827999 +
             uVar21 + (uVar2 >> 0x1b | uVar2 * 0x20);
    uVar19 = local_64 << 0x18 | (local_64 >> 8 & 0xff) << 0x10 |
             (local_64 >> 0x10 & 0xff) << 8 | local_64 >> 0x18;
    uVar23 = uVar10 >> 2 | uVar10 * 0x40000000;
    uVar3 = (uVar2 & (uVar1 ^ uVar6) ^ uVar1) + uVar25 + 0x5a827999 + uVar19 +
            (uVar10 >> 0x1b | uVar10 * 0x20);
    uVar14 = local_60 << 0x18 | (local_60 >> 8 & 0xff) << 0x10 |
             (local_60 >> 0x10 & 0xff) << 8 | local_60 >> 0x18;
    uVar11 = local_5c << 0x18 | (local_5c >> 8 & 0xff) << 0x10 |
             (local_5c >> 0x10 & 0xff) << 8 | local_5c >> 0x18;
    uVar2 = uVar3 >> 2 | uVar3 * 0x40000000;
    uVar27 = ((uVar6 ^ uVar7) & uVar10 ^ uVar6) + uVar1 + 0x5a827999 + uVar14 +
             (uVar3 >> 0x1b | uVar3 * 0x20);
    uVar12 = local_58 << 0x18 | (local_58 >> 8 & 0xff) << 0x10 |
             (local_58 >> 0x10 & 0xff) << 8 | local_58 >> 0x18;
    uVar10 = ((uVar7 ^ uVar23) & uVar3 ^ uVar7) + uVar6 + 0x5a827999 + uVar11 +
             (uVar27 >> 0x1b | uVar27 * 0x20);
    uVar1 = uVar27 >> 2 | uVar27 * 0x40000000;
    uVar4 = local_54 << 0x18 | (local_54 >> 8 & 0xff) << 0x10 |
            (local_54 >> 0x10 & 0xff) << 8 | local_54 >> 0x18;
    uVar6 = uVar10 >> 2 | uVar10 * 0x40000000;
    uVar3 = ((uVar23 ^ uVar2) & uVar27 ^ uVar23) + uVar12 + 0x5a827999 + uVar7 +
            (uVar10 >> 0x1b | uVar10 * 0x20);
    uVar5 = local_50 << 0x18 | (local_50 >> 8 & 0xff) << 0x10 |
            (local_50 >> 0x10 & 0xff) << 8 | local_50 >> 0x18;
    uVar7 = uVar3 >> 2 | uVar3 * 0x40000000;
    uVar27 = (uVar10 & (uVar2 ^ uVar1) ^ uVar2) + uVar4 + 0x5a827999 + uVar23 +
             (uVar3 >> 0x1b | uVar3 * 0x20);
    uVar20 = local_4c << 0x18 | (local_4c >> 8 & 0xff) << 0x10 |
             (local_4c >> 0x10 & 0xff) << 8 | local_4c >> 0x18;
    uVar23 = uVar27 >> 2 | uVar27 * 0x40000000;
    uVar10 = ((uVar1 ^ uVar6) & uVar3 ^ uVar1) + uVar5 + 0x5a827999 + uVar2 +
             (uVar27 >> 0x1b | uVar27 * 0x20);
    uVar2 = uVar10 >> 2 | uVar10 * 0x40000000;
    uVar28 = local_48 << 0x18 | (local_48 >> 8 & 0xff) << 0x10 |
             (local_48 >> 0x10 & 0xff) << 8 | local_48 >> 0x18;
    uVar3 = (uVar27 & (uVar6 ^ uVar7) ^ uVar6) + uVar20 + 0x5a827999 + uVar1 +
            (uVar10 >> 0x1b | uVar10 * 0x20);
    uVar13 = local_44 << 0x18 | (local_44 >> 8 & 0xff) << 0x10 |
             (local_44 >> 0x10 & 0xff) << 8 | local_44 >> 0x18;
    uVar1 = uVar3 >> 2 | uVar3 * 0x40000000;
    uVar10 = (uVar10 & (uVar7 ^ uVar23) ^ uVar7) + uVar28 + 0x5a827999 + uVar6 +
             (uVar3 >> 0x1b | uVar3 * 0x20);
    uVar17 = local_40 << 0x18 | (local_40 >> 8 & 0xff) << 0x10 |
             (local_40 >> 0x10 & 0xff) << 8 | local_40 >> 0x18;
    uVar6 = uVar10 >> 2 | uVar10 * 0x40000000;
    uVar27 = ((uVar23 ^ uVar2) & uVar3 ^ uVar23) + uVar13 + 0x5a827999 + uVar7 +
             (uVar10 >> 0x1b | uVar10 * 0x20);
    uVar18 = local_3c << 0x18 | (local_3c >> 8 & 0xff) << 0x10 |
             (local_3c >> 0x10 & 0xff) << 8 | local_3c >> 0x18;
    uVar7 = uVar27 >> 2 | uVar27 * 0x40000000;
    uVar3 = (uVar10 & (uVar2 ^ uVar1) ^ uVar2) + uVar17 + 0x5a827999 + uVar23 +
            (uVar27 >> 0x1b | uVar27 * 0x20);
    uVar8 = local_38 << 0x18 | (local_38 >> 8 & 0xff) << 0x10 |
            (local_38 >> 0x10 & 0xff) << 8 | local_38 >> 0x18;
    uVar23 = uVar3 >> 2 | uVar3 * 0x40000000;
    uVar29 = local_34 << 0x18 | (local_34 >> 8 & 0xff) << 0x10 |
             (local_34 >> 0x10 & 0xff) << 8 | local_34 >> 0x18;
    uVar2 = (uVar27 & (uVar1 ^ uVar6) ^ uVar1) + uVar18 + 0x5a827999 + uVar2 +
            (uVar3 >> 0x1b | uVar3 * 0x20);
    uVar26 = local_30 << 0x18 | (local_30 >> 8 & 0xff) << 0x10 |
             (local_30 >> 0x10 & 0xff) << 8 | local_30 >> 0x18;
    uVar3 = ((uVar6 ^ uVar7) & uVar3 ^ uVar6) + uVar8 + 0x5a827999 + uVar1 +
            (uVar2 >> 0x1b | uVar2 * 0x20);
    uVar1 = uVar2 >> 2 | uVar2 * 0x40000000;
    uVar10 = ((uVar7 ^ uVar23) & uVar2 ^ uVar7) + uVar29 + 0x5a827999 + uVar6 +
             (uVar3 >> 0x1b | uVar3 * 0x20);
    uVar6 = uVar3 >> 2 | uVar3 * 0x40000000;
    uVar2 = uVar22 ^ uVar19 ^ uVar20 ^ uVar8;
    uVar2 = uVar2 >> 0x1f | uVar2 << 1;
    uVar27 = ((uVar23 ^ uVar1) & uVar3 ^ uVar23) + uVar26 + 0x5a827999 + uVar7 +
             (uVar10 >> 0x1b | uVar10 * 0x20);
    uVar7 = uVar10 >> 2 | uVar10 * 0x40000000;
    uVar3 = uVar27 >> 2 | uVar27 * 0x40000000;
    uVar22 = ((uVar1 ^ uVar6) & uVar10 ^ uVar1) + uVar2 + 0x5a827999 + uVar23 +
             (uVar27 >> 0x1b | uVar27 * 0x20);
    uVar23 = uVar21 ^ uVar14 ^ uVar28 ^ uVar29;
    uVar23 = uVar23 >> 0x1f | uVar23 << 1;
    uVar10 = uVar19 ^ uVar11 ^ uVar13 ^ uVar26;
    uVar10 = uVar10 >> 0x1f | uVar10 << 1;
    uVar19 = uVar14 ^ uVar12 ^ uVar17 ^ uVar2;
    uVar14 = (uVar27 & (uVar6 ^ uVar7) ^ uVar6) + uVar23 + 0x5a827999 + uVar1 +
             (uVar22 >> 0x1b | uVar22 * 0x20);
    uVar1 = uVar19 >> 0x1f | uVar19 << 1;
    uVar27 = uVar22 >> 2 | uVar22 * 0x40000000;
    uVar11 = uVar11 ^ uVar4 ^ uVar18 ^ uVar23;
    uVar11 = uVar11 >> 0x1f | uVar11 << 1;
    uVar19 = (uVar22 & (uVar7 ^ uVar3) ^ uVar7) + uVar10 + 0x5a827999 + uVar6 +
             (uVar14 >> 0x1b | uVar14 * 0x20);
    uVar6 = uVar14 >> 2 | uVar14 * 0x40000000;
    uVar22 = ((uVar3 ^ uVar27) & uVar14 ^ uVar3) + uVar1 + 0x5a827999 + uVar7 +
             (uVar19 >> 0x1b | uVar19 * 0x20);
    uVar12 = uVar12 ^ uVar5 ^ uVar8 ^ uVar10;
    uVar7 = uVar22 >> 2 | uVar22 * 0x40000000;
    uVar14 = uVar19 >> 2 | uVar19 * 0x40000000;
    uVar12 = uVar12 >> 0x1f | uVar12 << 1;
    uVar21 = (uVar19 ^ uVar27 ^ uVar6) + uVar11 + 0x6ed9eba1 + uVar3 +
             (uVar22 >> 0x1b | uVar22 * 0x20);
    uVar3 = uVar4 ^ uVar20 ^ uVar29 ^ uVar1;
    uVar3 = uVar3 >> 0x1f | uVar3 << 1;
    uVar4 = uVar5 ^ uVar28 ^ uVar26 ^ uVar11;
    uVar4 = uVar4 >> 0x1f | uVar4 << 1;
    uVar19 = (uVar6 ^ uVar14 ^ uVar22) + uVar12 + 0x6ed9eba1 + uVar27 +
             (uVar21 >> 0x1b | uVar21 * 0x20);
    uVar27 = uVar21 >> 2 | uVar21 * 0x40000000;
    uVar5 = uVar20 ^ uVar13 ^ uVar2 ^ uVar12;
    uVar5 = uVar5 >> 0x1f | uVar5 << 1;
    uVar20 = (uVar21 ^ uVar14 ^ uVar7) + uVar3 + 0x6ed9eba1 + uVar6 +
             (uVar19 >> 0x1b | uVar19 * 0x20);
    uVar6 = uVar28 ^ uVar17 ^ uVar23 ^ uVar3;
    uVar6 = uVar6 >> 0x1f | uVar6 << 1;
    uVar22 = uVar19 >> 2 | uVar19 * 0x40000000;
    uVar21 = (uVar7 ^ uVar27 ^ uVar19) + uVar4 + 0x6ed9eba1 + uVar14 +
             (uVar20 >> 0x1b | uVar20 * 0x20);
    uVar14 = uVar20 >> 2 | uVar20 * 0x40000000;
    uVar19 = uVar13 ^ uVar18 ^ uVar10 ^ uVar4;
    uVar19 = uVar19 >> 0x1f | uVar19 << 1;
    uVar13 = uVar21 >> 2 | uVar21 * 0x40000000;
    uVar20 = (uVar20 ^ uVar27 ^ uVar22) + uVar5 + 0x6ed9eba1 + uVar7 +
             (uVar21 >> 0x1b | uVar21 * 0x20);
    uVar28 = (uVar22 ^ uVar14 ^ uVar21) + uVar6 + 0x6ed9eba1 + uVar27 +
             (uVar20 >> 0x1b | uVar20 * 0x20);
    uVar21 = uVar17 ^ uVar8 ^ uVar1 ^ uVar5;
    uVar7 = uVar18 ^ uVar29 ^ uVar11 ^ uVar6;
    uVar7 = uVar7 >> 0x1f | uVar7 << 1;
    uVar27 = uVar20 >> 2 | uVar20 * 0x40000000;
    uVar21 = uVar21 >> 0x1f | uVar21 << 1;
    uVar17 = (uVar14 ^ uVar13 ^ uVar20) + uVar19 + 0x6ed9eba1 + uVar22 +
             (uVar28 >> 0x1b | uVar28 * 0x20);
    uVar22 = uVar28 >> 2 | uVar28 * 0x40000000;
    uVar20 = uVar8 ^ uVar26 ^ uVar12 ^ uVar19;
    uVar20 = uVar20 >> 0x1f | uVar20 << 1;
    uVar8 = uVar17 >> 2 | uVar17 * 0x40000000;
    uVar18 = (uVar28 ^ uVar13 ^ uVar27) + uVar21 + 0x6ed9eba1 + uVar14 +
             (uVar17 >> 0x1b | uVar17 * 0x20);
    uVar14 = uVar29 ^ uVar2 ^ uVar3 ^ uVar21;
    uVar14 = uVar14 >> 0x1f | uVar14 << 1;
    uVar28 = uVar26 ^ uVar23 ^ uVar4 ^ uVar7;
    uVar28 = uVar28 >> 0x1f | uVar28 << 1;
    uVar26 = (uVar17 ^ uVar27 ^ uVar22) + uVar7 + 0x6ed9eba1 + uVar13 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar13 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar17 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar18 = (uVar22 ^ uVar8 ^ uVar18) + uVar20 + 0x6ed9eba1 + uVar27 +
             (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar2 = uVar2 ^ uVar10 ^ uVar5 ^ uVar20;
    uVar2 = uVar2 >> 0x1f | uVar2 << 1;
    uVar26 = (uVar8 ^ uVar13 ^ uVar26) + uVar14 + 0x6ed9eba1 + uVar22 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar27 = uVar23 ^ uVar1 ^ uVar6 ^ uVar14;
    uVar23 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar27 = uVar27 >> 0x1f | uVar27 << 1;
    uVar18 = (uVar18 ^ uVar13 ^ uVar17) + uVar28 + 0x6ed9eba1 + uVar8 +
             (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar22 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar8 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar10 = uVar10 ^ uVar11 ^ uVar19 ^ uVar28;
    uVar10 = uVar10 >> 0x1f | uVar10 << 1;
    uVar26 = (uVar17 ^ uVar23 ^ uVar26) + uVar2 + 0x6ed9eba1 + uVar13 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar1 = uVar1 ^ uVar12 ^ uVar21 ^ uVar2;
    uVar1 = uVar1 >> 0x1f | uVar1 << 1;
    uVar18 = (uVar18 ^ uVar23 ^ uVar22) + uVar27 + 0x6ed9eba1 + uVar17 +
             (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar11 = uVar11 ^ uVar3 ^ uVar7 ^ uVar27;
    uVar11 = uVar11 >> 0x1f | uVar11 << 1;
    uVar13 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar12 = uVar12 ^ uVar4 ^ uVar20 ^ uVar10;
    uVar12 = uVar12 >> 0x1f | uVar12 << 1;
    uVar26 = (uVar26 ^ uVar22 ^ uVar8) + uVar10 + 0x6ed9eba1 + uVar23 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar23 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar17 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar18 = (uVar8 ^ uVar13 ^ uVar18) + uVar1 + 0x6ed9eba1 + uVar22 +
             (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar3 = uVar3 ^ uVar5 ^ uVar14 ^ uVar1;
    uVar3 = uVar3 >> 0x1f | uVar3 << 1;
    uVar22 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar29 = (uVar26 ^ uVar13 ^ uVar23) + uVar11 + 0x6ed9eba1 + uVar8 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar4 = uVar4 ^ uVar6 ^ uVar28 ^ uVar11;
    uVar4 = uVar4 >> 0x1f | uVar4 << 1;
    uVar26 = (uVar23 ^ uVar17 ^ uVar18) + uVar12 + 0x6ed9eba1 + uVar13 +
             (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar13 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar5 = uVar5 ^ uVar19 ^ uVar2 ^ uVar12;
    uVar5 = uVar5 >> 0x1f | uVar5 << 1;
    uVar8 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar18 = (uVar29 ^ uVar17 ^ uVar22) + uVar3 + 0x6ed9eba1 + uVar23 +
             (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar23 = uVar6 ^ uVar21 ^ uVar27 ^ uVar3;
    uVar6 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar26 = (uVar26 ^ uVar22 ^ uVar13) + uVar4 + 0x6ed9eba1 + uVar17 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar23 = uVar23 >> 0x1f | uVar23 << 1;
    uVar17 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar18 = ((uVar18 | uVar8) & uVar13 | uVar18 & uVar8) + uVar5 + 0x8f1bbcdc +
             uVar22 + (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar22 = uVar19 ^ uVar7 ^ uVar10 ^ uVar4;
    uVar22 = uVar22 >> 0x1f | uVar22 << 1;
    uVar19 = uVar21 ^ uVar20 ^ uVar1 ^ uVar5;
    uVar19 = uVar19 >> 0x1f | uVar19 << 1;
    uVar21 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar26 = ((uVar26 | uVar6) & uVar8 | uVar26 & uVar6) + uVar23 + 0x8f1bbcdc +
             uVar13 + (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar13 = uVar7 ^ uVar14 ^ uVar11 ^ uVar23;
    uVar29 = ((uVar18 | uVar17) & uVar6 | uVar18 & uVar17) + uVar22 +
             0x8f1bbcdc + uVar8 + (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar7 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar13 = uVar13 >> 0x1f | uVar13 << 1;
    uVar18 = ((uVar26 | uVar21) & uVar17 | uVar26 & uVar21) + uVar19 +
             0x8f1bbcdc + uVar6 + (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar6 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar20 = uVar20 ^ uVar28 ^ uVar12 ^ uVar22;
    uVar20 = uVar20 >> 0x1f | uVar20 << 1;
    uVar8 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar14 = uVar14 ^ uVar2 ^ uVar3 ^ uVar19;
    uVar26 = ((uVar29 | uVar7) & uVar21 | uVar29 & uVar7) + uVar13 +
             0x8f1bbcdc + uVar17 + (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar14 = uVar14 >> 0x1f | uVar14 << 1;
    uVar17 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar18 = ((uVar18 | uVar6) & uVar7 | uVar18 & uVar6) + uVar20 + 0x8f1bbcdc +
             uVar21 + (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar21 = uVar28 ^ uVar27 ^ uVar4 ^ uVar13;
    uVar21 = uVar21 >> 0x1f | uVar21 << 1;
    uVar28 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar26 = ((uVar26 | uVar8) & uVar6 | uVar26 & uVar8) + uVar14 + 0x8f1bbcdc +
             uVar7 + (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar7 = uVar2 ^ uVar10 ^ uVar5 ^ uVar20;
    uVar7 = uVar7 >> 0x1f | uVar7 << 1;
    uVar2 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar29 = ((uVar18 | uVar17) & uVar8 | uVar18 & uVar17) + uVar21 +
             0x8f1bbcdc + uVar6 + (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar6 = uVar27 ^ uVar1 ^ uVar23 ^ uVar14;
    uVar6 = uVar6 >> 0x1f | uVar6 << 1;
    uVar27 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar18 = ((uVar26 | uVar28) & uVar17 | uVar26 & uVar28) + uVar7 +
             0x8f1bbcdc + uVar8 + (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar10 = uVar10 ^ uVar11 ^ uVar22 ^ uVar21;
    uVar10 = uVar10 >> 0x1f | uVar10 << 1;
    uVar8 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar26 = ((uVar29 | uVar2) & uVar28 | uVar29 & uVar2) + uVar6 + 0x8f1bbcdc +
             uVar17 + (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar1 = uVar1 ^ uVar12 ^ uVar19 ^ uVar7;
    uVar1 = uVar1 >> 0x1f | uVar1 << 1;
    uVar17 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar18 = ((uVar18 | uVar27) & uVar2 | uVar18 & uVar27) + uVar10 +
             0x8f1bbcdc + uVar28 + (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar11 = uVar11 ^ uVar3 ^ uVar13 ^ uVar6;
    uVar11 = uVar11 >> 0x1f | uVar11 << 1;
    uVar28 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar26 = ((uVar26 | uVar8) & uVar27 | uVar26 & uVar8) + uVar1 + 0x8f1bbcdc +
             uVar2 + (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar2 = uVar12 ^ uVar4 ^ uVar20 ^ uVar10;
    uVar2 = uVar2 >> 0x1f | uVar2 << 1;
    uVar12 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar3 = uVar3 ^ uVar5 ^ uVar14 ^ uVar1;
    uVar18 = ((uVar18 | uVar17) & uVar8 | uVar18 & uVar17) + uVar11 +
             0x8f1bbcdc + uVar27 + (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar3 = uVar3 >> 0x1f | uVar3 << 1;
    uVar27 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar26 = ((uVar26 | uVar28) & uVar17 | uVar26 & uVar28) + uVar2 +
             0x8f1bbcdc + uVar8 + (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar4 = uVar4 ^ uVar23 ^ uVar21 ^ uVar11;
    uVar4 = uVar4 >> 0x1f | uVar4 << 1;
    uVar8 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar5 = uVar5 ^ uVar22 ^ uVar7 ^ uVar2;
    uVar18 = ((uVar18 | uVar12) & uVar28 | uVar18 & uVar12) + uVar3 +
             0x8f1bbcdc + uVar17 + (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar5 = uVar5 >> 0x1f | uVar5 << 1;
    uVar23 = uVar23 ^ uVar19 ^ uVar6 ^ uVar3;
    uVar23 = uVar23 >> 0x1f | uVar23 << 1;
    uVar17 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar26 = ((uVar26 | uVar27) & uVar12 | uVar26 & uVar27) + uVar4 +
             0x8f1bbcdc + uVar28 + (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar22 = uVar22 ^ uVar13 ^ uVar10 ^ uVar4;
    uVar22 = uVar22 >> 0x1f | uVar22 << 1;
    uVar28 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar29 = ((uVar18 | uVar8) & uVar27 | uVar18 & uVar8) + uVar5 + 0x8f1bbcdc +
             uVar12 + (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar19 = uVar19 ^ uVar20 ^ uVar1 ^ uVar5;
    uVar12 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar18 = ((uVar26 | uVar17) & uVar8 | uVar26 & uVar17) + uVar23 +
             0x8f1bbcdc + uVar27 + (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar27 = uVar19 >> 0x1f | uVar19 << 1;
    uVar19 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar13 = uVar13 ^ uVar14 ^ uVar11 ^ uVar23;
    uVar13 = uVar13 >> 0x1f | uVar13 << 1;
    uVar26 = ((uVar29 | uVar28) & uVar17 | uVar29 & uVar28) + uVar22 +
             0x8f1bbcdc + uVar8 + (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar20 = uVar20 ^ uVar21 ^ uVar2 ^ uVar22;
    uVar20 = uVar20 >> 0x1f | uVar20 << 1;
    uVar8 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar17 = ((uVar18 | uVar12) & uVar28 | uVar18 & uVar12) + uVar27 +
             0x8f1bbcdc + uVar17 + (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar18 = (uVar12 ^ uVar19 ^ uVar26) + uVar13 + 0xca62c1d6 + uVar28 +
             (uVar17 >> 0x1b | uVar17 * 0x20);
    uVar28 = uVar14 ^ uVar7 ^ uVar3 ^ uVar27;
    uVar14 = uVar17 >> 2 | uVar17 * 0x40000000;
    uVar28 = uVar28 >> 0x1f | uVar28 << 1;
    uVar26 = (uVar19 ^ uVar8 ^ uVar17) + uVar20 + 0xca62c1d6 + uVar12 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar12 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar21 = uVar21 ^ uVar6 ^ uVar4 ^ uVar13;
    uVar21 = uVar21 >> 0x1f | uVar21 << 1;
    uVar17 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar18 = (uVar8 ^ uVar14 ^ uVar18) + uVar28 + 0xca62c1d6 + uVar19 +
             (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar7 = uVar7 ^ uVar10 ^ uVar5 ^ uVar20;
    uVar7 = uVar7 >> 0x1f | uVar7 << 1;
    uVar6 = uVar6 ^ uVar1 ^ uVar23 ^ uVar28;
    uVar6 = uVar6 >> 0x1f | uVar6 << 1;
    uVar19 = uVar10 ^ uVar11 ^ uVar22 ^ uVar21;
    uVar8 = (uVar14 ^ uVar12 ^ uVar26) + uVar21 + 0xca62c1d6 + uVar8 +
            (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar10 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar19 = uVar19 >> 0x1f | uVar19 << 1;
    uVar18 = (uVar12 ^ uVar17 ^ uVar18) + uVar7 + 0xca62c1d6 + uVar14 +
             (uVar8 >> 0x1b | uVar8 * 0x20);
    uVar14 = uVar8 >> 2 | uVar8 * 0x40000000;
    uVar1 = uVar1 ^ uVar2 ^ uVar27 ^ uVar7;
    uVar1 = uVar1 >> 0x1f | uVar1 << 1;
    uVar26 = (uVar17 ^ uVar10 ^ uVar8) + uVar6 + 0xca62c1d6 + uVar12 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar12 = uVar11 ^ uVar3 ^ uVar13 ^ uVar6;
    uVar11 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar12 = uVar12 >> 0x1f | uVar12 << 1;
    uVar8 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar18 = (uVar10 ^ uVar14 ^ uVar18) + uVar19 + 0xca62c1d6 + uVar17 +
             (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar26 = (uVar14 ^ uVar11 ^ uVar26) + uVar1 + 0xca62c1d6 + uVar10 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar2 = uVar2 ^ uVar4 ^ uVar20 ^ uVar19;
    uVar2 = uVar2 >> 0x1f | uVar2 << 1;
    uVar10 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar3 = uVar3 ^ uVar5 ^ uVar28 ^ uVar1;
    uVar3 = uVar3 >> 0x1f | uVar3 << 1;
    uVar17 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar18 = (uVar11 ^ uVar8 ^ uVar18) + uVar12 + 0xca62c1d6 + uVar14 +
             (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar14 = uVar4 ^ uVar23 ^ uVar21 ^ uVar12;
    uVar29 = (uVar8 ^ uVar10 ^ uVar26) + uVar2 + 0xca62c1d6 + uVar11 +
             (uVar18 >> 0x1b | uVar18 * 0x20);
    uVar11 = uVar18 >> 2 | uVar18 * 0x40000000;
    uVar14 = uVar14 >> 0x1f | uVar14 << 1;
    uVar4 = uVar29 >> 2 | uVar29 * 0x40000000;
    uVar5 = uVar5 ^ uVar22 ^ uVar7 ^ uVar2;
    uVar26 = (uVar10 ^ uVar17 ^ uVar18) + uVar3 + 0xca62c1d6 + uVar8 +
             (uVar29 >> 0x1b | uVar29 * 0x20);
    uVar5 = uVar5 >> 0x1f | uVar5 << 1;
    uVar18 = uVar23 ^ uVar27 ^ uVar6 ^ uVar3;
    uVar8 = (uVar17 ^ uVar11 ^ uVar29) + uVar14 + 0xca62c1d6 + uVar10 +
            (uVar26 >> 0x1b | uVar26 * 0x20);
    uVar23 = uVar26 >> 2 | uVar26 * 0x40000000;
    uVar10 = uVar18 >> 0x1f | uVar18 << 1;
    uVar22 = uVar22 ^ uVar13 ^ uVar19 ^ uVar14;
    uVar17 = (uVar26 ^ uVar11 ^ uVar4) + uVar5 + 0xca62c1d6 + uVar17 +
             (uVar8 >> 0x1b | uVar8 * 0x20);
    uVar22 = uVar22 >> 0x1f | uVar22 << 1;
    uVar19 = uVar8 >> 2 | uVar8 * 0x40000000;
    uVar5 = uVar27 ^ uVar20 ^ uVar1 ^ uVar5;
    uVar1 = uVar17 >> 2 | uVar17 * 0x40000000;
    uVar8 = (uVar4 ^ uVar23 ^ uVar8) + uVar10 + 0xca62c1d6 + uVar11 +
            (uVar17 >> 0x1b | uVar17 * 0x20);
    uVar4 = (uVar17 ^ uVar23 ^ uVar19) + uVar22 + 0xca62c1d6 + uVar4 +
            (uVar8 >> 0x1b | uVar8 * 0x20);
    uVar27 = uVar5 >> 0x1f | uVar5 << 1;
    uVar10 = uVar12 ^ uVar13 ^ uVar28 ^ uVar10;
    uVar11 = uVar8 >> 2 | uVar8 * 0x40000000;
    uVar10 = uVar10 >> 0x1f | uVar10 << 1;
    uVar22 = uVar22 ^ uVar20 ^ uVar21 ^ uVar2;
    uVar12 = (uVar8 ^ uVar19 ^ uVar1) + uVar27 + 0xca62c1d6 + uVar23 +
             (uVar4 >> 0x1b | uVar4 * 0x20);
    uVar23 = uVar4 >> 2 | uVar4 * 0x40000000;
    uVar2 = uVar12 >> 2 | uVar12 * 0x40000000;
    uVar27 = uVar28 ^ uVar7 ^ uVar3 ^ uVar27;
    uVar3 = (uVar1 ^ uVar11 ^ uVar4) + uVar10 + 0xca62c1d6 + uVar19 +
            (uVar12 >> 0x1b | uVar12 * 0x20);
    uVar7 = uVar3 >> 2 | uVar3 * 0x40000000;
    uVar10 = uVar14 ^ uVar21 ^ uVar6 ^ uVar10;
    uVar1 = (uVar22 >> 0x1f | uVar22 << 1) + 0xca62c1d6 + uVar1 +
            (uVar12 ^ uVar11 ^ uVar23) + (uVar3 >> 0x1b | uVar3 * 0x20);
    uVar6 = (uVar27 >> 0x1f | uVar27 << 1) + 0xca62c1d6 + uVar11 +
            (uVar3 ^ uVar23 ^ uVar2) + (uVar1 >> 0x1b | uVar1 * 0x20);
    bVar30 = local_2c == __stack_chk_guard;
    param_1[2] = uVar25 + (uVar1 >> 2 | uVar1 * 0x40000000);
    *param_1 = uVar9 + 0xca62c1d6 + (uVar10 >> 0x1f | uVar10 << 1) + uVar23 +
               (uVar2 ^ uVar7 ^ uVar1) + (uVar6 >> 0x1b | uVar6 * 0x20);
    param_1[1] = uVar16 + uVar6;
    param_1[4] = param_1[4] + uVar2;
    param_1[3] = uVar15 + uVar7;
    if (bVar30) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Removing unreachable block (ram,0x0008823c) */

void FUN_0008819c(undefined4 *param_1)

{
    if (param_1 != (undefined4 *)0x0) {
        *param_1 = 0x67452301;
        param_1[1] = 0xefcdab89;
        param_1[2] = 0x98badcfe;
        param_1[3] = 0x10325476;
        param_1[4] = 0xc3d2e1f0;
        param_1[5] = 0;
        param_1[6] = 0;
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("./../lib/isc/sha1.c", 0x10e, 2, "context != ((void *)0)");
}

/* WARNING: Removing unreachable block (ram,0x00088294) */

void FUN_00088250(void *param_1)

{
    memset(param_1, 0, 0x5c);
    return;
}

void FUN_000882a0(int param_1, void *param_2, uint param_3)

{
    size_t sVar1;
    size_t sVar2;
    int iVar3;
    size_t sVar4;
    void *pvVar5;
    uint uVar6;
    uint uVar7;
    void *__dest;
    bool bVar8;

    iVar3 = __stack_chk_guard;
    if (param_1 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/sha1.c", 0x128, 2, "context != 0");
    }
    if (param_2 != (void *)0x0) {
        uVar6 = *(uint *)(param_1 + 0x14);
        bVar8 = CARRY4(param_3 * 8, uVar6);
        uVar7 = param_3 * 8 + uVar6;
        uVar6 = (uVar6 << 0x17) >> 0x1a;
        *(uint *)(param_1 + 0x14) = uVar7;
        pvVar5 = param_2;
        if (bVar8) {
            uVar7 = param_3 >> 0x1d;
            pvVar5 = *(void **)(param_1 + 0x18);
        }
        if (bVar8) {
            uVar7 = uVar7 + 1;
        }
        __dest = (void *)(param_1 + uVar6 + 0x1c);
        if (bVar8) {
            *(uint *)(param_1 + 0x18) = (int)pvVar5 + uVar7;
        }
        pvVar5 = __dest;
        if (0x3f < param_3 + uVar6) {
            pvVar5 = (void *)(param_1 + 0x1c);
            memcpy(__dest, param_2, 0x40 - uVar6);
            FUN_00086ca4(param_1, pvVar5);
            sVar4 = 0x40 - uVar6;
            sVar2 = -uVar6;
            while (sVar1 = sVar4, sVar2 + 0x7f < param_3) {
                FUN_00086ca4(param_1, (int)param_2 + sVar1);
                sVar4 = sVar1 + 0x40;
                sVar2 = sVar1;
            }
            param_2 = (void *)((int)param_2 + sVar1);
            param_3 = param_3 - sVar1;
        }
        if (iVar3 == __stack_chk_guard) {
            memcpy(pvVar5, param_2, param_3);
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("./../lib/isc/sha1.c", 0x129, 2, "data != 0");
}

void FUN_000883e8(void *param_1, int param_2)

{
    undefined1 *puVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    uint uVar5;
    undefined1 uStack_25;
    undefined1 local_24[8];
    int local_1c;

    local_1c = __stack_chk_guard;
    if (param_2 == 0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/sha1.c", 0x149, 2, "digest != 0");
    }
    if (param_1 == (void *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/sha1.c", 0x14a, 2, "context != 0");
    }
    uVar3 = 0;
    puVar1 = &uStack_25;
    do {
        uVar4 = ~uVar3;
        if (uVar3 < 4) {
            iVar2 = 0x14;
        } else {
            iVar2 = 0x10;
        }
        uVar3 = uVar3 + 1;
        puVar1 = puVar1 + 1;
        *puVar1 =
            (char)(*(uint *)((int)param_1 + iVar2 + 4) >> ((uVar4 & 3) << 3));
    } while (uVar3 != 8);
    FUN_000882a0(param_1, &DAT_000ae23f, 1);
    uVar3 = *(uint *)((int)param_1 + 0x14);
    while ((uVar3 & 0x1f8) != 0x1c0) {
        FUN_000882a0(param_1, &DAT_000ae240, 1);
        uVar3 = *(uint *)((int)param_1 + 0x14);
    }
    FUN_000882a0(param_1, local_24, 8);
    puVar1 = (undefined1 *)(param_2 + -1);
    uVar3 = 0;
    do {
        uVar5 = ~uVar3;
        uVar4 = uVar3 & 0xfffffffc;
        uVar3 = uVar3 + 1;
        puVar1 = puVar1 + 1;
        *puVar1 = (char)(*(uint *)((int)param_1 + uVar4) >> ((uVar5 & 3) << 3));
    } while (uVar3 != 0x14);
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    memset(param_1, 0, 0x5c);
    return;
}

/* WARNING: Removing unreachable block (ram,0x00088608) */

void FUN_00088564(undefined4 param_1, int param_2, int param_3)

{
    if (param_3 != 0) {
        param_3 = param_2 + param_3;
        do {
            param_2 = param_2 + 1;
        } while (param_2 != param_3);
    }
    return;
}

void FUN_00088614(pthread_mutex_t *param_1, undefined4 param_2,
                  undefined4 param_3)

{
    int iVar1;
    int *piVar2;
    undefined1 auStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    iVar1 = pthread_mutex_init(param_1, (pthread_mutexattr_t *)0x0);
    if (iVar1 == 0xc) {
        iVar1 = 1;
    } else if (iVar1 != 0) {
        piVar2 = __errno_location();
        FUN_00085b10(*piVar2, auStack_9c, 0x80);
        FUN_0007f554(param_2, param_3, "isc_mutex_init() failed: %s",
                     auStack_9c);
        iVar1 = 0x22;
    }
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar1);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00088730) */

void FUN_000886b8(int param_1)

{
    undefined1 *puVar1;

    puVar1 = clktypes;
    if ((clktypes._0_4_ != -1) && (param_1 != clktypes._0_4_)) {
        do {
            puVar1 = (undefined1 *)((int)puVar1 + 0xc);
            if (*(int *)puVar1 == -1) {
                return;
            }
        } while (*(int *)puVar1 != param_1);
    }
    return;
}

void FUN_00088740(void)

{
    tm *ptVar1;
    char *__s;
    uint uVar2;
    time_t local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    local_28 = time((time_t *)0x0);
    ptVar1 = localtime(&local_28);
    if (ptVar1 == (tm *)0x0) {
        __s = "-- --- --:--:--";
    } else {
        __s = lib_stringbuf + lib_nextbuf * 0x80;
        uVar2 = lib_nextbuf + 1;
        memset(__s, 0, 0x80);
        lib_nextbuf = uVar2 & 0xf;
        FUN_0007c054(__s, 0x80, "%2d %s %02d:%02d:%02d", ptVar1->tm_mday,
                     *(undefined4 *)(months + ptVar1->tm_mon * 4),
                     ptVar1->tm_hour, ptVar1->tm_min, ptVar1->tm_sec);
    }
    if (local_24 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

void FUN_00088840(time_t param_1)

{
    tm *ptVar1;
    char *__s;
    uint uVar2;
    time_t local_24[2];
    int local_1c;

    local_1c = __stack_chk_guard;
    local_24[0] = param_1;
    ptVar1 = localtime(local_24);
    if (ptVar1 == (tm *)0x0) {
        __s = "--:--:--";
    } else {
        __s = lib_stringbuf + lib_nextbuf * 0x80;
        uVar2 = lib_nextbuf + 1;
        memset(__s, 0, 0x80);
        lib_nextbuf = uVar2 & 0xf;
        FUN_0007c054(__s, 0x80, "%02d:%02d:%02d", ptVar1->tm_hour,
                     ptVar1->tm_min, ptVar1->tm_sec);
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(__s);
}

/* WARNING: Removing unreachable block (ram,0x0008a328) */

void FUN_0008a2b0(undefined4 *param_1)

{
    if (param_1 != (undefined4 *)0x0) {
        *param_1 = 0x4449522a;
        *(undefined1 *)(param_1 + 0x101) = 0;
        param_1[0x141] = 0;
        param_1[0x142] = 0;
        return;
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("./../lib/isc/unix/dir.c", 0x2d, 0, "dir != ((void *)0)");
}

void FUN_0008a33c(int *param_1, char *param_2)

{
    int iVar1;
    size_t sVar2;
    DIR *pDVar3;
    int *piVar4;
    int *__s;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 0x4449522a)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0(
            "./../lib/isc/unix/dir.c", 0x41, 0,
            "(((dir) != ((void *)0)) && (((const isc__magic_t *)(dir))->magic "
            "== (((\'D\') << 24 | (\'I\') << 16 | (\'R\') << 8 | (\'*\')))))");
    }
    if (param_2 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/dir.c", 0x42, 0,
                     "dirname != ((void *)0)");
    }
    sVar2 = strlen(param_2);
    if (sVar2 + 3 < 0x401) {
        __s = param_1 + 1;
        FUN_0007d4dc(__s, param_2, sVar2 + 1);
        sVar2 = strlen((char *)__s);
        piVar4 = (int *)((int)__s + sVar2);
        if ((__s < piVar4) && (*(char *)((int)piVar4 + -1) != '/')) {
            piVar4 = (int *)((int)piVar4 + 1);
            *(undefined1 *)((int)__s + sVar2) = 0x2f;
        }
        *(undefined1 *)piVar4 = 0x2a;
        *(undefined1 *)((int)piVar4 + 1) = 0;
        pDVar3 = opendir(param_2);
        param_1[0x142] = (int)pDVar3;
        if (pDVar3 == (DIR *)0x0) {
            piVar4 = __errno_location();
            if (iVar1 == __stack_chk_guard) {
                FUN_0008a990(*piVar4, "./../lib/isc/unix/dir.c", 0x5d);
                return;
            }
            goto LAB_0008a468;
        }
        piVar4 = (int *)0x0;
    } else {
        piVar4 = (int *)0x13;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
LAB_0008a468:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar4);
}

void FUN_0008a4a4(int *param_1)

{
    int iVar1;
    dirent64 *pdVar2;
    size_t sVar3;
    undefined4 uVar4;
    char *__s;

    iVar1 = __stack_chk_guard;
    if (((param_1 == (int *)0x0) || (*param_1 != 0x4449522a)) ||
        ((DIR *)param_1[0x142] == (DIR *)0x0)) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0(
            "./../lib/isc/unix/dir.c", 0x6e, 0,
            "(((dir) != ((void *)0)) && (((const isc__magic_t *)(dir))->magic "
            "== (((\'D\') << 24 | (\'I\') << 16 | (\'R\') << 8 | (\'*\'))))) "
            "&& dir->handle != ((void *)0)");
    }
    pdVar2 = readdir64((DIR *)param_1[0x142]);
    if (pdVar2 == (dirent64 *)0x0) {
        uVar4 = 0x1d;
    } else {
        __s = pdVar2->d_name;
        sVar3 = strlen(__s);
        if (sVar3 + 1 < 0x101) {
            FUN_0007d4dc(param_1 + 0x101, __s);
            sVar3 = strlen(__s);
            uVar4 = 0;
            param_1[0x141] = sVar3;
        } else {
            uVar4 = 0x22;
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar4);
    }
    return;
}

void FUN_0008a584(int *param_1)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    if (((param_1 != (int *)0x0) && (*param_1 == 0x4449522a)) &&
        ((DIR *)param_1[0x142] != (DIR *)0x0)) {
        closedir((DIR *)param_1[0x142]);
        iVar2 = __stack_chk_guard;
        param_1[0x142] = 0;
        if (iVar1 == iVar2) {
            return;
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("./../lib/isc/unix/dir.c", 0x8e, 0,
                 "(((dir) != ((void *)0)) && (((const isc__magic_t "
                 "*)(dir))->magic == (((\'D\') << 24 | (\'I\') << 16 | (\'R\') "
                 "<< 8 | (\'*\'))))) && dir->handle != ((void *)0)");
}

void FUN_0008a990(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    undefined4 uVar1;
    undefined1 auStack_9c[128];
    int local_1c;

    local_1c = __stack_chk_guard;
    switch (param_1) {
    case 1:
        goto LAB_0008ac28;
    case 2:
        uVar1 = 0x26;
        goto LAB_0008ab98;
    case 3:
        break;
    case 4:
        break;
    case 5:
        uVar1 = 0x1a;
        goto LAB_0008ab98;
    case 6:
        break;
    case 7:
        break;
    case 8:
        break;
    case 9:
        goto LAB_0008ab94;
    case 10:
        break;
    case 0xb:
        break;
    case 0xc:
        uVar1 = 1;
        goto LAB_0008ab98;
    case 0xd:
    LAB_0008ac28:
        uVar1 = 6;
        goto LAB_0008ab98;
    case 0xe:
        break;
    case 0xf:
        break;
    case 0x10:
        break;
    case 0x11:
        uVar1 = 0x27;
        goto LAB_0008ab98;
    case 0x12:
        break;
    case 0x13:
        break;
    case 0x14:
        goto LAB_0008ab94;
    case 0x15:
        break;
    case 0x16:
        goto LAB_0008ab94;
    case 0x17:
        goto LAB_0008abc0;
    case 0x18:
    LAB_0008abc0:
        uVar1 = 0x32;
        goto LAB_0008ab98;
    case 0x19:
        break;
    case 0x1a:
        break;
    case 0x1b:
        break;
    case 0x1c:
        break;
    case 0x1d:
        break;
    case 0x1e:
        break;
    case 0x1f:
        break;
    case 0x20:
        goto LAB_0008abc8;
    case 0x21:
        break;
    case 0x22:
        break;
    case 0x23:
        break;
    case 0x24:
        goto LAB_0008ab94;
    case 0x25:
        break;
    case 0x26:
        break;
    case 0x27:
        break;
    case 0x28:
    LAB_0008ab94:
        uVar1 = 0x1e;
        goto LAB_0008ab98;
    case 0x29:
        break;
    case 0x2a:
        break;
    case 0x2b:
        break;
    case 0x2c:
        break;
    case 0x2d:
        break;
    case 0x2e:
        break;
    case 0x2f:
        break;
    case 0x30:
        break;
    case 0x31:
        break;
    case 0x32:
        break;
    case 0x33:
        break;
    case 0x34:
        break;
    case 0x35:
        break;
    case 0x36:
        break;
    case 0x37:
        break;
    case 0x38:
        break;
    case 0x39:
        break;
    case 0x3a:
        break;
    case 0x3b:
        break;
    case 0x3c:
        break;
    case 0x3d:
        break;
    case 0x3e:
        break;
    case 0x3f:
        break;
    case 0x40:
        break;
    case 0x41:
        break;
    case 0x42:
        break;
    case 0x43:
        break;
    case 0x44:
        break;
    case 0x45:
        break;
    case 0x46:
        break;
    case 0x47:
        break;
    case 0x48:
        break;
    case 0x49:
        break;
    case 0x4a:
        break;
    case 0x4b:
        break;
    case 0x4c:
        break;
    case 0x4d:
        break;
    case 0x4e:
        break;
    case 0x4f:
        break;
    case 0x50:
        break;
    case 0x51:
        break;
    case 0x52:
        break;
    case 0x53:
        break;
    case 0x54:
        break;
    case 0x55:
        break;
    case 0x56:
        break;
    case 0x57:
        break;
    case 0x58:
        break;
    case 0x59:
        break;
    case 0x5a:
        break;
    case 0x5b:
        break;
    case 0x5c:
        break;
    case 0x5d:
        break;
    case 0x5e:
        break;
    case 0x5f:
        break;
    case 0x60:
        break;
    case 0x61:
        uVar1 = 0x30;
        goto LAB_0008ab98;
    case 0x62:
        uVar1 = 5;
        goto LAB_0008ab98;
    case 99:
        uVar1 = 4;
        goto LAB_0008ab98;
    case 100:
        uVar1 = 10;
        goto LAB_0008ab98;
    case 0x65:
        uVar1 = 8;
        goto LAB_0008ab98;
    case 0x66:
        break;
    case 0x67:
        goto LAB_0008abc8;
    case 0x68:
    LAB_0008abc8:
        uVar1 = 0x36;
        goto LAB_0008ab98;
    case 0x69:
        uVar1 = 0xd;
        goto LAB_0008ab98;
    case 0x6a:
        break;
    case 0x6b:
        uVar1 = 0x28;
        goto LAB_0008ab98;
    case 0x6c:
        break;
    case 0x6d:
        break;
    case 0x6e:
        uVar1 = 2;
        goto LAB_0008ab98;
    case 0x6f:
        uVar1 = 0xc;
        goto LAB_0008ab98;
    case 0x70:
        uVar1 = 0xb;
        goto LAB_0008ab98;
    case 0x71:
        uVar1 = 9;
        goto LAB_0008ab98;
    }
    FUN_00085b10(param_1, auStack_9c, 0x80);
    FUN_0007f554(param_2, param_3,
                 "unable to convert errno to isc_result: %d: %s", param_1,
                 auStack_9c);
    uVar1 = 0x22;
LAB_0008ab98:
    if (local_1c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar1);
    }
    return;
}

void FUN_0008b648(char *param_1)

{
    int iVar1;
    int iVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/file.c", 0x140, 0,
                     "filename != ((void *)0)");
    }
    iVar2 = unlink(param_1);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else {
        piVar3 = __errno_location();
        if (iVar1 == __stack_chk_guard) {
            FUN_0008a990(*piVar3, "./../lib/isc/unix/file.c", 0x146);
            return;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008b6f4(char *param_1, char *param_2)

{
    int iVar1;
    int iVar2;
    int *piVar3;

    iVar1 = __stack_chk_guard;
    if (param_1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/unix/file.c", 0x14d, 0,
                     "oldname != ((void *)0)");
    }
    if (param_2 != (char *)0x0) {
        iVar2 = rename(param_1, param_2);
        if (iVar2 == 0) {
            if (iVar1 == __stack_chk_guard) {
                return;
            }
        } else {
            piVar3 = __errno_location();
            if (iVar1 == __stack_chk_guard) {
                FUN_0008a990(*piVar3, "./../lib/isc/unix/file.c", 0x154);
                return;
            }
        }
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Subroutine does not return */
    FUN_0007ecc0("./../lib/isc/unix/file.c", 0x14e, 0,
                 "newname != ((void *)0)");
}

void FUN_0008c0c8(void)

{
    int iVar1;
    int iVar2;

    iVar1 = __stack_chk_guard;
    iVar2 = pthread_once((pthread_once_t *)&DAT_001172bc,
                         (__init_routine *)&DAT_0008c06c);
    if (iVar2 == 0) {
        if (iVar1 == __stack_chk_guard) {
            return;
        }
    } else if (iVar1 == __stack_chk_guard) {
        FUN_0007f61c(
            "./../lib/isc/random.c", 0x3c,
            "((pthread_once((&once), (initialize_rand)) == 0) ? 0 : 34) == 0");
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008c1b4(uint *param_1)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    bool bVar4;

    iVar1 = __stack_chk_guard;
    if (param_1 == (uint *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0007ecc0("./../lib/isc/random.c", 0x4e, 0, "val != ((void *)0)");
    }
    FUN_0008c0c8();
    iVar2 = rand();
    uVar3 = rand();
    bVar4 = iVar1 == __stack_chk_guard;
    *param_1 = (uint)(iVar2 << 0xc) >> 0x10 | (uVar3 & 0xffff0) << 0xc;
    if (bVar4) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008c2f0(int param_1, ushort *param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    uVar4 = *(uint *)(param_2 + 8) & 0xfffff00 | 8;
    *(uint *)(param_2 + 8) = uVar4;
    if (*(code **)(param_2 + 0x14) != (code *)0x0) {
        (**(code **)(param_2 + 0x14))();
        uVar4 = *(uint *)(param_2 + 8);
    }
    iVar2 = __stack_chk_guard;
    iVar5 = *(int *)(param_1 + 0x78);
    *(undefined4 *)(param_2 + 0xc) =
        *(undefined4 *)(*(int *)(param_1 + 0x74) + (uint)*param_2 * 4);
    uVar3 = *(undefined4 *)(iVar5 + (uint)*param_2 * 4);
    *(uint *)(param_2 + 8) = uVar4 & 0xfffff00;
    *(undefined4 *)(param_2 + 0xe) = uVar3;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void optionNumericVal(uint param_1, int param_2)

{
    byte bVar1;
    int *piVar2;
    int iVar3;
    byte *pbVar4;
    byte *local_28;
    int local_24;

    local_24 = __stack_chk_guard;
    if (((param_2 == 0 || param_1 < 0x10) ||
         ((*(uint *)(param_2 + 0x10) & 8) != 0)) ||
        (*(int *)(param_2 + 0x18) == 0))
        goto LAB_0008c528;
    piVar2 = __errno_location();
    *piVar2 = 0;
    iVar3 = strtol(*(char **)(param_2 + 0x18), (char **)&local_28, 0);
    pbVar4 = local_28;
    if ((*(byte **)(param_2 + 0x18) == local_28) || (*piVar2 != 0))
        goto LAB_0008c5e4;
    if ((*(uint *)(param_2 + 0x10) & 0x1000000) == 0) {
    LAB_0008c5d8:
        pbVar4 = local_28;
        if (*local_28 == 0) {
            if ((*(uint *)(param_2 + 0x10) & 0x40) != 0) {
                free(*(byte **)(param_2 + 0x18));
                *(uint *)(param_2 + 0x10) =
                    *(uint *)(param_2 + 0x10) & 0xffffffbf;
            }
            *(int *)(param_2 + 0x18) = iVar3;
            goto LAB_0008c528;
        }
    } else {
        pbVar4 = local_28 + 1;
        bVar1 = *local_28;
        if (bVar1 == 0x54) {
            iVar3 = 0;
        LAB_0008c6a4:
            iVar3 = iVar3 << 10;
        LAB_0008c5cc:
            iVar3 = iVar3 << 10;
        LAB_0008c5d0:
            iVar3 = iVar3 << 10;
            local_28 = pbVar4;
            goto LAB_0008c5d8;
        }
        if (bVar1 < 0x55) {
            if (bVar1 == 0x47)
                goto LAB_0008c6a4;
            if (bVar1 < 0x48) {
                if (bVar1 == 0)
                    goto LAB_0008c5d8;
                goto LAB_0008c5e4;
            }
            if (bVar1 != 0x4b) {
                if (bVar1 != 0x4d)
                    goto LAB_0008c5e4;
                goto LAB_0008c5cc;
            }
            goto LAB_0008c5d0;
        }
        if (bVar1 == 0x6b) {
        LAB_0008c678:
            iVar3 = iVar3 * 1000;
            local_28 = pbVar4;
            goto LAB_0008c5d8;
        }
        if (bVar1 < 0x6c) {
            if (bVar1 == 0x67) {
            LAB_0008c668:
                iVar3 = iVar3 * 1000;
                goto LAB_0008c670;
            }
        } else {
            if (bVar1 == 0x6d) {
            LAB_0008c670:
                iVar3 = iVar3 * 1000;
                goto LAB_0008c678;
            }
            if (bVar1 == 0x74) {
                iVar3 = iVar3 * 1000;
                goto LAB_0008c668;
            }
        }
    }
LAB_0008c5e4:
    local_28 = pbVar4;
    fprintf(stderr, (char *)option_xlateable_txt._204_4_,
            *(undefined4 *)(param_1 + 0x1c));
    if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
        (**(code **)(param_1 + 0x54))(param_1, 1);
    }
    *piVar2 = 0x16;
    *(undefined4 *)(param_2 + 0x18) = 0xffffffff;
LAB_0008c528:
    if (local_24 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0008c6dc(FILE *param_1, char *param_2, char *param_3, char *param_4)

{
    int iVar1;
    char *pcVar2;

    iVar1 = __stack_chk_guard;
    if (((param_2 == (char *)0x0) &&
         (param_2 = param_3, param_3 == (char *)0x0)) &&
        (param_2 = param_4, param_4 == (char *)0x0)) {
        return;
    }
    pcVar2 = strchr(param_2, 10);
    if (pcVar2 == (char *)0x0) {
        fputs(param_2, param_1);
    } else {
        fwrite(param_2, 1, (int)pcVar2 - (int)param_2, param_1);
    }
    if (iVar1 == __stack_chk_guard) {
        fputc(10, param_1);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008c7a4(FILE *param_1, int param_2, char *param_3)

{
    int iVar1;
    size_t sVar2;
    char *pcVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    if (((*(uint *)(param_2 + 0x10) & 0x20) == 0) ||
        (*(short *)(param_2 + 8) != -0x8000)) {
        pcVar3 = *(char **)(param_2 + 0x34);
    } else {
        pcVar3 = *(char **)(param_2 + 0x38);
    }
    sVar2 = strlen(pcVar3);
    fputs(pcVar3, param_1);
    if ((param_3 != (char *)0x0) ||
        ((uint)(*(int *)(param_2 + 0x10) << 0x10) >> 0x1c == 5)) {
        iVar4 = -sVar2 + 0x10;
        fwrite(&DAT_000b2884, 1, 3, param_1);
        if (0 < (int)(-sVar2 + 0x11)) {
            do {
                iVar4 = iVar4 + -1;
                fputc(0x20, param_1);
            } while (iVar4 != -1);
        }
        if ((uint)(*(int *)(param_2 + 0x10) << 0x10) >> 0x1c == 5) {
            fprintf(param_1, "%d", param_3);
        } else {
            while (pcVar3 = strchr(param_3, 10), pcVar3 != (char *)0x0) {
                fwrite(param_3, (int)pcVar3 - (int)param_3, 1, param_1);
                param_3 = pcVar3 + 1;
                fwrite(&DAT_000b2888, 1, 2, param_1);
            }
            fputs(param_3, param_1);
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    fputc(10, param_1);
    return;
}

void FUN_0008c924(uint param_1, int param_2, undefined4 *param_3, int param_4)

{
    char cVar1;
    uint uVar2;
    char *__s;
    size_t sVar3;
    uint uVar4;
    int iVar5;
    undefined4 uVar6;
    undefined4 *puVar7;
    char *pcVar8;
    int iVar9;
    int iVar10;
    uint uVar11;
    uint uVar12;
    int local_60;
    int local_5c;
    char acStack_3c[16];
    int local_2c;

    uVar6 = *(undefined4 *)(param_2 + 0x34);
    local_2c = __stack_chk_guard;
    if (0xf < param_1) {
        fprintf(option_usage_fp, DAT_001172c0, *(undefined4 *)(param_1 + 0x1c),
                *(undefined4 *)(param_2 + 0x18), uVar6);
        uVar6 = *(undefined4 *)(param_2 + 0x34);
    }
    uVar11 = 0;
    uVar12 = 0;
    local_5c = param_4 + -1;
    fprintf(option_usage_fp, (char *)option_xlateable_txt._424_4_, uVar6);
    pcVar8 = (char *)*param_3;
    cVar1 = *pcVar8;
    local_60 = param_4;
    if (cVar1 == '\x7f') {
        pcVar8 = (char *)param_3[1];
        param_3 = param_3 + 1;
        local_60 = local_5c;
        local_5c = param_4 + -2;
    }
    uVar2 = (uint)(cVar1 == '\x7f');
    __s = pcVar8;
    puVar7 = param_3;
    iVar9 = local_60;
    while (true) {
        sVar3 = strlen(__s);
        uVar4 = sVar3 + 1;
        iVar9 = iVar9 + -1;
        uVar11 = uVar11 + uVar4;
        if (uVar12 < uVar4) {
            uVar12 = uVar4;
        }
        if (iVar9 < 1)
            break;
        puVar7 = puVar7 + 1;
        __s = (char *)*puVar7;
    }
    iVar9 = local_60;
    if (uVar12 < 0x24) {
        if (uVar11 < 0x4c) {
            fputc(0x20, option_usage_fp);
            do {
                fputc(0x20, option_usage_fp);
                iVar9 = iVar9 + -1;
                fputs((char *)*param_3, option_usage_fp);
                param_3 = param_3 + 1;
            } while (0 < iVar9);
            fputc(10, option_usage_fp);
        } else {
            param_3 = param_3 + -1;
            iVar10 = 0;
            sprintf(acStack_3c, "%%-%ds", uVar12);
            iVar5 = FUN_0009b690(0x4e, uVar12);
            fwrite(&DAT_000afed2, 1, 2, option_usage_fp);
            while (true) {
                iVar9 = iVar9 + -1;
                param_3 = param_3 + 1;
                if (iVar9 < 1)
                    break;
                iVar10 = iVar10 + 1;
                pcVar8 = acStack_3c;
                if (iVar5 == iVar10) {
                    iVar10 = 0;
                    pcVar8 = "%s\n  ";
                }
                fprintf(option_usage_fp, pcVar8, *param_3);
            }
            fprintf(option_usage_fp, "%s\n", *param_3);
        }
    } else {
        while (true) {
            fprintf(option_usage_fp, "  %s\n", pcVar8);
            if (iVar9 + -1 < 1)
                break;
            param_3 = param_3 + 1;
            pcVar8 = (char *)*param_3;
            iVar9 = iVar9 + -1;
        }
    }
    if (0xf < param_1) {
        fprintf(option_usage_fp, (char *)option_xlateable_txt._132_4_, uVar2,
                uVar2 + local_5c);
        (**(code **)(param_1 + 0x54))(param_1, 1);
    }
    if ((uint)(*(int *)(param_2 + 0x10) << 0x10) >> 0x1c == 4) {
        fprintf(option_usage_fp, (char *)option_xlateable_txt._296_4_,
                local_60);
        fputs((char *)option_xlateable_txt._416_4_, option_usage_fp);
    } else {
        fprintf(option_usage_fp, (char *)option_xlateable_txt._132_4_, uVar2,
                uVar2 + local_5c);
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0008cc34(byte *param_1, undefined4 param_2, undefined4 param_3,
                  int param_4, uint param_5)

{
    size_t __n;
    int iVar1;
    ulong uVar2;
    uint uVar3;
    ulong uVar4;
    char *__s1;
    undefined4 *puVar5;
    char *local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    __n = strlen((char *)param_1);
    uVar3 = (uint)*param_1;
    if (uVar3 < 0x80) {
        if ((*(uint *)(&DAT_000af184 + uVar3 * 4) & 0x30000) != 0) {
            uVar2 = strtoul((char *)param_1, &local_30, 0);
            if (*local_30 != '\0' || param_5 <= uVar2) {
                DAT_001172c0 = option_xlateable_txt._208_4_;
                option_usage_fp = stderr;
                FUN_0008c924(param_2, param_3, param_4, param_5);
                uVar2 = param_5;
            }
            goto LAB_0008cd54;
        }
        if (((*(uint *)(&DAT_000af184 + uVar3 * 4) & 0x8000) == 0) ||
            (param_1[2] != 0))
            goto LAB_0008cca8;
        if (uVar3 == 0x7e) {
            if (param_1[1] == 0x30)
                goto LAB_0008ce20;
        } else if ((uVar3 == 0x2d) && (param_1[1] == 0x31)) {
        LAB_0008ce20:
            uVar2 = param_5 - 1;
            goto LAB_0008cd54;
        }
    LAB_0008ce04:
        DAT_001172c0 = option_xlateable_txt._168_4_;
    } else {
    LAB_0008cca8:
        if (param_5 == 0)
            goto LAB_0008ce04;
        uVar4 = 0;
        puVar5 = (undefined4 *)(param_4 + -4);
        uVar3 = param_5;
        do {
            puVar5 = puVar5 + 1;
            __s1 = (char *)*puVar5;
            iVar1 = strncmp(__s1, (char *)param_1, __n);
            uVar2 = uVar3;
            if (iVar1 == 0) {
                uVar2 = uVar4;
                if (__s1[__n] == '\0')
                    goto LAB_0008cd54;
                if (param_5 != uVar3) {
                    uVar2 = 0xffffffff;
                }
            }
            uVar4 = uVar4 + 1;
            uVar3 = uVar2;
        } while (param_5 != uVar4);
        if (uVar2 < param_5)
            goto LAB_0008cd54;
        DAT_001172c0 = option_xlateable_txt._76_4_;
        if (uVar2 == param_5)
            goto LAB_0008ce04;
    }
    option_usage_fp = stderr;
    FUN_0008c924(param_2, param_3, param_4, param_5);
    uVar2 = param_5;
LAB_0008cd54:
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0008ce5c(int param_1)

{
    if (DAT_001172c4 != '\0') {
        printf("\nexit %d\n", param_1);
    }
    /* WARNING: Subroutine does not return */
    exit(param_1);
}

void FUN_0008cec0(undefined4 param_1)

{
    fprintf(stderr, (char *)option_xlateable_txt._48_4_, param_1);
    /* WARNING: Subroutine does not return */
    FUN_0008ce5c(0x46);
}

void FUN_0008cf18(undefined4 param_1, undefined4 param_2, undefined4 param_3)

{
    undefined4 __format;
    FILE *__stream;
    int *piVar1;
    char *pcVar2;
    int __errnum;

    __stream = stderr;
    __format = option_xlateable_txt._96_4_;
    piVar1 = __errno_location();
    __errnum = *piVar1;
    pcVar2 = strerror(__errnum);
    fprintf(__stream, (char *)__format, param_1, __errnum, pcVar2, param_2,
            param_3);
    /* WARNING: Subroutine does not return */
    FUN_0008ce5c(1);
}

void FUN_0008cfa4(FILE *param_1, int param_2, int param_3, int *param_4)

{
    int iVar1;
    undefined *puVar2;
    char *pcVar3;
    int iVar4;
    byte *pbVar5;
    int iVar6;
    int *piVar7;
    uint __c;
    undefined4 uVar8;
    undefined4 uVar9;

    iVar1 = __stack_chk_guard;
    param_2 = param_2 + -1;
    if (-1 < param_2) {
        do {
            _IO_putc(0x20, param_1);
            param_2 = param_2 + -1;
            _IO_putc(0x20, param_1);
        } while (param_2 != -1);
    }
    iVar6 = param_4[1];
    switch (*param_4) {
    case 1:
        pbVar5 = (byte *)((int)param_4 + 7);
        fprintf(param_1, "<%s>", iVar6);
    LAB_0008d208:
        pbVar5 = pbVar5 + 1;
        __c = (uint)*pbVar5;
        if (__c == 0x26) {
        LAB_0008d318:
            _IO_putc(0x26, param_1);
            puVar2 = &UNK_000af384;
            if (__c != 0x26) {
                if (__c == 0x3c) {
                    puVar2 = &UNK_000af394;
                } else {
                    puVar2 = &DAT_000af3a4;
                    if (__c != 0x3e) {
                        if (__c == 0x22) {
                            puVar2 = &UNK_000af3b4;
                        } else {
                            if (__c != 0x27) {
                                fprintf(param_1, "#x%02X;", __c);
                                goto LAB_0008d208;
                            }
                            puVar2 = &UNK_000af3c4;
                        }
                    }
                }
            }
            fputs(puVar2 + 8, param_1);
            goto LAB_0008d208;
        }
        if (0x26 < __c) {
            if (__c == 0x3e)
                goto LAB_0008d318;
            if (0x3e < __c) {
                if (__c < 0x7f)
                    goto LAB_0008d300;
                goto LAB_0008d318;
            }
            if (__c == 0x3c)
                goto LAB_0008d318;
        LAB_0008d300:
            _IO_putc(__c, param_1);
            goto LAB_0008d208;
        }
        if (__c != 0) {
            if (0x1f < __c)
                goto LAB_0008d300;
            goto LAB_0008d318;
        }
        if (iVar1 != __stack_chk_guard)
            goto LAB_0008d240;
        pcVar3 = "</%s>\n";
        goto LAB_0008d088;
    case 2:
        break;
    case 3:
        if (param_4[2] == 0) {
            pcVar3 = "false";
        } else {
            pcVar3 = "true";
        }
        if (iVar1 == __stack_chk_guard) {
            fprintf(param_1, "<%1$s type=boolean>%2$s</%1$s>\n", iVar6, pcVar3);
            return;
        }
        goto LAB_0008d240;
    case 4:
        break;
    case 5:
        goto LAB_0008d028;
    case 6:
        piVar7 = (int *)param_4[2];
        if (piVar7 == (int *)0x0) {
            if (iVar1 == __stack_chk_guard) {
                return;
            }
            goto LAB_0008d240;
        }
        if (0 < *piVar7) {
            iVar4 = *piVar7 + -1;
            fprintf(param_1, "<%s type=nested>\n", iVar6);
            DAT_000c8164 = DAT_000c8164 + 1;
            piVar7 = piVar7 + 2;
            do {
                iVar4 = iVar4 + -1;
                FUN_0008cfa4(param_1, DAT_000c8164, 0, *piVar7);
                piVar7 = piVar7 + 1;
            } while (iVar4 != -1);
            iVar4 = DAT_000c8164 + -2;
            DAT_000c8164 = DAT_000c8164 + -1;
            if (-1 < iVar4) {
                do {
                    _IO_putc(0x20, param_1);
                    iVar4 = iVar4 + -1;
                    _IO_putc(0x20, param_1);
                } while (iVar4 != -1);
            }
            if (iVar1 == __stack_chk_guard) {
                pcVar3 = "</%s>\n";
                goto LAB_0008d088;
            }
            goto LAB_0008d240;
        }
    default:
        if (iVar1 == __stack_chk_guard) {
            pcVar3 = "<%s/>\n";
        LAB_0008d088:
            fprintf(param_1, pcVar3, iVar6);
            return;
        }
        goto LAB_0008d240;
    }
    if (param_3 == 0) {
    LAB_0008d028:
        if (iVar1 == __stack_chk_guard) {
            fprintf(param_1, "<%1$s type=integer>0x%2$lX</%1$s>\n", iVar6,
                    param_4[2]);
            return;
        }
    } else {
        uVar8 = *(undefined4 *)(param_3 + 0x10);
        uVar9 = *(undefined4 *)(param_3 + 0x18);
        if (*param_4 == 2) {
            pcVar3 = "keyword";
        } else {
            pcVar3 = "set-membership";
        }
        fprintf(param_1, "<%s type=%s>", iVar6, pcVar3);
        (**(code **)(param_3 + 0x28))(3, param_3);
        if ((*(char **)(param_3 + 0x18) != (char *)0x0) &&
            (fputs(*(char **)(param_3 + 0x18), param_1), *param_4 != 2)) {
            free(*(void **)(param_3 + 0x18));
        }
        iVar6 = __stack_chk_guard;
        *(undefined4 *)(param_3 + 0x18) = uVar9;
        *(undefined4 *)(param_3 + 0x10) = uVar8;
        if (iVar1 == iVar6) {
            fprintf(param_1, "</%s>\n", param_4[1]);
            return;
        }
    }
LAB_0008d240:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008d420(uint param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 uVar2;

    iVar1 = __stack_chk_guard;
    param_1 = param_1 & 3;
    *param_2 = option_xlateable_txt._324_4_;
    DAT_001172d0 = option_xlateable_txt._12_4_;
    DAT_001172c8 = option_xlateable_txt._16_4_;
    DAT_001172d8 = option_xlateable_txt._8_4_;
    DAT_001172cc = &DAT_000af3d4;
    DAT_001172ec = &DAT_000af3d4;
    DAT_001172e0 = option_xlateable_txt._4_4_;
    DAT_001172dc = &DAT_000afe0d;
    DAT_00117300 = &DAT_000afe2a;
    DAT_001172d4 = "=file";
    DAT_001172e4 = &DAT_000afe12;
    DAT_001172e8 = "[=arg]";
    DAT_001172f0 = &DAT_000afe01;
    DAT_001172f4 = &DAT_000afec1;
    DAT_001172f8 = &DAT_000afece;
    if (param_1 == 2) {
        DAT_001172fc = &DAT_000afe68;
        uVar2 = 8;
        DAT_001172d4 = "=file";
        DAT_001172dc = &DAT_000afe0d;
        DAT_001172e4 = &DAT_000afe12;
        DAT_001172f0 = &DAT_000afe01;
        DAT_001172f4 = &DAT_000afec1;
        DAT_001172f8 = &DAT_000afece;
        DAT_00117300 = &DAT_000afe2a;
        *(undefined1 *)option_xlateable_txt._4_4_ = 0x20;
        *(undefined1 *)option_xlateable_txt._8_4_ = 0x20;
        *(undefined1 *)option_xlateable_txt._12_4_ = 0x20;
        *(undefined1 *)option_xlateable_txt._16_4_ = 0x20;
        DAT_001172e8 = " [arg]";
    } else if ((param_1 == 3) || (param_1 == 1)) {
        DAT_001172fc = &DAT_000afe1f;
        uVar2 = 0x16;
    } else {
        DAT_001172fc = &DAT_000afe21;
        uVar2 = 0x16;
        DAT_001172d4 = "=file";
        DAT_001172dc = &DAT_000afe0d;
        DAT_001172e4 = &DAT_000afe12;
        DAT_001172e8 = "[=arg]";
        DAT_001172f0 = &DAT_000afe01;
        DAT_001172f4 = &DAT_000afec1;
        DAT_001172f8 = &DAT_000afece;
        DAT_00117300 = &DAT_000afe2a;
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0008d588(uint param_1, undefined4 *param_2)

{
    int iVar1;
    undefined4 uVar2;

    iVar1 = __stack_chk_guard;
    DAT_001172c8 = &DAT_000afe97;
    DAT_001172cc = &DAT_000afe93;
    DAT_001172d0 = &DAT_000afe8b;
    DAT_001172d8 = &DAT_000afe7b;
    DAT_001172dc = &DAT_000afe7f;
    DAT_00117300 = &DAT_000afe9b;
    DAT_001172d4 = &DAT_000afe77;
    DAT_001172e0 = &DAT_000afe6b;
    DAT_001172e4 = &DAT_000afe83;
    DAT_001172e8 = &DAT_000afe8f;
    DAT_001172ec = &DAT_000afe87;
    DAT_001172f0 = &DAT_000afe6f;
    DAT_001172f4 = &DAT_000afec8;
    DAT_001172f8 = &DAT_000afed2;
    switch (param_1 & 0x12) {
    case 0:
        uVar2 = 0x18;
        *param_2 = option_xlateable_txt._408_4_;
        DAT_001172fc = " %3s %-14s %s";
        goto LAB_0008d6a8;
    case 2:
        uVar2 = 0x18;
        *param_2 = option_xlateable_txt._412_4_;
        DAT_001172fc = " %3s %-14s %s";
        goto LAB_0008d6a8;
    case 4:
        break;
    case 6:
        break;
    case 8:
        break;
    case 10:
        break;
    case 0xc:
        break;
    case 0xe:
        break;
    case 0x10:
        uVar2 = 0x13;
        *param_2 = option_xlateable_txt._320_4_;
        DAT_001172fc = (char *)option_xlateable_txt._328_4_;
        goto LAB_0008d6a8;
    case 0x12:
        uVar2 = 0x13;
        *param_2 = option_xlateable_txt._324_4_;
        DAT_001172fc = (char *)option_xlateable_txt._328_4_;
        goto LAB_0008d6a8;
    }
    uVar2 = 0;
LAB_0008d6a8:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar2);
    }
    return;
}

void FUN_0008db8c(int param_1, int param_2)

{
    int iVar1;
    undefined *puVar2;

    iVar1 = __stack_chk_guard;
    puVar2 = (undefined *)option_xlateable_txt._116_4_;
    if (*(short *)(param_2 + 8) == -0x8000) {
        puVar2 = &DAT_000af3d8;
    }
    fprintf(stderr, (char *)option_xlateable_txt._272_4_,
            *(undefined4 *)(param_1 + 0x1c));
    if (*(ushort *)(param_2 + 0xc) < 2) {
        fprintf(stderr, (char *)option_xlateable_txt._216_4_,
                *(undefined4 *)(param_2 + 0x34), puVar2);
    } else {
        fprintf(stderr, (char *)option_xlateable_txt._92_4_,
                (uint) * (ushort *)(param_2 + 0xc),
                *(undefined4 *)(param_2 + 0x34), puVar2);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    /* WARNING: Could not recover jumptable at 0x0008dc28. Too many branches */
    /* WARNING: Treating indirect jump as call */
    (**(code **)(param_1 + 0x54))(param_1, 1);
    return;
}

void FUN_0008dc70(int param_1, undefined4 *param_2)

{
    ushort uVar1;
    int iVar2;
    uint uVar3;
    uint uVar4;
    ushort *puVar5;
    uint uVar6;
    ushort *puVar7;
    code *pcVar8;
    uint uVar9;
    undefined4 uVar10;

    iVar2 = __stack_chk_guard;
    puVar7 = (ushort *)*param_2;
    uVar6 = *(uint *)(puVar7 + 8);
    pcVar8 = *(code **)(puVar7 + 0x14);
    if ((uVar6 & 0x40) != 0) {
        free(*(void **)(puVar7 + 0xc));
        uVar6 = *(uint *)(puVar7 + 8);
    }
    uVar3 = *(uint *)(param_1 + 0xc);
    uVar10 = param_2[1];
    *(undefined4 *)(puVar7 + 0xc) = uVar10;
    if (((uVar3 & 0x80000) == 0) || ((uVar6 & 0x100) == 0)) {
        uVar1 = *puVar7;
        uVar4 = (uint)uVar1;
        if (puVar7[4] == 0x8000) {
            uVar9 = param_2[2];
            puVar7[2] = uVar1;
            puVar7[3] = puVar7[1];
        } else {
            puVar5 =
                (ushort *)(*(int *)(param_1 + 0x44) + (uint)puVar7[4] * 0x40);
            if ((uVar6 & 4) == 0) {
                uVar9 = param_2[2];
                if (uVar4 != 0x8000) {
                    uVar6 = (uint)puVar7[1];
                }
                puVar5[2] = 0x8000;
                if (uVar4 != 0x8000) {
                    uVar9 = uVar9 | 0x10;
                    puVar5[2] = uVar1;
                    puVar5[3] = (ushort)uVar6;
                    param_2[2] = uVar9;
                }
            } else {
                if (puVar5[2] != uVar4) {
                    fprintf(stderr, (char *)option_xlateable_txt._148_4_,
                            *(undefined4 *)(puVar5 + 0x1a),
                            *(undefined4 *)(puVar7 + 0x1a),
                            *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                            (uint)puVar5[2] * 0x40 + 0x34));
                    uVar10 = 0xffffffff;
                    goto LAB_0008dd74;
                }
                uVar9 = param_2[2];
            }
            uVar6 = *(uint *)(puVar5 + 8);
            *(undefined4 *)(puVar5 + 0xc) = uVar10;
            puVar7 = puVar5;
        }
        *(uint *)(puVar7 + 8) = uVar6 & 0xfffff00 | uVar9 & 0xf00000ff;
        if (((uVar9 & 4) == 0) || (uVar1 = puVar7[7], puVar7[7] = uVar1 + 1,
                                   (ushort)(uVar1 + 1) <= puVar7[6])) {
            if (pcVar8 == (code *)0x0) {
                uVar10 = 0;
            } else {
                (*pcVar8)(param_1, puVar7);
                uVar10 = 0;
            }
        } else if ((uVar3 & 4) == 0) {
            uVar10 = 0xffffffff;
        } else {
            FUN_0008db8c(param_1, puVar7);
            uVar10 = 0xffffffff;
        }
    } else {
        uVar10 = 1;
    }
LAB_0008dd74:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar10);
    }
    return;
}

void FUN_0008de38(char *param_1)

{
    char cVar1;
    int iVar2;
    char *pcVar3;

    iVar2 = __stack_chk_guard;
    if ((param_1 == (char *)0x0) || (*param_1 == '\0')) {
        fwrite(&DAT_000afee9, 1, 2, stdout);
        return;
    }
    if (*param_1 == '\'') {
        do {
            fwrite(&DAT_000b000e, 1, 2, stdout);
            param_1 = param_1 + 1;
        } while (*param_1 == '\'');
        if (*param_1 == '\0') {
        LAB_0008deb4:
            if (iVar2 == __stack_chk_guard) {
                return;
            }
            goto LAB_0008dfdc;
        }
    }
    fputc(0x27, stdout);
    while (pcVar3 = strchr(param_1, 0x27), pcVar3 != (char *)0x0) {
        fwrite(param_1, (int)pcVar3 - (int)param_1, 1, stdout);
        fputc(0x27, stdout);
        cVar1 = *pcVar3;
        param_1 = pcVar3;
        while (cVar1 == '\'') {
            fwrite(&DAT_000b000e, 1, 2, stdout);
            param_1 = param_1 + 1;
            cVar1 = *param_1;
        }
        if (cVar1 == '\0')
            goto LAB_0008deb4;
        fputc(0x27, stdout);
    }
    fputs(param_1, stdout);
    if (iVar2 == __stack_chk_guard) {
        fputc(0x27, stdout);
        return;
    }
LAB_0008dfdc:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008dff0(int param_1, uint param_2, int *param_3, undefined4 *param_4)

{
    int iVar1;
    undefined4 uVar2;
    uint uVar3;
    int iVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    iVar5 = *(int *)(param_1 + 100);
    iVar4 = *(int *)(param_1 + 0x44);
    do {
        if (*(ushort *)(iVar4 + 2) == param_2) {
            if ((*(uint *)(iVar4 + 0x10) & 0x280000) == 0) {
                *param_3 = iVar4;
                *param_4 = 1;
                uVar2 = 0;
                goto LAB_0008e0b8;
            }
            uVar3 = *(uint *)(param_1 + 0xc) & 4;
            if ((*(uint *)(iVar4 + 0x10) != 0x80100) ||
                (*(int *)(iVar4 + 0x34) == 0))
                goto LAB_0008e0ac;
            if (uVar3 == 0)
                goto LAB_0008e0b4;
            fprintf(stderr, (char *)option_xlateable_txt._112_4_,
                    *(undefined4 *)(param_1 + 0x18));
            if (*(int *)(iVar4 + 0x2c) != 0) {
                fprintf(stderr, " -- %s");
            }
            fputc(10, stderr);
            goto LAB_0008e17c;
        }
        iVar5 = iVar5 + -1;
        iVar4 = iVar4 + 0x40;
    } while (0 < iVar5);
    if (((param_2 < 0x80) &&
         ((*(uint *)(&DAT_000af184 + param_2 * 4) & 0x30000) != 0)) &&
        (*(ushort *)(param_1 + 0x60) != 0x8000)) {
        iVar4 = *(int *)(param_1 + 0x14);
        *param_3 = *(int *)(param_1 + 0x44) +
                   (uint) * (ushort *)(param_1 + 0x60) * 0x40;
        uVar2 = 0;
        *(int *)(param_1 + 0x14) = iVar4 + -1;
        *param_4 = 1;
    } else {
        uVar3 = *(uint *)(param_1 + 0xc) & 4;
    LAB_0008e0ac:
        if (uVar3 != 0) {
            fprintf(stderr, (char *)option_xlateable_txt._120_4_,
                    *(undefined4 *)(param_1 + 0x18), param_2);
        LAB_0008e17c:
            (**(code **)(param_1 + 0x54))(param_1, 1);
            /* WARNING: Subroutine does not return */
            _exit(1);
        }
    LAB_0008e0b4:
        uVar2 = 0xffffffff;
    }
LAB_0008e0b8:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_0008e1ac(uint *param_1, ushort *param_2, undefined4 *param_3,
                  undefined4 *param_4)

{
    ushort uVar1;
    int iVar2;
    char *__s;

    iVar2 = __stack_chk_guard;
    if ((*param_1 & 2) == 0) {
        __s = (char *)*param_4;
    LAB_0008e234:
        fputs(__s, option_usage_fp);
        return;
    }
    uVar1 = *param_2;
    if (((uVar1 & 0x80) == 0) &&
        ((*(uint *)(&DAT_000af184 + (uVar1 & 0xff) * 4) & 0x4000) != 0)) {
        fprintf(option_usage_fp, "   -%c", (uint)uVar1);
        if ((~*param_1 & 0x1001) == 0) {
            if (iVar2 == __stack_chk_guard) {
                fwrite(&DAT_000abe84, 1, 2, option_usage_fp);
                return;
            }
        } else if (iVar2 == __stack_chk_guard) {
            return;
        }
    } else {
        if ((~*param_1 & 0x1001) == 0) {
            fputc(0x20, option_usage_fp);
        }
        if (iVar2 == __stack_chk_guard) {
            __s = (char *)*param_3;
            goto LAB_0008e234;
        }
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008e2f8(int param_1)

{
    int iVar1;
    void *pvVar2;
    undefined1 *puVar3;
    undefined1 *puVar4;
    uint *puVar5;
    uint uVar6;
    bool bVar7;

    iVar1 = __stack_chk_guard;
    uVar6 = *(uint *)(&DAT_000af3dc + param_1 * 4);
    pvVar2 = calloc(0x100, 1);
    if (pvVar2 == (void *)0x0) {
        fwrite("no memory for char-mapper span map\n", 1, 0x23, stderr);
        /* WARNING: Subroutine does not return */
        exit(1);
    }
    puVar5 = (uint *)&UNK_000af188;
    puVar3 = (undefined1 *)((int)pvVar2 + 2);
    while (puVar4 = puVar3, puVar5 != (uint *)&UNK_000af380) {
        puVar5 = puVar5 + 1;
        puVar3 = puVar4 + 1;
        if ((uVar6 & *puVar5) != 0) {
            *puVar4 = 1;
        }
    }
    bVar7 = iVar1 != __stack_chk_guard;
    *(void **)(&DAT_00117304 + param_1 * 4) = pvVar2;
    if (bVar7) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pvVar2);
    }
    return;
}

void FUN_0008e3dc(int param_1, int *param_2)

{
    int iVar1;
    uint uVar2;
    int iVar3;
    int iVar4;
    char *pcVar5;
    uint uVar6;
    int iVar7;

    iVar1 = __stack_chk_guard;
    iVar7 = *param_2;
    uVar2 = param_2[2];
    iVar3 = param_2[3];
    uVar6 = *(uint *)(iVar7 + 0x10) & 0xfffff00 | uVar2;
    param_2[2] = uVar6;
    if (((uVar2 & 0x20) == 0) && ((uVar6 & 0xf000) != 0)) {
        if ((uVar6 & 0x10000) == 0) {
            uVar6 = *(uint *)(param_1 + 0x10);
            uVar2 = uVar6;
            if (iVar3 == 1) {
                iVar3 = *(int *)(param_1 + 0x14);
                iVar4 = iVar3 + 1;
                *(int *)(param_1 + 0x14) = iVar4;
                if (*(char *)(iVar3 + 1) == '\0') {
                    uVar2 = uVar6 + 1;
                    *(uint *)(param_1 + 0x10) = uVar2;
                    iVar4 = *(int *)(*(int *)(param_1 + 8) + uVar6 * 4);
                    *(int *)(param_1 + 0x14) = iVar4;
                }
                param_2[1] = iVar4;
            } else if ((iVar3 == 2) && (param_2[1] == 0)) {
                uVar2 = uVar6 + 1;
                *(uint *)(param_1 + 0x10) = uVar2;
                param_2[1] = *(int *)(*(int *)(param_1 + 8) + uVar6 * 4);
            }
            if (*(uint *)(param_1 + 4) < uVar2) {
                fprintf(stderr, (char *)option_xlateable_txt._144_4_,
                        *(undefined4 *)(param_1 + 0x18),
                        *(undefined4 *)(iVar7 + 0x34));
                iVar3 = -1;
                goto LAB_0008e488;
            }
        } else if (iVar3 == 1) {
            iVar3 = *(int *)(param_1 + 0x14);
            pcVar5 = (char *)(iVar3 + 1);
            *(char **)(param_1 + 0x14) = pcVar5;
            if (*(char *)(iVar3 + 1) == '\0') {
                iVar3 = *(int *)(param_1 + 0x10);
                pcVar5 = *(char **)(*(int *)(param_1 + 8) + iVar3 * 4);
                if ((pcVar5 != (char *)0x0) && (*pcVar5 != '-'))
                    goto LAB_0008e570;
                param_2[1] = 0;
            } else {
            LAB_0008e578:
                param_2[1] = (int)pcVar5;
            }
        } else {
            if (iVar3 != 2) {
                /* WARNING: Subroutine does not return */
                FUN_0008cec0(option_xlateable_txt._68_4_);
            }
            if ((param_2[1] == 0) && ((*(uint *)(param_1 + 0xc) & 3) != 0)) {
                iVar3 = *(int *)(param_1 + 0x10);
                pcVar5 = *(char **)(*(int *)(param_1 + 8) + iVar3 * 4);
                if ((pcVar5 != (char *)0x0) && (*pcVar5 != '-')) {
                LAB_0008e570:
                    *(int *)(param_1 + 0x10) = iVar3 + 1;
                    goto LAB_0008e578;
                }
            }
        }
        iVar3 = 0;
    } else {
        if (iVar3 == 1) {
            iVar3 = 0;
            *(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 1;
            goto LAB_0008e488;
        }
        iVar3 = param_2[1];
        if (iVar3 != 0) {
            fprintf(stderr, (char *)option_xlateable_txt._156_4_,
                    *(undefined4 *)(param_1 + 0x18),
                    *(undefined4 *)(iVar7 + 0x34));
            iVar3 = -1;
            goto LAB_0008e488;
        }
    }
    *(int *)(param_1 + 0x14) = iVar3;
LAB_0008e488:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar3);
    }
    return;
}

void FUN_0008e624(char *param_1)

{
    size_t sVar1;

    sVar1 = strlen(param_1);
    fprintf(stderr, (char *)option_xlateable_txt._20_4_, sVar1);
    /* WARNING: Subroutine does not return */
    FUN_0008ce5c(1);
}

void FUN_0008eac8(undefined4 *param_1, int param_2)

{
    int iVar1;
    code *pcVar2;
    undefined4 uVar3;
    int iVar4;

    iVar1 = __stack_chk_guard;
    pcVar2 = *(code **)(param_2 + 0x28);
    if (pcVar2 == optionPrintVersion) {
        printf("            echo \"$%s_%s_TEXT\"\n            exit 0\n",
               *param_1, "VERSION");
    } else if (pcVar2 == optionPagedUsage) {
        printf("            echo \"$%s_LONGUSAGE_TEXT\" | ${PAGER-more}\n      "
               "      exit 0\n",
               *param_1);
    } else if (pcVar2 == optionLoadOpt) {
        printf("            %s\n",
               "echo \'Warning:  Cannot load options files\' >&2");
        printf("            %s\n", "OPT_ARG_NEEDED=YES");
    } else {
        iVar4 = *(int *)(param_2 + 0x30);
        if (iVar4 == 0) {
            if (pcVar2 == (code *)0x0) {
                printf("            %s\n",
                       "echo \'Warning:  Cannot save options files\' >&2");
                printf("            %s\n", "OPT_ARG_NEEDED=OK");
            } else {
                printf("            echo \"$%s_%s_TEXT\"\n            exit 0\n",
                       *param_1, "LONGUSAGE");
            }
        } else {
            uVar3 = *param_1;
            if (*(short *)(param_2 + 0xc) == 1) {
                printf("            if [ -n \"${%1$s_%2$s}\" ] && "
                       "${%1$s_%2$s_set} ; then\n                echo \'Error: "
                       " duplicate %2$s option\'\n                echo "
                       "\"$%1$s_USAGE_TEXT\"\n                exit 1\n         "
                       "   fi >&2\n            %1$s_%2$s_set=true\n            "
                       "OPT_NAME=\'%2$s\'\n",
                       uVar3);
            } else {
                if (*(short *)(param_2 + 0xc) != -1) {
                    printf("            if [ $%1$s_%2$s_CT -gt %3$u ] ; then\n "
                           "               echo \'Error:  more than %3$d %2$s "
                           "options\'\n                echo "
                           "\"$%1$s_USAGE_TEXT\"\n                exit 1\n     "
                           "       fi >&2\n",
                           uVar3);
                    uVar3 = *param_1;
                    iVar4 = *(int *)(param_2 + 0x30);
                }
                printf("            %1$s_%2$s_CT=`expr ${%1$s_%2$s_CT} + 1`\n  "
                       "          OPT_ELEMENT=\"_${%1$s_%2$s_CT}\"\n           "
                       " OPT_NAME=\'%2$s\'\n",
                       uVar3, iVar4);
            }
            if ((*(uint *)(param_2 + 0x10) & 0xf000) == 0) {
                printf("            eval %1$s_%2$s${OPT_ELEMENT}=true\n        "
                       "    export %1$s_%2$s${OPT_ELEMENT}\n",
                       *param_1, *(undefined4 *)(param_2 + 0x30));
                printf("            %s\n", "OPT_ARG_NEEDED=NO");
            } else if ((*(uint *)(param_2 + 0x10) & 0x10000) == 0) {
                printf("            %s\n", "OPT_ARG_NEEDED=YES");
            } else {
                printf("            eval %1$s_%2$s${OPT_ELEMENT}=true\n        "
                       "    export %1$s_%2$s${OPT_ELEMENT}\n",
                       *param_1, *(undefined4 *)(param_2 + 0x30));
                printf("            %s\n", "OPT_ARG_NEEDED=OK");
            }
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    fwrite(&DAT_000b00da, 1, 0x10, stdout);
    return;
}

void FUN_0008ed38(int param_1)

{
    int iVar1;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar3 = *(int *)(param_1 + 100);
    iVar2 = *(int *)(param_1 + 0x44);
    fwrite("        case \"${OPT_CODE}\" in\n", 1, 0x1e, stdout);
    if (0 < iVar3) {
        do {
            if ((((*(uint *)(iVar2 + 0x10) & 0x280000) == 0) &&
                 ((*(ushort *)(iVar2 + 2) & 0x80) == 0)) &&
                ((*(uint *)(&DAT_000af184 +
                            (*(ushort *)(iVar2 + 2) & 0xff) * 4) &
                  0x4000) != 0)) {
                printf("        \'%c\' )\n");
                FUN_0008eac8(param_1 + 0x20, iVar2);
            }
            iVar3 = iVar3 + -1;
            iVar2 = iVar2 + 0x40;
        } while (iVar3 != 0);
    }
    if (iVar1 == __stack_chk_guard) {
        printf("        * )\n            echo Unknown %s: \"${OPT_CODE}\" "
               ">&2\n            echo \"$%s_USAGE_TEXT\" >&2\n            exit "
               "1\n            ;;\n        esac\n",
               &DAT_000aff33, *(undefined4 *)(param_1 + 0x20));
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0008ee38(byte *param_1, int param_2, int *param_3, int *param_4)

{
    byte bVar1;
    byte bVar2;
    size_t sVar3;
    __int32_t **pp_Var4;
    byte *pbVar5;
    byte *pbVar6;
    uint uVar7;
    __int32_t *p_Var8;
    byte *pbVar9;
    uint __n;
    int iVar10;
    int iVar11;
    byte abStack_4c[32];
    int local_2c;

    local_2c = __stack_chk_guard;
    sVar3 = strlen((char *)param_1);
    if (sVar3 - 1 < 0x1f) {
        iVar10 = *param_3;
        __n = 2;
        iVar11 = *param_4 + -1;
        if (0 < *param_4) {
            do {
                if ((param_2 != iVar10) &&
                    ((*(uint *)(iVar10 + 0x10) & 0x280000) == 0)) {
                    pp_Var4 = __ctype_toupper_loc();
                    p_Var8 = *pp_Var4;
                    pbVar5 = param_1 + -1;
                    pbVar6 = (byte *)(*(int *)(iVar10 + 0x34) + -1);
                    uVar7 = 0;
                    while (true) {
                        pbVar6 = pbVar6 + 1;
                        pbVar5 = pbVar5 + 1;
                        if (p_Var8[*pbVar6] != p_Var8[*pbVar5])
                            break;
                        uVar7 = uVar7 + 1;
                    }
                    pbVar5 = *(byte **)(iVar10 + 0x38);
                    if (__n < uVar7) {
                        __n = uVar7;
                    }
                    if ((pbVar5 != (byte *)0x0) &&
                        (p_Var8[*param_1] == p_Var8[*pbVar5])) {
                        uVar7 = 0;
                        pbVar6 = param_1;
                        do {
                            pbVar5 = pbVar5 + 1;
                            uVar7 = uVar7 + 1;
                            pbVar6 = pbVar6 + 1;
                        } while (p_Var8[*pbVar5] == p_Var8[*pbVar6]);
                        if (__n < uVar7) {
                            __n = uVar7;
                        }
                    }
                }
                iVar11 = iVar11 + -1;
                iVar10 = iVar10 + 0x40;
            } while (iVar11 != -1);
        }
        if (__n < sVar3 - 1) {
            memcpy(abStack_4c, param_1, __n);
            pbVar6 = param_1 + __n;
            pbVar5 = abStack_4c + __n;
            do {
                pbVar9 = pbVar5;
                *pbVar9 = 0;
                printf("        \'%s\' | \\\n", abStack_4c);
                bVar1 = *pbVar6;
                pbVar6 = pbVar6 + 1;
                bVar2 = *pbVar6;
                *pbVar9 = bVar1;
                pbVar5 = pbVar9 + 1;
            } while (bVar2 != 0);
            pbVar9[1] = 0;
        }
    }
    printf("        \'%s\' )\n", param_1);
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0008f000(int param_1)

{
    int iVar1;
    char *__format;
    int iVar2;
    int iVar3;

    iVar1 = __stack_chk_guard;
    iVar2 = *(int *)(param_1 + 0x44);
    iVar3 = *(int *)(param_1 + 100);
    fwrite("        case \"${OPT_CODE}\" in\n", 1, 0x1e, stdout);
    do {
        if ((*(uint *)(iVar2 + 0x10) & 0x280000) == 0) {
            FUN_0008ee38(*(undefined4 *)(iVar2 + 0x34), iVar2, param_1 + 0x44,
                         param_1 + 100);
            FUN_0008eac8(param_1 + 0x20, iVar2);
            if (*(int *)(iVar2 + 0x38) != 0) {
                FUN_0008ee38(*(int *)(iVar2 + 0x38), iVar2, param_1 + 0x44,
                             param_1 + 100);
                if (*(code **)(iVar2 + 0x28) == optionLoadOpt) {
                    printf("            %s\n",
                           "echo \'Warning:  Cannot suppress the loading of "
                           "options files\' >&2");
                } else {
                    if (*(short *)(iVar2 + 0xc) == 1) {
                        __format = "            if [ -n \"${%1$s_%2$s}\" ] && "
                                   "${%1$s_%2$s_set} ; then\n                "
                                   "echo \'Error:  duplicate %2$s option\'\n   "
                                   "             echo \"$%1$s_USAGE_TEXT\"\n   "
                                   "             exit 1\n            fi >&2\n  "
                                   "          %1$s_%2$s_set=true\n            "
                                   "%1$s_%2$s=\'%3$s\'\n            export "
                                   "%1$s_%2$s\n            OPT_NAME=\'%2$s\'\n";
                    } else {
                        __format = "            %1$s_%2$s_CT=0\n            "
                                   "OPT_ELEMENT=\'\'\n            "
                                   "%1$s_%2$s=\'%3$s\'\n            export "
                                   "%1$s_%2$s\n            OPT_NAME=\'%2$s\'\n";
                    }
                    printf(__format, *(undefined4 *)(param_1 + 0x20),
                           *(undefined4 *)(iVar2 + 0x30),
                           *(undefined4 *)(iVar2 + 0x3c));
                }
                printf("            %s\n", "OPT_ARG_NEEDED=NO");
                fwrite(&DAT_000b00da, 1, 0x10, stdout);
            }
        }
        iVar3 = iVar3 + -1;
        iVar2 = iVar2 + 0x40;
    } while (0 < iVar3);
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    printf("        * )\n            echo Unknown %s: \"${OPT_CODE}\" >&2\n    "
           "        echo \"$%s_USAGE_TEXT\" >&2\n            exit 1\n          "
           "  ;;\n        esac\n",
           "option", *(undefined4 *)(param_1 + 0x20));
    return;
}

void FUN_0008f19c(undefined4 param_1, int *param_2)

{
    int iVar1;

    iVar1 = __stack_chk_guard;
    if (((param_2[2] & 4U) != 0) &&
        ((*(uint *)(*param_2 + 0x10) & 0x2000000) != 0)) {
        fprintf(stderr, (char *)option_xlateable_txt._184_4_,
                *(undefined4 *)(*param_2 + 0x34));
        if (iVar1 != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(0xffffffff);
        }
        return;
    }
    FUN_0008e3dc();
    return;
}

void optionPagedUsage(int param_1, int param_2)

{
    char *pcVar1;
    size_t sVar2;
    char *pcVar3;
    __pid_t _Var4;
    char *pcVar5;
    __mode_t __mask;
    int iVar6;
    int iVar7;

    iVar6 = __stack_chk_guard;
    pcVar5 = DAT_001173c0;
    if (DAT_001173bc != 0) {
        if (DAT_001173bc != 1) {
            return;
        }
        fclose(option_usage_fp);
        option_usage_fp = (FILE *)0x0;
        pcVar1 = getenv("PAGER");
        if (pcVar1 == (char *)0x0) {
            iVar7 = 0x1a;
            pcVar1 = "more";
        } else {
            sVar2 = strlen(pcVar1);
            iVar7 = sVar2 + 0x16;
        }
        sVar2 = strlen(pcVar5);
        sVar2 = iVar7 + sVar2 * 2;
        pcVar3 = (char *)malloc(sVar2);
        if (pcVar3 != (char *)0x0) {
            FUN_0007c054(pcVar3, sVar2, "%1$s %2$s ; rm -f %2$s", pcVar1,
                         pcVar5);
            free(pcVar5);
            DAT_001173c0 = pcVar3;
            if (DAT_001173c4 == '\0') {
                fclose(stderr);
                dup2(1, 2);
            } else {
                fwrite("\nexit 0\n", 1, 8, stdout);
                fclose(stdout);
                dup2(2, 1);
            }
            system(DAT_001173c0);
            if (iVar6 == __stack_chk_guard) {
                free(DAT_001173c0);
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        /* WARNING: Subroutine does not return */
        FUN_0001c610(sVar2);
    }
    if ((*(uint *)(param_2 + 0x10) & 8) != 0) {
        return;
    }
    _Var4 = getpid();
    pcVar5 = getenv("TMPDIR");
    if (pcVar5 == (char *)0x0) {
        pcVar5 = "/tmp";
    }
    sVar2 = strlen(pcVar5);
    sVar2 = sVar2 + 0x1a;
    pcVar1 = (char *)malloc(sVar2);
    if (pcVar1 == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0001c610(sVar2);
    }
    FUN_0007c054(pcVar1, sVar2, "%s/use-%u.XXXXXX", pcVar5, _Var4);
    __mask = umask(0x3f);
    iVar6 = mkstemp64(pcVar1);
    umask(__mask);
    if (iVar6 < 0) {
        free(pcVar1);
        option_usage_fp = (FILE *)0x0;
    } else {
        DAT_001173c0 = pcVar1;
        option_usage_fp = fdopen(iVar6, "w");
        if (option_usage_fp != (FILE *)0x0)
            goto LAB_0008f484;
    }
    (**(code **)(param_1 + 0x54))(param_1, 0);
LAB_0008f484:
    DAT_001173bc = 1;
    DAT_001173c4 = DAT_001172c4;
    FUN_0009c1a8(optionPagedUsage);
    DAT_001172c4 = 0;
    (**(code **)(param_1 + 0x54))(param_1, 0);
    /* WARNING: Subroutine does not return */
    _exit(1);
}

void FUN_0008f530(int param_1, int *param_2)

{
    undefined4 uVar1;
    FILE *pFVar2;
    int *piVar3;
    int iVar4;
    char *pcVar5;
    char *__s;
    size_t sVar6;
    size_t sVar7;
    int *piVar8;
    char *pcVar9;
    char *pcVar10;
    int iVar11;
    uint __n;
    stat64 sStack_1098;
    undefined1 auStack_102c[4096];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((*(ushort *)(param_1 + 0x5e) & 0x7fff) != 0) {
        pcVar10 = *(char **)(*(int *)(param_1 + 0x44) +
                             (uint) * (ushort *)(param_1 + 0x5e) * 0x40 + 0x18);
        if ((pcVar10 == (char *)0x0) || (*pcVar10 == '\0')) {
            piVar8 = *(int **)(param_1 + 0x34);
            if (piVar8 == (int *)0x0)
                goto LAB_0008f6f0;
            if (piVar8[1] != 0) {
                piVar3 = piVar8 + 1;
                do {
                    piVar8 = piVar3;
                    piVar3 = piVar8 + 1;
                } while (piVar8[1] != 0);
            }
            pcVar10 = (char *)*piVar8;
            if (*pcVar10 != '$')
                goto LAB_0008f5d8;
            pcVar9 = pcVar10 + 1;
            pcVar5 = strchr(pcVar9, 0x2f);
            if (pcVar5 == (char *)0x0) {
                pcVar10 = getenv(pcVar9);
                iVar11 = 0;
                if (pcVar10 == (char *)0x0) {
                LAB_0008f968:
                    pcVar10 = (char *)0x0;
                    fprintf(stderr, (char *)option_xlateable_txt._240_4_,
                            *(undefined4 *)(param_1 + 0x1c));
                    fprintf(stderr, (char *)option_xlateable_txt._192_4_,
                            pcVar9);
                    goto LAB_0008f6f4;
                }
            } else {
                sVar6 = (int)pcVar5 - (int)pcVar9;
                if (0x7f < (int)sVar6)
                    goto LAB_0008f6f0;
                pcVar10 = (char *)memcpy(auStack_102c, pcVar9, sVar6);
                auStack_102c[sVar6] = 0;
                __s = getenv(pcVar10);
                if (__s == (char *)0x0)
                    goto LAB_0008f968;
                sVar6 = strlen(__s);
                sVar7 = strlen(pcVar5);
                sVar6 = sVar6 + sVar7 + 2;
                pcVar10 = (char *)malloc(sVar6);
                if (pcVar10 == (char *)0x0) {
                    /* WARNING: Subroutine does not return */
                    FUN_0001c610(sVar6);
                }
                iVar11 = 1;
                sprintf(pcVar10, "%s/%s", __s, pcVar5);
            }
        } else {
        LAB_0008f5d8:
            iVar11 = 0;
        }
        iVar4 = __xstat64(3, pcVar10, &sStack_1098);
        if (iVar4 == 0) {
            if ((sStack_1098.st_mode & 0xf000) == 0x4000) {
                sVar6 = strlen(pcVar10);
                pcVar9 = *(char **)(param_1 + 0x24);
                sVar7 = strlen(pcVar9);
                sVar6 = sVar6 + sVar7 + 2;
                pcVar5 = (char *)malloc(sVar6);
                if (pcVar5 == (char *)0x0) {
                    /* WARNING: Subroutine does not return */
                    FUN_0001c610(sVar6);
                }
                FUN_0007c054(pcVar5, sVar6, "%s/%s", pcVar10, pcVar9);
                if (iVar11 != 0) {
                    free(pcVar10);
                }
                iVar11 = __xstat64(3, pcVar5, &sStack_1098);
                pcVar10 = pcVar5;
                if (iVar11 == 0) {
                    if ((sStack_1098.st_mode & 0xf000) != 0x8000) {
                        fprintf(stderr, (char *)option_xlateable_txt._240_4_,
                                *(undefined4 *)(param_1 + 0x1c), pcVar5);
                        goto LAB_0008f768;
                    }
                    iVar11 = 1;
                } else {
                    piVar8 = __errno_location();
                    if (*piVar8 != 2) {
                        pcVar10 = (char *)0x0;
                        fprintf(stderr, (char *)option_xlateable_txt._240_4_,
                                *(undefined4 *)(param_1 + 0x1c));
                        pFVar2 = stderr;
                        uVar1 = option_xlateable_txt._176_4_;
                        iVar11 = *piVar8;
                        pcVar9 = strerror(iVar11);
                        fprintf(pFVar2, (char *)uVar1, iVar11, pcVar9, pcVar5);
                        free(pcVar5);
                        goto LAB_0008f6f4;
                    }
                    sStack_1098.st_mode = 0x8000;
                    iVar11 = 1;
                }
            } else if ((sStack_1098.st_mode & 0xf000) != 0x8000) {
                fprintf(stderr, (char *)option_xlateable_txt._240_4_,
                        *(undefined4 *)(param_1 + 0x1c), pcVar10);
                pcVar5 = pcVar10;
                if (iVar11 != 0) {
                LAB_0008f768:
                    pcVar10 = (char *)0x0;
                    free(pcVar5);
                    goto LAB_0008f6f4;
                }
                goto LAB_0008f6f0;
            }
        LAB_0008f680:
            unlink(pcVar10);
            *param_2 = iVar11;
            goto LAB_0008f6f4;
        }
        piVar8 = __errno_location();
        if (*piVar8 == 2) {
            pcVar5 = strrchr(pcVar10, 0x2f);
            if (pcVar5 == (char *)0x0) {
            LAB_0008f678:
                sStack_1098.st_mode = 0x8000;
                goto LAB_0008f680;
            }
            __n = (int)pcVar5 - (int)pcVar10;
            if (__n < 0x1000) {
                pcVar5 = (char *)memcpy(auStack_102c, pcVar10, __n);
                auStack_102c[__n] = 0;
                iVar4 = __xstat64(3, pcVar5, &sStack_1098);
                if ((iVar4 == 0) && ((sStack_1098.st_mode & 0xf000) == 0x4000))
                    goto LAB_0008f678;
            }
        }
        fprintf(stderr, (char *)option_xlateable_txt._240_4_,
                *(undefined4 *)(param_1 + 0x1c));
        pFVar2 = stderr;
        uVar1 = option_xlateable_txt._176_4_;
        iVar4 = *piVar8;
        pcVar5 = strerror(iVar4);
        fprintf(pFVar2, (char *)uVar1, iVar4, pcVar5, pcVar10);
        if (iVar11 != 0) {
            free(pcVar10);
        }
    }
LAB_0008f6f0:
    pcVar10 = (char *)0x0;
LAB_0008f6f4:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pcVar10);
}

void FUN_0008f9cc(char *param_1, char *param_2)

{
    char *pcVar1;
    char cVar2;
    size_t sVar3;
    DIR *__dirp;
    int iVar4;
    dirent64 *pdVar5;
    size_t sVar6;
    char cVar7;
    size_t __n;
    uint uVar8;
    char *__src;
    uint uVar9;
    uint uVar10;
    char *pcVar11;
    uint uVar12;
    char *pcVar13;
    char *pcVar14;
    char local_1030[4100];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_1 != (char *)0x0) {
        uVar10 = 0;
    LAB_0008fa18:
        sVar3 = strlen(param_1);
        if (uVar10 < sVar3) {
            do {
                pcVar11 = param_1 + uVar10;
                cVar7 = param_1[uVar10];
                while (pcVar14 = local_1030, cVar7 == ':') {
                    pcVar11 = pcVar11 + 1;
                    cVar7 = *pcVar11;
                }
                while (true) {
                    pcVar11 = pcVar11 + 1;
                    *pcVar14 = cVar7;
                    if (cVar7 == '\0')
                        break;
                    if (cVar7 == ':') {
                        *pcVar14 = '\0';
                        break;
                    }
                    if (0xfff < (uint)((int)(pcVar14 + 1) - (int)local_1030))
                        break;
                    cVar7 = *pcVar11;
                    pcVar14 = pcVar14 + 1;
                }
                uVar10 = (int)pcVar11 - (int)param_1;
                if (local_1030[0] == '\0')
                    break;
                __dirp = opendir(local_1030);
                if (__dirp == (DIR *)0x0)
                    goto LAB_0008fa18;
                while (pdVar5 = readdir64(__dirp), pdVar5 != (dirent64 *)0x0) {
                    iVar4 = strcmp(pdVar5->d_name, param_2);
                    if (iVar4 == 0) {
                        if (*param_2 == '/') {
                            pcVar11 = (char *)__strdup();
                        } else {
                            sVar3 = strlen(param_2);
                            if (local_1030[0] == '\0') {
                                pcVar11 = (char *)malloc(sVar3 + 3);
                                if (pcVar11 == (char *)0x0)
                                    goto LAB_0008fdb8;
                                pcVar11[0] = '.';
                                pcVar11[1] = '/';
                                pcVar14 = pcVar11 + 2;
                                *pcVar14 = '\0';
                            } else {
                                sVar6 = strlen(local_1030);
                                pcVar11 = (char *)malloc(sVar3 + 2 + sVar6);
                                if (pcVar11 == (char *)0x0) {
                                LAB_0008fdb8:
                                    pcVar11 = (char *)0x0;
                                    goto LAB_0008fbb4;
                                }
                                __n = sVar6 + 1;
                                memcpy(pcVar11, local_1030, __n);
                                pcVar14 = pcVar11 + sVar6;
                                if (pcVar14[-1] != '/') {
                                    pcVar14 = pcVar11 + __n;
                                    pcVar11[sVar6] = '/';
                                    pcVar11[__n] = '\0';
                                }
                            }
                            memcpy(pcVar14, param_2, sVar3 + 1);
                        }
                    LAB_0008fbb4:
                        iVar4 = access(pcVar11, 5);
                        if ((iVar4 < 0) || (pcVar14 = (char *)__strdup(pcVar11),
                                            pcVar14 == (char *)0x0)) {
                            free(pcVar11);
                            closedir(__dirp);
                            goto LAB_0008fa18;
                        }
                        cVar7 = *pcVar11;
                        cVar2 = *pcVar14;
                        uVar10 = 0;
                        if (cVar7 != '/') {
                            cVar7 = '.';
                        }
                        goto joined_r0x0008fc08;
                    }
                }
                closedir(__dirp);
                sVar3 = strlen(param_1);
                if (sVar3 <= uVar10)
                    break;
            } while (true);
        }
    }
    pcVar14 = (char *)0x0;
LAB_0008fad4:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(pcVar14);
joined_r0x0008fc08:
    uVar12 = uVar10;
    if (cVar2 != '\0') {
        uVar8 = uVar12 + 1;
        uVar10 = uVar8;
        uVar9 = uVar12;
        if (cVar2 == '/')
            goto LAB_0008fc4c;
    LAB_0008fc18:
        pcVar13 = pcVar14 + uVar9;
        do {
            while (true) {
                uVar12 = uVar8;
                pcVar13 = pcVar13 + 1;
                cVar2 = *pcVar13;
                if (cVar2 == '\0' || cVar2 == '/')
                    break;
                uVar8 = uVar12 + 1;
                uVar9 = uVar12;
            }
            uVar10 = uVar9 + 2;
            if (cVar2 == '\0')
                break;
        LAB_0008fc4c:
            cVar2 = pcVar14[uVar10];
            pcVar13 = pcVar14 + uVar10;
            if (cVar2 == '/') {
                uVar8 = uVar10;
                pcVar1 = pcVar14 + uVar10 + 1;
                do {
                    __src = pcVar1;
                    uVar8 = uVar8 + 1;
                    pcVar1 = __src + 1;
                } while (*__src == '/');
                if (uVar8 != uVar10) {
                    strcpy(pcVar14 + uVar12 + 1, __src);
                    cVar2 = *pcVar13;
                }
            }
            if (uVar12 != 0) {
                if (pcVar14[uVar12 - 1] == '\\')
                    goto joined_r0x0008fc08;
                if (cVar2 != '\0')
                    goto LAB_0008fcb8;
            LAB_0008fdac:
                pcVar13[-1] = '\0';
                break;
            }
        LAB_0008fcb8:
            if (cVar2 != '.')
                goto joined_r0x0008fc08;
            uVar8 = uVar10 + 1;
            cVar2 = pcVar14[uVar8];
            if (cVar2 == '\0')
                goto LAB_0008fdac;
            if (cVar2 == '/') {
                strcpy(pcVar13, pcVar14 + uVar8);
                cVar2 = pcVar14[uVar12];
                uVar10 = uVar12;
                goto joined_r0x0008fc08;
            }
            uVar9 = uVar10;
            if (cVar2 != '.')
                goto LAB_0008fc18;
            if (pcVar14[uVar10 + 2] == '\0' || pcVar14[uVar10 + 2] == '/') {
                pcVar13 = pcVar14 + uVar12;
                goto LAB_0008fd10;
            }
        } while (true);
    }
    goto LAB_0008fd38;
    while (pcVar13 = pcVar13 + -1, *pcVar13 != '/') {
    LAB_0008fd10:
        uVar8 = uVar12;
        uVar12 = uVar8 - 1;
        if (uVar8 == 0)
            break;
    }
    uVar12 = uVar12 & ~((int)uVar12 >> 0x1f);
    strcpy(pcVar14 + uVar8, pcVar14 + uVar10 + 2);
    cVar2 = pcVar14[uVar12];
    uVar10 = uVar12;
    goto joined_r0x0008fc08;
LAB_0008fd38:
    if (*pcVar14 == '\0') {
        *pcVar14 = cVar7;
        pcVar14[1] = '\0';
    }
    free(pcVar11);
    closedir(__dirp);
    goto LAB_0008fad4;
}

void FUN_0008fdcc(int param_1, ushort *param_2, undefined4 param_3)

{
    char cVar1;
    size_t sVar2;
    int iVar3;
    uint uVar4;
    byte *pbVar5;
    int iVar6;
    uint uVar7;
    code *pcVar8;
    int iVar9;
    int *piVar10;
    char acStack_88[12];
    undefined1 auStack_7c[80];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (((*(uint *)(param_1 + 0xc) & 0x40000) != 0) && (param_2[3] == 0x57)) {
        uVar4 = 0;
        iVar9 = *(int *)(param_1 + 0x68);
        iVar6 = *(int *)(param_1 + 0x44);
        fprintf(option_usage_fp, &UNK_000afeb9 + DAT_001173c8,
                option_xlateable_txt._432_4_);
        do {
            if (((*(uint *)(iVar6 + 0x10) & 0x6280000) == 0) &&
                ((((*(ushort *)(iVar6 + 2) & 0x80) != 0 ||
                   ((*(uint *)(&DAT_000af184 +
                               (*(ushort *)(iVar6 + 2) & 0xff) * 4) &
                     0x4000) == 0)) &&
                  (sVar2 = strlen(*(char **)(iVar6 + 0x34)), uVar4 < sVar2)))) {
                uVar4 = sVar2;
            }
            iVar9 = iVar9 + -1;
            iVar6 = iVar6 + 0x40;
        } while (0 < iVar9);
        FUN_0007c054(acStack_88, 0xc, "%%-%us %%s\n", uVar4 + 4);
        iVar9 = *(int *)(param_1 + 0x68);
        iVar6 = *(int *)(param_1 + 0x44);
        if (DAT_001173c8 != 0) {
            DAT_001173c8 = DAT_001173c8 + -1;
        }
        do {
            if (((*(uint *)(iVar6 + 0x10) & 0x6280000) == 0) &&
                (((*(ushort *)(iVar6 + 2) & 0x80) != 0 ||
                  ((*(uint *)(&DAT_000af184 +
                              (*(ushort *)(iVar6 + 2) & 0xff) * 4) &
                    0x4000) == 0)))) {
                FUN_0008e1ac(param_1 + 0xc, iVar6 + 2, &DAT_001172f4,
                             &DAT_001172f8);
                pbVar5 = DAT_001172e8;
                if ((*(uint *)(iVar6 + 0x10) & 0x10000) == 0) {
                    switch ((*(uint *)(iVar6 + 0x10) << 0x10) >> 0x1c) {
                    case 0:
                        pbVar5 = DAT_001172ec;
                        break;
                    case 1:
                        pbVar5 = DAT_001172c8;
                        break;
                    case 2:
                        pbVar5 = DAT_001172d8;
                        break;
                    case 3:
                        pbVar5 = DAT_001172e0;
                        break;
                    case 4:
                        pbVar5 = DAT_001172dc;
                        break;
                    case 5:
                        pbVar5 = DAT_001172d0;
                        break;
                    case 6:
                        pbVar5 = DAT_001172e4;
                        break;
                    case 7:
                        pbVar5 = DAT_001172d4;
                        break;
                    case 8:
                        pbVar5 = DAT_00117300;
                        break;
                    default:
                        fprintf(stderr, (char *)option_xlateable_txt._136_4_,
                                *(undefined4 *)(param_1 + 0x1c),
                                *(undefined4 *)(iVar6 + 0x34));
                        /* WARNING: Subroutine does not return */
                        FUN_0008cec0(option_xlateable_txt._64_4_);
                    }
                }
                iVar3 = DAT_00117334;
                if (DAT_00117334 == 0) {
                    iVar3 = FUN_0008e2f8(0xc);
                }
                uVar4 = (uint)*pbVar5;
                cVar1 = *(char *)(iVar3 + uVar4);
                while (cVar1 != '\0') {
                    pbVar5 = pbVar5 + 1;
                    uVar4 = (uint)*pbVar5;
                    cVar1 = *(char *)(iVar3 + uVar4);
                }
                if (uVar4 == 0) {
                    FUN_0007c054(auStack_7c, 0x50, "%s",
                                 *(undefined4 *)(iVar6 + 0x34));
                } else {
                    FUN_0007c054(auStack_7c, 0x50, "%s=%s",
                                 *(undefined4 *)(iVar6 + 0x34), pbVar5);
                }
                fprintf(option_usage_fp, acStack_88, auStack_7c,
                        *(undefined4 *)(iVar6 + 0x2c));
                uVar4 = (uint)(*(int *)(iVar6 + 0x10) << 0x10) >> 0x1c;
                if (((uVar4 == 2) || (uVar4 == 4)) &&
                    (*(int *)(iVar6 + 0x28) != 0)) {
                    DAT_001173cc = 1;
                }
                FUN_0008fdcc(param_1, iVar6, param_3);
            }
            iVar9 = iVar9 + -1;
            iVar6 = iVar6 + 0x40;
        } while (0 < iVar9);
        goto LAB_00090114;
    }
    if ((*(int *)(param_2 + 0x10) == 0) && (*(int *)(param_2 + 0x12) == 0)) {
        iVar6 = *(int *)(param_2 + 0x1c);
    } else {
        fputs(&UNK_000afe9f + DAT_001173c8, option_usage_fp);
        piVar10 = *(int **)(param_2 + 0x10);
        if (piVar10 == (int *)0x0) {
        LAB_0008fecc:
            piVar10 = *(int **)(param_2 + 0x12);
            if (piVar10 != (int *)0x0) {
                if (piVar10[1] == 0x8000) {
                    fprintf(option_usage_fp,
                            (char *)option_xlateable_txt._360_4_,
                            *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                            *piVar10 * 0x40 + 0x34));
                    iVar6 = *(int *)(param_2 + 0x1c);
                    goto joined_r0x000901b0;
                }
                fputs((char *)option_xlateable_txt._356_4_, option_usage_fp);
                iVar6 = *piVar10;
                do {
                    fprintf(option_usage_fp, &UNK_000afeb9 + DAT_001173c8,
                            *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                            iVar6 * 0x40 + 0x34));
                    piVar10 = piVar10 + 1;
                    iVar6 = *piVar10;
                } while (iVar6 != 0x8000);
            }
        } else {
            if (piVar10[1] == 0x8000) {
                fprintf(option_usage_fp, (char *)option_xlateable_txt._400_4_,
                        *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                        *piVar10 * 0x40 + 0x34));
            } else {
                fputs((char *)option_xlateable_txt._404_4_, option_usage_fp);
                iVar6 = *piVar10;
                do {
                    fprintf(option_usage_fp, &UNK_000afeb9 + DAT_001173c8,
                            *(undefined4 *)(*(int *)(param_1 + 0x44) +
                                            iVar6 * 0x40 + 0x34));
                    piVar10 = piVar10 + 1;
                    iVar6 = *piVar10;
                } while (iVar6 != 0x8000);
            }
            if (*(int *)(param_2 + 0x12) != 0) {
                fputs("\t\t\t\t-- and " + DAT_001173c8, option_usage_fp);
                goto LAB_0008fecc;
            }
        }
        iVar6 = *(int *)(param_2 + 0x1c);
    }
joined_r0x000901b0:
    if (iVar6 != 0) {
        fprintf(option_usage_fp,
                (char *)(option_xlateable_txt._256_4_ + DAT_001173c8));
    }
    uVar7 = *(uint *)(param_2 + 8);
    uVar4 = (uVar7 << 0x10) >> 0x1c;
    if (uVar4 == 5) {
        pcVar8 = *(code **)(param_2 + 0x14);
        if (pcVar8 != (code *)0x0 && pcVar8 != optionNumericVal) {
            (*pcVar8)(1, param_2);
            uVar7 = *(uint *)(param_2 + 8);
        }
    } else if (uVar4 == 7) {
        (**(code **)(param_2 + 0x14))(1, param_2);
        uVar7 = *(uint *)(param_2 + 8);
    }
    if ((uVar7 & 0x800) != 0) {
        fputs((char *)(option_xlateable_txt._268_4_ + DAT_001173c8),
              option_usage_fp);
    }
    uVar4 = (uint)param_2[4];
    if ((uVar4 == 0x8000) || (param_2[2] == uVar4)) {
        uVar4 = *(uint *)(param_2 + 8);
        if (((uVar4 & 0x100) != 0) &&
            (((*(int *)(param_1 + 0x34) != 0 ||
               (*(int *)(param_1 + 0x20) != 0)) &&
              ((int)(uint)*param_2 < *(int *)(param_1 + 0x68))))) {
            fputs((char *)(option_xlateable_txt._316_4_ + DAT_001173c8),
                  option_usage_fp);
            uVar4 = *(uint *)(param_2 + 8);
        }
        if ((uVar4 << 0x10) >> 0x1c == 4) {
            fputs((char *)(option_xlateable_txt._300_4_ + DAT_001173c8),
                  option_usage_fp);
        } else {
            uVar4 = (uint)param_2[6];
            if (param_2[5] < 2) {
                if (uVar4 != 1) {
                    if (uVar4 == 0) {
                        fputs((char *)(option_xlateable_txt._348_4_ +
                                       DAT_001173c8),
                              option_usage_fp);
                    } else if (uVar4 == 0xffff) {
                        fputs((char *)(option_xlateable_txt._312_4_ +
                                       DAT_001173c8),
                              option_usage_fp);
                    } else {
                        fprintf(option_usage_fp,
                                (char *)(option_xlateable_txt._420_4_ +
                                         DAT_001173c8),
                                uVar4);
                    }
                }
            } else {
                fprintf(option_usage_fp,
                        (char *)(option_xlateable_txt._304_4_ + DAT_001173c8));
            }
        }
        if (((*(uint *)(param_1 + 0xc) & 3) == 0) &&
            (*(ushort *)(param_1 + 0x62) == *param_2)) {
            fputs((char *)(option_xlateable_txt._252_4_ + DAT_001173c8),
                  option_usage_fp);
        }
    } else {
        fprintf(
            option_usage_fp,
            (char *)(option_xlateable_txt._244_4_ + DAT_001173c8),
            *(undefined4 *)(*(int *)(param_1 + 0x44) + uVar4 * 0x40 + 0x34));
    }
LAB_00090114:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

/* WARNING: Heritage AFTER dead removal. Example location: r0x001172e8 :
 * 0x00090800 */
/* WARNING: Restarted to delay deadcode elimination for space: ram */

void FUN_000906bc(int param_1, int param_2, undefined4 param_3)

{
    undefined4 uVar1;
    undefined4 uVar2;
    uint uVar3;
    int iVar4;
    int iVar5;
    int iVar6;
    int iVar7;
    int local_9c;
    undefined1 auStack_7c[80];
    int local_2c;

    iVar6 = 0;
    local_9c = 0;
    iVar5 = *(int *)(param_1 + 100);
    local_2c = __stack_chk_guard;
    iVar4 = *(int *)(param_1 + 0x44);
    do {
        uVar3 = *(uint *)(iVar4 + 0x10);
        if ((uVar3 & 0x6080000) == 0) {
            if ((uVar3 & 0x200000) == 0) {
                uVar3 = *(uint *)(param_1 + 0xc) & 0x40000;
                if ((uVar3 == 0) ||
                    (((*(ushort *)(iVar4 + 2) & 0x80) == 0 &&
                      ((*(uint *)(&DAT_000af184 +
                                  (*(ushort *)(iVar4 + 2) & 0xff) * 4) &
                        0x4000) != 0)))) {
                    if (param_2 == 0 && 0 < local_9c) {
                        if (*(int *)(param_1 + 0x68) == iVar6) {
                            if ((*(uint *)(iVar4 + -0x30) & 0x200000) == 0) {
                                fprintf(option_usage_fp, DAT_001172f0,
                                        option_xlateable_txt._248_4_, param_3);
                            }
                        } else if (uVar3 != 0 && iVar5 == 1) {
                            fprintf(option_usage_fp, DAT_001172f0,
                                    option_xlateable_txt._428_4_, param_3);
                        }
                    }
                    FUN_0008e1ac(param_1 + 0xc, iVar4 + 2, &DAT_001172f4,
                                 &DAT_001172f8);
                    uVar2 = DAT_001172e8;
                    if ((*(uint *)(iVar4 + 0x10) & 0x10000) == 0) {
                        switch ((*(uint *)(iVar4 + 0x10) << 0x10) >> 0x1c) {
                        case 0:
                            uVar2 = DAT_001172ec;
                            break;
                        case 1:
                            uVar2 = DAT_001172c8;
                            break;
                        case 2:
                            uVar2 = DAT_001172d8;
                            break;
                        case 3:
                            uVar2 = DAT_001172e0;
                            break;
                        case 4:
                            uVar2 = DAT_001172dc;
                            break;
                        case 5:
                            uVar2 = DAT_001172d0;
                            break;
                        case 6:
                            uVar2 = DAT_001172e4;
                            break;
                        case 7:
                            uVar2 = DAT_001172d4;
                            break;
                        case 8:
                            uVar2 = DAT_00117300;
                            break;
                        default:
                            fprintf(stderr,
                                    (char *)option_xlateable_txt._136_4_,
                                    *(undefined4 *)(param_1 + 0x1c),
                                    *(undefined4 *)(iVar4 + 0x34));
                            /* WARNING: Subroutine does not return */
                            FUN_0008ce5c(0x46);
                        }
                    }
                    uVar1 = DAT_001172e8;
                    if (*(short *)(iVar4 + 10) != 0) {
                        uVar1 = DAT_001172cc;
                    }
                    FUN_0007c054(auStack_7c, 0x50, DAT_001172fc, uVar2,
                                 *(undefined4 *)(iVar4 + 0x34), uVar1);
                    fprintf(option_usage_fp, &DAT_001173d0, auStack_7c,
                            *(undefined4 *)(iVar4 + 0x2c));
                    uVar3 = (uint)(*(int *)(iVar4 + 0x10) << 0x10) >> 0x1c;
                    if (((uVar3 == 2) || (uVar3 == 4)) &&
                        (*(int *)(iVar4 + 0x28) != 0)) {
                        DAT_001173cc = 1;
                    }
                    if (param_2 == 0) {
                        FUN_0008fdcc(param_1, iVar4, param_3);
                    }
                }
            } else if (param_2 == 0) {
                local_9c = local_9c + 1;
                fprintf(option_usage_fp, DAT_001172f0,
                        *(undefined4 *)(iVar4 + 0x2c), param_3);
            }
        } else if ((uVar3 == 0x80100) &&
                   (*(int *)(iVar4 + 0x34) != 0 && param_2 == 0)) {
            iVar7 = *(int *)(iVar4 + 0x2c);
            if (*(int *)(iVar4 + 0x2c) == 0) {
                iVar7 = option_xlateable_txt._264_4_;
            }
            FUN_0008e1ac(param_1 + 0xc, iVar4 + 2, &DAT_001172f4,
                         &DAT_001172f8);
            fprintf(option_usage_fp, (char *)option_xlateable_txt._260_4_,
                    *(undefined4 *)(iVar4 + 0x34), iVar7);
        }
        iVar5 = iVar5 + -1;
        iVar4 = iVar4 + 0x40;
        iVar6 = iVar6 + 1;
    } while (0 < iVar5);
    fputc(10, option_usage_fp);
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0009121c(byte *param_1, int param_2)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    uint uVar4;
    byte *pbVar5;

    iVar1 = __stack_chk_guard;
    if (param_2 - 3U < 0xc) {
        uVar4 = (uint)(byte)(&DAT_000af4a0)[*param_1] + param_2;
        if (((uVar4 < 0x12) && (pbVar5 = *(byte **)(&DAT_000c5208 + uVar4 * 8),
                                (uint)*pbVar5 == (uint)*param_1)) &&
            (iVar2 = strncmp((char *)(param_1 + 1), (char *)(pbVar5 + 1),
                             param_2 - 1),
             iVar2 == 0)) {
            uVar3 = 0;
            if (pbVar5[param_2] == 0) {
                uVar3 = *(undefined4 *)(&DAT_000c520c + uVar4 * 8);
            }
            goto LAB_000912ac;
        }
    }
    uVar3 = 0;
LAB_000912ac:
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(uVar3);
    }
    return;
}

void FUN_000912e0(byte *param_1, int param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;
    undefined4 uVar4;
    byte *pbVar5;

    iVar2 = __stack_chk_guard;
    if (param_2 - 4U < 5) {
        if ((uint)(byte) "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                         "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                         "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                         "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                             [*param_1] +
                param_2 <
            10) {
            iVar1 = ((uint)(byte) "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                                  "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                                  "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                                  "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                                  "\n\n\n\n\n\n\n\n\n\n\n"[*param_1] +
                     param_2) *
                    8;
            pbVar5 = *(byte **)(&DAT_000c5298 + iVar1);
            if (((uint)*pbVar5 == (uint)*param_1) &&
                (iVar3 = strncmp((char *)(param_1 + 1), (char *)(pbVar5 + 1),
                                 param_2 - 1),
                 iVar3 == 0)) {
                uVar4 = 0;
                if (pbVar5[param_2] == 0) {
                    uVar4 = *(undefined4 *)(&DAT_000c529c + iVar1);
                }
                goto LAB_00091370;
            }
        }
    }
    uVar4 = 0;
LAB_00091370:
    if (iVar2 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_000913a4(byte *param_1, undefined4 *param_2, undefined4 *param_3)

{
    byte bVar1;
    char cVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;
    uint uVar6;
    byte *pbVar7;
    byte *pbVar8;
    byte *pbVar9;
    byte *pbVar10;

    iVar3 = __stack_chk_guard;
    do {
        iVar5 = DAT_00117358;
        if (DAT_00117358 == 0) {
            iVar5 = FUN_0008e2f8(0x15);
        }
        uVar6 = (uint) * (byte *)(iVar5 + (uint)*param_1);
        pbVar8 = param_1;
        if (uVar6 != 0) {
            do {
                pbVar8 = pbVar8 + 1;
            } while (*(char *)(iVar5 + (uint)*pbVar8) != '\0');
            uVar6 = (int)pbVar8 - (int)param_1;
        }
        uVar4 = FUN_000912e0(param_1, uVar6);
        switch (uVar4) {
        case 1:
            pbVar9 = pbVar8 + 1;
            pbVar10 = pbVar9;
            if (*pbVar8 != 0x3d) {
            switchD_00091748_default:
                *param_3 = 0;
                iVar5 = DAT_00117388;
                if (DAT_00117388 == 0) {
                    iVar5 = FUN_0008e2f8(0x21);
                }
                uVar6 = (uint)*pbVar10;
                pbVar8 = pbVar10;
                if (uVar6 != 0) {
                    while (*(char *)(iVar5 + uVar6) == '\0') {
                        pbVar8 = pbVar8 + 1;
                        uVar6 = (uint)*pbVar8;
                        if (uVar6 == 0)
                            goto LAB_000914e0;
                    }
                    break;
                }
                goto LAB_000914e0;
            }
            iVar5 = DAT_00117370;
            if (DAT_00117370 == 0) {
                iVar5 = FUN_0008e2f8(0x1b);
            }
            pbVar7 = pbVar9;
            if (*(char *)(iVar5 + (uint)pbVar8[1]) == '\0')
                goto switchD_00091748_default;
            do {
                pbVar7 = pbVar7 + 1;
            } while (*(char *)(iVar5 + (uint)*pbVar7) != '\0');
            iVar5 = (int)pbVar7 - (int)pbVar9;
            if (iVar5 == 0)
                goto switchD_00091748_default;
            pbVar8 = pbVar9 + iVar5;
            pbVar10 = pbVar8;
            if ((0x7f < pbVar9[iVar5]) ||
                ((*(uint *)(&DAT_000af184 + (uint)pbVar9[iVar5] * 4) &
                  0x1000c01) == 0))
                goto switchD_00091748_default;
            uVar4 = FUN_0009121c(pbVar9);
            switch (uVar4) {
            case 1:
                *param_3 = 1;
                break;
            case 2:
                *param_3 = 5;
                break;
            case 3:
                goto LAB_00091798;
            case 4:
            LAB_00091798:
                *param_3 = 3;
                break;
            case 5:
                *param_3 = 2;
                break;
            case 6:
                goto LAB_00091780;
            case 7:
            LAB_00091780:
                *param_3 = 4;
                break;
            case 8:
                goto LAB_00091774;
            case 9:
            LAB_00091774:
                *param_3 = 6;
                break;
            default:
                goto switchD_00091748_default;
            }
            break;
        case 2:
            iVar5 = DAT_00117388;
            if (DAT_00117388 == 0) {
                iVar5 = FUN_0008e2f8(0x21);
            }
            bVar1 = *pbVar8;
            while (true) {
                if (bVar1 == 0)
                    goto LAB_000914e0;
                if (*(char *)(iVar5 + (uint)bVar1) != '\0')
                    break;
                pbVar8 = pbVar8 + 1;
                bVar1 = *pbVar8;
            }
            break;
        case 3:
            iVar5 = DAT_00117388;
            if (DAT_00117388 == 0) {
                iVar5 = FUN_0008e2f8(0x21);
            }
            bVar1 = *pbVar8;
            while (true) {
                if (bVar1 == 0)
                    goto LAB_000914e0;
                if (*(char *)(iVar5 + (uint)bVar1) != '\0')
                    break;
                pbVar8 = pbVar8 + 1;
                bVar1 = *pbVar8;
            }
            break;
        case 4:
            param_1 = pbVar8;
            if ((0x7f < *pbVar8) ||
                ((*(uint *)(&DAT_000af184 + (uint)*pbVar8 * 4) & 0x1000c01) ==
                 0))
                goto switchD_0009142c_default;
            *param_2 = 0;
            break;
        case 5:
            param_1 = pbVar8;
            if ((0x7f < *pbVar8) ||
                ((*(uint *)(&DAT_000af184 + (uint)*pbVar8 * 4) & 0x1000c01) ==
                 0))
                goto switchD_0009142c_default;
            *param_2 = 1;
            break;
        case 6:
            param_1 = pbVar8;
            if ((0x7f < *pbVar8) ||
                ((*(uint *)(&DAT_000af184 + (uint)*pbVar8 * 4) & 0x1000c01) ==
                 0))
                goto switchD_0009142c_default;
            *param_2 = 2;
            break;
        default:
        switchD_0009142c_default:
            *param_3 = 0;
            iVar5 = DAT_00117388;
            if (DAT_00117388 == 0) {
                iVar5 = FUN_0008e2f8(0x21);
            }
            uVar6 = (uint)*param_1;
            if (uVar6 != 0)
                goto LAB_00091494;
            goto LAB_000914e0;
        }
        iVar5 = DAT_00117334;
        if (DAT_00117334 == 0) {
            iVar5 = FUN_0008e2f8(0xc);
        }
        uVar6 = (uint)*pbVar8;
        cVar2 = *(char *)(iVar5 + uVar6);
        param_1 = pbVar8;
        while (cVar2 != '\0') {
            param_1 = param_1 + 1;
            uVar6 = (uint)*param_1;
            cVar2 = *(char *)(iVar5 + uVar6);
        }
        if (uVar6 == 0x2f) {
            *param_3 = 0;
            goto LAB_000914e4;
        }
        if (uVar6 == 0x3e)
            goto LAB_000914e4;
        if ((0x7f < uVar6) ||
            ((*(uint *)(&DAT_000af184 + uVar6 * 4) & 0x80000) == 0))
            goto LAB_000914e0;
    } while (true);
    while (true) {
        param_1 = param_1 + 1;
        uVar6 = (uint)*param_1;
        if (uVar6 == 0)
            break;
    LAB_00091494:
        if (*(char *)(iVar5 + uVar6) != '\0')
            goto LAB_000914e4;
    }
LAB_000914e0:
    param_1 = (byte *)0x0;
LAB_000914e4:
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(param_1);
}

void FUN_00091b34(int *param_1, char *param_2)

{
    int iVar1;
    int iVar2;
    int iVar3;
    int *piVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 6)) {
        piVar4 = __errno_location();
        iVar5 = 0;
        *piVar4 = 0x16;
        goto LAB_00091b94;
    }
    piVar4 = (int *)param_1[2];
    iVar3 = *piVar4;
    if (0 < iVar3) {
        iVar5 = piVar4[2];
        if (param_2 != (char *)0x0) {
            piVar4 = piVar4 + 2;
            while (iVar2 = strcmp(*(char **)(iVar5 + 4), param_2), iVar2 != 0) {
                iVar3 = iVar3 + -1;
                if (iVar3 == 0)
                    goto LAB_00091bd4;
                piVar4 = piVar4 + 1;
                iVar5 = *piVar4;
            }
            goto LAB_00091b94;
        }
        if (iVar5 != 0)
            goto LAB_00091b94;
    }
LAB_00091bd4:
    piVar4 = __errno_location();
    iVar5 = 0;
    *piVar4 = 2;
LAB_00091b94:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar5);
}

void FUN_00091d14(int *param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    int *piVar3;
    int iVar4;
    int iVar5;

    iVar1 = __stack_chk_guard;
    if ((param_1 == (int *)0x0) || (*param_1 != 6)) {
        piVar3 = __errno_location();
        iVar5 = 0;
        *piVar3 = 0x16;
    } else {
        piVar3 = (int *)param_1[2] + 2;
        iVar5 = *(int *)param_1[2];
        do {
            piVar2 = piVar3;
            iVar4 = iVar5 + -1;
            if (iVar5 < 1) {
                iVar4 = 0x16;
                goto LAB_00091d7c;
            }
            piVar3 = piVar2 + 1;
            iVar5 = iVar4;
        } while (*piVar2 != param_2);
        if (iVar4 == 0) {
            iVar4 = 2;
        LAB_00091d7c:
            piVar3 = __errno_location();
            iVar5 = 0;
            *piVar3 = iVar4;
        } else {
            iVar5 = piVar2[1];
        }
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(iVar5);
    }
    return;
}

void FUN_00091ddc(byte *param_1, byte *param_2, byte param_3)

{
    byte bVar1;
    byte bVar2;
    ulong uVar3;
    int iVar4;
    int iVar5;
    byte local_18[4];
    int local_14;

    bVar1 = *param_1;
    local_14 = __stack_chk_guard;
    *param_2 = bVar1;
    switch (bVar1) {
    case 0:
        iVar5 = 0;
        goto LAB_00092000;
    case 1:
        break;
    case 2:
        break;
    case 3:
        break;
    case 4:
        break;
    case 5:
        break;
    case 6:
        break;
    case 7:
        break;
    case 8:
        break;
    case 9:
        break;
    case 10:
        iVar5 = 1;
    LAB_00091ffc:
        *param_2 = param_3;
        goto LAB_00092000;
    case 0xb:
        break;
    case 0xc:
        break;
    case 0xd:
        if (param_1[1] == 10) {
            iVar5 = 2;
            goto LAB_00091ffc;
        }
        break;
    case 0xe:
        break;
    case 0xf:
        break;
    case 0x10:
        break;
    case 0x11:
        break;
    case 0x12:
        break;
    case 0x13:
        break;
    case 0x14:
        break;
    case 0x15:
        break;
    case 0x16:
        break;
    case 0x17:
        break;
    case 0x18:
        break;
    case 0x19:
        break;
    case 0x1a:
        break;
    case 0x1b:
        break;
    case 0x1c:
        break;
    case 0x1d:
        break;
    case 0x1e:
        break;
    case 0x1f:
        break;
    case 0x20:
        break;
    case 0x21:
        break;
    case 0x22:
        break;
    case 0x23:
        break;
    case 0x24:
        break;
    case 0x25:
        break;
    case 0x26:
        break;
    case 0x27:
        break;
    case 0x28:
        break;
    case 0x29:
        break;
    case 0x2a:
        break;
    case 0x2b:
        break;
    case 0x2c:
        break;
    case 0x2d:
        break;
    case 0x2e:
        break;
    case 0x2f:
        break;
    case 0x30:
        goto LAB_00092034;
    case 0x31:
        goto LAB_00092034;
    case 0x32:
        goto LAB_00092034;
    case 0x33:
        goto LAB_00092034;
    case 0x34:
        goto LAB_00092034;
    case 0x35:
        goto LAB_00092034;
    case 0x36:
        goto LAB_00092034;
    case 0x37:
    LAB_00092034:
        bVar1 = param_1[1];
        local_18[0] = *param_1;
        if ((bVar1 < 0x80) &&
            ((*(uint *)(&DAT_000af184 + (uint)bVar1 * 4) & 0x10000) != 0)) {
            bVar2 = param_1[2];
            local_18[1] = bVar1;
            if ((bVar2 < 0x80) &&
                ((*(uint *)(&DAT_000af184 + (uint)bVar2 * 4) & 0x10000) != 0)) {
                iVar5 = 3;
                local_18[2] = bVar2;
            } else {
                iVar5 = 2;
            }
        } else {
            iVar5 = 1;
        }
        local_18[iVar5] = 0;
        uVar3 = strtoul((char *)local_18, (char **)0x0, 8);
        if (0xfe < uVar3) {
            uVar3 = 0xff;
        }
        *param_2 = (byte)uVar3;
        goto LAB_00092000;
    case 0x38:
        break;
    case 0x39:
        break;
    case 0x3a:
        break;
    case 0x3b:
        break;
    case 0x3c:
        break;
    case 0x3d:
        break;
    case 0x3e:
        break;
    case 0x3f:
        break;
    case 0x40:
        break;
    case 0x41:
        break;
    case 0x42:
        break;
    case 0x43:
        break;
    case 0x44:
        break;
    case 0x45:
        break;
    case 0x46:
        break;
    case 0x47:
        break;
    case 0x48:
        break;
    case 0x49:
        break;
    case 0x4a:
        break;
    case 0x4b:
        break;
    case 0x4c:
        break;
    case 0x4d:
        break;
    case 0x4e:
        break;
    case 0x4f:
        break;
    case 0x50:
        break;
    case 0x51:
        break;
    case 0x52:
        break;
    case 0x53:
        break;
    case 0x54:
        break;
    case 0x55:
        break;
    case 0x56:
        break;
    case 0x57:
        break;
    case 0x58:
        goto LAB_000920b0;
    case 0x59:
        break;
    case 0x5a:
        break;
    case 0x5b:
        break;
    case 0x5c:
        break;
    case 0x5d:
        break;
    case 0x5e:
        break;
    case 0x5f:
        break;
    case 0x60:
        break;
    case 0x61:
        iVar5 = 1;
        *param_2 = 7;
        goto LAB_00092000;
    case 0x62:
        iVar5 = 1;
        *param_2 = 8;
        goto LAB_00092000;
    case 99:
        break;
    case 100:
        break;
    case 0x65:
        break;
    case 0x66:
        iVar5 = 1;
        *param_2 = 0xc;
        goto LAB_00092000;
    case 0x67:
        break;
    case 0x68:
        break;
    case 0x69:
        break;
    case 0x6a:
        break;
    case 0x6b:
        break;
    case 0x6c:
        break;
    case 0x6d:
        break;
    case 0x6e:
        iVar5 = 1;
        *param_2 = 10;
        goto LAB_00092000;
    case 0x6f:
        break;
    case 0x70:
        break;
    case 0x71:
        break;
    case 0x72:
        iVar5 = 1;
        *param_2 = 0xd;
        goto LAB_00092000;
    case 0x73:
        break;
    case 0x74:
        iVar5 = 1;
        *param_2 = 9;
        goto LAB_00092000;
    case 0x75:
        break;
    case 0x76:
        iVar5 = 1;
        *param_2 = 0xb;
        goto LAB_00092000;
    case 0x77:
        break;
    case 0x78:
    LAB_000920b0:
        bVar1 = param_1[1];
        if ((bVar1 < 0x80) &&
            ((*(uint *)(&DAT_000af184 + (uint)bVar1 * 4) & 0x70000) != 0)) {
            bVar2 = param_1[2];
            if ((bVar2 < 0x80) &&
                ((*(uint *)(&DAT_000af184 + (uint)bVar2 * 4) & 0x70000) != 0)) {
                iVar5 = 3;
                iVar4 = 2;
                local_18[1] = bVar2;
            } else {
                iVar5 = 2;
                iVar4 = 1;
            }
            local_18[iVar4] = 0;
            local_18[0] = bVar1;
            uVar3 = strtoul((char *)local_18, (char **)0x0, 0x10);
            *param_2 = (byte)uVar3;
            goto LAB_00092000;
        }
    }
    iVar5 = 1;
LAB_00092000:
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar5);
}

void FUN_000921c8(byte *param_1, int *param_2)

{
    byte bVar1;
    byte *pbVar2;
    int iVar3;
    byte *pbVar4;
    uint uVar5;
    byte *pbVar6;
    byte *pbVar7;
    uint uVar8;
    int local_30;
    int local_2c;

    uVar8 = (uint)*param_1;
    local_30 = 0;
    local_2c = __stack_chk_guard;
    if (param_2 == (int *)0x0) {
        param_2 = &local_30;
    }
    uVar5 = (uint)param_1[1];
    pbVar6 = param_1 + 1;
joined_r0x00092220:
    do {
        while (pbVar2 = param_1, pbVar4 = pbVar6, pbVar6 = pbVar4 + 1,
               uVar5 == uVar8) {
            *pbVar2 = 0;
            while (true) {
                while ((uVar8 = (uint)*pbVar6,
                        uVar8 < 0x80 && ((*(uint *)(&DAT_000af184 + uVar8 * 4) &
                                          0xc01) != 0))) {
                    pbVar6 = pbVar6 + 1;
                    if (uVar8 == 10) {
                        *param_2 = *param_2 + 1;
                    }
                }
                if (uVar8 == 0x27)
                    goto LAB_00092370;
                if (uVar8 != 0x2f)
                    break;
                if (pbVar6[1] == 0x2a) {
                    pbVar4 = (byte *)strstr((char *)(pbVar6 + 2), "*/");
                    if (pbVar4 == (byte *)0x0)
                        goto LAB_000922a4;
                    if (pbVar6 < pbVar4) {
                        pbVar6 = pbVar6 + 1;
                        while (pbVar4 != pbVar6) {
                            pbVar7 = pbVar6 + 1;
                            bVar1 = *pbVar6;
                            pbVar6 = pbVar7;
                            if (bVar1 == 10) {
                                *param_2 = *param_2 + 1;
                            }
                        }
                    }
                    pbVar6 = pbVar4 + 2;
                } else if ((pbVar6[1] != 0x2f) ||
                           (pbVar6 = (byte *)strchr((char *)pbVar6, 10),
                            pbVar6 == (byte *)0x0))
                    goto LAB_000922a4;
            }
            if (uVar8 != 0x22)
                goto LAB_000922a8;
        LAB_00092370:
            uVar5 = (uint)pbVar6[1];
            pbVar6 = pbVar6 + 1;
            param_1 = pbVar2;
        }
        *pbVar2 = (byte)uVar5;
        param_1 = pbVar2 + 1;
        if (uVar5 != 10) {
            if (uVar5 == 0x5c) {
                uVar5 = (uint)pbVar4[1];
                if (uVar5 == 10) {
                    *param_2 = *param_2 + 1;
                    uVar5 = (uint)pbVar4[2];
                    pbVar6 = pbVar4 + 2;
                    param_1 = pbVar2;
                } else if (uVar8 == 0x27) {
                    if (((uVar5 == 0x27) || (uVar5 == 0x5c)) ||
                        (uVar5 == 0x23)) {
                        *pbVar2 = pbVar4[1];
                        uVar5 = (uint)pbVar4[2];
                        pbVar6 = pbVar4 + 2;
                    }
                } else {
                    iVar3 = FUN_00091ddc(pbVar6, pbVar2, 10);
                    if (iVar3 == 0)
                        goto LAB_000922a4;
                    uVar5 = (uint)pbVar6[iVar3];
                    pbVar6 = pbVar6 + iVar3;
                }
            } else {
                if (uVar5 == 0) {
                LAB_000922a4:
                    pbVar6 = (byte *)0x0;
                LAB_000922a8:
                    if (local_2c != __stack_chk_guard) {
                        /* WARNING: Subroutine does not return */
                        __stack_chk_fail(pbVar6);
                    }
                    return;
                }
                uVar5 = (uint)pbVar4[1];
            }
            goto joined_r0x00092220;
        }
        *param_2 = *param_2 + 1;
        uVar5 = (uint)pbVar4[1];
    } while (true);
}

void FUN_000935b8(int param_1)

{
    int iVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 uVar4;

    iVar1 = __stack_chk_guard;
    uVar4 = *(undefined4 *)(param_1 + 0x18);
    (**(code **)(param_1 + 0x28))(3, param_1);
    iVar2 = __stack_chk_guard;
    uVar3 = *(undefined4 *)(param_1 + 0x18);
    *(undefined4 *)(param_1 + 0x18) = uVar4;
    if (iVar1 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_0009361c(int param_1, int param_2, undefined4 *param_3, uint param_4)

{
    char cVar1;
    int iVar2;
    size_t sVar3;
    undefined1 *puVar4;
    undefined1 *puVar5;
    uint uVar6;
    uint uVar7;
    byte *__s1;
    byte *pbVar8;
    size_t sVar9;
    uint uVar10;
    char *__s;
    int iVar11;
    bool bVar12;
    uint local_c8;
    byte *local_b0;
    undefined1 uStack_ac;
    undefined1 auStack_ab[127];
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_1 == 2) {
        uVar6 = *(uint *)(param_2 + 0x1c) & ~(-1 << (param_4 & 0xff));
        if (uVar6 != 0) {
            uVar7 = 0;
            iVar11 = 0;
            do {
                if ((uVar6 & 1) != 0) {
                    bVar12 = iVar11 != 0;
                    iVar11 = iVar11 + 1;
                    if (bVar12) {
                        fwrite(&DAT_000afff0, 1, 3, stdout);
                    }
                    fputs((char *)param_3[uVar7], stdout);
                }
                uVar7 = uVar7 + 1;
            } while ((uVar7 < param_4) && (uVar6 = uVar6 >> 1, uVar6 != 0));
        }
        goto LAB_00093834;
    }
    if (param_1 == 3) {
        uVar6 = *(uint *)(param_2 + 0x1c) & ~(-1 << (param_4 & 0xff));
        if (uVar6 == 0) {
            puVar4 = (undefined1 *)malloc(1);
            if (puVar4 != (undefined1 *)0x0) {
                *(undefined1 **)(param_2 + 0x18) = puVar4;
                *puVar4 = 0;
                goto LAB_00093834;
            }
            sVar9 = 1;
        } else {
            sVar9 = 1;
            uVar10 = 0;
            uVar7 = uVar6;
            do {
                if ((uVar7 & 1) != 0) {
                    sVar3 = strlen((char *)param_3[uVar10]);
                    sVar9 = sVar3 + sVar9 + 4;
                }
                uVar10 = uVar10 + 1;
            } while ((uVar10 < param_4) && (uVar7 = uVar7 >> 1, uVar7 != 0));
            puVar4 = (undefined1 *)malloc(sVar9);
            if (puVar4 != (undefined1 *)0x0) {
                *(undefined1 **)(param_2 + 0x18) = puVar4;
                do {
                    uVar7 = uVar6 & 1;
                    uVar6 = uVar6 >> 1;
                    if (uVar7 != 0) {
                        __s = (char *)*param_3;
                        sVar9 = strlen(__s);
                        memcpy(puVar4, __s, sVar9);
                        puVar5 = puVar4 + sVar9;
                        if (uVar6 == 0)
                            goto code_r0x0009391c;
                        *(undefined2 *)(puVar4 + sVar9) = 0x2b20;
                        puVar4 = puVar5 + 3;
                        puVar5[2] = 0x20;
                    }
                    param_3 = param_3 + 1;
                } while (true);
            }
        }
        /* WARNING: Subroutine does not return */
        FUN_0001c610(sVar9);
    }
    if (param_1 == 1) {
        FUN_0008c924();
        goto LAB_00093834;
    }
    if ((*(uint *)(param_2 + 0x10) & 8) != 0)
        goto LAB_00093834;
    __s1 = *(byte **)(param_2 + 0x18);
    local_c8 = *(uint *)(param_2 + 0x1c);
    iVar11 = DAT_00117334;
    if (DAT_00117334 == 0) {
        iVar11 = FUN_0008e2f8(0xc);
    }
    uVar6 = (uint)*__s1;
    cVar1 = *(char *)(iVar11 + uVar6);
    while (cVar1 != '\0') {
        __s1 = __s1 + 1;
        uVar6 = (uint)*__s1;
        cVar1 = *(char *)(iVar11 + uVar6);
    }
    if (uVar6 != 0) {
        if (uVar6 == 0x3d) {
            iVar11 = DAT_00117334;
            if (DAT_00117334 == 0) {
                iVar11 = FUN_0008e2f8(0xc);
            }
            uVar6 = (uint)__s1[1];
            cVar1 = *(char *)(iVar11 + uVar6);
            __s1 = __s1 + 1;
            while (cVar1 != '\0') {
                __s1 = __s1 + 1;
                uVar6 = (uint)*__s1;
                cVar1 = *(char *)(iVar11 + uVar6);
            }
            if (uVar6 != 0x3d) {
                if (uVar6 == 0x5e) {
                    local_c8 = 0;
                    goto LAB_00093b68;
                }
                if (uVar6 != 0x2c) {
                    bVar12 = false;
                    local_c8 = 0;
                    goto LAB_000936dc;
                }
            }
        } else if (uVar6 == 0x5e) {
        LAB_00093b68:
            iVar11 = DAT_00117334;
            if (DAT_00117334 == 0) {
                iVar11 = FUN_0008e2f8(0xc);
            }
            uVar6 = (uint)__s1[1];
            cVar1 = *(char *)(iVar11 + uVar6);
            __s1 = __s1 + 1;
            while (cVar1 != '\0') {
                __s1 = __s1 + 1;
                uVar6 = (uint)*__s1;
                cVar1 = *(char *)(iVar11 + uVar6);
            }
            if (uVar6 != 0x2c) {
                bVar12 = true;
                goto LAB_000936dc;
            }
        } else if (uVar6 != 0x2c) {
            bVar12 = false;
        LAB_000936dc:
            uVar6 = (uint)*__s1;
            while (uVar6 != 0) {
                if (uVar6 == 0x2c) {
                    iVar11 = DAT_00117334;
                    if (DAT_00117334 == 0) {
                        iVar11 = FUN_0008e2f8(0xc);
                    }
                    uVar6 = (uint)__s1[1];
                    cVar1 = *(char *)(iVar11 + uVar6);
                    __s1 = __s1 + 1;
                    while (cVar1 != '\0') {
                        __s1 = __s1 + 1;
                        uVar6 = (uint)*__s1;
                        cVar1 = *(char *)(iVar11 + uVar6);
                    }
                    if (uVar6 == 0x7c || uVar6 == 0x2c)
                        goto LAB_000939a4;
                    uVar6 = (uint)*__s1;
                } else {
                    if (uVar6 < 0x2d) {
                        if (uVar6 == 0x21) {
                        LAB_00093ac4:
                            iVar11 = 1;
                            goto LAB_00093730;
                        }
                        if (uVar6 == 0x2b)
                            goto LAB_0009372c;
                    LAB_00093a6c:
                        iVar11 = 0;
                    } else {
                        if (uVar6 == 0x2d)
                            goto LAB_00093ac4;
                        if (uVar6 != 0x7c)
                            goto LAB_00093a6c;
                    LAB_0009372c:
                        iVar11 = 0;
                    LAB_00093730:
                        iVar2 = DAT_00117334;
                        if (DAT_00117334 == 0) {
                            iVar2 = FUN_0008e2f8(0xc);
                        }
                        cVar1 = *(char *)(iVar2 + (uint)__s1[1]);
                        __s1 = __s1 + 1;
                        while (cVar1 != '\0') {
                            __s1 = __s1 + 1;
                            cVar1 = *(char *)(iVar2 + (uint)*__s1);
                        }
                    }
                    iVar2 = DAT_001173ac;
                    if (DAT_001173ac == 0) {
                        iVar2 = FUN_0008e2f8(0x2a);
                    }
                    if ((*__s1 == 0) ||
                        (pbVar8 = __s1, *(char *)(iVar2 + (uint)*__s1) != '\0'))
                        break;
                    do {
                        pbVar8 = pbVar8 + 1;
                        if (*pbVar8 == 0)
                            break;
                    } while (*(char *)(iVar2 + (uint)*pbVar8) == '\0');
                    sVar9 = (int)pbVar8 - (int)__s1;
                    if (sVar9 == 0)
                        break;
                    if (sVar9 == 3) {
                        iVar2 = strncmp((char *)__s1, "all", 3);
                        if (iVar2 != 0)
                            goto LAB_000939dc;
                        local_c8 = iVar11 - 1;
                    } else if ((sVar9 == 4) &&
                               (iVar2 = strncmp((char *)__s1, "none", 4),
                                iVar2 == 0)) {
                        if (iVar11 == 0) {
                            local_c8 = 0;
                        }
                    } else {
                    LAB_000939dc:
                        uVar6 = strtoul((char *)__s1, (char **)&local_b0, 0);
                        if (local_b0 != pbVar8) {
                            memcpy(&uStack_ac, local_b0, sVar9);
                            auStack_ab[sVar9 - 1] = 0;
                            uVar6 = FUN_0008cc34(&uStack_ac, param_1, param_2,
                                                 param_3, param_4);
                            if ((param_4 <= uVar6) ||
                                (uVar6 = 1 << (uVar6 & 0xff), uVar6 == 0))
                                goto LAB_000939a4;
                        }
                        if (iVar11 == 0) {
                            local_c8 = local_c8 | uVar6;
                        } else {
                            local_c8 = local_c8 & ~uVar6;
                        }
                    }
                    iVar11 = DAT_00117334;
                    if (DAT_00117334 == 0) {
                        iVar11 = FUN_0008e2f8(0xc);
                    }
                    uVar6 = (uint)*pbVar8;
                    cVar1 = *(char *)(iVar11 + uVar6);
                    __s1 = pbVar8;
                    while (cVar1 != '\0') {
                        __s1 = __s1 + 1;
                        uVar6 = (uint)*__s1;
                        cVar1 = *(char *)(iVar11 + uVar6);
                    }
                }
            }
            if (bVar12) {
                local_c8 = ~local_c8;
            }
            if (param_4 < 0x20) {
                local_c8 = local_c8 & ~(-1 << (param_4 & 0xff));
            }
            *(uint *)(param_2 + 0x1c) = local_c8;
            goto LAB_00093834;
        }
    }
LAB_000939a4:
    *(undefined4 *)(param_2 + 0x1c) = 0;
LAB_00093834:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
code_r0x0009391c:
    *puVar5 = 0;
    goto LAB_00093834;
}

void FUN_00093f7c(char *param_1, char *param_2, char *param_3, char *param_4)

{
    int iVar1;
    char *pcVar2;
    char *pcVar3;
    int iVar4;
    size_t sVar5;
    size_t sVar6;
    char cVar7;
    uint uVar8;
    bool bVar9;
    byte *__s;
    int local_38;

    iVar1 = __stack_chk_guard;
    pcVar2 = (char *)strlen(param_3);
    if (pcVar2 != (char *)0x0 && pcVar2 < param_2) {
        bVar9 = false;
        cVar7 = *param_3;
        pcVar2 = param_1;
        pcVar3 = param_2;
        if (cVar7 == '$') {
            uVar8 = (uint)(byte)param_3[1];
            if (uVar8 == 0x24) {
                if (param_3[2] == '\0') {
                    local_38 = 2;
                } else {
                    if (param_3[2] != '/')
                        goto LAB_00094080;
                    local_38 = 3;
                }
                pcVar3 = strchr(param_4, 0x2f);
                pcVar2 = param_4;
                if (pcVar3 == (char *)0x0) {
                    pcVar2 = getenv("PATH");
                    pcVar2 = (char *)FUN_0008f9cc(pcVar2, param_4);
                    if (pcVar2 == (char *)0x0)
                        goto LAB_0009407c;
                }
                pcVar3 = strrchr(pcVar2, 0x2f);
                if (pcVar3 != (char *)0x0) {
                    sVar5 = strlen(param_3 + local_38);
                    pcVar3 = pcVar3 + (1 - (int)pcVar2);
                    if (pcVar3 + sVar5 < param_2) {
                        memcpy(param_1, pcVar2, (size_t)pcVar3);
                        strcpy(param_1 + (int)pcVar3, param_3 + local_38);
                        if (param_4 != pcVar2) {
                            free(pcVar2);
                        }
                        goto LAB_00094004;
                    }
                }
            } else if (uVar8 == 0x40) {
                if ((*DAT_000c8604 != '\0') &&
                    (iVar4 = FUN_0007c054(param_1, param_2, "%s%s",
                                          DAT_000c8604, param_3 + 2),
                     iVar4 < (int)param_2))
                    goto LAB_00094004;
            } else {
                if (uVar8 == 0)
                    goto LAB_00094080;
                __s = (byte *)(param_3 + 1);
                if ((uVar8 < 0x80) &&
                    ((*(uint *)(&DAT_000af184 + uVar8 * 4) & 0x3b0060) != 0)) {
                    do {
                        pcVar3 = pcVar2 + 1;
                        *pcVar2 = (char)uVar8;
                        __s = __s + 1;
                        uVar8 = (uint)*__s;
                        if (0x7f < uVar8)
                            break;
                        pcVar2 = pcVar3;
                    } while (
                        (*(uint *)(&DAT_000af184 + uVar8 * 4) & 0x3b0060) != 0);
                    if (param_1 != pcVar3) {
                        *pcVar3 = '\0';
                        pcVar2 = getenv(param_1);
                        if (pcVar2 != (char *)0x0) {
                            sVar5 = strlen(pcVar2);
                            sVar6 = strlen((char *)__s);
                            if ((char *)(sVar5 + sVar6 + 1) < param_2) {
                                sprintf(param_1, "%s%s", pcVar2, __s);
                                goto LAB_00094004;
                            }
                        }
                    }
                }
            }
        } else {
            while (true) {
                *pcVar2 = cVar7;
                if (cVar7 == '\0')
                    break;
                if ((int)(pcVar3 + -1) < 1)
                    goto LAB_0009407c;
                param_3 = param_3 + 1;
                cVar7 = *param_3;
                pcVar2 = pcVar2 + 1;
                pcVar3 = pcVar3 + -1;
            }
        LAB_00094004:
            pcVar2 = canonicalize_file_name(param_1);
            if (pcVar2 != (char *)0x0) {
                pcVar3 = (char *)strlen(pcVar2);
                bVar9 = pcVar3 < param_2;
                if (bVar9) {
                    memcpy(param_1, pcVar2, (size_t)(pcVar3 + 1));
                }
                free(pcVar2);
                goto LAB_00094080;
            }
        }
    }
LAB_0009407c:
    bVar9 = false;
LAB_00094080:
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(bVar9);
}

void FUN_00094264(undefined4 *param_1, char *param_2, undefined4 param_3)

{
    int iVar1;
    char *pcVar2;
    undefined4 *puVar3;
    char *__filename;
    stat64 sStack_1098;
    char acStack_1030[4100];
    int local_2c;

    local_2c = __stack_chk_guard;
    fputs((char *)option_xlateable_txt._352_4_, option_usage_fp);
    pcVar2 = (char *)*param_1;
    if (pcVar2 != (char *)0x0) {
        puVar3 = param_1 + 1;
        do {
            iVar1 = FUN_00093f7c(acStack_1030, 0x1001, pcVar2, param_3);
            __filename = pcVar2;
            if (((iVar1 != 0) && (__filename = acStack_1030, *pcVar2 == '$')) &&
                (pcVar2[1] == '@' || pcVar2[1] == '$')) {
                pcVar2 = acStack_1030;
            }
            fprintf(option_usage_fp, (char *)option_xlateable_txt._340_4_,
                    pcVar2);
            if (((*param_2 != '\0') &&
                 (iVar1 = __xstat64(3, __filename, &sStack_1098),
                  iVar1 == 0)) &&
                ((sStack_1098.st_mode & 0xf000) == 0x4000)) {
                fputc(0x2f, option_usage_fp);
                fputs(param_2, option_usage_fp);
            }
            fputc(10, option_usage_fp);
            pcVar2 = (char *)*puVar3;
            puVar3 = puVar3 + 1;
        } while (pcVar2 != (char *)0x0);
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_00094784(byte *param_1, char *param_2)

{
    byte bVar1;
    int iVar2;
    size_t __n;
    undefined1 *puVar3;
    uint uVar4;
    int iVar5;
    size_t __size;
    byte *pbVar6;
    byte *pbVar7;

    iVar2 = __stack_chk_guard;
    __size = 3;
    __n = strlen(param_2);
    pbVar6 = param_1;
LAB_000947c4:
    bVar1 = *pbVar6;
    while (true) {
        uVar4 = (uint)bVar1;
        pbVar6 = pbVar6 + 1;
        if (0x5e < uVar4 - 0x20)
            break;
        if (uVar4 == 0x5c || uVar4 == 0x22) {
            iVar5 = 2;
        } else {
            iVar5 = 1;
        }
        __size = __size + iVar5;
        bVar1 = *pbVar6;
    }
    switch (uVar4) {
    case 0:
        goto LAB_0009484c;
    case 1:
        break;
    case 2:
        break;
    case 3:
        break;
    case 4:
        break;
    case 5:
        break;
    case 6:
        break;
    case 7:
        goto LAB_00094844;
    case 8:
        goto LAB_00094844;
    case 9:
        goto LAB_00094844;
    case 10:
        goto LAB_0009483c;
    case 0xb:
        goto LAB_00094844;
    case 0xc:
        goto LAB_00094844;
    case 0xd:
    LAB_00094844:
        __size = __size + 2;
        goto LAB_000947c4;
    }
    __size = __size + 4;
    goto LAB_000947c4;
LAB_0009483c:
    __size = __size + __n;
    goto LAB_000947c4;
LAB_0009484c:
    puVar3 = (undefined1 *)malloc(__size);
    if (puVar3 == (undefined1 *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0001c610(__size);
    }
    pbVar6 = puVar3 + 1;
    *puVar3 = 0x22;
LAB_00094898:
    do {
        bVar1 = *param_1;
        uVar4 = (uint)bVar1;
        if (uVar4 - 0x20 < 0x5f) {
            pbVar7 = pbVar6 + 1;
            if (uVar4 == 0x5c || uVar4 == 0x22) {
                *pbVar6 = 0x5c;
                pbVar7 = pbVar6 + 2;
                pbVar6 = pbVar6 + 1;
            }
            *pbVar6 = bVar1;
            pbVar6 = pbVar7;
            goto LAB_00094894;
        }
        switch (uVar4) {
        case 0:
            goto LAB_0009493c;
        case 1:
            break;
        case 2:
            break;
        case 3:
            break;
        case 4:
            break;
        case 5:
            break;
        case 6:
            break;
        case 7:
            *pbVar6 = 0x5c;
            pbVar6[1] = 0x61;
            pbVar6 = pbVar6 + 2;
            goto LAB_00094894;
        case 8:
            *pbVar6 = 0x5c;
            pbVar6[1] = 0x62;
            pbVar6 = pbVar6 + 2;
            goto LAB_00094894;
        case 9:
            *pbVar6 = 0x5c;
            pbVar6[1] = 0x74;
            pbVar6 = pbVar6 + 2;
            goto LAB_00094894;
        case 10:
            bVar1 = param_1[1];
            param_1 = param_1 + 1;
            pbVar7 = pbVar6;
            while (bVar1 == 10) {
                param_1 = param_1 + 1;
                bVar1 = *param_1;
                *pbVar7 = 0x5c;
                pbVar7[1] = 0x6e;
                pbVar7 = pbVar7 + 2;
            }
            if (bVar1 != 0)
                goto LAB_00094a20;
            pbVar6 = pbVar7 + 2;
            *pbVar7 = 0x5c;
            pbVar7[1] = 0x6e;
        LAB_0009493c:
            *pbVar6 = 0x22;
            iVar5 = __stack_chk_guard;
            pbVar6[1] = 0;
            if (iVar2 == iVar5) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail(puVar3);
        case 0xb:
            *pbVar6 = 0x5c;
            pbVar6[1] = 0x76;
            pbVar6 = pbVar6 + 2;
            goto LAB_00094894;
        case 0xc:
            *pbVar6 = 0x5c;
            pbVar6[1] = 0x66;
            pbVar6 = pbVar6 + 2;
            goto LAB_00094894;
        case 0xd:
            *pbVar6 = 0x5c;
            pbVar6[1] = 0x72;
            pbVar6 = pbVar6 + 2;
            goto LAB_00094894;
        }
        sprintf((char *)pbVar6, "\\%03o");
        pbVar6 = pbVar6 + 4;
    LAB_00094894:
        param_1 = param_1 + 1;
    } while (true);
LAB_00094a20:
    pbVar6 = pbVar7 + __n;
    memcpy(pbVar7, param_2, __n);
    goto LAB_00094898;
}

void FUN_00094a50(undefined4 param_1, FILE *param_2)

{
    int iVar1;
    void *__ptr;

    iVar1 = __stack_chk_guard;
    __ptr = (void *)FUN_00094784(param_1, &DAT_000aff4d);
    fprintf(param_2, "  puts(_(%s));\n", __ptr);
    if (iVar1 == __stack_chk_guard) {
        free(__ptr);
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00094ad0(int param_1)

{
    undefined4 *puVar1;
    char cVar2;
    int iVar3;
    uint uVar4;
    __int32_t **pp_Var5;
    undefined4 uVar6;
    undefined4 uVar7;
    uint uVar8;
    int iVar9;
    int iVar10;
    int iVar11;
    char *pcVar12;
    uint uVar13;
    byte *pbVar14;
    int *piVar15;
    int *piVar16;
    byte *__ptr;
    byte *pbVar17;

    iVar3 = __stack_chk_guard;
    uVar13 = 0;
    printf("OPTION_CT=%d\nexport OPTION_CT\n", *(int *)(param_1 + 0x10) + -1);
LAB_00094b54:
    iVar10 = *(int *)(param_1 + 0x44) + uVar13 * 0x40;
    uVar8 = *(uint *)(iVar10 + 0x10);
    if (((uVar8 & 0x8280000) == 0) && (*(short *)(iVar10 + 8) == -0x8000)) {
        iVar11 = iVar10;
        if (*(ushort *)(iVar10 + 4) != uVar13) {
            iVar11 = *(int *)(param_1 + 0x44) +
                     (uint) * (ushort *)(iVar10 + 4) * 0x40;
            uVar6 = *(undefined4 *)(iVar10 + 0x30);
            *(undefined4 *)(iVar11 + 0x18) = *(undefined4 *)(iVar10 + 0x18);
            uVar8 = *(uint *)(iVar11 + 0x10) & 0xfffff00;
            *(uint *)(iVar11 + 0x10) = uVar8;
            *(uint *)(iVar11 + 0x10) =
                *(uint *)(iVar10 + 0x10) & 0xf00000ff | uVar8;
            printf("%1$s_%2$s_MODE=\'%3$s\'\nexport %1$s_%2$s_MODE\n",
                   *(undefined4 *)(param_1 + 0x20), uVar6,
                   *(undefined4 *)(iVar11 + 0x30));
            uVar8 = *(uint *)(iVar11 + 0x10);
        }
        uVar4 = (uVar8 << 0x10) >> 0x1c;
        if (uVar4 == 4) {
            uVar6 = *(undefined4 *)(iVar11 + 0x18);
            printf("%1$s_%2$s=%3$d # 0x%3$X\nexport %1$s_%2$s\n",
                   *(undefined4 *)(param_1 + 0x20),
                   *(undefined4 *)(iVar11 + 0x30),
                   *(undefined4 *)(iVar11 + 0x1c));
            *(undefined4 *)(iVar11 + 0x1c) = 0xffffffff;
            (**(code **)(iVar11 + 0x28))(3, iVar11);
            __ptr = *(byte **)(iVar11 + 0x18);
            if (*__ptr != 0) {
                iVar10 = 1;
                do {
                    printf("readonly %s_", *(undefined4 *)(iVar11 + 0x30));
                    iVar9 = DAT_0011738c;
                    if (DAT_0011738c == 0) {
                        iVar9 = FUN_0008e2f8(0x22);
                    }
                    uVar8 = (uint)*__ptr;
                    cVar2 = *(char *)(iVar9 + uVar8);
                    pbVar14 = __ptr;
                    while (cVar2 != '\0') {
                        pbVar14 = pbVar14 + 1;
                        uVar8 = (uint)*pbVar14;
                        cVar2 = *(char *)(iVar9 + uVar8);
                    }
                LAB_00094efc:
                    pbVar17 = pbVar14 + 1;
                    if (0x7f < uVar8) {
                    LAB_00094f08:
                        __ptr = pbVar14;
                        if (uVar8 == 0)
                            goto LAB_00094f34;
                        fputc(0x5f, stdout);
                    LAB_00094ef4:
                        uVar8 = (uint)*pbVar17;
                        pbVar14 = pbVar17;
                        goto LAB_00094efc;
                    }
                    uVar4 = *(uint *)(&DAT_000af184 + uVar8 * 4);
                    if ((uVar4 & 0x80000) != 0) {
                        pp_Var5 = __ctype_toupper_loc();
                        fputc((*pp_Var5)[uVar8], stdout);
                        goto LAB_00094ef4;
                    }
                    if ((uVar4 & 0x100000) != 0) {
                        fputc(uVar8, stdout);
                        goto LAB_00094ef4;
                    }
                    __ptr = pbVar17;
                    if ((uVar4 & 0xc81) == 0)
                        goto LAB_00094f08;
                LAB_00094f34:
                    printf("=%1$lu # 0x%1$lX\n", iVar10);
                    iVar10 = iVar10 << 1;
                } while (*__ptr != 0);
                __ptr = *(byte **)(iVar11 + 0x18);
            }
            uVar13 = uVar13 + 1;
            free(__ptr);
            *(undefined4 *)(iVar11 + 0x18) = uVar6;
            if (*(int *)(param_1 + 0x68) <= (int)uVar13) {
            LAB_00094c6c:
                if (((*(uint *)(param_1 + 0xc) & 0x800) != 0) &&
                    (*(uint *)(param_1 + 0x10) < *(uint *)(param_1 + 4))) {
                    fwrite("set --", 1, 6, stdout);
                    uVar13 = *(uint *)(param_1 + 0x10);
                    if (uVar13 < *(uint *)(param_1 + 4)) {
                        iVar10 = uVar13 << 2;
                        do {
                            fputc(0x20, stdout);
                            uVar13 = uVar13 + 1;
                            puVar1 =
                                (undefined4 *)(*(int *)(param_1 + 8) + iVar10);
                            iVar10 = iVar10 + 4;
                            FUN_0008de38(*puVar1);
                        } while (uVar13 < *(uint *)(param_1 + 4));
                    }
                    fwrite("\nOPTION_CT=0\n", 1, 0xd, stdout);
                }
                if (iVar3 == __stack_chk_guard) {
                    fflush(stdout);
                    return;
                }
                /* WARNING: Subroutine does not return */
                __stack_chk_fail();
            }
            goto LAB_00094b54;
        }
        if ((uVar8 & 0x2f) != 0x20) {
            uVar6 = *(undefined4 *)(param_1 + 0x20);
            uVar7 = *(undefined4 *)(iVar11 + 0x30);
            if (((uVar8 & 0x400) != 0) &&
                (piVar15 = *(int **)(iVar11 + 0x1c), piVar15 != (int *)0x0)) {
                piVar16 = piVar15 + 2;
                iVar10 = *piVar15;
                printf("%1$s_%2$s_CT=%3$d\nexport %1$s_%2$s_CT\n", uVar6, uVar7,
                       iVar10);
                iVar10 = iVar10 + -1;
                if (iVar10 < 0)
                    goto LAB_00094c5c;
                do {
                    printf("%s_%s_%d=", *(undefined4 *)(param_1 + 0x20),
                           *(undefined4 *)(iVar11 + 0x30), *piVar15 - iVar10);
                    FUN_0008de38(*piVar16);
                    iVar9 = *piVar15 - iVar10;
                    iVar10 = iVar10 + -1;
                    printf("\nexport %s_%s_%d\n",
                           *(undefined4 *)(param_1 + 0x20),
                           *(undefined4 *)(iVar11 + 0x30), iVar9);
                    piVar16 = piVar16 + 1;
                } while (iVar10 != -1);
                uVar13 = uVar13 + 1;
                if (*(int *)(param_1 + 0x68) <= (int)uVar13)
                    goto LAB_00094c6c;
                goto LAB_00094b54;
            }
            if ((uVar8 & 0x20) != 0) {
                pcVar12 = *(char **)(iVar11 + 0x3c);
                if (pcVar12 == (char *)0x0) {
                    pcVar12 = "false";
                }
                uVar13 = uVar13 + 1;
                printf("%1$s_%2$s=%3$s\nexport %1$s_%2$s\n", uVar6, uVar7,
                       pcVar12);
                if (*(int *)(param_1 + 0x68) <= (int)uVar13)
                    goto LAB_00094c6c;
                goto LAB_00094b54;
            }
            pcVar12 = *(char **)(iVar11 + 0x18);
            if (uVar4 == 5) {
                uVar13 = uVar13 + 1;
                printf("%1$s_%2$s=%3$d # 0x%3$X\nexport %1$s_%2$s\n", uVar6,
                       uVar7, pcVar12);
                if (*(int *)(param_1 + 0x68) <= (int)uVar13)
                    goto LAB_00094c6c;
                goto LAB_00094b54;
            }
            if (uVar4 == 2) {
                printf("%s_%s=", uVar6, uVar7);
                (**(code **)(iVar11 + 0x28))(3, iVar11);
                printf("\'%s\'", *(undefined4 *)(iVar11 + 0x18));
                if ((*(uint *)(iVar11 + 0x10) & 0x40) != 0) {
                    free(*(void **)(iVar11 + 0x18));
                }
                *(char **)(iVar11 + 0x18) = pcVar12;
                printf("\nexport %s_%s\n", *(undefined4 *)(param_1 + 0x20),
                       *(undefined4 *)(iVar11 + 0x30));
            } else {
                if (uVar4 == 3) {
                    if (pcVar12 == (char *)0x0) {
                        pcVar12 = "false";
                    } else {
                        pcVar12 = "true";
                    }
                    uVar13 = uVar13 + 1;
                    printf("%1$s_%2$s=\'%3$s\'\nexport %1$s_%2$s\n", uVar6,
                           uVar7, pcVar12);
                    if (*(int *)(param_1 + 0x68) <= (int)uVar13)
                        goto LAB_00094c6c;
                    goto LAB_00094b54;
                }
                if ((pcVar12 != (char *)0x0) && (*pcVar12 != '\0')) {
                    uVar13 = uVar13 + 1;
                    printf("%s_%s=", uVar6, uVar7);
                    FUN_0008de38(*(undefined4 *)(iVar11 + 0x18));
                    printf("\nexport %s_%s\n", *(undefined4 *)(param_1 + 0x20),
                           *(undefined4 *)(iVar11 + 0x30));
                    if (*(int *)(param_1 + 0x68) <= (int)uVar13)
                        goto LAB_00094c6c;
                    goto LAB_00094b54;
                }
                printf("%1$s_%2$s=%3$d # 0x%3$X\nexport %1$s_%2$s\n", uVar6,
                       uVar7, (uint) * (ushort *)(iVar11 + 0xe));
            }
        }
    }
LAB_00094c5c:
    uVar13 = uVar13 + 1;
    if (*(int *)(param_1 + 0x68) <= (int)uVar13)
        goto LAB_00094c6c;
    goto LAB_00094b54;
}

void FUN_00095318(int *param_1)

{
    char *pcVar1;
    FILE *pFVar2;
    size_t sVar3;
    undefined1 *__ptr;
    int iVar4;
    int *piVar5;
    uint uVar6;
    ushort *puVar7;
    int iVar8;
    int iVar9;
    char *pcVar10;
    ushort *puVar11;
    undefined4 uVar12;
    int iVar13;
    time_t local_30;
    int local_2c;

    local_30 = 0;
    local_2c = __stack_chk_guard;
    pcVar1 = (char *)FUN_0008f530(param_1, &local_30);
    if (pcVar1 != (char *)0x0) {
        pFVar2 = fopen64(pcVar1, "w");
        if (pFVar2 == (FILE *)0x0) {
            fprintf(stderr, (char *)option_xlateable_txt._240_4_, param_1[7]);
            piVar5 = __errno_location();
            pFVar2 = stderr;
            uVar12 = option_xlateable_txt._164_4_;
            iVar8 = *piVar5;
            pcVar10 = strerror(iVar8);
            fprintf(pFVar2, (char *)uVar12, iVar8, pcVar10, pcVar1);
            if (local_30 != 0) {
                free(pcVar1);
            }
        } else {
            if (local_30 != 0) {
                free(pcVar1);
            }
            fwrite(&DAT_000b2934, 1, 3, pFVar2);
            pcVar10 = (char *)param_1[0xe];
            pcVar1 = strchr(pcVar10, 10);
            if (pcVar1 != (char *)0x0) {
                fwrite(pcVar10, 1, (size_t)(pcVar1 + (1 - (int)pcVar10)),
                       pFVar2);
            }
            local_30 = time((time_t *)0x0);
            pcVar1 = ctime(&local_30);
            fprintf(pFVar2, "#  preset/initialization file\n#  %s#\n", pcVar1);
            iVar8 = param_1[0x1a];
            puVar7 = (ushort *)param_1[0x11];
        LAB_00095428:
            do {
                uVar6 = *(uint *)(puVar7 + 8);
                if ((((uVar6 & 0xf) == 0) || ((uVar6 & 0x280100) != 0)) ||
                    ((puVar7[4] != 0x8000 && (*puVar7 != puVar7[4]))))
                    goto switchD_00095470_default;
                puVar11 = puVar7;
                if ((uVar6 & 0x10) != 0) {
                    puVar11 =
                        (ushort *)(param_1[0x11] + (uint)puVar7[2] * 0x40);
                }
                switch ((uVar6 << 0x10) >> 0x1c) {
                case 0:
                    iVar8 = iVar8 + -1;
                    iVar13 = *(int *)(puVar7 + 0x1a);
                    if ((*(uint *)(puVar11 + 8) & 0x20) != 0) {
                        iVar13 = *(int *)(puVar7 + 0x1c);
                    }
                    if (iVar13 == 0) {
                        iVar13 = *(int *)(puVar7 + 0x1a);
                    }
                    fprintf(pFVar2, "%s\n", iVar13);
                    puVar7 = puVar7 + 0x20;
                    if (iVar8 < 1)
                        goto LAB_000954c8;
                    goto LAB_00095428;
                case 1:
                    if ((*(uint *)(puVar11 + 8) & 0x400) == 0)
                        goto LAB_000954ec;
                    piVar5 = *(int **)(puVar11 + 0xe) + 2;
                    iVar13 = **(int **)(puVar11 + 0xe);
                    if (iVar13 < 2) {
                        iVar4 = iVar13 + -1;
                        if (iVar13 < 1)
                            break;
                    } else {
                        iVar4 = iVar13 + -1;
                        *(uint *)(puVar11 + 8) =
                            *(uint *)(puVar11 + 8) & 0xffffffdf;
                    }
                    do {
                        iVar4 = iVar4 + -1;
                        FUN_0008c7a4(pFVar2, puVar11, *piVar5);
                        piVar5 = piVar5 + 1;
                    } while (iVar4 != -1);
                    break;
                case 2:
                    uVar12 = *(undefined4 *)(puVar11 + 0xc);
                    (**(code **)(puVar11 + 0x14))(3, puVar11);
                    FUN_0008c7a4(pFVar2, puVar11,
                                 *(undefined4 *)(puVar11 + 0xc));
                    *(undefined4 *)(puVar11 + 0xc) = uVar12;
                    goto joined_r0x00095658;
                case 3:
                    if (*(int *)(puVar11 + 0xc) == 0) {
                        pcVar1 = "false";
                    } else {
                        pcVar1 = "true";
                    }
                LAB_000954ac:
                    FUN_0008c7a4(pFVar2, puVar11, pcVar1);
                    break;
                case 4:
                    pcVar1 = (char *)FUN_000935b8(puVar11);
                    sVar3 = strlen(pcVar1);
                    __ptr = (undefined1 *)malloc(sVar3 + 3);
                    if (__ptr == (undefined1 *)0x0) {
                        /* WARNING: Subroutine does not return */
                        FUN_0001c610(sVar3 + 3);
                    }
                    *__ptr = 0x3d;
                    memcpy(__ptr + 1, pcVar1, sVar3 + 1);
                    FUN_0008c7a4(pFVar2, puVar11, __ptr);
                    free(__ptr);
                    free(pcVar1);
                    goto joined_r0x00095658;
                case 5:
                LAB_000954ec:
                    FUN_0008c7a4(pFVar2, puVar11,
                                 *(undefined4 *)(puVar11 + 0xc));
                    goto joined_r0x00095658;
                case 6:
                    piVar5 = *(int **)(puVar11 + 0xe);
                    if ((piVar5 != (int *)0x0) &&
                        (iVar13 = *piVar5, 0 < iVar13)) {
                        piVar5 = piVar5 + 2;
                        do {
                            iVar9 = *piVar5;
                            iVar4 = FUN_00091b34(iVar9, 0);
                            if (iVar4 != 0) {
                                fprintf(pFVar2, "<%s type=nested>\n",
                                        *(undefined4 *)(puVar11 + 0x1a));
                                do {
                                    FUN_0008cfa4(pFVar2, 1, puVar11, iVar4);
                                    iVar4 = FUN_00091d14(iVar9, iVar4);
                                } while (iVar4 != 0);
                                fprintf(pFVar2, "</%s>\n",
                                        *(undefined4 *)(puVar11 + 0x1a));
                            }
                            iVar13 = iVar13 + -1;
                            piVar5 = piVar5 + 1;
                        } while (iVar13 != 0);
                    }
                    break;
                case 7:
                    pcVar1 = *(char **)(puVar11 + 0xe);
                    if ((pcVar1 != (char *)0x0) ||
                        ((0x1ffff < *param_1 &&
                          (pcVar1 = *(char **)(puVar11 + 0xc),
                           *(char **)(param_1[0x1d] + (uint)*puVar11 * 4) !=
                               pcVar1))))
                        goto LAB_000954ac;
                }
            switchD_00095470_default:
            joined_r0x00095658:
                iVar8 = iVar8 + -1;
                puVar7 = puVar7 + 0x20;
            } while (0 < iVar8);
        LAB_000954c8:
            fclose(pFVar2);
        }
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00095a88) */

void FUN_000959ec(byte *param_1, byte *param_2, int param_3)

{
    byte *pbVar1;
    byte *pbVar2;
    uint uVar3;

    if (0 < param_3) {
        pbVar1 = param_2;
        do {
            uVar3 = (uint)*param_1;
            pbVar2 = pbVar1 + 1;
            if ((uVar3 != *pbVar1) &&
                ((&DAT_000c816c)[uVar3] != (&DAT_000c816c)[*pbVar1])) {
                return;
            }
            if (uVar3 == 0) {
                return;
            }
            param_1 = param_1 + 1;
            pbVar1 = pbVar2;
        } while (param_2 + param_3 != pbVar2);
    }
    return;
}

void FUN_00095a98(int param_1, char *param_2, int *param_3)

{
    ushort uVar1;
    bool bVar2;
    int iVar3;
    undefined4 uVar4;
    int iVar5;
    int iVar6;
    undefined *puVar7;
    char *pcVar8;
    char *pcVar9;
    int iVar10;
    int iVar11;
    int iVar12;
    size_t sVar13;
    char local_ac[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    pcVar8 = param_2;
    do {
        sVar13 = (int)pcVar8 - (int)param_2;
        pcVar9 = pcVar8 + 1;
        if (*pcVar8 == '\0') {
            pcVar9 = (char *)0x0;
        LAB_00095b14:
            if (1 < (int)sVar13) {
                bVar2 = false;
                iVar6 = 0;
                iVar5 = *(int *)(param_1 + 0x44);
                iVar12 = 0;
                iVar11 = *(int *)(param_1 + 100);
                iVar10 = 0;
                goto LAB_00095b74;
            }
            break;
        }
        if (*pcVar8 == '=') {
            memcpy(local_ac, param_2, sVar13);
            local_ac[sVar13] = '\0';
            param_2 = local_ac;
            goto LAB_00095b14;
        }
        pcVar8 = pcVar9;
    } while (pcVar9 != param_2 + 0x80);
    if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
        fprintf(stderr, (char *)option_xlateable_txt._140_4_,
                *(undefined4 *)(param_1 + 0x1c), param_2);
        goto LAB_00095e54;
    }
    goto LAB_00095bfc;
LAB_00095b74:
    do {
        if ((*(int *)(iVar5 + 0x34) != 0) &&
            (*(uint *)(iVar5 + 0x10) == 0x80100 ||
             (*(uint *)(iVar5 + 0x10) & 0x280000) == 0)) {
            iVar3 = FUN_000959ec(param_2, *(int *)(iVar5 + 0x34), sVar13);
            if (iVar3 == 0) {
                if (*(char *)(*(int *)(iVar5 + 0x34) + sVar13) == '\0')
                    goto LAB_00095d88;
            } else {
                if ((*(int *)(iVar5 + 0x38) == 0) ||
                    (iVar3 =
                         FUN_000959ec(param_2, *(int *)(iVar5 + 0x38), sVar13),
                     iVar3 != 0))
                    goto LAB_00095b64;
                if (*(char *)(*(int *)(iVar5 + 0x38) + sVar13) == '\0') {
                    iVar10 = *(int *)(param_1 + 0x44) + iVar10 * 0x40;
                    if ((*(uint *)(iVar10 + 0x10) & 0x280000) != 0)
                        goto LAB_00095de4;
                    goto LAB_00095e68;
                }
                bVar2 = true;
            }
            iVar12 = iVar12 + 1;
            iVar6 = iVar10;
        }
    LAB_00095b64:
        iVar10 = iVar10 + 1;
        iVar5 = iVar5 + 0x40;
    } while (iVar10 < iVar11);
    if (iVar12 == 0) {
        if (((pcVar9 == (char *)0x0) &&
             ((*(uint *)(param_1 + 0xc) & 3) == 0)) &&
            (uVar1 = *(ushort *)(param_1 + 0x62), uVar1 != 0x8000)) {
            iVar10 = *(int *)(param_1 + 0x44);
            param_3[1] = (int)param_2;
            param_3[3] = 3;
            *param_3 = iVar10 + (uint)uVar1 * 0x40;
            uVar4 = 0;
            goto LAB_00095c00;
        }
        if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
            fprintf(stderr, (char *)option_xlateable_txt._124_4_,
                    *(undefined4 *)(param_1 + 0x18), param_2);
            goto LAB_00095e54;
        }
    } else {
        iVar10 = iVar6;
        if (iVar12 == 1) {
        LAB_00095d88:
            iVar10 = *(int *)(param_1 + 0x44) + iVar10 * 0x40;
            if ((*(uint *)(iVar10 + 0x10) & 0x280000) == 0) {
                if (bVar2) {
                LAB_00095e68:
                    param_3[2] = param_3[2] | 0x20;
                }
                uVar4 = 0;
                *param_3 = iVar10;
                param_3[1] = (int)pcVar9;
                param_3[3] = 2;
                goto LAB_00095c00;
            }
        LAB_00095de4:
            if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
                fprintf(stderr, (char *)option_xlateable_txt._112_4_,
                        *(undefined4 *)(param_1 + 0x1c),
                        *(undefined4 *)(iVar10 + 0x34));
                if (*(int *)(iVar10 + 0x2c) != 0) {
                    fprintf(stderr, " -- %s");
                }
                fputc(10, stderr);
                goto LAB_00095e54;
            }
        } else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
            fprintf(stderr, (char *)option_xlateable_txt._84_4_,
                    *(undefined4 *)(param_1 + 0x18), param_2, iVar12);
            if (iVar12 < 5) {
                sVar13 = strlen(param_2);
                if ((*(uint *)(param_1 + 0xc) & 3) == 0) {
                    puVar7 = &DAT_000a7f7c;
                } else {
                    puVar7 = &UNK_000aff5d;
                }
                iVar10 = 0;
                iVar6 = *(int *)(param_1 + 0x44);
                fputs((char *)option_xlateable_txt._80_4_, stderr);
                do {
                    if (*(int *)(iVar6 + 0x34) != 0) {
                        iVar5 = FUN_000959ec(param_2, *(int *)(iVar6 + 0x34),
                                             sVar13);
                        if (iVar5 == 0) {
                            fprintf(stderr, "  %s%s\n", puVar7,
                                    *(undefined4 *)(iVar6 + 0x34));
                        } else if ((*(int *)(iVar6 + 0x38) != 0) &&
                                   (iVar5 = FUN_000959ec(param_2,
                                                         *(int *)(iVar6 + 0x38),
                                                         sVar13),
                                    iVar5 == 0)) {
                            fprintf(stderr, "  %s%s\n", puVar7,
                                    *(undefined4 *)(iVar6 + 0x38));
                        }
                    }
                    iVar10 = iVar10 + 1;
                    iVar6 = iVar6 + 0x40;
                } while (iVar10 < *(int *)(param_1 + 100));
            }
        LAB_00095e54:
            (**(code **)(param_1 + 0x54))(param_1, 1);
            /* WARNING: Subroutine does not return */
            _exit(1);
        }
    }
LAB_00095bfc:
    uVar4 = 0xffffffff;
LAB_00095c00:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar4);
}

void FUN_00095f40(uint param_1, int *param_2, byte *param_3, int param_4,
                  uint param_5)

{
    char cVar1;
    byte bVar2;
    undefined4 uVar3;
    int iVar4;
    byte *pbVar5;
    int iVar6;
    size_t sVar7;
    void *__ptr;
    uint uVar8;
    uint extraout_r2;
    uint uVar9;
    byte *pbVar10;
    uint extraout_r12;
    bool bVar11;
    undefined8 uVar12;
    undefined4 local_6c;
    undefined4 local_68;
    undefined4 local_64;
    undefined4 local_60;
    int local_5c;
    byte *pbStack_54;
    int *piStack_50;
    byte *pbStack_4c;
    undefined4 *puStack_48;
    uint uStack_44;
    uint uStack_40;
    code *UNRECOVERED_JUMPTABLE;
    byte *local_34;
    int local_2c;

    local_2c = __stack_chk_guard;
    iVar6 = DAT_001173b8;
    if (DAT_001173b8 == 0) {
        iVar6 = FUN_0008e2f8(0x2d);
    }
    cVar1 = *(char *)(iVar6 + (uint)*param_3);
    while (cVar1 != '\0') {
        param_3 = param_3 + 1;
        cVar1 = *(char *)(iVar6 + (uint)*param_3);
    }
    pbVar5 = (byte *)strpbrk((char *)param_3, " \t\n:=");
    if (pbVar5 == (byte *)0x0) {
        sVar7 = strlen((char *)param_3);
        pbVar10 = param_3 + sVar7;
    } else {
        pbVar10 = pbVar5 + 1;
        if (param_5 == 2) {
            *pbVar5 = 0;
        } else {
            if (*pbVar5 < 0x80) {
                if ((*(uint *)(&DAT_000af184 + (uint)*pbVar5 * 4) & 0xc01) ==
                    0) {
                    bVar11 = false;
                } else {
                    bVar11 = true;
                }
            } else {
                bVar11 = false;
            }
            *pbVar5 = 0;
            iVar6 = DAT_00117334;
            if (DAT_00117334 == 0) {
                local_34 = pbVar5;
                iVar6 = FUN_0008e2f8(0xc);
                pbVar5 = local_34;
            }
            uVar9 = (uint)pbVar5[1];
            cVar1 = *(char *)(iVar6 + uVar9);
            while (cVar1 != '\0') {
                pbVar10 = pbVar10 + 1;
                uVar9 = (uint)*pbVar10;
                cVar1 = *(char *)(iVar6 + uVar9);
            }
            if ((bVar11) && (uVar9 == 0x3d || uVar9 == 0x3a)) {
                iVar6 = DAT_00117334;
                if (DAT_00117334 == 0) {
                    iVar6 = FUN_0008e2f8(0xc);
                }
                cVar1 = *(char *)(iVar6 + (uint)pbVar10[1]);
                pbVar10 = pbVar10 + 1;
                while (cVar1 != '\0') {
                    pbVar10 = pbVar10 + 1;
                    cVar1 = *(char *)(iVar6 + (uint)*pbVar10);
                }
            }
        }
    }
    if ((param_3[1] < 0x80) &&
        ((*(uint *)(&DAT_000af184 + (uint)param_3[1] * 4) & 0x3b0040) != 0)) {
        iVar6 = FUN_00095a98(param_1, param_3, param_2);
        if (iVar6 != 0)
            goto LAB_00096100;
        if (param_4 != 0)
            goto LAB_00096118;
    LAB_000960a4:
        if ((*pbVar10 == 0x22) || (*pbVar10 == 0x27))
            goto LAB_00096224;
        param_2[1] = (int)pbVar10;
    } else {
        iVar6 = FUN_0008dff0(param_1, *param_3, param_2, param_2 + 3);
        if (iVar6 != 0)
            goto LAB_00096100;
        if (param_4 == 0)
            goto LAB_000960a4;
    LAB_00096118:
        uVar9 = param_2[2];
        if ((uVar9 & 0x100) != 0)
            goto LAB_00096100;
        if ((*pbVar10 == 0x22) || (*pbVar10 == 0x27)) {
        LAB_00096224:
            FUN_000921c8(pbVar10, 0);
            param_2[1] = (int)pbVar10;
            uVar9 = param_2[2];
            if (param_4 == 0)
                goto LAB_000960bc;
        } else {
            param_2[1] = (int)pbVar10;
        }
        uVar8 = uVar9 & 0x60000;
        if (uVar8 == 0x20000) {
            if (param_4 < 0) {
            LAB_0009628c:
                if ((uVar9 & 0x20) == 0)
                    goto LAB_00096100;
            } else {
            LAB_000962a4:
                if ((uVar9 & 0x20) != 0)
                    goto LAB_00096100;
            }
        } else if (uVar8 < 0x20001) {
            if ((uVar8 == 0) && (param_4 < 0))
                goto LAB_00096100;
        } else {
            if (uVar8 == 0x40000) {
                if (param_4 < 0)
                    goto LAB_000962a4;
                goto LAB_0009628c;
            }
            if ((uVar8 == 0x60000) && (0 < param_4))
                goto LAB_00096100;
        }
    }
LAB_000960bc:
    bVar2 = *pbVar10;
    if ((*(uint *)(*param_2 + 0x10) & 0xf000) == 0) {
        if (bVar2 != 0)
            goto LAB_00096100;
    LAB_000960d8:
        param_2[1] = 0;
    } else if ((*(uint *)(*param_2 + 0x10) & 0x10000) == 0) {
        if (bVar2 != 0)
            goto LAB_000961ac;
        param_2[1] = (int)&DAT_000af3d8;
    } else {
        if (bVar2 == 0)
            goto LAB_000960d8;
    LAB_000961ac:
        iVar6 = __strdup(pbVar10);
        bVar11 = iVar6 == 0;
        if (bVar11) {
            uVar12 = FUN_0008e624(pbVar10);
            /* WARNING: Could not recover jumptable at 0x000962c8. Too many
             * branches */
            /* WARNING: Treating indirect jump as call */
            if (bVar11) {
                (*(code *)(extraout_r2 & param_1 << ((uint)pbVar10 & 0xff)))();
                return;
            }
            if (bVar11) {
                uVar9 = (uint)uVar12 & extraout_r12 >> 0x10 &
                        (int)extraout_r12 >> 0x10;
                param_5 = param_1 & (uint)param_3 >> 5 & extraout_r12 << 2;
                param_1 = param_1 & (uVar9 >> 1 | uVar9 << 0x1f);
                uVar12 = CONCAT44(param_1, uVar9);
                param_1 = param_1 & extraout_r12 << 0x1e;
            }
            uVar3 = (undefined4)((ulonglong)uVar12 >> 0x20);
            iVar6 = (int)uVar12;
            UNRECOVERED_JUMPTABLE = (code *)0x962c8;
            uVar9 = *(uint *)(iVar6 + 0xc);
            *(uint *)(iVar6 + 0xc) = uVar9 & 0xfffffffb;
            local_5c = __stack_chk_guard;
            local_6c = 0;
            local_68 = 0;
            local_60 = 0;
            local_64 = 1;
            pbStack_54 = param_3;
            piStack_50 = param_2;
            pbStack_4c = pbVar10;
            puStack_48 = &__stack_chk_guard;
            uStack_44 = param_1;
            uStack_40 = param_5;
            __ptr = (void *)__strdup(uVar3);
            if (__ptr == (void *)0x0) {
                FUN_0008e624(uVar3);
            } else {
                FUN_00095f40(iVar6, &local_6c, __ptr, 0, 0);
                free(__ptr);
                iVar4 = __stack_chk_guard;
                *(uint *)(iVar6 + 0xc) = uVar9;
                if (local_5c == iVar4) {
                    /* WARNING: Could not recover jumptable at 0x00096384. Too
                     * many branches */
                    /* WARNING: Treating indirect jump as call */
                    (*UNRECOVERED_JUMPTABLE)();
                    return;
                }
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        param_2[1] = iVar6;
        param_2[2] = param_2[2] | 0x40;
    }
    uVar3 = DAT_000c8168;
    DAT_000c8168 = param_5;
    FUN_0008dc70(param_1, param_2);
    DAT_000c8168 = uVar3;
LAB_00096100:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_0009639c(uint param_1, int param_2)

{
    int iVar1;
    uint uVar2;
    undefined4 uVar3;
    undefined4 local_2c;
    undefined4 local_28;
    uint local_24;
    undefined4 local_20;
    int local_1c;

    local_2c = 0;
    local_28 = 0;
    local_1c = __stack_chk_guard;
    local_20 = 0;
    local_24 = 2;
    if ((param_1 < 0x10) || ((*(uint *)(param_2 + 0x10) & 8) != 0))
        goto LAB_00096494;
    uVar3 = *(undefined4 *)(param_2 + 0x18);
    if ((*(uint *)(param_2 + 0x10) & 0x8000) == 0) {
        local_24 = 4;
    }
    if ((*(uint *)(param_1 + 0xc) & 0x40000) == 0) {
    LAB_000964d8:
        fprintf(stderr, (char *)option_xlateable_txt._128_4_,
                *(undefined4 *)(param_1 + 0x1c), uVar3);
        (**(code **)(param_1 + 0x54))(param_1, 1);
        /* WARNING: Subroutine does not return */
        _exit(1);
    }
    iVar1 = FUN_00095a98(param_1, uVar3, &local_2c);
    if ((iVar1 != 0) || (iVar1 = FUN_0008e3dc(param_1, &local_2c), iVar1 != 0))
        goto LAB_000964d8;
    if ((*(uint *)(param_1 + 0xc) & 0x8000) == 0) {
        if ((((local_24 & 0x20020) != 0) && ((local_24 & 0x40020) != 0x20)) &&
            ((local_24 & 0x400020) != 0x400000)) {
            uVar2 = ~local_24 & 0x800020;
        joined_r0x000964c0:
            if (uVar2 != 0)
                goto LAB_00096494;
        }
    } else if ((local_24 & 0x20020) != 0x20000) {
        uVar2 = ~local_24 & 0x40020;
        goto joined_r0x000964c0;
    }
    FUN_0008dc70(param_1, &local_2c);
LAB_00096494:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00096524(int *param_1, int param_2)

{
    byte bVar1;
    int iVar2;
    byte *pbVar3;
    int iVar4;
    undefined4 local_2c;
    undefined4 local_28;
    undefined4 local_24;
    undefined4 local_20;
    int local_1c;

    local_2c = 0;
    local_28 = 0;
    local_1c = __stack_chk_guard;
    local_20 = 0;
    local_24 = 4;
    if ((int *)0xf < param_1) {
        if (DAT_001173f0 == '\0') {
            if ((*param_1 < 0x20000) || (param_1[0x1e] == 0)) {
                /* WARNING: Subroutine does not return */
                FUN_0008cec0(option_xlateable_txt._52_4_);
            }
            pbVar3 = *(byte **)(param_2 + 0x18);
            if ((pbVar3 == (byte *)0x0) || (bVar1 = *pbVar3, bVar1 == 0)) {
                fprintf(stderr, (char *)option_xlateable_txt._172_4_,
                        param_1[7], *(undefined4 *)(param_2 + 0x34));
                (*(code *)param_1[0x15])(param_1, 1);
                /* WARNING: Subroutine does not return */
                __assert_fail("0 == 1", "reset.c", 0x60, "optionResetOpt");
            }
            DAT_001173f0 = 1;
            if (pbVar3[1] == 0) {
                if (bVar1 == 0x2a) {
                    iVar4 = param_1[0x11];
                    iVar2 = param_1[0x1a];
                    while (true) {
                        iVar2 = iVar2 + -1;
                        FUN_0008c2f0(param_1, iVar4);
                        if (iVar2 < 1)
                            break;
                        iVar4 = iVar4 + 0x40;
                    }
                    DAT_001173f0 = '\0';
                    goto LAB_00096600;
                }
                iVar2 = FUN_0008dff0(param_1, bVar1, &local_2c, &local_20);
                if (iVar2 != 0) {
                    fprintf(stderr, (char *)option_xlateable_txt._120_4_,
                            param_1[6], (uint)*pbVar3);
                    (*(code *)param_1[0x15])(param_1, 1);
                    /* WARNING: Subroutine does not return */
                    __assert_fail("0 == 1", "reset.c", 0x71, "optionResetOpt");
                }
            } else {
                iVar2 = FUN_00095a98(param_1, pbVar3, &local_2c);
                if (iVar2 != 0) {
                    fprintf(stderr, (char *)option_xlateable_txt._124_4_,
                            param_1[6], pbVar3);
                    (*(code *)param_1[0x15])(param_1, 1);
                    /* WARNING: Subroutine does not return */
                    __assert_fail("0 == 1", "reset.c", 0x79, "optionResetOpt");
                }
            }
            FUN_0008c2f0(param_1, local_2c);
            DAT_001173f0 = '\0';
        }
    }
LAB_00096600:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000967cc(int param_1, int param_2)

{
    undefined2 uVar1;
    uint uVar2;
    uint uVar3;
    char cVar4;
    char *pcVar5;
    uint uVar6;
    char *pcVar7;
    bool bVar8;

    uVar3 = __stack_chk_guard;
    if ((*(char **)(param_1 + 0x14) != (char *)0x0) &&
        (cVar4 = **(char **)(param_1 + 0x14), cVar4 != '\0')) {
    LAB_000968b0:
        FUN_0008dff0(param_1, cVar4, param_2, param_2 + 0xc);
        return;
    }
    uVar6 = *(uint *)(param_1 + 0x10);
    if (uVar6 < *(uint *)(param_1 + 4)) {
        uVar2 = *(uint *)(param_1 + 0xc);
        pcVar5 = *(char **)(*(int *)(param_1 + 8) + uVar6 * 4);
        *(char **)(param_1 + 0x14) = pcVar5;
        if ((uVar2 & 3) != 0) {
            *(char **)(param_1 + 0x14) = pcVar5 + 1;
            if ((*pcVar5 == '-') && (pcVar5[1] != '\0')) {
                *(uint *)(param_1 + 0x10) = uVar6 + 1;
                cVar4 = pcVar5[1];
                if (cVar4 != '-') {
                    pcVar7 = pcVar5 + 1;
                    if ((uVar2 & 2) != 0) {
                        if (uVar3 == __stack_chk_guard)
                            goto LAB_000968b0;
                        goto LAB_0009691c;
                    }
                    goto joined_r0x00096914;
                }
                pcVar7 = pcVar5 + 2;
                *(char **)(param_1 + 0x14) = pcVar7;
                if (pcVar5[2] != '\0') {
                    if ((uVar2 & 1) != 0) {
                        if (uVar3 != __stack_chk_guard)
                            goto LAB_0009691c;
                        goto LAB_000968d0;
                    }
                    fprintf(stderr, (char *)option_xlateable_txt._124_4_,
                            *(undefined4 *)(param_1 + 0x18), pcVar5);
                    uVar6 = 0xffffffff;
                    goto LAB_00096888;
                }
            }
            goto LAB_00096884;
        }
        *(uint *)(param_1 + 0x10) = uVar6 + 1;
        uVar2 = uVar3;
        pcVar7 = pcVar5;
        if (*pcVar5 != '-') {
        joined_r0x00096914:
            bVar8 = uVar3 == __stack_chk_guard;
            uVar3 = uVar2;
            if (bVar8) {
            LAB_000968d0:
                FUN_00095a98(param_1, pcVar7);
                return;
            }
            goto LAB_0009691c;
        }
        do {
            pcVar5 = pcVar5 + 1;
        } while (*pcVar5 == '-');
        uVar1 = *(undefined2 *)(param_1 + 0x62);
        *(undefined2 *)(param_1 + 0x62) = 0x8000;
        uVar6 = FUN_00095a98(param_1);
        *(undefined2 *)(param_1 + 0x62) = uVar1;
    } else {
    LAB_00096884:
        uVar6 = 1;
    }
LAB_00096888:
    bVar8 = uVar3 == __stack_chk_guard;
    uVar3 = uVar6;
    if (bVar8) {
        return;
    }
LAB_0009691c:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar3);
}

void FUN_000969ac(int param_1)

{
    int iVar1;
    undefined4 uVar2;
    int local_34[6];

    local_34[4] = __stack_chk_guard;
LAB_000969ec:
    do {
        local_34[0] = 0;
        local_34[1] = 0;
        local_34[2] = 4;
        local_34[3] = 0;
        iVar1 = FUN_000967cc(param_1, local_34);
        if (iVar1 == 0) {
            iVar1 = FUN_0008f19c(param_1, local_34);
        }
        if (iVar1 == -1)
            goto LAB_00096a88;
        if (iVar1 == 1) {
            uVar2 = 0;
            goto LAB_00096aac;
        }
        if (((local_34[2] & 0x20020U) != 0) &&
            ((local_34[2] & 0x40020U) != 0x20)) {
            if (((local_34[2] & 0x400020U) != 0x400000) &&
                ((~local_34[2] & 0x800020U) != 0))
                goto LAB_000969ec;
            *(short *)(local_34[0] + 0xe) = *(short *)(local_34[0] + 0xe) + -1;
        }
        iVar1 = FUN_0008dc70(param_1, local_34);
        if (iVar1 != 0) {
        LAB_00096a88:
            if ((*(uint *)(param_1 + 0xc) & 4) == 0) {
                uVar2 = 0xffffffff;
            } else {
                (**(code **)(param_1 + 0x54))(param_1, 1);
                uVar2 = 0xffffffff;
            }
        LAB_00096aac:
            if (local_34[4] != __stack_chk_guard) {
                /* WARNING: Subroutine does not return */
                __stack_chk_fail(uVar2);
            }
            return;
        }
    } while (true);
}

void FUN_00096ad8(int param_1)

{
    int iVar1;
    int iVar2;
    uint uVar3;
    undefined4 local_34;
    undefined4 local_30;
    uint local_2c;
    undefined4 local_28;
    int local_24;

    *(uint *)(param_1 + 0xc) = *(uint *)(param_1 + 0xc) | 0x8000;
    local_24 = __stack_chk_guard;
    *(undefined4 *)(param_1 + 0x14) = 0;
    *(undefined4 *)(param_1 + 0x10) = 1;
    do {
        local_34 = 0;
        local_30 = 0;
        local_28 = 0;
        local_2c = 2;
        iVar1 = FUN_000967cc(param_1, &local_34);
        if (iVar1 == 0) {
            iVar1 = FUN_0008f19c(param_1, &local_34);
        }
        if (iVar1 == -1)
            break;
        if (iVar1 == 1) {
            uVar3 = *(uint *)(param_1 + 0xc);
            iVar1 = 0;
            goto LAB_00096bc4;
        }
    } while (
        (((local_2c & 0x20020) != 0x20000) && ((~local_2c & 0x40020) != 0)) ||
        (iVar2 = FUN_0008dc70(param_1, &local_34), iVar2 == 0));
    uVar3 = *(uint *)(param_1 + 0xc);
    if ((uVar3 & 4) != 0) {
        (**(code **)(param_1 + 0x54))(param_1, 1);
        uVar3 = *(uint *)(param_1 + 0xc);
    }
LAB_00096bc4:
    iVar2 = __stack_chk_guard;
    *(uint *)(param_1 + 0xc) = uVar3 & 0xffff7fff;
    if (local_24 == iVar2) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar1);
}

void FUN_00096c00(int param_1, char *param_2)

{
    char cVar1;
    int iVar2;
    char *__needle;
    size_t sVar3;
    int iVar4;
    uint uVar5;
    byte *pbVar6;
    byte *__haystack;

    iVar2 = __stack_chk_guard;
    __needle = (char *)malloc(10);
    if (__needle == (char *)0x0) {
        /* WARNING: Subroutine does not return */
        FUN_0001c610(10);
    }
    sVar3 = strlen(*(char **)(param_1 + 0x1c));
    builtin_strncpy(__needle, "<?program", 10);
    do {
        __haystack = (byte *)(param_2 + 1);
        iVar4 = DAT_00117334;
        if (DAT_00117334 == 0) {
            iVar4 = FUN_0008e2f8(0xc);
        }
        cVar1 = *(char *)(iVar4 + (uint)(byte)param_2[1]);
        while (cVar1 != '\0') {
            __haystack = __haystack + 1;
            cVar1 = *(char *)(iVar4 + (uint)*__haystack);
        }
        iVar4 =
            FUN_000959ec(__haystack, *(undefined4 *)(param_1 + 0x1c), sVar3);
        if (iVar4 == 0) {
            uVar5 = (uint)__haystack[sVar3];
            pbVar6 = __haystack + sVar3;
            if ((uVar5 < 0x80) &&
                ((*(uint *)(&DAT_000af184 + uVar5 * 4) & 0x1000c01) != 0)) {
                free(__needle);
                goto LAB_00096d60;
            }
        }
        param_2 = strstr((char *)__haystack, __needle);
    } while (param_2 != (char *)0x0);
    free(__needle);
    pbVar6 = (byte *)0x0;
LAB_00096d08:
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pbVar6);
    }
    return;
LAB_00096d60:
    pbVar6 = pbVar6 + 1;
    if (uVar5 == 0)
        goto code_r0x00096d68;
    if (uVar5 == 0x3e)
        goto LAB_00096d08;
    uVar5 = (uint)*pbVar6;
    goto LAB_00096d60;
code_r0x00096d68:
    pbVar6 = (byte *)0x0;
    goto LAB_00096d08;
}

void FUN_00096d90(uint *param_1, byte *param_2)

{
    undefined4 *puVar1;
    char cVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    uint uVar6;
    uint uVar7;
    byte *pbVar8;
    undefined4 *puVar9;

    iVar3 = __stack_chk_guard;
    if ((param_2 != (byte *)0x0) ||
        (param_2 = (byte *)getenv("AUTOOPTS_USAGE"), param_2 != (byte *)0x0)) {
        iVar4 = DAT_00117334;
        if (DAT_00117334 == 0) {
            iVar4 = FUN_0008e2f8(0xc);
        }
        uVar5 = (uint)*param_2;
        cVar2 = *(char *)(iVar4 + uVar5);
        while (cVar2 != '\0') {
            param_2 = param_2 + 1;
            uVar5 = (uint)*param_2;
            cVar2 = *(char *)(iVar4 + uVar5);
        }
        if (uVar5 != 0) {
            uVar5 = 0;
            while (true) {
                puVar9 = &DAT_000c52e8;
                iVar4 = FUN_000959ec(param_2, &DAT_000b2948, 3);
                uVar7 = 0;
                while (iVar4 != 0) {
                    uVar7 = uVar7 + 1;
                    if (uVar7 == 5)
                        goto LAB_00096f3c;
                    puVar1 = puVar9 + 5;
                    puVar9 = puVar9 + 3;
                    iVar4 = FUN_000959ec(param_2, *puVar1, *puVar9);
                }
                param_2 = param_2 + (&DAT_000c52e8)[uVar7 * 3];
                uVar6 = (uint)*param_2;
                if ((0x7f < uVar6) ||
                    ((*(uint *)(&DAT_000af184 + uVar6 * 4) & 0xc13) == 0))
                    goto LAB_00096f3c;
                uVar5 = uVar5 | 1 << (uVar7 & 0xff);
                iVar4 = DAT_00117334;
                if (DAT_00117334 == 0) {
                    iVar4 = FUN_0008e2f8(0xc);
                    uVar6 = (uint)*param_2;
                }
                cVar2 = *(char *)(iVar4 + uVar6);
                while (cVar2 != '\0') {
                    param_2 = param_2 + 1;
                    uVar6 = (uint)*param_2;
                    cVar2 = *(char *)(iVar4 + uVar6);
                }
                if (uVar6 == 0)
                    break;
                if (uVar6 == 0x2c) {
                    pbVar8 = param_2 + 1;
                    iVar4 = DAT_00117334;
                    if (DAT_00117334 == 0) {
                        iVar4 = FUN_0008e2f8(0xc);
                    }
                    cVar2 = *(char *)(iVar4 + (uint)param_2[1]);
                    while ((param_2 = pbVar8,
                            cVar2 != '\0' &&
                                (param_2 = pbVar8 + 1,
                                 *(char *)(iVar4 + (uint)*param_2) != '\0'))) {
                        pbVar8 = pbVar8 + 2;
                        cVar2 = *(char *)(iVar4 + (uint)*pbVar8);
                    }
                }
            }
            if (((uVar5 & 3) != 3) && ((uVar5 & 0xc) != 0xc)) {
                puVar9 = &DAT_000c52e8;
                while (true) {
                    if ((uVar5 & 1) != 0) {
                        uVar7 = puVar9[1];
                        if ((uVar7 & 1) == 0) {
                            uVar7 = uVar7 | *param_1;
                        } else {
                            uVar7 = uVar7 & *param_1;
                        }
                        *param_1 = uVar7;
                    }
                    uVar5 = uVar5 >> 1;
                    if (uVar5 == 0)
                        break;
                    puVar9 = puVar9 + 3;
                }
            }
        }
    }
LAB_00096f3c:
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00097004(int param_1, int param_2)

{
    char cVar1;
    int iVar2;
    char *pcVar3;
    void *__dest;
    int iVar4;
    byte *__s;
    size_t __n;

    iVar2 = __stack_chk_guard;
    __s = (byte *)(param_2 + 1);
    iVar4 = DAT_00117334;
    if (DAT_00117334 == 0) {
        iVar4 = FUN_0008e2f8(0xc);
    }
    cVar1 = *(char *)(iVar4 + (uint) * (byte *)(param_2 + 1));
    while (cVar1 != '\0') {
        __s = __s + 1;
        cVar1 = *(char *)(iVar4 + (uint)*__s);
    }
    pcVar3 = strchr((char *)__s, 0x3e);
    if (pcVar3 != (char *)0x0) {
        __n = (int)pcVar3 - (int)__s;
        __dest = malloc(__n + 1);
        if (__dest == (void *)0x0) {
            /* WARNING: Subroutine does not return */
            FUN_0001c610(__n + 1);
        }
        memcpy(__dest, __s, __n);
        *(undefined1 *)((int)__dest + __n) = 0;
        FUN_00096d90(param_1 + 0xc, __dest);
        pcVar3 = pcVar3 + 1;
        free(__dest);
    }
    if (iVar2 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail(pcVar3);
    }
    return;
}

/* WARNING: Removing unreachable block (ram,0x00097184) */

void FUN_00097100(byte *param_1, byte *param_2)

{
    uint uVar1;

    while (true) {
        while (true) {
            uVar1 = (uint)*param_1;
            if (uVar1 != *param_2)
                break;
            param_1 = param_1 + 1;
            param_2 = param_2 + 1;
            if (uVar1 == 0) {
                return;
            }
        }
        if ((&DAT_000c816c)[uVar1] != (&DAT_000c816c)[*param_2])
            break;
        param_1 = param_1 + 1;
        param_2 = param_2 + 1;
        if (uVar1 == 0) {
            return;
        }
    }
    return;
}

/* WARNING: Control flow encountered bad instruction data */

void FUN_00097194(int *param_1, char *param_2, undefined4 param_3, int param_4)

{
    int iVar1;
    char *pcVar2;
    int iVar3;
    int iVar4;
    uint uVar5;

    iVar1 = __stack_chk_guard;
    pcVar2 = getenv(param_2);
    param_1[1] = (int)pcVar2;
    if (pcVar2 == (char *)0x0) {
    LAB_000972a8:
        if (iVar1 == __stack_chk_guard) {
            return;
        }
        goto LAB_000972e0;
    }
    iVar4 = *(int *)(*param_1 + 0x3c);
    uVar5 = *(uint *)(*param_1 + 0x10);
    param_1[3] = 0;
    param_1[2] = uVar5 | 0x42;
    if ((iVar4 == 0) ||
        (iVar3 = FUN_00097100(), iVar4 = __stack_chk_guard, iVar3 != 0)) {
        if (param_4 == 1) {
            if ((param_1[2] & 0x20020U) != 0x20000) {
                uVar5 = ~param_1[2] & 0x40020;
                goto joined_r0x000972a4;
            }
        } else if ((((param_4 == 2) &&
                     (uVar5 = param_1[2], (uVar5 & 0x20020) != 0)) &&
                    ((uVar5 & 0x40020) != 0x20)) &&
                   ((uVar5 & 0x400020) != 0x400000)) {
            uVar5 = ~uVar5 & 0x800020;
        joined_r0x000972a4:
            if (uVar5 != 0)
                goto LAB_000972a8;
        }
        if ((*(uint *)(*param_1 + 0x10) & 0xf000) != 0) {
            pcVar2 = (char *)param_1[1];
            if (*pcVar2 != '\0') {
                iVar4 = __strdup(pcVar2);
                if (iVar4 == 0) {
                    FUN_0008e624(pcVar2);
                    /* WARNING: Bad instruction - Truncating control flow here
                     */
                    halt_baddata();
                }
                param_1[1] = iVar4;
                param_1[2] = param_1[2] | 0x40;
                iVar4 = __stack_chk_guard;
                goto joined_r0x000972dc;
            }
            if ((*(uint *)(*param_1 + 0x10) & 0x10000) == 0)
                goto LAB_000972a8;
        }
        param_1[1] = 0;
        iVar4 = __stack_chk_guard;
    } else {
        param_1[1] = 0;
        param_1[2] = param_1[2] | 0x20;
    }
joined_r0x000972dc:
    if (iVar1 == iVar4) {
        FUN_0008dc70(param_3, param_1);
        return;
    }
LAB_000972e0:
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00097404(byte *param_1)

{
    byte bVar1;
    byte bVar2;
    int iVar3;

    iVar3 = __stack_chk_guard;
    if (param_1 != (byte *)0x0) {
        bVar1 = *param_1;
        bVar2 = bVar1;
        while (bVar2 != 0) {
            (&DAT_000c816c)[bVar2] = bVar1;
            param_1 = param_1 + 1;
            bVar2 = *param_1;
        }
    }
    if (iVar3 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00097480(uint *param_1, char *param_2)

{
    int iVar1;
    undefined4 uVar2;
    char *pcVar3;
    uint uVar4;

    iVar1 = __stack_chk_guard;
    if (param_1 == (uint *)0x0) {
        fputs((char *)option_xlateable_txt._24_4_, stderr);
        uVar2 = 0xffffffff;
    } else {
        uVar4 = param_1[3];
        DAT_001172c4 = (byte)((uVar4 << 10) >> 0x1f);
        if ((((uVar4 & 0x2000) != 0) &&
             ((code *)param_1[0x16] != (code *)0x0)) &&
            (option_xlateable_txt._0_4_ != 0)) {
            if ((uVar4 & 0x30000) == 0x20000) {
                param_1[3] = uVar4 | 0x10000;
            }
            (*(code *)param_1[0x16])();
        }
        uVar4 = *param_1;
        if (uVar4 - 0x19000 < 0x10002) {
            if (param_1[7] == 0) {
                pcVar3 = strrchr(param_2, 0x2f);
                if (pcVar3 == (char *)0x0) {
                    param_1[7] = (uint)param_2;
                } else {
                    param_1[7] = (uint)(pcVar3 + 1);
                }
                pcVar3 = getenv("PATH");
                pcVar3 = (char *)FUN_0008f9cc(pcVar3, param_2);
                if (pcVar3 == (char *)0x0) {
                    pcVar3 = param_2;
                }
                param_1[6] = (uint)pcVar3;
                FUN_00097404(&ao_strs_strtable);
                uVar2 = 0;
            } else {
                uVar2 = 0;
            }
        } else {
            fprintf(stderr, (char *)option_xlateable_txt._32_4_, param_2,
                    (int)uVar4 >> 0xc, (uVar4 << 0x14) >> 0x1b, uVar4 & 0x7f);
            pcVar3 = (char *)option_xlateable_txt._28_4_;
            if ((int)*param_1 < 0x29002) {
                pcVar3 = (char *)option_xlateable_txt._40_4_;
            }
            fputs(pcVar3, stderr);
            fwrite("41:0:16\n", 8, 1, stderr);
            uVar2 = 0xffffffff;
        }
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_000976c0(char *param_1, uint param_2, uint param_3,
                  undefined4 *param_4)

{
    int iVar1;
    undefined4 uVar2;
    long lVar3;
    int *piVar4;
    size_t __len;
    void *pvVar5;
    uint uVar6;
    stat64 sStack_88;
    int local_1c;

    uVar6 = param_2 & 2;
    param_4[6] = param_2;
    param_4[7] = param_3;
    local_1c = __stack_chk_guard;
    param_4[3] = 0xffffffff;
    *param_4 = 0;
    param_4[1] = 0;
    param_4[2] = 0;
    param_4[4] = 0;
    param_4[5] = 0;
    if (uVar6 != 0) {
        if ((param_3 & 3) == 1) {
            if ((param_3 & 1) == 0) {
                uVar6 = 0x82;
            } else {
                uVar6 = 2;
            }
        } else if ((param_3 & 1) == 0) {
            uVar6 = 0x80;
        } else {
            uVar6 = 0;
        }
    }
    iVar1 = open64(param_1, uVar6);
    param_4[3] = iVar1;
    if (iVar1 < 0) {
        piVar4 = __errno_location();
        pvVar5 = (void *)*piVar4;
        param_4[3] = 0xffffffff;
        param_4[5] = pvVar5;
    LAB_0009783c:
        if (pvVar5 != (void *)0x0) {
            uVar2 = 0xffffffff;
            goto LAB_00097848;
        }
    } else {
        iVar1 = __fxstat64(3, iVar1, &sStack_88);
        if (iVar1 == 0) {
            if ((sStack_88.st_mode & 0xf000) == 0x8000) {
                param_4[1] = (undefined4)sStack_88.st_size;
                if (param_4[3] == -1) {
                    piVar4 = __errno_location();
                    pvVar5 = (void *)*piVar4;
                    param_4[5] = pvVar5;
                    goto LAB_0009783c;
                }
            } else {
                piVar4 = __errno_location();
                *piVar4 = 0x16;
                param_4[5] = 0x16;
                close(param_4[3]);
            }
        } else {
            piVar4 = __errno_location();
            param_4[5] = *piVar4;
            close(param_4[3]);
        }
        pvVar5 = (void *)param_4[5];
        if (pvVar5 != (void *)0x0) {
            uVar2 = 0xffffffff;
            goto LAB_00097848;
        }
    }
    lVar3 = sysconf(0x1e);
    __len = param_4[1];
    uVar6 = lVar3 + __len;
    param_4[2] = -lVar3 & uVar6;
    if (uVar6 == (-lVar3 & uVar6)) {
        pvVar5 = mmap64(pvVar5, uVar6, 3, 0x22, -1, 0);
        if (pvVar5 != (void *)0xffffffff) {
            __len = param_4[1];
            uVar6 = param_4[7] | 0x10;
            param_4[7] = uVar6;
            goto LAB_000977c0;
        }
    LAB_000978ac:
        piVar4 = __errno_location();
        iVar1 = *piVar4;
        param_4[5] = iVar1;
    } else {
        uVar6 = param_4[7];
    LAB_000977c0:
        pvVar5 = mmap64(pvVar5, __len, param_4[6], uVar6, param_4[3], 0);
        *param_4 = pvVar5;
        if (pvVar5 == (void *)0xffffffff)
            goto LAB_000978ac;
        iVar1 = param_4[5];
    }
    if (iVar1 == 0) {
        uVar2 = *param_4;
    } else {
        if (param_4[3] != -1) {
            close(param_4[3]);
            iVar1 = param_4[5];
            param_4[3] = 0xffffffff;
        }
        piVar4 = __errno_location();
        *piVar4 = iVar1;
        uVar2 = 0xffffffff;
        *param_4 = 0xffffffff;
    }
LAB_00097848:
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(uVar2);
}

void FUN_0009791c(undefined4 *param_1)

{
    int iVar1;
    int *piVar2;
    void *__addr;
    int iVar3;

    iVar1 = __stack_chk_guard;
    piVar2 = __errno_location();
    __addr = (void *)*param_1;
    *piVar2 = 0;
    munmap(__addr, param_1[2]);
    iVar3 = *piVar2;
    param_1[5] = iVar3;
    if (param_1[3] != -1) {
        close(param_1[3]);
        iVar3 = param_1[5];
        param_1[3] = 0xffffffff;
    }
    if (iVar1 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(iVar3);
}

void FUN_000979a8(int param_1, undefined4 param_2, int param_3)

{
    char cVar1;
    byte *pbVar2;
    byte bVar3;
    byte *pbVar4;
    int iVar5;
    size_t sVar6;
    byte *pbVar7;
    int iVar9;
    byte *pbVar10;
    uint uVar11;
    byte *pbVar12;
    undefined *puVar13;
    char *pcVar14;
    byte *__haystack;
    undefined4 uVar15;
    undefined4 uVar16;
    int local_d4;
    int local_c0;
    int local_b0;
    byte *local_ac;
    undefined4 local_a8;
    undefined4 local_a4;
    undefined4 local_a0;
    undefined4 local_9c;
    undefined1 auStack_98[32];
    int local_78[3];
    byte local_6c;
    byte local_6b;
    undefined1 local_6a;
    int local_2c;
    ulong uVar8;

    uVar15 = 2;
    local_a0 = 2;
    local_2c = __stack_chk_guard;
    local_a8 = 0;
    local_a4 = 0;
    uVar16 = *(undefined4 *)(param_1 + 0xc);
    local_9c = 0;
    pbVar4 = (byte *)FUN_000976c0(param_2, 3, 2, auStack_98);
    if (pbVar4 != (byte *)0xffffffff) {
        uVar11 = *(uint *)(param_1 + 0xc);
        if (param_3 == 0) {
            uVar15 = 4;
        }
        *(uint *)(param_1 + 0xc) = uVar11 & 0xfffffffb;
        local_d4 = param_3;
        if (param_3 == 0) {
            local_d4 = 1;
        }
        if ((uVar11 & 0x80000) == 0) {
            uVar15 = 1;
        }
        do {
            iVar5 = DAT_00117334;
            local_a0 = uVar15;
            if (DAT_00117334 == 0) {
                iVar5 = FUN_0008e2f8(0xc);
            }
            pcVar14 = DAT_001173f4;
            uVar11 = (uint)*pbVar4;
            cVar1 = *(char *)(iVar5 + uVar11);
            pbVar12 = pbVar4;
            while (cVar1 != '\0') {
                pbVar12 = pbVar12 + 1;
                uVar11 = (uint)*pbVar12;
                cVar1 = *(char *)(iVar5 + uVar11);
            }
            if ((uVar11 < 0x80) &&
                ((*(uint *)(&DAT_000af184 + uVar11 * 4) & 0x180040) != 0)) {
                pbVar4 = pbVar12 + 1;
                pbVar10 = (byte *)strchr((char *)pbVar4, 10);
                if (pbVar10 == (byte *)0x0) {
                    sVar6 = strlen((char *)pbVar4);
                    pbVar4 = pbVar4 + sVar6;
                } else {
                    iVar5 = DAT_00117374;
                    if (DAT_00117374 == 0) {
                        iVar5 = FUN_0008e2f8(0x1c);
                    }
                    cVar1 = *(char *)(iVar5 + (uint)pbVar12[1]);
                    while (cVar1 != '\0') {
                        pbVar4 = pbVar4 + 1;
                        cVar1 = *(char *)(iVar5 + (uint)*pbVar4);
                    }
                    iVar5 = DAT_00117334;
                    if (DAT_00117334 == 0) {
                        iVar5 = FUN_0008e2f8(0xc);
                    }
                    uVar11 = (uint)*pbVar4;
                    cVar1 = *(char *)(iVar5 + uVar11);
                    while (cVar1 != '\0') {
                        pbVar4 = pbVar4 + 1;
                        uVar11 = (uint)*pbVar4;
                        cVar1 = *(char *)(iVar5 + uVar11);
                    }
                    if (pbVar10 < pbVar4) {
                    LAB_00097f20:
                        *pbVar10 = 0;
                        pbVar4 = pbVar10 + 1;
                        FUN_00095f40(param_1, &local_a8, pbVar12, local_d4, 1);
                    } else {
                        if (uVar11 == 0x3a || uVar11 == 0x3d) {
                            pbVar7 = pbVar4 + 1;
                            iVar5 = DAT_00117334;
                            if (DAT_00117334 == 0) {
                                iVar5 = FUN_0008e2f8(0xc);
                            }
                            cVar1 = *(char *)(iVar5 + (uint)pbVar4[1]);
                            while ((pbVar4 = pbVar7,
                                    cVar1 != '\0' &&
                                        (pbVar4 = pbVar7 + 1,
                                         *(char *)(iVar5 + (uint)*pbVar4) !=
                                             '\0'))) {
                                pbVar7 = pbVar7 + 2;
                                cVar1 = *(char *)(iVar5 + (uint)*pbVar7);
                            }
                            if (pbVar10 < pbVar4)
                                goto LAB_00097f20;
                        } else if ((0x7f < pbVar4[-1]) ||
                                   ((*(uint *)(&DAT_000af184 +
                                               (uint)pbVar4[-1] * 4) &
                                     0xc01) == 0))
                            break;
                        if (pbVar10[-1] == 0x5c) {
                            bVar3 = *pbVar10;
                            pbVar7 = pbVar10 + -1;
                            while (pbVar4 = pbVar10 + 1, bVar3 != 10) {
                                if (bVar3 == 0x5c) {
                                    if (pbVar10[1] == 10) {
                                        pbVar4 = pbVar10 + 2;
                                        bVar3 = 10;
                                    }
                                } else if (bVar3 == 0) {
                                    pbVar4 = (byte *)0x0;
                                    break;
                                }
                                *pbVar7 = bVar3;
                                pbVar7 = pbVar7 + 1;
                                pbVar10 = pbVar4;
                                bVar3 = *pbVar4;
                            }
                            *pbVar7 = 0;
                        } else {
                            pbVar4 = pbVar10 + 1;
                            *pbVar10 = 0;
                        }
                        FUN_00095f40(param_1, &local_a8, pbVar12, local_d4, 1);
                    }
                }
            } else if (uVar11 == 0x3c) {
                uVar11 = (uint)pbVar12[1];
                if ((uVar11 < 0x80) &&
                    ((*(uint *)(&DAT_000af184 + uVar11 * 4) & 0x180040) != 0)) {
                    pbVar10 = pbVar12 + 1;
                    local_b0 = DAT_000c8168;
                    iVar5 = DAT_00117374;
                    if (DAT_00117374 == 0) {
                        iVar5 = FUN_0008e2f8(0x1c);
                    }
                    cVar1 = *(char *)(iVar5 + (uint)pbVar12[1]);
                    pbVar12 = pbVar10;
                    while (cVar1 != '\0') {
                        pbVar12 = pbVar12 + 1;
                        cVar1 = *(char *)(iVar5 + (uint)*pbVar12);
                    }
                    local_78[0] = 1;
                    uVar11 = (uint)*pbVar12;
                    if (uVar11 == 0x20) {
                    LAB_000980a0:
                        iVar5 = DAT_00117334;
                        if (DAT_00117334 == 0) {
                            iVar5 = FUN_0008e2f8(0xc);
                            uVar11 = (uint)*pbVar12;
                        }
                        cVar1 = *(char *)(iVar5 + uVar11);
                        pbVar4 = pbVar12;
                        while (cVar1 != '\0') {
                            pbVar4 = pbVar4 + 1;
                            cVar1 = *(char *)(iVar5 + (uint)*pbVar4);
                        }
                        pbVar7 =
                            (byte *)FUN_000913a4(pbVar4, &local_b0, local_78);
                        if (pbVar7 == (byte *)0x0)
                            break;
                        if (*pbVar7 != 0x3e) {
                            if (*pbVar7 == 0x2f) {
                            LAB_00098104:
                                if (pbVar7[1] == 0x3e) {
                                    pbVar4 = pbVar7 + 2;
                                    *pbVar7 = 0;
                                    FUN_00095f40(param_1, &local_a8, pbVar10,
                                                 local_d4, local_b0);
                                    goto LAB_00097b28;
                                }
                            }
                            break;
                        }
                    } else {
                        if (uVar11 < 0x21) {
                            if (uVar11 == 9)
                                goto LAB_000980a0;
                        LAB_000981cc:
                            pcVar14 = strchr((char *)pbVar12, 0x3e);
                        joined_r0x00098050:
                            if (pcVar14 != (char *)0x0) {
                                pbVar4 = (byte *)(pcVar14 + 1);
                                goto LAB_00097b28;
                            }
                            break;
                        }
                        pbVar7 = pbVar12;
                        if (uVar11 == 0x2f)
                            goto LAB_00098104;
                        if (uVar11 != 0x3e)
                            goto LAB_000981cc;
                    }
                    *pbVar12 = 0;
                    __haystack = pbVar7 + 1;
                    sVar6 = strlen((char *)pbVar10);
                    iVar5 = local_b0;
                    uVar11 = sVar6 + 4;
                    if (uVar11 < 0x40) {
                        local_c0 = sprintf((char *)&local_6c, "</%s>", pbVar10);
                        pbVar7[1] = 0x20;
                        pbVar7 = (byte *)strstr((char *)__haystack,
                                                (char *)&local_6c);
                    } else {
                        pcVar14 = (char *)malloc(uVar11);
                        if (pcVar14 == (char *)0x0) {
                            /* WARNING: Subroutine does not return */
                            FUN_0001c610(uVar11);
                        }
                        local_c0 = sprintf(pcVar14, "</%s>", pbVar10);
                        pbVar7[1] = 0x20;
                        pbVar7 = (byte *)strstr((char *)__haystack, pcVar14);
                        free(pcVar14);
                    }
                    if (pbVar7 == (byte *)0x0)
                        break;
                    pbVar4 = pbVar7 + local_c0;
                    if (iVar5 != 1) {
                        iVar5 = DAT_00117334;
                        if (DAT_00117334 == 0) {
                            iVar5 = FUN_0008e2f8(0xc);
                        }
                        if (pbVar7 <= __haystack) {
                            sVar6 = strlen((char *)__haystack);
                            pbVar7 = __haystack + sVar6;
                            if (pbVar7 <= __haystack)
                                goto LAB_00097d80;
                        }
                        if (*(char *)(iVar5 + (uint)pbVar7[-1]) != '\0') {
                            pbVar2 = pbVar7 + -1;
                            do {
                                pbVar7 = pbVar2;
                                if (pbVar7 <= __haystack)
                                    break;
                                pbVar2 = pbVar7 + -1;
                            } while (*(char *)(iVar5 + (uint)pbVar7[-1]) !=
                                     '\0');
                        }
                    }
                LAB_00097d80:
                    *pbVar7 = 0;
                    if (pbVar4 == (byte *)0x0)
                        break;
                    memset(pbVar12, 0x20, (int)__haystack - (int)pbVar12);
                    if ((local_78[0] == 1) && (local_b0 == 0)) {
                        local_6a = 0;
                        bVar3 = *__haystack;
                        pbVar12 = __haystack;
                        if (bVar3 == 0x25)
                            goto LAB_000982b8;
                        while (pbVar7 = pbVar12 + 1, bVar3 != 0x26) {
                            if (bVar3 == 0) {
                                *__haystack = 0;
                                goto LAB_00097db0;
                            }
                            while (true) {
                                *__haystack = bVar3;
                            LAB_000982a4:
                                bVar3 = *pbVar7;
                                __haystack = __haystack + 1;
                                pbVar12 = pbVar7;
                                if (bVar3 != 0x25)
                                    break;
                            LAB_000982b8:
                                local_6c = pbVar12[1];
                                pbVar7 = pbVar12 + 3;
                                local_6b = pbVar12[2];
                                bVar3 = local_6c;
                                if (local_6c == 0) {
                                    bVar3 = 1;
                                }
                                if (local_6c != 0) {
                                    bVar3 = local_6b == 0;
                                }
                                if (bVar3 != 0)
                                    goto LAB_000983a4;
                                uVar8 = strtoul((char *)&local_6c, (char **)0x0,
                                                0x10);
                                bVar3 = (byte)uVar8;
                            }
                        }
                        uVar11 = (uint)pbVar12[1];
                        if (uVar11 == 0x23) {
                            local_ac = pbVar12 + 2;
                        LAB_00098354:
                            bVar3 = *local_ac;
                            if ((bVar3 == 0x58) || (bVar3 == 0x78)) {
                                local_ac = local_ac + 1;
                                iVar5 = 0x10;
                            } else if (bVar3 == 0x30) {
                                if (local_ac[1] == 0x30) {
                                    iVar5 = 0x10;
                                } else {
                                    iVar5 = 10;
                                }
                            } else {
                                iVar5 = 10;
                            }
                            uVar8 = strtoul((char *)local_ac,
                                            (char **)&local_ac, iVar5);
                            if ((*local_ac != 0x3b) || (0x7f < uVar8)) {
                            LAB_000983a4:
                                *__haystack = 0;
                                goto LAB_00097db0;
                            }
                            pbVar7 = local_ac + 1;
                        } else {
                            local_ac = pbVar7;
                            if ((uVar11 < 0x80) &&
                                ((*(uint *)(&DAT_000af184 + uVar11 * 4) &
                                  0x30000) != 0))
                                goto LAB_00098354;
                            sVar6 = 4;
                            iVar5 = 0;
                            pcVar14 = "amp;";
                            puVar13 = &DAT_000c5324;
                            while (iVar9 =
                                       strncmp((char *)pbVar7, pcVar14, sVar6),
                                   iVar9 != 0) {
                                iVar5 = iVar5 + 1;
                                if (iVar5 == 0xc)
                                    goto LAB_000983a4;
                                pcVar14 = *(char **)(puVar13 + 8);
                                sVar6 = (size_t) * (ushort *)(puVar13 + 0xc);
                                puVar13 = puVar13 + 8;
                            }
                            pbVar7 = pbVar7 + sVar6;
                            uVar8 = (ulong)(short)(&DAT_000c532a)[iVar5 * 4];
                        }
                        *__haystack = (byte)uVar8;
                        if (uVar8 != 0)
                            goto LAB_000982a4;
                    }
                LAB_00097db0:
                    FUN_00095f40(param_1, &local_a8, pbVar10, local_d4,
                                 local_b0);
                } else if (uVar11 == 0x2f) {
                    pcVar14 = strchr((char *)(pbVar12 + 2), 0x3e);
                    pbVar4 = (byte *)(pcVar14 + 1);
                    if (pcVar14 == (char *)0x0)
                        break;
                } else if (uVar11 == 0x3f) {
                    if (DAT_001173f4 == (char *)0x0) {
                        sVar6 = 7;
                        pcVar14 = "program";
                        DAT_001173f8 = "auto-options";
                        DAT_001173f4 = pcVar14;
                    } else {
                        sVar6 = strlen(DAT_001173f4);
                    }
                    pbVar4 = pbVar12 + 2;
                    iVar5 = strncmp((char *)pbVar4, pcVar14, sVar6);
                    pcVar14 = DAT_001173f8;
                    if (iVar5 != 0) {
                    LAB_00097fe0:
                        sVar6 = strlen(DAT_001173f8);
                        iVar5 = strncmp((char *)pbVar4, pcVar14, sVar6);
                        if (iVar5 == 0) {
                            pbVar10 = pbVar12 + sVar6 + 2;
                            if ((0x7f < pbVar12[sVar6 + 2]) ||
                                ((*(uint *)(&DAT_000af184 +
                                            (uint)pbVar12[sVar6 + 2] * 4) &
                                  0x3b0060) == 0)) {
                                iVar5 = 1;
                                goto LAB_00098140;
                            }
                        }
                        pcVar14 = strchr((char *)pbVar4, 0x3e);
                        goto joined_r0x00098050;
                    }
                    pbVar10 = pbVar12 + sVar6 + 2;
                    iVar5 = 0;
                    if ((pbVar12[sVar6 + 2] < 0x80) &&
                        ((*(uint *)(&DAT_000af184 +
                                    (uint)pbVar12[sVar6 + 2] * 4) &
                          0x3b0060) != 0))
                        goto LAB_00097fe0;
                LAB_00098140:
                    pbVar4 = (byte *)(**(code **)(&DAT_000c5384 + iVar5 * 4))(
                        param_1, pbVar10);
                } else {
                    if ((uVar11 != 0x21) ||
                        (pcVar14 = strstr((char *)pbVar12, "-->"),
                         pcVar14 == (char *)0x0))
                        break;
                    pbVar4 = (byte *)(pcVar14 + 3);
                }
            } else {
                if (uVar11 == 0x5b) {
                    pcVar14 = *(char **)(param_1 + 0x20);
                    sVar6 = strlen(pcVar14);
                    iVar5 = strncmp((char *)(pbVar12 + 1), pcVar14, sVar6);
                    if ((iVar5 == 0) && (pbVar12[sVar6 + 1] == 0x5d)) {
                        pbVar4 =
                            (byte *)strchr((char *)(pbVar12 + sVar6 + 2), 10);
                        goto LAB_00097b28;
                    }
                    if (0x10 < sVar6)
                        break;
                    sprintf((char *)&local_6c, "[%s]", pcVar14);
                    pbVar12 =
                        (byte *)strstr((char *)pbVar12, (char *)&local_6c);
                    if (pbVar12 == (byte *)0x0)
                        break;
                } else {
                    if (uVar11 != 0x23)
                        break;
                    pbVar12 = pbVar12 + 1;
                }
                pbVar4 = (byte *)strchr((char *)pbVar12, 10);
            }
        LAB_00097b28:
        } while (pbVar4 != (byte *)0x0);
        FUN_0009791c(auStack_98);
        *(undefined4 *)(param_1 + 0xc) = uVar16;
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_000984d4(int param_1)

{
    char *pcVar1;
    int iVar2;
    size_t sVar3;
    size_t sVar4;
    int *piVar5;
    char cVar6;
    int *piVar7;
    int iVar8;
    int iVar9;
    int iVar10;
    char *__s;
    uint uVar11;
    bool bVar12;
    stat64 sStack_1098;
    char acStack_1030[4100];
    int local_2c;

    piVar7 = *(int **)(param_1 + 0x34);
    local_2c = __stack_chk_guard;
    if (piVar7 != (int *)0x0) {
        iVar8 = piVar7[1];
        uVar11 = *(uint *)(param_1 + 0xc);
        *(uint *)(param_1 + 0xc) = uVar11 & 0xfffffffb;
        if (iVar8 != 0) {
            piVar5 = piVar7 + 1;
            iVar8 = 0;
            do {
                piVar5 = piVar5 + 1;
                iVar8 = iVar8 + 1;
            } while (*piVar5 != 0);
        }
        iVar10 = -1;
        while (true) {
            if (iVar8 == -1) {
                iVar10 = 1;
                iVar9 = 0;
            } else {
                piVar7 = piVar7 + iVar8;
                iVar9 = iVar8;
            }
            if (*piVar7 == 0)
                break;
            iVar8 = iVar9 + iVar10;
            iVar2 = FUN_00093f7c(acStack_1030, 0x1001, *piVar7,
                                 *(undefined4 *)(param_1 + 0x18));
            if ((iVar2 != 0) &&
                (iVar2 = __xstat64(3, acStack_1030, &sStack_1098),
                 iVar2 == 0)) {
                if ((sStack_1098.st_mode & 0xf000) == 0x4000) {
                    sVar3 = strlen(acStack_1030);
                    __s = *(char **)(param_1 + 0x24);
                    sVar4 = strlen(__s);
                    if (0x1000 < sVar3 + 1 + sVar4 + 1)
                        goto LAB_00098648;
                    cVar6 = acStack_1030[sVar3 - 1];
                    bVar12 = cVar6 != '/';
                    pcVar1 = acStack_1030;
                    if (bVar12) {
                        cVar6 = '/';
                        pcVar1 = acStack_1030 + 1;
                    }
                    if (bVar12) {
                        acStack_1030[sVar3] = cVar6;
                    }
                    memcpy(pcVar1 + sVar3, __s, sVar4 + 1);
                }
                FUN_000979a8(param_1, acStack_1030, iVar10);
                if (((uint)(iVar10 == -1) &
                     *(uint *)(*(int *)(param_1 + 0x44) +
                               (uint) * (ushort *)(param_1 + 0x5e) * 0x40 +
                               0x50) >>
                         5) != 0) {
                    iVar10 = 1;
                    iVar8 = iVar9;
                }
            }
        LAB_00098648:
            piVar7 = *(int **)(param_1 + 0x34);
        }
        *(uint *)(param_1 + 0xc) = uVar11;
    }
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void optionLoadOpt(uint param_1, int param_2)

{
    int iVar1;
    int *piVar2;
    stat64 sStack_80;
    int local_14;

    local_14 = __stack_chk_guard;
    if ((0xf < param_1) && ((*(uint *)(param_2 + 0x10) & 0x28) == 0)) {
        iVar1 = __xstat64(3, *(char **)(param_2 + 0x18), &sStack_80);
        if (iVar1 == 0) {
            if ((sStack_80.st_mode & 0xf000) == 0x8000) {
                FUN_000979a8(param_1, *(undefined4 *)(param_2 + 0x18));
            } else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
                piVar2 = __errno_location();
                *piVar2 = 0x16;
                /* WARNING: Subroutine does not return */
                FUN_0008cf18(*(undefined4 *)(param_1 + 0x1c), &DAT_000a1074,
                             *(undefined4 *)(param_2 + 0x18));
            }
        } else if ((*(uint *)(param_1 + 0xc) & 4) != 0) {
            /* WARNING: Subroutine does not return */
            FUN_0008cf18(*(undefined4 *)(param_1 + 0x1c), &DAT_000a1074,
                         *(undefined4 *)(param_2 + 0x18));
        }
    }
    if (local_14 == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00098a20(byte *param_1)

{
    char cVar1;
    byte bVar2;
    int *piVar3;
    int iVar4;
    byte bVar5;
    int iVar6;
    byte bVar7;
    uint uVar8;
    int iVar9;
    byte *pbVar10;
    int *piVar11;
    byte *pbVar12;
    byte *pbVar13;
    byte local_2d;
    int local_2c;

    local_2c = __stack_chk_guard;
    if (param_1 != (byte *)0x0) {
        iVar9 = DAT_00117334;
        if (DAT_00117334 == 0) {
            iVar9 = FUN_0008e2f8(0xc);
        }
        uVar8 = (uint)*param_1;
        cVar1 = *(char *)(iVar9 + uVar8);
        pbVar12 = param_1;
        while (cVar1 != '\0') {
            pbVar12 = pbVar12 + 1;
            uVar8 = (uint)*pbVar12;
            cVar1 = *(char *)(iVar9 + uVar8);
        }
        if (uVar8 != 0) {
            iVar9 = 2;
            pbVar10 = pbVar12;
            do {
                iVar9 = iVar9 + 1;
                pbVar13 = pbVar10 + 1;
                if (DAT_00117334 == 0) {
                    iVar6 = FUN_0008e2f8(0xc);
                    iVar4 = DAT_00117334;
                    if (pbVar10[1] != 0) {
                        cVar1 = *(char *)(iVar6 + (uint)pbVar10[1]);
                        goto joined_r0x00098d74;
                    }
                LAB_00098ae8:
                    if (iVar4 == 0) {
                        iVar4 = FUN_0008e2f8(0xc);
                        uVar8 = (uint)*pbVar13;
                    } else {
                    LAB_00098af0:
                        uVar8 = (uint)*pbVar13;
                    }
                } else {
                    iVar4 = DAT_00117334;
                    if (pbVar10[1] != 0) {
                        iVar6 = DAT_00117334;
                        if (*(char *)(DAT_00117334 + (uint)pbVar10[1]) ==
                            '\0') {
                            do {
                                pbVar13 = pbVar13 + 1;
                                if (*pbVar13 == 0)
                                    break;
                                cVar1 = *(char *)(iVar6 + (uint)*pbVar13);
                            joined_r0x00098d74:
                            } while (cVar1 == '\0');
                            goto LAB_00098ae8;
                        }
                        goto LAB_00098af0;
                    }
                    uVar8 = 0;
                }
                cVar1 = *(char *)(iVar4 + uVar8);
                pbVar10 = pbVar13;
                while (cVar1 != '\0') {
                    pbVar10 = pbVar10 + 1;
                    uVar8 = (uint)*pbVar10;
                    cVar1 = *(char *)(iVar4 + uVar8);
                }
            } while (uVar8 != 0);
            piVar3 = (int *)malloc(
                (size_t)(pbVar10 + ((iVar9 * 4 + 8) - (int)pbVar12)));
            if (piVar3 == (int *)0x0) {
                /* WARNING: Subroutine does not return */
                FUN_0001c610(pbVar10 + ((iVar9 * 4 + 8) - (int)pbVar12));
            }
            uVar8 = (uint)*param_1;
            piVar3[1] = (int)(piVar3 + iVar9);
            iVar6 = 0;
            pbVar12 = (byte *)(piVar3 + iVar9);
            do {
                *piVar3 = iVar6 + 1;
                piVar3[iVar6 + 1] = (int)pbVar12;
                do {
                    while (true) {
                        if ((uVar8 < 0x80) &&
                            ((*(uint *)(&DAT_000af184 + uVar8 * 4) & 0xc01) !=
                             0))
                            goto LAB_00098c0c;
                        if (uVar8 == 0x22)
                            break;
                        if (uVar8 == 0x27) {
                            bVar7 = param_1[1];
                            pbVar10 = param_1 + 1;
                        LAB_00098bac:
                            param_1 = pbVar10 + 1;
                            pbVar13 = param_1;
                            if (bVar7 != 0x27) {
                                do {
                                    if (bVar7 == 0x5c) {
                                        bVar2 = pbVar10[1];
                                        if (bVar2 == 0xd) {
                                            bVar7 = pbVar10[2];
                                            if (bVar7 == 10) {
                                                bVar7 = pbVar10[3];
                                                pbVar10 = pbVar10 + 3;
                                            } else {
                                                pbVar10 = pbVar10 + 2;
                                            }
                                            goto LAB_00098bac;
                                        }
                                        if (bVar2 < 0xe) {
                                            if (bVar2 == 0)
                                                goto LAB_00098dec;
                                            if (bVar2 == 10)
                                                goto code_r0x00098d28;
                                        } else if ((bVar2 == 0x27) ||
                                                   (bVar2 == 0x5c)) {
                                            bVar7 = pbVar10[2];
                                            pbVar13 = pbVar10 + 2;
                                            bVar5 = bVar2;
                                            goto LAB_00098bd4;
                                        }
                                        bVar5 = 0x5c;
                                        bVar7 = bVar2;
                                    } else {
                                        if (bVar7 == 0)
                                            goto LAB_00098dec;
                                        bVar5 = bVar7;
                                        bVar7 = pbVar10[1];
                                    }
                                LAB_00098bd4:
                                    *pbVar12 = bVar5;
                                    param_1 = pbVar13 + 1;
                                    pbVar12 = pbVar12 + 1;
                                    pbVar10 = pbVar13;
                                    pbVar13 = param_1;
                                    if (bVar7 == 0x27)
                                        break;
                                } while (true);
                            }
                            if (param_1 == (byte *)0x0)
                                goto LAB_00098dec;
                            uVar8 = (uint)*param_1;
                            if ((uVar8 < 0x80) &&
                                ((*(uint *)(&DAT_000af184 + uVar8 * 4) &
                                  0xc01) != 0))
                                goto LAB_00098c0c;
                        } else {
                            if (uVar8 == 0) {
                                *pbVar12 = (byte)uVar8;
                                goto LAB_00098dbc;
                            }
                            *pbVar12 = (byte)uVar8;
                            param_1 = param_1 + 1;
                            uVar8 = (uint)*param_1;
                            pbVar12 = pbVar12 + 1;
                        }
                    }
                    pbVar10 = param_1 + 1;
                LAB_00098c84:
                    local_2d = *pbVar10;
                    param_1 = pbVar10 + 1;
                    if (local_2d != 0x22) {
                        if (local_2d == 0x5c)
                            goto LAB_00098ce0;
                        pbVar10 = param_1;
                        if (local_2d != 0)
                            goto LAB_00098ca8;
                        goto LAB_00098dec;
                    }
                    if (param_1 == (byte *)0x0) {
                    LAB_00098dec:
                        piVar11 = (int *)0x0;
                        free(piVar3);
                        piVar3 = __errno_location();
                        *piVar3 = 0x16;
                        goto LAB_00098dcc;
                    }
                    uVar8 = (uint)pbVar10[1];
                } while ((0x7f < uVar8) ||
                         ((*(uint *)(&DAT_000af184 + uVar8 * 4) & 0xc01) == 0));
            LAB_00098c0c:
                iVar9 = DAT_00117334;
                if (DAT_00117334 == 0) {
                    iVar9 = FUN_0008e2f8(0xc);
                }
                uVar8 = (uint)param_1[1];
                cVar1 = *(char *)(iVar9 + uVar8);
                param_1 = param_1 + 1;
                while (cVar1 != '\0') {
                    param_1 = param_1 + 1;
                    uVar8 = (uint)*param_1;
                    cVar1 = *(char *)(iVar9 + uVar8);
                }
                *pbVar12 = 0;
                if (uVar8 == 0)
                    goto LAB_00098dbc;
                iVar6 = *piVar3;
                pbVar12 = pbVar12 + 1;
            } while (true);
        }
    }
    piVar3 = __errno_location();
    piVar11 = (int *)0x0;
    *piVar3 = 2;
LAB_00098dcc:
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail(piVar11);
LAB_00098ce0:
    iVar9 = FUN_00091ddc(param_1, &local_2d, 0x7f);
    pbVar10 = param_1 + iVar9;
    if (local_2d != 0x7f) {
    LAB_00098ca8:
        *pbVar12 = local_2d;
        pbVar12 = pbVar12 + 1;
    }
    goto LAB_00098c84;
code_r0x00098d28:
    bVar7 = pbVar10[2];
    pbVar10 = pbVar10 + 2;
    goto LAB_00098bac;
LAB_00098dbc:
    piVar3[*piVar3 + 1] = 0;
    piVar11 = piVar3;
    goto LAB_00098dcc;
}

void FUN_00098e84(int param_1, int param_2)

{
    char *pcVar1;
    int *__ptr;
    size_t sVar2;
    int iVar3;
    undefined1 *__dest;
    int iVar4;
    uint uVar5;
    int iVar6;
    undefined4 uVar7;
    undefined4 uVar8;
    int local_bc[4];
    undefined1 auStack_ac[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((*(uint *)(param_1 + 0xc) & 0x100) != 0) {
        pcVar1 = getenv(*(char **)(param_1 + 0x20));
        if ((pcVar1 != (char *)0x0) &&
            (__ptr = (int *)FUN_00098a20(), __ptr != (int *)0x0)) {
            iVar3 = *__ptr;
            uVar5 = *(uint *)(param_1 + 0xc);
            uVar7 = *(undefined4 *)(param_1 + 4);
            uVar8 = *(undefined4 *)(param_1 + 8);
            *(undefined4 *)(param_1 + 0x10) = 1;
            *(undefined4 *)(param_1 + 0x14) = 0;
            *(uint *)(param_1 + 0xc) = uVar5 & 0xfffffffb;
            *(int *)(param_1 + 4) = iVar3 + 1;
            *(int **)(param_1 + 8) = __ptr;
            if (param_2 == 1) {
                FUN_00096ad8(param_1);
            } else {
                if (param_2 != 2) {
                    FUN_00096ad8(param_1);
                    *(undefined4 *)(param_1 + 0x14) = 0;
                    *(undefined4 *)(param_1 + 0x10) = 1;
                }
                FUN_000969ac(param_1);
            }
            free(__ptr);
            *(undefined4 *)(param_1 + 4) = uVar7;
            *(undefined4 *)(param_1 + 8) = uVar8;
            *(uint *)(param_1 + 0xc) = uVar5;
        }
        iVar6 = *(int *)(param_1 + 0x68);
        local_bc[0] = *(int *)(param_1 + 0x44);
        iVar4 = iVar6 + -1;
        iVar3 = FUN_0007c054(auStack_ac, 0x80, &DAT_000b2964,
                             *(undefined4 *)(param_1 + 0x20));
        __dest = auStack_ac + iVar3;
        if (0 < iVar6) {
            do {
                iVar6 = local_bc[0];
                if (((*(uint *)(local_bc[0] + 0x10) & 0x100) == 0) &&
                    (*(short *)(local_bc[0] + 8) == -0x8000)) {
                    pcVar1 = *(char **)(local_bc[0] + 0x30);
                    sVar2 = strlen(pcVar1);
                    if (sVar2 + 1 <= 0x7fU - iVar3) {
                        memcpy(__dest, pcVar1, sVar2 + 1);
                        FUN_00097194(local_bc, auStack_ac, param_1, param_2);
                        iVar6 = local_bc[0];
                    }
                }
                iVar4 = iVar4 + -1;
                local_bc[0] = iVar6 + 0x40;
            } while (iVar4 != -1);
        }
        if ((*(ushort *)(param_1 + 0x5e) & 0x7fff) != 0) {
            local_bc[0] = *(int *)(param_1 + 0x44) +
                          (*(ushort *)(param_1 + 0x5e) + 1) * 0x40;
            pcVar1 = *(char **)(local_bc[0] + 0x30);
            if (pcVar1 != (char *)0x0) {
                sVar2 = strlen(pcVar1);
                if (sVar2 + 1 <= 0x7fU - iVar3) {
                    memcpy(__dest, pcVar1, sVar2 + 1);
                    FUN_00097194(local_bc, auStack_ac, param_1, param_2);
                }
            }
        }
    }
    if (local_2c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00099944(int param_1, int param_2)

{
    uint uVar1;
    int iVar2;
    undefined4 uVar3;
    undefined4 local_20;
    int local_1c;

    local_20 = 0;
    local_1c = __stack_chk_guard;
    FUN_00096d90(param_1 + 0xc, 0);
    uVar1 = *(uint *)(param_1 + 0xc);
    if ((param_2 == 0) || ((uVar1 & 0x4000) == 0)) {
        if ((uVar1 & 0x1000) == 0) {
            FUN_0008d588();
        } else {
            FUN_0008d420(uVar1, &local_20);
        }
        FUN_000906bc(param_1, param_2, local_20);
        fflush(option_usage_fp);
        iVar2 = ferror(option_usage_fp);
        if (iVar2 != 0) {
            uVar3 = option_xlateable_txt._224_4_;
            if (option_usage_fp != stderr) {
                uVar3 = option_xlateable_txt._220_4_;
            }
            /* WARNING: Subroutine does not return */
            FUN_0008cf18(*(undefined4 *)(param_1 + 0x1c),
                         option_xlateable_txt._228_4_, uVar3);
        }
    }
    if (local_1c == __stack_chk_guard) {
        return;
    }
    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
}

void FUN_00099a3c(char *param_1, uint param_2, FILE *param_3)

{
    undefined2 uVar1;
    size_t sVar2;
    byte *__ptr;
    char *pcVar3;
    ushort **ppuVar4;
    int *piVar5;
    int iVar6;
    int iVar7;
    int iVar8;
    uint uVar9;
    byte *__s;
    undefined4 uVar10;
    uint uVar11;
    int iVar12;
    byte *pbVar13;
    byte *pbVar14;
    uint extraout_r12;
    bool bVar15;
    undefined8 uVar16;
    char *pcStack_78;
    undefined4 uStack_74;
    ushort uStack_70;
    undefined1 uStack_6e;
    int iStack_5c;
    char *pcStack_54;
    uint uStack_50;
    size_t sStack_4c;
    undefined4 *puStack_48;
    uint uStack_44;
    FILE *pFStack_40;
    undefined4 uStack_3c;
    uint local_34;
    int local_2c;

    local_2c = __stack_chk_guard;
    sVar2 = strlen(param_1);
    uVar9 = param_2;
    if (sVar2 < 0x100) {
        uVar9 = param_2 | 1;
    }
    if (uVar9 != 0) {
        if (param_2 == 0) {
            if (local_2c == __stack_chk_guard) {
                FUN_00094a50(param_1, param_3);
                return;
            }
        } else if (local_2c == __stack_chk_guard) {
            fputs(param_1, param_3);
            return;
        }
    LAB_00099bd4:
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    __ptr = (byte *)__strdup(param_1);
    bVar15 = __ptr == (byte *)0x0;
    __s = __ptr;
    pbVar13 = __ptr;
    if (!bVar15) {
    LAB_00099ae4:
        do {
            do {
                do {
                    pcVar3 = strchr((char *)__s, 10);
                    pbVar14 = pbVar13;
                    if (pcVar3 == (char *)0x0)
                        goto LAB_00099ba8;
                    pbVar14 = (byte *)(pcVar3 + 1);
                    __s = pbVar14;
                } while ((int)pcVar3 - (int)pbVar13 < 0x28);
                ppuVar4 = __ctype_b_loc();
                uVar11 = (uint)(byte)pcVar3[1];
                uVar9 = (((*ppuVar4)[uVar11] ^ 0x2000) << 0x12) >> 0x1f;
                if (uVar11 == 9) {
                    uVar9 = 1;
                }
            } while (uVar9 != 0);
            if (uVar11 == 10) {
                do {
                    pbVar14 = pbVar14 + 1;
                    uVar11 = (uint)*pbVar14;
                } while (uVar11 == 10);
            } else if (uVar11 == 0x20) {
                do {
                    __s = __s + 1;
                    if (*__s != 0x20)
                        goto LAB_00099b74;
                } while (__s != (byte *)(pcVar3 + 8));
                goto LAB_00099ae4;
            }
        LAB_00099b74:
            *pbVar14 = 0;
            local_34 = uVar11;
            FUN_00094a50(pbVar13, param_3);
            sVar2 = sVar2 - ((int)pbVar14 - (int)pbVar13);
            if (sVar2 == 0)
                goto LAB_00099bb4;
            *pbVar14 = (byte)local_34;
            __s = pbVar14;
            pbVar13 = pbVar14;
        } while (0xff < sVar2);
    LAB_00099ba8:
        FUN_00094a50(pbVar14, param_3);
    LAB_00099bb4:
        if (local_2c == __stack_chk_guard) {
            free(__ptr);
            return;
        }
        goto LAB_00099bd4;
    }
    uVar16 = FUN_0008e624(param_1);
    iVar7 = (int)((ulonglong)uVar16 >> 0x20);
    piVar5 = (int *)uVar16;
    if (bVar15) {
        piVar5 = (int *)((uint)piVar5 & extraout_r12 >> 0x10);
    }
    uStack_3c = 0x99be0;
    iStack_5c = __stack_chk_guard;
    iVar8 = iVar7;
    pcStack_54 = param_1;
    uStack_50 = param_2;
    sStack_4c = sVar2;
    puStack_48 = &__stack_chk_guard;
    uStack_44 = uVar9;
    pFStack_40 = param_3;
    if (iVar7 == 0x2750) {
        DAT_001173cc = '\0';
        FUN_00096d90(piVar5 + 3, 0);
    LAB_00099de0:
        if (*piVar5 < 0x1e000) {
            pcVar3 = (char *)0x0;
        } else {
            pcVar3 = (char *)piVar5[0x1b];
        }
        if (option_usage_fp == (FILE *)0x0) {
            option_usage_fp = stdout;
            if (DAT_001172c4 != '\0') {
                option_usage_fp = stderr;
            }
            uVar9 = piVar5[3];
        } else {
            uVar9 = piVar5[3];
        }
        if (((uVar9 & 0x100000) == 0) && (iVar8 = 0, pcVar3 != (char *)0x0)) {
        LAB_00099e18:
            iVar7 = iVar8;
            if ((uVar9 & 0x2000) == 0) {
                fputs(pcVar3, option_usage_fp);
            } else {
                FUN_00099a3c(pcVar3, 1);
            }
            goto LAB_00099e28;
        }
        fprintf(option_usage_fp, (char *)piVar5[0xe], piVar5[7]);
        uVar9 = piVar5[3];
        pcStack_78 = (char *)0x0;
        if ((int)(uVar9 << 0x13) < 0) {
            iVar8 = 0;
        LAB_00099ca8:
            iVar6 = FUN_0008d420(uVar9, &pcStack_78);
            sprintf(&DAT_001173d0, "%%-%ds %%s\n", iVar6);
            fputc(10, option_usage_fp);
        } else {
            iVar6 = FUN_0008d588(uVar9, &pcStack_78);
            sprintf(&DAT_001173d0, "%%-%ds %%s\n", iVar6);
            iVar8 = 0;
            if ((iVar7 != 0) ||
                (iVar8 = iVar7,
                 (*(uint *)(piVar5[0x11] + 0x10) & 0x200000) == 0)) {
            LAB_00099f1c:
                fputs(pcStack_78, option_usage_fp);
            }
        }
        iVar12 = iVar6 + 0xf;
        if (iVar12 < 0) {
            iVar12 = iVar6 + 0x16;
        }
        iVar6 = 4 - (iVar12 >> 3);
        if (0 < iVar6) {
            DAT_001173c8 = iVar6;
        }
        FUN_000906bc(piVar5, iVar7, pcStack_78);
        uVar9 = piVar5[3];
        uVar11 = uVar9 & 3;
        if (uVar11 == 1) {
            fputs((char *)option_xlateable_txt._308_4_, option_usage_fp);
            uVar9 = piVar5[3];
        } else if (uVar11 == 0) {
            fputs((char *)option_xlateable_txt._336_4_, option_usage_fp);
            uVar9 = piVar5[3];
        } else if (uVar11 == 3) {
            fputs((char *)option_xlateable_txt._288_4_, option_usage_fp);
            uVar9 = piVar5[3];
        }
        if ((uVar9 & 0x20) != 0) {
            fputs((char *)option_xlateable_txt._332_4_, option_usage_fp);
            uVar9 = piVar5[3];
        }
        if ((uVar9 & 0x800) != 0) {
            fputs((char *)option_xlateable_txt._396_4_, option_usage_fp);
        }
        if ((char *)piVar5[0xf] != (char *)0x0) {
            fputs((char *)piVar5[0xf], option_usage_fp);
        }
        if (iVar7 == 0) {
            if (piVar5[0xd] == 0) {
                if ((piVar5[3] & 0x100U) != 0) {
                    fputs((char *)option_xlateable_txt._352_4_,
                          option_usage_fp);
                    goto LAB_0009a040;
                }
            } else {
                FUN_00094264(piVar5[0xd], piVar5[9], piVar5[6]);
                if ((piVar5[3] & 0x100U) != 0) {
                LAB_0009a040:
                    fprintf(option_usage_fp,
                            (char *)option_xlateable_txt._276_4_, piVar5[8]);
                }
            }
            if (DAT_001173cc != '\0') {
                iVar6 = piVar5[0x19];
                iVar7 = piVar5[0x11];
                fputc(10, option_usage_fp);
                fflush(option_usage_fp);
                do {
                    uVar9 = (uint)(*(int *)(iVar7 + 0x10) << 0x10) >> 0x1c;
                    if ((uVar9 == 2) || (uVar9 == 4)) {
                        (**(code **)(iVar7 + 0x28))(1, iVar7);
                    }
                    iVar6 = iVar6 + -1;
                    iVar7 = iVar7 + 0x40;
                } while (0 < iVar6);
            }
            if ((char *)piVar5[0x10] != (char *)0x0) {
                fputs((char *)piVar5[0x10], option_usage_fp);
            }
        }
        if ((*piVar5 < 0x22000) || ((char *)piVar5[0x20] == (char *)0x0)) {
            if (piVar5[0x12] != 0) {
                fprintf(option_usage_fp, (char *)option_xlateable_txt._344_4_);
            }
        } else {
            fputs((char *)piVar5[0x20], option_usage_fp);
        }
        fflush(option_usage_fp);
        iVar6 = ferror(option_usage_fp);
        iVar7 = iVar8;
        if (iVar6 == 0)
            goto LAB_00099e28;
        iVar7 = piVar5[7];
        uVar10 = option_xlateable_txt._224_4_;
        if (option_usage_fp == stderr)
            goto LAB_00099e6c;
    } else {
        DAT_001173cc = '\0';
        FUN_00096d90(piVar5 + 3, 0);
        if (iVar7 == 0)
            goto LAB_00099de0;
        if (*piVar5 < 0x1e000) {
            pcVar3 = (char *)0x0;
        } else {
            pcVar3 = (char *)piVar5[0x1c];
        }
        if (option_usage_fp != (FILE *)0x0) {
            uVar9 = piVar5[3];
            if ((uVar9 & 0x100000) != 0)
                goto LAB_00099c78;
        LAB_00099c70:
            if (pcVar3 == (char *)0x0)
                goto LAB_00099c78;
            goto LAB_00099e18;
        }
        option_usage_fp = stderr;
        uVar9 = piVar5[3];
        if ((uVar9 & 0x100000) == 0)
            goto LAB_00099c70;
    LAB_00099c78:
        fprintf(option_usage_fp, (char *)piVar5[0xe], piVar5[7]);
        uVar9 = piVar5[3];
        pcVar3 = (char *)-((int)(uVar9 << 0x11) >> 0x1f);
        if (pcVar3 == (char *)0x0) {
            pcStack_78 = pcVar3;
            if ((uVar9 & 0x1000) == 0) {
                iVar6 = FUN_0008d588(uVar9, &pcStack_78);
                sprintf(&DAT_001173d0, "%%-%ds %%s\n", iVar6);
                goto LAB_00099f1c;
            }
            goto LAB_00099ca8;
        }
        uVar1 = uStack_74._2_2_;
        if (*piVar5 < 0x26000) {
            uVar9 = uVar9 & 3;
            if (uVar9 == 2) {
                uStack_74 = CONCAT13(uStack_74._3_1_, 0x682d);
            } else if ((uVar9 == 3) || (uVar9 == 1)) {
                uStack_74 = 0x65682d2d;
                uStack_70 = 0x706c;
                uStack_6e = 0;
            } else {
                uStack_74 = 0x706c6568;
                uStack_70 = uStack_70 & 0xff00;
            }
        } else {
            iVar8 = piVar5[0x11] + piVar5[0x1a] * 0x40;
            if (*(int *)(iVar8 + 0x14) != 3) {
                iVar12 = piVar5[0x1a] + 1;
                iVar6 = iVar8;
                if (iVar12 < piVar5[0x19]) {
                    do {
                        iVar8 = iVar6 + 0x40;
                        if (*(int *)(iVar6 + 0x54) == 3)
                            goto LAB_0009a0d8;
                        iVar12 = iVar12 + 1;
                        iVar6 = iVar8;
                    } while (iVar12 != piVar5[0x19]);
                }
                /* WARNING: Subroutine does not return */
                FUN_0008cec0(option_xlateable_txt._56_4_);
            }
        LAB_0009a0d8:
            uVar9 = uVar9 & 3;
            if (uVar9 == 2) {
                uStack_74 = (uint)uStack_74._3_1_ << 0x18;
                uStack_74._0_2_ =
                    CONCAT11((char)*(undefined2 *)(iVar8 + 2), 0x2d);
            } else if ((uVar9 == 3) || (uVar9 == 1)) {
                uStack_74 = CONCAT22(uVar1, 0x2d2d);
                strncpy((char *)((int)&uStack_74 + 2), *(char **)(iVar8 + 0x34),
                        0x14);
            } else {
                strncpy((char *)&uStack_74, *(char **)(iVar8 + 0x34), 0x14);
            }
        }
        fprintf(option_usage_fp, (char *)option_xlateable_txt._212_4_,
                piVar5[7], &uStack_74);
    LAB_00099e28:
        fflush(option_usage_fp);
        iVar8 = ferror(option_usage_fp);
        if (iVar8 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0008ce5c(iVar7);
        }
        iVar7 = piVar5[7];
        uVar10 = option_xlateable_txt._224_4_;
        if (option_usage_fp != stdout)
            goto LAB_00099e6c;
    }
    uVar10 = option_xlateable_txt._220_4_;
LAB_00099e6c:
    /* WARNING: Subroutine does not return */
    FUN_0008cf18(iVar7, option_xlateable_txt._228_4_, uVar10);
}

void FUN_00099be8(int *param_1, int param_2)

{
    undefined2 uVar1;
    char *pcVar2;
    int iVar3;
    int iVar4;
    uint uVar5;
    undefined4 uVar6;
    uint uVar7;
    int iVar8;
    char *local_40;
    undefined4 local_3c;
    ushort local_38;
    undefined1 local_36;
    undefined4 local_24;

    local_24 = __stack_chk_guard;
    iVar4 = param_2;
    if (param_2 == 0x2750) {
        DAT_001173cc = '\0';
        FUN_00096d90(param_1 + 3, 0);
    LAB_00099de0:
        if (*param_1 < 0x1e000) {
            pcVar2 = (char *)0x0;
        } else {
            pcVar2 = (char *)param_1[0x1b];
        }
        if (option_usage_fp == (FILE *)0x0) {
            option_usage_fp = stdout;
            if (DAT_001172c4 != '\0') {
                option_usage_fp = stderr;
            }
            uVar7 = param_1[3];
        } else {
            uVar7 = param_1[3];
        }
        if (((uVar7 & 0x100000) == 0) && (iVar4 = 0, pcVar2 != (char *)0x0)) {
        LAB_00099e18:
            param_2 = iVar4;
            if ((uVar7 & 0x2000) == 0) {
                fputs(pcVar2, option_usage_fp);
            } else {
                FUN_00099a3c(pcVar2, 1);
            }
            goto LAB_00099e28;
        }
        fprintf(option_usage_fp, (char *)param_1[0xe], param_1[7]);
        uVar7 = param_1[3];
        local_40 = (char *)0x0;
        if ((int)(uVar7 << 0x13) < 0) {
            iVar4 = 0;
        LAB_00099ca8:
            iVar3 = FUN_0008d420(uVar7, &local_40);
            sprintf(&DAT_001173d0, "%%-%ds %%s\n", iVar3);
            fputc(10, option_usage_fp);
        } else {
            iVar3 = FUN_0008d588(uVar7, &local_40);
            sprintf(&DAT_001173d0, "%%-%ds %%s\n", iVar3);
            iVar4 = 0;
            if ((param_2 != 0) ||
                (iVar4 = param_2,
                 (*(uint *)(param_1[0x11] + 0x10) & 0x200000) == 0)) {
            LAB_00099f1c:
                fputs(local_40, option_usage_fp);
            }
        }
        iVar8 = iVar3 + 0xf;
        if (iVar8 < 0) {
            iVar8 = iVar3 + 0x16;
        }
        iVar3 = 4 - (iVar8 >> 3);
        if (0 < iVar3) {
            DAT_001173c8 = iVar3;
        }
        FUN_000906bc(param_1, param_2, local_40);
        uVar7 = param_1[3];
        uVar5 = uVar7 & 3;
        if (uVar5 == 1) {
            fputs((char *)option_xlateable_txt._308_4_, option_usage_fp);
            uVar7 = param_1[3];
        } else if (uVar5 == 0) {
            fputs((char *)option_xlateable_txt._336_4_, option_usage_fp);
            uVar7 = param_1[3];
        } else if (uVar5 == 3) {
            fputs((char *)option_xlateable_txt._288_4_, option_usage_fp);
            uVar7 = param_1[3];
        }
        if ((uVar7 & 0x20) != 0) {
            fputs((char *)option_xlateable_txt._332_4_, option_usage_fp);
            uVar7 = param_1[3];
        }
        if ((uVar7 & 0x800) != 0) {
            fputs((char *)option_xlateable_txt._396_4_, option_usage_fp);
        }
        if ((char *)param_1[0xf] != (char *)0x0) {
            fputs((char *)param_1[0xf], option_usage_fp);
        }
        if (param_2 == 0) {
            if (param_1[0xd] == 0) {
                if ((param_1[3] & 0x100U) != 0) {
                    fputs((char *)option_xlateable_txt._352_4_,
                          option_usage_fp);
                    goto LAB_0009a040;
                }
            } else {
                FUN_00094264(param_1[0xd], param_1[9], param_1[6]);
                if ((param_1[3] & 0x100U) != 0) {
                LAB_0009a040:
                    fprintf(option_usage_fp,
                            (char *)option_xlateable_txt._276_4_, param_1[8]);
                }
            }
            if (DAT_001173cc != '\0') {
                iVar8 = param_1[0x19];
                iVar3 = param_1[0x11];
                fputc(10, option_usage_fp);
                fflush(option_usage_fp);
                do {
                    uVar7 = (uint)(*(int *)(iVar3 + 0x10) << 0x10) >> 0x1c;
                    if ((uVar7 == 2) || (uVar7 == 4)) {
                        (**(code **)(iVar3 + 0x28))(1, iVar3);
                    }
                    iVar8 = iVar8 + -1;
                    iVar3 = iVar3 + 0x40;
                } while (0 < iVar8);
            }
            if ((char *)param_1[0x10] != (char *)0x0) {
                fputs((char *)param_1[0x10], option_usage_fp);
            }
        }
        if ((*param_1 < 0x22000) || ((char *)param_1[0x20] == (char *)0x0)) {
            if (param_1[0x12] != 0) {
                fprintf(option_usage_fp, (char *)option_xlateable_txt._344_4_);
            }
        } else {
            fputs((char *)param_1[0x20], option_usage_fp);
        }
        fflush(option_usage_fp);
        iVar3 = ferror(option_usage_fp);
        param_2 = iVar4;
        if (iVar3 == 0)
            goto LAB_00099e28;
        iVar4 = param_1[7];
        uVar6 = option_xlateable_txt._224_4_;
        if (option_usage_fp == stderr)
            goto LAB_00099e6c;
    } else {
        DAT_001173cc = '\0';
        FUN_00096d90(param_1 + 3, 0);
        if (param_2 == 0)
            goto LAB_00099de0;
        if (*param_1 < 0x1e000) {
            pcVar2 = (char *)0x0;
        } else {
            pcVar2 = (char *)param_1[0x1c];
        }
        if (option_usage_fp != (FILE *)0x0) {
            uVar7 = param_1[3];
            if ((uVar7 & 0x100000) != 0)
                goto LAB_00099c78;
        LAB_00099c70:
            if (pcVar2 == (char *)0x0)
                goto LAB_00099c78;
            goto LAB_00099e18;
        }
        option_usage_fp = stderr;
        uVar7 = param_1[3];
        if ((uVar7 & 0x100000) == 0)
            goto LAB_00099c70;
    LAB_00099c78:
        fprintf(option_usage_fp, (char *)param_1[0xe], param_1[7]);
        uVar7 = param_1[3];
        pcVar2 = (char *)-((int)(uVar7 << 0x11) >> 0x1f);
        if (pcVar2 == (char *)0x0) {
            local_40 = pcVar2;
            if ((uVar7 & 0x1000) == 0) {
                iVar3 = FUN_0008d588(uVar7, &local_40);
                sprintf(&DAT_001173d0, "%%-%ds %%s\n", iVar3);
                goto LAB_00099f1c;
            }
            goto LAB_00099ca8;
        }
        uVar1 = local_3c._2_2_;
        if (*param_1 < 0x26000) {
            uVar7 = uVar7 & 3;
            if (uVar7 == 2) {
                local_3c = CONCAT13(local_3c._3_1_, 0x682d);
            } else if ((uVar7 == 3) || (uVar7 == 1)) {
                local_3c = 0x65682d2d;
                local_38 = 0x706c;
                local_36 = 0;
            } else {
                local_3c = 0x706c6568;
                local_38 = local_38 & 0xff00;
            }
        } else {
            iVar4 = param_1[0x11] + param_1[0x1a] * 0x40;
            if (*(int *)(iVar4 + 0x14) != 3) {
                iVar8 = param_1[0x1a] + 1;
                iVar3 = iVar4;
                if (iVar8 < param_1[0x19]) {
                    do {
                        iVar4 = iVar3 + 0x40;
                        if (*(int *)(iVar3 + 0x54) == 3)
                            goto LAB_0009a0d8;
                        iVar8 = iVar8 + 1;
                        iVar3 = iVar4;
                    } while (iVar8 != param_1[0x19]);
                }
                /* WARNING: Subroutine does not return */
                FUN_0008cec0(option_xlateable_txt._56_4_);
            }
        LAB_0009a0d8:
            uVar7 = uVar7 & 3;
            if (uVar7 == 2) {
                local_3c = (uint)local_3c._3_1_ << 0x18;
                local_3c._0_2_ =
                    CONCAT11((char)*(undefined2 *)(iVar4 + 2), 0x2d);
            } else if ((uVar7 == 3) || (uVar7 == 1)) {
                local_3c = CONCAT22(uVar1, 0x2d2d);
                strncpy((char *)((int)&local_3c + 2), *(char **)(iVar4 + 0x34),
                        0x14);
            } else {
                strncpy((char *)&local_3c, *(char **)(iVar4 + 0x34), 0x14);
            }
        }
        fprintf(option_usage_fp, (char *)option_xlateable_txt._212_4_,
                param_1[7], &local_3c);
    LAB_00099e28:
        fflush(option_usage_fp);
        iVar4 = ferror(option_usage_fp);
        if (iVar4 == 0) {
            /* WARNING: Subroutine does not return */
            FUN_0008ce5c(param_2);
        }
        iVar4 = param_1[7];
        uVar6 = option_xlateable_txt._224_4_;
        if (option_usage_fp != stdout)
            goto LAB_00099e6c;
    }
    uVar6 = option_xlateable_txt._220_4_;
LAB_00099e6c:
    /* WARNING: Subroutine does not return */
    FUN_0008cf18(iVar4, option_xlateable_txt._228_4_, uVar6);
}

void FUN_0009a30c(int param_1, int param_2)

{
    int iVar1;
    __pid_t _Var2;
    byte *pbVar3;
    __int32_t **pp_Var4;
    __int32_t *p_Var5;
    uint uVar6;
    undefined4 uVar7;
    undefined1 auStack_30[4];
    undefined4 local_2c;

    local_2c = __stack_chk_guard;
    if (param_2 != 0) {
        FUN_00099be8();
    }
    fflush(stderr);
    fflush(stdout);
    iVar1 = ferror(stdout);
    if ((iVar1 != 0) || (iVar1 = ferror(stderr), iVar1 != 0)) {
        /* WARNING: Subroutine does not return */
        FUN_0008ce5c(1);
    }
    option_usage_fp = stdout;
    _Var2 = fork();
    if (_Var2 == -1) {
        FUN_00099be8(param_1, 1);
    LAB_0009a49c:
        DAT_001173bc = 2;
        FUN_00099be8(param_1, 0);
        /* WARNING: Subroutine does not return */
        _exit(1);
    }
    if (_Var2 == 0)
        goto LAB_0009a49c;
    wait(auStack_30);
    iVar1 = optionParseShellOptions;
    uVar7 = *(undefined4 *)(optionParseShellOptions + 0x20);
    pbVar3 = (byte *)__strdup(uVar7);
    if (pbVar3 == (byte *)0x0) {
        FUN_0008e624(uVar7);
        goto LAB_0009a4c8;
    }
    *(byte **)(iVar1 + 0x1c) = pbVar3;
    uVar6 = (uint)*pbVar3;
    if (uVar6 != 0) {
        pp_Var4 = __ctype_tolower_loc();
        p_Var5 = *pp_Var4;
        do {
            *pbVar3 = (byte)p_Var5[uVar6];
            pbVar3 = pbVar3 + 1;
            uVar6 = (uint)*pbVar3;
        } while (uVar6 != 0);
    }
    fprintf(option_usage_fp, (char *)option_xlateable_txt._292_4_,
            *(undefined4 *)(optionParseShellOptions + 0x1c));
    fflush(option_usage_fp);
    _Var2 = fork();
    if (_Var2 == -1) {
    LAB_0009a454:
        FUN_00099be8(optionParseShellOptions, 1);
    } else if (_Var2 == 0) {
        DAT_001173bc = 2;
        goto LAB_0009a454;
    }
    wait(auStack_30);
    fflush(stdout);
    iVar1 = ferror(stdout);
    if (iVar1 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0008cf18(*(undefined4 *)(param_1 + 0x1c),
                     option_xlateable_txt._228_4_,
                     option_xlateable_txt._220_4_);
    }
LAB_0009a4c8:
    /* WARNING: Subroutine does not return */
    FUN_0008ce5c();
}

/* WARNING: Removing unreachable block (ram,0x0009a578) */

undefined *FUN_0009a534(void)

{
    return &DAT_000af6c4;
}

void FUN_0009a588(int *param_1, uint *param_2, undefined4 *param_3,
                  FILE *param_4, char param_5)

{
    char cVar1;
    int iVar2;
    int iVar3;
    char *__s;
    undefined4 uVar4;
    undefined4 uVar5;

    iVar2 = __stack_chk_guard;
    if ((((*param_2 & 0x10000) == 0) || ((char *)*param_3 == (char *)0x0)) ||
        (cVar1 = *(char *)*param_3, cVar1 == '\0')) {
        FUN_00096d90(param_1 + 3, 0);
        if ((param_1[3] & 0x1000U) == 0)
            goto LAB_0009a6d0;
        goto LAB_0009a71c;
    }
    switch (cVar1) {
    case 'C':
        goto LAB_0009a71c;
    case 'D':
        break;
    case 'E':
        break;
    case 'F':
        break;
    case 'G':
        break;
    case 'H':
        break;
    case 'I':
        break;
    case 'J':
        break;
    case 'K':
        break;
    case 'L':
        break;
    case 'M':
        break;
    case 'N':
        goto LAB_0009a7a0;
    case 'O':
        break;
    case 'P':
        break;
    case 'Q':
        break;
    case 'R':
        break;
    case 'S':
        break;
    case 'T':
        break;
    case 'U':
        break;
    case 'V':
        goto LAB_0009a6d0;
    case 'W':
        break;
    case 'X':
        break;
    case 'Y':
        break;
    case 'Z':
        break;
    case '[':
        break;
    case '\\':
        break;
    case ']':
        break;
    case '^':
        break;
    case '_':
        break;
    case '`':
        break;
    case 'a':
        break;
    case 'b':
        break;
    case 'c':
    LAB_0009a71c:
        __s = (char *)param_1[10];
        if ((__s == (char *)0x0) &&
            (__s = (char *)param_1[0xc], __s == (char *)0x0)) {
            FUN_0008c6dc(param_4, param_1[0xe], 0, 0);
        } else {
            fputs(__s, param_4);
        }
        if ((*param_1 < 0x22000) || (param_1[0x20] == 0)) {
            if (param_1[0x12] != 0) {
                fputc(10, param_4);
                fprintf(param_4, (char *)option_xlateable_txt._344_4_,
                        param_1[0x12]);
            }
        } else {
        LAB_0009a80c:
            fputc(10, param_4);
            fputs((char *)param_1[0x20], param_4);
        }
    LAB_0009a6e4:
        fflush(param_4);
        iVar3 = ferror(param_4);
        if (iVar3 != 0) {
            uVar5 = option_xlateable_txt._220_4_;
            if (param_4 != stdout) {
                uVar5 = option_xlateable_txt._224_4_;
            }
            /* WARNING: Subroutine does not return */
            FUN_0008cf18(param_1[7], option_xlateable_txt._228_4_, uVar5);
        }
        if (param_5 == '\0') {
            if (iVar2 == __stack_chk_guard) {
                return;
            }
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        /* WARNING: Subroutine does not return */
        FUN_0008ce5c();
    case 'd':
        break;
    case 'e':
        break;
    case 'f':
        break;
    case 'g':
        break;
    case 'h':
        break;
    case 'i':
        break;
    case 'j':
        break;
    case 'k':
        break;
    case 'l':
        break;
    case 'm':
        break;
    case 'n':
    LAB_0009a7a0:
        if ((char *)param_1[10] != (char *)0x0) {
            fputs((char *)param_1[10], param_4);
        }
        if ((char *)param_1[0xb] != (char *)0x0) {
            fputs((char *)param_1[0xb], param_4);
        }
        fputc(10, param_4);
        uVar5 = option_xlateable_txt._44_4_;
        uVar4 = FUN_0009a534();
        fprintf(param_4, (char *)uVar5, uVar4);
        if ((*param_1 < 0x22000) || (param_1[0x20] == 0)) {
            if (param_1[0x12] != 0) {
                fputc(10, param_4);
                fprintf(param_4, (char *)option_xlateable_txt._344_4_,
                        param_1[0x12]);
            }
            goto LAB_0009a6e4;
        }
        goto LAB_0009a80c;
    case 'o':
        break;
    case 'p':
        break;
    case 'q':
        break;
    case 'r':
        break;
    case 's':
        break;
    case 't':
        break;
    case 'u':
        break;
    case 'v':
    LAB_0009a6d0:
        FUN_0008c6dc(param_4, param_1[0xc], param_1[10], param_1[0xe]);
        goto LAB_0009a6e4;
    }
    fprintf(stderr, (char *)option_xlateable_txt._104_4_);
    /* WARNING: Subroutine does not return */
    FUN_0008ce5c(1);
}

void optionPrintVersion(uint param_1, int param_2)

{
    int iVar1;
    undefined4 uVar2;

    iVar1 = __stack_chk_guard;
    uVar2 = stdout;
    if (DAT_001172c4 != '\0') {
        uVar2 = stderr;
    }
    if (0xf < param_1) {
        FUN_0009a588(param_1, param_2 + 0x10, param_2 + 0x18, uVar2, 1);
    }
    if (iVar1 != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

void FUN_0009a95c(int param_1, int param_2, int param_3)

{
    int iVar1;
    __pid_t _Var2;
    FILE *__stream;
    int __c;
    undefined4 uVar3;
    undefined *puVar4;
    int local_34;
    int local_30;
    int local_2c;

    local_2c = __stack_chk_guard;
    fflush(stdout);
    fflush(stderr);
    iVar1 = pipe(&local_34);
    if (iVar1 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0008cf18(*(undefined4 *)(param_1 + 0x1c), &DAT_000b298c,
                     option_xlateable_txt._100_4_);
    }
    _Var2 = fork();
    if (_Var2 == -1) {
        /* WARNING: Subroutine does not return */
        FUN_0008cf18(*(undefined4 *)(param_1 + 0x1c), &DAT_000b2994);
    }
    if (_Var2 != 0) {
        close(local_30);
        uVar3 = *(undefined4 *)(param_1 + 0x20);
        puVar4 = (&PTR_s_LONGUSAGE_000c538c)[param_2];
        __stream = fdopen(local_34, "r");
        printf("%s_%s_TEXT=\'", uVar3, puVar4);
        if (__stream != (FILE *)0x0) {
            iVar1 = 0;
            while (true) {
                while (true) {
                    while (__c = fgetc(__stream), __c == 10) {
                        iVar1 = iVar1 + 1;
                    }
                    if (__c != 0x27)
                        break;
                    for (; iVar1 != 0; iVar1 = iVar1 + -1) {
                        fputc(10, stdout);
                    }
                    fwrite(&DAT_000b00ba, 1, 4, stdout);
                    iVar1 = 0;
                }
                if (__c == -1)
                    break;
                for (; iVar1 != 0; iVar1 = iVar1 + -1) {
                    fputc(10, stdout);
                }
                fputc(__c, stdout);
                iVar1 = 0;
            }
            fclose(__stream);
        }
        fwrite(&DAT_000afef9, 1, 3, stdout);
        if (local_2c != __stack_chk_guard) {
            /* WARNING: Subroutine does not return */
            __stack_chk_fail();
        }
        return;
    }
    dup2(local_30, 2);
    dup2(local_30, 1);
    close(local_34);
    if (param_2 != 1) {
        if (param_2 == 2)
            goto LAB_0009ab68;
        (**(code **)(param_1 + 0x54))(param_1, 0);
    }
    (**(code **)(param_1 + 0x54))(param_1, 1);
LAB_0009ab68:
    if ((*(uint *)(param_3 + 0x10) & 0x40) != 0) {
        free(*(void **)(param_3 + 0x18));
        *(uint *)(param_3 + 0x10) = *(uint *)(param_3 + 0x10) & 0xffffffbf;
    }
    *(char **)(param_3 + 0x18) = "c";
    optionPrintVersion(param_1, param_3);
    /* WARNING: Subroutine does not return */
    FUN_0008ce5c(1);
}

void FUN_0009abec(int param_1)

{
    __int32_t _Var1;
    tm *ptVar2;
    __int32_t **pp_Var3;
    __int32_t *p_Var4;
    FILE *pFVar5;
    char *__haystack;
    char *pcVar6;
    uint uVar7;
    char *pcVar8;
    byte *pbVar9;
    int iVar10;
    int iVar11;
    int iVar12;
    size_t sVar13;
    int iVar14;
    char *pcVar15;
    undefined4 uVar16;
    size_t local_130;
    stat64 local_118;
    char acStack_ac[128];
    int local_2c;

    local_2c = __stack_chk_guard;
    if ((*(uint *)(genshelloptOptions._68_4_ + 0x50) & 0xf) == 0) {
        if ((*(uint *)(genshelloptOptions._68_4_ + 0x50) & 0x20) == 0) {
            DAT_001173fc = getenv("SHELL");
            if (DAT_001173fc == (char *)0x0) {
                DAT_001173fc = "/bin/bash";
            }
            goto LAB_0009ac40;
        }
        DAT_001173fc = (char *)0x0;
        uVar7 = *(uint *)(genshelloptOptions._68_4_ + 0x10);
    } else {
        DAT_001173fc = *(char **)(genshelloptOptions._68_4_ + 0x58);
    LAB_0009ac40:
        uVar7 = *(uint *)(genshelloptOptions._68_4_ + 0x10);
    }
    if ((uVar7 & 0xf) != 0) {
        pcVar15 = *(char **)(genshelloptOptions._68_4_ + 0x18);
        uVar16 = *(undefined4 *)(param_1 + 0x1c);
        pFVar5 = fopen64(pcVar15, "r");
        if (pFVar5 == (FILE *)0x0) {
            DAT_00117400 = (char *)0x0;
            pcVar8 = DAT_00117404;
        } else {
            iVar14 = fileno(pFVar5);
            iVar14 = __fxstat64(3, iVar14, &local_118);
            local_130 = (size_t)local_118.st_size;
            if ((iVar14 != 0) || ((local_118.st_mode & 0xf000) != 0x8000)) {
                /* WARNING: Subroutine does not return */
                FUN_0008cf18(uVar16, "fstat", pcVar15);
            }
            sVar13 = (size_t)local_118.st_size + 1;
            __haystack = (char *)malloc(sVar13);
            if (__haystack == (char *)0x0) {
                /* WARNING: Subroutine does not return */
                FUN_0001c610(sVar13);
            }
            pcVar8 = __haystack;
            while (sVar13 = fread(pcVar8, 1, local_130, pFVar5), sVar13 != 0) {
                local_130 = (size_t)local_118.st_size - sVar13;
                local_118.st_size._4_4_ =
                    local_118.st_size._4_4_ -
                    (((int)sVar13 >> 0x1f) +
                     (uint)((size_t)local_118.st_size < sVar13));
                local_118.st_size._0_4_ = local_130;
                if (local_130 == 0 && local_118.st_size._4_4_ == 0)
                    break;
                pcVar8 = pcVar8 + sVar13;
            }
            *pcVar8 = '\0';
            fclose(pFVar5);
            DAT_00117400 = __haystack;
            pcVar6 = strstr(__haystack,
                            "# # # # # # # # # # -- do not modify this marker "
                            "--\n#\n#  DO NOT EDIT THIS SECTION\n");
            pcVar8 = __haystack;
            if (pcVar6 != (char *)0x0) {
                *pcVar6 = '\0';
                pcVar8 = strstr(pcVar6 + 1,
                                "\n# # # # # # # # # #\n#\n#  END OF AUTOMATED "
                                "OPTION PROCESSING\n#\n# # # # # # # # # # -- "
                                "do not modify this marker --\n");
                if (pcVar8 == (char *)0x0) {
                    sVar13 = strlen(__haystack);
                    pcVar8 = __haystack + sVar13 + 0x53;
                } else {
                    pcVar8 = pcVar8 + 0x73;
                    DAT_00117408 = __haystack;
                }
            }
        }
        DAT_00117404 = pcVar8;
        pFVar5 = freopen64(pcVar15, "w", stdout);
        if (stdout != pFVar5) {
            /* WARNING: Subroutine does not return */
            FUN_0008cf18(uVar16, "freopen", pcVar15);
        }
    }
    if (DAT_00117408 == (char *)0x0) {
        local_118.st_dev._0_4_ = time((time_t *)0x0);
        ptVar2 = localtime((time_t *)&local_118);
        strftime(acStack_ac, 0x80, "%A %B %e, %Y at %r %Z", ptVar2);
        pcVar15 = (char *)0x0;
        if ((*(uint *)(genshelloptOptions._68_4_ + 0x10) & 0xf) != 0)
            goto LAB_0009afb0;
        pcVar8 = "stdout";
    LAB_0009b2e4:
        if (DAT_001173fc != (char *)0x0) {
            printf("#! %s\n");
        }
    } else {
        fputs(DAT_00117408, stdout);
        pcVar15 = DAT_00117408;
        local_118.st_dev._0_4_ = time((time_t *)0x0);
        ptVar2 = localtime((time_t *)&local_118);
        strftime(acStack_ac, 0x80, "%A %B %e, %Y at %r %Z", ptVar2);
        if ((*(uint *)(genshelloptOptions._68_4_ + 0x10) & 0xf) == 0) {
            pcVar8 = "stdout";
        } else {
        LAB_0009afb0:
            pcVar8 = *(char **)(genshelloptOptions._68_4_ + 0x18);
        }
        if (pcVar15 == (char *)0x0)
            goto LAB_0009b2e4;
    }
    printf("%s OF %s\n#\n#  From here to the next `-- do not modify this "
           "marker --\',\n#  the text has been generated %s\n",
           "# # # # # # # # # # -- do not modify this marker --\n#\n#  DO NOT "
           "EDIT THIS SECTION\n",
           pcVar8, acStack_ac);
    printf("#  From the %s option definitions\n#\n",
           *(undefined4 *)(param_1 + 0x20));
    pp_Var3 = __ctype_tolower_loc();
    p_Var4 = *pp_Var3;
    pbVar9 = *(byte **)(param_1 + 0x20);
    pcVar15 = acStack_ac;
    do {
        _Var1 = p_Var4[*pbVar9];
        *pcVar15 = (char)_Var1;
        pbVar9 = pbVar9 + 1;
        pcVar15 = pcVar15 + 1;
    } while ((char)_Var1 != '\0');
    *(char **)(param_1 + 0x18) = acStack_ac;
    *(char **)(param_1 + 0x1c) = acStack_ac;
    FUN_0009a95c(param_1, 0, 0);
    FUN_0009a95c(param_1, 1, 0);
    iVar12 = *(int *)(param_1 + 0x44);
    iVar14 = iVar12;
    if (*(code **)(iVar12 + 0x28) == optionPrintVersion) {
    LAB_0009ad8c:
        FUN_0009a95c(param_1, 2, iVar14);
        iVar12 = *(int *)(param_1 + 0x44);
    } else {
        iVar11 = *(int *)(param_1 + 100) + -1;
        iVar10 = iVar12;
        if (0 < iVar11) {
            do {
                iVar14 = iVar10 + 0x40;
                if (*(code **)(iVar10 + 0x68) == optionPrintVersion)
                    goto LAB_0009ad8c;
                iVar11 = iVar11 + -1;
                iVar10 = iVar10 + 0x40;
            } while (iVar11 != 0);
        }
    }
    iVar14 = *(int *)(param_1 + 0x68);
    if (0 < iVar14) {
        do {
            if (((*(uint *)(iVar12 + 0x10) & 0x280000) == 0) &&
                (iVar10 = *(int *)(iVar12 + 0x30), iVar10 != 0)) {
                pcVar15 = "\n%1$s_%2$s=${%1$s_%2$s-\'%3$s\'}\n%1$s_%2$s_set="
                          "false\nexport %1$s_%2$s\n";
                if (1 < *(ushort *)(iVar12 + 0xc)) {
                    pcVar15 = "\nif test -z \"${%1$s_%2$s}\"\nthen\n  "
                              "%1$s_%2$s_CT=0\n  export %1$s_%2$s_CT\nelse\n  "
                              "%1$s_%2$s_CT=1\n  %1$s_%2$s_1=${%1$s_%2$s}\n  "
                              "export %1$s_%2$s_CT %1$s_%2$s_1\nfi\n";
                }
                pcVar8 = acStack_ac;
                switch ((*(uint *)(iVar12 + 0x10) << 0x10) >> 0x1c) {
                case 2:
                    (**(code **)(iVar12 + 0x28))(2, iVar12);
                    iVar10 = *(int *)(iVar12 + 0x30);
                    pcVar8 = *(char **)(iVar12 + 0x18);
                    break;
                case 3:
                    pcVar8 = "false";
                    if (*(int *)(iVar12 + 0x18) != 0) {
                        pcVar8 = "true";
                    }
                    break;
                case 4:
                    FUN_0007c054(acStack_ac, 0x20, "%lu",
                                 *(undefined4 *)(iVar12 + 0x18));
                    iVar10 = *(int *)(iVar12 + 0x30);
                    break;
                case 5:
                    FUN_0007c054(acStack_ac, 0x20, "%d",
                                 *(undefined4 *)(iVar12 + 0x18));
                    iVar10 = *(int *)(iVar12 + 0x30);
                    break;
                default:
                    pcVar8 = *(char **)(iVar12 + 0x18);
                    if ((pcVar8 == (char *)0x0) &&
                        (pcVar15 == "\n%1$s_%2$s=${%1$s_%2$s-\'%3$s\'}\n%1$s_%"
                                    "2$s_set=false\nexport %1$s_%2$s\n")) {
                        pcVar15 = "\n%1$s_%2$s=${%1$s_%2$s}\n%1$s_%2$s_set="
                                  "false\nexport %1$s_%2$s\n";
                    }
                }
                printf(pcVar15, *(undefined4 *)(param_1 + 0x20), iVar10,
                       pcVar8);
            }
            iVar14 = iVar14 + -1;
            iVar12 = iVar12 + 0x40;
        } while (iVar14 != 0);
    }
    uVar7 = *(uint *)(param_1 + 0xc) & 3;
    if (uVar7 == 2) {
        fwrite("\nARG_COUNT=$#\nOPT_PROCESS=true\nOPT_ARG=$1\nwhile "
               "${OPT_PROCESS} && [ $# -gt 0 ]\ndo\n    OPT_ELEMENT=\'\'\n    "
               "OPT_ARG_VAL=\'\'\n\n    case \"${OPT_ARG}\" in\n    -- )\n     "
               "   OPT_PROCESS=false\n        shift\n        ;;\n",
               1, 0xce, stdout);
        fwrite(&DAT_000aff29, 1, 9, stdout);
        fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\" | sed "
               "\'s/X-\\(.\\).*/\\1/\'`\n        OPT_ARG=` echo "
               "\"X${OPT_ARG}\" | sed \'s/X-.//\'`\n",
               1, 0x74, stdout);
        FUN_0008ed38(param_1);
        printf("        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n          "
               "  if [ -n \"${OPT_ARG}\" ]\n            then\n                "
               "OPT_ARG=-${OPT_ARG}\n            else\n                shift\n "
               "               OPT_ARG=$1\n            fi\n            ;;\n    "
               "    YES )\n            if [ -n \"${OPT_ARG}\" ]\n            "
               "then\n                OPT_ARG_VAL=${OPT_ARG}\n            "
               "else\n                if [ $# -eq 0 ]\n                then\n  "
               "                  echo No argument provided for ${OPT_NAME} "
               "option\n                    echo \"$%s_USAGE_TEXT\"\n          "
               "          exit 1\n                fi >&2\n                "
               "shift\n                OPT_ARG_VAL=$1\n            fi\n        "
               "    shift\n            OPT_ARG=$1\n            ;;\n        OK "
               ")\n            if [ -n \"${OPT_ARG}\" ]\n            then\n    "
               "            OPT_ARG_VAL=${OPT_ARG}\n                shift\n    "
               "            OPT_ARG=$1\n            else\n                "
               "shift\n                if [ $# -gt 0 ]\n                then\n "
               "                   case \"$1\" in -* ) ;; * )\n                "
               "        OPT_ARG_VAL=$1\n                        shift ;; "
               "esac\n                    OPT_ARG=$1\n                fi\n     "
               "       fi\n            ;;\n        esac\n",
               *(undefined4 *)(param_1 + 0x20));
    } else {
        if (uVar7 != 3) {
            if (uVar7 == 1) {
                fwrite("\nARG_COUNT=$#\nOPT_PROCESS=true\nOPT_ARG=$1\nwhile "
                       "${OPT_PROCESS} && [ $# -gt 0 ]\ndo\n    "
                       "OPT_ELEMENT=\'\'\n    OPT_ARG_VAL=\'\'\n\n    case "
                       "\"${OPT_ARG}\" in\n    -- )\n        "
                       "OPT_PROCESS=false\n        shift\n        ;;\n",
                       1, 0xce, stdout);
                fwrite(&DAT_000aff52, 1, 10, stdout);
                fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\"|sed "
                       "\'s/^X-*//\'`\n        shift\n        OPT_ARG=$1\n     "
                       "   case \"${OPT_CODE}\" in *=* )\n            "
                       "OPT_ARG_VAL=`echo \"${OPT_CODE}\"|sed "
                       "\'s/^[^=]*=//\'`\n            OPT_CODE=`echo "
                       "\"${OPT_CODE}\"|sed \'s/=.*$//\'` ;; esac\n",
                       1, 0xfa, stdout);
                FUN_0008f000(param_1);
                printf(
                    "        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n     "
                    "       OPT_ARG_VAL=\'\'\n            ;;\n        YES )\n  "
                    "          if [ -z \"${OPT_ARG_VAL}\" ]\n            "
                    "then\n                if [ $# -eq 0 ]\n                "
                    "then\n                    echo No argument provided for "
                    "${OPT_NAME} option\n                    echo "
                    "\"$%s_USAGE_TEXT\"\n                    exit 1\n          "
                    "      fi >&2\n                OPT_ARG_VAL=${OPT_ARG}\n    "
                    "            shift\n                OPT_ARG=$1\n           "
                    " fi\n            ;;\n        OK )\n            if [ -z "
                    "\"${OPT_ARG_VAL}\" ] && [ $# -gt 0 ]\n            then\n  "
                    "              case \"${OPT_ARG}\" in -* ) ;; * )\n        "
                    "            OPT_ARG_VAL=${OPT_ARG}\n                    "
                    "shift\n                    OPT_ARG=$1 ;; esac\n           "
                    " fi\n            ;;\n        esac\n",
                    *(undefined4 *)(param_1 + 0x20));
                fwrite(&DAT_000afeec, 1, 0xc, stdout);
                fwrite("    * )\n         OPT_PROCESS=false\n         ;;\n    "
                       "esac\n",
                       1, 0x38, stdout);
            } else {
                fwrite("\nARG_COUNT=$#\nOPT_ARG=$1\nwhile [ $# -gt 0 ]\ndo\n   "
                       " OPT_ELEMENT=\'\'\n    OPT_ARG_VAL=\'\'\n    "
                       "OPT_ARG=${1}\n",
                       1, 0x66, stdout);
                fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\"|sed "
                       "\'s/^X-*//\'`\n        shift\n        OPT_ARG=$1\n     "
                       "   case \"${OPT_CODE}\" in *=* )\n            "
                       "OPT_ARG_VAL=`echo \"${OPT_CODE}\"|sed "
                       "\'s/^[^=]*=//\'`\n            OPT_CODE=`echo "
                       "\"${OPT_CODE}\"|sed \'s/=.*$//\'` ;; esac\n",
                       1, 0xfa, stdout);
                FUN_0008f000(param_1);
                printf(
                    "        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n     "
                    "       OPT_ARG_VAL=\'\'\n            ;;\n        YES )\n  "
                    "          if [ -z \"${OPT_ARG_VAL}\" ]\n            "
                    "then\n                if [ $# -eq 0 ]\n                "
                    "then\n                    echo No argument provided for "
                    "${OPT_NAME} option\n                    echo "
                    "\"$%s_USAGE_TEXT\"\n                    exit 1\n          "
                    "      fi >&2\n                OPT_ARG_VAL=${OPT_ARG}\n    "
                    "            shift\n                OPT_ARG=$1\n           "
                    " fi\n            ;;\n        OK )\n            if [ -z "
                    "\"${OPT_ARG_VAL}\" ] && [ $# -gt 0 ]\n            then\n  "
                    "              case \"${OPT_ARG}\" in -* ) ;; * )\n        "
                    "            OPT_ARG_VAL=${OPT_ARG}\n                    "
                    "shift\n                    OPT_ARG=$1 ;; esac\n           "
                    " fi\n            ;;\n        esac\n",
                    *(undefined4 *)(param_1 + 0x20));
            }
            goto LAB_0009aeb8;
        }
        fwrite("\nARG_COUNT=$#\nOPT_PROCESS=true\nOPT_ARG=$1\nwhile "
               "${OPT_PROCESS} && [ $# -gt 0 ]\ndo\n    OPT_ELEMENT=\'\'\n    "
               "OPT_ARG_VAL=\'\'\n\n    case \"${OPT_ARG}\" in\n    -- )\n     "
               "   OPT_PROCESS=false\n        shift\n        ;;\n",
               1, 0xce, stdout);
        fwrite(&DAT_000aff52, 1, 10, stdout);
        fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\"|sed \'s/^X-*//\'`\n     "
               "   shift\n        OPT_ARG=$1\n        case \"${OPT_CODE}\" in "
               "*=* )\n            OPT_ARG_VAL=`echo \"${OPT_CODE}\"|sed "
               "\'s/^[^=]*=//\'`\n            OPT_CODE=`echo "
               "\"${OPT_CODE}\"|sed \'s/=.*$//\'` ;; esac\n",
               1, 0xfa, stdout);
        FUN_0008f000(param_1);
        printf(
            "        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n            "
            "OPT_ARG_VAL=\'\'\n            ;;\n        YES )\n            if [ "
            "-z \"${OPT_ARG_VAL}\" ]\n            then\n                if [ "
            "$# -eq 0 ]\n                then\n                    echo No "
            "argument provided for ${OPT_NAME} option\n                    "
            "echo \"$%s_USAGE_TEXT\"\n                    exit 1\n             "
            "   fi >&2\n                OPT_ARG_VAL=${OPT_ARG}\n               "
            " shift\n                OPT_ARG=$1\n            fi\n            "
            ";;\n        OK )\n            if [ -z \"${OPT_ARG_VAL}\" ] && [ "
            "$# -gt 0 ]\n            then\n                case \"${OPT_ARG}\" "
            "in -* ) ;; * )\n                    OPT_ARG_VAL=${OPT_ARG}\n      "
            "              shift\n                    OPT_ARG=$1 ;; esac\n     "
            "       fi\n            ;;\n        esac\n",
            *(undefined4 *)(param_1 + 0x20));
        fwrite(&DAT_000afeec, 1, 0xc, stdout);
        fwrite(&DAT_000aff29, 1, 9, stdout);
        fwrite("        OPT_CODE=`echo \"X${OPT_ARG}\" | sed "
               "\'s/X-\\(.\\).*/\\1/\'`\n        OPT_ARG=` echo "
               "\"X${OPT_ARG}\" | sed \'s/X-.//\'`\n",
               1, 0x74, stdout);
        FUN_0008ed38(param_1);
        printf("        case \"${OPT_ARG_NEEDED}\" in\n        NO )\n          "
               "  if [ -n \"${OPT_ARG}\" ]\n            then\n                "
               "OPT_ARG=-${OPT_ARG}\n            else\n                shift\n "
               "               OPT_ARG=$1\n            fi\n            ;;\n    "
               "    YES )\n            if [ -n \"${OPT_ARG}\" ]\n            "
               "then\n                OPT_ARG_VAL=${OPT_ARG}\n            "
               "else\n                if [ $# -eq 0 ]\n                then\n  "
               "                  echo No argument provided for ${OPT_NAME} "
               "option\n                    echo \"$%s_USAGE_TEXT\"\n          "
               "          exit 1\n                fi >&2\n                "
               "shift\n                OPT_ARG_VAL=$1\n            fi\n        "
               "    shift\n            OPT_ARG=$1\n            ;;\n        OK "
               ")\n            if [ -n \"${OPT_ARG}\" ]\n            then\n    "
               "            OPT_ARG_VAL=${OPT_ARG}\n                shift\n    "
               "            OPT_ARG=$1\n            else\n                "
               "shift\n                if [ $# -gt 0 ]\n                then\n "
               "                   case \"$1\" in -* ) ;; * )\n                "
               "        OPT_ARG_VAL=$1\n                        shift ;; "
               "esac\n                    OPT_ARG=$1\n                fi\n     "
               "       fi\n            ;;\n        esac\n",
               *(undefined4 *)(param_1 + 0x20));
    }
    fwrite(&DAT_000afeec, 1, 0xc, stdout);
    fwrite("    * )\n         OPT_PROCESS=false\n         ;;\n    esac\n", 1,
           0x38, stdout);
LAB_0009aeb8:
    iVar12 = *(int *)(param_1 + 0x68);
    iVar14 = *(int *)(param_1 + 0x44);
    printf("    if [ -n \"${OPT_ARG_VAL}\" ]\n    then\n        eval "
           "%1$s_${OPT_NAME}${OPT_ELEMENT}=\"\'${OPT_ARG_VAL}\'\"\n        "
           "export %1$s_${OPT_NAME}${OPT_ELEMENT}\n    "
           "fi\ndone\nOPTION_COUNT=`expr $ARG_COUNT - "
           "$#`\nOPERAND_COUNT=$#\nunset OPT_PROCESS || :\nunset OPT_ELEMENT "
           "|| :\nunset OPT_ARG     || :\nunset OPT_ARG_NEEDED || :\nunset "
           "OPT_NAME    || :\nunset OPT_CODE    || :\nunset OPT_ARG_VAL || :\n",
           *(undefined4 *)(param_1 + 0x20));
    if (0 < iVar12) {
        do {
            if (((*(uint *)(iVar14 + 0x10) & 0x280000) == 0) &&
                (*(int *)(iVar14 + 0x30) != 0)) {
                uVar7 = (uint) * (ushort *)(iVar14 + 10);
                pcVar15 = "test ${%1$s_%2$s_CT-0} -ge %3$u || {\n    echo "
                          "%1$s_%2$s has not been set\n    exit 1\n} 1>&2\n";
                if (uVar7 == 0) {
                    if ((*(uint *)(iVar14 + 0x10) & 0x100000) == 0)
                        goto LAB_0009af14;
                    if (*(ushort *)(iVar14 + 0xc) < 2) {
                        uVar7 = 1;
                        pcVar15 =
                            "test -n \"$%1$s_%2$s\" || {\n    echo %1$s_%2$s "
                            "has not been set\n    exit 1\n} 1>&2\n";
                    } else {
                        uVar7 = 1;
                    }
                } else if (*(ushort *)(iVar14 + 0xc) < 2) {
                    pcVar15 = "test -n \"$%1$s_%2$s\" || {\n    echo %1$s_%2$s "
                              "has not been set\n    exit 1\n} 1>&2\n";
                }
                printf(pcVar15, *(undefined4 *)(param_1 + 0x20),
                       *(int *)(iVar14 + 0x30), uVar7);
            }
        LAB_0009af14:
            iVar12 = iVar12 + -1;
            iVar14 = iVar14 + 0x40;
        } while (iVar12 != 0);
    }
    fwrite(
        "\n# # # # # # # # # #\n#\n#  END OF AUTOMATED OPTION PROCESSING\n#\n# "
        "# # # # # # # # # -- do not modify this marker --\n",
        1, 0x73, stdout);
    if ((DAT_00117404 == (char *)0x0) || (*DAT_00117404 == '\0')) {
        if ((*(uint *)(genshelloptOptions._68_4_ + 0x50) & 0x20) == 0) {
            printf("\nenv | grep \'^%s_\'\n", *(undefined4 *)(param_1 + 0x20));
        }
    } else {
        fputs(DAT_00117404, stdout);
    }
    fchmod(1, 0x1ed);
    fclose(stdout);
    iVar14 = ferror(stdout);
    if (iVar14 != 0) {
        /* WARNING: Subroutine does not return */
        FUN_0008cf18(*(undefined4 *)(param_1 + 0x1c),
                     option_xlateable_txt._228_4_,
                     option_xlateable_txt._220_4_);
    }
    free(DAT_00117400);
    DAT_00117408 = (char *)0x0;
    DAT_00117404 = (char *)0x0;
    DAT_00117400 = (char *)0x0;
    if (local_2c != __stack_chk_guard) {
        /* WARNING: Subroutine does not return */
        __stack_chk_fail();
    }
    return;
}

ulonglong FUN_0009b690(uint param_1, uint param_2)

{
    uint uVar1;
    ulonglong uVar2;

    if (param_2 - 1 == 0) {
        return CONCAT44(param_2, param_1);
    }
    if (param_2 == 0) {
        uVar1 = raise(8);
        return (ulonglong)uVar1;
    }
    if (param_1 <= param_2) {
        return CONCAT44(param_2, (uint)(param_1 == param_2));
    }
    if ((param_2 & param_2 - 1) == 0) {
        return CONCAT44(param_2, param_1 >> (0x1fU - LZCOUNT(param_2) & 0xff));
    }
    /* WARNING: Could not recover jumptable at 0x0009b6c0. Too many branches */
    /* WARNING: Treating indirect jump as call */
    uVar2 = (*(code *)(&UNK_0009b6c8 +
                       (0x1f - (LZCOUNT(param_2) - LZCOUNT(param_1))) * 0x10))(
        param_1, param_2, 0);
    return uVar2;
}

void FUN_0009b8ec(undefined4 param_1, int param_2)

{
    if (param_2 != 0) {
        FUN_0009b690();
        return;
    }
    raise(8);
    return;
}

ulonglong FUN_0009b908(uint param_1, uint param_2)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    ulonglong uVar4;

    if (param_2 == 0) {
        uVar2 = raise(8);
        return (ulonglong)uVar2;
    }
    uVar3 = param_1 ^ param_2;
    uVar2 = param_2;
    if ((int)param_2 < 0) {
        uVar2 = -param_2;
    }
    if (uVar2 - 1 == 0) {
        if ((int)param_2 < 0) {
            param_1 = -param_1;
        }
        return CONCAT44(uVar2, param_1);
    }
    uVar1 = param_1;
    if ((int)param_1 < 0) {
        uVar1 = -param_1;
    }
    if (uVar1 <= uVar2) {
        if (uVar1 < uVar2) {
            param_1 = 0;
        }
        if (uVar1 == uVar2) {
            param_1 = (int)uVar3 >> 0x1f | 1;
        }
        return CONCAT44(uVar2, param_1);
    }
    if ((uVar2 & uVar2 - 1) == 0) {
        uVar1 = uVar1 >> (0x1fU - LZCOUNT(uVar2) & 0xff);
        if ((int)uVar3 < 0) {
            uVar1 = -uVar1;
        }
        return CONCAT44(uVar2, uVar1);
    }
    /* WARNING: Could not recover jumptable at 0x0009b948. Too many branches */
    /* WARNING: Treating indirect jump as call */
    uVar4 = (*(code *)(&UNK_0009b950 +
                       (0x1f - (LZCOUNT(uVar2) - LZCOUNT(uVar1))) * 0x10))(0);
    return uVar4;
}

uint FUN_0009b90e(uint param_1, uint param_2)

{
    uint uVar1;
    uint uVar2;
    uint uVar3;
    char in_NG;

    uVar3 = param_1 ^ param_2;
    uVar1 = param_2;
    if (in_NG != '\0') {
        uVar1 = -param_2;
    }
    if (uVar1 - 1 == 0) {
        if ((int)param_2 < 0) {
            param_1 = -param_1;
        }
        return param_1;
    }
    uVar2 = param_1;
    if ((int)param_1 < 0) {
        uVar2 = -param_1;
    }
    if (uVar2 <= uVar1) {
        if (uVar2 < uVar1) {
            param_1 = 0;
        }
        if (uVar2 == uVar1) {
            param_1 = (int)uVar3 >> 0x1f | 1;
        }
        return param_1;
    }
    if ((uVar1 & uVar1 - 1) == 0) {
        uVar2 = uVar2 >> (0x1fU - LZCOUNT(uVar1) & 0xff);
        if ((int)uVar3 < 0) {
            uVar2 = -uVar2;
        }
        return uVar2;
    }
    /* WARNING: Could not recover jumptable at 0x0009b948. Too many branches */
    /* WARNING: Treating indirect jump as call */
    uVar1 = (*(code *)(&UNK_0009b950 +
                       (0x1f - (LZCOUNT(uVar1) - LZCOUNT(uVar2))) * 0x10))(0);
    return uVar1;
}

void FUN_0009bb9c(undefined4 param_1, int param_2)

{
    if (param_2 != 0) {
        FUN_0009b90e();
        return;
    }
    raise(8);
    return;
}

ulonglong FUN_0009bec4(uint param_1, uint param_2)

{
    byte bVar1;
    uint uVar2;
    uint uVar3;
    uint uVar4;
    int iVar5;
    uint uVar6;
    int iVar7;
    uint uVar8;
    bool bVar9;
    bool bVar10;
    bool bVar11;

    if (param_1 == 0 && param_2 == 0) {
        return CONCAT44(param_2, param_1);
    }
    iVar7 = 0x432;
    uVar8 = param_2 >> 0x16;
    if (uVar8 != 0) {
        iVar7 = 3;
        if (param_2 >> 0x19 != 0) {
            iVar7 = 6;
        }
        if (param_2 >> 0x1c != 0) {
            iVar7 = iVar7 + 3;
        }
        uVar4 = iVar7 - ((int)param_2 >> 0x1f);
        uVar8 = param_1 << (0x20 - uVar4 & 0xff);
        param_1 = param_1 >> (uVar4 & 0xff) | param_2 << (0x20 - uVar4 & 0xff);
        param_2 = param_2 >> (uVar4 & 0xff);
        iVar7 = uVar4 + 0x432;
    }
    if (0xfffff < param_2) {
        if (0x1fffff < param_2) {
            uVar4 = param_2 & 1;
            param_2 = param_2 >> 1;
            bVar1 = (byte)param_1;
            param_1 = (uint)(uVar4 != 0) << 0x1f | param_1 >> 1;
            uVar8 = (uint)(bVar1 & 1) << 0x1f | uVar8 >> 1;
            iVar7 = iVar7 + 1;
            if (0xffbfffff < (uint)(iVar7 * 0x200000)) {
                return 0x7ff0000000000000;
            }
        }
    LAB_0009bcd0:
        bVar10 = 0x7fffffff < uVar8;
        if (uVar8 == 0x80000000) {
            bVar10 = (param_1 & 1) != 0;
        }
        return CONCAT44(param_2 + iVar7 * 0x100000 +
                            (uint)CARRY4(param_1, (uint)bVar10),
                        param_1 + bVar10);
    }
    bVar9 = (uVar8 & 0x80000000) != 0;
    uVar8 = uVar8 << 1;
    uVar4 = param_1 * 2;
    bVar10 = CARRY4(param_1, param_1);
    param_1 = param_1 * 2 + (uint)bVar9;
    param_2 = param_2 * 2 + (uint)(bVar10 || CARRY4(uVar4, (uint)bVar9));
    iVar7 = iVar7 + -1;
    if ((param_2 & 0x100000) != 0)
        goto LAB_0009bcd0;
    uVar2 = param_1;
    uVar4 = param_2;
    if (param_2 == 0) {
        uVar2 = 0;
        uVar4 = param_1;
    }
    iVar5 = LZCOUNT(uVar4);
    if (param_2 == 0) {
        iVar5 = iVar5 + 0x20;
    }
    uVar6 = iVar5 - 0xb;
    bVar11 = SBORROW4(uVar6, 0x20);
    uVar3 = iVar5 - 0x2b;
    bVar10 = (int)uVar3 < 0;
    bVar9 = uVar3 == 0;
    if ((int)uVar6 < 0x20) {
        bVar11 = SCARRY4(uVar3, 0xc);
        iVar5 = iVar5 + -0x1f;
        bVar10 = iVar5 < 0;
        bVar9 = iVar5 == 0;
        uVar3 = uVar6;
        if (!bVar9 && bVar10 == bVar11) {
            uVar2 = uVar4 << (uVar6 & 0xff);
            uVar4 = uVar4 >> (0xcU - iVar5 & 0xff);
            goto LAB_0009bd48;
        }
    }
    if (bVar9 || bVar10 != bVar11) {
        uVar8 = 0x20 - uVar3;
    }
    uVar4 = uVar4 << (uVar3 & 0xff);
    if (bVar9 || bVar10 != bVar11) {
        uVar4 = uVar4 | uVar2 >> (uVar8 & 0xff);
        uVar2 = uVar2 << (uVar3 & 0xff);
    }
LAB_0009bd48:
    if ((int)uVar6 <= iVar7) {
        return CONCAT44(uVar4 + (iVar7 - uVar6) * 0x100000, uVar2);
    }
    uVar8 = ~(iVar7 - uVar6);
    if (0x1e < (int)uVar8) {
        return (ulonglong)(uVar4 >> (uVar8 - 0x1f & 0xff));
    }
    iVar7 = uVar8 - 0x13;
    if (iVar7 == 0 || iVar7 < 0 != SCARRY4(uVar8 - 0x1f, 0xc)) {
        uVar8 = uVar8 + 1;
        return CONCAT44(uVar4 >> (uVar8 & 0xff),
                        uVar2 >> (uVar8 & 0xff) | uVar4
                                                      << (0x20 - uVar8 & 0xff));
    }
    return (ulonglong)(uVar2 >> (0x20 - (0xcU - iVar7) & 0xff) |
                       uVar4 << (0xcU - iVar7 & 0xff));
}

undefined8 FUN_0009bf30(int param_1, int param_2, int param_3, int param_4)

{
    int iVar1;
    undefined8 uVar2;
    int local_8;

    if ((param_4 == 0) && (param_3 == 0)) {
        if (param_2 < 0) {
            param_2 = -0x80000000;
        } else if (param_2 != 0 || param_1 != 0) {
            param_2 = 0x7fffffff;
        }
        local_8 = param_2;
        iVar1 = raise(8);
        return CONCAT44(local_8, iVar1);
    }
    if (param_2 < 0) {
        iVar1 = -param_2 - (uint)(param_1 != 0);
        if (param_4 < 0) {
            uVar2 = FUN_0009c050(-param_1, iVar1, -param_3,
                                 -param_4 - (uint)(param_3 != 0), &local_8);
            return uVar2;
        }
        uVar2 = FUN_0009c050(-param_1, iVar1, param_3, param_4, &local_8);
        return CONCAT44(-(int)((ulonglong)uVar2 >> 0x20) -
                            (uint)((int)uVar2 != 0),
                        -(int)uVar2);
    }
    if (param_4 < 0) {
        uVar2 = FUN_0009c050(param_1, param_2, -param_3,
                             -param_4 - (uint)(param_3 != 0), &local_8);
        return CONCAT44(-(int)((ulonglong)uVar2 >> 0x20) -
                            (uint)((int)uVar2 != 0),
                        -(int)uVar2);
    }
    uVar2 = FUN_0009c050();
    return uVar2;
}

void FUN_0009bfd0(undefined4 param_1, undefined4 param_2, int param_3,
                  int param_4)

{
    if ((param_4 == 0) && (param_3 == 0)) {
        raise(8);
        return;
    }
    FUN_0009c050();
    return;
}

undefined8 FUN_0009c010(undefined4 param_1, undefined4 param_2)

{
    uint uVar1;
    double dVar2;

    dVar2 = (double)CONCAT44(param_2, param_1) * 2.3283064365386963e-10;
    uVar1 = (uint)(0.0 < dVar2) * (int)(longlong)dVar2;
    dVar2 = (double)CONCAT44(param_2, param_1) - (double)uVar1 * 4294967296.0;
    return CONCAT44(uVar1, (uint)(0.0 < dVar2) * (int)(longlong)dVar2);
}

undefined8 FUN_0009c050(uint param_1, uint param_2, uint param_3, uint param_4,
                        uint *param_5)

{
    uint uVar1;
    uint uVar2;
    int iVar3;
    uint uVar4;
    uint uVar5;
    uint uVar6;
    uint uVar7;
    uint uVar8;
    uint uVar9;
    int iVar10;
    uint uVar11;
    bool bVar12;

    bVar12 = param_4 <= param_2;
    if (param_2 == param_4) {
        bVar12 = param_3 <= param_1;
    }
    if (bVar12) {
        iVar10 = LZCOUNT(param_4);
        if (param_4 == 0) {
            iVar10 = LZCOUNT(param_3) + 0x20;
        }
        iVar3 = LZCOUNT(param_2);
        if (param_2 == 0) {
            iVar3 = LZCOUNT(param_1) + 0x20;
        }
        uVar11 = iVar10 - iVar3;
        uVar8 = uVar11 - 0x20;
        uVar9 = 0x20 - uVar11;
        uVar5 = param_3 << (uVar11 & 0xff);
        uVar6 = param_4 << (uVar11 & 0xff) | param_3 << (uVar8 & 0xff) |
                param_3 >> (uVar9 & 0xff);
        bVar12 = uVar6 <= param_2;
        if (param_2 == uVar6) {
            bVar12 = uVar5 <= param_1;
        }
        if (bVar12) {
            bVar12 = param_1 < uVar5;
            param_1 = param_1 - uVar5;
            uVar1 = 1 << (uVar11 & 0xff);
            param_2 = (param_2 - uVar6) - (uint)bVar12;
            uVar2 = 1 << (uVar8 & 0xff) | 1U >> (uVar9 & 0xff);
        } else {
            uVar1 = 0;
            uVar2 = uVar1;
        }
        if (uVar11 != 0) {
            uVar7 = uVar6 >> 1;
            uVar6 = (uint)((uVar6 & 1) != 0) << 0x1f | uVar5 >> 1;
            uVar5 = uVar11;
            do {
                while (true) {
                    bVar12 = uVar7 <= param_2;
                    if (param_2 == uVar7) {
                        bVar12 = uVar6 <= param_1;
                    }
                    if (bVar12)
                        break;
                    bVar12 = CARRY4(param_1, param_1);
                    param_1 = param_1 * 2;
                    param_2 = param_2 * 2 + (uint)bVar12;
                    uVar5 = uVar5 - 1;
                    uVar4 = param_2;
                    if (uVar5 == 0)
                        goto LAB_0009c0fa;
                }
                bVar12 = param_1 < uVar6;
                uVar4 = param_1 - uVar6;
                param_1 = uVar4 * 2 + 1;
                param_2 = ((param_2 - uVar7) - (uint)bVar12) * 2 +
                          (uint)CARRY4(uVar4, uVar4) +
                          (uint)(0xfffffffe < uVar4 * 2);
                uVar5 = uVar5 - 1;
                uVar4 = param_2;
            } while (uVar5 != 0);
        LAB_0009c0fa:
            param_2 = uVar4 >> (uVar11 & 0xff);
            bVar12 = CARRY4(uVar1, param_1);
            uVar5 = uVar1 + param_1;
            param_1 = param_1 >> (uVar11 & 0xff) | uVar4 << (uVar9 & 0xff) |
                      uVar4 >> (uVar8 & 0xff);
            uVar6 = param_1 << (uVar11 & 0xff);
            uVar1 = uVar5 - uVar6;
            uVar2 = ((uVar4 + uVar2 + bVar12) -
                     (param_2 << (uVar11 & 0xff) |
                      param_1 << (uVar11 - 0x20 & 0xff) |
                      param_1 >> (0x20 - uVar11 & 0xff))) -
                    (uint)(uVar5 < uVar6);
        }
    } else {
        uVar1 = 0;
        uVar2 = uVar1;
    }
    if (param_5 != (uint *)0x0) {
        *param_5 = param_1;
        param_5[1] = param_2;
    }
    return CONCAT44(uVar2, uVar1);
}

void __libc_csu_init(undefined4 param_1, undefined4 param_2, undefined4 param_3,
                     undefined4 param_4)

{
    int iVar1;
    undefined **ppuVar2;

    _DT_INIT();
    iVar1 = 0;
    ppuVar2 = &__DT_INIT_ARRAY;
    do {
        iVar1 = iVar1 + 1;
        (*(code *)*ppuVar2)(param_1, param_2, param_3, *ppuVar2, param_4);
        ppuVar2 = ppuVar2 + 1;
    } while (iVar1 != 1);
    return;
}

void __libc_csu_fini(void)

{
    return;
}

void FUN_0009c1a8(undefined4 param_1)

{
    __cxa_atexit(param_1, 0, DAT_000c6004);
    return;
}

void _DT_FINI(void)

{
    return;
}
